Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.15000000000000002_ffn_num_layers_1_hidden_size_1400/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total scaffolds = 195 | train scaffolds = 91 | val scaffolds = 66 | test scaffolds = 38
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=1404, out_features=1, bias=True)
  )
)
Number of parameters = 4,314,805
Moving model to cuda
Epoch 0
Loss = 1.2277e-02, PNorm = 55.9789, GNorm = 3.1371, lr_0 = 3.6053e-04
Validation rmse = 1.637329
Epoch 1
Loss = 7.0157e-03, PNorm = 56.0433, GNorm = 4.2536, lr_0 = 6.2105e-04
Loss = 6.1289e-03, PNorm = 56.1350, GNorm = 5.7063, lr_0 = 8.5789e-04
Validation rmse = 1.310051
Epoch 2
Loss = 4.8861e-03, PNorm = 56.2252, GNorm = 1.2534, lr_0 = 9.8284e-04
Loss = 5.1765e-03, PNorm = 56.3141, GNorm = 2.0898, lr_0 = 9.4120e-04
Validation rmse = 1.406170
Epoch 3
Loss = 3.8905e-03, PNorm = 56.3949, GNorm = 2.2603, lr_0 = 8.9744e-04
Loss = 3.4824e-03, PNorm = 56.4533, GNorm = 0.4772, lr_0 = 8.5943e-04
Validation rmse = 1.327128
Epoch 4
Loss = 4.1149e-03, PNorm = 56.5090, GNorm = 1.2328, lr_0 = 8.2303e-04
Loss = 3.1314e-03, PNorm = 56.5610, GNorm = 3.2418, lr_0 = 7.8816e-04
Validation rmse = 1.192008
Epoch 5
Loss = 2.2410e-03, PNorm = 56.6104, GNorm = 2.0406, lr_0 = 7.5478e-04
Loss = 2.4467e-03, PNorm = 56.6533, GNorm = 2.7257, lr_0 = 7.2281e-04
Validation rmse = 1.249398
Epoch 6
Loss = 2.0637e-03, PNorm = 56.7019, GNorm = 0.5558, lr_0 = 6.8920e-04
Loss = 2.2332e-03, PNorm = 56.7397, GNorm = 1.2510, lr_0 = 6.6001e-04
Validation rmse = 1.315940
Epoch 7
Loss = 3.1358e-03, PNorm = 56.7787, GNorm = 3.8843, lr_0 = 6.3205e-04
Loss = 2.1055e-03, PNorm = 56.8197, GNorm = 2.0903, lr_0 = 6.0528e-04
Validation rmse = 1.158565
Epoch 8
Loss = 2.0319e-03, PNorm = 56.8558, GNorm = 1.6006, lr_0 = 5.7714e-04
Loss = 2.0747e-03, PNorm = 56.8890, GNorm = 0.7108, lr_0 = 5.5269e-04
Validation rmse = 1.038323
Epoch 9
Loss = 2.1458e-03, PNorm = 56.9216, GNorm = 2.2306, lr_0 = 5.2928e-04
Loss = 2.2292e-03, PNorm = 56.9571, GNorm = 1.5962, lr_0 = 5.0686e-04
Validation rmse = 1.104922
Epoch 10
Loss = 1.9396e-03, PNorm = 56.9835, GNorm = 2.0309, lr_0 = 4.8539e-04
Loss = 2.0582e-03, PNorm = 57.0119, GNorm = 1.0569, lr_0 = 4.6483e-04
Validation rmse = 1.071828
Epoch 11
Loss = 1.4833e-03, PNorm = 57.0384, GNorm = 1.0174, lr_0 = 4.4322e-04
Loss = 1.6568e-03, PNorm = 57.0587, GNorm = 1.4484, lr_0 = 4.2444e-04
Validation rmse = 1.053839
Epoch 12
Loss = 1.6738e-03, PNorm = 57.0782, GNorm = 1.4463, lr_0 = 4.0646e-04
Loss = 1.6005e-03, PNorm = 57.0991, GNorm = 0.6604, lr_0 = 3.8925e-04
Validation rmse = 0.994352
Epoch 13
Loss = 1.5691e-03, PNorm = 57.1190, GNorm = 0.4611, lr_0 = 3.7276e-04
Loss = 1.8384e-03, PNorm = 57.1427, GNorm = 0.8561, lr_0 = 3.5697e-04
Validation rmse = 1.119435
Epoch 14
Loss = 1.5152e-03, PNorm = 57.1641, GNorm = 1.7354, lr_0 = 3.4037e-04
Loss = 1.5086e-03, PNorm = 57.1822, GNorm = 1.1834, lr_0 = 3.2596e-04
Validation rmse = 1.043128
Epoch 15
Loss = 1.5838e-03, PNorm = 57.1995, GNorm = 0.4086, lr_0 = 3.1215e-04
Loss = 1.2877e-03, PNorm = 57.2174, GNorm = 1.3259, lr_0 = 2.9893e-04
Validation rmse = 1.113627
Epoch 16
Loss = 1.3775e-03, PNorm = 57.2307, GNorm = 0.4220, lr_0 = 2.8503e-04
Loss = 1.3076e-03, PNorm = 57.2451, GNorm = 0.6405, lr_0 = 2.7295e-04
Validation rmse = 0.981260
Epoch 17
Loss = 1.3037e-03, PNorm = 57.2604, GNorm = 1.3003, lr_0 = 2.6139e-04
Loss = 1.4453e-03, PNorm = 57.2771, GNorm = 0.4998, lr_0 = 2.5032e-04
Validation rmse = 0.967588
Epoch 18
Loss = 1.0677e-03, PNorm = 57.2889, GNorm = 0.3037, lr_0 = 2.3972e-04
Loss = 1.2365e-03, PNorm = 57.3014, GNorm = 0.6828, lr_0 = 2.2956e-04
Validation rmse = 1.073308
Epoch 19
Loss = 1.2222e-03, PNorm = 57.3188, GNorm = 0.8639, lr_0 = 2.1889e-04
Loss = 1.4139e-03, PNorm = 57.3305, GNorm = 0.5175, lr_0 = 2.0962e-04
Validation rmse = 1.034815
Epoch 20
Loss = 1.2529e-03, PNorm = 57.3422, GNorm = 0.3563, lr_0 = 2.0074e-04
Loss = 1.3225e-03, PNorm = 57.3527, GNorm = 1.0725, lr_0 = 1.9224e-04
Validation rmse = 1.038808
Epoch 21
Loss = 1.1738e-03, PNorm = 57.3655, GNorm = 0.3294, lr_0 = 1.8409e-04
Loss = 1.2080e-03, PNorm = 57.3759, GNorm = 1.0059, lr_0 = 1.7630e-04
Validation rmse = 0.966850
Epoch 22
Loss = 9.7208e-04, PNorm = 57.3874, GNorm = 0.9066, lr_0 = 1.6810e-04
Loss = 1.3828e-03, PNorm = 57.3960, GNorm = 0.5449, lr_0 = 1.6098e-04
Validation rmse = 0.974766
Epoch 23
Loss = 1.1702e-03, PNorm = 57.4055, GNorm = 0.6034, lr_0 = 1.5416e-04
Loss = 1.0809e-03, PNorm = 57.4157, GNorm = 0.5435, lr_0 = 1.4763e-04
Loss = 1.5466e-03, PNorm = 57.4167, GNorm = 0.7599, lr_0 = 1.4699e-04
Validation rmse = 0.996007
Epoch 24
Loss = 1.3291e-03, PNorm = 57.4226, GNorm = 0.4465, lr_0 = 1.4077e-04
Loss = 1.1257e-03, PNorm = 57.4307, GNorm = 0.8475, lr_0 = 1.3480e-04
Validation rmse = 0.990519
Epoch 25
Loss = 1.0927e-03, PNorm = 57.4369, GNorm = 0.8877, lr_0 = 1.2909e-04
Loss = 1.1077e-03, PNorm = 57.4431, GNorm = 0.9357, lr_0 = 1.2362e-04
Validation rmse = 1.042087
Epoch 26
Loss = 1.1094e-03, PNorm = 57.4492, GNorm = 1.2723, lr_0 = 1.1839e-04
Validation rmse = 1.062584
Epoch 27
Loss = 8.8028e-04, PNorm = 57.4575, GNorm = 0.7164, lr_0 = 1.1288e-04
Loss = 1.2013e-03, PNorm = 57.4643, GNorm = 0.8650, lr_0 = 1.0810e-04
Validation rmse = 0.953200
Epoch 28
Loss = 1.8571e-03, PNorm = 57.4709, GNorm = 0.6907, lr_0 = 1.0352e-04
Loss = 8.8702e-04, PNorm = 57.4775, GNorm = 0.4890, lr_0 = 1.0000e-04
Validation rmse = 0.994744
Epoch 29
Loss = 1.3147e-03, PNorm = 57.4837, GNorm = 0.4296, lr_0 = 1.0000e-04
Loss = 1.0472e-03, PNorm = 57.4909, GNorm = 0.5281, lr_0 = 1.0000e-04
Validation rmse = 1.008282
Model 0 best validation rmse = 0.953200 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.847945
Ensemble test rmse = 0.847945
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.15000000000000002_ffn_num_layers_1_hidden_size_1400/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total scaffolds = 195 | train scaffolds = 76 | val scaffolds = 60 | test scaffolds = 59
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=1404, out_features=1, bias=True)
  )
)
Number of parameters = 4,314,805
Moving model to cuda
Epoch 0
Loss = 1.4722e-02, PNorm = 55.9780, GNorm = 11.7537, lr_0 = 3.6053e-04
Validation rmse = 1.857472
Epoch 1
Loss = 8.0114e-03, PNorm = 56.0374, GNorm = 6.3060, lr_0 = 6.2105e-04
Loss = 7.3186e-03, PNorm = 56.1235, GNorm = 2.7858, lr_0 = 8.5789e-04
Validation rmse = 1.382838
Epoch 2
Loss = 6.5709e-03, PNorm = 56.2212, GNorm = 2.8326, lr_0 = 9.8284e-04
Loss = 4.1922e-03, PNorm = 56.3005, GNorm = 1.1426, lr_0 = 9.4120e-04
Validation rmse = 1.336690
Epoch 3
Loss = 4.1929e-03, PNorm = 56.3678, GNorm = 3.2827, lr_0 = 8.9744e-04
Loss = 3.8699e-03, PNorm = 56.4281, GNorm = 0.9434, lr_0 = 8.5943e-04
Validation rmse = 1.270161
Epoch 4
Loss = 2.3117e-03, PNorm = 56.4795, GNorm = 1.0567, lr_0 = 8.2303e-04
Loss = 3.0038e-03, PNorm = 56.5290, GNorm = 2.2509, lr_0 = 7.8816e-04
Validation rmse = 1.220904
Epoch 5
Loss = 2.2618e-03, PNorm = 56.5722, GNorm = 1.9568, lr_0 = 7.5478e-04
Loss = 2.8128e-03, PNorm = 56.6193, GNorm = 1.3804, lr_0 = 7.2281e-04
Validation rmse = 1.161266
Epoch 6
Loss = 2.4995e-03, PNorm = 56.6607, GNorm = 1.0629, lr_0 = 6.8920e-04
Loss = 2.4100e-03, PNorm = 56.7031, GNorm = 0.8759, lr_0 = 6.6001e-04
Validation rmse = 1.352646
Epoch 7
Loss = 2.4761e-03, PNorm = 56.7360, GNorm = 1.7109, lr_0 = 6.3205e-04
Loss = 2.6786e-03, PNorm = 56.7698, GNorm = 0.8222, lr_0 = 6.0528e-04
Validation rmse = 1.058613
Epoch 8
Loss = 2.3090e-03, PNorm = 56.8088, GNorm = 1.1151, lr_0 = 5.7714e-04
Loss = 1.9327e-03, PNorm = 56.8423, GNorm = 1.6377, lr_0 = 5.5269e-04
Validation rmse = 1.016670
Epoch 9
Loss = 1.5364e-03, PNorm = 56.8725, GNorm = 0.8385, lr_0 = 5.2928e-04
Loss = 1.7508e-03, PNorm = 56.8964, GNorm = 0.5211, lr_0 = 5.0686e-04
Validation rmse = 1.016727
Epoch 10
Loss = 1.5366e-03, PNorm = 56.9237, GNorm = 0.5787, lr_0 = 4.8539e-04
Loss = 1.3748e-03, PNorm = 56.9467, GNorm = 1.0426, lr_0 = 4.6483e-04
Validation rmse = 0.999736
Epoch 11
Loss = 2.1498e-03, PNorm = 56.9701, GNorm = 2.2053, lr_0 = 4.4322e-04
Loss = 1.7658e-03, PNorm = 56.9919, GNorm = 2.5869, lr_0 = 4.2444e-04
Validation rmse = 0.954338
Epoch 12
Loss = 1.2149e-03, PNorm = 57.0152, GNorm = 0.5067, lr_0 = 4.0646e-04
Loss = 1.6904e-03, PNorm = 57.0328, GNorm = 0.8538, lr_0 = 3.8925e-04
Validation rmse = 1.049258
Epoch 13
Loss = 1.8802e-03, PNorm = 57.0529, GNorm = 2.6526, lr_0 = 3.7276e-04
Loss = 1.7315e-03, PNorm = 57.0730, GNorm = 0.6593, lr_0 = 3.5697e-04
Validation rmse = 0.923477
Epoch 14
Loss = 1.4758e-03, PNorm = 57.0962, GNorm = 2.1191, lr_0 = 3.4037e-04
Loss = 1.9904e-03, PNorm = 57.1164, GNorm = 1.0820, lr_0 = 3.2596e-04
Validation rmse = 1.010142
Epoch 15
Loss = 1.6541e-03, PNorm = 57.1320, GNorm = 0.6382, lr_0 = 3.1215e-04
Loss = 1.3722e-03, PNorm = 57.1517, GNorm = 0.7532, lr_0 = 2.9893e-04
Validation rmse = 0.920111
Epoch 16
Loss = 1.1371e-03, PNorm = 57.1669, GNorm = 0.3755, lr_0 = 2.8503e-04
Loss = 1.4999e-03, PNorm = 57.1798, GNorm = 1.0088, lr_0 = 2.7295e-04
Validation rmse = 0.941076
Epoch 17
Loss = 1.1818e-03, PNorm = 57.1949, GNorm = 1.5065, lr_0 = 2.6139e-04
Loss = 1.2827e-03, PNorm = 57.2072, GNorm = 0.5571, lr_0 = 2.5032e-04
Validation rmse = 0.966241
Epoch 18
Loss = 1.3043e-03, PNorm = 57.2195, GNorm = 1.2455, lr_0 = 2.3972e-04
Loss = 1.2293e-03, PNorm = 57.2313, GNorm = 1.8222, lr_0 = 2.2956e-04
Validation rmse = 0.980936
Epoch 19
Loss = 9.2704e-04, PNorm = 57.2450, GNorm = 0.5027, lr_0 = 2.1889e-04
Loss = 1.3360e-03, PNorm = 57.2558, GNorm = 0.6479, lr_0 = 2.0962e-04
Validation rmse = 0.931355
Epoch 20
Loss = 1.1392e-03, PNorm = 57.2670, GNorm = 0.3932, lr_0 = 2.0074e-04
Loss = 1.3450e-03, PNorm = 57.2794, GNorm = 0.8464, lr_0 = 1.9224e-04
Validation rmse = 0.949385
Epoch 21
Loss = 1.0432e-03, PNorm = 57.2896, GNorm = 0.9248, lr_0 = 1.8409e-04
Loss = 1.2433e-03, PNorm = 57.3009, GNorm = 0.8542, lr_0 = 1.7630e-04
Validation rmse = 0.941550
Epoch 22
Loss = 1.2563e-03, PNorm = 57.3129, GNorm = 1.2662, lr_0 = 1.6810e-04
Loss = 1.0528e-03, PNorm = 57.3219, GNorm = 0.7490, lr_0 = 1.6098e-04
Validation rmse = 0.964023
Epoch 23
Loss = 1.1226e-03, PNorm = 57.3301, GNorm = 0.5330, lr_0 = 1.5416e-04
Loss = 1.1002e-03, PNorm = 57.3379, GNorm = 0.7434, lr_0 = 1.4763e-04
Loss = 1.0148e-03, PNorm = 57.3387, GNorm = 0.6645, lr_0 = 1.4699e-04
Validation rmse = 0.922226
Epoch 24
Loss = 1.2272e-03, PNorm = 57.3475, GNorm = 0.5361, lr_0 = 1.4077e-04
Loss = 9.8913e-04, PNorm = 57.3558, GNorm = 0.5794, lr_0 = 1.3480e-04
Validation rmse = 0.931630
Epoch 25
Loss = 9.5284e-04, PNorm = 57.3634, GNorm = 0.6519, lr_0 = 1.2909e-04
Loss = 1.2937e-03, PNorm = 57.3712, GNorm = 1.6302, lr_0 = 1.2362e-04
Validation rmse = 0.926185
Epoch 26
Loss = 1.0691e-03, PNorm = 57.3787, GNorm = 0.6146, lr_0 = 1.1839e-04
Validation rmse = 0.961699
Epoch 27
Loss = 9.8666e-04, PNorm = 57.3855, GNorm = 1.6468, lr_0 = 1.1288e-04
Loss = 9.9279e-04, PNorm = 57.3916, GNorm = 0.6277, lr_0 = 1.0810e-04
Validation rmse = 0.952996
Epoch 28
Loss = 6.4390e-04, PNorm = 57.3980, GNorm = 0.4621, lr_0 = 1.0352e-04
Loss = 1.0948e-03, PNorm = 57.4043, GNorm = 1.0057, lr_0 = 1.0000e-04
Validation rmse = 0.955400
Epoch 29
Loss = 7.7921e-04, PNorm = 57.4102, GNorm = 0.4755, lr_0 = 1.0000e-04
Loss = 1.0537e-03, PNorm = 57.4175, GNorm = 1.0194, lr_0 = 1.0000e-04
Validation rmse = 0.982881
Model 0 best validation rmse = 0.920111 on epoch 15
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.066143
Ensemble test rmse = 1.066143
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.15000000000000002_ffn_num_layers_1_hidden_size_1400/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total scaffolds = 195 | train scaffolds = 55 | val scaffolds = 64 | test scaffolds = 76
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=1404, out_features=1, bias=True)
  )
)
Number of parameters = 4,314,805
Moving model to cuda
Epoch 0
Loss = 1.9136e-02, PNorm = 55.9740, GNorm = 8.6553, lr_0 = 3.6053e-04
Validation rmse = 1.665205
Epoch 1
Loss = 5.5139e-03, PNorm = 56.0389, GNorm = 2.8295, lr_0 = 6.2105e-04
Loss = 6.9405e-03, PNorm = 56.1277, GNorm = 1.0775, lr_0 = 8.5789e-04
Validation rmse = 1.429334
Epoch 2
Loss = 5.1897e-03, PNorm = 56.2167, GNorm = 1.7133, lr_0 = 9.8284e-04
Loss = 4.3305e-03, PNorm = 56.3011, GNorm = 2.1167, lr_0 = 9.4120e-04
Validation rmse = 1.416568
Epoch 3
Loss = 4.3199e-03, PNorm = 56.3740, GNorm = 2.3124, lr_0 = 8.9744e-04
Loss = 3.7725e-03, PNorm = 56.4341, GNorm = 2.7527, lr_0 = 8.5943e-04
Validation rmse = 1.426519
Epoch 4
Loss = 2.4896e-03, PNorm = 56.4885, GNorm = 1.4426, lr_0 = 8.2303e-04
Loss = 3.7878e-03, PNorm = 56.5455, GNorm = 5.7382, lr_0 = 7.8816e-04
Validation rmse = 1.345224
Epoch 5
Loss = 2.6335e-03, PNorm = 56.6012, GNorm = 1.4942, lr_0 = 7.5478e-04
Loss = 2.7312e-03, PNorm = 56.6469, GNorm = 0.8755, lr_0 = 7.2281e-04
Validation rmse = 1.224527
Epoch 6
Loss = 1.7297e-03, PNorm = 56.6984, GNorm = 0.9851, lr_0 = 6.8920e-04
Loss = 2.2923e-03, PNorm = 56.7402, GNorm = 0.5677, lr_0 = 6.6001e-04
Validation rmse = 1.202647
Epoch 7
Loss = 2.3710e-03, PNorm = 56.7770, GNorm = 1.8471, lr_0 = 6.3205e-04
Loss = 1.8017e-03, PNorm = 56.8108, GNorm = 0.8549, lr_0 = 6.0528e-04
Validation rmse = 1.177841
Epoch 8
Loss = 2.8020e-03, PNorm = 56.8486, GNorm = 1.7637, lr_0 = 5.7714e-04
Loss = 2.1980e-03, PNorm = 56.8866, GNorm = 1.0362, lr_0 = 5.5269e-04
Validation rmse = 1.190706
Epoch 9
Loss = 1.7591e-03, PNorm = 56.9139, GNorm = 2.3187, lr_0 = 5.2928e-04
Loss = 1.8757e-03, PNorm = 56.9436, GNorm = 0.9273, lr_0 = 5.0686e-04
Validation rmse = 1.137198
Epoch 10
Loss = 1.7354e-03, PNorm = 56.9678, GNorm = 1.0458, lr_0 = 4.8539e-04
Loss = 1.6351e-03, PNorm = 56.9908, GNorm = 0.6026, lr_0 = 4.6483e-04
Validation rmse = 1.182193
Epoch 11
Loss = 1.8384e-03, PNorm = 57.0116, GNorm = 0.4004, lr_0 = 4.4322e-04
Loss = 1.9116e-03, PNorm = 57.0350, GNorm = 0.6067, lr_0 = 4.2444e-04
Validation rmse = 1.119275
Epoch 12
Loss = 1.6803e-03, PNorm = 57.0579, GNorm = 0.5292, lr_0 = 4.0646e-04
Loss = 1.7159e-03, PNorm = 57.0775, GNorm = 1.1684, lr_0 = 3.8925e-04
Validation rmse = 1.146831
Epoch 13
Loss = 2.2861e-03, PNorm = 57.0930, GNorm = 1.9720, lr_0 = 3.7276e-04
Loss = 1.8548e-03, PNorm = 57.1076, GNorm = 1.5744, lr_0 = 3.5697e-04
Validation rmse = 1.176767
Epoch 14
Loss = 1.8738e-03, PNorm = 57.1282, GNorm = 1.1434, lr_0 = 3.4037e-04
Loss = 1.4813e-03, PNorm = 57.1433, GNorm = 1.0073, lr_0 = 3.2596e-04
Validation rmse = 1.134047
Epoch 15
Loss = 1.7431e-03, PNorm = 57.1583, GNorm = 1.4623, lr_0 = 3.1215e-04
Loss = 1.4911e-03, PNorm = 57.1708, GNorm = 0.7811, lr_0 = 2.9893e-04
Validation rmse = 1.189029
Epoch 16
Loss = 1.5635e-03, PNorm = 57.1860, GNorm = 1.7281, lr_0 = 2.8503e-04
Loss = 1.4785e-03, PNorm = 57.1982, GNorm = 1.3418, lr_0 = 2.7295e-04
Validation rmse = 1.154201
Epoch 17
Loss = 1.3428e-03, PNorm = 57.2121, GNorm = 1.8582, lr_0 = 2.6139e-04
Loss = 1.5117e-03, PNorm = 57.2232, GNorm = 2.4079, lr_0 = 2.5032e-04
Validation rmse = 1.250832
Epoch 18
Loss = 1.4536e-03, PNorm = 57.2383, GNorm = 1.4850, lr_0 = 2.3972e-04
Loss = 1.5684e-03, PNorm = 57.2503, GNorm = 0.7463, lr_0 = 2.2956e-04
Validation rmse = 1.206148
Epoch 19
Loss = 1.9035e-03, PNorm = 57.2647, GNorm = 2.0304, lr_0 = 2.1889e-04
Loss = 1.3994e-03, PNorm = 57.2785, GNorm = 1.5019, lr_0 = 2.0962e-04
Validation rmse = 1.115283
Epoch 20
Loss = 1.3745e-03, PNorm = 57.2858, GNorm = 0.4191, lr_0 = 2.0074e-04
Loss = 1.4319e-03, PNorm = 57.2972, GNorm = 0.9935, lr_0 = 1.9224e-04
Validation rmse = 1.123215
Epoch 21
Loss = 1.3729e-03, PNorm = 57.3053, GNorm = 0.9580, lr_0 = 1.8409e-04
Loss = 1.4813e-03, PNorm = 57.3149, GNorm = 0.9133, lr_0 = 1.7630e-04
Validation rmse = 1.274791
Epoch 22
Loss = 1.5883e-03, PNorm = 57.3244, GNorm = 0.4075, lr_0 = 1.6810e-04
Loss = 1.2318e-03, PNorm = 57.3329, GNorm = 1.3514, lr_0 = 1.6098e-04
Validation rmse = 1.134393
Epoch 23
Loss = 1.0752e-03, PNorm = 57.3414, GNorm = 1.7608, lr_0 = 1.5416e-04
Loss = 1.5165e-03, PNorm = 57.3499, GNorm = 1.3035, lr_0 = 1.4763e-04
Loss = 3.3315e-03, PNorm = 57.3503, GNorm = 1.5161, lr_0 = 1.4699e-04
Validation rmse = 1.145527
Epoch 24
Loss = 1.1425e-03, PNorm = 57.3571, GNorm = 2.2622, lr_0 = 1.4077e-04
Loss = 1.4407e-03, PNorm = 57.3636, GNorm = 0.7708, lr_0 = 1.3480e-04
Validation rmse = 1.194931
Epoch 25
Loss = 1.4789e-03, PNorm = 57.3709, GNorm = 0.4365, lr_0 = 1.2909e-04
Loss = 1.1947e-03, PNorm = 57.3771, GNorm = 1.4525, lr_0 = 1.2362e-04
Validation rmse = 1.134445
Epoch 26
Loss = 1.2775e-03, PNorm = 57.3835, GNorm = 0.6811, lr_0 = 1.1839e-04
Validation rmse = 1.138070
Epoch 27
Loss = 1.1867e-03, PNorm = 57.3900, GNorm = 0.7222, lr_0 = 1.1288e-04
Loss = 1.2156e-03, PNorm = 57.3948, GNorm = 1.0121, lr_0 = 1.0810e-04
Validation rmse = 1.117917
Epoch 28
Loss = 7.9000e-04, PNorm = 57.4001, GNorm = 0.3121, lr_0 = 1.0352e-04
Loss = 1.0142e-03, PNorm = 57.4041, GNorm = 0.8537, lr_0 = 1.0000e-04
Validation rmse = 1.124114
Epoch 29
Loss = 1.3830e-03, PNorm = 57.4107, GNorm = 1.2063, lr_0 = 1.0000e-04
Loss = 1.2419e-03, PNorm = 57.4145, GNorm = 0.8279, lr_0 = 1.0000e-04
Validation rmse = 1.143217
Model 0 best validation rmse = 1.115283 on epoch 19
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.161531
Ensemble test rmse = 1.161531
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.15000000000000002_ffn_num_layers_1_hidden_size_1400/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total scaffolds = 195 | train scaffolds = 80 | val scaffolds = 54 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=1404, out_features=1, bias=True)
  )
)
Number of parameters = 4,314,805
Moving model to cuda
Epoch 0
Loss = 1.2876e-02, PNorm = 55.9828, GNorm = 8.4551, lr_0 = 3.6053e-04
Validation rmse = 1.536683
Epoch 1
Loss = 4.6576e-03, PNorm = 56.0439, GNorm = 1.4594, lr_0 = 6.2105e-04
Loss = 6.7224e-03, PNorm = 56.1231, GNorm = 2.3272, lr_0 = 8.5789e-04
Validation rmse = 1.319801
Epoch 2
Loss = 4.7270e-03, PNorm = 56.2185, GNorm = 2.8141, lr_0 = 9.8284e-04
Loss = 3.9247e-03, PNorm = 56.3035, GNorm = 1.6488, lr_0 = 9.4120e-04
Validation rmse = 1.283758
Epoch 3
Loss = 3.8071e-03, PNorm = 56.3767, GNorm = 2.3349, lr_0 = 8.9744e-04
Loss = 3.1548e-03, PNorm = 56.4340, GNorm = 2.7424, lr_0 = 8.5943e-04
Validation rmse = 1.357776
Epoch 4
Loss = 2.2670e-03, PNorm = 56.4882, GNorm = 0.9811, lr_0 = 8.2303e-04
Loss = 3.7674e-03, PNorm = 56.5448, GNorm = 2.1774, lr_0 = 7.8816e-04
Validation rmse = 1.349039
Epoch 5
Loss = 2.6259e-03, PNorm = 56.5939, GNorm = 0.7374, lr_0 = 7.5478e-04
Loss = 2.3451e-03, PNorm = 56.6359, GNorm = 1.7140, lr_0 = 7.2281e-04
Validation rmse = 1.196755
Epoch 6
Loss = 1.9790e-03, PNorm = 56.6763, GNorm = 0.8020, lr_0 = 6.8920e-04
Loss = 1.9925e-03, PNorm = 56.7093, GNorm = 0.9572, lr_0 = 6.6001e-04
Validation rmse = 1.161965
Epoch 7
Loss = 1.8459e-03, PNorm = 56.7451, GNorm = 1.5725, lr_0 = 6.3205e-04
Loss = 1.8865e-03, PNorm = 56.7758, GNorm = 1.1729, lr_0 = 6.0528e-04
Validation rmse = 1.118035
Epoch 8
Loss = 1.9356e-03, PNorm = 56.8142, GNorm = 0.7477, lr_0 = 5.7714e-04
Loss = 1.6697e-03, PNorm = 56.8446, GNorm = 1.5334, lr_0 = 5.5269e-04
Validation rmse = 1.191719
Epoch 9
Loss = 1.8461e-03, PNorm = 56.8731, GNorm = 0.8083, lr_0 = 5.2928e-04
Loss = 1.6382e-03, PNorm = 56.9005, GNorm = 1.4175, lr_0 = 5.0686e-04
Validation rmse = 1.096628
Epoch 10
Loss = 1.8520e-03, PNorm = 56.9249, GNorm = 1.2060, lr_0 = 4.8539e-04
Loss = 1.4738e-03, PNorm = 56.9497, GNorm = 1.2086, lr_0 = 4.6483e-04
Validation rmse = 1.106386
Epoch 11
Loss = 1.2929e-03, PNorm = 56.9745, GNorm = 2.7145, lr_0 = 4.4322e-04
Loss = 1.6207e-03, PNorm = 56.9963, GNorm = 0.9275, lr_0 = 4.2444e-04
Validation rmse = 1.169300
Epoch 12
Loss = 1.5781e-03, PNorm = 57.0178, GNorm = 0.9611, lr_0 = 4.0646e-04
Loss = 1.5716e-03, PNorm = 57.0406, GNorm = 1.3774, lr_0 = 3.8925e-04
Validation rmse = 1.260285
Epoch 13
Loss = 1.5156e-03, PNorm = 57.0603, GNorm = 1.8198, lr_0 = 3.7276e-04
Loss = 1.4000e-03, PNorm = 57.0780, GNorm = 0.3581, lr_0 = 3.5697e-04
Validation rmse = 1.048315
Epoch 14
Loss = 1.2857e-03, PNorm = 57.0957, GNorm = 2.0822, lr_0 = 3.4037e-04
Loss = 1.2910e-03, PNorm = 57.1136, GNorm = 0.6953, lr_0 = 3.2596e-04
Validation rmse = 1.176014
Epoch 15
Loss = 1.2991e-03, PNorm = 57.1309, GNorm = 1.8801, lr_0 = 3.1215e-04
Loss = 1.4396e-03, PNorm = 57.1449, GNorm = 0.8764, lr_0 = 2.9893e-04
Validation rmse = 1.125028
Epoch 16
Loss = 1.2986e-03, PNorm = 57.1646, GNorm = 1.8990, lr_0 = 2.8503e-04
Loss = 1.3789e-03, PNorm = 57.1836, GNorm = 2.1989, lr_0 = 2.7295e-04
Validation rmse = 1.141395
Epoch 17
Loss = 1.0488e-03, PNorm = 57.1975, GNorm = 0.5934, lr_0 = 2.6139e-04
Loss = 1.2085e-03, PNorm = 57.2116, GNorm = 1.2858, lr_0 = 2.5032e-04
Validation rmse = 1.130533
Epoch 18
Loss = 1.1505e-03, PNorm = 57.2239, GNorm = 1.1113, lr_0 = 2.3972e-04
Loss = 1.1121e-03, PNorm = 57.2375, GNorm = 0.8834, lr_0 = 2.2956e-04
Validation rmse = 1.120325
Epoch 19
Loss = 1.2197e-03, PNorm = 57.2528, GNorm = 0.4133, lr_0 = 2.1889e-04
Loss = 1.1877e-03, PNorm = 57.2650, GNorm = 0.4402, lr_0 = 2.0962e-04
Validation rmse = 1.064123
Epoch 20
Loss = 1.1144e-03, PNorm = 57.2720, GNorm = 0.3959, lr_0 = 2.0074e-04
Loss = 1.2071e-03, PNorm = 57.2825, GNorm = 0.8145, lr_0 = 1.9224e-04
Validation rmse = 1.084113
Epoch 21
Loss = 9.6888e-04, PNorm = 57.2925, GNorm = 0.5266, lr_0 = 1.8409e-04
Loss = 1.0673e-03, PNorm = 57.3010, GNorm = 1.0816, lr_0 = 1.7630e-04
Validation rmse = 1.083465
Epoch 22
Loss = 1.0534e-03, PNorm = 57.3129, GNorm = 0.7191, lr_0 = 1.6810e-04
Loss = 8.8214e-04, PNorm = 57.3221, GNorm = 0.3829, lr_0 = 1.6098e-04
Validation rmse = 1.060418
Epoch 23
Loss = 9.8079e-04, PNorm = 57.3281, GNorm = 0.7252, lr_0 = 1.5416e-04
Loss = 1.0484e-03, PNorm = 57.3367, GNorm = 0.7470, lr_0 = 1.4763e-04
Loss = 1.0238e-03, PNorm = 57.3377, GNorm = 0.6927, lr_0 = 1.4699e-04
Validation rmse = 1.036431
Epoch 24
Loss = 9.9173e-04, PNorm = 57.3458, GNorm = 1.0106, lr_0 = 1.4077e-04
Loss = 9.9516e-04, PNorm = 57.3547, GNorm = 0.7001, lr_0 = 1.3480e-04
Validation rmse = 1.082189
Epoch 25
Loss = 9.1146e-04, PNorm = 57.3620, GNorm = 0.4367, lr_0 = 1.2909e-04
Loss = 9.3033e-04, PNorm = 57.3694, GNorm = 0.9697, lr_0 = 1.2362e-04
Validation rmse = 1.059290
Epoch 26
Loss = 9.9114e-04, PNorm = 57.3746, GNorm = 0.6934, lr_0 = 1.1839e-04
Validation rmse = 1.077571
Epoch 27
Loss = 1.2902e-03, PNorm = 57.3812, GNorm = 0.3572, lr_0 = 1.1288e-04
Loss = 9.5420e-04, PNorm = 57.3892, GNorm = 0.3691, lr_0 = 1.0810e-04
Validation rmse = 1.091371
Epoch 28
Loss = 9.1464e-04, PNorm = 57.3939, GNorm = 0.3312, lr_0 = 1.0352e-04
Loss = 8.9347e-04, PNorm = 57.3990, GNorm = 0.5953, lr_0 = 1.0000e-04
Validation rmse = 1.060973
Epoch 29
Loss = 7.4442e-04, PNorm = 57.4045, GNorm = 0.3286, lr_0 = 1.0000e-04
Loss = 8.1984e-04, PNorm = 57.4099, GNorm = 0.4250, lr_0 = 1.0000e-04
Validation rmse = 1.070492
Model 0 best validation rmse = 1.036431 on epoch 23
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.003586
Ensemble test rmse = 1.003586
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.15000000000000002_ffn_num_layers_1_hidden_size_1400/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 49 | test scaffolds = 62
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=1404, out_features=1, bias=True)
  )
)
Number of parameters = 4,314,805
Moving model to cuda
Epoch 0
Loss = 1.3047e-02, PNorm = 55.9782, GNorm = 12.4660, lr_0 = 3.6053e-04
Validation rmse = 1.442771
Epoch 1
Loss = 7.3383e-03, PNorm = 56.0452, GNorm = 3.6022, lr_0 = 6.2105e-04
Loss = 5.7775e-03, PNorm = 56.1234, GNorm = 7.0024, lr_0 = 8.5789e-04
Validation rmse = 1.387364
Epoch 2
Loss = 4.3644e-03, PNorm = 56.2191, GNorm = 2.1358, lr_0 = 9.8284e-04
Loss = 4.7663e-03, PNorm = 56.3026, GNorm = 1.9201, lr_0 = 9.4120e-04
Validation rmse = 1.209393
Epoch 3
Loss = 3.1936e-03, PNorm = 56.3824, GNorm = 1.5301, lr_0 = 8.9744e-04
Loss = 3.1935e-03, PNorm = 56.4402, GNorm = 1.0414, lr_0 = 8.5943e-04
Validation rmse = 1.144547
Epoch 4
Loss = 2.9346e-03, PNorm = 56.4948, GNorm = 0.9003, lr_0 = 8.2303e-04
Loss = 3.1123e-03, PNorm = 56.5496, GNorm = 3.0567, lr_0 = 7.8816e-04
Validation rmse = 1.250258
Epoch 5
Loss = 2.8384e-03, PNorm = 56.6013, GNorm = 3.2065, lr_0 = 7.5478e-04
Loss = 3.2921e-03, PNorm = 56.6531, GNorm = 3.4667, lr_0 = 7.2281e-04
Validation rmse = 1.017953
Epoch 6
Loss = 1.9799e-03, PNorm = 56.7082, GNorm = 1.1242, lr_0 = 6.8920e-04
Loss = 2.2409e-03, PNorm = 56.7471, GNorm = 0.5664, lr_0 = 6.6001e-04
Validation rmse = 0.971638
Epoch 7
Loss = 1.4237e-03, PNorm = 56.7783, GNorm = 1.0849, lr_0 = 6.3205e-04
Loss = 2.4576e-03, PNorm = 56.8155, GNorm = 0.4310, lr_0 = 6.0528e-04
Validation rmse = 1.357802
Epoch 8
Loss = 2.2789e-03, PNorm = 56.8522, GNorm = 1.3067, lr_0 = 5.7714e-04
Loss = 1.8713e-03, PNorm = 56.8862, GNorm = 0.7767, lr_0 = 5.5269e-04
Validation rmse = 0.995520
Epoch 9
Loss = 1.4503e-03, PNorm = 56.9146, GNorm = 0.4371, lr_0 = 5.2928e-04
Loss = 1.9960e-03, PNorm = 56.9364, GNorm = 0.4145, lr_0 = 5.0686e-04
Validation rmse = 0.991722
Epoch 10
Loss = 2.1229e-03, PNorm = 56.9598, GNorm = 2.3609, lr_0 = 4.8539e-04
Loss = 1.9846e-03, PNorm = 56.9834, GNorm = 0.5279, lr_0 = 4.6483e-04
Validation rmse = 1.115617
Epoch 11
Loss = 1.7564e-03, PNorm = 57.0072, GNorm = 0.5864, lr_0 = 4.4322e-04
Loss = 1.5519e-03, PNorm = 57.0280, GNorm = 1.3427, lr_0 = 4.2444e-04
Validation rmse = 1.010180
Epoch 12
Loss = 1.2192e-03, PNorm = 57.0450, GNorm = 0.7291, lr_0 = 4.0646e-04
Loss = 1.6696e-03, PNorm = 57.0626, GNorm = 0.5287, lr_0 = 3.8925e-04
Validation rmse = 0.945668
Epoch 13
Loss = 1.1635e-03, PNorm = 57.0793, GNorm = 0.7609, lr_0 = 3.7276e-04
Loss = 1.7531e-03, PNorm = 57.0981, GNorm = 1.2870, lr_0 = 3.5697e-04
Validation rmse = 0.903415
Epoch 14
Loss = 1.4228e-03, PNorm = 57.1137, GNorm = 1.2330, lr_0 = 3.4037e-04
Loss = 1.6141e-03, PNorm = 57.1304, GNorm = 1.8626, lr_0 = 3.2596e-04
Validation rmse = 0.973362
Epoch 15
Loss = 1.1530e-03, PNorm = 57.1445, GNorm = 0.3545, lr_0 = 3.1215e-04
Loss = 1.5130e-03, PNorm = 57.1586, GNorm = 0.7215, lr_0 = 2.9893e-04
Validation rmse = 1.004316
Epoch 16
Loss = 1.1157e-03, PNorm = 57.1727, GNorm = 1.1387, lr_0 = 2.8503e-04
Loss = 1.6269e-03, PNorm = 57.1832, GNorm = 1.0513, lr_0 = 2.7295e-04
Validation rmse = 0.935461
Epoch 17
Loss = 1.2097e-03, PNorm = 57.1965, GNorm = 0.7580, lr_0 = 2.6139e-04
Loss = 1.4219e-03, PNorm = 57.2057, GNorm = 0.8904, lr_0 = 2.5032e-04
Validation rmse = 0.973096
Epoch 18
Loss = 1.5989e-03, PNorm = 57.2190, GNorm = 1.5151, lr_0 = 2.3972e-04
Loss = 1.2674e-03, PNorm = 57.2340, GNorm = 1.0494, lr_0 = 2.2956e-04
Validation rmse = 0.985465
Epoch 19
Loss = 1.3047e-03, PNorm = 57.2442, GNorm = 0.9382, lr_0 = 2.1889e-04
Loss = 1.3809e-03, PNorm = 57.2563, GNorm = 0.7742, lr_0 = 2.0962e-04
Validation rmse = 1.032210
Epoch 20
Loss = 1.3078e-03, PNorm = 57.2659, GNorm = 0.7776, lr_0 = 2.0074e-04
Loss = 1.2792e-03, PNorm = 57.2754, GNorm = 1.8922, lr_0 = 1.9224e-04
Validation rmse = 1.110524
Epoch 21
Loss = 1.2889e-03, PNorm = 57.2844, GNorm = 1.0195, lr_0 = 1.8409e-04
Loss = 1.4147e-03, PNorm = 57.2939, GNorm = 1.5772, lr_0 = 1.7630e-04
Validation rmse = 1.020345
Epoch 22
Loss = 1.1029e-03, PNorm = 57.3034, GNorm = 1.1599, lr_0 = 1.6810e-04
Loss = 1.3612e-03, PNorm = 57.3102, GNorm = 0.6965, lr_0 = 1.6098e-04
Validation rmse = 0.959762
Epoch 23
Loss = 1.2602e-03, PNorm = 57.3170, GNorm = 1.1402, lr_0 = 1.5416e-04
Loss = 1.1216e-03, PNorm = 57.3244, GNorm = 0.3543, lr_0 = 1.4763e-04
Loss = 1.8515e-03, PNorm = 57.3253, GNorm = 0.7845, lr_0 = 1.4699e-04
Validation rmse = 0.887909
Epoch 24
Loss = 1.0665e-03, PNorm = 57.3331, GNorm = 0.5616, lr_0 = 1.4077e-04
Loss = 1.3754e-03, PNorm = 57.3393, GNorm = 0.8528, lr_0 = 1.3480e-04
Validation rmse = 1.023998
Epoch 25
Loss = 9.9270e-04, PNorm = 57.3455, GNorm = 1.1048, lr_0 = 1.2909e-04
Loss = 1.3664e-03, PNorm = 57.3519, GNorm = 1.1311, lr_0 = 1.2362e-04
Validation rmse = 0.869986
Epoch 26
Loss = 1.0780e-03, PNorm = 57.3576, GNorm = 0.3308, lr_0 = 1.1839e-04
Validation rmse = 0.905975
Epoch 27
Loss = 1.0830e-03, PNorm = 57.3654, GNorm = 0.7522, lr_0 = 1.1288e-04
Loss = 9.1364e-04, PNorm = 57.3694, GNorm = 0.6327, lr_0 = 1.0810e-04
Validation rmse = 0.856020
Epoch 28
Loss = 6.7659e-04, PNorm = 57.3753, GNorm = 1.5352, lr_0 = 1.0352e-04
Loss = 1.1453e-03, PNorm = 57.3797, GNorm = 1.0029, lr_0 = 1.0000e-04
Validation rmse = 1.039839
Epoch 29
Loss = 9.8526e-04, PNorm = 57.3849, GNorm = 1.3212, lr_0 = 1.0000e-04
Loss = 1.0786e-03, PNorm = 57.3905, GNorm = 0.7259, lr_0 = 1.0000e-04
Validation rmse = 0.865151
Model 0 best validation rmse = 0.856020 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.059442
Ensemble test rmse = 1.059442
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.15000000000000002_ffn_num_layers_1_hidden_size_1400/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total scaffolds = 195 | train scaffolds = 94 | val scaffolds = 55 | test scaffolds = 46
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=1404, out_features=1, bias=True)
  )
)
Number of parameters = 4,314,805
Moving model to cuda
Epoch 0
Loss = 1.1551e-02, PNorm = 55.9835, GNorm = 3.2727, lr_0 = 3.6053e-04
Validation rmse = 2.049266
Epoch 1
Loss = 8.6191e-03, PNorm = 56.0449, GNorm = 8.7267, lr_0 = 6.2105e-04
Loss = 5.5969e-03, PNorm = 56.1206, GNorm = 5.2543, lr_0 = 8.5789e-04
Validation rmse = 1.686323
Epoch 2
Loss = 4.9305e-03, PNorm = 56.2249, GNorm = 1.8221, lr_0 = 9.8284e-04
Loss = 4.1193e-03, PNorm = 56.3124, GNorm = 2.2825, lr_0 = 9.4120e-04
Validation rmse = 1.688577
Epoch 3
Loss = 5.3972e-03, PNorm = 56.3835, GNorm = 2.6560, lr_0 = 8.9744e-04
Loss = 3.7136e-03, PNorm = 56.4469, GNorm = 2.5996, lr_0 = 8.5943e-04
Validation rmse = 1.444837
Epoch 4
Loss = 2.3588e-03, PNorm = 56.4974, GNorm = 0.8188, lr_0 = 8.2303e-04
Loss = 2.6895e-03, PNorm = 56.5537, GNorm = 1.7823, lr_0 = 7.8816e-04
Validation rmse = 1.384177
Epoch 5
Loss = 2.4981e-03, PNorm = 56.5981, GNorm = 1.4265, lr_0 = 7.5478e-04
Loss = 2.5224e-03, PNorm = 56.6416, GNorm = 2.0967, lr_0 = 7.2281e-04
Validation rmse = 1.283923
Epoch 6
Loss = 2.8764e-03, PNorm = 56.6887, GNorm = 2.1242, lr_0 = 6.8920e-04
Loss = 2.4902e-03, PNorm = 56.7363, GNorm = 2.8916, lr_0 = 6.6001e-04
Validation rmse = 1.290322
Epoch 7
Loss = 2.1463e-03, PNorm = 56.7765, GNorm = 1.6812, lr_0 = 6.3205e-04
Loss = 2.0194e-03, PNorm = 56.8172, GNorm = 0.8935, lr_0 = 6.0528e-04
Validation rmse = 1.284273
Epoch 8
Loss = 2.1491e-03, PNorm = 56.8522, GNorm = 1.1059, lr_0 = 5.7714e-04
Loss = 2.0549e-03, PNorm = 56.8896, GNorm = 1.1044, lr_0 = 5.5269e-04
Validation rmse = 1.232769
Epoch 9
Loss = 1.9986e-03, PNorm = 56.9152, GNorm = 0.6042, lr_0 = 5.2928e-04
Loss = 1.9326e-03, PNorm = 56.9451, GNorm = 0.4290, lr_0 = 5.0686e-04
Validation rmse = 1.237184
Epoch 10
Loss = 1.6614e-03, PNorm = 56.9731, GNorm = 1.3401, lr_0 = 4.8539e-04
Loss = 1.7895e-03, PNorm = 56.9994, GNorm = 2.6247, lr_0 = 4.6483e-04
Validation rmse = 1.309516
Epoch 11
Loss = 1.4858e-03, PNorm = 57.0297, GNorm = 0.5694, lr_0 = 4.4322e-04
Loss = 1.5412e-03, PNorm = 57.0550, GNorm = 1.4181, lr_0 = 4.2444e-04
Validation rmse = 1.235017
Epoch 12
Loss = 1.3665e-03, PNorm = 57.0789, GNorm = 1.1779, lr_0 = 4.0646e-04
Loss = 1.7376e-03, PNorm = 57.1017, GNorm = 1.3427, lr_0 = 3.8925e-04
Validation rmse = 1.285991
Epoch 13
Loss = 1.4807e-03, PNorm = 57.1210, GNorm = 1.8961, lr_0 = 3.7276e-04
Loss = 1.3588e-03, PNorm = 57.1335, GNorm = 0.6011, lr_0 = 3.5697e-04
Validation rmse = 1.184005
Epoch 14
Loss = 1.5261e-03, PNorm = 57.1543, GNorm = 1.2393, lr_0 = 3.4037e-04
Loss = 1.3077e-03, PNorm = 57.1720, GNorm = 0.5400, lr_0 = 3.2596e-04
Validation rmse = 1.166819
Epoch 15
Loss = 1.4526e-03, PNorm = 57.1912, GNorm = 0.7716, lr_0 = 3.1215e-04
Loss = 1.4073e-03, PNorm = 57.2096, GNorm = 0.6020, lr_0 = 2.9893e-04
Validation rmse = 1.174136
Epoch 16
Loss = 1.2654e-03, PNorm = 57.2254, GNorm = 0.6351, lr_0 = 2.8503e-04
Loss = 1.4437e-03, PNorm = 57.2415, GNorm = 1.2108, lr_0 = 2.7295e-04
Validation rmse = 1.243668
Epoch 17
Loss = 1.2875e-03, PNorm = 57.2582, GNorm = 0.6146, lr_0 = 2.6139e-04
Loss = 1.2616e-03, PNorm = 57.2689, GNorm = 0.3242, lr_0 = 2.5032e-04
Validation rmse = 1.139117
Epoch 18
Loss = 1.2213e-03, PNorm = 57.2819, GNorm = 1.1067, lr_0 = 2.3972e-04
Loss = 1.2304e-03, PNorm = 57.2976, GNorm = 0.5943, lr_0 = 2.2956e-04
Validation rmse = 1.152912
Epoch 19
Loss = 1.0568e-03, PNorm = 57.3101, GNorm = 0.7780, lr_0 = 2.1889e-04
Loss = 1.3273e-03, PNorm = 57.3220, GNorm = 0.3641, lr_0 = 2.0962e-04
Validation rmse = 1.185336
Epoch 20
Loss = 1.3969e-03, PNorm = 57.3353, GNorm = 1.3528, lr_0 = 2.0074e-04
Loss = 1.4131e-03, PNorm = 57.3454, GNorm = 0.7098, lr_0 = 1.9224e-04
Validation rmse = 1.183414
Epoch 21
Loss = 1.2147e-03, PNorm = 57.3564, GNorm = 1.9438, lr_0 = 1.8409e-04
Loss = 1.3303e-03, PNorm = 57.3686, GNorm = 1.9559, lr_0 = 1.7630e-04
Validation rmse = 1.219620
Epoch 22
Loss = 1.0016e-03, PNorm = 57.3790, GNorm = 0.6285, lr_0 = 1.6810e-04
Loss = 1.2917e-03, PNorm = 57.3891, GNorm = 0.7052, lr_0 = 1.6098e-04
Validation rmse = 1.138996
Epoch 23
Loss = 1.2368e-03, PNorm = 57.3978, GNorm = 0.5040, lr_0 = 1.5416e-04
Loss = 1.0390e-03, PNorm = 57.4058, GNorm = 0.6848, lr_0 = 1.4763e-04
Loss = 6.8465e-04, PNorm = 57.4064, GNorm = 0.4427, lr_0 = 1.4699e-04
Validation rmse = 1.238375
Epoch 24
Loss = 1.1562e-03, PNorm = 57.4138, GNorm = 1.0856, lr_0 = 1.4077e-04
Loss = 1.3068e-03, PNorm = 57.4220, GNorm = 0.4577, lr_0 = 1.3480e-04
Validation rmse = 1.230847
Epoch 25
Loss = 1.0918e-03, PNorm = 57.4292, GNorm = 1.6657, lr_0 = 1.2909e-04
Loss = 1.2755e-03, PNorm = 57.4361, GNorm = 1.1849, lr_0 = 1.2362e-04
Validation rmse = 1.122825
Epoch 26
Loss = 1.0138e-03, PNorm = 57.4435, GNorm = 0.7446, lr_0 = 1.1839e-04
Validation rmse = 1.138594
Epoch 27
Loss = 1.2409e-03, PNorm = 57.4516, GNorm = 0.5261, lr_0 = 1.1288e-04
Loss = 9.5833e-04, PNorm = 57.4574, GNorm = 0.5173, lr_0 = 1.0810e-04
Validation rmse = 1.132480
Epoch 28
Loss = 1.0697e-03, PNorm = 57.4636, GNorm = 0.4317, lr_0 = 1.0352e-04
Loss = 1.1298e-03, PNorm = 57.4688, GNorm = 0.7346, lr_0 = 1.0000e-04
Validation rmse = 1.122049
Epoch 29
Loss = 9.4544e-04, PNorm = 57.4745, GNorm = 0.4910, lr_0 = 1.0000e-04
Loss = 9.5509e-04, PNorm = 57.4807, GNorm = 1.0954, lr_0 = 1.0000e-04
Validation rmse = 1.143140
Model 0 best validation rmse = 1.122049 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.180387
Ensemble test rmse = 1.180387
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.15000000000000002_ffn_num_layers_1_hidden_size_1400/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total scaffolds = 195 | train scaffolds = 64 | val scaffolds = 68 | test scaffolds = 63
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=1404, out_features=1, bias=True)
  )
)
Number of parameters = 4,314,805
Moving model to cuda
Epoch 0
Loss = 1.5699e-02, PNorm = 55.9774, GNorm = 5.4844, lr_0 = 3.6053e-04
Validation rmse = 1.593103
Epoch 1
Loss = 6.0061e-03, PNorm = 56.0445, GNorm = 1.6983, lr_0 = 6.2105e-04
Loss = 6.4635e-03, PNorm = 56.1317, GNorm = 3.2610, lr_0 = 8.5789e-04
Validation rmse = 1.676261
Epoch 2
Loss = 5.9204e-03, PNorm = 56.2320, GNorm = 2.5234, lr_0 = 9.8284e-04
Loss = 5.2381e-03, PNorm = 56.3173, GNorm = 1.1610, lr_0 = 9.4120e-04
Validation rmse = 1.297791
Epoch 3
Loss = 3.1501e-03, PNorm = 56.3971, GNorm = 2.1558, lr_0 = 8.9744e-04
Loss = 3.4903e-03, PNorm = 56.4601, GNorm = 0.7581, lr_0 = 8.5943e-04
Validation rmse = 1.341111
Epoch 4
Loss = 2.5806e-03, PNorm = 56.5156, GNorm = 0.8106, lr_0 = 8.2303e-04
Loss = 3.2727e-03, PNorm = 56.5799, GNorm = 1.4271, lr_0 = 7.8816e-04
Validation rmse = 1.421121
Epoch 5
Loss = 2.9643e-03, PNorm = 56.6324, GNorm = 1.1273, lr_0 = 7.5478e-04
Loss = 2.8863e-03, PNorm = 56.6798, GNorm = 1.0012, lr_0 = 7.2281e-04
Validation rmse = 1.289631
Epoch 6
Loss = 2.6175e-03, PNorm = 56.7332, GNorm = 2.7827, lr_0 = 6.8920e-04
Loss = 2.3644e-03, PNorm = 56.7866, GNorm = 1.4231, lr_0 = 6.6001e-04
Validation rmse = 1.201753
Epoch 7
Loss = 2.7373e-03, PNorm = 56.8295, GNorm = 1.0525, lr_0 = 6.3205e-04
Loss = 1.9011e-03, PNorm = 56.8652, GNorm = 1.0240, lr_0 = 6.0528e-04
Validation rmse = 1.217807
Epoch 8
Loss = 1.9391e-03, PNorm = 56.9035, GNorm = 0.8044, lr_0 = 5.7714e-04
Loss = 2.2996e-03, PNorm = 56.9383, GNorm = 0.7282, lr_0 = 5.5269e-04
Validation rmse = 1.353400
Epoch 9
Loss = 2.1169e-03, PNorm = 56.9698, GNorm = 2.3289, lr_0 = 5.2928e-04
Loss = 1.7285e-03, PNorm = 57.0028, GNorm = 0.7599, lr_0 = 5.0686e-04
Validation rmse = 1.111559
Epoch 10
Loss = 1.6609e-03, PNorm = 57.0340, GNorm = 0.9099, lr_0 = 4.8539e-04
Loss = 1.4051e-03, PNorm = 57.0628, GNorm = 0.4700, lr_0 = 4.6483e-04
Validation rmse = 1.095266
Epoch 11
Loss = 1.5990e-03, PNorm = 57.0900, GNorm = 0.2425, lr_0 = 4.4322e-04
Loss = 1.2823e-03, PNorm = 57.1147, GNorm = 0.7764, lr_0 = 4.2444e-04
Validation rmse = 1.074701
Epoch 12
Loss = 1.2431e-03, PNorm = 57.1350, GNorm = 0.5344, lr_0 = 4.0646e-04
Loss = 1.6122e-03, PNorm = 57.1556, GNorm = 0.9345, lr_0 = 3.8925e-04
Validation rmse = 1.109373
Epoch 13
Loss = 1.3067e-03, PNorm = 57.1771, GNorm = 0.9390, lr_0 = 3.7276e-04
Loss = 1.5110e-03, PNorm = 57.1993, GNorm = 1.0668, lr_0 = 3.5697e-04
Validation rmse = 1.236621
Epoch 14
Loss = 1.3722e-03, PNorm = 57.2216, GNorm = 1.4063, lr_0 = 3.4037e-04
Loss = 1.6017e-03, PNorm = 57.2414, GNorm = 0.6374, lr_0 = 3.2596e-04
Validation rmse = 1.069164
Epoch 15
Loss = 1.3386e-03, PNorm = 57.2562, GNorm = 1.2061, lr_0 = 3.1215e-04
Loss = 1.3543e-03, PNorm = 57.2722, GNorm = 2.0464, lr_0 = 2.9893e-04
Validation rmse = 1.086045
Epoch 16
Loss = 1.2676e-03, PNorm = 57.2927, GNorm = 0.4566, lr_0 = 2.8503e-04
Loss = 1.3263e-03, PNorm = 57.3069, GNorm = 2.4407, lr_0 = 2.7295e-04
Validation rmse = 1.166422
Epoch 17
Loss = 1.3233e-03, PNorm = 57.3226, GNorm = 0.4586, lr_0 = 2.6139e-04
Loss = 1.2488e-03, PNorm = 57.3339, GNorm = 1.4557, lr_0 = 2.5032e-04
Validation rmse = 1.168886
Epoch 18
Loss = 1.6310e-03, PNorm = 57.3504, GNorm = 2.0484, lr_0 = 2.3972e-04
Loss = 1.1645e-03, PNorm = 57.3643, GNorm = 0.9994, lr_0 = 2.2956e-04
Validation rmse = 1.138911
Epoch 19
Loss = 1.1925e-03, PNorm = 57.3798, GNorm = 0.6410, lr_0 = 2.1889e-04
Loss = 1.2474e-03, PNorm = 57.3916, GNorm = 0.7211, lr_0 = 2.0962e-04
Validation rmse = 1.146509
Epoch 20
Loss = 1.0807e-03, PNorm = 57.4013, GNorm = 0.3884, lr_0 = 2.0074e-04
Loss = 1.1759e-03, PNorm = 57.4109, GNorm = 1.1829, lr_0 = 1.9224e-04
Validation rmse = 1.143025
Epoch 21
Loss = 9.7021e-04, PNorm = 57.4226, GNorm = 0.9759, lr_0 = 1.8409e-04
Loss = 1.2086e-03, PNorm = 57.4326, GNorm = 0.8165, lr_0 = 1.7630e-04
Validation rmse = 1.117536
Epoch 22
Loss = 1.1572e-03, PNorm = 57.4422, GNorm = 0.5543, lr_0 = 1.6810e-04
Loss = 1.0197e-03, PNorm = 57.4507, GNorm = 0.7641, lr_0 = 1.6098e-04
Validation rmse = 1.084808
Epoch 23
Loss = 1.0026e-03, PNorm = 57.4600, GNorm = 0.3583, lr_0 = 1.5416e-04
Loss = 9.6613e-04, PNorm = 57.4680, GNorm = 0.6550, lr_0 = 1.4763e-04
Loss = 2.1803e-03, PNorm = 57.4687, GNorm = 0.9555, lr_0 = 1.4699e-04
Validation rmse = 1.072813
Epoch 24
Loss = 1.0483e-03, PNorm = 57.4774, GNorm = 0.5843, lr_0 = 1.4077e-04
Loss = 9.7327e-04, PNorm = 57.4853, GNorm = 1.1186, lr_0 = 1.3480e-04
Validation rmse = 1.092139
Epoch 25
Loss = 9.3588e-04, PNorm = 57.4919, GNorm = 0.8300, lr_0 = 1.2909e-04
Loss = 9.5765e-04, PNorm = 57.4980, GNorm = 0.5226, lr_0 = 1.2362e-04
Validation rmse = 1.061157
Epoch 26
Loss = 8.7265e-04, PNorm = 57.5033, GNorm = 0.4300, lr_0 = 1.1839e-04
Validation rmse = 1.064085
Epoch 27
Loss = 1.8312e-03, PNorm = 57.5103, GNorm = 1.1680, lr_0 = 1.1288e-04
Loss = 8.3074e-04, PNorm = 57.5161, GNorm = 0.4487, lr_0 = 1.0810e-04
Validation rmse = 1.058088
Epoch 28
Loss = 1.0742e-03, PNorm = 57.5227, GNorm = 1.5110, lr_0 = 1.0352e-04
Loss = 1.0488e-03, PNorm = 57.5277, GNorm = 1.2124, lr_0 = 1.0000e-04
Validation rmse = 1.112534
Epoch 29
Loss = 8.2283e-04, PNorm = 57.5344, GNorm = 0.9919, lr_0 = 1.0000e-04
Loss = 9.7066e-04, PNorm = 57.5406, GNorm = 1.2029, lr_0 = 1.0000e-04
Validation rmse = 1.064248
Model 0 best validation rmse = 1.058088 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.985323
Ensemble test rmse = 0.985323
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.15000000000000002_ffn_num_layers_1_hidden_size_1400/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total scaffolds = 195 | train scaffolds = 69 | val scaffolds = 65 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=1404, out_features=1, bias=True)
  )
)
Number of parameters = 4,314,805
Moving model to cuda
Epoch 0
Loss = 1.5739e-02, PNorm = 55.9750, GNorm = 8.2854, lr_0 = 3.6053e-04
Validation rmse = 2.210304
Epoch 1
Loss = 7.4588e-03, PNorm = 56.0385, GNorm = 2.8396, lr_0 = 6.2105e-04
Loss = 6.5709e-03, PNorm = 56.1268, GNorm = 2.6895, lr_0 = 8.5789e-04
Validation rmse = 1.704910
Epoch 2
Loss = 3.6991e-03, PNorm = 56.2272, GNorm = 0.8968, lr_0 = 9.8284e-04
Loss = 4.7556e-03, PNorm = 56.3159, GNorm = 2.7116, lr_0 = 9.4120e-04
Validation rmse = 1.606653
Epoch 3
Loss = 4.3658e-03, PNorm = 56.3949, GNorm = 5.0723, lr_0 = 8.9744e-04
Loss = 4.5981e-03, PNorm = 56.4656, GNorm = 3.4320, lr_0 = 8.5943e-04
Validation rmse = 1.602404
Epoch 4
Loss = 3.1553e-03, PNorm = 56.5249, GNorm = 1.6880, lr_0 = 8.2303e-04
Loss = 3.5147e-03, PNorm = 56.5829, GNorm = 1.9178, lr_0 = 7.8816e-04
Validation rmse = 1.489962
Epoch 5
Loss = 2.1706e-03, PNorm = 56.6390, GNorm = 0.9639, lr_0 = 7.5478e-04
Loss = 2.2686e-03, PNorm = 56.6880, GNorm = 0.3411, lr_0 = 7.2281e-04
Validation rmse = 1.671745
Epoch 6
Loss = 3.2673e-03, PNorm = 56.7384, GNorm = 3.9109, lr_0 = 6.8920e-04
Loss = 2.7578e-03, PNorm = 56.7878, GNorm = 0.7438, lr_0 = 6.6001e-04
Validation rmse = 1.588686
Epoch 7
Loss = 2.3358e-03, PNorm = 56.8297, GNorm = 2.6596, lr_0 = 6.3205e-04
Loss = 2.6750e-03, PNorm = 56.8688, GNorm = 1.3066, lr_0 = 6.0528e-04
Validation rmse = 1.485462
Epoch 8
Loss = 1.8563e-03, PNorm = 56.9064, GNorm = 0.8447, lr_0 = 5.7714e-04
Loss = 2.0944e-03, PNorm = 56.9345, GNorm = 1.1437, lr_0 = 5.5269e-04
Validation rmse = 1.491714
Epoch 9
Loss = 1.6866e-03, PNorm = 56.9614, GNorm = 0.5369, lr_0 = 5.2928e-04
Loss = 1.7964e-03, PNorm = 56.9867, GNorm = 0.8896, lr_0 = 5.0686e-04
Validation rmse = 1.467955
Epoch 10
Loss = 1.8399e-03, PNorm = 57.0091, GNorm = 0.7422, lr_0 = 4.8539e-04
Loss = 1.7120e-03, PNorm = 57.0340, GNorm = 1.1950, lr_0 = 4.6483e-04
Validation rmse = 1.562113
Epoch 11
Loss = 1.5927e-03, PNorm = 57.0586, GNorm = 1.3361, lr_0 = 4.4322e-04
Loss = 1.5640e-03, PNorm = 57.0772, GNorm = 1.2790, lr_0 = 4.2444e-04
Validation rmse = 1.433949
Epoch 12
Loss = 1.3783e-03, PNorm = 57.0971, GNorm = 0.4627, lr_0 = 4.0646e-04
Loss = 1.3475e-03, PNorm = 57.1156, GNorm = 0.9117, lr_0 = 3.8925e-04
Validation rmse = 1.384597
Epoch 13
Loss = 1.8041e-03, PNorm = 57.1350, GNorm = 1.9887, lr_0 = 3.7276e-04
Loss = 1.9827e-03, PNorm = 57.1540, GNorm = 0.7292, lr_0 = 3.5697e-04
Validation rmse = 1.731545
Epoch 14
Loss = 1.7146e-03, PNorm = 57.1741, GNorm = 2.3034, lr_0 = 3.4037e-04
Loss = 1.4400e-03, PNorm = 57.1900, GNorm = 0.4242, lr_0 = 3.2596e-04
Validation rmse = 1.549005
Epoch 15
Loss = 1.1122e-03, PNorm = 57.2061, GNorm = 0.5058, lr_0 = 3.1215e-04
Loss = 1.5782e-03, PNorm = 57.2215, GNorm = 0.7576, lr_0 = 2.9893e-04
Validation rmse = 1.644306
Epoch 16
Loss = 1.2927e-03, PNorm = 57.2424, GNorm = 0.4250, lr_0 = 2.8503e-04
Loss = 1.2678e-03, PNorm = 57.2575, GNorm = 0.3922, lr_0 = 2.7295e-04
Validation rmse = 1.576772
Epoch 17
Loss = 1.2794e-03, PNorm = 57.2726, GNorm = 0.9779, lr_0 = 2.6139e-04
Loss = 1.3577e-03, PNorm = 57.2861, GNorm = 1.1043, lr_0 = 2.5032e-04
Validation rmse = 1.401084
Epoch 18
Loss = 1.1771e-03, PNorm = 57.2967, GNorm = 0.6541, lr_0 = 2.3972e-04
Loss = 1.3862e-03, PNorm = 57.3093, GNorm = 0.5518, lr_0 = 2.2956e-04
Validation rmse = 1.492551
Epoch 19
Loss = 1.2384e-03, PNorm = 57.3240, GNorm = 0.9478, lr_0 = 2.1889e-04
Loss = 1.1326e-03, PNorm = 57.3367, GNorm = 0.4772, lr_0 = 2.0962e-04
Validation rmse = 1.433873
Epoch 20
Loss = 1.4782e-03, PNorm = 57.3487, GNorm = 1.0877, lr_0 = 2.0074e-04
Loss = 9.9432e-04, PNorm = 57.3580, GNorm = 0.9329, lr_0 = 1.9224e-04
Validation rmse = 1.514094
Epoch 21
Loss = 1.1361e-03, PNorm = 57.3682, GNorm = 1.2749, lr_0 = 1.8409e-04
Loss = 1.2211e-03, PNorm = 57.3772, GNorm = 0.7249, lr_0 = 1.7630e-04
Validation rmse = 1.593864
Epoch 22
Loss = 9.6462e-04, PNorm = 57.3840, GNorm = 1.4376, lr_0 = 1.6810e-04
Loss = 1.2670e-03, PNorm = 57.3926, GNorm = 0.7192, lr_0 = 1.6098e-04
Validation rmse = 1.518814
Epoch 23
Loss = 1.0243e-03, PNorm = 57.4005, GNorm = 0.3849, lr_0 = 1.5416e-04
Loss = 1.0437e-03, PNorm = 57.4083, GNorm = 0.3139, lr_0 = 1.4763e-04
Loss = 1.9623e-03, PNorm = 57.4091, GNorm = 0.9437, lr_0 = 1.4699e-04
Validation rmse = 1.485891
Epoch 24
Loss = 1.0850e-03, PNorm = 57.4160, GNorm = 0.8701, lr_0 = 1.4077e-04
Loss = 1.1440e-03, PNorm = 57.4247, GNorm = 0.4988, lr_0 = 1.3480e-04
Validation rmse = 1.390651
Epoch 25
Loss = 1.0573e-03, PNorm = 57.4318, GNorm = 0.6487, lr_0 = 1.2909e-04
Loss = 1.1526e-03, PNorm = 57.4402, GNorm = 1.0358, lr_0 = 1.2362e-04
Validation rmse = 1.443822
Epoch 26
Loss = 9.6054e-04, PNorm = 57.4447, GNorm = 0.4588, lr_0 = 1.1839e-04
Validation rmse = 1.499169
Epoch 27
Loss = 8.0344e-04, PNorm = 57.4510, GNorm = 0.6919, lr_0 = 1.1288e-04
Loss = 9.5430e-04, PNorm = 57.4572, GNorm = 1.2524, lr_0 = 1.0810e-04
Validation rmse = 1.527958
Epoch 28
Loss = 1.3443e-03, PNorm = 57.4628, GNorm = 0.7261, lr_0 = 1.0352e-04
Loss = 9.9951e-04, PNorm = 57.4680, GNorm = 0.9758, lr_0 = 1.0000e-04
Validation rmse = 1.545743
Epoch 29
Loss = 1.2393e-03, PNorm = 57.4747, GNorm = 1.2846, lr_0 = 1.0000e-04
Loss = 1.0144e-03, PNorm = 57.4796, GNorm = 0.5459, lr_0 = 1.0000e-04
Validation rmse = 1.450207
Model 0 best validation rmse = 1.384597 on epoch 12
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.030907
Ensemble test rmse = 1.030907
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.15000000000000002_ffn_num_layers_1_hidden_size_1400/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total scaffolds = 195 | train scaffolds = 75 | val scaffolds = 42 | test scaffolds = 78
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=1404, out_features=1, bias=True)
  )
)
Number of parameters = 4,314,805
Moving model to cuda
Epoch 0
Loss = 1.5714e-02, PNorm = 55.9763, GNorm = 7.9606, lr_0 = 3.6053e-04
Validation rmse = 2.114166
Epoch 1
Loss = 6.3071e-03, PNorm = 56.0387, GNorm = 6.0067, lr_0 = 6.2105e-04
Loss = 5.7048e-03, PNorm = 56.1149, GNorm = 3.5562, lr_0 = 8.5789e-04
Validation rmse = 1.730753
Epoch 2
Loss = 5.8626e-03, PNorm = 56.2006, GNorm = 5.4806, lr_0 = 9.8284e-04
Loss = 4.3106e-03, PNorm = 56.2781, GNorm = 1.8671, lr_0 = 9.4120e-04
Validation rmse = 1.529742
Epoch 3
Loss = 2.7924e-03, PNorm = 56.3431, GNorm = 0.7572, lr_0 = 8.9744e-04
Loss = 3.1213e-03, PNorm = 56.3958, GNorm = 3.2032, lr_0 = 8.5943e-04
Validation rmse = 1.369212
Epoch 4
Loss = 2.6858e-03, PNorm = 56.4444, GNorm = 1.4880, lr_0 = 8.2303e-04
Loss = 2.5165e-03, PNorm = 56.4906, GNorm = 1.1270, lr_0 = 7.8816e-04
Validation rmse = 1.291471
Epoch 5
Loss = 1.7617e-03, PNorm = 56.5344, GNorm = 1.3236, lr_0 = 7.5478e-04
Loss = 2.3782e-03, PNorm = 56.5802, GNorm = 1.1203, lr_0 = 7.2281e-04
Validation rmse = 1.258133
Epoch 6
Loss = 1.4364e-03, PNorm = 56.6242, GNorm = 0.5312, lr_0 = 6.8920e-04
Loss = 2.2960e-03, PNorm = 56.6594, GNorm = 2.9696, lr_0 = 6.6001e-04
Validation rmse = 1.323651
Epoch 7
Loss = 2.4349e-03, PNorm = 56.6945, GNorm = 1.8928, lr_0 = 6.3205e-04
Loss = 1.9774e-03, PNorm = 56.7299, GNorm = 1.0201, lr_0 = 6.0528e-04
Validation rmse = 1.166831
Epoch 8
Loss = 2.2005e-03, PNorm = 56.7656, GNorm = 1.9098, lr_0 = 5.7714e-04
Loss = 1.6340e-03, PNorm = 56.7949, GNorm = 2.9660, lr_0 = 5.5269e-04
Validation rmse = 1.205539
Epoch 9
Loss = 1.6354e-03, PNorm = 56.8248, GNorm = 3.0232, lr_0 = 5.2928e-04
Loss = 1.5547e-03, PNorm = 56.8542, GNorm = 0.7016, lr_0 = 5.0686e-04
Validation rmse = 1.201122
Epoch 10
Loss = 1.4354e-03, PNorm = 56.8775, GNorm = 0.6771, lr_0 = 4.8539e-04
Loss = 1.6943e-03, PNorm = 56.9016, GNorm = 0.5952, lr_0 = 4.6483e-04
Validation rmse = 1.116694
Epoch 11
Loss = 1.5058e-03, PNorm = 56.9210, GNorm = 2.0710, lr_0 = 4.4322e-04
Loss = 1.5315e-03, PNorm = 56.9402, GNorm = 1.3412, lr_0 = 4.2444e-04
Validation rmse = 1.137466
Epoch 12
Loss = 1.3855e-03, PNorm = 56.9603, GNorm = 0.7844, lr_0 = 4.0646e-04
Loss = 1.4128e-03, PNorm = 56.9786, GNorm = 1.2251, lr_0 = 3.8925e-04
Validation rmse = 1.083313
Epoch 13
Loss = 1.4202e-03, PNorm = 56.9972, GNorm = 0.7769, lr_0 = 3.7276e-04
Loss = 1.3454e-03, PNorm = 57.0129, GNorm = 0.6786, lr_0 = 3.5697e-04
Validation rmse = 1.018199
Epoch 14
Loss = 1.4359e-03, PNorm = 57.0300, GNorm = 1.6556, lr_0 = 3.4037e-04
Loss = 1.3583e-03, PNorm = 57.0449, GNorm = 2.0393, lr_0 = 3.2596e-04
Validation rmse = 1.065266
Epoch 15
Loss = 1.5420e-03, PNorm = 57.0597, GNorm = 3.6948, lr_0 = 3.1215e-04
Loss = 1.7914e-03, PNorm = 57.0776, GNorm = 0.7466, lr_0 = 2.9893e-04
Validation rmse = 1.208471
Epoch 16
Loss = 1.2677e-03, PNorm = 57.0985, GNorm = 0.7676, lr_0 = 2.8503e-04
Loss = 1.3200e-03, PNorm = 57.1147, GNorm = 0.6473, lr_0 = 2.7295e-04
Validation rmse = 1.079159
Epoch 17
Loss = 1.1885e-03, PNorm = 57.1246, GNorm = 0.3450, lr_0 = 2.6139e-04
Loss = 1.2718e-03, PNorm = 57.1374, GNorm = 0.7837, lr_0 = 2.5032e-04
Validation rmse = 1.055904
Epoch 18
Loss = 1.2205e-03, PNorm = 57.1478, GNorm = 0.7376, lr_0 = 2.3972e-04
Loss = 1.1217e-03, PNorm = 57.1573, GNorm = 1.0925, lr_0 = 2.2956e-04
Validation rmse = 1.055670
Epoch 19
Loss = 1.1088e-03, PNorm = 57.1669, GNorm = 1.6527, lr_0 = 2.1889e-04
Loss = 1.2502e-03, PNorm = 57.1752, GNorm = 0.4719, lr_0 = 2.0962e-04
Validation rmse = 1.063278
Epoch 20
Loss = 9.9796e-04, PNorm = 57.1874, GNorm = 0.3885, lr_0 = 2.0074e-04
Loss = 1.2409e-03, PNorm = 57.1961, GNorm = 0.5764, lr_0 = 1.9224e-04
Validation rmse = 1.051402
Epoch 21
Loss = 1.1420e-03, PNorm = 57.2050, GNorm = 1.1760, lr_0 = 1.8409e-04
Loss = 1.3839e-03, PNorm = 57.2127, GNorm = 0.7456, lr_0 = 1.7630e-04
Validation rmse = 1.147057
Epoch 22
Loss = 1.1519e-03, PNorm = 57.2241, GNorm = 0.4937, lr_0 = 1.6810e-04
Loss = 1.2514e-03, PNorm = 57.2341, GNorm = 1.2884, lr_0 = 1.6098e-04
Validation rmse = 1.015580
Epoch 23
Loss = 1.1474e-03, PNorm = 57.2424, GNorm = 1.8836, lr_0 = 1.5416e-04
Loss = 1.0674e-03, PNorm = 57.2489, GNorm = 1.1951, lr_0 = 1.4763e-04
Loss = 2.2064e-03, PNorm = 57.2495, GNorm = 1.6808, lr_0 = 1.4699e-04
Validation rmse = 1.084502
Epoch 24
Loss = 9.9169e-04, PNorm = 57.2552, GNorm = 0.6575, lr_0 = 1.4077e-04
Loss = 1.0225e-03, PNorm = 57.2635, GNorm = 0.3993, lr_0 = 1.3480e-04
Validation rmse = 1.041696
Epoch 25
Loss = 1.2133e-03, PNorm = 57.2694, GNorm = 0.8424, lr_0 = 1.2909e-04
Loss = 9.8714e-04, PNorm = 57.2765, GNorm = 0.9717, lr_0 = 1.2362e-04
Validation rmse = 1.072599
Epoch 26
Loss = 1.2386e-03, PNorm = 57.2821, GNorm = 1.0633, lr_0 = 1.1839e-04
Validation rmse = 1.039859
Epoch 27
Loss = 1.7899e-03, PNorm = 57.2894, GNorm = 1.8723, lr_0 = 1.1288e-04
Loss = 9.0647e-04, PNorm = 57.2949, GNorm = 1.2300, lr_0 = 1.0810e-04
Validation rmse = 1.044104
Epoch 28
Loss = 7.8311e-04, PNorm = 57.3009, GNorm = 0.5397, lr_0 = 1.0352e-04
Loss = 1.0590e-03, PNorm = 57.3040, GNorm = 0.8694, lr_0 = 1.0000e-04
Validation rmse = 1.035087
Epoch 29
Loss = 9.0876e-04, PNorm = 57.3102, GNorm = 0.4980, lr_0 = 1.0000e-04
Loss = 9.0306e-04, PNorm = 57.3139, GNorm = 0.4585, lr_0 = 1.0000e-04
Validation rmse = 1.030669
Model 0 best validation rmse = 1.015580 on epoch 22
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.261960
Ensemble test rmse = 1.261960
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.15000000000000002_ffn_num_layers_1_hidden_size_1400/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 58 | test scaffolds = 53
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=1404, out_features=1, bias=True)
  )
)
Number of parameters = 4,314,805
Moving model to cuda
Epoch 0
Loss = 1.7321e-02, PNorm = 55.9753, GNorm = 2.4929, lr_0 = 3.6053e-04
Validation rmse = 2.049136
Epoch 1
Loss = 9.0505e-03, PNorm = 56.0417, GNorm = 5.9312, lr_0 = 6.2105e-04
Loss = 7.9685e-03, PNorm = 56.1346, GNorm = 5.1709, lr_0 = 8.5789e-04
Validation rmse = 1.528592
Epoch 2
Loss = 6.3023e-03, PNorm = 56.2404, GNorm = 2.7359, lr_0 = 9.8284e-04
Loss = 5.7650e-03, PNorm = 56.3285, GNorm = 1.9893, lr_0 = 9.4120e-04
Validation rmse = 1.526842
Epoch 3
Loss = 4.9496e-03, PNorm = 56.4001, GNorm = 3.1935, lr_0 = 8.9744e-04
Loss = 4.0985e-03, PNorm = 56.4611, GNorm = 3.3336, lr_0 = 8.5943e-04
Validation rmse = 1.194852
Epoch 4
Loss = 3.9518e-03, PNorm = 56.5192, GNorm = 1.5897, lr_0 = 8.2303e-04
Loss = 2.6524e-03, PNorm = 56.5722, GNorm = 1.2634, lr_0 = 7.8816e-04
Validation rmse = 1.194815
Epoch 5
Loss = 2.1513e-03, PNorm = 56.6195, GNorm = 2.0196, lr_0 = 7.5478e-04
Loss = 2.6623e-03, PNorm = 56.6667, GNorm = 0.6871, lr_0 = 7.2281e-04
Validation rmse = 1.146865
Epoch 6
Loss = 2.8507e-03, PNorm = 56.7105, GNorm = 2.7443, lr_0 = 6.8920e-04
Loss = 2.8144e-03, PNorm = 56.7473, GNorm = 3.1518, lr_0 = 6.6001e-04
Validation rmse = 1.113437
Epoch 7
Loss = 2.1818e-03, PNorm = 56.7783, GNorm = 1.2993, lr_0 = 6.3205e-04
Loss = 2.2775e-03, PNorm = 56.8135, GNorm = 1.4241, lr_0 = 6.0528e-04
Validation rmse = 1.052563
Epoch 8
Loss = 1.6279e-03, PNorm = 56.8456, GNorm = 0.4775, lr_0 = 5.7714e-04
Loss = 1.9140e-03, PNorm = 56.8731, GNorm = 1.1864, lr_0 = 5.5269e-04
Validation rmse = 1.013341
Epoch 9
Loss = 1.8058e-03, PNorm = 56.8992, GNorm = 1.2260, lr_0 = 5.2928e-04
Loss = 1.6451e-03, PNorm = 56.9244, GNorm = 0.5131, lr_0 = 5.0686e-04
Validation rmse = 0.988574
Epoch 10
Loss = 1.8555e-03, PNorm = 56.9438, GNorm = 1.1256, lr_0 = 4.8539e-04
Loss = 1.6686e-03, PNorm = 56.9671, GNorm = 0.7008, lr_0 = 4.6483e-04
Validation rmse = 1.031369
Epoch 11
Loss = 1.9962e-03, PNorm = 56.9944, GNorm = 1.7509, lr_0 = 4.4322e-04
Loss = 1.8229e-03, PNorm = 57.0151, GNorm = 1.0315, lr_0 = 4.2444e-04
Validation rmse = 0.968226
Epoch 12
Loss = 1.6513e-03, PNorm = 57.0365, GNorm = 0.6032, lr_0 = 4.0646e-04
Loss = 1.8414e-03, PNorm = 57.0568, GNorm = 2.0866, lr_0 = 3.8925e-04
Validation rmse = 0.977765
Epoch 13
Loss = 1.4897e-03, PNorm = 57.0726, GNorm = 0.7302, lr_0 = 3.7276e-04
Loss = 1.5760e-03, PNorm = 57.0900, GNorm = 1.1841, lr_0 = 3.5697e-04
Validation rmse = 1.077160
Epoch 14
Loss = 1.5836e-03, PNorm = 57.1115, GNorm = 1.0640, lr_0 = 3.4037e-04
Loss = 1.6705e-03, PNorm = 57.1283, GNorm = 0.6072, lr_0 = 3.2596e-04
Validation rmse = 0.955599
Epoch 15
Loss = 1.2312e-03, PNorm = 57.1426, GNorm = 0.7275, lr_0 = 3.1215e-04
Loss = 1.7257e-03, PNorm = 57.1590, GNorm = 2.7279, lr_0 = 2.9893e-04
Validation rmse = 0.991496
Epoch 16
Loss = 1.5491e-03, PNorm = 57.1759, GNorm = 0.7891, lr_0 = 2.8503e-04
Loss = 1.3370e-03, PNorm = 57.1892, GNorm = 0.5871, lr_0 = 2.7295e-04
Validation rmse = 0.940831
Epoch 17
Loss = 1.4738e-03, PNorm = 57.2009, GNorm = 1.3163, lr_0 = 2.6139e-04
Loss = 1.6354e-03, PNorm = 57.2143, GNorm = 0.8313, lr_0 = 2.5032e-04
Validation rmse = 0.939648
Epoch 18
Loss = 1.1612e-03, PNorm = 57.2279, GNorm = 0.3621, lr_0 = 2.3972e-04
Loss = 1.7047e-03, PNorm = 57.2419, GNorm = 0.9280, lr_0 = 2.2956e-04
Validation rmse = 0.893290
Epoch 19
Loss = 1.4460e-03, PNorm = 57.2530, GNorm = 1.0715, lr_0 = 2.1889e-04
Loss = 1.6381e-03, PNorm = 57.2648, GNorm = 0.5984, lr_0 = 2.0962e-04
Validation rmse = 1.026630
Epoch 20
Loss = 1.7728e-03, PNorm = 57.2798, GNorm = 0.6103, lr_0 = 2.0074e-04
Loss = 1.2793e-03, PNorm = 57.2920, GNorm = 1.0465, lr_0 = 1.9224e-04
Validation rmse = 0.879228
Epoch 21
Loss = 1.1522e-03, PNorm = 57.2993, GNorm = 1.9112, lr_0 = 1.8409e-04
Loss = 1.2229e-03, PNorm = 57.3081, GNorm = 0.3844, lr_0 = 1.7630e-04
Validation rmse = 0.884785
Epoch 22
Loss = 1.4060e-03, PNorm = 57.3160, GNorm = 1.4373, lr_0 = 1.6810e-04
Loss = 1.3971e-03, PNorm = 57.3244, GNorm = 1.7598, lr_0 = 1.6098e-04
Validation rmse = 0.880606
Epoch 23
Loss = 1.1836e-03, PNorm = 57.3316, GNorm = 0.7896, lr_0 = 1.5416e-04
Loss = 1.3229e-03, PNorm = 57.3391, GNorm = 0.6109, lr_0 = 1.4763e-04
Loss = 2.9709e-03, PNorm = 57.3400, GNorm = 0.8822, lr_0 = 1.4699e-04
Validation rmse = 0.913361
Epoch 24
Loss = 1.2411e-03, PNorm = 57.3462, GNorm = 0.8610, lr_0 = 1.4077e-04
Loss = 1.2326e-03, PNorm = 57.3525, GNorm = 0.6598, lr_0 = 1.3480e-04
Validation rmse = 0.911434
Epoch 25
Loss = 1.2630e-03, PNorm = 57.3598, GNorm = 0.4935, lr_0 = 1.2909e-04
Loss = 1.1610e-03, PNorm = 57.3657, GNorm = 0.8544, lr_0 = 1.2362e-04
Validation rmse = 0.927678
Epoch 26
Loss = 1.1182e-03, PNorm = 57.3719, GNorm = 0.6515, lr_0 = 1.1839e-04
Validation rmse = 0.863487
Epoch 27
Loss = 7.2560e-04, PNorm = 57.3789, GNorm = 0.6252, lr_0 = 1.1288e-04
Loss = 1.1181e-03, PNorm = 57.3833, GNorm = 1.2393, lr_0 = 1.0810e-04
Validation rmse = 0.877226
Epoch 28
Loss = 9.2705e-04, PNorm = 57.3895, GNorm = 0.3351, lr_0 = 1.0352e-04
Loss = 1.1404e-03, PNorm = 57.3946, GNorm = 0.4063, lr_0 = 1.0000e-04
Validation rmse = 0.891737
Epoch 29
Loss = 1.1623e-03, PNorm = 57.4004, GNorm = 0.8411, lr_0 = 1.0000e-04
Loss = 1.0323e-03, PNorm = 57.4055, GNorm = 0.8608, lr_0 = 1.0000e-04
Validation rmse = 0.887684
Model 0 best validation rmse = 0.863487 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.456768
Ensemble test rmse = 1.456768
10-fold cross validation
	Seed 0 ==> test rmse = 0.847945
	Seed 1 ==> test rmse = 1.066143
	Seed 2 ==> test rmse = 1.161531
	Seed 3 ==> test rmse = 1.003586
	Seed 4 ==> test rmse = 1.059442
	Seed 5 ==> test rmse = 1.180387
	Seed 6 ==> test rmse = 0.985323
	Seed 7 ==> test rmse = 1.030907
	Seed 8 ==> test rmse = 1.261960
	Seed 9 ==> test rmse = 1.456768
Overall test rmse = 1.105399 +/- 0.160317
Elapsed time = 0:06:03
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.2_ffn_num_layers_3_hidden_size_600/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total scaffolds = 195 | train scaffolds = 91 | val scaffolds = 66 | test scaffolds = 38
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=600, bias=False)
      (W_h): Linear(in_features=600, out_features=600, bias=False)
      (W_o): Linear(in_features=733, out_features=600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=604, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.2, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,612,801
Moving model to cuda
Epoch 0
Loss = 1.4471e-02, PNorm = 51.9370, GNorm = 5.8594, lr_0 = 3.6053e-04
Validation rmse = 1.153505
Epoch 1
Loss = 6.9424e-03, PNorm = 51.9675, GNorm = 3.2740, lr_0 = 6.2105e-04
Loss = 5.9481e-03, PNorm = 52.0098, GNorm = 1.6225, lr_0 = 8.5789e-04
Validation rmse = 1.029799
Epoch 2
Loss = 6.3140e-03, PNorm = 52.0550, GNorm = 1.3535, lr_0 = 9.8284e-04
Loss = 4.8517e-03, PNorm = 52.0992, GNorm = 1.0189, lr_0 = 9.4120e-04
Validation rmse = 1.084937
Epoch 3
Loss = 3.0225e-03, PNorm = 52.1378, GNorm = 1.9663, lr_0 = 8.9744e-04
Loss = 3.9670e-03, PNorm = 52.1665, GNorm = 0.7493, lr_0 = 8.5943e-04
Validation rmse = 1.115146
Epoch 4
Loss = 6.5078e-03, PNorm = 52.1935, GNorm = 1.7473, lr_0 = 8.2303e-04
Loss = 2.5680e-03, PNorm = 52.2152, GNorm = 1.3619, lr_0 = 7.8816e-04
Validation rmse = 1.156576
Epoch 5
Loss = 2.5741e-03, PNorm = 52.2370, GNorm = 1.2835, lr_0 = 7.5478e-04
Loss = 2.8466e-03, PNorm = 52.2556, GNorm = 1.1800, lr_0 = 7.2281e-04
Validation rmse = 1.198824
Epoch 6
Loss = 2.6305e-03, PNorm = 52.2797, GNorm = 1.9395, lr_0 = 6.8920e-04
Loss = 2.6073e-03, PNorm = 52.3013, GNorm = 0.6860, lr_0 = 6.6001e-04
Validation rmse = 1.528239
Epoch 7
Loss = 3.9589e-03, PNorm = 52.3189, GNorm = 3.0265, lr_0 = 6.3205e-04
Loss = 2.7063e-03, PNorm = 52.3360, GNorm = 1.4772, lr_0 = 6.0528e-04
Validation rmse = 0.890310
Epoch 8
Loss = 2.5012e-03, PNorm = 52.3570, GNorm = 1.3993, lr_0 = 5.7714e-04
Loss = 2.5925e-03, PNorm = 52.3720, GNorm = 0.8821, lr_0 = 5.5269e-04
Validation rmse = 0.968586
Epoch 9
Loss = 2.4959e-03, PNorm = 52.3877, GNorm = 1.4430, lr_0 = 5.2928e-04
Loss = 2.2834e-03, PNorm = 52.4027, GNorm = 0.6484, lr_0 = 5.0686e-04
Validation rmse = 1.033551
Epoch 10
Loss = 2.2573e-03, PNorm = 52.4122, GNorm = 2.5058, lr_0 = 4.8539e-04
Loss = 2.6072e-03, PNorm = 52.4263, GNorm = 0.6986, lr_0 = 4.6483e-04
Validation rmse = 0.938626
Epoch 11
Loss = 2.1318e-03, PNorm = 52.4397, GNorm = 0.8432, lr_0 = 4.4322e-04
Loss = 2.3071e-03, PNorm = 52.4514, GNorm = 1.5355, lr_0 = 4.2444e-04
Validation rmse = 0.961876
Epoch 12
Loss = 2.3411e-03, PNorm = 52.4615, GNorm = 1.4482, lr_0 = 4.0646e-04
Loss = 2.1309e-03, PNorm = 52.4725, GNorm = 0.5354, lr_0 = 3.8925e-04
Validation rmse = 1.053222
Epoch 13
Loss = 1.8169e-03, PNorm = 52.4832, GNorm = 0.8394, lr_0 = 3.7276e-04
Loss = 1.9164e-03, PNorm = 52.4915, GNorm = 1.0812, lr_0 = 3.5697e-04
Validation rmse = 1.050416
Epoch 14
Loss = 2.0551e-03, PNorm = 52.5029, GNorm = 0.8966, lr_0 = 3.4037e-04
Loss = 1.8855e-03, PNorm = 52.5117, GNorm = 2.2537, lr_0 = 3.2596e-04
Validation rmse = 1.046050
Epoch 15
Loss = 1.6138e-03, PNorm = 52.5194, GNorm = 0.6028, lr_0 = 3.1215e-04
Loss = 1.6441e-03, PNorm = 52.5281, GNorm = 1.6104, lr_0 = 2.9893e-04
Validation rmse = 1.000782
Epoch 16
Loss = 1.8549e-03, PNorm = 52.5360, GNorm = 0.8988, lr_0 = 2.8503e-04
Loss = 1.6965e-03, PNorm = 52.5415, GNorm = 1.4941, lr_0 = 2.7295e-04
Validation rmse = 1.003915
Epoch 17
Loss = 2.0498e-03, PNorm = 52.5492, GNorm = 2.1731, lr_0 = 2.6139e-04
Loss = 2.2251e-03, PNorm = 52.5562, GNorm = 1.7925, lr_0 = 2.5032e-04
Validation rmse = 0.989048
Epoch 18
Loss = 1.6123e-03, PNorm = 52.5636, GNorm = 0.5566, lr_0 = 2.3972e-04
Loss = 1.9938e-03, PNorm = 52.5707, GNorm = 2.0085, lr_0 = 2.2956e-04
Validation rmse = 1.251846
Epoch 19
Loss = 1.5274e-03, PNorm = 52.5778, GNorm = 1.4214, lr_0 = 2.1889e-04
Loss = 1.8626e-03, PNorm = 52.5843, GNorm = 0.8125, lr_0 = 2.0962e-04
Validation rmse = 1.009422
Epoch 20
Loss = 1.5580e-03, PNorm = 52.5904, GNorm = 0.7295, lr_0 = 2.0074e-04
Loss = 1.5523e-03, PNorm = 52.5952, GNorm = 0.7703, lr_0 = 1.9224e-04
Validation rmse = 1.001427
Epoch 21
Loss = 1.4772e-03, PNorm = 52.5999, GNorm = 0.7819, lr_0 = 1.8409e-04
Loss = 1.5170e-03, PNorm = 52.6042, GNorm = 1.1113, lr_0 = 1.7630e-04
Validation rmse = 0.946811
Epoch 22
Loss = 1.3880e-03, PNorm = 52.6091, GNorm = 0.8351, lr_0 = 1.6810e-04
Loss = 1.5341e-03, PNorm = 52.6121, GNorm = 0.6774, lr_0 = 1.6098e-04
Validation rmse = 0.935895
Epoch 23
Loss = 1.5018e-03, PNorm = 52.6160, GNorm = 0.7955, lr_0 = 1.5416e-04
Loss = 1.4850e-03, PNorm = 52.6199, GNorm = 1.1950, lr_0 = 1.4763e-04
Loss = 2.6676e-03, PNorm = 52.6204, GNorm = 1.3971, lr_0 = 1.4699e-04
Validation rmse = 1.002130
Epoch 24
Loss = 1.4580e-03, PNorm = 52.6249, GNorm = 0.8100, lr_0 = 1.4077e-04
Loss = 1.5371e-03, PNorm = 52.6279, GNorm = 0.8684, lr_0 = 1.3480e-04
Validation rmse = 0.965590
Epoch 25
Loss = 1.4520e-03, PNorm = 52.6310, GNorm = 0.5233, lr_0 = 1.2909e-04
Loss = 1.4033e-03, PNorm = 52.6339, GNorm = 0.5366, lr_0 = 1.2362e-04
Validation rmse = 1.037634
Epoch 26
Loss = 1.3515e-03, PNorm = 52.6360, GNorm = 0.5839, lr_0 = 1.1839e-04
Validation rmse = 0.964069
Epoch 27
Loss = 1.4934e-03, PNorm = 52.6390, GNorm = 1.4439, lr_0 = 1.1288e-04
Loss = 1.5854e-03, PNorm = 52.6416, GNorm = 1.3205, lr_0 = 1.0810e-04
Validation rmse = 0.976889
Epoch 28
Loss = 2.2339e-03, PNorm = 52.6433, GNorm = 0.6488, lr_0 = 1.0352e-04
Loss = 1.2866e-03, PNorm = 52.6450, GNorm = 0.4927, lr_0 = 1.0000e-04
Validation rmse = 0.970650
Epoch 29
Loss = 1.4120e-03, PNorm = 52.6470, GNorm = 1.3504, lr_0 = 1.0000e-04
Loss = 1.4499e-03, PNorm = 52.6495, GNorm = 0.9839, lr_0 = 1.0000e-04
Validation rmse = 0.989542
Model 0 best validation rmse = 0.890310 on epoch 7
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.007116
Ensemble test rmse = 1.007116
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.2_ffn_num_layers_3_hidden_size_600/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total scaffolds = 195 | train scaffolds = 76 | val scaffolds = 60 | test scaffolds = 59
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=600, bias=False)
      (W_h): Linear(in_features=600, out_features=600, bias=False)
      (W_o): Linear(in_features=733, out_features=600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=604, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.2, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,612,801
Moving model to cuda
Epoch 0
Loss = 1.4904e-02, PNorm = 51.9374, GNorm = 4.9449, lr_0 = 3.6053e-04
Validation rmse = 1.280028
Epoch 1
Loss = 6.6626e-03, PNorm = 51.9673, GNorm = 4.4454, lr_0 = 6.2105e-04
Loss = 6.0191e-03, PNorm = 52.0074, GNorm = 4.2030, lr_0 = 8.5789e-04
Validation rmse = 1.161677
Epoch 2
Loss = 7.3854e-03, PNorm = 52.0551, GNorm = 4.0676, lr_0 = 9.8284e-04
Loss = 4.2009e-03, PNorm = 52.0983, GNorm = 1.4510, lr_0 = 9.4120e-04
Validation rmse = 1.130393
Epoch 3
Loss = 3.9566e-03, PNorm = 52.1407, GNorm = 2.6808, lr_0 = 8.9744e-04
Loss = 4.2584e-03, PNorm = 52.1748, GNorm = 2.6222, lr_0 = 8.5943e-04
Validation rmse = 1.134960
Epoch 4
Loss = 2.8531e-03, PNorm = 52.2002, GNorm = 1.1377, lr_0 = 8.2303e-04
Loss = 3.4934e-03, PNorm = 52.2260, GNorm = 2.6303, lr_0 = 7.8816e-04
Validation rmse = 1.129440
Epoch 5
Loss = 3.2544e-03, PNorm = 52.2460, GNorm = 0.6552, lr_0 = 7.5478e-04
Loss = 3.2908e-03, PNorm = 52.2674, GNorm = 1.0942, lr_0 = 7.2281e-04
Validation rmse = 1.078588
Epoch 6
Loss = 3.0682e-03, PNorm = 52.2914, GNorm = 1.6114, lr_0 = 6.8920e-04
Loss = 2.5592e-03, PNorm = 52.3140, GNorm = 1.1507, lr_0 = 6.6001e-04
Validation rmse = 1.147148
Epoch 7
Loss = 2.6231e-03, PNorm = 52.3314, GNorm = 0.9526, lr_0 = 6.3205e-04
Loss = 2.8448e-03, PNorm = 52.3495, GNorm = 1.0644, lr_0 = 6.0528e-04
Validation rmse = 1.103098
Epoch 8
Loss = 2.2429e-03, PNorm = 52.3717, GNorm = 0.6614, lr_0 = 5.7714e-04
Loss = 2.4903e-03, PNorm = 52.3883, GNorm = 2.5173, lr_0 = 5.5269e-04
Validation rmse = 1.001472
Epoch 9
Loss = 2.1523e-03, PNorm = 52.4075, GNorm = 2.5191, lr_0 = 5.2928e-04
Loss = 2.6250e-03, PNorm = 52.4234, GNorm = 2.3001, lr_0 = 5.0686e-04
Validation rmse = 1.113621
Epoch 10
Loss = 2.0848e-03, PNorm = 52.4392, GNorm = 1.6135, lr_0 = 4.8539e-04
Loss = 1.6265e-03, PNorm = 52.4512, GNorm = 0.7070, lr_0 = 4.6483e-04
Validation rmse = 0.996941
Epoch 11
Loss = 2.3025e-03, PNorm = 52.4640, GNorm = 1.8008, lr_0 = 4.4322e-04
Loss = 1.9941e-03, PNorm = 52.4752, GNorm = 0.5279, lr_0 = 4.2444e-04
Validation rmse = 0.977788
Epoch 12
Loss = 1.7724e-03, PNorm = 52.4880, GNorm = 0.9765, lr_0 = 4.0646e-04
Loss = 1.9385e-03, PNorm = 52.4998, GNorm = 1.0007, lr_0 = 3.8925e-04
Validation rmse = 1.058840
Epoch 13
Loss = 2.6126e-03, PNorm = 52.5085, GNorm = 1.5439, lr_0 = 3.7276e-04
Loss = 1.9754e-03, PNorm = 52.5197, GNorm = 2.8511, lr_0 = 3.5697e-04
Validation rmse = 1.015748
Epoch 14
Loss = 1.6879e-03, PNorm = 52.5296, GNorm = 1.3524, lr_0 = 3.4037e-04
Loss = 1.5639e-03, PNorm = 52.5410, GNorm = 1.2546, lr_0 = 3.2596e-04
Validation rmse = 1.002585
Epoch 15
Loss = 1.6448e-03, PNorm = 52.5493, GNorm = 0.9065, lr_0 = 3.1215e-04
Loss = 1.4365e-03, PNorm = 52.5586, GNorm = 0.9641, lr_0 = 2.9893e-04
Validation rmse = 0.972324
Epoch 16
Loss = 1.6886e-03, PNorm = 52.5651, GNorm = 0.4970, lr_0 = 2.8503e-04
Loss = 1.8311e-03, PNorm = 52.5713, GNorm = 0.6658, lr_0 = 2.7295e-04
Validation rmse = 1.006356
Epoch 17
Loss = 1.4992e-03, PNorm = 52.5799, GNorm = 0.8753, lr_0 = 2.6139e-04
Loss = 1.6076e-03, PNorm = 52.5862, GNorm = 0.7314, lr_0 = 2.5032e-04
Validation rmse = 1.032312
Epoch 18
Loss = 1.6497e-03, PNorm = 52.5921, GNorm = 1.0366, lr_0 = 2.3972e-04
Loss = 1.3217e-03, PNorm = 52.5976, GNorm = 1.2420, lr_0 = 2.2956e-04
Validation rmse = 0.978638
Epoch 19
Loss = 1.3321e-03, PNorm = 52.6031, GNorm = 1.0892, lr_0 = 2.1889e-04
Loss = 1.6252e-03, PNorm = 52.6071, GNorm = 0.7657, lr_0 = 2.0962e-04
Validation rmse = 1.000746
Epoch 20
Loss = 1.2423e-03, PNorm = 52.6123, GNorm = 1.1799, lr_0 = 2.0074e-04
Loss = 1.5037e-03, PNorm = 52.6177, GNorm = 0.7382, lr_0 = 1.9224e-04
Validation rmse = 0.973483
Epoch 21
Loss = 1.5302e-03, PNorm = 52.6213, GNorm = 1.3158, lr_0 = 1.8409e-04
Loss = 1.5709e-03, PNorm = 52.6256, GNorm = 1.7758, lr_0 = 1.7630e-04
Validation rmse = 0.969292
Epoch 22
Loss = 1.5755e-03, PNorm = 52.6320, GNorm = 0.5895, lr_0 = 1.6810e-04
Loss = 1.5254e-03, PNorm = 52.6354, GNorm = 1.4011, lr_0 = 1.6098e-04
Validation rmse = 1.026368
Epoch 23
Loss = 1.3841e-03, PNorm = 52.6394, GNorm = 1.0809, lr_0 = 1.5416e-04
Loss = 1.3502e-03, PNorm = 52.6426, GNorm = 0.8439, lr_0 = 1.4763e-04
Loss = 1.4994e-03, PNorm = 52.6429, GNorm = 0.6146, lr_0 = 1.4699e-04
Validation rmse = 1.001812
Epoch 24
Loss = 1.3497e-03, PNorm = 52.6470, GNorm = 0.7062, lr_0 = 1.4077e-04
Loss = 1.3352e-03, PNorm = 52.6492, GNorm = 1.1239, lr_0 = 1.3480e-04
Validation rmse = 1.005247
Epoch 25
Loss = 1.1364e-03, PNorm = 52.6511, GNorm = 0.6840, lr_0 = 1.2909e-04
Loss = 1.5884e-03, PNorm = 52.6534, GNorm = 1.2269, lr_0 = 1.2362e-04
Validation rmse = 0.984883
Epoch 26
Loss = 1.2590e-03, PNorm = 52.6554, GNorm = 0.7403, lr_0 = 1.1839e-04
Validation rmse = 0.973475
Epoch 27
Loss = 1.0932e-03, PNorm = 52.6588, GNorm = 1.3451, lr_0 = 1.1288e-04
Loss = 1.3008e-03, PNorm = 52.6614, GNorm = 0.4793, lr_0 = 1.0810e-04
Validation rmse = 1.000487
Epoch 28
Loss = 1.3001e-03, PNorm = 52.6639, GNorm = 0.6009, lr_0 = 1.0352e-04
Loss = 1.4484e-03, PNorm = 52.6671, GNorm = 0.7447, lr_0 = 1.0000e-04
Validation rmse = 1.042672
Epoch 29
Loss = 1.2768e-03, PNorm = 52.6694, GNorm = 0.5382, lr_0 = 1.0000e-04
Loss = 1.5410e-03, PNorm = 52.6736, GNorm = 2.1477, lr_0 = 1.0000e-04
Validation rmse = 1.002680
Model 0 best validation rmse = 0.969292 on epoch 21
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.013111
Ensemble test rmse = 1.013111
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.2_ffn_num_layers_3_hidden_size_600/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total scaffolds = 195 | train scaffolds = 55 | val scaffolds = 64 | test scaffolds = 76
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=600, bias=False)
      (W_h): Linear(in_features=600, out_features=600, bias=False)
      (W_o): Linear(in_features=733, out_features=600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=604, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.2, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,612,801
Moving model to cuda
Epoch 0
Loss = 1.5492e-02, PNorm = 51.9369, GNorm = 7.0574, lr_0 = 3.6053e-04
Validation rmse = 1.549044
Epoch 1
Loss = 6.2767e-03, PNorm = 51.9679, GNorm = 2.8090, lr_0 = 6.2105e-04
Loss = 6.8228e-03, PNorm = 52.0094, GNorm = 5.6743, lr_0 = 8.5789e-04
Validation rmse = 1.201606
Epoch 2
Loss = 3.1573e-03, PNorm = 52.0597, GNorm = 0.9267, lr_0 = 9.8284e-04
Loss = 4.7079e-03, PNorm = 52.1007, GNorm = 2.9765, lr_0 = 9.4120e-04
Validation rmse = 1.235945
Epoch 3
Loss = 4.3065e-03, PNorm = 52.1342, GNorm = 0.6710, lr_0 = 8.9744e-04
Loss = 3.5501e-03, PNorm = 52.1623, GNorm = 1.2405, lr_0 = 8.5943e-04
Validation rmse = 1.423882
Epoch 4
Loss = 3.2415e-03, PNorm = 52.1838, GNorm = 2.8413, lr_0 = 8.2303e-04
Loss = 4.5495e-03, PNorm = 52.2132, GNorm = 3.7087, lr_0 = 7.8816e-04
Validation rmse = 1.195654
Epoch 5
Loss = 2.4986e-03, PNorm = 52.2428, GNorm = 1.1292, lr_0 = 7.5478e-04
Loss = 3.1751e-03, PNorm = 52.2638, GNorm = 1.0601, lr_0 = 7.2281e-04
Validation rmse = 1.077269
Epoch 6
Loss = 2.8320e-03, PNorm = 52.2943, GNorm = 1.3597, lr_0 = 6.8920e-04
Loss = 2.8969e-03, PNorm = 52.3170, GNorm = 0.7397, lr_0 = 6.6001e-04
Validation rmse = 1.147060
Epoch 7
Loss = 3.6985e-03, PNorm = 52.3394, GNorm = 1.0845, lr_0 = 6.3205e-04
Loss = 2.4076e-03, PNorm = 52.3576, GNorm = 0.6180, lr_0 = 6.0528e-04
Validation rmse = 1.049238
Epoch 8
Loss = 2.9429e-03, PNorm = 52.3771, GNorm = 0.7925, lr_0 = 5.7714e-04
Loss = 2.4376e-03, PNorm = 52.3952, GNorm = 0.4646, lr_0 = 5.5269e-04
Validation rmse = 1.079571
Epoch 9
Loss = 2.2471e-03, PNorm = 52.4075, GNorm = 0.8118, lr_0 = 5.2928e-04
Loss = 2.1982e-03, PNorm = 52.4227, GNorm = 0.9713, lr_0 = 5.0686e-04
Validation rmse = 1.161771
Epoch 10
Loss = 2.1041e-03, PNorm = 52.4378, GNorm = 1.9882, lr_0 = 4.8539e-04
Loss = 2.5159e-03, PNorm = 52.4522, GNorm = 0.7880, lr_0 = 4.6483e-04
Validation rmse = 1.070832
Epoch 11
Loss = 3.1464e-03, PNorm = 52.4688, GNorm = 2.8490, lr_0 = 4.4322e-04
Loss = 2.2144e-03, PNorm = 52.4815, GNorm = 0.9520, lr_0 = 4.2444e-04
Validation rmse = 1.043603
Epoch 12
Loss = 2.4039e-03, PNorm = 52.4946, GNorm = 1.7173, lr_0 = 4.0646e-04
Loss = 2.0433e-03, PNorm = 52.5040, GNorm = 0.7955, lr_0 = 3.8925e-04
Validation rmse = 1.066028
Epoch 13
Loss = 2.1505e-03, PNorm = 52.5153, GNorm = 1.7452, lr_0 = 3.7276e-04
Loss = 1.9582e-03, PNorm = 52.5256, GNorm = 1.3033, lr_0 = 3.5697e-04
Validation rmse = 1.042284
Epoch 14
Loss = 2.2719e-03, PNorm = 52.5347, GNorm = 1.5949, lr_0 = 3.4037e-04
Loss = 1.8464e-03, PNorm = 52.5459, GNorm = 0.8880, lr_0 = 3.2596e-04
Validation rmse = 1.058145
Epoch 15
Loss = 2.3096e-03, PNorm = 52.5539, GNorm = 1.5747, lr_0 = 3.1215e-04
Loss = 2.1152e-03, PNorm = 52.5618, GNorm = 0.8046, lr_0 = 2.9893e-04
Validation rmse = 1.091979
Epoch 16
Loss = 2.0115e-03, PNorm = 52.5711, GNorm = 1.1931, lr_0 = 2.8503e-04
Loss = 1.8441e-03, PNorm = 52.5780, GNorm = 0.7036, lr_0 = 2.7295e-04
Validation rmse = 1.031785
Epoch 17
Loss = 1.6990e-03, PNorm = 52.5846, GNorm = 1.3078, lr_0 = 2.6139e-04
Loss = 1.7131e-03, PNorm = 52.5910, GNorm = 2.6588, lr_0 = 2.5032e-04
Validation rmse = 1.257063
Epoch 18
Loss = 1.7764e-03, PNorm = 52.5975, GNorm = 1.9062, lr_0 = 2.3972e-04
Loss = 1.9583e-03, PNorm = 52.6039, GNorm = 0.9707, lr_0 = 2.2956e-04
Validation rmse = 1.022320
Epoch 19
Loss = 2.0856e-03, PNorm = 52.6122, GNorm = 1.8667, lr_0 = 2.1889e-04
Loss = 1.8113e-03, PNorm = 52.6195, GNorm = 1.6941, lr_0 = 2.0962e-04
Validation rmse = 1.010573
Epoch 20
Loss = 1.6227e-03, PNorm = 52.6235, GNorm = 0.6993, lr_0 = 2.0074e-04
Loss = 1.8290e-03, PNorm = 52.6289, GNorm = 1.2379, lr_0 = 1.9224e-04
Validation rmse = 1.037465
Epoch 21
Loss = 1.6030e-03, PNorm = 52.6317, GNorm = 1.1270, lr_0 = 1.8409e-04
Loss = 1.5934e-03, PNorm = 52.6384, GNorm = 0.5542, lr_0 = 1.7630e-04
Validation rmse = 1.026440
Epoch 22
Loss = 1.6024e-03, PNorm = 52.6423, GNorm = 1.9899, lr_0 = 1.6810e-04
Loss = 1.6589e-03, PNorm = 52.6464, GNorm = 0.6168, lr_0 = 1.6098e-04
Validation rmse = 1.034381
Epoch 23
Loss = 1.2256e-03, PNorm = 52.6504, GNorm = 1.2636, lr_0 = 1.5416e-04
Loss = 1.8554e-03, PNorm = 52.6553, GNorm = 1.0904, lr_0 = 1.4763e-04
Loss = 3.3131e-03, PNorm = 52.6555, GNorm = 1.2501, lr_0 = 1.4699e-04
Validation rmse = 1.021637
Epoch 24
Loss = 1.3918e-03, PNorm = 52.6584, GNorm = 1.1958, lr_0 = 1.4077e-04
Loss = 1.6334e-03, PNorm = 52.6619, GNorm = 0.8409, lr_0 = 1.3480e-04
Validation rmse = 1.038762
Epoch 25
Loss = 1.6596e-03, PNorm = 52.6653, GNorm = 0.5723, lr_0 = 1.2909e-04
Loss = 1.4455e-03, PNorm = 52.6683, GNorm = 1.1050, lr_0 = 1.2362e-04
Validation rmse = 1.049675
Epoch 26
Loss = 1.6492e-03, PNorm = 52.6724, GNorm = 0.7441, lr_0 = 1.1839e-04
Validation rmse = 1.064904
Epoch 27
Loss = 1.0347e-03, PNorm = 52.6757, GNorm = 0.8818, lr_0 = 1.1288e-04
Loss = 1.2912e-03, PNorm = 52.6788, GNorm = 1.2150, lr_0 = 1.0810e-04
Validation rmse = 1.029100
Epoch 28
Loss = 1.1398e-03, PNorm = 52.6814, GNorm = 0.6903, lr_0 = 1.0352e-04
Loss = 1.3045e-03, PNorm = 52.6837, GNorm = 0.6483, lr_0 = 1.0000e-04
Validation rmse = 1.034837
Epoch 29
Loss = 1.6612e-03, PNorm = 52.6859, GNorm = 0.8520, lr_0 = 1.0000e-04
Loss = 1.4530e-03, PNorm = 52.6879, GNorm = 0.9809, lr_0 = 1.0000e-04
Validation rmse = 1.024445
Model 0 best validation rmse = 1.010573 on epoch 19
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.100836
Ensemble test rmse = 1.100836
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.2_ffn_num_layers_3_hidden_size_600/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total scaffolds = 195 | train scaffolds = 80 | val scaffolds = 54 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=600, bias=False)
      (W_h): Linear(in_features=600, out_features=600, bias=False)
      (W_o): Linear(in_features=733, out_features=600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=604, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.2, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,612,801
Moving model to cuda
Epoch 0
Loss = 1.4592e-02, PNorm = 51.9388, GNorm = 6.4981, lr_0 = 3.6053e-04
Validation rmse = 1.479255
Epoch 1
Loss = 8.4904e-03, PNorm = 51.9658, GNorm = 4.9357, lr_0 = 6.2105e-04
Loss = 5.0171e-03, PNorm = 52.0036, GNorm = 1.9800, lr_0 = 8.5789e-04
Validation rmse = 1.294799
Epoch 2
Loss = 5.1768e-03, PNorm = 52.0528, GNorm = 2.1445, lr_0 = 9.8284e-04
Loss = 5.1227e-03, PNorm = 52.0923, GNorm = 1.8158, lr_0 = 9.4120e-04
Validation rmse = 1.522004
Epoch 3
Loss = 8.1652e-03, PNorm = 52.1338, GNorm = 2.7018, lr_0 = 8.9744e-04
Loss = 3.8252e-03, PNorm = 52.1756, GNorm = 1.4255, lr_0 = 8.5943e-04
Validation rmse = 1.097161
Epoch 4
Loss = 3.5994e-03, PNorm = 52.1979, GNorm = 1.1141, lr_0 = 8.2303e-04
Loss = 3.5076e-03, PNorm = 52.2242, GNorm = 0.7700, lr_0 = 7.8816e-04
Validation rmse = 1.290257
Epoch 5
Loss = 3.5064e-03, PNorm = 52.2446, GNorm = 2.2725, lr_0 = 7.5478e-04
Loss = 3.3175e-03, PNorm = 52.2692, GNorm = 0.9982, lr_0 = 7.2281e-04
Validation rmse = 1.245793
Epoch 6
Loss = 3.0144e-03, PNorm = 52.2935, GNorm = 1.7332, lr_0 = 6.8920e-04
Loss = 2.9356e-03, PNorm = 52.3131, GNorm = 1.2885, lr_0 = 6.6001e-04
Validation rmse = 1.096417
Epoch 7
Loss = 2.4153e-03, PNorm = 52.3316, GNorm = 1.0605, lr_0 = 6.3205e-04
Loss = 2.1302e-03, PNorm = 52.3514, GNorm = 1.0289, lr_0 = 6.0528e-04
Validation rmse = 1.074424
Epoch 8
Loss = 2.3891e-03, PNorm = 52.3695, GNorm = 1.0614, lr_0 = 5.7714e-04
Loss = 2.0921e-03, PNorm = 52.3890, GNorm = 0.6666, lr_0 = 5.5269e-04
Validation rmse = 1.150549
Epoch 9
Loss = 1.8659e-03, PNorm = 52.4055, GNorm = 0.8020, lr_0 = 5.2928e-04
Loss = 2.1171e-03, PNorm = 52.4233, GNorm = 2.0476, lr_0 = 5.0686e-04
Validation rmse = 1.105076
Epoch 10
Loss = 2.0893e-03, PNorm = 52.4374, GNorm = 1.0606, lr_0 = 4.8539e-04
Loss = 1.9394e-03, PNorm = 52.4537, GNorm = 0.8455, lr_0 = 4.6483e-04
Validation rmse = 1.110281
Epoch 11
Loss = 1.7741e-03, PNorm = 52.4724, GNorm = 0.6262, lr_0 = 4.4322e-04
Loss = 2.0709e-03, PNorm = 52.4875, GNorm = 0.8204, lr_0 = 4.2444e-04
Validation rmse = 1.083330
Epoch 12
Loss = 1.8983e-03, PNorm = 52.4992, GNorm = 0.6989, lr_0 = 4.0646e-04
Loss = 1.9131e-03, PNorm = 52.5087, GNorm = 1.2306, lr_0 = 3.8925e-04
Validation rmse = 1.112192
Epoch 13
Loss = 1.8059e-03, PNorm = 52.5208, GNorm = 0.9889, lr_0 = 3.7276e-04
Loss = 1.8983e-03, PNorm = 52.5302, GNorm = 0.7903, lr_0 = 3.5697e-04
Validation rmse = 1.082542
Epoch 14
Loss = 1.9347e-03, PNorm = 52.5426, GNorm = 1.2347, lr_0 = 3.4037e-04
Loss = 1.6124e-03, PNorm = 52.5533, GNorm = 1.0402, lr_0 = 3.2596e-04
Validation rmse = 1.225344
Epoch 15
Loss = 1.7732e-03, PNorm = 52.5642, GNorm = 1.5825, lr_0 = 3.1215e-04
Loss = 1.8514e-03, PNorm = 52.5731, GNorm = 1.7747, lr_0 = 2.9893e-04
Validation rmse = 1.089640
Epoch 16
Loss = 1.4007e-03, PNorm = 52.5820, GNorm = 0.8221, lr_0 = 2.8503e-04
Loss = 1.7088e-03, PNorm = 52.5911, GNorm = 0.6435, lr_0 = 2.7295e-04
Validation rmse = 1.021733
Epoch 17
Loss = 1.3015e-03, PNorm = 52.5969, GNorm = 0.5555, lr_0 = 2.6139e-04
Loss = 1.6569e-03, PNorm = 52.6041, GNorm = 1.0680, lr_0 = 2.5032e-04
Validation rmse = 1.052420
Epoch 18
Loss = 1.5135e-03, PNorm = 52.6108, GNorm = 0.7687, lr_0 = 2.3972e-04
Loss = 1.5576e-03, PNorm = 52.6183, GNorm = 0.3688, lr_0 = 2.2956e-04
Validation rmse = 1.103248
Epoch 19
Loss = 1.5170e-03, PNorm = 52.6246, GNorm = 0.9074, lr_0 = 2.1889e-04
Loss = 1.4057e-03, PNorm = 52.6303, GNorm = 1.3970, lr_0 = 2.0962e-04
Validation rmse = 1.067309
Epoch 20
Loss = 1.3859e-03, PNorm = 52.6349, GNorm = 0.9468, lr_0 = 2.0074e-04
Loss = 1.6251e-03, PNorm = 52.6394, GNorm = 0.8800, lr_0 = 1.9224e-04
Validation rmse = 1.170830
Epoch 21
Loss = 1.5781e-03, PNorm = 52.6452, GNorm = 0.9800, lr_0 = 1.8409e-04
Loss = 1.7068e-03, PNorm = 52.6505, GNorm = 1.5451, lr_0 = 1.7630e-04
Validation rmse = 1.142290
Epoch 22
Loss = 1.5621e-03, PNorm = 52.6573, GNorm = 0.8251, lr_0 = 1.6810e-04
Loss = 1.2072e-03, PNorm = 52.6627, GNorm = 0.6757, lr_0 = 1.6098e-04
Validation rmse = 1.029834
Epoch 23
Loss = 1.3500e-03, PNorm = 52.6665, GNorm = 0.9781, lr_0 = 1.5416e-04
Loss = 1.4106e-03, PNorm = 52.6707, GNorm = 1.4464, lr_0 = 1.4763e-04
Loss = 3.2604e-03, PNorm = 52.6711, GNorm = 1.7670, lr_0 = 1.4699e-04
Validation rmse = 1.053012
Epoch 24
Loss = 1.2078e-03, PNorm = 52.6748, GNorm = 1.1771, lr_0 = 1.4077e-04
Loss = 1.2972e-03, PNorm = 52.6786, GNorm = 1.1646, lr_0 = 1.3480e-04
Validation rmse = 1.048046
Epoch 25
Loss = 1.1591e-03, PNorm = 52.6808, GNorm = 0.6847, lr_0 = 1.2909e-04
Loss = 1.2676e-03, PNorm = 52.6831, GNorm = 1.3556, lr_0 = 1.2362e-04
Validation rmse = 1.056358
Epoch 26
Loss = 1.4337e-03, PNorm = 52.6854, GNorm = 0.7437, lr_0 = 1.1839e-04
Validation rmse = 1.110430
Epoch 27
Loss = 2.2033e-03, PNorm = 52.6884, GNorm = 1.1219, lr_0 = 1.1288e-04
Loss = 1.2691e-03, PNorm = 52.6918, GNorm = 0.9200, lr_0 = 1.0810e-04
Validation rmse = 1.039958
Epoch 28
Loss = 1.2509e-03, PNorm = 52.6944, GNorm = 1.1817, lr_0 = 1.0352e-04
Loss = 1.3491e-03, PNorm = 52.6973, GNorm = 0.9686, lr_0 = 1.0000e-04
Validation rmse = 1.067301
Epoch 29
Loss = 1.1456e-03, PNorm = 52.7009, GNorm = 0.5366, lr_0 = 1.0000e-04
Loss = 1.1061e-03, PNorm = 52.7030, GNorm = 0.7011, lr_0 = 1.0000e-04
Validation rmse = 1.072497
Model 0 best validation rmse = 1.021733 on epoch 16
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.971415
Ensemble test rmse = 0.971415
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.2_ffn_num_layers_3_hidden_size_600/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 49 | test scaffolds = 62
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=600, bias=False)
      (W_h): Linear(in_features=600, out_features=600, bias=False)
      (W_o): Linear(in_features=733, out_features=600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=604, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.2, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,612,801
Moving model to cuda
Epoch 0
Loss = 1.5384e-02, PNorm = 51.9363, GNorm = 4.9501, lr_0 = 3.6053e-04
Validation rmse = 1.216464
Epoch 1
Loss = 1.3664e-02, PNorm = 51.9671, GNorm = 6.9389, lr_0 = 6.2105e-04
Loss = 6.6203e-03, PNorm = 52.0062, GNorm = 1.8599, lr_0 = 8.5789e-04
Validation rmse = 1.055492
Epoch 2
Loss = 3.0199e-03, PNorm = 52.0512, GNorm = 1.2180, lr_0 = 9.8284e-04
Loss = 4.9359e-03, PNorm = 52.0928, GNorm = 2.4575, lr_0 = 9.4120e-04
Validation rmse = 1.354491
Epoch 3
Loss = 3.3792e-03, PNorm = 52.1321, GNorm = 0.8976, lr_0 = 8.9744e-04
Loss = 3.5958e-03, PNorm = 52.1628, GNorm = 0.9451, lr_0 = 8.5943e-04
Validation rmse = 0.937550
Epoch 4
Loss = 3.2172e-03, PNorm = 52.1885, GNorm = 1.6131, lr_0 = 8.2303e-04
Loss = 2.8968e-03, PNorm = 52.2139, GNorm = 1.1965, lr_0 = 7.8816e-04
Validation rmse = 0.926972
Epoch 5
Loss = 3.2782e-03, PNorm = 52.2350, GNorm = 1.6732, lr_0 = 7.5478e-04
Loss = 3.1285e-03, PNorm = 52.2574, GNorm = 3.5953, lr_0 = 7.2281e-04
Validation rmse = 0.913409
Epoch 6
Loss = 2.0674e-03, PNorm = 52.2827, GNorm = 1.0894, lr_0 = 6.8920e-04
Loss = 2.7966e-03, PNorm = 52.3020, GNorm = 0.7274, lr_0 = 6.6001e-04
Validation rmse = 0.993375
Epoch 7
Loss = 2.0472e-03, PNorm = 52.3229, GNorm = 0.9270, lr_0 = 6.3205e-04
Loss = 2.6768e-03, PNorm = 52.3395, GNorm = 0.9245, lr_0 = 6.0528e-04
Validation rmse = 1.208526
Epoch 8
Loss = 2.5697e-03, PNorm = 52.3601, GNorm = 2.9141, lr_0 = 5.7714e-04
Loss = 2.6460e-03, PNorm = 52.3757, GNorm = 1.0523, lr_0 = 5.5269e-04
Validation rmse = 0.913890
Epoch 9
Loss = 1.8805e-03, PNorm = 52.3947, GNorm = 1.6440, lr_0 = 5.2928e-04
Loss = 2.2549e-03, PNorm = 52.4103, GNorm = 1.4869, lr_0 = 5.0686e-04
Validation rmse = 0.905730
Epoch 10
Loss = 2.7606e-03, PNorm = 52.4222, GNorm = 2.5925, lr_0 = 4.8539e-04
Loss = 2.8557e-03, PNorm = 52.4392, GNorm = 2.5746, lr_0 = 4.6483e-04
Validation rmse = 0.903819
Epoch 11
Loss = 2.5452e-03, PNorm = 52.4525, GNorm = 0.7385, lr_0 = 4.4322e-04
Loss = 2.0250e-03, PNorm = 52.4654, GNorm = 0.9760, lr_0 = 4.2444e-04
Validation rmse = 0.971591
Epoch 12
Loss = 1.6650e-03, PNorm = 52.4752, GNorm = 0.6748, lr_0 = 4.0646e-04
Loss = 1.9950e-03, PNorm = 52.4864, GNorm = 1.7674, lr_0 = 3.8925e-04
Validation rmse = 0.905126
Epoch 13
Loss = 1.9273e-03, PNorm = 52.4962, GNorm = 1.5693, lr_0 = 3.7276e-04
Loss = 1.7605e-03, PNorm = 52.5066, GNorm = 0.8925, lr_0 = 3.5697e-04
Validation rmse = 0.897093
Epoch 14
Loss = 1.7822e-03, PNorm = 52.5155, GNorm = 0.4673, lr_0 = 3.4037e-04
Loss = 1.9656e-03, PNorm = 52.5230, GNorm = 0.9961, lr_0 = 3.2596e-04
Validation rmse = 0.876625
Epoch 15
Loss = 1.6485e-03, PNorm = 52.5308, GNorm = 0.7154, lr_0 = 3.1215e-04
Loss = 1.6740e-03, PNorm = 52.5366, GNorm = 0.6927, lr_0 = 2.9893e-04
Validation rmse = 0.883088
Epoch 16
Loss = 1.5289e-03, PNorm = 52.5463, GNorm = 0.5640, lr_0 = 2.8503e-04
Loss = 1.7024e-03, PNorm = 52.5530, GNorm = 0.3758, lr_0 = 2.7295e-04
Validation rmse = 0.846612
Epoch 17
Loss = 1.5908e-03, PNorm = 52.5599, GNorm = 0.9139, lr_0 = 2.6139e-04
Loss = 1.8432e-03, PNorm = 52.5655, GNorm = 0.9695, lr_0 = 2.5032e-04
Validation rmse = 0.868405
Epoch 18
Loss = 1.9069e-03, PNorm = 52.5728, GNorm = 1.8849, lr_0 = 2.3972e-04
Loss = 1.5511e-03, PNorm = 52.5794, GNorm = 0.7544, lr_0 = 2.2956e-04
Validation rmse = 0.908954
Epoch 19
Loss = 1.3689e-03, PNorm = 52.5852, GNorm = 1.0210, lr_0 = 2.1889e-04
Loss = 1.7535e-03, PNorm = 52.5904, GNorm = 1.9686, lr_0 = 2.0962e-04
Validation rmse = 0.920081
Epoch 20
Loss = 1.6261e-03, PNorm = 52.5961, GNorm = 0.7927, lr_0 = 2.0074e-04
Loss = 1.3972e-03, PNorm = 52.6000, GNorm = 1.8842, lr_0 = 1.9224e-04
Validation rmse = 0.950031
Epoch 21
Loss = 1.6083e-03, PNorm = 52.6049, GNorm = 0.6534, lr_0 = 1.8409e-04
Loss = 1.6885e-03, PNorm = 52.6099, GNorm = 0.6310, lr_0 = 1.7630e-04
Validation rmse = 0.901985
Epoch 22
Loss = 1.4168e-03, PNorm = 52.6155, GNorm = 0.5761, lr_0 = 1.6810e-04
Loss = 1.7217e-03, PNorm = 52.6187, GNorm = 0.5156, lr_0 = 1.6098e-04
Validation rmse = 0.976834
Epoch 23
Loss = 1.5504e-03, PNorm = 52.6226, GNorm = 1.3834, lr_0 = 1.5416e-04
Loss = 1.3330e-03, PNorm = 52.6244, GNorm = 0.6228, lr_0 = 1.4763e-04
Loss = 2.5544e-03, PNorm = 52.6247, GNorm = 0.6227, lr_0 = 1.4699e-04
Validation rmse = 0.862308
Epoch 24
Loss = 1.3455e-03, PNorm = 52.6284, GNorm = 1.0593, lr_0 = 1.4077e-04
Loss = 1.6228e-03, PNorm = 52.6322, GNorm = 1.1104, lr_0 = 1.3480e-04
Validation rmse = 0.972046
Epoch 25
Loss = 1.3716e-03, PNorm = 52.6357, GNorm = 0.9706, lr_0 = 1.2909e-04
Loss = 1.9370e-03, PNorm = 52.6389, GNorm = 1.3030, lr_0 = 1.2362e-04
Validation rmse = 0.842680
Epoch 26
Loss = 1.4693e-03, PNorm = 52.6422, GNorm = 0.9374, lr_0 = 1.1839e-04
Validation rmse = 0.851115
Epoch 27
Loss = 8.9594e-04, PNorm = 52.6453, GNorm = 0.5966, lr_0 = 1.1288e-04
Loss = 1.2497e-03, PNorm = 52.6467, GNorm = 0.9683, lr_0 = 1.0810e-04
Validation rmse = 0.841059
Epoch 28
Loss = 1.0509e-03, PNorm = 52.6496, GNorm = 0.7262, lr_0 = 1.0352e-04
Loss = 1.4312e-03, PNorm = 52.6515, GNorm = 0.8342, lr_0 = 1.0000e-04
Validation rmse = 0.936997
Epoch 29
Loss = 1.3407e-03, PNorm = 52.6528, GNorm = 1.1110, lr_0 = 1.0000e-04
Loss = 1.5786e-03, PNorm = 52.6559, GNorm = 1.7708, lr_0 = 1.0000e-04
Validation rmse = 0.876562
Model 0 best validation rmse = 0.841059 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.015535
Ensemble test rmse = 1.015535
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.2_ffn_num_layers_3_hidden_size_600/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total scaffolds = 195 | train scaffolds = 94 | val scaffolds = 55 | test scaffolds = 46
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=600, bias=False)
      (W_h): Linear(in_features=600, out_features=600, bias=False)
      (W_o): Linear(in_features=733, out_features=600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=604, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.2, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,612,801
Moving model to cuda
Epoch 0
Loss = 1.4952e-02, PNorm = 51.9373, GNorm = 3.5675, lr_0 = 3.6053e-04
Validation rmse = 1.452728
Epoch 1
Loss = 5.8151e-03, PNorm = 51.9678, GNorm = 2.5520, lr_0 = 6.2105e-04
Loss = 4.7440e-03, PNorm = 52.0056, GNorm = 1.3794, lr_0 = 8.5789e-04
Validation rmse = 1.347958
Epoch 2
Loss = 5.3372e-03, PNorm = 52.0551, GNorm = 1.4132, lr_0 = 9.8284e-04
Loss = 4.2586e-03, PNorm = 52.1003, GNorm = 2.0539, lr_0 = 9.4120e-04
Validation rmse = 1.340068
Epoch 3
Loss = 5.8812e-03, PNorm = 52.1386, GNorm = 3.8935, lr_0 = 8.9744e-04
Loss = 4.4904e-03, PNorm = 52.1740, GNorm = 1.2425, lr_0 = 8.5943e-04
Validation rmse = 1.223484
Epoch 4
Loss = 3.4418e-03, PNorm = 52.2033, GNorm = 2.9209, lr_0 = 8.2303e-04
Loss = 3.4227e-03, PNorm = 52.2322, GNorm = 0.9645, lr_0 = 7.8816e-04
Validation rmse = 1.163092
Epoch 5
Loss = 2.5182e-03, PNorm = 52.2519, GNorm = 1.4359, lr_0 = 7.5478e-04
Loss = 2.3745e-03, PNorm = 52.2731, GNorm = 0.9381, lr_0 = 7.2281e-04
Validation rmse = 1.087578
Epoch 6
Loss = 3.3368e-03, PNorm = 52.2925, GNorm = 1.3375, lr_0 = 6.8920e-04
Loss = 3.0300e-03, PNorm = 52.3150, GNorm = 2.2194, lr_0 = 6.6001e-04
Validation rmse = 1.252529
Epoch 7
Loss = 2.9254e-03, PNorm = 52.3321, GNorm = 1.7994, lr_0 = 6.3205e-04
Loss = 2.1798e-03, PNorm = 52.3539, GNorm = 0.6027, lr_0 = 6.0528e-04
Validation rmse = 1.118811
Epoch 8
Loss = 2.0376e-03, PNorm = 52.3705, GNorm = 1.1026, lr_0 = 5.7714e-04
Loss = 2.5458e-03, PNorm = 52.3853, GNorm = 0.9231, lr_0 = 5.5269e-04
Validation rmse = 1.046326
Epoch 9
Loss = 2.3376e-03, PNorm = 52.3995, GNorm = 0.5738, lr_0 = 5.2928e-04
Loss = 2.2968e-03, PNorm = 52.4148, GNorm = 0.4412, lr_0 = 5.0686e-04
Validation rmse = 1.263779
Epoch 10
Loss = 2.5651e-03, PNorm = 52.4298, GNorm = 2.1628, lr_0 = 4.8539e-04
Loss = 2.4383e-03, PNorm = 52.4432, GNorm = 1.3728, lr_0 = 4.6483e-04
Validation rmse = 1.027414
Epoch 11
Loss = 2.0536e-03, PNorm = 52.4595, GNorm = 0.9008, lr_0 = 4.4322e-04
Loss = 2.2569e-03, PNorm = 52.4741, GNorm = 1.1651, lr_0 = 4.2444e-04
Validation rmse = 1.192135
Epoch 12
Loss = 1.7885e-03, PNorm = 52.4847, GNorm = 0.7773, lr_0 = 4.0646e-04
Loss = 2.0025e-03, PNorm = 52.4975, GNorm = 0.9926, lr_0 = 3.8925e-04
Validation rmse = 0.995701
Epoch 13
Loss = 2.1248e-03, PNorm = 52.5068, GNorm = 1.3795, lr_0 = 3.7276e-04
Loss = 2.1568e-03, PNorm = 52.5161, GNorm = 0.8942, lr_0 = 3.5697e-04
Validation rmse = 1.208542
Epoch 14
Loss = 2.2835e-03, PNorm = 52.5280, GNorm = 0.9721, lr_0 = 3.4037e-04
Loss = 1.9989e-03, PNorm = 52.5369, GNorm = 1.1965, lr_0 = 3.2596e-04
Validation rmse = 0.991426
Epoch 15
Loss = 2.1610e-03, PNorm = 52.5473, GNorm = 0.6318, lr_0 = 3.1215e-04
Loss = 1.7431e-03, PNorm = 52.5580, GNorm = 1.2887, lr_0 = 2.9893e-04
Validation rmse = 0.990125
Epoch 16
Loss = 1.7621e-03, PNorm = 52.5667, GNorm = 0.7379, lr_0 = 2.8503e-04
Loss = 2.0656e-03, PNorm = 52.5748, GNorm = 0.8866, lr_0 = 2.7295e-04
Validation rmse = 1.052766
Epoch 17
Loss = 1.6993e-03, PNorm = 52.5847, GNorm = 0.7603, lr_0 = 2.6139e-04
Loss = 1.7229e-03, PNorm = 52.5919, GNorm = 0.7370, lr_0 = 2.5032e-04
Validation rmse = 0.975999
Epoch 18
Loss = 1.7561e-03, PNorm = 52.5979, GNorm = 0.5694, lr_0 = 2.3972e-04
Loss = 1.7278e-03, PNorm = 52.6061, GNorm = 0.9682, lr_0 = 2.2956e-04
Validation rmse = 0.985426
Epoch 19
Loss = 1.4501e-03, PNorm = 52.6108, GNorm = 1.8385, lr_0 = 2.1889e-04
Loss = 1.9132e-03, PNorm = 52.6160, GNorm = 0.9065, lr_0 = 2.0962e-04
Validation rmse = 1.046483
Epoch 20
Loss = 1.7196e-03, PNorm = 52.6217, GNorm = 1.2781, lr_0 = 2.0074e-04
Loss = 1.7268e-03, PNorm = 52.6281, GNorm = 1.9448, lr_0 = 1.9224e-04
Validation rmse = 1.089255
Epoch 21
Loss = 1.3565e-03, PNorm = 52.6314, GNorm = 1.3324, lr_0 = 1.8409e-04
Loss = 1.7366e-03, PNorm = 52.6373, GNorm = 0.6877, lr_0 = 1.7630e-04
Validation rmse = 1.010962
Epoch 22
Loss = 1.2922e-03, PNorm = 52.6410, GNorm = 0.5916, lr_0 = 1.6810e-04
Loss = 1.4737e-03, PNorm = 52.6457, GNorm = 0.4645, lr_0 = 1.6098e-04
Validation rmse = 0.957991
Epoch 23
Loss = 1.7244e-03, PNorm = 52.6492, GNorm = 0.5077, lr_0 = 1.5416e-04
Loss = 1.5419e-03, PNorm = 52.6529, GNorm = 1.0120, lr_0 = 1.4763e-04
Loss = 1.2474e-03, PNorm = 52.6534, GNorm = 0.8569, lr_0 = 1.4699e-04
Validation rmse = 0.990169
Epoch 24
Loss = 1.3827e-03, PNorm = 52.6574, GNorm = 0.4609, lr_0 = 1.4077e-04
Loss = 1.4683e-03, PNorm = 52.6600, GNorm = 0.9100, lr_0 = 1.3480e-04
Validation rmse = 1.048226
Epoch 25
Loss = 1.4264e-03, PNorm = 52.6644, GNorm = 0.8560, lr_0 = 1.2909e-04
Loss = 1.6086e-03, PNorm = 52.6671, GNorm = 1.9581, lr_0 = 1.2362e-04
Validation rmse = 1.048843
Epoch 26
Loss = 1.2487e-03, PNorm = 52.6697, GNorm = 0.9216, lr_0 = 1.1839e-04
Validation rmse = 1.011489
Epoch 27
Loss = 1.1511e-03, PNorm = 52.6729, GNorm = 0.5340, lr_0 = 1.1288e-04
Loss = 1.3070e-03, PNorm = 52.6754, GNorm = 0.5302, lr_0 = 1.0810e-04
Validation rmse = 0.948955
Epoch 28
Loss = 1.2637e-03, PNorm = 52.6784, GNorm = 0.9736, lr_0 = 1.0352e-04
Loss = 1.4657e-03, PNorm = 52.6807, GNorm = 1.4257, lr_0 = 1.0000e-04
Validation rmse = 0.976974
Epoch 29
Loss = 1.0763e-03, PNorm = 52.6842, GNorm = 0.3636, lr_0 = 1.0000e-04
Loss = 1.2406e-03, PNorm = 52.6865, GNorm = 0.7501, lr_0 = 1.0000e-04
Validation rmse = 0.964077
Model 0 best validation rmse = 0.948955 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.051470
Ensemble test rmse = 1.051470
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.2_ffn_num_layers_3_hidden_size_600/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total scaffolds = 195 | train scaffolds = 64 | val scaffolds = 68 | test scaffolds = 63
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=600, bias=False)
      (W_h): Linear(in_features=600, out_features=600, bias=False)
      (W_o): Linear(in_features=733, out_features=600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=604, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.2, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,612,801
Moving model to cuda
Epoch 0
Loss = 1.5722e-02, PNorm = 51.9372, GNorm = 2.7543, lr_0 = 3.6053e-04
Validation rmse = 1.739097
Epoch 1
Loss = 6.6252e-03, PNorm = 51.9673, GNorm = 2.2731, lr_0 = 6.2105e-04
Loss = 5.6673e-03, PNorm = 52.0083, GNorm = 3.6344, lr_0 = 8.5789e-04
Validation rmse = 1.465675
Epoch 2
Loss = 5.9652e-03, PNorm = 52.0547, GNorm = 2.9791, lr_0 = 9.8284e-04
Loss = 4.2714e-03, PNorm = 52.0972, GNorm = 1.1239, lr_0 = 9.4120e-04
Validation rmse = 1.358962
Epoch 3
Loss = 3.9019e-03, PNorm = 52.1340, GNorm = 1.3124, lr_0 = 8.9744e-04
Loss = 2.8456e-03, PNorm = 52.1608, GNorm = 1.2623, lr_0 = 8.5943e-04
Validation rmse = 1.149988
Epoch 4
Loss = 3.2488e-03, PNorm = 52.1896, GNorm = 0.9372, lr_0 = 8.2303e-04
Loss = 2.9800e-03, PNorm = 52.2178, GNorm = 1.5085, lr_0 = 7.8816e-04
Validation rmse = 1.356975
Epoch 5
Loss = 2.7823e-03, PNorm = 52.2414, GNorm = 1.1825, lr_0 = 7.5478e-04
Loss = 2.7240e-03, PNorm = 52.2618, GNorm = 1.4383, lr_0 = 7.2281e-04
Validation rmse = 1.411962
Epoch 6
Loss = 2.6736e-03, PNorm = 52.2865, GNorm = 0.8641, lr_0 = 6.8920e-04
Loss = 2.6461e-03, PNorm = 52.3089, GNorm = 1.4289, lr_0 = 6.6001e-04
Validation rmse = 1.105174
Epoch 7
Loss = 3.4532e-03, PNorm = 52.3312, GNorm = 0.6747, lr_0 = 6.3205e-04
Loss = 2.2293e-03, PNorm = 52.3540, GNorm = 1.2306, lr_0 = 6.0528e-04
Validation rmse = 1.073652
Epoch 8
Loss = 2.2193e-03, PNorm = 52.3770, GNorm = 0.9352, lr_0 = 5.7714e-04
Loss = 2.3569e-03, PNorm = 52.3950, GNorm = 0.5390, lr_0 = 5.5269e-04
Validation rmse = 1.382874
Epoch 9
Loss = 2.7615e-03, PNorm = 52.4148, GNorm = 1.2270, lr_0 = 5.2928e-04
Loss = 2.0124e-03, PNorm = 52.4321, GNorm = 0.7074, lr_0 = 5.0686e-04
Validation rmse = 1.063388
Epoch 10
Loss = 2.3062e-03, PNorm = 52.4485, GNorm = 1.2953, lr_0 = 4.8539e-04
Loss = 2.0323e-03, PNorm = 52.4643, GNorm = 1.8593, lr_0 = 4.6483e-04
Validation rmse = 1.170734
Epoch 11
Loss = 2.0902e-03, PNorm = 52.4775, GNorm = 1.1991, lr_0 = 4.4322e-04
Loss = 1.9751e-03, PNorm = 52.4903, GNorm = 1.6362, lr_0 = 4.2444e-04
Validation rmse = 1.063275
Epoch 12
Loss = 1.8194e-03, PNorm = 52.4997, GNorm = 0.6019, lr_0 = 4.0646e-04
Loss = 2.1885e-03, PNorm = 52.5081, GNorm = 1.4582, lr_0 = 3.8925e-04
Validation rmse = 1.071134
Epoch 13
Loss = 1.6183e-03, PNorm = 52.5213, GNorm = 0.9044, lr_0 = 3.7276e-04
Loss = 1.8084e-03, PNorm = 52.5330, GNorm = 1.4806, lr_0 = 3.5697e-04
Validation rmse = 1.081456
Epoch 14
Loss = 1.7008e-03, PNorm = 52.5456, GNorm = 1.1489, lr_0 = 3.4037e-04
Loss = 1.7919e-03, PNorm = 52.5557, GNorm = 1.0431, lr_0 = 3.2596e-04
Validation rmse = 1.060202
Epoch 15
Loss = 1.5621e-03, PNorm = 52.5659, GNorm = 0.7988, lr_0 = 3.1215e-04
Loss = 1.6181e-03, PNorm = 52.5722, GNorm = 1.3524, lr_0 = 2.9893e-04
Validation rmse = 1.029154
Epoch 16
Loss = 1.5832e-03, PNorm = 52.5820, GNorm = 0.8179, lr_0 = 2.8503e-04
Loss = 1.6650e-03, PNorm = 52.5888, GNorm = 0.8649, lr_0 = 2.7295e-04
Validation rmse = 1.015429
Epoch 17
Loss = 1.7761e-03, PNorm = 52.5970, GNorm = 0.7237, lr_0 = 2.6139e-04
Loss = 1.6113e-03, PNorm = 52.6021, GNorm = 0.8554, lr_0 = 2.5032e-04
Validation rmse = 1.083120
Epoch 18
Loss = 1.9474e-03, PNorm = 52.6107, GNorm = 0.7344, lr_0 = 2.3972e-04
Loss = 1.7628e-03, PNorm = 52.6178, GNorm = 0.4402, lr_0 = 2.2956e-04
Validation rmse = 1.102071
Epoch 19
Loss = 1.5142e-03, PNorm = 52.6256, GNorm = 0.6131, lr_0 = 2.1889e-04
Loss = 1.5716e-03, PNorm = 52.6305, GNorm = 0.4624, lr_0 = 2.0962e-04
Validation rmse = 1.099772
Epoch 20
Loss = 1.5017e-03, PNorm = 52.6356, GNorm = 0.9179, lr_0 = 2.0074e-04
Loss = 1.5130e-03, PNorm = 52.6401, GNorm = 0.5816, lr_0 = 1.9224e-04
Validation rmse = 1.097839
Epoch 21
Loss = 1.2289e-03, PNorm = 52.6460, GNorm = 0.6549, lr_0 = 1.8409e-04
Loss = 1.4038e-03, PNorm = 52.6514, GNorm = 0.9038, lr_0 = 1.7630e-04
Validation rmse = 1.113034
Epoch 22
Loss = 1.5279e-03, PNorm = 52.6556, GNorm = 0.7701, lr_0 = 1.6810e-04
Loss = 1.3450e-03, PNorm = 52.6594, GNorm = 1.3148, lr_0 = 1.6098e-04
Validation rmse = 1.052289
Epoch 23
Loss = 1.4949e-03, PNorm = 52.6637, GNorm = 1.0416, lr_0 = 1.5416e-04
Loss = 1.3364e-03, PNorm = 52.6688, GNorm = 0.7705, lr_0 = 1.4763e-04
Loss = 4.5629e-03, PNorm = 52.6692, GNorm = 1.5478, lr_0 = 1.4699e-04
Validation rmse = 1.105008
Epoch 24
Loss = 1.2428e-03, PNorm = 52.6719, GNorm = 0.6138, lr_0 = 1.4077e-04
Loss = 1.2582e-03, PNorm = 52.6758, GNorm = 1.1967, lr_0 = 1.3480e-04
Validation rmse = 1.077120
Epoch 25
Loss = 1.2570e-03, PNorm = 52.6780, GNorm = 0.8413, lr_0 = 1.2909e-04
Loss = 1.5340e-03, PNorm = 52.6803, GNorm = 0.9354, lr_0 = 1.2362e-04
Validation rmse = 1.043600
Epoch 26
Loss = 1.3121e-03, PNorm = 52.6830, GNorm = 0.7806, lr_0 = 1.1839e-04
Validation rmse = 1.035743
Epoch 27
Loss = 1.7373e-03, PNorm = 52.6871, GNorm = 1.2108, lr_0 = 1.1288e-04
Loss = 1.2558e-03, PNorm = 52.6896, GNorm = 0.6721, lr_0 = 1.0810e-04
Validation rmse = 1.043748
Epoch 28
Loss = 1.0943e-03, PNorm = 52.6924, GNorm = 0.7484, lr_0 = 1.0352e-04
Loss = 1.2032e-03, PNorm = 52.6947, GNorm = 0.7854, lr_0 = 1.0000e-04
Validation rmse = 1.167318
Epoch 29
Loss = 1.0316e-03, PNorm = 52.6975, GNorm = 0.9003, lr_0 = 1.0000e-04
Loss = 1.1476e-03, PNorm = 52.7007, GNorm = 0.5985, lr_0 = 1.0000e-04
Validation rmse = 1.061985
Model 0 best validation rmse = 1.015429 on epoch 16
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.899815
Ensemble test rmse = 0.899815
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.2_ffn_num_layers_3_hidden_size_600/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total scaffolds = 195 | train scaffolds = 69 | val scaffolds = 65 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=600, bias=False)
      (W_h): Linear(in_features=600, out_features=600, bias=False)
      (W_o): Linear(in_features=733, out_features=600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=604, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.2, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,612,801
Moving model to cuda
Epoch 0
Loss = 1.5635e-02, PNorm = 51.9381, GNorm = 4.8180, lr_0 = 3.6053e-04
Validation rmse = 1.807432
Epoch 1
Loss = 6.6428e-03, PNorm = 51.9700, GNorm = 5.4466, lr_0 = 6.2105e-04
Loss = 6.4655e-03, PNorm = 52.0090, GNorm = 2.0146, lr_0 = 8.5789e-04
Validation rmse = 1.587267
Epoch 2
Loss = 4.3797e-03, PNorm = 52.0636, GNorm = 1.6347, lr_0 = 9.8284e-04
Loss = 4.8712e-03, PNorm = 52.1087, GNorm = 1.1423, lr_0 = 9.4120e-04
Validation rmse = 1.630745
Epoch 3
Loss = 3.2576e-03, PNorm = 52.1447, GNorm = 0.6327, lr_0 = 8.9744e-04
Loss = 3.8580e-03, PNorm = 52.1757, GNorm = 2.2989, lr_0 = 8.5943e-04
Validation rmse = 1.303038
Epoch 4
Loss = 3.4294e-03, PNorm = 52.1985, GNorm = 1.8957, lr_0 = 8.2303e-04
Loss = 3.1573e-03, PNorm = 52.2235, GNorm = 2.2585, lr_0 = 7.8816e-04
Validation rmse = 1.277666
Epoch 5
Loss = 2.3043e-03, PNorm = 52.2414, GNorm = 0.8216, lr_0 = 7.5478e-04
Loss = 2.8740e-03, PNorm = 52.2631, GNorm = 0.6224, lr_0 = 7.2281e-04
Validation rmse = 1.442975
Epoch 6
Loss = 3.9779e-03, PNorm = 52.2834, GNorm = 3.4208, lr_0 = 6.8920e-04
Loss = 3.7782e-03, PNorm = 52.3048, GNorm = 0.8292, lr_0 = 6.6001e-04
Validation rmse = 1.326699
Epoch 7
Loss = 2.8264e-03, PNorm = 52.3297, GNorm = 0.7638, lr_0 = 6.3205e-04
Loss = 2.9719e-03, PNorm = 52.3482, GNorm = 0.8306, lr_0 = 6.0528e-04
Validation rmse = 1.286380
Epoch 8
Loss = 2.7694e-03, PNorm = 52.3652, GNorm = 1.2683, lr_0 = 5.7714e-04
Loss = 2.7909e-03, PNorm = 52.3853, GNorm = 2.9405, lr_0 = 5.5269e-04
Validation rmse = 1.469649
Epoch 9
Loss = 2.2729e-03, PNorm = 52.3990, GNorm = 0.7937, lr_0 = 5.2928e-04
Loss = 2.5284e-03, PNorm = 52.4158, GNorm = 1.0339, lr_0 = 5.0686e-04
Validation rmse = 1.300816
Epoch 10
Loss = 2.2953e-03, PNorm = 52.4283, GNorm = 1.2167, lr_0 = 4.8539e-04
Loss = 1.9454e-03, PNorm = 52.4422, GNorm = 0.7997, lr_0 = 4.6483e-04
Validation rmse = 1.272036
Epoch 11
Loss = 2.1892e-03, PNorm = 52.4535, GNorm = 1.0135, lr_0 = 4.4322e-04
Loss = 2.1685e-03, PNorm = 52.4650, GNorm = 1.2313, lr_0 = 4.2444e-04
Validation rmse = 1.281338
Epoch 12
Loss = 2.0447e-03, PNorm = 52.4749, GNorm = 0.9040, lr_0 = 4.0646e-04
Loss = 2.0704e-03, PNorm = 52.4850, GNorm = 1.1819, lr_0 = 3.8925e-04
Validation rmse = 1.261106
Epoch 13
Loss = 1.7867e-03, PNorm = 52.4951, GNorm = 1.4728, lr_0 = 3.7276e-04
Loss = 2.1855e-03, PNorm = 52.5057, GNorm = 1.3470, lr_0 = 3.5697e-04
Validation rmse = 1.329412
Epoch 14
Loss = 1.7461e-03, PNorm = 52.5172, GNorm = 1.3411, lr_0 = 3.4037e-04
Loss = 2.0934e-03, PNorm = 52.5248, GNorm = 1.2278, lr_0 = 3.2596e-04
Validation rmse = 1.293616
Epoch 15
Loss = 1.9455e-03, PNorm = 52.5353, GNorm = 1.1253, lr_0 = 3.1215e-04
Loss = 2.0691e-03, PNorm = 52.5445, GNorm = 0.8402, lr_0 = 2.9893e-04
Validation rmse = 1.445202
Epoch 16
Loss = 2.0530e-03, PNorm = 52.5544, GNorm = 0.6376, lr_0 = 2.8503e-04
Loss = 1.6504e-03, PNorm = 52.5606, GNorm = 0.9794, lr_0 = 2.7295e-04
Validation rmse = 1.411262
Epoch 17
Loss = 1.7264e-03, PNorm = 52.5689, GNorm = 0.8760, lr_0 = 2.6139e-04
Loss = 1.9036e-03, PNorm = 52.5749, GNorm = 0.6024, lr_0 = 2.5032e-04
Validation rmse = 1.321681
Epoch 18
Loss = 1.7077e-03, PNorm = 52.5816, GNorm = 0.6482, lr_0 = 2.3972e-04
Loss = 1.8254e-03, PNorm = 52.5886, GNorm = 0.7879, lr_0 = 2.2956e-04
Validation rmse = 1.350021
Epoch 19
Loss = 1.8193e-03, PNorm = 52.5936, GNorm = 1.1724, lr_0 = 2.1889e-04
Loss = 1.6688e-03, PNorm = 52.6000, GNorm = 0.8098, lr_0 = 2.0962e-04
Validation rmse = 1.255790
Epoch 20
Loss = 1.7729e-03, PNorm = 52.6063, GNorm = 0.8560, lr_0 = 2.0074e-04
Loss = 1.4247e-03, PNorm = 52.6109, GNorm = 0.6009, lr_0 = 1.9224e-04
Validation rmse = 1.426415
Epoch 21
Loss = 1.5879e-03, PNorm = 52.6154, GNorm = 1.6470, lr_0 = 1.8409e-04
Loss = 1.7502e-03, PNorm = 52.6201, GNorm = 1.0002, lr_0 = 1.7630e-04
Validation rmse = 1.509251
Epoch 22
Loss = 1.6504e-03, PNorm = 52.6234, GNorm = 3.0237, lr_0 = 1.6810e-04
Loss = 1.5522e-03, PNorm = 52.6290, GNorm = 1.2794, lr_0 = 1.6098e-04
Validation rmse = 1.260742
Epoch 23
Loss = 1.5197e-03, PNorm = 52.6327, GNorm = 0.8626, lr_0 = 1.5416e-04
Loss = 1.5136e-03, PNorm = 52.6375, GNorm = 0.8858, lr_0 = 1.4763e-04
Loss = 2.6255e-03, PNorm = 52.6378, GNorm = 1.8846, lr_0 = 1.4699e-04
Validation rmse = 1.444751
Epoch 24
Loss = 1.5691e-03, PNorm = 52.6415, GNorm = 1.9718, lr_0 = 1.4077e-04
Loss = 1.3497e-03, PNorm = 52.6451, GNorm = 1.0272, lr_0 = 1.3480e-04
Validation rmse = 1.397113
Epoch 25
Loss = 1.3869e-03, PNorm = 52.6487, GNorm = 1.4469, lr_0 = 1.2909e-04
Loss = 1.5783e-03, PNorm = 52.6505, GNorm = 1.2924, lr_0 = 1.2362e-04
Validation rmse = 1.515725
Epoch 26
Loss = 1.4897e-03, PNorm = 52.6529, GNorm = 1.7496, lr_0 = 1.1839e-04
Validation rmse = 1.473237
Epoch 27
Loss = 1.0040e-03, PNorm = 52.6567, GNorm = 0.6768, lr_0 = 1.1288e-04
Loss = 1.2166e-03, PNorm = 52.6593, GNorm = 0.7936, lr_0 = 1.0810e-04
Validation rmse = 1.484464
Epoch 28
Loss = 2.0518e-03, PNorm = 52.6612, GNorm = 1.5907, lr_0 = 1.0352e-04
Loss = 1.3489e-03, PNorm = 52.6647, GNorm = 0.6172, lr_0 = 1.0000e-04
Validation rmse = 1.422107
Epoch 29
Loss = 1.7006e-03, PNorm = 52.6683, GNorm = 0.8868, lr_0 = 1.0000e-04
Loss = 1.4080e-03, PNorm = 52.6705, GNorm = 1.0243, lr_0 = 1.0000e-04
Validation rmse = 1.440683
Model 0 best validation rmse = 1.255790 on epoch 19
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.884964
Ensemble test rmse = 0.884964
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.2_ffn_num_layers_3_hidden_size_600/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total scaffolds = 195 | train scaffolds = 75 | val scaffolds = 42 | test scaffolds = 78
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=600, bias=False)
      (W_h): Linear(in_features=600, out_features=600, bias=False)
      (W_o): Linear(in_features=733, out_features=600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=604, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.2, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,612,801
Moving model to cuda
Epoch 0
Loss = 1.3980e-02, PNorm = 51.9378, GNorm = 4.6020, lr_0 = 3.6053e-04
Validation rmse = 1.266955
Epoch 1
Loss = 4.4891e-03, PNorm = 51.9701, GNorm = 2.5004, lr_0 = 6.2105e-04
Loss = 6.3906e-03, PNorm = 52.0084, GNorm = 2.1642, lr_0 = 8.5789e-04
Validation rmse = 1.590775
Epoch 2
Loss = 8.1362e-03, PNorm = 52.0571, GNorm = 7.8079, lr_0 = 9.8284e-04
Loss = 5.0264e-03, PNorm = 52.1022, GNorm = 2.8137, lr_0 = 9.4120e-04
Validation rmse = 1.491670
Epoch 3
Loss = 4.4583e-03, PNorm = 52.1415, GNorm = 1.5225, lr_0 = 8.9744e-04
Loss = 3.6710e-03, PNorm = 52.1739, GNorm = 1.5024, lr_0 = 8.5943e-04
Validation rmse = 1.097215
Epoch 4
Loss = 3.5103e-03, PNorm = 52.2058, GNorm = 1.5734, lr_0 = 8.2303e-04
Loss = 3.3598e-03, PNorm = 52.2253, GNorm = 1.1961, lr_0 = 7.8816e-04
Validation rmse = 1.171842
Epoch 5
Loss = 2.4043e-03, PNorm = 52.2483, GNorm = 0.8442, lr_0 = 7.5478e-04
Loss = 2.5279e-03, PNorm = 52.2658, GNorm = 0.6294, lr_0 = 7.2281e-04
Validation rmse = 1.178950
Epoch 6
Loss = 2.3015e-03, PNorm = 52.2852, GNorm = 0.8762, lr_0 = 6.8920e-04
Loss = 2.5501e-03, PNorm = 52.3061, GNorm = 2.0714, lr_0 = 6.6001e-04
Validation rmse = 1.111304
Epoch 7
Loss = 3.1189e-03, PNorm = 52.3230, GNorm = 2.1059, lr_0 = 6.3205e-04
Loss = 2.6146e-03, PNorm = 52.3418, GNorm = 1.0790, lr_0 = 6.0528e-04
Validation rmse = 1.058399
Epoch 8
Loss = 2.2233e-03, PNorm = 52.3624, GNorm = 0.7675, lr_0 = 5.7714e-04
Loss = 1.9784e-03, PNorm = 52.3779, GNorm = 1.0693, lr_0 = 5.5269e-04
Validation rmse = 1.031099
Epoch 9
Loss = 1.7228e-03, PNorm = 52.3923, GNorm = 0.8105, lr_0 = 5.2928e-04
Loss = 2.3253e-03, PNorm = 52.4016, GNorm = 1.4726, lr_0 = 5.0686e-04
Validation rmse = 1.129853
Epoch 10
Loss = 2.1680e-03, PNorm = 52.4169, GNorm = 1.1162, lr_0 = 4.8539e-04
Loss = 2.1915e-03, PNorm = 52.4276, GNorm = 0.7518, lr_0 = 4.6483e-04
Validation rmse = 1.063252
Epoch 11
Loss = 2.1649e-03, PNorm = 52.4432, GNorm = 0.6222, lr_0 = 4.4322e-04
Loss = 1.8368e-03, PNorm = 52.4534, GNorm = 1.2139, lr_0 = 4.2444e-04
Validation rmse = 0.981249
Epoch 12
Loss = 1.7075e-03, PNorm = 52.4651, GNorm = 1.7032, lr_0 = 4.0646e-04
Loss = 1.6370e-03, PNorm = 52.4777, GNorm = 0.9527, lr_0 = 3.8925e-04
Validation rmse = 0.979053
Epoch 13
Loss = 1.9276e-03, PNorm = 52.4882, GNorm = 0.7905, lr_0 = 3.7276e-04
Loss = 1.7369e-03, PNorm = 52.5004, GNorm = 0.9136, lr_0 = 3.5697e-04
Validation rmse = 0.955431
Epoch 14
Loss = 1.6075e-03, PNorm = 52.5110, GNorm = 0.7995, lr_0 = 3.4037e-04
Loss = 1.8184e-03, PNorm = 52.5199, GNorm = 1.5941, lr_0 = 3.2596e-04
Validation rmse = 0.952248
Epoch 15
Loss = 1.3887e-03, PNorm = 52.5282, GNorm = 0.5105, lr_0 = 3.1215e-04
Loss = 1.6900e-03, PNorm = 52.5358, GNorm = 0.6763, lr_0 = 2.9893e-04
Validation rmse = 1.010196
Epoch 16
Loss = 1.5647e-03, PNorm = 52.5451, GNorm = 0.8305, lr_0 = 2.8503e-04
Loss = 2.0021e-03, PNorm = 52.5538, GNorm = 1.1001, lr_0 = 2.7295e-04
Validation rmse = 1.004788
Epoch 17
Loss = 1.5224e-03, PNorm = 52.5588, GNorm = 0.6428, lr_0 = 2.6139e-04
Loss = 1.9437e-03, PNorm = 52.5687, GNorm = 0.5653, lr_0 = 2.5032e-04
Validation rmse = 1.044063
Epoch 18
Loss = 1.9118e-03, PNorm = 52.5754, GNorm = 0.9664, lr_0 = 2.3972e-04
Loss = 1.6676e-03, PNorm = 52.5837, GNorm = 1.0122, lr_0 = 2.2956e-04
Validation rmse = 0.985364
Epoch 19
Loss = 1.3682e-03, PNorm = 52.5905, GNorm = 0.5584, lr_0 = 2.1889e-04
Loss = 1.3391e-03, PNorm = 52.5955, GNorm = 0.4153, lr_0 = 2.0962e-04
Validation rmse = 0.994542
Epoch 20
Loss = 1.4090e-03, PNorm = 52.6021, GNorm = 0.6932, lr_0 = 2.0074e-04
Loss = 1.6000e-03, PNorm = 52.6065, GNorm = 1.1340, lr_0 = 1.9224e-04
Validation rmse = 0.958190
Epoch 21
Loss = 1.4339e-03, PNorm = 52.6128, GNorm = 2.1133, lr_0 = 1.8409e-04
Loss = 1.5741e-03, PNorm = 52.6186, GNorm = 0.8309, lr_0 = 1.7630e-04
Validation rmse = 1.006658
Epoch 22
Loss = 1.3943e-03, PNorm = 52.6232, GNorm = 0.6611, lr_0 = 1.6810e-04
Loss = 1.4149e-03, PNorm = 52.6279, GNorm = 0.7771, lr_0 = 1.6098e-04
Validation rmse = 0.990953
Epoch 23
Loss = 1.3895e-03, PNorm = 52.6322, GNorm = 1.5775, lr_0 = 1.5416e-04
Loss = 1.3506e-03, PNorm = 52.6352, GNorm = 0.8244, lr_0 = 1.4763e-04
Loss = 1.9739e-03, PNorm = 52.6355, GNorm = 0.5938, lr_0 = 1.4699e-04
Validation rmse = 0.955349
Epoch 24
Loss = 1.2196e-03, PNorm = 52.6386, GNorm = 0.8224, lr_0 = 1.4077e-04
Loss = 1.4722e-03, PNorm = 52.6436, GNorm = 0.7405, lr_0 = 1.3480e-04
Validation rmse = 0.944509
Epoch 25
Loss = 1.4742e-03, PNorm = 52.6465, GNorm = 0.9007, lr_0 = 1.2909e-04
Loss = 1.2616e-03, PNorm = 52.6513, GNorm = 1.5176, lr_0 = 1.2362e-04
Validation rmse = 0.970820
Epoch 26
Loss = 1.3736e-03, PNorm = 52.6547, GNorm = 1.1389, lr_0 = 1.1839e-04
Validation rmse = 0.974397
Epoch 27
Loss = 3.1513e-03, PNorm = 52.6575, GNorm = 1.9696, lr_0 = 1.1288e-04
Loss = 1.1334e-03, PNorm = 52.6596, GNorm = 0.7095, lr_0 = 1.0810e-04
Validation rmse = 0.929143
Epoch 28
Loss = 1.4384e-03, PNorm = 52.6623, GNorm = 1.8631, lr_0 = 1.0352e-04
Loss = 1.2640e-03, PNorm = 52.6647, GNorm = 0.5431, lr_0 = 1.0000e-04
Validation rmse = 1.001591
Epoch 29
Loss = 1.2877e-03, PNorm = 52.6680, GNorm = 0.7371, lr_0 = 1.0000e-04
Loss = 1.2328e-03, PNorm = 52.6695, GNorm = 1.0366, lr_0 = 1.0000e-04
Validation rmse = 0.997682
Model 0 best validation rmse = 0.929143 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.051801
Ensemble test rmse = 1.051801
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.2,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.2_ffn_num_layers_3_hidden_size_600/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 58 | test scaffolds = 53
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.2, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=600, bias=False)
      (W_h): Linear(in_features=600, out_features=600, bias=False)
      (W_o): Linear(in_features=733, out_features=600, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=604, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.2, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,612,801
Moving model to cuda
Epoch 0
Loss = 1.5638e-02, PNorm = 51.9380, GNorm = 2.7164, lr_0 = 3.6053e-04
Validation rmse = 1.266006
Epoch 1
Loss = 6.7936e-03, PNorm = 51.9684, GNorm = 4.3279, lr_0 = 6.2105e-04
Loss = 7.4998e-03, PNorm = 52.0087, GNorm = 1.9768, lr_0 = 8.5789e-04
Validation rmse = 1.144230
Epoch 2
Loss = 5.1336e-03, PNorm = 52.0575, GNorm = 1.5205, lr_0 = 9.8284e-04
Loss = 4.7894e-03, PNorm = 52.1024, GNorm = 2.1677, lr_0 = 9.4120e-04
Validation rmse = 1.284838
Epoch 3
Loss = 4.6108e-03, PNorm = 52.1394, GNorm = 2.9405, lr_0 = 8.9744e-04
Loss = 4.0811e-03, PNorm = 52.1674, GNorm = 1.3137, lr_0 = 8.5943e-04
Validation rmse = 0.996239
Epoch 4
Loss = 3.8239e-03, PNorm = 52.1951, GNorm = 3.0874, lr_0 = 8.2303e-04
Loss = 3.2416e-03, PNorm = 52.2201, GNorm = 2.2838, lr_0 = 7.8816e-04
Validation rmse = 1.124615
Epoch 5
Loss = 2.7862e-03, PNorm = 52.2396, GNorm = 1.3909, lr_0 = 7.5478e-04
Loss = 3.6366e-03, PNorm = 52.2643, GNorm = 1.3487, lr_0 = 7.2281e-04
Validation rmse = 1.067648
Epoch 6
Loss = 3.0033e-03, PNorm = 52.2876, GNorm = 0.6923, lr_0 = 6.8920e-04
Loss = 2.8471e-03, PNorm = 52.3078, GNorm = 1.0379, lr_0 = 6.6001e-04
Validation rmse = 1.096915
Epoch 7
Loss = 2.8772e-03, PNorm = 52.3292, GNorm = 1.0937, lr_0 = 6.3205e-04
Loss = 2.4483e-03, PNorm = 52.3487, GNorm = 0.6952, lr_0 = 6.0528e-04
Validation rmse = 0.985941
Epoch 8
Loss = 2.4597e-03, PNorm = 52.3657, GNorm = 2.3491, lr_0 = 5.7714e-04
Loss = 2.2806e-03, PNorm = 52.3810, GNorm = 0.8927, lr_0 = 5.5269e-04
Validation rmse = 0.994739
Epoch 9
Loss = 2.5735e-03, PNorm = 52.3936, GNorm = 0.8421, lr_0 = 5.2928e-04
Loss = 2.0727e-03, PNorm = 52.4075, GNorm = 1.0768, lr_0 = 5.0686e-04
Validation rmse = 1.068720
Epoch 10
Loss = 1.9141e-03, PNorm = 52.4182, GNorm = 0.9906, lr_0 = 4.8539e-04
Loss = 2.1528e-03, PNorm = 52.4327, GNorm = 0.9816, lr_0 = 4.6483e-04
Validation rmse = 0.986599
Epoch 11
Loss = 2.3489e-03, PNorm = 52.4469, GNorm = 1.1264, lr_0 = 4.4322e-04
Loss = 2.2927e-03, PNorm = 52.4596, GNorm = 0.6425, lr_0 = 4.2444e-04
Validation rmse = 1.061741
Epoch 12
Loss = 1.8208e-03, PNorm = 52.4724, GNorm = 1.1303, lr_0 = 4.0646e-04
Loss = 2.2461e-03, PNorm = 52.4843, GNorm = 1.5830, lr_0 = 3.8925e-04
Validation rmse = 0.932937
Epoch 13
Loss = 1.5545e-03, PNorm = 52.4945, GNorm = 1.2383, lr_0 = 3.7276e-04
Loss = 2.0678e-03, PNorm = 52.5052, GNorm = 2.5899, lr_0 = 3.5697e-04
Validation rmse = 0.985521
Epoch 14
Loss = 1.9594e-03, PNorm = 52.5179, GNorm = 1.0552, lr_0 = 3.4037e-04
Loss = 1.8997e-03, PNorm = 52.5282, GNorm = 0.7096, lr_0 = 3.2596e-04
Validation rmse = 0.987353
Epoch 15
Loss = 1.5231e-03, PNorm = 52.5377, GNorm = 0.8427, lr_0 = 3.1215e-04
Loss = 2.1481e-03, PNorm = 52.5464, GNorm = 1.3692, lr_0 = 2.9893e-04
Validation rmse = 0.960222
Epoch 16
Loss = 1.9684e-03, PNorm = 52.5560, GNorm = 1.5041, lr_0 = 2.8503e-04
Loss = 1.8148e-03, PNorm = 52.5633, GNorm = 0.8365, lr_0 = 2.7295e-04
Validation rmse = 0.986370
Epoch 17
Loss = 1.7717e-03, PNorm = 52.5699, GNorm = 1.0554, lr_0 = 2.6139e-04
Loss = 1.7830e-03, PNorm = 52.5769, GNorm = 1.5874, lr_0 = 2.5032e-04
Validation rmse = 0.947807
Epoch 18
Loss = 1.4758e-03, PNorm = 52.5841, GNorm = 0.3738, lr_0 = 2.3972e-04
Loss = 1.7694e-03, PNorm = 52.5924, GNorm = 0.6784, lr_0 = 2.2956e-04
Validation rmse = 0.901327
Epoch 19
Loss = 1.6861e-03, PNorm = 52.5971, GNorm = 1.2225, lr_0 = 2.1889e-04
Loss = 1.7488e-03, PNorm = 52.6058, GNorm = 0.5121, lr_0 = 2.0962e-04
Validation rmse = 0.920806
Epoch 20
Loss = 1.6234e-03, PNorm = 52.6098, GNorm = 0.6003, lr_0 = 2.0074e-04
Loss = 1.4337e-03, PNorm = 52.6152, GNorm = 0.5678, lr_0 = 1.9224e-04
Validation rmse = 0.871101
Epoch 21
Loss = 1.6441e-03, PNorm = 52.6187, GNorm = 1.7596, lr_0 = 1.8409e-04
Loss = 1.5862e-03, PNorm = 52.6244, GNorm = 1.3844, lr_0 = 1.7630e-04
Validation rmse = 0.899376
Epoch 22
Loss = 1.5844e-03, PNorm = 52.6307, GNorm = 1.6436, lr_0 = 1.6810e-04
Loss = 1.4488e-03, PNorm = 52.6353, GNorm = 1.1712, lr_0 = 1.6098e-04
Validation rmse = 0.868275
Epoch 23
Loss = 1.3401e-03, PNorm = 52.6388, GNorm = 1.1100, lr_0 = 1.5416e-04
Loss = 1.6839e-03, PNorm = 52.6430, GNorm = 0.9907, lr_0 = 1.4763e-04
Loss = 2.2477e-03, PNorm = 52.6434, GNorm = 0.8088, lr_0 = 1.4699e-04
Validation rmse = 0.888056
Epoch 24
Loss = 1.5732e-03, PNorm = 52.6454, GNorm = 0.9342, lr_0 = 1.4077e-04
Loss = 1.4633e-03, PNorm = 52.6493, GNorm = 1.0042, lr_0 = 1.3480e-04
Validation rmse = 0.875869
Epoch 25
Loss = 1.5642e-03, PNorm = 52.6521, GNorm = 1.5498, lr_0 = 1.2909e-04
Loss = 1.4788e-03, PNorm = 52.6551, GNorm = 2.0706, lr_0 = 1.2362e-04
Validation rmse = 0.915381
Epoch 26
Loss = 1.2573e-03, PNorm = 52.6575, GNorm = 0.8782, lr_0 = 1.1839e-04
Validation rmse = 0.893474
Epoch 27
Loss = 1.0454e-03, PNorm = 52.6611, GNorm = 0.6405, lr_0 = 1.1288e-04
Loss = 1.2843e-03, PNorm = 52.6637, GNorm = 2.5218, lr_0 = 1.0810e-04
Validation rmse = 0.889238
Epoch 28
Loss = 1.2917e-03, PNorm = 52.6660, GNorm = 0.6545, lr_0 = 1.0352e-04
Loss = 1.3553e-03, PNorm = 52.6689, GNorm = 0.4947, lr_0 = 1.0000e-04
Validation rmse = 0.959383
Epoch 29
Loss = 1.7918e-03, PNorm = 52.6711, GNorm = 2.2066, lr_0 = 1.0000e-04
Loss = 1.2617e-03, PNorm = 52.6746, GNorm = 0.9180, lr_0 = 1.0000e-04
Validation rmse = 0.898232
Model 0 best validation rmse = 0.868275 on epoch 22
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.258705
Ensemble test rmse = 1.258705
10-fold cross validation
	Seed 0 ==> test rmse = 1.007116
	Seed 1 ==> test rmse = 1.013111
	Seed 2 ==> test rmse = 1.100836
	Seed 3 ==> test rmse = 0.971415
	Seed 4 ==> test rmse = 1.015535
	Seed 5 ==> test rmse = 1.051470
	Seed 6 ==> test rmse = 0.899815
	Seed 7 ==> test rmse = 0.884964
	Seed 8 ==> test rmse = 1.051801
	Seed 9 ==> test rmse = 1.258705
Overall test rmse = 1.025477 +/- 0.100244
Elapsed time = 0:06:04
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.30000000000000004_ffn_num_layers_1_hidden_size_800/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total scaffolds = 195 | train scaffolds = 91 | val scaffolds = 66 | test scaffolds = 38
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=804, out_features=1, bias=True)
  )
)
Number of parameters = 1,505,605
Moving model to cuda
Epoch 0
Loss = 1.8778e-02, PNorm = 43.7968, GNorm = 11.9375, lr_0 = 3.6053e-04
Validation rmse = 1.820454
Epoch 1
Loss = 1.1801e-02, PNorm = 43.8286, GNorm = 4.4385, lr_0 = 6.2105e-04
Loss = 8.2669e-03, PNorm = 43.8861, GNorm = 1.8892, lr_0 = 8.5789e-04
Validation rmse = 1.362046
Epoch 2
Loss = 6.6060e-03, PNorm = 43.9467, GNorm = 2.0985, lr_0 = 9.8284e-04
Loss = 5.5849e-03, PNorm = 43.9937, GNorm = 1.4962, lr_0 = 9.4120e-04
Validation rmse = 1.307824
Epoch 3
Loss = 4.8676e-03, PNorm = 44.0444, GNorm = 2.9920, lr_0 = 8.9744e-04
Loss = 4.2062e-03, PNorm = 44.0832, GNorm = 1.3654, lr_0 = 8.5943e-04
Validation rmse = 1.345042
Epoch 4
Loss = 5.5882e-03, PNorm = 44.1159, GNorm = 3.4906, lr_0 = 8.2303e-04
Loss = 3.3825e-03, PNorm = 44.1480, GNorm = 1.0102, lr_0 = 7.8816e-04
Validation rmse = 1.322361
Epoch 5
Loss = 2.6864e-03, PNorm = 44.1759, GNorm = 0.8727, lr_0 = 7.5478e-04
Loss = 3.3084e-03, PNorm = 44.1997, GNorm = 1.7938, lr_0 = 7.2281e-04
Validation rmse = 1.195985
Epoch 6
Loss = 2.4788e-03, PNorm = 44.2336, GNorm = 1.9797, lr_0 = 6.8920e-04
Loss = 2.8910e-03, PNorm = 44.2596, GNorm = 1.9033, lr_0 = 6.6001e-04
Validation rmse = 1.274313
Epoch 7
Loss = 3.0649e-03, PNorm = 44.2834, GNorm = 0.9177, lr_0 = 6.3205e-04
Loss = 2.7888e-03, PNorm = 44.3088, GNorm = 0.7661, lr_0 = 6.0528e-04
Validation rmse = 1.219128
Epoch 8
Loss = 2.7010e-03, PNorm = 44.3372, GNorm = 0.9557, lr_0 = 5.7714e-04
Loss = 2.3958e-03, PNorm = 44.3622, GNorm = 0.6291, lr_0 = 5.5269e-04
Validation rmse = 1.143430
Epoch 9
Loss = 2.8336e-03, PNorm = 44.3830, GNorm = 2.9771, lr_0 = 5.2928e-04
Loss = 2.7067e-03, PNorm = 44.4080, GNorm = 0.8554, lr_0 = 5.0686e-04
Validation rmse = 1.169284
Epoch 10
Loss = 2.6947e-03, PNorm = 44.4243, GNorm = 3.1154, lr_0 = 4.8539e-04
Loss = 3.0973e-03, PNorm = 44.4420, GNorm = 1.3135, lr_0 = 4.6483e-04
Validation rmse = 1.075300
Epoch 11
Loss = 2.1688e-03, PNorm = 44.4617, GNorm = 1.0494, lr_0 = 4.4322e-04
Loss = 2.3121e-03, PNorm = 44.4755, GNorm = 1.2314, lr_0 = 4.2444e-04
Validation rmse = 1.072924
Epoch 12
Loss = 2.0349e-03, PNorm = 44.4901, GNorm = 0.6906, lr_0 = 4.0646e-04
Loss = 2.2146e-03, PNorm = 44.5016, GNorm = 0.9721, lr_0 = 3.8925e-04
Validation rmse = 1.096324
Epoch 13
Loss = 2.0687e-03, PNorm = 44.5149, GNorm = 0.5148, lr_0 = 3.7276e-04
Loss = 2.2987e-03, PNorm = 44.5270, GNorm = 1.1817, lr_0 = 3.5697e-04
Validation rmse = 1.154827
Epoch 14
Loss = 2.1426e-03, PNorm = 44.5403, GNorm = 0.8196, lr_0 = 3.4037e-04
Loss = 2.2419e-03, PNorm = 44.5537, GNorm = 1.9427, lr_0 = 3.2596e-04
Validation rmse = 1.209878
Epoch 15
Loss = 2.0243e-03, PNorm = 44.5627, GNorm = 0.4500, lr_0 = 3.1215e-04
Loss = 2.0259e-03, PNorm = 44.5740, GNorm = 1.3516, lr_0 = 2.9893e-04
Validation rmse = 1.255202
Epoch 16
Loss = 2.0733e-03, PNorm = 44.5831, GNorm = 2.0594, lr_0 = 2.8503e-04
Loss = 1.9980e-03, PNorm = 44.5916, GNorm = 0.5007, lr_0 = 2.7295e-04
Validation rmse = 1.039191
Epoch 17
Loss = 1.7973e-03, PNorm = 44.5995, GNorm = 1.8216, lr_0 = 2.6139e-04
Loss = 2.1114e-03, PNorm = 44.6087, GNorm = 1.8145, lr_0 = 2.5032e-04
Validation rmse = 1.022681
Epoch 18
Loss = 1.5037e-03, PNorm = 44.6134, GNorm = 0.5656, lr_0 = 2.3972e-04
Loss = 2.0650e-03, PNorm = 44.6220, GNorm = 0.7133, lr_0 = 2.2956e-04
Validation rmse = 1.076407
Epoch 19
Loss = 1.9303e-03, PNorm = 44.6314, GNorm = 1.1543, lr_0 = 2.1889e-04
Loss = 1.9237e-03, PNorm = 44.6373, GNorm = 0.9421, lr_0 = 2.0962e-04
Validation rmse = 1.102839
Epoch 20
Loss = 1.8608e-03, PNorm = 44.6438, GNorm = 1.3119, lr_0 = 2.0074e-04
Loss = 1.9064e-03, PNorm = 44.6493, GNorm = 0.7155, lr_0 = 1.9224e-04
Validation rmse = 1.016555
Epoch 21
Loss = 1.6627e-03, PNorm = 44.6560, GNorm = 0.8238, lr_0 = 1.8409e-04
Loss = 1.8234e-03, PNorm = 44.6605, GNorm = 1.1904, lr_0 = 1.7630e-04
Validation rmse = 0.956094
Epoch 22
Loss = 1.7003e-03, PNorm = 44.6668, GNorm = 0.7784, lr_0 = 1.6810e-04
Loss = 2.0382e-03, PNorm = 44.6721, GNorm = 1.0371, lr_0 = 1.6098e-04
Validation rmse = 0.981167
Epoch 23
Loss = 1.8923e-03, PNorm = 44.6763, GNorm = 0.7498, lr_0 = 1.5416e-04
Loss = 1.8842e-03, PNorm = 44.6809, GNorm = 0.9919, lr_0 = 1.4763e-04
Loss = 2.3620e-03, PNorm = 44.6814, GNorm = 1.5620, lr_0 = 1.4699e-04
Validation rmse = 1.038294
Epoch 24
Loss = 1.9355e-03, PNorm = 44.6860, GNorm = 0.6605, lr_0 = 1.4077e-04
Loss = 1.7751e-03, PNorm = 44.6909, GNorm = 0.6380, lr_0 = 1.3480e-04
Validation rmse = 0.959565
Epoch 25
Loss = 1.7977e-03, PNorm = 44.6946, GNorm = 1.3844, lr_0 = 1.2909e-04
Loss = 1.8061e-03, PNorm = 44.6986, GNorm = 1.1572, lr_0 = 1.2362e-04
Validation rmse = 1.013414
Epoch 26
Loss = 1.8388e-03, PNorm = 44.7016, GNorm = 1.2284, lr_0 = 1.1839e-04
Validation rmse = 0.958938
Epoch 27
Loss = 1.0052e-03, PNorm = 44.7070, GNorm = 1.5397, lr_0 = 1.1288e-04
Loss = 1.6663e-03, PNorm = 44.7106, GNorm = 1.1951, lr_0 = 1.0810e-04
Validation rmse = 0.999070
Epoch 28
Loss = 2.4247e-03, PNorm = 44.7131, GNorm = 0.8903, lr_0 = 1.0352e-04
Loss = 1.6499e-03, PNorm = 44.7171, GNorm = 1.0472, lr_0 = 1.0000e-04
Validation rmse = 0.954366
Epoch 29
Loss = 2.1590e-03, PNorm = 44.7199, GNorm = 1.1106, lr_0 = 1.0000e-04
Loss = 1.9399e-03, PNorm = 44.7232, GNorm = 0.7657, lr_0 = 1.0000e-04
Validation rmse = 0.970651
Model 0 best validation rmse = 0.954366 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.946170
Ensemble test rmse = 0.946170
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.30000000000000004_ffn_num_layers_1_hidden_size_800/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total scaffolds = 195 | train scaffolds = 76 | val scaffolds = 60 | test scaffolds = 59
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=804, out_features=1, bias=True)
  )
)
Number of parameters = 1,505,605
Moving model to cuda
Epoch 0
Loss = 1.8178e-02, PNorm = 43.7991, GNorm = 11.4254, lr_0 = 3.6053e-04
Validation rmse = 2.161883
Epoch 1
Loss = 1.1339e-02, PNorm = 43.8334, GNorm = 7.3083, lr_0 = 6.2105e-04
Loss = 8.0949e-03, PNorm = 43.8875, GNorm = 3.2767, lr_0 = 8.5789e-04
Validation rmse = 1.467209
Epoch 2
Loss = 7.9478e-03, PNorm = 43.9480, GNorm = 4.2647, lr_0 = 9.8284e-04
Loss = 4.7457e-03, PNorm = 43.9974, GNorm = 1.0549, lr_0 = 9.4120e-04
Validation rmse = 1.319327
Epoch 3
Loss = 5.1489e-03, PNorm = 44.0451, GNorm = 3.2635, lr_0 = 8.9744e-04
Loss = 3.6684e-03, PNorm = 44.0873, GNorm = 0.8728, lr_0 = 8.5943e-04
Validation rmse = 1.326410
Epoch 4
Loss = 2.1901e-03, PNorm = 44.1179, GNorm = 1.2223, lr_0 = 8.2303e-04
Loss = 3.4631e-03, PNorm = 44.1537, GNorm = 2.0647, lr_0 = 7.8816e-04
Validation rmse = 1.243599
Epoch 5
Loss = 3.1879e-03, PNorm = 44.1800, GNorm = 1.6631, lr_0 = 7.5478e-04
Loss = 3.1348e-03, PNorm = 44.2117, GNorm = 2.0014, lr_0 = 7.2281e-04
Validation rmse = 1.315304
Epoch 6
Loss = 3.2478e-03, PNorm = 44.2415, GNorm = 1.8065, lr_0 = 6.8920e-04
Loss = 2.9438e-03, PNorm = 44.2723, GNorm = 1.0448, lr_0 = 6.6001e-04
Validation rmse = 1.432430
Epoch 7
Loss = 3.4356e-03, PNorm = 44.2951, GNorm = 0.9978, lr_0 = 6.3205e-04
Loss = 3.4879e-03, PNorm = 44.3234, GNorm = 4.0094, lr_0 = 6.0528e-04
Validation rmse = 1.245649
Epoch 8
Loss = 2.9695e-03, PNorm = 44.3540, GNorm = 1.5616, lr_0 = 5.7714e-04
Loss = 2.5127e-03, PNorm = 44.3744, GNorm = 1.9892, lr_0 = 5.5269e-04
Validation rmse = 1.173673
Epoch 9
Loss = 2.2117e-03, PNorm = 44.3958, GNorm = 2.4722, lr_0 = 5.2928e-04
Loss = 2.6786e-03, PNorm = 44.4138, GNorm = 2.3325, lr_0 = 5.0686e-04
Validation rmse = 1.164866
Epoch 10
Loss = 2.3328e-03, PNorm = 44.4325, GNorm = 0.8743, lr_0 = 4.8539e-04
Loss = 1.9995e-03, PNorm = 44.4474, GNorm = 1.7076, lr_0 = 4.6483e-04
Validation rmse = 1.096675
Epoch 11
Loss = 2.6203e-03, PNorm = 44.4646, GNorm = 1.8765, lr_0 = 4.4322e-04
Loss = 2.1555e-03, PNorm = 44.4780, GNorm = 0.6918, lr_0 = 4.2444e-04
Validation rmse = 1.016442
Epoch 12
Loss = 1.7574e-03, PNorm = 44.4942, GNorm = 0.6259, lr_0 = 4.0646e-04
Loss = 2.2606e-03, PNorm = 44.5062, GNorm = 1.7288, lr_0 = 3.8925e-04
Validation rmse = 1.073370
Epoch 13
Loss = 2.7169e-03, PNorm = 44.5190, GNorm = 0.9441, lr_0 = 3.7276e-04
Loss = 2.0908e-03, PNorm = 44.5321, GNorm = 1.1047, lr_0 = 3.5697e-04
Validation rmse = 1.023275
Epoch 14
Loss = 1.8743e-03, PNorm = 44.5461, GNorm = 1.9175, lr_0 = 3.4037e-04
Loss = 2.1546e-03, PNorm = 44.5605, GNorm = 1.4983, lr_0 = 3.2596e-04
Validation rmse = 1.004986
Epoch 15
Loss = 2.1316e-03, PNorm = 44.5714, GNorm = 1.1329, lr_0 = 3.1215e-04
Loss = 1.9547e-03, PNorm = 44.5833, GNorm = 1.1780, lr_0 = 2.9893e-04
Validation rmse = 0.990448
Epoch 16
Loss = 1.5961e-03, PNorm = 44.5913, GNorm = 0.6826, lr_0 = 2.8503e-04
Loss = 2.0556e-03, PNorm = 44.5998, GNorm = 0.8956, lr_0 = 2.7295e-04
Validation rmse = 0.998316
Epoch 17
Loss = 2.0427e-03, PNorm = 44.6099, GNorm = 1.2474, lr_0 = 2.6139e-04
Loss = 1.9043e-03, PNorm = 44.6198, GNorm = 0.7531, lr_0 = 2.5032e-04
Validation rmse = 0.974162
Epoch 18
Loss = 1.7984e-03, PNorm = 44.6271, GNorm = 1.5381, lr_0 = 2.3972e-04
Loss = 1.7122e-03, PNorm = 44.6349, GNorm = 2.5430, lr_0 = 2.2956e-04
Validation rmse = 0.988634
Epoch 19
Loss = 1.4583e-03, PNorm = 44.6426, GNorm = 0.9759, lr_0 = 2.1889e-04
Loss = 1.7838e-03, PNorm = 44.6482, GNorm = 0.8605, lr_0 = 2.0962e-04
Validation rmse = 0.956494
Epoch 20
Loss = 1.7063e-03, PNorm = 44.6564, GNorm = 0.6977, lr_0 = 2.0074e-04
Loss = 1.8262e-03, PNorm = 44.6636, GNorm = 0.9704, lr_0 = 1.9224e-04
Validation rmse = 0.950549
Epoch 21
Loss = 1.4796e-03, PNorm = 44.6684, GNorm = 1.6866, lr_0 = 1.8409e-04
Loss = 1.9109e-03, PNorm = 44.6741, GNorm = 1.0005, lr_0 = 1.7630e-04
Validation rmse = 1.033230
Epoch 22
Loss = 1.6924e-03, PNorm = 44.6822, GNorm = 1.3178, lr_0 = 1.6810e-04
Loss = 1.3927e-03, PNorm = 44.6869, GNorm = 0.8598, lr_0 = 1.6098e-04
Validation rmse = 1.009157
Epoch 23
Loss = 1.8402e-03, PNorm = 44.6915, GNorm = 0.7714, lr_0 = 1.5416e-04
Loss = 1.5801e-03, PNorm = 44.6966, GNorm = 0.6402, lr_0 = 1.4763e-04
Loss = 1.3696e-03, PNorm = 44.6970, GNorm = 1.8464, lr_0 = 1.4699e-04
Validation rmse = 0.943641
Epoch 24
Loss = 1.7333e-03, PNorm = 44.7022, GNorm = 0.4855, lr_0 = 1.4077e-04
Loss = 1.6399e-03, PNorm = 44.7070, GNorm = 1.1413, lr_0 = 1.3480e-04
Validation rmse = 1.031619
Epoch 25
Loss = 1.6730e-03, PNorm = 44.7112, GNorm = 1.2940, lr_0 = 1.2909e-04
Loss = 1.7369e-03, PNorm = 44.7159, GNorm = 1.2011, lr_0 = 1.2362e-04
Validation rmse = 0.947979
Epoch 26
Loss = 1.6778e-03, PNorm = 44.7198, GNorm = 1.5866, lr_0 = 1.1839e-04
Validation rmse = 0.953302
Epoch 27
Loss = 2.0197e-03, PNorm = 44.7248, GNorm = 1.4978, lr_0 = 1.1288e-04
Loss = 1.5866e-03, PNorm = 44.7275, GNorm = 0.6084, lr_0 = 1.0810e-04
Validation rmse = 0.986347
Epoch 28
Loss = 1.2132e-03, PNorm = 44.7310, GNorm = 0.7204, lr_0 = 1.0352e-04
Loss = 1.5810e-03, PNorm = 44.7347, GNorm = 0.6669, lr_0 = 1.0000e-04
Validation rmse = 0.952271
Epoch 29
Loss = 1.4144e-03, PNorm = 44.7383, GNorm = 0.5674, lr_0 = 1.0000e-04
Loss = 1.7488e-03, PNorm = 44.7419, GNorm = 1.4123, lr_0 = 1.0000e-04
Validation rmse = 0.951946
Model 0 best validation rmse = 0.943641 on epoch 23
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.087425
Ensemble test rmse = 1.087425
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.30000000000000004_ffn_num_layers_1_hidden_size_800/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total scaffolds = 195 | train scaffolds = 55 | val scaffolds = 64 | test scaffolds = 76
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=804, out_features=1, bias=True)
  )
)
Number of parameters = 1,505,605
Moving model to cuda
Epoch 0
Loss = 1.6450e-02, PNorm = 43.7986, GNorm = 4.4856, lr_0 = 3.6053e-04
Validation rmse = 1.464166
Epoch 1
Loss = 7.6542e-03, PNorm = 43.8373, GNorm = 2.7374, lr_0 = 6.2105e-04
Loss = 7.9654e-03, PNorm = 43.8881, GNorm = 2.9368, lr_0 = 8.5789e-04
Validation rmse = 1.485344
Epoch 2
Loss = 5.6652e-03, PNorm = 43.9498, GNorm = 2.8144, lr_0 = 9.8284e-04
Loss = 5.1841e-03, PNorm = 44.0016, GNorm = 1.0297, lr_0 = 9.4120e-04
Validation rmse = 1.336179
Epoch 3
Loss = 4.3828e-03, PNorm = 44.0503, GNorm = 1.1553, lr_0 = 8.9744e-04
Loss = 4.4579e-03, PNorm = 44.0830, GNorm = 2.0390, lr_0 = 8.5943e-04
Validation rmse = 1.316871
Epoch 4
Loss = 2.5301e-03, PNorm = 44.1149, GNorm = 1.4335, lr_0 = 8.2303e-04
Loss = 3.8473e-03, PNorm = 44.1511, GNorm = 5.8512, lr_0 = 7.8816e-04
Validation rmse = 1.469323
Epoch 5
Loss = 3.1993e-03, PNorm = 44.1821, GNorm = 0.8273, lr_0 = 7.5478e-04
Loss = 3.0639e-03, PNorm = 44.2138, GNorm = 1.4127, lr_0 = 7.2281e-04
Validation rmse = 1.234856
Epoch 6
Loss = 2.5667e-03, PNorm = 44.2436, GNorm = 1.7203, lr_0 = 6.8920e-04
Loss = 3.0858e-03, PNorm = 44.2685, GNorm = 0.7835, lr_0 = 6.6001e-04
Validation rmse = 1.188298
Epoch 7
Loss = 3.0323e-03, PNorm = 44.2956, GNorm = 2.2704, lr_0 = 6.3205e-04
Loss = 2.6667e-03, PNorm = 44.3217, GNorm = 2.6703, lr_0 = 6.0528e-04
Validation rmse = 1.391178
Epoch 8
Loss = 3.1330e-03, PNorm = 44.3444, GNorm = 1.1641, lr_0 = 5.7714e-04
Loss = 2.8928e-03, PNorm = 44.3704, GNorm = 2.5368, lr_0 = 5.5269e-04
Validation rmse = 1.157656
Epoch 9
Loss = 2.5678e-03, PNorm = 44.3882, GNorm = 2.6651, lr_0 = 5.2928e-04
Loss = 2.6426e-03, PNorm = 44.4101, GNorm = 1.1364, lr_0 = 5.0686e-04
Validation rmse = 1.159219
Epoch 10
Loss = 2.8786e-03, PNorm = 44.4284, GNorm = 1.3148, lr_0 = 4.8539e-04
Loss = 2.5437e-03, PNorm = 44.4421, GNorm = 0.9889, lr_0 = 4.6483e-04
Validation rmse = 1.150007
Epoch 11
Loss = 2.8661e-03, PNorm = 44.4629, GNorm = 2.5785, lr_0 = 4.4322e-04
Loss = 2.2775e-03, PNorm = 44.4790, GNorm = 1.5220, lr_0 = 4.2444e-04
Validation rmse = 1.148992
Epoch 12
Loss = 2.1979e-03, PNorm = 44.4922, GNorm = 0.5804, lr_0 = 4.0646e-04
Loss = 2.0999e-03, PNorm = 44.5048, GNorm = 0.7888, lr_0 = 3.8925e-04
Validation rmse = 1.178996
Epoch 13
Loss = 2.4700e-03, PNorm = 44.5161, GNorm = 1.5617, lr_0 = 3.7276e-04
Loss = 2.2304e-03, PNorm = 44.5252, GNorm = 0.7825, lr_0 = 3.5697e-04
Validation rmse = 1.164110
Epoch 14
Loss = 2.3886e-03, PNorm = 44.5354, GNorm = 0.7475, lr_0 = 3.4037e-04
Loss = 2.1125e-03, PNorm = 44.5494, GNorm = 1.5666, lr_0 = 3.2596e-04
Validation rmse = 1.114691
Epoch 15
Loss = 1.8884e-03, PNorm = 44.5586, GNorm = 0.7028, lr_0 = 3.1215e-04
Loss = 2.3657e-03, PNorm = 44.5662, GNorm = 2.0162, lr_0 = 2.9893e-04
Validation rmse = 1.160755
Epoch 16
Loss = 1.9919e-03, PNorm = 44.5773, GNorm = 0.5719, lr_0 = 2.8503e-04
Loss = 2.2341e-03, PNorm = 44.5853, GNorm = 2.7589, lr_0 = 2.7295e-04
Validation rmse = 1.164447
Epoch 17
Loss = 2.2701e-03, PNorm = 44.5945, GNorm = 1.9422, lr_0 = 2.6139e-04
Loss = 2.4339e-03, PNorm = 44.6032, GNorm = 2.1624, lr_0 = 2.5032e-04
Validation rmse = 1.353412
Epoch 18
Loss = 2.2191e-03, PNorm = 44.6149, GNorm = 1.3379, lr_0 = 2.3972e-04
Loss = 2.0819e-03, PNorm = 44.6213, GNorm = 0.4596, lr_0 = 2.2956e-04
Validation rmse = 1.140320
Epoch 19
Loss = 2.2950e-03, PNorm = 44.6290, GNorm = 2.0535, lr_0 = 2.1889e-04
Loss = 2.0228e-03, PNorm = 44.6371, GNorm = 1.1011, lr_0 = 2.0962e-04
Validation rmse = 1.132101
Epoch 20
Loss = 1.7250e-03, PNorm = 44.6423, GNorm = 0.7646, lr_0 = 2.0074e-04
Loss = 1.9555e-03, PNorm = 44.6499, GNorm = 0.7689, lr_0 = 1.9224e-04
Validation rmse = 1.115554
Epoch 21
Loss = 1.9031e-03, PNorm = 44.6548, GNorm = 0.8848, lr_0 = 1.8409e-04
Loss = 1.9119e-03, PNorm = 44.6609, GNorm = 1.4496, lr_0 = 1.7630e-04
Validation rmse = 1.196446
Epoch 22
Loss = 2.0782e-03, PNorm = 44.6681, GNorm = 0.5058, lr_0 = 1.6810e-04
Loss = 1.7383e-03, PNorm = 44.6722, GNorm = 0.9582, lr_0 = 1.6098e-04
Validation rmse = 1.171496
Epoch 23
Loss = 1.7747e-03, PNorm = 44.6779, GNorm = 0.9946, lr_0 = 1.5416e-04
Loss = 1.8540e-03, PNorm = 44.6830, GNorm = 1.0079, lr_0 = 1.4763e-04
Loss = 3.0565e-03, PNorm = 44.6832, GNorm = 1.5118, lr_0 = 1.4699e-04
Validation rmse = 1.116979
Epoch 24
Loss = 1.6549e-03, PNorm = 44.6864, GNorm = 1.8107, lr_0 = 1.4077e-04
Loss = 1.9610e-03, PNorm = 44.6900, GNorm = 0.8426, lr_0 = 1.3480e-04
Validation rmse = 1.180487
Epoch 25
Loss = 2.1984e-03, PNorm = 44.6947, GNorm = 0.8724, lr_0 = 1.2909e-04
Loss = 1.5109e-03, PNorm = 44.6974, GNorm = 1.1879, lr_0 = 1.2362e-04
Validation rmse = 1.134936
Epoch 26
Loss = 1.7007e-03, PNorm = 44.7016, GNorm = 0.9375, lr_0 = 1.1839e-04
Validation rmse = 1.131229
Epoch 27
Loss = 1.4508e-03, PNorm = 44.7062, GNorm = 1.3098, lr_0 = 1.1288e-04
Loss = 1.5851e-03, PNorm = 44.7093, GNorm = 1.4702, lr_0 = 1.0810e-04
Validation rmse = 1.128624
Epoch 28
Loss = 1.9313e-03, PNorm = 44.7132, GNorm = 1.1076, lr_0 = 1.0352e-04
Loss = 1.5762e-03, PNorm = 44.7159, GNorm = 0.6842, lr_0 = 1.0000e-04
Validation rmse = 1.171519
Epoch 29
Loss = 1.4867e-03, PNorm = 44.7196, GNorm = 0.7292, lr_0 = 1.0000e-04
Loss = 1.7740e-03, PNorm = 44.7223, GNorm = 1.2235, lr_0 = 1.0000e-04
Validation rmse = 1.162927
Model 0 best validation rmse = 1.114691 on epoch 14
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.217140
Ensemble test rmse = 1.217140
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.30000000000000004_ffn_num_layers_1_hidden_size_800/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total scaffolds = 195 | train scaffolds = 80 | val scaffolds = 54 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=804, out_features=1, bias=True)
  )
)
Number of parameters = 1,505,605
Moving model to cuda
Epoch 0
Loss = 1.8813e-02, PNorm = 43.7986, GNorm = 3.9944, lr_0 = 3.6053e-04
Validation rmse = 2.298274
Epoch 1
Loss = 1.0006e-02, PNorm = 43.8325, GNorm = 7.8709, lr_0 = 6.2105e-04
Loss = 7.5638e-03, PNorm = 43.8832, GNorm = 5.3603, lr_0 = 8.5789e-04
Validation rmse = 1.402129
Epoch 2
Loss = 5.7706e-03, PNorm = 43.9401, GNorm = 3.3362, lr_0 = 9.8284e-04
Loss = 5.1371e-03, PNorm = 43.9955, GNorm = 2.6181, lr_0 = 9.4120e-04
Validation rmse = 1.428316
Epoch 3
Loss = 5.1950e-03, PNorm = 44.0424, GNorm = 1.9538, lr_0 = 8.9744e-04
Loss = 4.5488e-03, PNorm = 44.0785, GNorm = 2.8483, lr_0 = 8.5943e-04
Validation rmse = 1.671677
Epoch 4
Loss = 5.3926e-03, PNorm = 44.1158, GNorm = 5.4362, lr_0 = 8.2303e-04
Loss = 4.7880e-03, PNorm = 44.1561, GNorm = 0.9805, lr_0 = 7.8816e-04
Validation rmse = 1.349109
Epoch 5
Loss = 4.0118e-03, PNorm = 44.1924, GNorm = 1.4454, lr_0 = 7.5478e-04
Loss = 2.9366e-03, PNorm = 44.2256, GNorm = 1.5826, lr_0 = 7.2281e-04
Validation rmse = 1.536242
Epoch 6
Loss = 3.0602e-03, PNorm = 44.2581, GNorm = 0.8895, lr_0 = 6.8920e-04
Loss = 2.9577e-03, PNorm = 44.2815, GNorm = 1.3613, lr_0 = 6.6001e-04
Validation rmse = 1.241293
Epoch 7
Loss = 2.6795e-03, PNorm = 44.3064, GNorm = 1.2860, lr_0 = 6.3205e-04
Loss = 2.2486e-03, PNorm = 44.3268, GNorm = 0.7598, lr_0 = 6.0528e-04
Validation rmse = 1.195397
Epoch 8
Loss = 2.7804e-03, PNorm = 44.3523, GNorm = 0.9548, lr_0 = 5.7714e-04
Loss = 2.1331e-03, PNorm = 44.3752, GNorm = 1.5018, lr_0 = 5.5269e-04
Validation rmse = 1.583677
Epoch 9
Loss = 2.7756e-03, PNorm = 44.3921, GNorm = 1.9124, lr_0 = 5.2928e-04
Loss = 2.7072e-03, PNorm = 44.4134, GNorm = 0.8372, lr_0 = 5.0686e-04
Validation rmse = 1.273654
Epoch 10
Loss = 2.5521e-03, PNorm = 44.4374, GNorm = 0.6508, lr_0 = 4.8539e-04
Loss = 2.3406e-03, PNorm = 44.4554, GNorm = 1.5571, lr_0 = 4.6483e-04
Validation rmse = 1.140922
Epoch 11
Loss = 2.0175e-03, PNorm = 44.4767, GNorm = 1.0747, lr_0 = 4.4322e-04
Loss = 2.3228e-03, PNorm = 44.4946, GNorm = 1.3319, lr_0 = 4.2444e-04
Validation rmse = 1.168165
Epoch 12
Loss = 2.1432e-03, PNorm = 44.5096, GNorm = 2.3816, lr_0 = 4.0646e-04
Loss = 1.8410e-03, PNorm = 44.5257, GNorm = 0.7010, lr_0 = 3.8925e-04
Validation rmse = 1.210693
Epoch 13
Loss = 2.0357e-03, PNorm = 44.5375, GNorm = 0.6466, lr_0 = 3.7276e-04
Loss = 2.0531e-03, PNorm = 44.5499, GNorm = 0.5754, lr_0 = 3.5697e-04
Validation rmse = 1.147600
Epoch 14
Loss = 1.8918e-03, PNorm = 44.5623, GNorm = 0.7378, lr_0 = 3.4037e-04
Loss = 1.9417e-03, PNorm = 44.5761, GNorm = 1.3371, lr_0 = 3.2596e-04
Validation rmse = 1.334235
Epoch 15
Loss = 1.9702e-03, PNorm = 44.5905, GNorm = 2.3654, lr_0 = 3.1215e-04
Loss = 2.1850e-03, PNorm = 44.6011, GNorm = 2.0235, lr_0 = 2.9893e-04
Validation rmse = 1.197434
Epoch 16
Loss = 1.5723e-03, PNorm = 44.6138, GNorm = 0.7054, lr_0 = 2.8503e-04
Loss = 2.0123e-03, PNorm = 44.6253, GNorm = 0.7619, lr_0 = 2.7295e-04
Validation rmse = 1.075426
Epoch 17
Loss = 1.7648e-03, PNorm = 44.6350, GNorm = 0.7231, lr_0 = 2.6139e-04
Loss = 1.9307e-03, PNorm = 44.6459, GNorm = 0.5819, lr_0 = 2.5032e-04
Validation rmse = 1.125725
Epoch 18
Loss = 1.8448e-03, PNorm = 44.6555, GNorm = 0.8061, lr_0 = 2.3972e-04
Loss = 1.6771e-03, PNorm = 44.6640, GNorm = 0.5306, lr_0 = 2.2956e-04
Validation rmse = 1.105455
Epoch 19
Loss = 1.9032e-03, PNorm = 44.6723, GNorm = 0.6419, lr_0 = 2.1889e-04
Loss = 1.5899e-03, PNorm = 44.6812, GNorm = 0.6573, lr_0 = 2.0962e-04
Validation rmse = 1.109181
Epoch 20
Loss = 1.7756e-03, PNorm = 44.6867, GNorm = 1.0914, lr_0 = 2.0074e-04
Loss = 1.8232e-03, PNorm = 44.6917, GNorm = 0.6663, lr_0 = 1.9224e-04
Validation rmse = 1.270210
Epoch 21
Loss = 1.5873e-03, PNorm = 44.6984, GNorm = 0.8026, lr_0 = 1.8409e-04
Loss = 1.5280e-03, PNorm = 44.7032, GNorm = 0.6879, lr_0 = 1.7630e-04
Validation rmse = 1.166192
Epoch 22
Loss = 1.7340e-03, PNorm = 44.7110, GNorm = 0.6855, lr_0 = 1.6810e-04
Loss = 1.6139e-03, PNorm = 44.7169, GNorm = 0.6251, lr_0 = 1.6098e-04
Validation rmse = 1.115545
Epoch 23
Loss = 1.5155e-03, PNorm = 44.7210, GNorm = 1.7217, lr_0 = 1.5416e-04
Loss = 1.5915e-03, PNorm = 44.7265, GNorm = 0.8395, lr_0 = 1.4763e-04
Loss = 2.4886e-03, PNorm = 44.7272, GNorm = 1.1176, lr_0 = 1.4699e-04
Validation rmse = 1.083697
Epoch 24
Loss = 1.4643e-03, PNorm = 44.7326, GNorm = 1.2087, lr_0 = 1.4077e-04
Loss = 1.7164e-03, PNorm = 44.7375, GNorm = 1.1300, lr_0 = 1.3480e-04
Validation rmse = 1.119849
Epoch 25
Loss = 1.5870e-03, PNorm = 44.7420, GNorm = 1.0286, lr_0 = 1.2909e-04
Loss = 1.6809e-03, PNorm = 44.7459, GNorm = 1.8132, lr_0 = 1.2362e-04
Validation rmse = 1.081353
Epoch 26
Loss = 1.5016e-03, PNorm = 44.7475, GNorm = 1.0450, lr_0 = 1.1839e-04
Validation rmse = 1.110716
Epoch 27
Loss = 2.2571e-03, PNorm = 44.7514, GNorm = 1.4443, lr_0 = 1.1288e-04
Loss = 1.6579e-03, PNorm = 44.7552, GNorm = 0.9226, lr_0 = 1.0810e-04
Validation rmse = 1.097375
Epoch 28
Loss = 1.7317e-03, PNorm = 44.7584, GNorm = 1.1068, lr_0 = 1.0352e-04
Loss = 1.6476e-03, PNorm = 44.7615, GNorm = 0.5537, lr_0 = 1.0000e-04
Validation rmse = 1.079565
Epoch 29
Loss = 1.4196e-03, PNorm = 44.7655, GNorm = 0.5536, lr_0 = 1.0000e-04
Loss = 1.4582e-03, PNorm = 44.7684, GNorm = 0.4774, lr_0 = 1.0000e-04
Validation rmse = 1.092269
Model 0 best validation rmse = 1.075426 on epoch 16
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.107019
Ensemble test rmse = 1.107019
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.30000000000000004_ffn_num_layers_1_hidden_size_800/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 49 | test scaffolds = 62
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=804, out_features=1, bias=True)
  )
)
Number of parameters = 1,505,605
Moving model to cuda
Epoch 0
Loss = 2.1031e-02, PNorm = 43.7973, GNorm = 13.6248, lr_0 = 3.6053e-04
Validation rmse = 1.918081
Epoch 1
Loss = 1.6007e-02, PNorm = 43.8269, GNorm = 5.7356, lr_0 = 6.2105e-04
Loss = 8.9842e-03, PNorm = 43.8803, GNorm = 4.1233, lr_0 = 8.5789e-04
Validation rmse = 1.317120
Epoch 2
Loss = 4.5794e-03, PNorm = 43.9358, GNorm = 2.0944, lr_0 = 9.8284e-04
Loss = 6.5207e-03, PNorm = 43.9874, GNorm = 2.7393, lr_0 = 9.4120e-04
Validation rmse = 1.427681
Epoch 3
Loss = 5.6702e-03, PNorm = 44.0359, GNorm = 1.4947, lr_0 = 8.9744e-04
Loss = 4.5263e-03, PNorm = 44.0728, GNorm = 1.2603, lr_0 = 8.5943e-04
Validation rmse = 1.229626
Epoch 4
Loss = 3.6738e-03, PNorm = 44.1057, GNorm = 1.7531, lr_0 = 8.2303e-04
Loss = 3.2757e-03, PNorm = 44.1321, GNorm = 1.2888, lr_0 = 7.8816e-04
Validation rmse = 1.073848
Epoch 5
Loss = 2.7709e-03, PNorm = 44.1537, GNorm = 0.7095, lr_0 = 7.5478e-04
Loss = 3.1111e-03, PNorm = 44.1810, GNorm = 0.6679, lr_0 = 7.2281e-04
Validation rmse = 1.083429
Epoch 6
Loss = 2.7744e-03, PNorm = 44.2082, GNorm = 1.6961, lr_0 = 6.8920e-04
Loss = 3.1884e-03, PNorm = 44.2356, GNorm = 0.6817, lr_0 = 6.6001e-04
Validation rmse = 1.210784
Epoch 7
Loss = 2.1005e-03, PNorm = 44.2599, GNorm = 0.5630, lr_0 = 6.3205e-04
Loss = 3.5014e-03, PNorm = 44.2865, GNorm = 2.1567, lr_0 = 6.0528e-04
Validation rmse = 1.279719
Epoch 8
Loss = 2.7355e-03, PNorm = 44.3143, GNorm = 1.0363, lr_0 = 5.7714e-04
Loss = 2.8013e-03, PNorm = 44.3363, GNorm = 1.5349, lr_0 = 5.5269e-04
Validation rmse = 1.172957
Epoch 9
Loss = 2.0773e-03, PNorm = 44.3588, GNorm = 1.3027, lr_0 = 5.2928e-04
Loss = 2.2900e-03, PNorm = 44.3787, GNorm = 1.0900, lr_0 = 5.0686e-04
Validation rmse = 0.986596
Epoch 10
Loss = 2.3996e-03, PNorm = 44.3981, GNorm = 2.3948, lr_0 = 4.8539e-04
Loss = 2.7410e-03, PNorm = 44.4166, GNorm = 1.9185, lr_0 = 4.6483e-04
Validation rmse = 0.950023
Epoch 11
Loss = 2.1701e-03, PNorm = 44.4367, GNorm = 0.4569, lr_0 = 4.4322e-04
Loss = 2.2241e-03, PNorm = 44.4540, GNorm = 0.9428, lr_0 = 4.2444e-04
Validation rmse = 0.944398
Epoch 12
Loss = 1.7499e-03, PNorm = 44.4691, GNorm = 1.4505, lr_0 = 4.0646e-04
Loss = 1.9911e-03, PNorm = 44.4827, GNorm = 1.0648, lr_0 = 3.8925e-04
Validation rmse = 0.955893
Epoch 13
Loss = 1.5490e-03, PNorm = 44.4956, GNorm = 1.5965, lr_0 = 3.7276e-04
Loss = 2.4584e-03, PNorm = 44.5088, GNorm = 2.3347, lr_0 = 3.5697e-04
Validation rmse = 1.009588
Epoch 14
Loss = 1.7974e-03, PNorm = 44.5236, GNorm = 0.6737, lr_0 = 3.4037e-04
Loss = 2.0296e-03, PNorm = 44.5342, GNorm = 2.1726, lr_0 = 3.2596e-04
Validation rmse = 0.905355
Epoch 15
Loss = 1.5748e-03, PNorm = 44.5441, GNorm = 0.4784, lr_0 = 3.1215e-04
Loss = 2.0315e-03, PNorm = 44.5542, GNorm = 0.9741, lr_0 = 2.9893e-04
Validation rmse = 0.928843
Epoch 16
Loss = 1.8773e-03, PNorm = 44.5631, GNorm = 1.1878, lr_0 = 2.8503e-04
Loss = 2.0803e-03, PNorm = 44.5706, GNorm = 0.3229, lr_0 = 2.7295e-04
Validation rmse = 0.904782
Epoch 17
Loss = 1.7836e-03, PNorm = 44.5788, GNorm = 0.4668, lr_0 = 2.6139e-04
Loss = 2.0479e-03, PNorm = 44.5848, GNorm = 0.4166, lr_0 = 2.5032e-04
Validation rmse = 0.900223
Epoch 18
Loss = 2.3027e-03, PNorm = 44.5946, GNorm = 1.2546, lr_0 = 2.3972e-04
Loss = 1.9068e-03, PNorm = 44.6022, GNorm = 1.8402, lr_0 = 2.2956e-04
Validation rmse = 0.902210
Epoch 19
Loss = 1.8840e-03, PNorm = 44.6099, GNorm = 0.8562, lr_0 = 2.1889e-04
Loss = 1.8754e-03, PNorm = 44.6162, GNorm = 0.8972, lr_0 = 2.0962e-04
Validation rmse = 0.994456
Epoch 20
Loss = 1.9218e-03, PNorm = 44.6232, GNorm = 1.4427, lr_0 = 2.0074e-04
Loss = 1.8085e-03, PNorm = 44.6286, GNorm = 1.9080, lr_0 = 1.9224e-04
Validation rmse = 0.892325
Epoch 21
Loss = 1.9585e-03, PNorm = 44.6342, GNorm = 1.4732, lr_0 = 1.8409e-04
Loss = 1.9112e-03, PNorm = 44.6394, GNorm = 1.3990, lr_0 = 1.7630e-04
Validation rmse = 0.877039
Epoch 22
Loss = 1.5629e-03, PNorm = 44.6467, GNorm = 1.0174, lr_0 = 1.6810e-04
Loss = 1.9235e-03, PNorm = 44.6504, GNorm = 0.6230, lr_0 = 1.6098e-04
Validation rmse = 0.967507
Epoch 23
Loss = 1.7840e-03, PNorm = 44.6545, GNorm = 1.1226, lr_0 = 1.5416e-04
Loss = 1.6945e-03, PNorm = 44.6584, GNorm = 0.8336, lr_0 = 1.4763e-04
Loss = 2.5403e-03, PNorm = 44.6590, GNorm = 0.7830, lr_0 = 1.4699e-04
Validation rmse = 0.854315
Epoch 24
Loss = 1.5006e-03, PNorm = 44.6629, GNorm = 0.7035, lr_0 = 1.4077e-04
Loss = 1.9404e-03, PNorm = 44.6663, GNorm = 0.8970, lr_0 = 1.3480e-04
Validation rmse = 0.989593
Epoch 25
Loss = 1.4629e-03, PNorm = 44.6713, GNorm = 0.5193, lr_0 = 1.2909e-04
Loss = 2.1478e-03, PNorm = 44.6741, GNorm = 2.0537, lr_0 = 1.2362e-04
Validation rmse = 0.885324
Epoch 26
Loss = 1.5446e-03, PNorm = 44.6775, GNorm = 0.7314, lr_0 = 1.1839e-04
Validation rmse = 0.865120
Epoch 27
Loss = 1.2971e-03, PNorm = 44.6812, GNorm = 0.8732, lr_0 = 1.1288e-04
Loss = 1.5491e-03, PNorm = 44.6832, GNorm = 1.1338, lr_0 = 1.0810e-04
Validation rmse = 0.853852
Epoch 28
Loss = 7.9192e-04, PNorm = 44.6861, GNorm = 0.7429, lr_0 = 1.0352e-04
Loss = 1.8453e-03, PNorm = 44.6889, GNorm = 0.8694, lr_0 = 1.0000e-04
Validation rmse = 0.883282
Epoch 29
Loss = 1.2617e-03, PNorm = 44.6925, GNorm = 0.5611, lr_0 = 1.0000e-04
Loss = 1.8431e-03, PNorm = 44.6957, GNorm = 2.0405, lr_0 = 1.0000e-04
Validation rmse = 0.905913
Model 0 best validation rmse = 0.853852 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.089684
Ensemble test rmse = 1.089684
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.30000000000000004_ffn_num_layers_1_hidden_size_800/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total scaffolds = 195 | train scaffolds = 94 | val scaffolds = 55 | test scaffolds = 46
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=804, out_features=1, bias=True)
  )
)
Number of parameters = 1,505,605
Moving model to cuda
Epoch 0
Loss = 1.8848e-02, PNorm = 43.7982, GNorm = 8.0481, lr_0 = 3.6053e-04
Validation rmse = 2.041182
Epoch 1
Loss = 9.4140e-03, PNorm = 43.8296, GNorm = 4.5989, lr_0 = 6.2105e-04
Loss = 6.0616e-03, PNorm = 43.8787, GNorm = 3.2355, lr_0 = 8.5789e-04
Validation rmse = 1.751711
Epoch 2
Loss = 6.3864e-03, PNorm = 43.9392, GNorm = 2.6021, lr_0 = 9.8284e-04
Loss = 5.7906e-03, PNorm = 43.9865, GNorm = 1.3754, lr_0 = 9.4120e-04
Validation rmse = 1.660240
Epoch 3
Loss = 5.1312e-03, PNorm = 44.0331, GNorm = 1.5453, lr_0 = 8.9744e-04
Loss = 4.4154e-03, PNorm = 44.0739, GNorm = 1.0161, lr_0 = 8.5943e-04
Validation rmse = 1.528748
Epoch 4
Loss = 3.4797e-03, PNorm = 44.1048, GNorm = 0.7853, lr_0 = 8.2303e-04
Loss = 3.8981e-03, PNorm = 44.1349, GNorm = 0.9740, lr_0 = 7.8816e-04
Validation rmse = 1.364287
Epoch 5
Loss = 3.9754e-03, PNorm = 44.1666, GNorm = 1.8729, lr_0 = 7.5478e-04
Loss = 3.4936e-03, PNorm = 44.1994, GNorm = 1.0825, lr_0 = 7.2281e-04
Validation rmse = 1.455916
Epoch 6
Loss = 4.0008e-03, PNorm = 44.2294, GNorm = 0.8208, lr_0 = 6.8920e-04
Loss = 3.3825e-03, PNorm = 44.2632, GNorm = 1.7578, lr_0 = 6.6001e-04
Validation rmse = 1.361573
Epoch 7
Loss = 3.3772e-03, PNorm = 44.2902, GNorm = 1.8772, lr_0 = 6.3205e-04
Loss = 2.9586e-03, PNorm = 44.3217, GNorm = 2.2697, lr_0 = 6.0528e-04
Validation rmse = 1.584863
Epoch 8
Loss = 2.8710e-03, PNorm = 44.3444, GNorm = 1.2939, lr_0 = 5.7714e-04
Loss = 2.7626e-03, PNorm = 44.3702, GNorm = 1.4353, lr_0 = 5.5269e-04
Validation rmse = 1.492216
Epoch 9
Loss = 3.2453e-03, PNorm = 44.3919, GNorm = 2.7189, lr_0 = 5.2928e-04
Loss = 2.6581e-03, PNorm = 44.4110, GNorm = 1.7651, lr_0 = 5.0686e-04
Validation rmse = 1.328195
Epoch 10
Loss = 2.4706e-03, PNorm = 44.4313, GNorm = 2.4299, lr_0 = 4.8539e-04
Loss = 2.7686e-03, PNorm = 44.4532, GNorm = 1.0481, lr_0 = 4.6483e-04
Validation rmse = 1.394702
Epoch 11
Loss = 1.9921e-03, PNorm = 44.4754, GNorm = 1.0109, lr_0 = 4.4322e-04
Loss = 2.1602e-03, PNorm = 44.4952, GNorm = 1.6803, lr_0 = 4.2444e-04
Validation rmse = 1.348093
Epoch 12
Loss = 1.9914e-03, PNorm = 44.5105, GNorm = 0.9963, lr_0 = 4.0646e-04
Loss = 2.3705e-03, PNorm = 44.5245, GNorm = 1.0055, lr_0 = 3.8925e-04
Validation rmse = 1.287542
Epoch 13
Loss = 2.0888e-03, PNorm = 44.5371, GNorm = 0.7074, lr_0 = 3.7276e-04
Loss = 2.2487e-03, PNorm = 44.5464, GNorm = 0.8986, lr_0 = 3.5697e-04
Validation rmse = 1.452047
Epoch 14
Loss = 2.7809e-03, PNorm = 44.5611, GNorm = 2.1898, lr_0 = 3.4037e-04
Loss = 2.2730e-03, PNorm = 44.5731, GNorm = 1.2459, lr_0 = 3.2596e-04
Validation rmse = 1.265100
Epoch 15
Loss = 2.3412e-03, PNorm = 44.5886, GNorm = 0.4534, lr_0 = 3.1215e-04
Loss = 2.1267e-03, PNorm = 44.5990, GNorm = 1.4278, lr_0 = 2.9893e-04
Validation rmse = 1.175757
Epoch 16
Loss = 2.1822e-03, PNorm = 44.6084, GNorm = 0.9759, lr_0 = 2.8503e-04
Loss = 2.1389e-03, PNorm = 44.6165, GNorm = 0.9176, lr_0 = 2.7295e-04
Validation rmse = 1.273104
Epoch 17
Loss = 2.0491e-03, PNorm = 44.6274, GNorm = 0.4387, lr_0 = 2.6139e-04
Loss = 1.8214e-03, PNorm = 44.6343, GNorm = 0.4095, lr_0 = 2.5032e-04
Validation rmse = 1.273922
Epoch 18
Loss = 1.9543e-03, PNorm = 44.6425, GNorm = 1.0261, lr_0 = 2.3972e-04
Loss = 1.9424e-03, PNorm = 44.6523, GNorm = 0.5897, lr_0 = 2.2956e-04
Validation rmse = 1.165629
Epoch 19
Loss = 1.6649e-03, PNorm = 44.6605, GNorm = 1.1876, lr_0 = 2.1889e-04
Loss = 2.0453e-03, PNorm = 44.6683, GNorm = 1.9503, lr_0 = 2.0962e-04
Validation rmse = 1.140658
Epoch 20
Loss = 2.0273e-03, PNorm = 44.6738, GNorm = 0.8223, lr_0 = 2.0074e-04
Loss = 2.1529e-03, PNorm = 44.6807, GNorm = 1.1217, lr_0 = 1.9224e-04
Validation rmse = 1.251659
Epoch 21
Loss = 1.9112e-03, PNorm = 44.6856, GNorm = 1.5561, lr_0 = 1.8409e-04
Loss = 2.0157e-03, PNorm = 44.6933, GNorm = 0.5237, lr_0 = 1.7630e-04
Validation rmse = 1.173367
Epoch 22
Loss = 1.5605e-03, PNorm = 44.6994, GNorm = 1.5417, lr_0 = 1.6810e-04
Loss = 2.0340e-03, PNorm = 44.7059, GNorm = 0.9967, lr_0 = 1.6098e-04
Validation rmse = 1.224597
Epoch 23
Loss = 1.6585e-03, PNorm = 44.7103, GNorm = 0.7176, lr_0 = 1.5416e-04
Loss = 1.6323e-03, PNorm = 44.7147, GNorm = 1.4684, lr_0 = 1.4763e-04
Loss = 1.7448e-03, PNorm = 44.7150, GNorm = 1.3502, lr_0 = 1.4699e-04
Validation rmse = 1.186439
Epoch 24
Loss = 1.7599e-03, PNorm = 44.7195, GNorm = 0.4642, lr_0 = 1.4077e-04
Loss = 1.8212e-03, PNorm = 44.7236, GNorm = 0.8404, lr_0 = 1.3480e-04
Validation rmse = 1.179204
Epoch 25
Loss = 1.6760e-03, PNorm = 44.7278, GNorm = 0.7254, lr_0 = 1.2909e-04
Loss = 2.1208e-03, PNorm = 44.7317, GNorm = 2.0680, lr_0 = 1.2362e-04
Validation rmse = 1.237193
Epoch 26
Loss = 1.6836e-03, PNorm = 44.7350, GNorm = 0.8733, lr_0 = 1.1839e-04
Validation rmse = 1.193601
Epoch 27
Loss = 1.9162e-03, PNorm = 44.7385, GNorm = 0.7442, lr_0 = 1.1288e-04
Loss = 1.7880e-03, PNorm = 44.7428, GNorm = 0.6928, lr_0 = 1.0810e-04
Validation rmse = 1.141124
Epoch 28
Loss = 1.4336e-03, PNorm = 44.7465, GNorm = 0.8301, lr_0 = 1.0352e-04
Loss = 1.5856e-03, PNorm = 44.7489, GNorm = 1.1027, lr_0 = 1.0000e-04
Validation rmse = 1.156958
Epoch 29
Loss = 1.3076e-03, PNorm = 44.7528, GNorm = 0.7438, lr_0 = 1.0000e-04
Loss = 1.6766e-03, PNorm = 44.7560, GNorm = 0.4748, lr_0 = 1.0000e-04
Validation rmse = 1.166688
Model 0 best validation rmse = 1.140658 on epoch 19
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.201760
Ensemble test rmse = 1.201760
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.30000000000000004_ffn_num_layers_1_hidden_size_800/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total scaffolds = 195 | train scaffolds = 64 | val scaffolds = 68 | test scaffolds = 63
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=804, out_features=1, bias=True)
  )
)
Number of parameters = 1,505,605
Moving model to cuda
Epoch 0
Loss = 1.8486e-02, PNorm = 43.7978, GNorm = 3.0186, lr_0 = 3.6053e-04
Validation rmse = 1.796127
Epoch 1
Loss = 7.7702e-03, PNorm = 43.8335, GNorm = 4.4370, lr_0 = 6.2105e-04
Loss = 6.7930e-03, PNorm = 43.8778, GNorm = 1.9257, lr_0 = 8.5789e-04
Validation rmse = 1.314347
Epoch 2
Loss = 5.1172e-03, PNorm = 43.9348, GNorm = 1.4950, lr_0 = 9.8284e-04
Loss = 4.8458e-03, PNorm = 43.9853, GNorm = 4.3056, lr_0 = 9.4120e-04
Validation rmse = 1.280991
Epoch 3
Loss = 3.9407e-03, PNorm = 44.0309, GNorm = 3.7053, lr_0 = 8.9744e-04
Loss = 4.3645e-03, PNorm = 44.0733, GNorm = 2.3197, lr_0 = 8.5943e-04
Validation rmse = 1.400163
Epoch 4
Loss = 3.2158e-03, PNorm = 44.1025, GNorm = 2.1243, lr_0 = 8.2303e-04
Loss = 3.6269e-03, PNorm = 44.1418, GNorm = 2.1456, lr_0 = 7.8816e-04
Validation rmse = 1.442818
Epoch 5
Loss = 2.9477e-03, PNorm = 44.1713, GNorm = 0.9492, lr_0 = 7.5478e-04
Loss = 3.3040e-03, PNorm = 44.1984, GNorm = 1.1633, lr_0 = 7.2281e-04
Validation rmse = 1.227642
Epoch 6
Loss = 3.3740e-03, PNorm = 44.2274, GNorm = 3.7758, lr_0 = 6.8920e-04
Loss = 2.8746e-03, PNorm = 44.2570, GNorm = 2.3328, lr_0 = 6.6001e-04
Validation rmse = 1.213790
Epoch 7
Loss = 2.8157e-03, PNorm = 44.2855, GNorm = 0.8120, lr_0 = 6.3205e-04
Loss = 2.3264e-03, PNorm = 44.3091, GNorm = 1.3480, lr_0 = 6.0528e-04
Validation rmse = 1.268068
Epoch 8
Loss = 2.4642e-03, PNorm = 44.3373, GNorm = 1.0566, lr_0 = 5.7714e-04
Loss = 2.6814e-03, PNorm = 44.3626, GNorm = 1.0484, lr_0 = 5.5269e-04
Validation rmse = 1.364799
Epoch 9
Loss = 3.0764e-03, PNorm = 44.3847, GNorm = 4.3142, lr_0 = 5.2928e-04
Loss = 2.5599e-03, PNorm = 44.4094, GNorm = 0.7943, lr_0 = 5.0686e-04
Validation rmse = 1.145999
Epoch 10
Loss = 2.3677e-03, PNorm = 44.4333, GNorm = 1.1082, lr_0 = 4.8539e-04
Loss = 2.1263e-03, PNorm = 44.4530, GNorm = 1.0151, lr_0 = 4.6483e-04
Validation rmse = 1.179137
Epoch 11
Loss = 2.1076e-03, PNorm = 44.4719, GNorm = 0.4686, lr_0 = 4.4322e-04
Loss = 1.8013e-03, PNorm = 44.4879, GNorm = 0.8372, lr_0 = 4.2444e-04
Validation rmse = 1.157054
Epoch 12
Loss = 1.8091e-03, PNorm = 44.5030, GNorm = 0.8211, lr_0 = 4.0646e-04
Loss = 2.2813e-03, PNorm = 44.5176, GNorm = 1.5959, lr_0 = 3.8925e-04
Validation rmse = 1.142022
Epoch 13
Loss = 2.0151e-03, PNorm = 44.5332, GNorm = 1.7874, lr_0 = 3.7276e-04
Loss = 2.4105e-03, PNorm = 44.5472, GNorm = 1.0823, lr_0 = 3.5697e-04
Validation rmse = 1.213991
Epoch 14
Loss = 1.9865e-03, PNorm = 44.5618, GNorm = 2.7232, lr_0 = 3.4037e-04
Loss = 2.0679e-03, PNorm = 44.5776, GNorm = 2.2436, lr_0 = 3.2596e-04
Validation rmse = 1.243254
Epoch 15
Loss = 1.8166e-03, PNorm = 44.5892, GNorm = 0.7209, lr_0 = 3.1215e-04
Loss = 1.7118e-03, PNorm = 44.5996, GNorm = 1.6676, lr_0 = 2.9893e-04
Validation rmse = 1.105870
Epoch 16
Loss = 1.7032e-03, PNorm = 44.6112, GNorm = 0.6144, lr_0 = 2.8503e-04
Loss = 1.6901e-03, PNorm = 44.6202, GNorm = 2.0365, lr_0 = 2.7295e-04
Validation rmse = 1.141005
Epoch 17
Loss = 1.9449e-03, PNorm = 44.6308, GNorm = 0.7474, lr_0 = 2.6139e-04
Loss = 1.9731e-03, PNorm = 44.6384, GNorm = 1.1903, lr_0 = 2.5032e-04
Validation rmse = 1.103061
Epoch 18
Loss = 2.3053e-03, PNorm = 44.6473, GNorm = 1.0463, lr_0 = 2.3972e-04
Loss = 1.8426e-03, PNorm = 44.6578, GNorm = 1.9953, lr_0 = 2.2956e-04
Validation rmse = 1.079452
Epoch 19
Loss = 1.6886e-03, PNorm = 44.6682, GNorm = 0.9571, lr_0 = 2.1889e-04
Loss = 1.8439e-03, PNorm = 44.6764, GNorm = 2.3642, lr_0 = 2.0962e-04
Validation rmse = 1.170582
Epoch 20
Loss = 1.8260e-03, PNorm = 44.6818, GNorm = 0.5968, lr_0 = 2.0074e-04
Loss = 1.7447e-03, PNorm = 44.6884, GNorm = 0.6824, lr_0 = 1.9224e-04
Validation rmse = 1.090025
Epoch 21
Loss = 1.4842e-03, PNorm = 44.6953, GNorm = 0.8141, lr_0 = 1.8409e-04
Loss = 1.7027e-03, PNorm = 44.7016, GNorm = 1.2651, lr_0 = 1.7630e-04
Validation rmse = 1.185815
Epoch 22
Loss = 1.7079e-03, PNorm = 44.7070, GNorm = 0.8093, lr_0 = 1.6810e-04
Loss = 1.6095e-03, PNorm = 44.7114, GNorm = 0.6888, lr_0 = 1.6098e-04
Validation rmse = 1.086302
Epoch 23
Loss = 1.7807e-03, PNorm = 44.7173, GNorm = 0.8485, lr_0 = 1.5416e-04
Loss = 1.6175e-03, PNorm = 44.7220, GNorm = 0.8157, lr_0 = 1.4763e-04
Loss = 3.7741e-03, PNorm = 44.7225, GNorm = 1.0877, lr_0 = 1.4699e-04
Validation rmse = 1.076837
Epoch 24
Loss = 1.5357e-03, PNorm = 44.7286, GNorm = 0.8598, lr_0 = 1.4077e-04
Loss = 1.4362e-03, PNorm = 44.7338, GNorm = 1.6352, lr_0 = 1.3480e-04
Validation rmse = 1.098254
Epoch 25
Loss = 1.5790e-03, PNorm = 44.7381, GNorm = 0.5109, lr_0 = 1.2909e-04
Loss = 1.6035e-03, PNorm = 44.7427, GNorm = 0.5910, lr_0 = 1.2362e-04
Validation rmse = 1.079200
Epoch 26
Loss = 1.3566e-03, PNorm = 44.7467, GNorm = 0.8328, lr_0 = 1.1839e-04
Validation rmse = 1.102737
Epoch 27
Loss = 1.7320e-03, PNorm = 44.7506, GNorm = 0.6948, lr_0 = 1.1288e-04
Loss = 1.4134e-03, PNorm = 44.7530, GNorm = 0.6384, lr_0 = 1.0810e-04
Validation rmse = 1.068042
Epoch 28
Loss = 1.3536e-03, PNorm = 44.7571, GNorm = 1.1369, lr_0 = 1.0352e-04
Loss = 1.4049e-03, PNorm = 44.7607, GNorm = 0.7735, lr_0 = 1.0000e-04
Validation rmse = 1.110030
Epoch 29
Loss = 1.6790e-03, PNorm = 44.7639, GNorm = 1.0331, lr_0 = 1.0000e-04
Loss = 1.5266e-03, PNorm = 44.7674, GNorm = 0.6195, lr_0 = 1.0000e-04
Validation rmse = 1.082296
Model 0 best validation rmse = 1.068042 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.979079
Ensemble test rmse = 0.979079
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.30000000000000004_ffn_num_layers_1_hidden_size_800/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total scaffolds = 195 | train scaffolds = 69 | val scaffolds = 65 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=804, out_features=1, bias=True)
  )
)
Number of parameters = 1,505,605
Moving model to cuda
Epoch 0
Loss = 1.7808e-02, PNorm = 43.8003, GNorm = 5.9044, lr_0 = 3.6053e-04
Validation rmse = 1.918561
Epoch 1
Loss = 9.6518e-03, PNorm = 43.8383, GNorm = 3.3540, lr_0 = 6.2105e-04
Loss = 7.0248e-03, PNorm = 43.8893, GNorm = 7.8087, lr_0 = 8.5789e-04
Validation rmse = 1.565704
Epoch 2
Loss = 6.7158e-03, PNorm = 43.9515, GNorm = 4.6280, lr_0 = 9.8284e-04
Loss = 5.8768e-03, PNorm = 44.0102, GNorm = 2.4952, lr_0 = 9.4120e-04
Validation rmse = 1.912820
Epoch 3
Loss = 3.6028e-03, PNorm = 44.0611, GNorm = 1.1359, lr_0 = 8.9744e-04
Loss = 4.7188e-03, PNorm = 44.0998, GNorm = 3.3051, lr_0 = 8.5943e-04
Validation rmse = 1.529078
Epoch 4
Loss = 3.6095e-03, PNorm = 44.1308, GNorm = 2.3027, lr_0 = 8.2303e-04
Loss = 3.8170e-03, PNorm = 44.1628, GNorm = 3.0204, lr_0 = 7.8816e-04
Validation rmse = 1.672716
Epoch 5
Loss = 3.5081e-03, PNorm = 44.1949, GNorm = 0.6635, lr_0 = 7.5478e-04
Loss = 2.7614e-03, PNorm = 44.2226, GNorm = 0.7106, lr_0 = 7.2281e-04
Validation rmse = 1.645810
Epoch 6
Loss = 3.5083e-03, PNorm = 44.2531, GNorm = 3.5103, lr_0 = 6.8920e-04
Loss = 3.0869e-03, PNorm = 44.2812, GNorm = 2.2679, lr_0 = 6.6001e-04
Validation rmse = 1.917974
Epoch 7
Loss = 3.0651e-03, PNorm = 44.3086, GNorm = 2.8310, lr_0 = 6.3205e-04
Loss = 3.8666e-03, PNorm = 44.3360, GNorm = 2.9741, lr_0 = 6.0528e-04
Validation rmse = 1.672309
Epoch 8
Loss = 2.6119e-03, PNorm = 44.3679, GNorm = 1.8151, lr_0 = 5.7714e-04
Loss = 3.1140e-03, PNorm = 44.3904, GNorm = 1.5316, lr_0 = 5.5269e-04
Validation rmse = 1.618376
Epoch 9
Loss = 2.1902e-03, PNorm = 44.4116, GNorm = 1.0996, lr_0 = 5.2928e-04
Loss = 2.2571e-03, PNorm = 44.4313, GNorm = 0.8145, lr_0 = 5.0686e-04
Validation rmse = 1.661760
Epoch 10
Loss = 2.4033e-03, PNorm = 44.4473, GNorm = 1.0354, lr_0 = 4.8539e-04
Loss = 2.4534e-03, PNorm = 44.4643, GNorm = 0.7908, lr_0 = 4.6483e-04
Validation rmse = 1.641551
Epoch 11
Loss = 2.4045e-03, PNorm = 44.4826, GNorm = 0.6082, lr_0 = 4.4322e-04
Loss = 2.0649e-03, PNorm = 44.4958, GNorm = 2.2370, lr_0 = 4.2444e-04
Validation rmse = 1.451856
Epoch 12
Loss = 1.9017e-03, PNorm = 44.5079, GNorm = 0.6499, lr_0 = 4.0646e-04
Loss = 2.1356e-03, PNorm = 44.5202, GNorm = 0.9228, lr_0 = 3.8925e-04
Validation rmse = 1.454053
Epoch 13
Loss = 2.1271e-03, PNorm = 44.5351, GNorm = 0.8220, lr_0 = 3.7276e-04
Loss = 2.3219e-03, PNorm = 44.5486, GNorm = 1.0122, lr_0 = 3.5697e-04
Validation rmse = 1.550557
Epoch 14
Loss = 2.0073e-03, PNorm = 44.5631, GNorm = 0.6612, lr_0 = 3.4037e-04
Loss = 2.2178e-03, PNorm = 44.5730, GNorm = 1.5538, lr_0 = 3.2596e-04
Validation rmse = 1.565557
Epoch 15
Loss = 1.5335e-03, PNorm = 44.5834, GNorm = 0.6574, lr_0 = 3.1215e-04
Loss = 2.2082e-03, PNorm = 44.5940, GNorm = 0.8678, lr_0 = 2.9893e-04
Validation rmse = 1.627216
Epoch 16
Loss = 2.0939e-03, PNorm = 44.6052, GNorm = 0.8356, lr_0 = 2.8503e-04
Loss = 2.0350e-03, PNorm = 44.6147, GNorm = 0.7438, lr_0 = 2.7295e-04
Validation rmse = 1.824099
Epoch 17
Loss = 1.9615e-03, PNorm = 44.6238, GNorm = 0.5970, lr_0 = 2.6139e-04
Loss = 2.0076e-03, PNorm = 44.6302, GNorm = 0.4536, lr_0 = 2.5032e-04
Validation rmse = 1.557496
Epoch 18
Loss = 1.7513e-03, PNorm = 44.6390, GNorm = 0.5964, lr_0 = 2.3972e-04
Loss = 1.9259e-03, PNorm = 44.6478, GNorm = 0.6207, lr_0 = 2.2956e-04
Validation rmse = 1.610899
Epoch 19
Loss = 1.7594e-03, PNorm = 44.6572, GNorm = 1.4278, lr_0 = 2.1889e-04
Loss = 1.7580e-03, PNorm = 44.6633, GNorm = 0.7052, lr_0 = 2.0962e-04
Validation rmse = 1.491744
Epoch 20
Loss = 1.8579e-03, PNorm = 44.6698, GNorm = 0.7001, lr_0 = 2.0074e-04
Loss = 1.4958e-03, PNorm = 44.6765, GNorm = 1.0585, lr_0 = 1.9224e-04
Validation rmse = 1.551149
Epoch 21
Loss = 1.9151e-03, PNorm = 44.6828, GNorm = 1.3103, lr_0 = 1.8409e-04
Loss = 1.8151e-03, PNorm = 44.6887, GNorm = 1.5243, lr_0 = 1.7630e-04
Validation rmse = 1.547360
Epoch 22
Loss = 1.6951e-03, PNorm = 44.6930, GNorm = 2.0496, lr_0 = 1.6810e-04
Loss = 1.8888e-03, PNorm = 44.6984, GNorm = 0.8880, lr_0 = 1.6098e-04
Validation rmse = 1.595297
Epoch 23
Loss = 1.4847e-03, PNorm = 44.7034, GNorm = 0.7156, lr_0 = 1.5416e-04
Loss = 1.7369e-03, PNorm = 44.7081, GNorm = 0.5865, lr_0 = 1.4763e-04
Loss = 2.2191e-03, PNorm = 44.7085, GNorm = 1.1065, lr_0 = 1.4699e-04
Validation rmse = 1.474101
Epoch 24
Loss = 1.7294e-03, PNorm = 44.7126, GNorm = 1.2633, lr_0 = 1.4077e-04
Loss = 1.6844e-03, PNorm = 44.7167, GNorm = 1.4492, lr_0 = 1.3480e-04
Validation rmse = 1.563572
Epoch 25
Loss = 1.6025e-03, PNorm = 44.7202, GNorm = 0.9063, lr_0 = 1.2909e-04
Loss = 1.8907e-03, PNorm = 44.7244, GNorm = 2.0538, lr_0 = 1.2362e-04
Validation rmse = 1.452927
Epoch 26
Loss = 1.6968e-03, PNorm = 44.7278, GNorm = 0.6506, lr_0 = 1.1839e-04
Validation rmse = 1.628084
Epoch 27
Loss = 1.4008e-03, PNorm = 44.7315, GNorm = 0.8739, lr_0 = 1.1288e-04
Loss = 1.5407e-03, PNorm = 44.7358, GNorm = 1.7157, lr_0 = 1.0810e-04
Validation rmse = 1.557693
Epoch 28
Loss = 2.6360e-03, PNorm = 44.7398, GNorm = 1.4330, lr_0 = 1.0352e-04
Loss = 1.4242e-03, PNorm = 44.7434, GNorm = 0.8796, lr_0 = 1.0000e-04
Validation rmse = 1.562121
Epoch 29
Loss = 1.8757e-03, PNorm = 44.7466, GNorm = 0.6746, lr_0 = 1.0000e-04
Loss = 1.4003e-03, PNorm = 44.7493, GNorm = 0.5641, lr_0 = 1.0000e-04
Validation rmse = 1.552033
Model 0 best validation rmse = 1.451856 on epoch 11
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.077544
Ensemble test rmse = 1.077544
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.30000000000000004_ffn_num_layers_1_hidden_size_800/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total scaffolds = 195 | train scaffolds = 75 | val scaffolds = 42 | test scaffolds = 78
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=804, out_features=1, bias=True)
  )
)
Number of parameters = 1,505,605
Moving model to cuda
Epoch 0
Loss = 1.6090e-02, PNorm = 43.7989, GNorm = 6.1903, lr_0 = 3.6053e-04
Validation rmse = 2.030071
Epoch 1
Loss = 6.3894e-03, PNorm = 43.8387, GNorm = 1.8650, lr_0 = 6.2105e-04
Loss = 6.7445e-03, PNorm = 43.8891, GNorm = 7.6309, lr_0 = 8.5789e-04
Validation rmse = 1.633972
Epoch 2
Loss = 4.1005e-03, PNorm = 43.9506, GNorm = 1.6739, lr_0 = 9.8284e-04
Loss = 3.5797e-03, PNorm = 44.0021, GNorm = 2.6193, lr_0 = 9.4120e-04
Validation rmse = 1.522752
Epoch 3
Loss = 4.8082e-03, PNorm = 44.0445, GNorm = 4.2390, lr_0 = 8.9744e-04
Loss = 4.3030e-03, PNorm = 44.0841, GNorm = 3.1146, lr_0 = 8.5943e-04
Validation rmse = 1.394176
Epoch 4
Loss = 3.6959e-03, PNorm = 44.1177, GNorm = 3.7653, lr_0 = 8.2303e-04
Loss = 3.2975e-03, PNorm = 44.1476, GNorm = 1.7502, lr_0 = 7.8816e-04
Validation rmse = 1.460739
Epoch 5
Loss = 3.2359e-03, PNorm = 44.1744, GNorm = 2.1783, lr_0 = 7.5478e-04
Loss = 2.9481e-03, PNorm = 44.2029, GNorm = 0.6938, lr_0 = 7.2281e-04
Validation rmse = 1.483775
Epoch 6
Loss = 2.2557e-03, PNorm = 44.2292, GNorm = 0.8856, lr_0 = 6.8920e-04
Loss = 2.7061e-03, PNorm = 44.2536, GNorm = 1.2257, lr_0 = 6.6001e-04
Validation rmse = 1.368227
Epoch 7
Loss = 2.8935e-03, PNorm = 44.2734, GNorm = 1.9185, lr_0 = 6.3205e-04
Loss = 2.3104e-03, PNorm = 44.2978, GNorm = 1.1381, lr_0 = 6.0528e-04
Validation rmse = 1.240490
Epoch 8
Loss = 2.6712e-03, PNorm = 44.3203, GNorm = 1.2376, lr_0 = 5.7714e-04
Loss = 2.3958e-03, PNorm = 44.3394, GNorm = 1.9263, lr_0 = 5.5269e-04
Validation rmse = 1.295090
Epoch 9
Loss = 2.1621e-03, PNorm = 44.3619, GNorm = 0.9848, lr_0 = 5.2928e-04
Loss = 2.2879e-03, PNorm = 44.3786, GNorm = 2.4811, lr_0 = 5.0686e-04
Validation rmse = 1.225084
Epoch 10
Loss = 1.6410e-03, PNorm = 44.3975, GNorm = 0.7550, lr_0 = 4.8539e-04
Loss = 2.2856e-03, PNorm = 44.4132, GNorm = 1.0049, lr_0 = 4.6483e-04
Validation rmse = 1.212213
Epoch 11
Loss = 2.1027e-03, PNorm = 44.4309, GNorm = 0.7583, lr_0 = 4.4322e-04
Loss = 1.7502e-03, PNorm = 44.4467, GNorm = 0.5992, lr_0 = 4.2444e-04
Validation rmse = 1.186199
Epoch 12
Loss = 1.8262e-03, PNorm = 44.4609, GNorm = 1.3912, lr_0 = 4.0646e-04
Loss = 1.8556e-03, PNorm = 44.4766, GNorm = 1.1881, lr_0 = 3.8925e-04
Validation rmse = 1.161228
Epoch 13
Loss = 1.7674e-03, PNorm = 44.4904, GNorm = 0.6928, lr_0 = 3.7276e-04
Loss = 1.8395e-03, PNorm = 44.5029, GNorm = 0.9296, lr_0 = 3.5697e-04
Validation rmse = 1.092354
Epoch 14
Loss = 1.8521e-03, PNorm = 44.5143, GNorm = 0.9223, lr_0 = 3.4037e-04
Loss = 2.0004e-03, PNorm = 44.5239, GNorm = 1.8992, lr_0 = 3.2596e-04
Validation rmse = 1.108589
Epoch 15
Loss = 1.8394e-03, PNorm = 44.5329, GNorm = 2.6146, lr_0 = 3.1215e-04
Loss = 1.8714e-03, PNorm = 44.5420, GNorm = 0.4892, lr_0 = 2.9893e-04
Validation rmse = 1.118689
Epoch 16
Loss = 1.6900e-03, PNorm = 44.5548, GNorm = 0.6249, lr_0 = 2.8503e-04
Loss = 1.8125e-03, PNorm = 44.5650, GNorm = 1.8521, lr_0 = 2.7295e-04
Validation rmse = 1.098297
Epoch 17
Loss = 1.6036e-03, PNorm = 44.5720, GNorm = 0.5366, lr_0 = 2.6139e-04
Loss = 2.0047e-03, PNorm = 44.5829, GNorm = 0.4129, lr_0 = 2.5032e-04
Validation rmse = 1.159093
Epoch 18
Loss = 2.0039e-03, PNorm = 44.5910, GNorm = 0.6793, lr_0 = 2.3972e-04
Loss = 1.9160e-03, PNorm = 44.6006, GNorm = 0.9629, lr_0 = 2.2956e-04
Validation rmse = 1.168188
Epoch 19
Loss = 1.8107e-03, PNorm = 44.6091, GNorm = 0.7400, lr_0 = 2.1889e-04
Loss = 1.6292e-03, PNorm = 44.6171, GNorm = 0.8686, lr_0 = 2.0962e-04
Validation rmse = 1.132449
Epoch 20
Loss = 1.4858e-03, PNorm = 44.6240, GNorm = 0.7136, lr_0 = 2.0074e-04
Loss = 1.7015e-03, PNorm = 44.6313, GNorm = 1.0676, lr_0 = 1.9224e-04
Validation rmse = 1.135476
Epoch 21
Loss = 1.6636e-03, PNorm = 44.6386, GNorm = 2.2417, lr_0 = 1.8409e-04
Loss = 1.8149e-03, PNorm = 44.6444, GNorm = 1.3615, lr_0 = 1.7630e-04
Validation rmse = 1.184979
Epoch 22
Loss = 1.5013e-03, PNorm = 44.6508, GNorm = 1.4979, lr_0 = 1.6810e-04
Loss = 1.7474e-03, PNorm = 44.6563, GNorm = 1.1286, lr_0 = 1.6098e-04
Validation rmse = 1.089588
Epoch 23
Loss = 1.4878e-03, PNorm = 44.6617, GNorm = 0.8706, lr_0 = 1.5416e-04
Loss = 1.6147e-03, PNorm = 44.6658, GNorm = 0.4295, lr_0 = 1.4763e-04
Loss = 2.5324e-03, PNorm = 44.6662, GNorm = 0.8248, lr_0 = 1.4699e-04
Validation rmse = 1.094748
Epoch 24
Loss = 1.5221e-03, PNorm = 44.6691, GNorm = 1.4468, lr_0 = 1.4077e-04
Loss = 1.7817e-03, PNorm = 44.6748, GNorm = 0.6146, lr_0 = 1.3480e-04
Validation rmse = 1.080747
Epoch 25
Loss = 1.7090e-03, PNorm = 44.6789, GNorm = 1.0668, lr_0 = 1.2909e-04
Loss = 1.5137e-03, PNorm = 44.6837, GNorm = 2.3778, lr_0 = 1.2362e-04
Validation rmse = 1.061261
Epoch 26
Loss = 1.8257e-03, PNorm = 44.6873, GNorm = 1.1516, lr_0 = 1.1839e-04
Validation rmse = 1.082938
Epoch 27
Loss = 3.0346e-03, PNorm = 44.6910, GNorm = 2.5355, lr_0 = 1.1288e-04
Loss = 1.4335e-03, PNorm = 44.6945, GNorm = 1.7963, lr_0 = 1.0810e-04
Validation rmse = 1.069623
Epoch 28
Loss = 1.2538e-03, PNorm = 44.6979, GNorm = 1.8264, lr_0 = 1.0352e-04
Loss = 1.4928e-03, PNorm = 44.7007, GNorm = 0.8128, lr_0 = 1.0000e-04
Validation rmse = 1.097990
Epoch 29
Loss = 1.2649e-03, PNorm = 44.7047, GNorm = 0.7702, lr_0 = 1.0000e-04
Loss = 1.3784e-03, PNorm = 44.7076, GNorm = 1.1306, lr_0 = 1.0000e-04
Validation rmse = 1.062908
Model 0 best validation rmse = 1.061261 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.182292
Ensemble test rmse = 1.182292
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.30000000000000004_ffn_num_layers_1_hidden_size_800/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 58 | test scaffolds = 53
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=804, out_features=1, bias=True)
  )
)
Number of parameters = 1,505,605
Moving model to cuda
Epoch 0
Loss = 1.9177e-02, PNorm = 43.7984, GNorm = 3.1462, lr_0 = 3.6053e-04
Validation rmse = 2.070272
Epoch 1
Loss = 8.4362e-03, PNorm = 43.8320, GNorm = 2.8460, lr_0 = 6.2105e-04
Loss = 7.5320e-03, PNorm = 43.8842, GNorm = 2.2266, lr_0 = 8.5789e-04
Validation rmse = 1.511233
Epoch 2
Loss = 5.2219e-03, PNorm = 43.9437, GNorm = 4.5412, lr_0 = 9.8284e-04
Loss = 5.0546e-03, PNorm = 43.9924, GNorm = 1.1412, lr_0 = 9.4120e-04
Validation rmse = 1.417138
Epoch 3
Loss = 5.2510e-03, PNorm = 44.0403, GNorm = 1.9114, lr_0 = 8.9744e-04
Loss = 4.3083e-03, PNorm = 44.0784, GNorm = 2.6628, lr_0 = 8.5943e-04
Validation rmse = 1.240527
Epoch 4
Loss = 4.8772e-03, PNorm = 44.1110, GNorm = 4.8719, lr_0 = 8.2303e-04
Loss = 3.1458e-03, PNorm = 44.1475, GNorm = 0.7724, lr_0 = 7.8816e-04
Validation rmse = 1.179232
Epoch 5
Loss = 3.1922e-03, PNorm = 44.1709, GNorm = 4.4873, lr_0 = 7.5478e-04
Loss = 3.3907e-03, PNorm = 44.1962, GNorm = 1.0056, lr_0 = 7.2281e-04
Validation rmse = 1.253909
Epoch 6
Loss = 3.2210e-03, PNorm = 44.2264, GNorm = 2.8460, lr_0 = 6.8920e-04
Loss = 3.1009e-03, PNorm = 44.2497, GNorm = 2.8098, lr_0 = 6.6001e-04
Validation rmse = 1.131173
Epoch 7
Loss = 2.5889e-03, PNorm = 44.2764, GNorm = 1.5099, lr_0 = 6.3205e-04
Loss = 2.8886e-03, PNorm = 44.2997, GNorm = 1.0900, lr_0 = 6.0528e-04
Validation rmse = 1.171336
Epoch 8
Loss = 2.1508e-03, PNorm = 44.3231, GNorm = 0.9557, lr_0 = 5.7714e-04
Loss = 2.4951e-03, PNorm = 44.3429, GNorm = 1.2722, lr_0 = 5.5269e-04
Validation rmse = 1.191062
Epoch 9
Loss = 2.7390e-03, PNorm = 44.3622, GNorm = 3.9349, lr_0 = 5.2928e-04
Loss = 2.3547e-03, PNorm = 44.3790, GNorm = 1.2637, lr_0 = 5.0686e-04
Validation rmse = 1.168364
Epoch 10
Loss = 2.3404e-03, PNorm = 44.3912, GNorm = 0.6312, lr_0 = 4.8539e-04
Loss = 2.2688e-03, PNorm = 44.4072, GNorm = 1.0045, lr_0 = 4.6483e-04
Validation rmse = 1.103536
Epoch 11
Loss = 2.1551e-03, PNorm = 44.4256, GNorm = 0.6652, lr_0 = 4.4322e-04
Loss = 2.3807e-03, PNorm = 44.4398, GNorm = 1.7230, lr_0 = 4.2444e-04
Validation rmse = 1.115883
Epoch 12
Loss = 2.1516e-03, PNorm = 44.4583, GNorm = 0.9820, lr_0 = 4.0646e-04
Loss = 2.5629e-03, PNorm = 44.4729, GNorm = 3.1036, lr_0 = 3.8925e-04
Validation rmse = 1.086685
Epoch 13
Loss = 2.0088e-03, PNorm = 44.4865, GNorm = 1.2656, lr_0 = 3.7276e-04
Loss = 2.4155e-03, PNorm = 44.5000, GNorm = 2.0667, lr_0 = 3.5697e-04
Validation rmse = 1.255559
Epoch 14
Loss = 2.4458e-03, PNorm = 44.5144, GNorm = 2.1931, lr_0 = 3.4037e-04
Loss = 2.2652e-03, PNorm = 44.5278, GNorm = 1.7964, lr_0 = 3.2596e-04
Validation rmse = 1.101338
Epoch 15
Loss = 1.8829e-03, PNorm = 44.5389, GNorm = 1.0000, lr_0 = 3.1215e-04
Loss = 2.3190e-03, PNorm = 44.5485, GNorm = 2.6812, lr_0 = 2.9893e-04
Validation rmse = 1.060274
Epoch 16
Loss = 2.2752e-03, PNorm = 44.5600, GNorm = 2.2720, lr_0 = 2.8503e-04
Loss = 1.8264e-03, PNorm = 44.5683, GNorm = 1.7923, lr_0 = 2.7295e-04
Validation rmse = 1.134899
Epoch 17
Loss = 1.9895e-03, PNorm = 44.5770, GNorm = 1.3884, lr_0 = 2.6139e-04
Loss = 2.3171e-03, PNorm = 44.5862, GNorm = 1.8308, lr_0 = 2.5032e-04
Validation rmse = 1.044987
Epoch 18
Loss = 1.6942e-03, PNorm = 44.5959, GNorm = 1.0724, lr_0 = 2.3972e-04
Loss = 2.2064e-03, PNorm = 44.6023, GNorm = 1.0731, lr_0 = 2.2956e-04
Validation rmse = 0.966528
Epoch 19
Loss = 1.9031e-03, PNorm = 44.6089, GNorm = 1.2463, lr_0 = 2.1889e-04
Loss = 1.9627e-03, PNorm = 44.6157, GNorm = 0.5335, lr_0 = 2.0962e-04
Validation rmse = 1.032852
Epoch 20
Loss = 2.1290e-03, PNorm = 44.6236, GNorm = 0.5396, lr_0 = 2.0074e-04
Loss = 1.6739e-03, PNorm = 44.6299, GNorm = 0.9382, lr_0 = 1.9224e-04
Validation rmse = 0.974515
Epoch 21
Loss = 1.6481e-03, PNorm = 44.6359, GNorm = 1.7313, lr_0 = 1.8409e-04
Loss = 1.8841e-03, PNorm = 44.6405, GNorm = 1.7813, lr_0 = 1.7630e-04
Validation rmse = 0.968974
Epoch 22
Loss = 1.9152e-03, PNorm = 44.6474, GNorm = 2.1452, lr_0 = 1.6810e-04
Loss = 1.8235e-03, PNorm = 44.6527, GNorm = 2.0806, lr_0 = 1.6098e-04
Validation rmse = 1.027160
Epoch 23
Loss = 1.7518e-03, PNorm = 44.6575, GNorm = 1.0815, lr_0 = 1.5416e-04
Loss = 1.9796e-03, PNorm = 44.6618, GNorm = 1.0349, lr_0 = 1.4763e-04
Loss = 1.7301e-03, PNorm = 44.6624, GNorm = 0.6420, lr_0 = 1.4699e-04
Validation rmse = 1.008838
Epoch 24
Loss = 1.6230e-03, PNorm = 44.6683, GNorm = 0.5098, lr_0 = 1.4077e-04
Loss = 1.7090e-03, PNorm = 44.6732, GNorm = 0.6742, lr_0 = 1.3480e-04
Validation rmse = 0.985194
Epoch 25
Loss = 1.8393e-03, PNorm = 44.6773, GNorm = 1.2560, lr_0 = 1.2909e-04
Loss = 1.6985e-03, PNorm = 44.6805, GNorm = 1.4084, lr_0 = 1.2362e-04
Validation rmse = 0.957915
Epoch 26
Loss = 1.7226e-03, PNorm = 44.6835, GNorm = 0.6733, lr_0 = 1.1839e-04
Validation rmse = 0.979059
Epoch 27
Loss = 1.6359e-03, PNorm = 44.6880, GNorm = 1.5695, lr_0 = 1.1288e-04
Loss = 1.6093e-03, PNorm = 44.6915, GNorm = 0.9516, lr_0 = 1.0810e-04
Validation rmse = 0.998225
Epoch 28
Loss = 1.3545e-03, PNorm = 44.6950, GNorm = 0.5578, lr_0 = 1.0352e-04
Loss = 1.7449e-03, PNorm = 44.6979, GNorm = 0.9356, lr_0 = 1.0000e-04
Validation rmse = 1.022954
Epoch 29
Loss = 1.9222e-03, PNorm = 44.7019, GNorm = 1.0901, lr_0 = 1.0000e-04
Loss = 1.6482e-03, PNorm = 44.7042, GNorm = 1.3570, lr_0 = 1.0000e-04
Validation rmse = 1.025814
Model 0 best validation rmse = 0.957915 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.505402
Ensemble test rmse = 1.505402
10-fold cross validation
	Seed 0 ==> test rmse = 0.946170
	Seed 1 ==> test rmse = 1.087425
	Seed 2 ==> test rmse = 1.217140
	Seed 3 ==> test rmse = 1.107019
	Seed 4 ==> test rmse = 1.089684
	Seed 5 ==> test rmse = 1.201760
	Seed 6 ==> test rmse = 0.979079
	Seed 7 ==> test rmse = 1.077544
	Seed 8 ==> test rmse = 1.182292
	Seed 9 ==> test rmse = 1.505402
Overall test rmse = 1.139351 +/- 0.147925
Elapsed time = 0:05:47
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2100,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_2100/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total scaffolds = 195 | train scaffolds = 91 | val scaffolds = 66 | test scaffolds = 38
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2100, bias=False)
      (W_h): Linear(in_features=2100, out_features=2100, bias=False)
      (W_o): Linear(in_features=2233, out_features=2100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=2104, out_features=2100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=2100, out_features=2100, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=2100, out_features=1, bias=True)
  )
)
Number of parameters = 18,244,801
Moving model to cuda
Epoch 0
Loss = 1.6060e-02, PNorm = 93.5607, GNorm = 5.0308, lr_0 = 3.6053e-04
Validation rmse = 1.259673
Epoch 1
Loss = 6.8249e-03, PNorm = 93.7009, GNorm = 2.3597, lr_0 = 6.2105e-04
Loss = 6.5678e-03, PNorm = 93.8741, GNorm = 1.9491, lr_0 = 8.5789e-04
Validation rmse = 1.122827
Epoch 2
Loss = 3.6407e-03, PNorm = 94.0463, GNorm = 1.5591, lr_0 = 9.8284e-04
Loss = 5.4875e-03, PNorm = 94.1848, GNorm = 1.9001, lr_0 = 9.4120e-04
Validation rmse = 1.045986
Epoch 3
Loss = 2.8865e-03, PNorm = 94.2942, GNorm = 1.1510, lr_0 = 8.9744e-04
Loss = 4.0729e-03, PNorm = 94.3666, GNorm = 1.2892, lr_0 = 8.5943e-04
Validation rmse = 1.281210
Epoch 4
Loss = 4.4509e-03, PNorm = 94.4402, GNorm = 2.3249, lr_0 = 8.2303e-04
Loss = 4.2934e-03, PNorm = 94.5047, GNorm = 2.7235, lr_0 = 7.8816e-04
Validation rmse = 1.152836
Epoch 5
Loss = 3.2128e-03, PNorm = 94.5653, GNorm = 1.3149, lr_0 = 7.5478e-04
Loss = 2.8540e-03, PNorm = 94.6176, GNorm = 1.4553, lr_0 = 7.2281e-04
Validation rmse = 1.144952
Epoch 6
Loss = 2.7516e-03, PNorm = 94.6669, GNorm = 1.0980, lr_0 = 6.8920e-04
Loss = 2.9646e-03, PNorm = 94.7074, GNorm = 4.5100, lr_0 = 6.6001e-04
Validation rmse = 1.136784
Epoch 7
Loss = 2.8967e-03, PNorm = 94.7493, GNorm = 2.5091, lr_0 = 6.3205e-04
Loss = 3.2208e-03, PNorm = 94.7888, GNorm = 0.8754, lr_0 = 6.0528e-04
Validation rmse = 1.005043
Epoch 8
Loss = 2.2320e-03, PNorm = 94.8381, GNorm = 0.8574, lr_0 = 5.7714e-04
Loss = 2.2660e-03, PNorm = 94.8745, GNorm = 0.7605, lr_0 = 5.5269e-04
Validation rmse = 1.056283
Epoch 9
Loss = 1.8503e-03, PNorm = 94.9067, GNorm = 1.5266, lr_0 = 5.2928e-04
Loss = 3.0853e-03, PNorm = 94.9408, GNorm = 1.2770, lr_0 = 5.0686e-04
Validation rmse = 1.014522
Epoch 10
Loss = 2.4263e-03, PNorm = 94.9721, GNorm = 2.0233, lr_0 = 4.8539e-04
Loss = 2.3560e-03, PNorm = 95.0004, GNorm = 0.8438, lr_0 = 4.6483e-04
Validation rmse = 1.097601
Epoch 11
Loss = 1.6564e-03, PNorm = 95.0250, GNorm = 1.0283, lr_0 = 4.4322e-04
Loss = 1.9074e-03, PNorm = 95.0461, GNorm = 1.2613, lr_0 = 4.2444e-04
Validation rmse = 1.049227
Epoch 12
Loss = 1.6847e-03, PNorm = 95.0633, GNorm = 1.7095, lr_0 = 4.0646e-04
Loss = 1.7186e-03, PNorm = 95.0793, GNorm = 0.6662, lr_0 = 3.8925e-04
Validation rmse = 1.071107
Epoch 13
Loss = 1.4158e-03, PNorm = 95.0981, GNorm = 0.5142, lr_0 = 3.7276e-04
Loss = 1.9101e-03, PNorm = 95.1173, GNorm = 1.0359, lr_0 = 3.5697e-04
Validation rmse = 1.045784
Epoch 14
Loss = 1.7828e-03, PNorm = 95.1333, GNorm = 0.9461, lr_0 = 3.4037e-04
Loss = 1.7711e-03, PNorm = 95.1484, GNorm = 0.5985, lr_0 = 3.2596e-04
Validation rmse = 1.088083
Epoch 15
Loss = 1.6966e-03, PNorm = 95.1646, GNorm = 0.5266, lr_0 = 3.1215e-04
Loss = 1.5896e-03, PNorm = 95.1798, GNorm = 1.2450, lr_0 = 2.9893e-04
Validation rmse = 1.027660
Epoch 16
Loss = 1.4532e-03, PNorm = 95.1945, GNorm = 0.6368, lr_0 = 2.8503e-04
Loss = 1.4727e-03, PNorm = 95.2064, GNorm = 0.6960, lr_0 = 2.7295e-04
Validation rmse = 1.040713
Epoch 17
Loss = 1.3328e-03, PNorm = 95.2200, GNorm = 1.3162, lr_0 = 2.6139e-04
Loss = 1.4247e-03, PNorm = 95.2320, GNorm = 0.7268, lr_0 = 2.5032e-04
Validation rmse = 0.971227
Epoch 18
Loss = 1.2974e-03, PNorm = 95.2417, GNorm = 0.3463, lr_0 = 2.3972e-04
Loss = 1.3654e-03, PNorm = 95.2529, GNorm = 0.6713, lr_0 = 2.2956e-04
Validation rmse = 1.099920
Epoch 19
Loss = 1.3566e-03, PNorm = 95.2647, GNorm = 1.5618, lr_0 = 2.1889e-04
Loss = 1.3628e-03, PNorm = 95.2737, GNorm = 0.7100, lr_0 = 2.0962e-04
Validation rmse = 1.081144
Epoch 20
Loss = 1.3593e-03, PNorm = 95.2832, GNorm = 0.6179, lr_0 = 2.0074e-04
Loss = 1.2558e-03, PNorm = 95.2915, GNorm = 0.6304, lr_0 = 1.9224e-04
Validation rmse = 1.087106
Epoch 21
Loss = 1.3007e-03, PNorm = 95.2996, GNorm = 0.5485, lr_0 = 1.8409e-04
Loss = 1.2828e-03, PNorm = 95.3085, GNorm = 0.9853, lr_0 = 1.7630e-04
Validation rmse = 0.976675
Epoch 22
Loss = 1.1125e-03, PNorm = 95.3159, GNorm = 0.5943, lr_0 = 1.6810e-04
Loss = 1.2766e-03, PNorm = 95.3221, GNorm = 0.6123, lr_0 = 1.6098e-04
Validation rmse = 1.019954
Epoch 23
Loss = 1.2036e-03, PNorm = 95.3281, GNorm = 0.8244, lr_0 = 1.5416e-04
Loss = 1.1733e-03, PNorm = 95.3372, GNorm = 0.6916, lr_0 = 1.4763e-04
Loss = 1.8303e-03, PNorm = 95.3382, GNorm = 0.7355, lr_0 = 1.4699e-04
Validation rmse = 1.014202
Epoch 24
Loss = 1.2400e-03, PNorm = 95.3438, GNorm = 2.1047, lr_0 = 1.4077e-04
Loss = 1.4181e-03, PNorm = 95.3517, GNorm = 1.2866, lr_0 = 1.3480e-04
Validation rmse = 1.102265
Epoch 25
Loss = 1.3228e-03, PNorm = 95.3561, GNorm = 1.1460, lr_0 = 1.2909e-04
Loss = 1.0823e-03, PNorm = 95.3626, GNorm = 0.9862, lr_0 = 1.2362e-04
Validation rmse = 1.042961
Epoch 26
Loss = 1.1066e-03, PNorm = 95.3669, GNorm = 0.7572, lr_0 = 1.1839e-04
Validation rmse = 1.028340
Epoch 27
Loss = 1.2794e-03, PNorm = 95.3726, GNorm = 1.6262, lr_0 = 1.1288e-04
Loss = 1.3508e-03, PNorm = 95.3758, GNorm = 1.3198, lr_0 = 1.0810e-04
Validation rmse = 1.036116
Epoch 28
Loss = 1.9142e-03, PNorm = 95.3807, GNorm = 0.9165, lr_0 = 1.0352e-04
Loss = 1.1037e-03, PNorm = 95.3844, GNorm = 0.5100, lr_0 = 1.0000e-04
Validation rmse = 0.990462
Epoch 29
Loss = 1.1147e-03, PNorm = 95.3892, GNorm = 1.3912, lr_0 = 1.0000e-04
Loss = 1.1034e-03, PNorm = 95.3931, GNorm = 0.6284, lr_0 = 1.0000e-04
Validation rmse = 1.036846
Model 0 best validation rmse = 0.971227 on epoch 17
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.885723
Ensemble test rmse = 0.885723
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2100,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_2100/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total scaffolds = 195 | train scaffolds = 76 | val scaffolds = 60 | test scaffolds = 59
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2100, bias=False)
      (W_h): Linear(in_features=2100, out_features=2100, bias=False)
      (W_o): Linear(in_features=2233, out_features=2100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=2104, out_features=2100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=2100, out_features=2100, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=2100, out_features=1, bias=True)
  )
)
Number of parameters = 18,244,801
Moving model to cuda
Epoch 0
Loss = 1.5797e-02, PNorm = 93.5625, GNorm = 5.5080, lr_0 = 3.6053e-04
Validation rmse = 1.325651
Epoch 1
Loss = 7.1032e-03, PNorm = 93.6899, GNorm = 1.8491, lr_0 = 6.2105e-04
Loss = 6.9196e-03, PNorm = 93.8573, GNorm = 3.7244, lr_0 = 8.5789e-04
Validation rmse = 1.817290
Epoch 2
Loss = 1.2456e-02, PNorm = 94.0258, GNorm = 4.5151, lr_0 = 9.8284e-04
Loss = 5.1757e-03, PNorm = 94.1636, GNorm = 1.2592, lr_0 = 9.4120e-04
Validation rmse = 1.179690
Epoch 3
Loss = 5.0364e-03, PNorm = 94.2708, GNorm = 4.3913, lr_0 = 8.9744e-04
Loss = 3.6067e-03, PNorm = 94.3474, GNorm = 1.1571, lr_0 = 8.5943e-04
Validation rmse = 1.291715
Epoch 4
Loss = 1.8886e-03, PNorm = 94.4035, GNorm = 0.6008, lr_0 = 8.2303e-04
Loss = 3.7525e-03, PNorm = 94.4565, GNorm = 1.1508, lr_0 = 7.8816e-04
Validation rmse = 1.021793
Epoch 5
Loss = 3.5520e-03, PNorm = 94.5058, GNorm = 2.6095, lr_0 = 7.5478e-04
Loss = 3.5344e-03, PNorm = 94.5540, GNorm = 1.0795, lr_0 = 7.2281e-04
Validation rmse = 1.109341
Epoch 6
Loss = 3.5729e-03, PNorm = 94.6008, GNorm = 1.1523, lr_0 = 6.8920e-04
Loss = 2.8379e-03, PNorm = 94.6462, GNorm = 1.0837, lr_0 = 6.6001e-04
Validation rmse = 1.189674
Epoch 7
Loss = 2.7074e-03, PNorm = 94.6859, GNorm = 1.1630, lr_0 = 6.3205e-04
Loss = 4.0224e-03, PNorm = 94.7270, GNorm = 1.6960, lr_0 = 6.0528e-04
Validation rmse = 1.028798
Epoch 8
Loss = 2.0457e-03, PNorm = 94.7742, GNorm = 0.6692, lr_0 = 5.7714e-04
Loss = 2.3013e-03, PNorm = 94.8097, GNorm = 1.3417, lr_0 = 5.5269e-04
Validation rmse = 1.052488
Epoch 9
Loss = 1.5706e-03, PNorm = 94.8440, GNorm = 0.5698, lr_0 = 5.2928e-04
Loss = 2.2586e-03, PNorm = 94.8714, GNorm = 0.6654, lr_0 = 5.0686e-04
Validation rmse = 1.131872
Epoch 10
Loss = 1.9333e-03, PNorm = 94.8980, GNorm = 0.7589, lr_0 = 4.8539e-04
Loss = 1.8666e-03, PNorm = 94.9219, GNorm = 0.6593, lr_0 = 4.6483e-04
Validation rmse = 0.997080
Epoch 11
Loss = 2.3208e-03, PNorm = 94.9491, GNorm = 3.3825, lr_0 = 4.4322e-04
Loss = 2.1906e-03, PNorm = 94.9710, GNorm = 2.1709, lr_0 = 4.2444e-04
Validation rmse = 1.086079
Epoch 12
Loss = 1.7117e-03, PNorm = 94.9929, GNorm = 0.7307, lr_0 = 4.0646e-04
Loss = 1.7585e-03, PNorm = 95.0103, GNorm = 0.7913, lr_0 = 3.8925e-04
Validation rmse = 1.049865
Epoch 13
Loss = 1.8117e-03, PNorm = 95.0258, GNorm = 1.3879, lr_0 = 3.7276e-04
Loss = 1.5664e-03, PNorm = 95.0418, GNorm = 0.5334, lr_0 = 3.5697e-04
Validation rmse = 0.989300
Epoch 14
Loss = 1.5017e-03, PNorm = 95.0575, GNorm = 1.4021, lr_0 = 3.4037e-04
Loss = 1.6838e-03, PNorm = 95.0747, GNorm = 0.9055, lr_0 = 3.2596e-04
Validation rmse = 1.119954
Epoch 15
Loss = 1.7538e-03, PNorm = 95.0891, GNorm = 0.8661, lr_0 = 3.1215e-04
Loss = 1.2757e-03, PNorm = 95.1014, GNorm = 1.0088, lr_0 = 2.9893e-04
Validation rmse = 1.008833
Epoch 16
Loss = 1.5144e-03, PNorm = 95.1129, GNorm = 1.4230, lr_0 = 2.8503e-04
Loss = 1.7854e-03, PNorm = 95.1246, GNorm = 1.6454, lr_0 = 2.7295e-04
Validation rmse = 1.041567
Epoch 17
Loss = 1.4748e-03, PNorm = 95.1390, GNorm = 1.4427, lr_0 = 2.6139e-04
Loss = 1.3581e-03, PNorm = 95.1485, GNorm = 0.8265, lr_0 = 2.5032e-04
Validation rmse = 1.037524
Epoch 18
Loss = 1.3207e-03, PNorm = 95.1585, GNorm = 1.3267, lr_0 = 2.3972e-04
Loss = 1.3775e-03, PNorm = 95.1684, GNorm = 1.7161, lr_0 = 2.2956e-04
Validation rmse = 1.058893
Epoch 19
Loss = 1.1223e-03, PNorm = 95.1793, GNorm = 2.0247, lr_0 = 2.1889e-04
Loss = 1.2259e-03, PNorm = 95.1884, GNorm = 0.8788, lr_0 = 2.0962e-04
Validation rmse = 1.032067
Epoch 20
Loss = 1.1752e-03, PNorm = 95.1971, GNorm = 1.3518, lr_0 = 2.0074e-04
Loss = 1.3476e-03, PNorm = 95.2039, GNorm = 0.4784, lr_0 = 1.9224e-04
Validation rmse = 1.014896
Epoch 21
Loss = 1.2284e-03, PNorm = 95.2106, GNorm = 0.5487, lr_0 = 1.8409e-04
Loss = 1.3878e-03, PNorm = 95.2180, GNorm = 1.0742, lr_0 = 1.7630e-04
Validation rmse = 0.971935
Epoch 22
Loss = 1.3570e-03, PNorm = 95.2259, GNorm = 1.4374, lr_0 = 1.6810e-04
Loss = 1.1600e-03, PNorm = 95.2328, GNorm = 1.3015, lr_0 = 1.6098e-04
Validation rmse = 1.075114
Epoch 23
Loss = 1.2509e-03, PNorm = 95.2396, GNorm = 0.6749, lr_0 = 1.5416e-04
Loss = 1.2531e-03, PNorm = 95.2441, GNorm = 0.7027, lr_0 = 1.4763e-04
Loss = 1.4949e-03, PNorm = 95.2449, GNorm = 0.8106, lr_0 = 1.4699e-04
Validation rmse = 1.031560
Epoch 24
Loss = 1.2293e-03, PNorm = 95.2518, GNorm = 0.3648, lr_0 = 1.4077e-04
Loss = 1.1224e-03, PNorm = 95.2566, GNorm = 0.8981, lr_0 = 1.3480e-04
Validation rmse = 1.048805
Epoch 25
Loss = 1.0240e-03, PNorm = 95.2615, GNorm = 0.6866, lr_0 = 1.2909e-04
Loss = 1.2402e-03, PNorm = 95.2661, GNorm = 1.4048, lr_0 = 1.2362e-04
Validation rmse = 1.024043
Epoch 26
Loss = 1.1572e-03, PNorm = 95.2711, GNorm = 0.7694, lr_0 = 1.1839e-04
Validation rmse = 1.016720
Epoch 27
Loss = 1.1757e-03, PNorm = 95.2757, GNorm = 0.9605, lr_0 = 1.1288e-04
Loss = 1.0101e-03, PNorm = 95.2807, GNorm = 0.5153, lr_0 = 1.0810e-04
Validation rmse = 1.040966
Epoch 28
Loss = 8.6047e-04, PNorm = 95.2843, GNorm = 0.7195, lr_0 = 1.0352e-04
Loss = 1.2706e-03, PNorm = 95.2892, GNorm = 1.0016, lr_0 = 1.0000e-04
Validation rmse = 1.053495
Epoch 29
Loss = 8.1428e-04, PNorm = 95.2928, GNorm = 0.5112, lr_0 = 1.0000e-04
Loss = 1.0640e-03, PNorm = 95.2969, GNorm = 1.1728, lr_0 = 1.0000e-04
Validation rmse = 1.075467
Model 0 best validation rmse = 0.971935 on epoch 21
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.003340
Ensemble test rmse = 1.003340
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2100,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_2100/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total scaffolds = 195 | train scaffolds = 55 | val scaffolds = 64 | test scaffolds = 76
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2100, bias=False)
      (W_h): Linear(in_features=2100, out_features=2100, bias=False)
      (W_o): Linear(in_features=2233, out_features=2100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=2104, out_features=2100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=2100, out_features=2100, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=2100, out_features=1, bias=True)
  )
)
Number of parameters = 18,244,801
Moving model to cuda
Epoch 0
Loss = 1.6145e-02, PNorm = 93.5613, GNorm = 2.0846, lr_0 = 3.6053e-04
Validation rmse = 1.484525
Epoch 1
Loss = 9.9113e-03, PNorm = 93.6877, GNorm = 2.5331, lr_0 = 6.2105e-04
Loss = 8.3610e-03, PNorm = 93.8652, GNorm = 2.7052, lr_0 = 8.5789e-04
Validation rmse = 1.401588
Epoch 2
Loss = 6.8074e-03, PNorm = 94.0446, GNorm = 1.4335, lr_0 = 9.8284e-04
Loss = 5.7798e-03, PNorm = 94.1856, GNorm = 2.8499, lr_0 = 9.4120e-04
Validation rmse = 1.175159
Epoch 3
Loss = 4.8347e-03, PNorm = 94.2904, GNorm = 1.3116, lr_0 = 8.9744e-04
Loss = 4.1409e-03, PNorm = 94.3652, GNorm = 1.4430, lr_0 = 8.5943e-04
Validation rmse = 1.274917
Epoch 4
Loss = 3.6053e-03, PNorm = 94.4227, GNorm = 1.5794, lr_0 = 8.2303e-04
Loss = 4.6462e-03, PNorm = 94.4842, GNorm = 3.5079, lr_0 = 7.8816e-04
Validation rmse = 1.194069
Epoch 5
Loss = 2.7337e-03, PNorm = 94.5416, GNorm = 1.6056, lr_0 = 7.5478e-04
Loss = 3.1715e-03, PNorm = 94.5863, GNorm = 0.7461, lr_0 = 7.2281e-04
Validation rmse = 1.166148
Epoch 6
Loss = 3.0253e-03, PNorm = 94.6309, GNorm = 0.9890, lr_0 = 6.8920e-04
Loss = 2.9332e-03, PNorm = 94.6727, GNorm = 1.0226, lr_0 = 6.6001e-04
Validation rmse = 1.204202
Epoch 7
Loss = 3.2280e-03, PNorm = 94.7105, GNorm = 1.0764, lr_0 = 6.3205e-04
Loss = 2.6935e-03, PNorm = 94.7458, GNorm = 1.5635, lr_0 = 6.0528e-04
Validation rmse = 1.187960
Epoch 8
Loss = 3.3142e-03, PNorm = 94.7883, GNorm = 1.0405, lr_0 = 5.7714e-04
Loss = 2.6559e-03, PNorm = 94.8238, GNorm = 0.8486, lr_0 = 5.5269e-04
Validation rmse = 1.129683
Epoch 9
Loss = 2.1897e-03, PNorm = 94.8533, GNorm = 1.4177, lr_0 = 5.2928e-04
Loss = 2.4822e-03, PNorm = 94.8843, GNorm = 0.8145, lr_0 = 5.0686e-04
Validation rmse = 1.081295
Epoch 10
Loss = 2.6333e-03, PNorm = 94.9096, GNorm = 1.8006, lr_0 = 4.8539e-04
Loss = 2.1057e-03, PNorm = 94.9346, GNorm = 1.2904, lr_0 = 4.6483e-04
Validation rmse = 1.110114
Epoch 11
Loss = 2.9437e-03, PNorm = 94.9612, GNorm = 1.0182, lr_0 = 4.4322e-04
Loss = 2.5057e-03, PNorm = 94.9880, GNorm = 0.7973, lr_0 = 4.2444e-04
Validation rmse = 1.191557
Epoch 12
Loss = 2.4170e-03, PNorm = 95.0109, GNorm = 1.1464, lr_0 = 4.0646e-04
Loss = 2.2060e-03, PNorm = 95.0301, GNorm = 1.4146, lr_0 = 3.8925e-04
Validation rmse = 1.189445
Epoch 13
Loss = 2.1220e-03, PNorm = 95.0473, GNorm = 1.1514, lr_0 = 3.7276e-04
Loss = 2.0955e-03, PNorm = 95.0671, GNorm = 0.9226, lr_0 = 3.5697e-04
Validation rmse = 1.202466
Epoch 14
Loss = 2.0689e-03, PNorm = 95.0883, GNorm = 1.4783, lr_0 = 3.4037e-04
Loss = 1.9304e-03, PNorm = 95.1063, GNorm = 1.5817, lr_0 = 3.2596e-04
Validation rmse = 1.167611
Epoch 15
Loss = 1.8681e-03, PNorm = 95.1206, GNorm = 1.2949, lr_0 = 3.1215e-04
Loss = 1.6871e-03, PNorm = 95.1376, GNorm = 0.7010, lr_0 = 2.9893e-04
Validation rmse = 1.085337
Epoch 16
Loss = 1.6726e-03, PNorm = 95.1516, GNorm = 1.2145, lr_0 = 2.8503e-04
Loss = 1.7029e-03, PNorm = 95.1650, GNorm = 1.0074, lr_0 = 2.7295e-04
Validation rmse = 1.133463
Epoch 17
Loss = 1.6193e-03, PNorm = 95.1776, GNorm = 1.9249, lr_0 = 2.6139e-04
Loss = 1.7399e-03, PNorm = 95.1869, GNorm = 2.3247, lr_0 = 2.5032e-04
Validation rmse = 1.172907
Epoch 18
Loss = 1.7904e-03, PNorm = 95.1994, GNorm = 1.0186, lr_0 = 2.3972e-04
Loss = 1.6881e-03, PNorm = 95.2101, GNorm = 0.6593, lr_0 = 2.2956e-04
Validation rmse = 1.078568
Epoch 19
Loss = 1.8043e-03, PNorm = 95.2206, GNorm = 1.8554, lr_0 = 2.1889e-04
Loss = 1.5390e-03, PNorm = 95.2315, GNorm = 0.8642, lr_0 = 2.0962e-04
Validation rmse = 1.020333
Epoch 20
Loss = 1.4060e-03, PNorm = 95.2382, GNorm = 0.6199, lr_0 = 2.0074e-04
Loss = 1.5630e-03, PNorm = 95.2482, GNorm = 0.7566, lr_0 = 1.9224e-04
Validation rmse = 1.069805
Epoch 21
Loss = 1.5448e-03, PNorm = 95.2562, GNorm = 0.5633, lr_0 = 1.8409e-04
Loss = 1.3534e-03, PNorm = 95.2652, GNorm = 0.5586, lr_0 = 1.7630e-04
Validation rmse = 1.080472
Epoch 22
Loss = 1.3503e-03, PNorm = 95.2737, GNorm = 1.3314, lr_0 = 1.6810e-04
Loss = 1.2650e-03, PNorm = 95.2811, GNorm = 0.5464, lr_0 = 1.6098e-04
Validation rmse = 1.021864
Epoch 23
Loss = 1.2503e-03, PNorm = 95.2862, GNorm = 0.7801, lr_0 = 1.5416e-04
Loss = 1.5510e-03, PNorm = 95.2933, GNorm = 0.8483, lr_0 = 1.4763e-04
Loss = 2.1858e-03, PNorm = 95.2937, GNorm = 1.1793, lr_0 = 1.4699e-04
Validation rmse = 1.039819
Epoch 24
Loss = 1.2746e-03, PNorm = 95.2993, GNorm = 1.6077, lr_0 = 1.4077e-04
Loss = 1.4926e-03, PNorm = 95.3049, GNorm = 0.6326, lr_0 = 1.3480e-04
Validation rmse = 1.045094
Epoch 25
Loss = 1.3996e-03, PNorm = 95.3101, GNorm = 0.4588, lr_0 = 1.2909e-04
Loss = 1.1284e-03, PNorm = 95.3156, GNorm = 0.8075, lr_0 = 1.2362e-04
Validation rmse = 1.018743
Epoch 26
Loss = 1.3071e-03, PNorm = 95.3217, GNorm = 0.9898, lr_0 = 1.1839e-04
Validation rmse = 1.045012
Epoch 27
Loss = 9.2101e-04, PNorm = 95.3265, GNorm = 0.5192, lr_0 = 1.1288e-04
Loss = 1.1508e-03, PNorm = 95.3305, GNorm = 0.7067, lr_0 = 1.0810e-04
Validation rmse = 1.035634
Epoch 28
Loss = 1.6322e-03, PNorm = 95.3348, GNorm = 1.0278, lr_0 = 1.0352e-04
Loss = 1.1533e-03, PNorm = 95.3403, GNorm = 0.8942, lr_0 = 1.0000e-04
Validation rmse = 1.045799
Epoch 29
Loss = 1.2184e-03, PNorm = 95.3461, GNorm = 0.6281, lr_0 = 1.0000e-04
Loss = 1.2516e-03, PNorm = 95.3495, GNorm = 1.0515, lr_0 = 1.0000e-04
Validation rmse = 1.052780
Model 0 best validation rmse = 1.018743 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.050452
Ensemble test rmse = 1.050452
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2100,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_2100/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total scaffolds = 195 | train scaffolds = 80 | val scaffolds = 54 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2100, bias=False)
      (W_h): Linear(in_features=2100, out_features=2100, bias=False)
      (W_o): Linear(in_features=2233, out_features=2100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=2104, out_features=2100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=2100, out_features=2100, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=2100, out_features=1, bias=True)
  )
)
Number of parameters = 18,244,801
Moving model to cuda
Epoch 0
Loss = 1.6179e-02, PNorm = 93.5661, GNorm = 40.9659, lr_0 = 3.6053e-04
Validation rmse = 1.317663
Epoch 1
Loss = 6.1336e-03, PNorm = 93.6927, GNorm = 2.3752, lr_0 = 6.2105e-04
Loss = 6.6251e-03, PNorm = 93.8508, GNorm = 2.1457, lr_0 = 8.5789e-04
Validation rmse = 1.430338
Epoch 2
Loss = 5.2934e-03, PNorm = 94.0126, GNorm = 2.0870, lr_0 = 9.8284e-04
Loss = 6.0410e-03, PNorm = 94.1387, GNorm = 1.1995, lr_0 = 9.4120e-04
Validation rmse = 1.543785
Epoch 3
Loss = 3.7467e-03, PNorm = 94.2433, GNorm = 0.8759, lr_0 = 8.9744e-04
Loss = 3.9339e-03, PNorm = 94.3126, GNorm = 1.1096, lr_0 = 8.5943e-04
Validation rmse = 1.150734
Epoch 4
Loss = 3.4215e-03, PNorm = 94.3739, GNorm = 0.9496, lr_0 = 8.2303e-04
Loss = 3.0157e-03, PNorm = 94.4341, GNorm = 1.3107, lr_0 = 7.8816e-04
Validation rmse = 1.522759
Epoch 5
Loss = 4.7711e-03, PNorm = 94.4858, GNorm = 0.6297, lr_0 = 7.5478e-04
Loss = 3.8655e-03, PNorm = 94.5472, GNorm = 1.8225, lr_0 = 7.2281e-04
Validation rmse = 1.210473
Epoch 6
Loss = 2.8083e-03, PNorm = 94.6021, GNorm = 1.4464, lr_0 = 6.8920e-04
Loss = 3.3534e-03, PNorm = 94.6395, GNorm = 1.6016, lr_0 = 6.6001e-04
Validation rmse = 1.201455
Epoch 7
Loss = 2.7309e-03, PNorm = 94.6739, GNorm = 2.4217, lr_0 = 6.3205e-04
Loss = 2.8084e-03, PNorm = 94.7099, GNorm = 1.6912, lr_0 = 6.0528e-04
Validation rmse = 1.145738
Epoch 8
Loss = 2.9972e-03, PNorm = 94.7443, GNorm = 0.8996, lr_0 = 5.7714e-04
Loss = 3.1592e-03, PNorm = 94.7792, GNorm = 1.9674, lr_0 = 5.5269e-04
Validation rmse = 1.238501
Epoch 9
Loss = 2.5780e-03, PNorm = 94.8137, GNorm = 1.3377, lr_0 = 5.2928e-04
Loss = 2.8802e-03, PNorm = 94.8475, GNorm = 0.7354, lr_0 = 5.0686e-04
Validation rmse = 1.057003
Epoch 10
Loss = 2.5294e-03, PNorm = 94.8753, GNorm = 0.5747, lr_0 = 4.8539e-04
Loss = 2.0353e-03, PNorm = 94.9002, GNorm = 1.1983, lr_0 = 4.6483e-04
Validation rmse = 1.153949
Epoch 11
Loss = 1.7932e-03, PNorm = 94.9256, GNorm = 0.8097, lr_0 = 4.4322e-04
Loss = 1.8810e-03, PNorm = 94.9471, GNorm = 0.7403, lr_0 = 4.2444e-04
Validation rmse = 1.128428
Epoch 12
Loss = 1.9391e-03, PNorm = 94.9695, GNorm = 1.1803, lr_0 = 4.0646e-04
Loss = 1.5792e-03, PNorm = 94.9911, GNorm = 1.1671, lr_0 = 3.8925e-04
Validation rmse = 1.092533
Epoch 13
Loss = 1.6541e-03, PNorm = 95.0080, GNorm = 0.7299, lr_0 = 3.7276e-04
Loss = 1.5164e-03, PNorm = 95.0251, GNorm = 0.9209, lr_0 = 3.5697e-04
Validation rmse = 1.150396
Epoch 14
Loss = 1.5501e-03, PNorm = 95.0446, GNorm = 1.5370, lr_0 = 3.4037e-04
Loss = 1.4602e-03, PNorm = 95.0601, GNorm = 0.9268, lr_0 = 3.2596e-04
Validation rmse = 1.240445
Epoch 15
Loss = 1.8240e-03, PNorm = 95.0720, GNorm = 1.5844, lr_0 = 3.1215e-04
Loss = 1.6336e-03, PNorm = 95.0878, GNorm = 1.2802, lr_0 = 2.9893e-04
Validation rmse = 1.157510
Epoch 16
Loss = 1.4663e-03, PNorm = 95.1032, GNorm = 1.3535, lr_0 = 2.8503e-04
Loss = 1.7453e-03, PNorm = 95.1172, GNorm = 1.1952, lr_0 = 2.7295e-04
Validation rmse = 1.116280
Epoch 17
Loss = 1.4732e-03, PNorm = 95.1315, GNorm = 0.7979, lr_0 = 2.6139e-04
Loss = 1.5112e-03, PNorm = 95.1454, GNorm = 0.5310, lr_0 = 2.5032e-04
Validation rmse = 1.141782
Epoch 18
Loss = 1.1378e-03, PNorm = 95.1567, GNorm = 0.9144, lr_0 = 2.3972e-04
Loss = 1.4188e-03, PNorm = 95.1677, GNorm = 0.6751, lr_0 = 2.2956e-04
Validation rmse = 1.140552
Epoch 19
Loss = 1.3438e-03, PNorm = 95.1816, GNorm = 0.3996, lr_0 = 2.1889e-04
Loss = 1.2741e-03, PNorm = 95.1891, GNorm = 0.8180, lr_0 = 2.0962e-04
Validation rmse = 1.095655
Epoch 20
Loss = 1.1019e-03, PNorm = 95.1957, GNorm = 1.0407, lr_0 = 2.0074e-04
Loss = 1.3047e-03, PNorm = 95.2029, GNorm = 1.0053, lr_0 = 1.9224e-04
Validation rmse = 1.101022
Epoch 21
Loss = 1.0582e-03, PNorm = 95.2104, GNorm = 0.4133, lr_0 = 1.8409e-04
Loss = 1.2672e-03, PNorm = 95.2185, GNorm = 1.7655, lr_0 = 1.7630e-04
Validation rmse = 1.115062
Epoch 22
Loss = 1.3122e-03, PNorm = 95.2281, GNorm = 0.8035, lr_0 = 1.6810e-04
Loss = 1.1303e-03, PNorm = 95.2352, GNorm = 0.5471, lr_0 = 1.6098e-04
Validation rmse = 1.079031
Epoch 23
Loss = 1.0410e-03, PNorm = 95.2411, GNorm = 1.1319, lr_0 = 1.5416e-04
Loss = 1.1509e-03, PNorm = 95.2472, GNorm = 1.3736, lr_0 = 1.4763e-04
Loss = 1.6209e-03, PNorm = 95.2481, GNorm = 0.6579, lr_0 = 1.4699e-04
Validation rmse = 1.074117
Epoch 24
Loss = 1.0740e-03, PNorm = 95.2532, GNorm = 0.7564, lr_0 = 1.4077e-04
Loss = 1.2381e-03, PNorm = 95.2602, GNorm = 1.2065, lr_0 = 1.3480e-04
Validation rmse = 1.087380
Epoch 25
Loss = 1.2029e-03, PNorm = 95.2635, GNorm = 0.8141, lr_0 = 1.2909e-04
Loss = 1.0262e-03, PNorm = 95.2693, GNorm = 0.4517, lr_0 = 1.2362e-04
Validation rmse = 1.099218
Epoch 26
Loss = 1.2853e-03, PNorm = 95.2740, GNorm = 0.7860, lr_0 = 1.1839e-04
Validation rmse = 1.161515
Epoch 27
Loss = 1.3272e-03, PNorm = 95.2787, GNorm = 0.9195, lr_0 = 1.1288e-04
Loss = 9.9298e-04, PNorm = 95.2833, GNorm = 0.8087, lr_0 = 1.0810e-04
Validation rmse = 1.093259
Epoch 28
Loss = 1.1738e-03, PNorm = 95.2869, GNorm = 1.4039, lr_0 = 1.0352e-04
Loss = 9.7032e-04, PNorm = 95.2912, GNorm = 0.5170, lr_0 = 1.0000e-04
Validation rmse = 1.153768
Epoch 29
Loss = 9.5936e-04, PNorm = 95.2950, GNorm = 0.5147, lr_0 = 1.0000e-04
Loss = 1.2181e-03, PNorm = 95.2997, GNorm = 1.1839, lr_0 = 1.0000e-04
Validation rmse = 1.112445
Model 0 best validation rmse = 1.057003 on epoch 9
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.003468
Ensemble test rmse = 1.003468
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2100,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_2100/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 49 | test scaffolds = 62
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2100, bias=False)
      (W_h): Linear(in_features=2100, out_features=2100, bias=False)
      (W_o): Linear(in_features=2233, out_features=2100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=2104, out_features=2100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=2100, out_features=2100, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=2100, out_features=1, bias=True)
  )
)
Number of parameters = 18,244,801
Moving model to cuda
Epoch 0
Loss = 1.5957e-02, PNorm = 93.5598, GNorm = 9.5858, lr_0 = 3.6053e-04
Validation rmse = 1.480213
Epoch 1
Loss = 8.1280e-03, PNorm = 93.6954, GNorm = 4.1742, lr_0 = 6.2105e-04
Loss = 6.6894e-03, PNorm = 93.8589, GNorm = 2.2348, lr_0 = 8.5789e-04
Validation rmse = 1.783457
Epoch 2
Loss = 1.3869e-02, PNorm = 94.0328, GNorm = 9.5833, lr_0 = 9.8284e-04
Loss = 6.0980e-03, PNorm = 94.1732, GNorm = 1.9213, lr_0 = 9.4120e-04
Validation rmse = 1.149139
Epoch 3
Loss = 4.8005e-03, PNorm = 94.2888, GNorm = 2.3330, lr_0 = 8.9744e-04
Loss = 3.5655e-03, PNorm = 94.3666, GNorm = 0.8728, lr_0 = 8.5943e-04
Validation rmse = 0.973944
Epoch 4
Loss = 3.7688e-03, PNorm = 94.4302, GNorm = 1.6379, lr_0 = 8.2303e-04
Loss = 3.3854e-03, PNorm = 94.4870, GNorm = 1.2696, lr_0 = 7.8816e-04
Validation rmse = 1.153976
Epoch 5
Loss = 2.8247e-03, PNorm = 94.5371, GNorm = 2.6986, lr_0 = 7.5478e-04
Loss = 3.5197e-03, PNorm = 94.5823, GNorm = 2.5226, lr_0 = 7.2281e-04
Validation rmse = 0.888158
Epoch 6
Loss = 2.3644e-03, PNorm = 94.6356, GNorm = 0.6157, lr_0 = 6.8920e-04
Loss = 3.0559e-03, PNorm = 94.6735, GNorm = 0.6256, lr_0 = 6.6001e-04
Validation rmse = 0.916428
Epoch 7
Loss = 1.8995e-03, PNorm = 94.7144, GNorm = 1.0389, lr_0 = 6.3205e-04
Loss = 3.4815e-03, PNorm = 94.7476, GNorm = 0.7146, lr_0 = 6.0528e-04
Validation rmse = 1.340395
Epoch 8
Loss = 3.0998e-03, PNorm = 94.7860, GNorm = 1.4150, lr_0 = 5.7714e-04
Loss = 2.3697e-03, PNorm = 94.8212, GNorm = 0.7547, lr_0 = 5.5269e-04
Validation rmse = 1.040007
Epoch 9
Loss = 2.1174e-03, PNorm = 94.8530, GNorm = 0.6916, lr_0 = 5.2928e-04
Loss = 2.4075e-03, PNorm = 94.8806, GNorm = 0.5281, lr_0 = 5.0686e-04
Validation rmse = 1.003618
Epoch 10
Loss = 2.2167e-03, PNorm = 94.9051, GNorm = 1.3763, lr_0 = 4.8539e-04
Loss = 2.3291e-03, PNorm = 94.9300, GNorm = 0.5931, lr_0 = 4.6483e-04
Validation rmse = 0.984439
Epoch 11
Loss = 2.4877e-03, PNorm = 94.9589, GNorm = 2.2095, lr_0 = 4.4322e-04
Loss = 2.3211e-03, PNorm = 94.9826, GNorm = 1.7186, lr_0 = 4.2444e-04
Validation rmse = 1.031790
Epoch 12
Loss = 1.5202e-03, PNorm = 95.0003, GNorm = 0.4777, lr_0 = 4.0646e-04
Loss = 1.8851e-03, PNorm = 95.0183, GNorm = 1.0880, lr_0 = 3.8925e-04
Validation rmse = 0.962881
Epoch 13
Loss = 1.6947e-03, PNorm = 95.0350, GNorm = 1.8284, lr_0 = 3.7276e-04
Loss = 2.0584e-03, PNorm = 95.0518, GNorm = 0.9952, lr_0 = 3.5697e-04
Validation rmse = 0.948277
Epoch 14
Loss = 1.6372e-03, PNorm = 95.0694, GNorm = 1.7491, lr_0 = 3.4037e-04
Loss = 1.8310e-03, PNorm = 95.0852, GNorm = 0.6871, lr_0 = 3.2596e-04
Validation rmse = 0.934590
Epoch 15
Loss = 1.5416e-03, PNorm = 95.0971, GNorm = 1.3934, lr_0 = 3.1215e-04
Loss = 1.5775e-03, PNorm = 95.1104, GNorm = 1.3647, lr_0 = 2.9893e-04
Validation rmse = 0.890808
Epoch 16
Loss = 1.4012e-03, PNorm = 95.1243, GNorm = 1.0207, lr_0 = 2.8503e-04
Loss = 1.7674e-03, PNorm = 95.1366, GNorm = 0.8493, lr_0 = 2.7295e-04
Validation rmse = 0.878967
Epoch 17
Loss = 1.2961e-03, PNorm = 95.1477, GNorm = 0.8485, lr_0 = 2.6139e-04
Loss = 1.4507e-03, PNorm = 95.1583, GNorm = 0.3825, lr_0 = 2.5032e-04
Validation rmse = 0.878930
Epoch 18
Loss = 1.7098e-03, PNorm = 95.1702, GNorm = 0.5195, lr_0 = 2.3972e-04
Loss = 1.3104e-03, PNorm = 95.1815, GNorm = 1.1620, lr_0 = 2.2956e-04
Validation rmse = 0.925155
Epoch 19
Loss = 1.4514e-03, PNorm = 95.1915, GNorm = 0.5427, lr_0 = 2.1889e-04
Loss = 1.4961e-03, PNorm = 95.2016, GNorm = 0.6076, lr_0 = 2.0962e-04
Validation rmse = 1.058661
Epoch 20
Loss = 1.5684e-03, PNorm = 95.2107, GNorm = 0.6552, lr_0 = 2.0074e-04
Loss = 1.3501e-03, PNorm = 95.2183, GNorm = 0.9939, lr_0 = 1.9224e-04
Validation rmse = 1.111146
Epoch 21
Loss = 1.3152e-03, PNorm = 95.2261, GNorm = 0.8056, lr_0 = 1.8409e-04
Loss = 1.4695e-03, PNorm = 95.2354, GNorm = 1.4839, lr_0 = 1.7630e-04
Validation rmse = 0.926480
Epoch 22
Loss = 1.4070e-03, PNorm = 95.2425, GNorm = 1.7909, lr_0 = 1.6810e-04
Loss = 1.3992e-03, PNorm = 95.2496, GNorm = 0.5641, lr_0 = 1.6098e-04
Validation rmse = 0.909098
Epoch 23
Loss = 1.2827e-03, PNorm = 95.2537, GNorm = 0.8794, lr_0 = 1.5416e-04
Loss = 1.2325e-03, PNorm = 95.2604, GNorm = 0.4586, lr_0 = 1.4763e-04
Loss = 1.6001e-03, PNorm = 95.2608, GNorm = 0.5637, lr_0 = 1.4699e-04
Validation rmse = 0.885418
Epoch 24
Loss = 1.0650e-03, PNorm = 95.2663, GNorm = 0.6029, lr_0 = 1.4077e-04
Loss = 1.4539e-03, PNorm = 95.2723, GNorm = 0.9785, lr_0 = 1.3480e-04
Validation rmse = 1.000833
Epoch 25
Loss = 1.1112e-03, PNorm = 95.2770, GNorm = 1.0103, lr_0 = 1.2909e-04
Loss = 1.4394e-03, PNorm = 95.2815, GNorm = 1.6865, lr_0 = 1.2362e-04
Validation rmse = 0.903752
Epoch 26
Loss = 1.0260e-03, PNorm = 95.2860, GNorm = 0.9693, lr_0 = 1.1839e-04
Validation rmse = 0.885792
Epoch 27
Loss = 1.0151e-03, PNorm = 95.2911, GNorm = 0.7620, lr_0 = 1.1288e-04
Loss = 1.0403e-03, PNorm = 95.2943, GNorm = 0.5667, lr_0 = 1.0810e-04
Validation rmse = 0.854183
Epoch 28
Loss = 7.9360e-04, PNorm = 95.3000, GNorm = 0.7822, lr_0 = 1.0352e-04
Loss = 1.1203e-03, PNorm = 95.3026, GNorm = 0.6327, lr_0 = 1.0000e-04
Validation rmse = 0.973101
Epoch 29
Loss = 9.6487e-04, PNorm = 95.3066, GNorm = 0.6966, lr_0 = 1.0000e-04
Loss = 1.1027e-03, PNorm = 95.3100, GNorm = 0.7582, lr_0 = 1.0000e-04
Validation rmse = 0.882295
Model 0 best validation rmse = 0.854183 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.030331
Ensemble test rmse = 1.030331
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2100,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_2100/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total scaffolds = 195 | train scaffolds = 94 | val scaffolds = 55 | test scaffolds = 46
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2100, bias=False)
      (W_h): Linear(in_features=2100, out_features=2100, bias=False)
      (W_o): Linear(in_features=2233, out_features=2100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=2104, out_features=2100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=2100, out_features=2100, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=2100, out_features=1, bias=True)
  )
)
Number of parameters = 18,244,801
Moving model to cuda
Epoch 0
Loss = 1.6535e-02, PNorm = 93.5597, GNorm = 5.0139, lr_0 = 3.6053e-04
Validation rmse = 1.647729
Epoch 1
Loss = 6.3198e-03, PNorm = 93.6964, GNorm = 2.0100, lr_0 = 6.2105e-04
Loss = 6.3076e-03, PNorm = 93.8624, GNorm = 2.5689, lr_0 = 8.5789e-04
Validation rmse = 1.523245
Epoch 2
Loss = 5.4004e-03, PNorm = 94.0397, GNorm = 1.0903, lr_0 = 9.8284e-04
Loss = 5.7976e-03, PNorm = 94.1795, GNorm = 1.0374, lr_0 = 9.4120e-04
Validation rmse = 1.492875
Epoch 3
Loss = 4.7494e-03, PNorm = 94.2853, GNorm = 1.1093, lr_0 = 8.9744e-04
Loss = 4.3579e-03, PNorm = 94.3585, GNorm = 1.1356, lr_0 = 8.5943e-04
Validation rmse = 1.539408
Epoch 4
Loss = 3.2812e-03, PNorm = 94.4154, GNorm = 1.5189, lr_0 = 8.2303e-04
Loss = 3.7360e-03, PNorm = 94.4701, GNorm = 0.5911, lr_0 = 7.8816e-04
Validation rmse = 1.145131
Epoch 5
Loss = 2.7647e-03, PNorm = 94.5223, GNorm = 0.7912, lr_0 = 7.5478e-04
Loss = 2.9303e-03, PNorm = 94.5601, GNorm = 1.4714, lr_0 = 7.2281e-04
Validation rmse = 1.139865
Epoch 6
Loss = 2.7664e-03, PNorm = 94.6017, GNorm = 0.6717, lr_0 = 6.8920e-04
Loss = 2.5284e-03, PNorm = 94.6412, GNorm = 0.9084, lr_0 = 6.6001e-04
Validation rmse = 1.113062
Epoch 7
Loss = 2.3316e-03, PNorm = 94.6798, GNorm = 0.4915, lr_0 = 6.3205e-04
Loss = 2.7485e-03, PNorm = 94.7155, GNorm = 1.6457, lr_0 = 6.0528e-04
Validation rmse = 1.024912
Epoch 8
Loss = 1.9483e-03, PNorm = 94.7514, GNorm = 0.5767, lr_0 = 5.7714e-04
Loss = 2.2943e-03, PNorm = 94.7865, GNorm = 0.7857, lr_0 = 5.5269e-04
Validation rmse = 1.165955
Epoch 9
Loss = 2.2492e-03, PNorm = 94.8164, GNorm = 0.7616, lr_0 = 5.2928e-04
Loss = 2.9909e-03, PNorm = 94.8418, GNorm = 1.1256, lr_0 = 5.0686e-04
Validation rmse = 1.192626
Epoch 10
Loss = 2.4344e-03, PNorm = 94.8721, GNorm = 1.0154, lr_0 = 4.8539e-04
Loss = 2.2565e-03, PNorm = 94.8986, GNorm = 0.6607, lr_0 = 4.6483e-04
Validation rmse = 1.140460
Epoch 11
Loss = 2.0608e-03, PNorm = 94.9246, GNorm = 1.0390, lr_0 = 4.4322e-04
Loss = 1.8123e-03, PNorm = 94.9511, GNorm = 0.5344, lr_0 = 4.2444e-04
Validation rmse = 1.100676
Epoch 12
Loss = 1.9126e-03, PNorm = 94.9697, GNorm = 0.8542, lr_0 = 4.0646e-04
Loss = 2.0145e-03, PNorm = 94.9904, GNorm = 1.7503, lr_0 = 3.8925e-04
Validation rmse = 1.135247
Epoch 13
Loss = 1.8276e-03, PNorm = 95.0108, GNorm = 1.9158, lr_0 = 3.7276e-04
Loss = 1.6504e-03, PNorm = 95.0283, GNorm = 0.6923, lr_0 = 3.5697e-04
Validation rmse = 1.097616
Epoch 14
Loss = 1.6811e-03, PNorm = 95.0477, GNorm = 0.8772, lr_0 = 3.4037e-04
Loss = 1.3573e-03, PNorm = 95.0646, GNorm = 0.8929, lr_0 = 3.2596e-04
Validation rmse = 1.070712
Epoch 15
Loss = 1.5589e-03, PNorm = 95.0817, GNorm = 0.6181, lr_0 = 3.1215e-04
Loss = 1.6548e-03, PNorm = 95.0976, GNorm = 1.3426, lr_0 = 2.9893e-04
Validation rmse = 1.086469
Epoch 16
Loss = 1.6342e-03, PNorm = 95.1142, GNorm = 0.7076, lr_0 = 2.8503e-04
Loss = 1.6558e-03, PNorm = 95.1280, GNorm = 1.3600, lr_0 = 2.7295e-04
Validation rmse = 1.092118
Epoch 17
Loss = 1.5423e-03, PNorm = 95.1421, GNorm = 0.4475, lr_0 = 2.6139e-04
Loss = 1.5925e-03, PNorm = 95.1548, GNorm = 0.6138, lr_0 = 2.5032e-04
Validation rmse = 1.049112
Epoch 18
Loss = 1.3950e-03, PNorm = 95.1651, GNorm = 0.4555, lr_0 = 2.3972e-04
Loss = 1.3558e-03, PNorm = 95.1777, GNorm = 0.8472, lr_0 = 2.2956e-04
Validation rmse = 1.132375
Epoch 19
Loss = 1.4727e-03, PNorm = 95.1916, GNorm = 1.0192, lr_0 = 2.1889e-04
Loss = 1.6499e-03, PNorm = 95.1985, GNorm = 0.7349, lr_0 = 2.0962e-04
Validation rmse = 1.177832
Epoch 20
Loss = 1.4168e-03, PNorm = 95.2105, GNorm = 0.9133, lr_0 = 2.0074e-04
Loss = 1.6084e-03, PNorm = 95.2176, GNorm = 1.9188, lr_0 = 1.9224e-04
Validation rmse = 1.033957
Epoch 21
Loss = 1.1772e-03, PNorm = 95.2268, GNorm = 0.8936, lr_0 = 1.8409e-04
Loss = 1.3385e-03, PNorm = 95.2346, GNorm = 1.3498, lr_0 = 1.7630e-04
Validation rmse = 1.048929
Epoch 22
Loss = 1.1310e-03, PNorm = 95.2429, GNorm = 0.5520, lr_0 = 1.6810e-04
Loss = 1.3144e-03, PNorm = 95.2508, GNorm = 1.0095, lr_0 = 1.6098e-04
Validation rmse = 0.976245
Epoch 23
Loss = 1.3740e-03, PNorm = 95.2558, GNorm = 1.3036, lr_0 = 1.5416e-04
Loss = 1.1230e-03, PNorm = 95.2612, GNorm = 0.9916, lr_0 = 1.4763e-04
Loss = 9.1103e-04, PNorm = 95.2615, GNorm = 0.3905, lr_0 = 1.4699e-04
Validation rmse = 1.131382
Epoch 24
Loss = 1.0821e-03, PNorm = 95.2673, GNorm = 0.6489, lr_0 = 1.4077e-04
Loss = 1.2242e-03, PNorm = 95.2719, GNorm = 0.4863, lr_0 = 1.3480e-04
Validation rmse = 1.157332
Epoch 25
Loss = 1.2734e-03, PNorm = 95.2777, GNorm = 1.7312, lr_0 = 1.2909e-04
Loss = 1.3248e-03, PNorm = 95.2825, GNorm = 1.0415, lr_0 = 1.2362e-04
Validation rmse = 1.059535
Epoch 26
Loss = 1.0163e-03, PNorm = 95.2874, GNorm = 0.6647, lr_0 = 1.1839e-04
Validation rmse = 1.027444
Epoch 27
Loss = 1.2112e-03, PNorm = 95.2928, GNorm = 0.5496, lr_0 = 1.1288e-04
Loss = 1.0060e-03, PNorm = 95.2973, GNorm = 0.6551, lr_0 = 1.0810e-04
Validation rmse = 1.044133
Epoch 28
Loss = 7.0774e-04, PNorm = 95.3010, GNorm = 0.4690, lr_0 = 1.0352e-04
Loss = 1.1184e-03, PNorm = 95.3050, GNorm = 1.2224, lr_0 = 1.0000e-04
Validation rmse = 1.051840
Epoch 29
Loss = 8.9105e-04, PNorm = 95.3084, GNorm = 0.5746, lr_0 = 1.0000e-04
Loss = 1.0024e-03, PNorm = 95.3129, GNorm = 0.7104, lr_0 = 1.0000e-04
Validation rmse = 1.057983
Model 0 best validation rmse = 0.976245 on epoch 22
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.109421
Ensemble test rmse = 1.109421
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2100,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_2100/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total scaffolds = 195 | train scaffolds = 64 | val scaffolds = 68 | test scaffolds = 63
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2100, bias=False)
      (W_h): Linear(in_features=2100, out_features=2100, bias=False)
      (W_o): Linear(in_features=2233, out_features=2100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=2104, out_features=2100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=2100, out_features=2100, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=2100, out_features=1, bias=True)
  )
)
Number of parameters = 18,244,801
Moving model to cuda
Epoch 0
Loss = 1.7333e-02, PNorm = 93.5591, GNorm = 3.3891, lr_0 = 3.6053e-04
Validation rmse = 1.449086
Epoch 1
Loss = 5.0816e-03, PNorm = 93.6942, GNorm = 1.7705, lr_0 = 6.2105e-04
Loss = 6.3323e-03, PNorm = 93.8553, GNorm = 3.4128, lr_0 = 8.5789e-04
Validation rmse = 1.301608
Epoch 2
Loss = 4.8527e-03, PNorm = 94.0242, GNorm = 1.2698, lr_0 = 9.8284e-04
Loss = 4.7450e-03, PNorm = 94.1582, GNorm = 1.5697, lr_0 = 9.4120e-04
Validation rmse = 1.223495
Epoch 3
Loss = 3.5730e-03, PNorm = 94.2580, GNorm = 2.1405, lr_0 = 8.9744e-04
Loss = 3.1352e-03, PNorm = 94.3262, GNorm = 1.5551, lr_0 = 8.5943e-04
Validation rmse = 1.163148
Epoch 4
Loss = 3.9734e-03, PNorm = 94.3880, GNorm = 1.9311, lr_0 = 8.2303e-04
Loss = 3.2115e-03, PNorm = 94.4471, GNorm = 1.2260, lr_0 = 7.8816e-04
Validation rmse = 1.104237
Epoch 5
Loss = 2.7278e-03, PNorm = 94.4971, GNorm = 1.7789, lr_0 = 7.5478e-04
Loss = 2.4299e-03, PNorm = 94.5399, GNorm = 0.6064, lr_0 = 7.2281e-04
Validation rmse = 1.240886
Epoch 6
Loss = 2.7268e-03, PNorm = 94.5909, GNorm = 1.1123, lr_0 = 6.8920e-04
Loss = 2.7562e-03, PNorm = 94.6329, GNorm = 1.5225, lr_0 = 6.6001e-04
Validation rmse = 1.094642
Epoch 7
Loss = 2.8134e-03, PNorm = 94.6703, GNorm = 1.5750, lr_0 = 6.3205e-04
Loss = 2.2612e-03, PNorm = 94.7077, GNorm = 1.2587, lr_0 = 6.0528e-04
Validation rmse = 1.200344
Epoch 8
Loss = 2.3534e-03, PNorm = 94.7436, GNorm = 1.1170, lr_0 = 5.7714e-04
Loss = 2.2959e-03, PNorm = 94.7727, GNorm = 1.2161, lr_0 = 5.5269e-04
Validation rmse = 1.205068
Epoch 9
Loss = 1.9941e-03, PNorm = 94.8043, GNorm = 1.1208, lr_0 = 5.2928e-04
Loss = 1.8245e-03, PNorm = 94.8296, GNorm = 1.3877, lr_0 = 5.0686e-04
Validation rmse = 1.176886
Epoch 10
Loss = 2.2327e-03, PNorm = 94.8585, GNorm = 1.3614, lr_0 = 4.8539e-04
Loss = 1.9659e-03, PNorm = 94.8846, GNorm = 0.9796, lr_0 = 4.6483e-04
Validation rmse = 1.052026
Epoch 11
Loss = 2.0985e-03, PNorm = 94.9107, GNorm = 0.4131, lr_0 = 4.4322e-04
Loss = 1.6008e-03, PNorm = 94.9322, GNorm = 0.9504, lr_0 = 4.2444e-04
Validation rmse = 1.075104
Epoch 12
Loss = 1.4374e-03, PNorm = 94.9528, GNorm = 0.6131, lr_0 = 4.0646e-04
Loss = 1.9529e-03, PNorm = 94.9698, GNorm = 0.6804, lr_0 = 3.8925e-04
Validation rmse = 1.135753
Epoch 13
Loss = 1.6117e-03, PNorm = 94.9903, GNorm = 0.6493, lr_0 = 3.7276e-04
Loss = 1.7073e-03, PNorm = 95.0093, GNorm = 0.5538, lr_0 = 3.5697e-04
Validation rmse = 1.329557
Epoch 14
Loss = 1.6665e-03, PNorm = 95.0286, GNorm = 2.5952, lr_0 = 3.4037e-04
Loss = 1.7167e-03, PNorm = 95.0462, GNorm = 0.6832, lr_0 = 3.2596e-04
Validation rmse = 1.072266
Epoch 15
Loss = 1.4059e-03, PNorm = 95.0616, GNorm = 1.0762, lr_0 = 3.1215e-04
Loss = 1.4683e-03, PNorm = 95.0756, GNorm = 0.8299, lr_0 = 2.9893e-04
Validation rmse = 1.316214
Epoch 16
Loss = 1.7204e-03, PNorm = 95.0912, GNorm = 1.3731, lr_0 = 2.8503e-04
Loss = 1.4287e-03, PNorm = 95.1039, GNorm = 0.6791, lr_0 = 2.7295e-04
Validation rmse = 1.182220
Epoch 17
Loss = 1.4294e-03, PNorm = 95.1182, GNorm = 0.4679, lr_0 = 2.6139e-04
Loss = 1.4330e-03, PNorm = 95.1283, GNorm = 0.7462, lr_0 = 2.5032e-04
Validation rmse = 1.438548
Epoch 18
Loss = 2.1193e-03, PNorm = 95.1404, GNorm = 1.9649, lr_0 = 2.3972e-04
Loss = 1.4950e-03, PNorm = 95.1522, GNorm = 1.3006, lr_0 = 2.2956e-04
Validation rmse = 1.116960
Epoch 19
Loss = 1.2257e-03, PNorm = 95.1689, GNorm = 0.4855, lr_0 = 2.1889e-04
Loss = 1.2113e-03, PNorm = 95.1778, GNorm = 0.8124, lr_0 = 2.0962e-04
Validation rmse = 1.090317
Epoch 20
Loss = 1.1618e-03, PNorm = 95.1867, GNorm = 1.3228, lr_0 = 2.0074e-04
Loss = 1.1367e-03, PNorm = 95.1921, GNorm = 0.2650, lr_0 = 1.9224e-04
Validation rmse = 1.165872
Epoch 21
Loss = 1.0539e-03, PNorm = 95.2010, GNorm = 1.1102, lr_0 = 1.8409e-04
Loss = 1.3290e-03, PNorm = 95.2072, GNorm = 0.6501, lr_0 = 1.7630e-04
Validation rmse = 1.203857
Epoch 22
Loss = 1.2534e-03, PNorm = 95.2147, GNorm = 0.5283, lr_0 = 1.6810e-04
Loss = 1.1234e-03, PNorm = 95.2206, GNorm = 1.1079, lr_0 = 1.6098e-04
Validation rmse = 1.098282
Epoch 23
Loss = 1.1555e-03, PNorm = 95.2271, GNorm = 0.8610, lr_0 = 1.5416e-04
Loss = 1.3271e-03, PNorm = 95.2335, GNorm = 1.2700, lr_0 = 1.4763e-04
Loss = 2.8241e-03, PNorm = 95.2338, GNorm = 1.3608, lr_0 = 1.4699e-04
Validation rmse = 1.119128
Epoch 24
Loss = 1.1891e-03, PNorm = 95.2407, GNorm = 0.9561, lr_0 = 1.4077e-04
Loss = 1.2037e-03, PNorm = 95.2466, GNorm = 1.0088, lr_0 = 1.3480e-04
Validation rmse = 1.176683
Epoch 25
Loss = 1.0723e-03, PNorm = 95.2510, GNorm = 1.2468, lr_0 = 1.2909e-04
Loss = 1.1651e-03, PNorm = 95.2561, GNorm = 1.6647, lr_0 = 1.2362e-04
Validation rmse = 1.085086
Epoch 26
Loss = 1.0437e-03, PNorm = 95.2602, GNorm = 0.4449, lr_0 = 1.1839e-04
Validation rmse = 1.092841
Epoch 27
Loss = 1.1865e-03, PNorm = 95.2654, GNorm = 0.7770, lr_0 = 1.1288e-04
Loss = 8.5268e-04, PNorm = 95.2691, GNorm = 0.5539, lr_0 = 1.0810e-04
Validation rmse = 1.078433
Epoch 28
Loss = 6.8408e-04, PNorm = 95.2729, GNorm = 0.6528, lr_0 = 1.0352e-04
Loss = 1.0092e-03, PNorm = 95.2765, GNorm = 0.7217, lr_0 = 1.0000e-04
Validation rmse = 1.157216
Epoch 29
Loss = 1.0155e-03, PNorm = 95.2807, GNorm = 1.8518, lr_0 = 1.0000e-04
Loss = 1.0177e-03, PNorm = 95.2833, GNorm = 0.7051, lr_0 = 1.0000e-04
Validation rmse = 1.109281
Model 0 best validation rmse = 1.052026 on epoch 10
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.963059
Ensemble test rmse = 0.963059
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2100,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_2100/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total scaffolds = 195 | train scaffolds = 69 | val scaffolds = 65 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2100, bias=False)
      (W_h): Linear(in_features=2100, out_features=2100, bias=False)
      (W_o): Linear(in_features=2233, out_features=2100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=2104, out_features=2100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=2100, out_features=2100, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=2100, out_features=1, bias=True)
  )
)
Number of parameters = 18,244,801
Moving model to cuda
Epoch 0
Loss = 1.7185e-02, PNorm = 93.5624, GNorm = 5.0566, lr_0 = 3.6053e-04
Validation rmse = 1.879593
Epoch 1
Loss = 9.3219e-03, PNorm = 93.6978, GNorm = 1.9244, lr_0 = 6.2105e-04
Loss = 6.7400e-03, PNorm = 93.8643, GNorm = 1.7591, lr_0 = 8.5789e-04
Validation rmse = 1.335092
Epoch 2
Loss = 5.3051e-03, PNorm = 94.0293, GNorm = 1.3489, lr_0 = 9.8284e-04
Loss = 5.8828e-03, PNorm = 94.1610, GNorm = 1.6351, lr_0 = 9.4120e-04
Validation rmse = 1.988939
Epoch 3
Loss = 3.3481e-03, PNorm = 94.2675, GNorm = 0.8435, lr_0 = 8.9744e-04
Loss = 4.9630e-03, PNorm = 94.3521, GNorm = 2.0684, lr_0 = 8.5943e-04
Validation rmse = 1.627992
Epoch 4
Loss = 3.6055e-03, PNorm = 94.4237, GNorm = 1.5815, lr_0 = 8.2303e-04
Loss = 3.4760e-03, PNorm = 94.4895, GNorm = 0.8584, lr_0 = 7.8816e-04
Validation rmse = 1.319615
Epoch 5
Loss = 2.6033e-03, PNorm = 94.5452, GNorm = 0.7835, lr_0 = 7.5478e-04
Loss = 3.3826e-03, PNorm = 94.5959, GNorm = 0.5587, lr_0 = 7.2281e-04
Validation rmse = 1.322978
Epoch 6
Loss = 3.1261e-03, PNorm = 94.6532, GNorm = 1.3289, lr_0 = 6.8920e-04
Loss = 2.8122e-03, PNorm = 94.6973, GNorm = 1.9379, lr_0 = 6.6001e-04
Validation rmse = 1.556087
Epoch 7
Loss = 3.1885e-03, PNorm = 94.7356, GNorm = 4.4589, lr_0 = 6.3205e-04
Loss = 3.2121e-03, PNorm = 94.7772, GNorm = 2.4628, lr_0 = 6.0528e-04
Validation rmse = 1.345232
Epoch 8
Loss = 2.4969e-03, PNorm = 94.8163, GNorm = 1.2057, lr_0 = 5.7714e-04
Loss = 2.7496e-03, PNorm = 94.8488, GNorm = 1.4797, lr_0 = 5.5269e-04
Validation rmse = 1.421440
Epoch 9
Loss = 2.5634e-03, PNorm = 94.8772, GNorm = 0.5657, lr_0 = 5.2928e-04
Loss = 2.2801e-03, PNorm = 94.9047, GNorm = 1.1686, lr_0 = 5.0686e-04
Validation rmse = 1.454069
Epoch 10
Loss = 2.2133e-03, PNorm = 94.9323, GNorm = 0.8905, lr_0 = 4.8539e-04
Loss = 1.7932e-03, PNorm = 94.9596, GNorm = 0.8797, lr_0 = 4.6483e-04
Validation rmse = 1.293537
Epoch 11
Loss = 1.9277e-03, PNorm = 94.9881, GNorm = 0.8513, lr_0 = 4.4322e-04
Loss = 1.7922e-03, PNorm = 95.0104, GNorm = 0.7395, lr_0 = 4.2444e-04
Validation rmse = 1.331882
Epoch 12
Loss = 1.6135e-03, PNorm = 95.0308, GNorm = 0.5545, lr_0 = 4.0646e-04
Loss = 1.5683e-03, PNorm = 95.0529, GNorm = 0.6028, lr_0 = 3.8925e-04
Validation rmse = 1.244559
Epoch 13
Loss = 1.8197e-03, PNorm = 95.0720, GNorm = 1.2716, lr_0 = 3.7276e-04
Loss = 2.0863e-03, PNorm = 95.0926, GNorm = 1.0414, lr_0 = 3.5697e-04
Validation rmse = 1.474851
Epoch 14
Loss = 1.7363e-03, PNorm = 95.1148, GNorm = 1.0433, lr_0 = 3.4037e-04
Loss = 1.5129e-03, PNorm = 95.1339, GNorm = 0.6183, lr_0 = 3.2596e-04
Validation rmse = 1.296510
Epoch 15
Loss = 1.6429e-03, PNorm = 95.1499, GNorm = 1.2858, lr_0 = 3.1215e-04
Loss = 1.4222e-03, PNorm = 95.1641, GNorm = 0.4573, lr_0 = 2.9893e-04
Validation rmse = 1.472533
Epoch 16
Loss = 1.5631e-03, PNorm = 95.1802, GNorm = 0.7175, lr_0 = 2.8503e-04
Loss = 1.6624e-03, PNorm = 95.1925, GNorm = 0.6378, lr_0 = 2.7295e-04
Validation rmse = 1.418112
Epoch 17
Loss = 1.3970e-03, PNorm = 95.2060, GNorm = 1.0499, lr_0 = 2.6139e-04
Loss = 1.5981e-03, PNorm = 95.2168, GNorm = 1.2204, lr_0 = 2.5032e-04
Validation rmse = 1.286783
Epoch 18
Loss = 1.2161e-03, PNorm = 95.2269, GNorm = 0.8298, lr_0 = 2.3972e-04
Loss = 1.5616e-03, PNorm = 95.2400, GNorm = 0.8002, lr_0 = 2.2956e-04
Validation rmse = 1.375023
Epoch 19
Loss = 1.3902e-03, PNorm = 95.2504, GNorm = 0.5871, lr_0 = 2.1889e-04
Loss = 1.2352e-03, PNorm = 95.2612, GNorm = 0.4257, lr_0 = 2.0962e-04
Validation rmse = 1.348723
Epoch 20
Loss = 1.3473e-03, PNorm = 95.2704, GNorm = 0.7465, lr_0 = 2.0074e-04
Loss = 1.1098e-03, PNorm = 95.2793, GNorm = 0.5616, lr_0 = 1.9224e-04
Validation rmse = 1.288035
Epoch 21
Loss = 1.0528e-03, PNorm = 95.2882, GNorm = 0.9256, lr_0 = 1.8409e-04
Loss = 1.2802e-03, PNorm = 95.2967, GNorm = 0.7662, lr_0 = 1.7630e-04
Validation rmse = 1.455646
Epoch 22
Loss = 1.2318e-03, PNorm = 95.3036, GNorm = 1.1894, lr_0 = 1.6810e-04
Loss = 1.3579e-03, PNorm = 95.3111, GNorm = 1.3225, lr_0 = 1.6098e-04
Validation rmse = 1.477397
Epoch 23
Loss = 1.2462e-03, PNorm = 95.3189, GNorm = 1.0473, lr_0 = 1.5416e-04
Loss = 1.2262e-03, PNorm = 95.3248, GNorm = 0.5602, lr_0 = 1.4763e-04
Loss = 1.2553e-03, PNorm = 95.3254, GNorm = 0.9750, lr_0 = 1.4699e-04
Validation rmse = 1.333194
Epoch 24
Loss = 1.1126e-03, PNorm = 95.3321, GNorm = 0.6242, lr_0 = 1.4077e-04
Loss = 1.2450e-03, PNorm = 95.3369, GNorm = 0.8294, lr_0 = 1.3480e-04
Validation rmse = 1.338951
Epoch 25
Loss = 1.0769e-03, PNorm = 95.3414, GNorm = 0.3449, lr_0 = 1.2909e-04
Loss = 1.2293e-03, PNorm = 95.3476, GNorm = 1.1157, lr_0 = 1.2362e-04
Validation rmse = 1.342696
Epoch 26
Loss = 1.1905e-03, PNorm = 95.3513, GNorm = 0.7976, lr_0 = 1.1839e-04
Validation rmse = 1.338825
Epoch 27
Loss = 7.4238e-04, PNorm = 95.3568, GNorm = 0.7442, lr_0 = 1.1288e-04
Loss = 1.0029e-03, PNorm = 95.3616, GNorm = 0.5113, lr_0 = 1.0810e-04
Validation rmse = 1.511119
Epoch 28
Loss = 7.1848e-04, PNorm = 95.3666, GNorm = 0.9505, lr_0 = 1.0352e-04
Loss = 1.0110e-03, PNorm = 95.3712, GNorm = 0.5333, lr_0 = 1.0000e-04
Validation rmse = 1.329571
Epoch 29
Loss = 1.1981e-03, PNorm = 95.3749, GNorm = 0.7385, lr_0 = 1.0000e-04
Loss = 9.0040e-04, PNorm = 95.3769, GNorm = 1.3701, lr_0 = 1.0000e-04
Validation rmse = 1.457289
Model 0 best validation rmse = 1.244559 on epoch 12
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.892196
Ensemble test rmse = 0.892196
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2100,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_2100/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total scaffolds = 195 | train scaffolds = 75 | val scaffolds = 42 | test scaffolds = 78
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2100, bias=False)
      (W_h): Linear(in_features=2100, out_features=2100, bias=False)
      (W_o): Linear(in_features=2233, out_features=2100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=2104, out_features=2100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=2100, out_features=2100, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=2100, out_features=1, bias=True)
  )
)
Number of parameters = 18,244,801
Moving model to cuda
Epoch 0
Loss = 1.6555e-02, PNorm = 93.5593, GNorm = 3.6898, lr_0 = 3.6053e-04
Validation rmse = 1.252422
Epoch 1
Loss = 5.2184e-03, PNorm = 93.6903, GNorm = 1.5909, lr_0 = 6.2105e-04
Loss = 8.0895e-03, PNorm = 93.8454, GNorm = 8.8185, lr_0 = 8.5789e-04
Validation rmse = 1.876554
Epoch 2
Loss = 9.1178e-03, PNorm = 94.0167, GNorm = 1.9920, lr_0 = 9.8284e-04
Loss = 4.9746e-03, PNorm = 94.1658, GNorm = 0.9878, lr_0 = 9.4120e-04
Validation rmse = 1.286593
Epoch 3
Loss = 3.9031e-03, PNorm = 94.2852, GNorm = 2.5665, lr_0 = 8.9744e-04
Loss = 3.7591e-03, PNorm = 94.3640, GNorm = 0.8788, lr_0 = 8.5943e-04
Validation rmse = 1.414157
Epoch 4
Loss = 4.2565e-03, PNorm = 94.4313, GNorm = 1.7673, lr_0 = 8.2303e-04
Loss = 3.0020e-03, PNorm = 94.4827, GNorm = 1.7884, lr_0 = 7.8816e-04
Validation rmse = 1.096645
Epoch 5
Loss = 3.6006e-03, PNorm = 94.5256, GNorm = 6.0952, lr_0 = 7.5478e-04
Loss = 3.3229e-03, PNorm = 94.5705, GNorm = 1.8248, lr_0 = 7.2281e-04
Validation rmse = 1.163332
Epoch 6
Loss = 2.2043e-03, PNorm = 94.6116, GNorm = 0.8766, lr_0 = 6.8920e-04
Loss = 2.6032e-03, PNorm = 94.6472, GNorm = 2.1487, lr_0 = 6.6001e-04
Validation rmse = 1.366106
Epoch 7
Loss = 3.2055e-03, PNorm = 94.6822, GNorm = 3.6138, lr_0 = 6.3205e-04
Loss = 3.0047e-03, PNorm = 94.7186, GNorm = 0.6686, lr_0 = 6.0528e-04
Validation rmse = 1.064190
Epoch 8
Loss = 2.5616e-03, PNorm = 94.7563, GNorm = 0.7761, lr_0 = 5.7714e-04
Loss = 2.1083e-03, PNorm = 94.7846, GNorm = 0.7908, lr_0 = 5.5269e-04
Validation rmse = 1.116899
Epoch 9
Loss = 1.8508e-03, PNorm = 94.8104, GNorm = 0.5716, lr_0 = 5.2928e-04
Loss = 2.0115e-03, PNorm = 94.8335, GNorm = 0.9769, lr_0 = 5.0686e-04
Validation rmse = 1.141357
Epoch 10
Loss = 1.8436e-03, PNorm = 94.8565, GNorm = 0.5132, lr_0 = 4.8539e-04
Loss = 1.7148e-03, PNorm = 94.8784, GNorm = 1.1790, lr_0 = 4.6483e-04
Validation rmse = 1.011031
Epoch 11
Loss = 2.0642e-03, PNorm = 94.8989, GNorm = 1.0410, lr_0 = 4.4322e-04
Loss = 1.7143e-03, PNorm = 94.9192, GNorm = 1.6926, lr_0 = 4.2444e-04
Validation rmse = 1.099335
Epoch 12
Loss = 1.7810e-03, PNorm = 94.9397, GNorm = 1.1966, lr_0 = 4.0646e-04
Loss = 1.4313e-03, PNorm = 94.9601, GNorm = 1.4983, lr_0 = 3.8925e-04
Validation rmse = 0.988386
Epoch 13
Loss = 1.6866e-03, PNorm = 94.9767, GNorm = 0.7794, lr_0 = 3.7276e-04
Loss = 1.6058e-03, PNorm = 94.9925, GNorm = 0.8296, lr_0 = 3.5697e-04
Validation rmse = 1.019723
Epoch 14
Loss = 1.7476e-03, PNorm = 95.0106, GNorm = 1.3057, lr_0 = 3.4037e-04
Loss = 1.5900e-03, PNorm = 95.0247, GNorm = 1.1585, lr_0 = 3.2596e-04
Validation rmse = 1.018466
Epoch 15
Loss = 1.4236e-03, PNorm = 95.0399, GNorm = 0.5311, lr_0 = 3.1215e-04
Loss = 1.4608e-03, PNorm = 95.0549, GNorm = 0.8021, lr_0 = 2.9893e-04
Validation rmse = 1.065989
Epoch 16
Loss = 1.4372e-03, PNorm = 95.0682, GNorm = 0.6228, lr_0 = 2.8503e-04
Loss = 1.4538e-03, PNorm = 95.0826, GNorm = 0.3735, lr_0 = 2.7295e-04
Validation rmse = 1.014208
Epoch 17
Loss = 1.4018e-03, PNorm = 95.0920, GNorm = 0.8956, lr_0 = 2.6139e-04
Loss = 1.4232e-03, PNorm = 95.1053, GNorm = 0.5471, lr_0 = 2.5032e-04
Validation rmse = 1.093727
Epoch 18
Loss = 1.2536e-03, PNorm = 95.1159, GNorm = 0.5144, lr_0 = 2.3972e-04
Loss = 1.2619e-03, PNorm = 95.1235, GNorm = 0.4295, lr_0 = 2.2956e-04
Validation rmse = 1.046319
Epoch 19
Loss = 1.2555e-03, PNorm = 95.1360, GNorm = 0.6600, lr_0 = 2.1889e-04
Loss = 1.1821e-03, PNorm = 95.1423, GNorm = 0.5534, lr_0 = 2.0962e-04
Validation rmse = 1.071063
Epoch 20
Loss = 1.1503e-03, PNorm = 95.1520, GNorm = 0.8942, lr_0 = 2.0074e-04
Loss = 1.2435e-03, PNorm = 95.1596, GNorm = 0.5680, lr_0 = 1.9224e-04
Validation rmse = 1.018019
Epoch 21
Loss = 1.2716e-03, PNorm = 95.1685, GNorm = 0.7008, lr_0 = 1.8409e-04
Loss = 1.3377e-03, PNorm = 95.1775, GNorm = 0.5395, lr_0 = 1.7630e-04
Validation rmse = 1.115595
Epoch 22
Loss = 1.3836e-03, PNorm = 95.1854, GNorm = 0.7864, lr_0 = 1.6810e-04
Loss = 1.3299e-03, PNorm = 95.1935, GNorm = 1.6879, lr_0 = 1.6098e-04
Validation rmse = 1.030074
Epoch 23
Loss = 1.1623e-03, PNorm = 95.2001, GNorm = 1.2709, lr_0 = 1.5416e-04
Loss = 1.1653e-03, PNorm = 95.2063, GNorm = 0.5760, lr_0 = 1.4763e-04
Loss = 1.4876e-03, PNorm = 95.2069, GNorm = 1.3058, lr_0 = 1.4699e-04
Validation rmse = 1.047593
Epoch 24
Loss = 1.2239e-03, PNorm = 95.2114, GNorm = 1.2777, lr_0 = 1.4077e-04
Loss = 1.1909e-03, PNorm = 95.2184, GNorm = 0.7032, lr_0 = 1.3480e-04
Validation rmse = 1.035135
Epoch 25
Loss = 1.2557e-03, PNorm = 95.2230, GNorm = 0.7871, lr_0 = 1.2909e-04
Loss = 1.0698e-03, PNorm = 95.2280, GNorm = 0.7933, lr_0 = 1.2362e-04
Validation rmse = 1.003993
Epoch 26
Loss = 1.1639e-03, PNorm = 95.2334, GNorm = 1.4228, lr_0 = 1.1839e-04
Validation rmse = 1.044326
Epoch 27
Loss = 1.7449e-03, PNorm = 95.2371, GNorm = 1.0916, lr_0 = 1.1288e-04
Loss = 1.0519e-03, PNorm = 95.2414, GNorm = 1.5246, lr_0 = 1.0810e-04
Validation rmse = 1.049447
Epoch 28
Loss = 9.5475e-04, PNorm = 95.2452, GNorm = 0.7273, lr_0 = 1.0352e-04
Loss = 1.0703e-03, PNorm = 95.2478, GNorm = 0.4743, lr_0 = 1.0000e-04
Validation rmse = 1.112329
Epoch 29
Loss = 1.0046e-03, PNorm = 95.2528, GNorm = 1.0253, lr_0 = 1.0000e-04
Loss = 9.3622e-04, PNorm = 95.2557, GNorm = 0.7649, lr_0 = 1.0000e-04
Validation rmse = 1.059184
Model 0 best validation rmse = 0.988386 on epoch 12
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.140507
Ensemble test rmse = 1.140507
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2100,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_2100/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 58 | test scaffolds = 53
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2100, bias=False)
      (W_h): Linear(in_features=2100, out_features=2100, bias=False)
      (W_o): Linear(in_features=2233, out_features=2100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=2104, out_features=2100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=2100, out_features=2100, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=2100, out_features=1, bias=True)
  )
)
Number of parameters = 18,244,801
Moving model to cuda
Epoch 0
Loss = 1.5508e-02, PNorm = 93.5642, GNorm = 5.2538, lr_0 = 3.6053e-04
Validation rmse = 1.393502
Epoch 1
Loss = 8.2956e-03, PNorm = 93.6986, GNorm = 3.1636, lr_0 = 6.2105e-04
Loss = 8.1590e-03, PNorm = 93.8672, GNorm = 2.6059, lr_0 = 8.5789e-04
Validation rmse = 1.315027
Epoch 2
Loss = 7.0007e-03, PNorm = 94.0483, GNorm = 2.2965, lr_0 = 9.8284e-04
Loss = 4.5529e-03, PNorm = 94.1884, GNorm = 2.2034, lr_0 = 9.4120e-04
Validation rmse = 1.426106
Epoch 3
Loss = 7.0954e-03, PNorm = 94.2949, GNorm = 2.1623, lr_0 = 8.9744e-04
Loss = 4.5863e-03, PNorm = 94.3742, GNorm = 1.2437, lr_0 = 8.5943e-04
Validation rmse = 1.153788
Epoch 4
Loss = 2.7279e-03, PNorm = 94.4349, GNorm = 1.0384, lr_0 = 8.2303e-04
Loss = 3.5811e-03, PNorm = 94.4848, GNorm = 1.3457, lr_0 = 7.8816e-04
Validation rmse = 1.174762
Epoch 5
Loss = 2.5926e-03, PNorm = 94.5308, GNorm = 1.3621, lr_0 = 7.5478e-04
Loss = 3.1225e-03, PNorm = 94.5770, GNorm = 0.8080, lr_0 = 7.2281e-04
Validation rmse = 1.038539
Epoch 6
Loss = 2.9228e-03, PNorm = 94.6260, GNorm = 0.9993, lr_0 = 6.8920e-04
Loss = 3.1081e-03, PNorm = 94.6614, GNorm = 1.6428, lr_0 = 6.6001e-04
Validation rmse = 1.096037
Epoch 7
Loss = 4.1805e-03, PNorm = 94.6973, GNorm = 1.3686, lr_0 = 6.3205e-04
Loss = 4.1000e-03, PNorm = 94.7443, GNorm = 2.4689, lr_0 = 6.0528e-04
Validation rmse = 1.147465
Epoch 8
Loss = 2.7152e-03, PNorm = 94.7865, GNorm = 0.8495, lr_0 = 5.7714e-04
Loss = 3.0369e-03, PNorm = 94.8147, GNorm = 1.5994, lr_0 = 5.5269e-04
Validation rmse = 1.040487
Epoch 9
Loss = 2.4533e-03, PNorm = 94.8418, GNorm = 2.4119, lr_0 = 5.2928e-04
Loss = 2.1493e-03, PNorm = 94.8697, GNorm = 0.7827, lr_0 = 5.0686e-04
Validation rmse = 1.018854
Epoch 10
Loss = 2.2815e-03, PNorm = 94.8891, GNorm = 2.0825, lr_0 = 4.8539e-04
Loss = 2.1466e-03, PNorm = 94.9097, GNorm = 1.1525, lr_0 = 4.6483e-04
Validation rmse = 1.026810
Epoch 11
Loss = 2.0025e-03, PNorm = 94.9334, GNorm = 0.7119, lr_0 = 4.4322e-04
Loss = 1.9249e-03, PNorm = 94.9538, GNorm = 0.8870, lr_0 = 4.2444e-04
Validation rmse = 1.055506
Epoch 12
Loss = 1.7682e-03, PNorm = 94.9715, GNorm = 1.2987, lr_0 = 4.0646e-04
Loss = 2.1488e-03, PNorm = 94.9891, GNorm = 1.6388, lr_0 = 3.8925e-04
Validation rmse = 0.959408
Epoch 13
Loss = 1.7600e-03, PNorm = 95.0059, GNorm = 1.2394, lr_0 = 3.7276e-04
Loss = 1.7613e-03, PNorm = 95.0230, GNorm = 1.2410, lr_0 = 3.5697e-04
Validation rmse = 1.130357
Epoch 14
Loss = 2.2974e-03, PNorm = 95.0429, GNorm = 1.1480, lr_0 = 3.4037e-04
Loss = 2.0383e-03, PNorm = 95.0608, GNorm = 2.4153, lr_0 = 3.2596e-04
Validation rmse = 1.105273
Epoch 15
Loss = 1.8638e-03, PNorm = 95.0777, GNorm = 0.6211, lr_0 = 3.1215e-04
Loss = 1.9334e-03, PNorm = 95.0939, GNorm = 0.9446, lr_0 = 2.9893e-04
Validation rmse = 0.964813
Epoch 16
Loss = 1.7549e-03, PNorm = 95.1092, GNorm = 1.5292, lr_0 = 2.8503e-04
Loss = 1.6091e-03, PNorm = 95.1184, GNorm = 1.0291, lr_0 = 2.7295e-04
Validation rmse = 1.040576
Epoch 17
Loss = 1.8647e-03, PNorm = 95.1322, GNorm = 1.5775, lr_0 = 2.6139e-04
Loss = 2.3080e-03, PNorm = 95.1429, GNorm = 1.6641, lr_0 = 2.5032e-04
Validation rmse = 1.025123
Epoch 18
Loss = 1.6141e-03, PNorm = 95.1584, GNorm = 1.9074, lr_0 = 2.3972e-04
Loss = 1.8671e-03, PNorm = 95.1690, GNorm = 1.2349, lr_0 = 2.2956e-04
Validation rmse = 0.872389
Epoch 19
Loss = 1.5138e-03, PNorm = 95.1787, GNorm = 0.8051, lr_0 = 2.1889e-04
Loss = 1.7960e-03, PNorm = 95.1884, GNorm = 0.4999, lr_0 = 2.0962e-04
Validation rmse = 0.919515
Epoch 20
Loss = 1.7716e-03, PNorm = 95.1964, GNorm = 1.2468, lr_0 = 2.0074e-04
Loss = 1.4681e-03, PNorm = 95.2047, GNorm = 0.6086, lr_0 = 1.9224e-04
Validation rmse = 0.852290
Epoch 21
Loss = 1.3516e-03, PNorm = 95.2114, GNorm = 1.1515, lr_0 = 1.8409e-04
Loss = 1.3345e-03, PNorm = 95.2185, GNorm = 0.6097, lr_0 = 1.7630e-04
Validation rmse = 0.895701
Epoch 22
Loss = 1.5103e-03, PNorm = 95.2264, GNorm = 1.1391, lr_0 = 1.6810e-04
Loss = 1.0757e-03, PNorm = 95.2327, GNorm = 0.6859, lr_0 = 1.6098e-04
Validation rmse = 0.902438
Epoch 23
Loss = 1.1605e-03, PNorm = 95.2375, GNorm = 0.7752, lr_0 = 1.5416e-04
Loss = 1.4044e-03, PNorm = 95.2428, GNorm = 0.5655, lr_0 = 1.4763e-04
Loss = 1.9631e-03, PNorm = 95.2434, GNorm = 1.0054, lr_0 = 1.4699e-04
Validation rmse = 0.943458
Epoch 24
Loss = 1.2486e-03, PNorm = 95.2487, GNorm = 0.7277, lr_0 = 1.4077e-04
Loss = 1.2551e-03, PNorm = 95.2543, GNorm = 0.7280, lr_0 = 1.3480e-04
Validation rmse = 0.882873
Epoch 25
Loss = 1.2399e-03, PNorm = 95.2593, GNorm = 0.6357, lr_0 = 1.2909e-04
Loss = 1.4006e-03, PNorm = 95.2639, GNorm = 1.6999, lr_0 = 1.2362e-04
Validation rmse = 0.945769
Epoch 26
Loss = 1.1389e-03, PNorm = 95.2689, GNorm = 0.6856, lr_0 = 1.1839e-04
Validation rmse = 0.898891
Epoch 27
Loss = 1.1737e-03, PNorm = 95.2739, GNorm = 0.9494, lr_0 = 1.1288e-04
Loss = 1.3930e-03, PNorm = 95.2777, GNorm = 1.3931, lr_0 = 1.0810e-04
Validation rmse = 0.923592
Epoch 28
Loss = 8.3224e-04, PNorm = 95.2817, GNorm = 0.6836, lr_0 = 1.0352e-04
Loss = 1.2027e-03, PNorm = 95.2862, GNorm = 0.7606, lr_0 = 1.0000e-04
Validation rmse = 0.897868
Epoch 29
Loss = 1.2504e-03, PNorm = 95.2911, GNorm = 0.9000, lr_0 = 1.0000e-04
Loss = 1.0564e-03, PNorm = 95.2938, GNorm = 0.5696, lr_0 = 1.0000e-04
Validation rmse = 0.938246
Model 0 best validation rmse = 0.852290 on epoch 20
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.229432
Ensemble test rmse = 1.229432
10-fold cross validation
	Seed 0 ==> test rmse = 0.885723
	Seed 1 ==> test rmse = 1.003340
	Seed 2 ==> test rmse = 1.050452
	Seed 3 ==> test rmse = 1.003468
	Seed 4 ==> test rmse = 1.030331
	Seed 5 ==> test rmse = 1.109421
	Seed 6 ==> test rmse = 0.963059
	Seed 7 ==> test rmse = 0.892196
	Seed 8 ==> test rmse = 1.140507
	Seed 9 ==> test rmse = 1.229432
Overall test rmse = 1.030793 +/- 0.102179
Elapsed time = 0:07:53
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.15000000000000002_ffn_num_layers_3_hidden_size_2300/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total scaffolds = 195 | train scaffolds = 91 | val scaffolds = 66 | test scaffolds = 38
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2300, bias=False)
      (W_h): Linear(in_features=2300, out_features=2300, bias=False)
      (W_o): Linear(in_features=2433, out_features=2300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=2304, out_features=2300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.15000000000000002, inplace=False)
    (4): Linear(in_features=2300, out_features=2300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.15000000000000002, inplace=False)
    (7): Linear(in_features=2300, out_features=1, bias=True)
  )
)
Number of parameters = 21,822,401
Moving model to cuda
Epoch 0
Loss = 1.2211e-02, PNorm = 97.7631, GNorm = 2.1941, lr_0 = 3.6053e-04
Validation rmse = 1.067528
Epoch 1
Loss = 3.4217e-03, PNorm = 97.9005, GNorm = 1.1003, lr_0 = 6.2105e-04
Loss = 4.2437e-03, PNorm = 98.0641, GNorm = 1.3537, lr_0 = 8.5789e-04
Validation rmse = 1.036261
Epoch 2
Loss = 4.1944e-03, PNorm = 98.2445, GNorm = 1.6044, lr_0 = 9.8284e-04
Loss = 4.5511e-03, PNorm = 98.4066, GNorm = 1.1513, lr_0 = 9.4120e-04
Validation rmse = 0.889749
Epoch 3
Loss = 2.3410e-03, PNorm = 98.5501, GNorm = 1.2025, lr_0 = 8.9744e-04
Loss = 3.3195e-03, PNorm = 98.6453, GNorm = 0.4665, lr_0 = 8.5943e-04
Validation rmse = 1.044757
Epoch 4
Loss = 4.8583e-03, PNorm = 98.7280, GNorm = 1.1429, lr_0 = 8.2303e-04
Loss = 2.6014e-03, PNorm = 98.8006, GNorm = 1.8953, lr_0 = 7.8816e-04
Validation rmse = 1.010915
Epoch 5
Loss = 2.2028e-03, PNorm = 98.8626, GNorm = 0.7610, lr_0 = 7.5478e-04
Loss = 2.1939e-03, PNorm = 98.9190, GNorm = 1.5358, lr_0 = 7.2281e-04
Validation rmse = 0.968863
Epoch 6
Loss = 1.7593e-03, PNorm = 98.9767, GNorm = 0.4334, lr_0 = 6.8920e-04
Loss = 2.1269e-03, PNorm = 99.0225, GNorm = 0.7737, lr_0 = 6.6001e-04
Validation rmse = 1.389075
Epoch 7
Loss = 2.9192e-03, PNorm = 99.0723, GNorm = 1.8242, lr_0 = 6.3205e-04
Loss = 2.4609e-03, PNorm = 99.1251, GNorm = 0.8784, lr_0 = 6.0528e-04
Validation rmse = 0.888122
Epoch 8
Loss = 2.4688e-03, PNorm = 99.1785, GNorm = 0.9665, lr_0 = 5.7714e-04
Loss = 1.8554e-03, PNorm = 99.2244, GNorm = 0.5260, lr_0 = 5.5269e-04
Validation rmse = 0.837174
Epoch 9
Loss = 1.6350e-03, PNorm = 99.2632, GNorm = 1.2058, lr_0 = 5.2928e-04
Loss = 2.1226e-03, PNorm = 99.3077, GNorm = 0.6912, lr_0 = 5.0686e-04
Validation rmse = 0.912764
Epoch 10
Loss = 1.5598e-03, PNorm = 99.3398, GNorm = 1.5820, lr_0 = 4.8539e-04
Loss = 2.2305e-03, PNorm = 99.3769, GNorm = 0.6846, lr_0 = 4.6483e-04
Validation rmse = 1.043703
Epoch 11
Loss = 1.6971e-03, PNorm = 99.4217, GNorm = 0.6440, lr_0 = 4.4322e-04
Loss = 1.5105e-03, PNorm = 99.4594, GNorm = 0.4040, lr_0 = 4.2444e-04
Validation rmse = 0.909953
Epoch 12
Loss = 1.7087e-03, PNorm = 99.4878, GNorm = 0.4516, lr_0 = 4.0646e-04
Loss = 1.3090e-03, PNorm = 99.5127, GNorm = 0.3874, lr_0 = 3.8925e-04
Validation rmse = 0.993784
Epoch 13
Loss = 1.2904e-03, PNorm = 99.5394, GNorm = 0.5639, lr_0 = 3.7276e-04
Loss = 1.5609e-03, PNorm = 99.5651, GNorm = 0.7627, lr_0 = 3.5697e-04
Validation rmse = 0.940064
Epoch 14
Loss = 1.2901e-03, PNorm = 99.5862, GNorm = 0.6360, lr_0 = 3.4037e-04
Loss = 1.1625e-03, PNorm = 99.6015, GNorm = 0.5383, lr_0 = 3.2596e-04
Validation rmse = 0.904119
Epoch 15
Loss = 1.0921e-03, PNorm = 99.6202, GNorm = 0.6049, lr_0 = 3.1215e-04
Loss = 1.0398e-03, PNorm = 99.6406, GNorm = 0.5294, lr_0 = 2.9893e-04
Validation rmse = 0.972327
Epoch 16
Loss = 1.1365e-03, PNorm = 99.6639, GNorm = 0.3997, lr_0 = 2.8503e-04
Loss = 1.0867e-03, PNorm = 99.6812, GNorm = 0.4872, lr_0 = 2.7295e-04
Validation rmse = 0.937973
Epoch 17
Loss = 1.1150e-03, PNorm = 99.6979, GNorm = 1.1235, lr_0 = 2.6139e-04
Loss = 1.0436e-03, PNorm = 99.7129, GNorm = 0.5525, lr_0 = 2.5032e-04
Validation rmse = 0.941457
Epoch 18
Loss = 8.2660e-04, PNorm = 99.7278, GNorm = 0.2184, lr_0 = 2.3972e-04
Loss = 1.1228e-03, PNorm = 99.7466, GNorm = 0.6022, lr_0 = 2.2956e-04
Validation rmse = 0.949140
Epoch 19
Loss = 1.1512e-03, PNorm = 99.7656, GNorm = 0.4576, lr_0 = 2.1889e-04
Loss = 1.0651e-03, PNorm = 99.7820, GNorm = 0.6683, lr_0 = 2.0962e-04
Validation rmse = 1.027998
Epoch 20
Loss = 1.1666e-03, PNorm = 99.7922, GNorm = 0.3863, lr_0 = 2.0074e-04
Loss = 1.0441e-03, PNorm = 99.8071, GNorm = 0.6364, lr_0 = 1.9224e-04
Validation rmse = 1.010128
Epoch 21
Loss = 9.6627e-04, PNorm = 99.8208, GNorm = 0.5470, lr_0 = 1.8409e-04
Loss = 9.9297e-04, PNorm = 99.8356, GNorm = 0.6008, lr_0 = 1.7630e-04
Validation rmse = 0.941753
Epoch 22
Loss = 9.7301e-04, PNorm = 99.8505, GNorm = 0.4745, lr_0 = 1.6810e-04
Loss = 1.0660e-03, PNorm = 99.8619, GNorm = 0.5927, lr_0 = 1.6098e-04
Validation rmse = 0.938556
Epoch 23
Loss = 7.9704e-04, PNorm = 99.8730, GNorm = 0.3858, lr_0 = 1.5416e-04
Loss = 8.7833e-04, PNorm = 99.8842, GNorm = 0.6582, lr_0 = 1.4763e-04
Loss = 1.1489e-03, PNorm = 99.8853, GNorm = 0.3318, lr_0 = 1.4699e-04
Validation rmse = 0.970346
Epoch 24
Loss = 8.0655e-04, PNorm = 99.8940, GNorm = 0.3646, lr_0 = 1.4077e-04
Loss = 9.4066e-04, PNorm = 99.9054, GNorm = 1.1058, lr_0 = 1.3480e-04
Validation rmse = 0.959439
Epoch 25
Loss = 8.5842e-04, PNorm = 99.9142, GNorm = 0.4849, lr_0 = 1.2909e-04
Loss = 9.2440e-04, PNorm = 99.9226, GNorm = 0.4055, lr_0 = 1.2362e-04
Validation rmse = 0.985253
Epoch 26
Loss = 7.6857e-04, PNorm = 99.9292, GNorm = 0.6238, lr_0 = 1.1839e-04
Validation rmse = 0.974006
Epoch 27
Loss = 5.3574e-04, PNorm = 99.9406, GNorm = 0.4909, lr_0 = 1.1288e-04
Loss = 8.0947e-04, PNorm = 99.9475, GNorm = 0.6660, lr_0 = 1.0810e-04
Validation rmse = 1.002486
Epoch 28
Loss = 8.1044e-04, PNorm = 99.9551, GNorm = 0.5865, lr_0 = 1.0352e-04
Loss = 8.5823e-04, PNorm = 99.9621, GNorm = 0.3684, lr_0 = 1.0000e-04
Validation rmse = 0.948708
Epoch 29
Loss = 6.9301e-04, PNorm = 99.9701, GNorm = 0.5170, lr_0 = 1.0000e-04
Loss = 7.7949e-04, PNorm = 99.9769, GNorm = 0.2956, lr_0 = 1.0000e-04
Validation rmse = 0.997670
Model 0 best validation rmse = 0.837174 on epoch 8
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.877505
Ensemble test rmse = 0.877505
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.15000000000000002_ffn_num_layers_3_hidden_size_2300/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total scaffolds = 195 | train scaffolds = 76 | val scaffolds = 60 | test scaffolds = 59
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2300, bias=False)
      (W_h): Linear(in_features=2300, out_features=2300, bias=False)
      (W_o): Linear(in_features=2433, out_features=2300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=2304, out_features=2300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.15000000000000002, inplace=False)
    (4): Linear(in_features=2300, out_features=2300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.15000000000000002, inplace=False)
    (7): Linear(in_features=2300, out_features=1, bias=True)
  )
)
Number of parameters = 21,822,401
Moving model to cuda
Epoch 0
Loss = 1.3569e-02, PNorm = 97.7640, GNorm = 9.0446, lr_0 = 3.6053e-04
Validation rmse = 1.170022
Epoch 1
Loss = 5.7796e-03, PNorm = 97.8919, GNorm = 1.4692, lr_0 = 6.2105e-04
Loss = 5.2484e-03, PNorm = 98.0526, GNorm = 2.1419, lr_0 = 8.5789e-04
Validation rmse = 1.631874
Epoch 2
Loss = 1.0092e-02, PNorm = 98.2333, GNorm = 3.5894, lr_0 = 9.8284e-04
Loss = 3.3954e-03, PNorm = 98.3910, GNorm = 0.8411, lr_0 = 9.4120e-04
Validation rmse = 1.108431
Epoch 3
Loss = 3.2349e-03, PNorm = 98.5194, GNorm = 2.7731, lr_0 = 8.9744e-04
Loss = 2.9039e-03, PNorm = 98.6164, GNorm = 0.3907, lr_0 = 8.5943e-04
Validation rmse = 0.995127
Epoch 4
Loss = 1.8800e-03, PNorm = 98.6942, GNorm = 1.0242, lr_0 = 8.2303e-04
Loss = 2.3843e-03, PNorm = 98.7656, GNorm = 0.8300, lr_0 = 7.8816e-04
Validation rmse = 1.042065
Epoch 5
Loss = 1.7423e-03, PNorm = 98.8298, GNorm = 0.7082, lr_0 = 7.5478e-04
Loss = 3.0607e-03, PNorm = 98.8944, GNorm = 1.0675, lr_0 = 7.2281e-04
Validation rmse = 1.137712
Epoch 6
Loss = 2.5946e-03, PNorm = 98.9688, GNorm = 0.7888, lr_0 = 6.8920e-04
Loss = 2.4619e-03, PNorm = 99.0341, GNorm = 0.6782, lr_0 = 6.6001e-04
Validation rmse = 0.865226
Epoch 7
Loss = 1.8143e-03, PNorm = 99.0952, GNorm = 0.6842, lr_0 = 6.3205e-04
Loss = 2.1621e-03, PNorm = 99.1473, GNorm = 0.9568, lr_0 = 6.0528e-04
Validation rmse = 0.882761
Epoch 8
Loss = 1.5895e-03, PNorm = 99.1984, GNorm = 0.5549, lr_0 = 5.7714e-04
Loss = 1.4759e-03, PNorm = 99.2373, GNorm = 0.5145, lr_0 = 5.5269e-04
Validation rmse = 0.991882
Epoch 9
Loss = 1.4585e-03, PNorm = 99.2748, GNorm = 0.6633, lr_0 = 5.2928e-04
Loss = 1.8907e-03, PNorm = 99.3114, GNorm = 0.7040, lr_0 = 5.0686e-04
Validation rmse = 1.117259
Epoch 10
Loss = 1.8793e-03, PNorm = 99.3496, GNorm = 1.0111, lr_0 = 4.8539e-04
Loss = 1.4374e-03, PNorm = 99.3850, GNorm = 0.3851, lr_0 = 4.6483e-04
Validation rmse = 0.884977
Epoch 11
Loss = 1.8709e-03, PNorm = 99.4221, GNorm = 1.2624, lr_0 = 4.4322e-04
Loss = 1.7617e-03, PNorm = 99.4585, GNorm = 1.4637, lr_0 = 4.2444e-04
Validation rmse = 0.936323
Epoch 12
Loss = 1.1551e-03, PNorm = 99.4934, GNorm = 0.7372, lr_0 = 4.0646e-04
Loss = 1.5430e-03, PNorm = 99.5196, GNorm = 0.6323, lr_0 = 3.8925e-04
Validation rmse = 0.964046
Epoch 13
Loss = 1.4701e-03, PNorm = 99.5428, GNorm = 0.8458, lr_0 = 3.7276e-04
Loss = 1.2607e-03, PNorm = 99.5669, GNorm = 0.3953, lr_0 = 3.5697e-04
Validation rmse = 0.845116
Epoch 14
Loss = 9.4593e-04, PNorm = 99.5959, GNorm = 0.5461, lr_0 = 3.4037e-04
Loss = 1.4721e-03, PNorm = 99.6203, GNorm = 0.8860, lr_0 = 3.2596e-04
Validation rmse = 0.963796
Epoch 15
Loss = 1.5722e-03, PNorm = 99.6442, GNorm = 0.6084, lr_0 = 3.1215e-04
Loss = 1.1100e-03, PNorm = 99.6658, GNorm = 0.3699, lr_0 = 2.9893e-04
Validation rmse = 0.977077
Epoch 16
Loss = 1.2046e-03, PNorm = 99.6823, GNorm = 0.4578, lr_0 = 2.8503e-04
Loss = 1.4002e-03, PNorm = 99.6951, GNorm = 0.6029, lr_0 = 2.7295e-04
Validation rmse = 0.963219
Epoch 17
Loss = 1.1241e-03, PNorm = 99.7166, GNorm = 0.7427, lr_0 = 2.6139e-04
Loss = 1.1319e-03, PNorm = 99.7318, GNorm = 0.7038, lr_0 = 2.5032e-04
Validation rmse = 0.945664
Epoch 18
Loss = 1.0432e-03, PNorm = 99.7454, GNorm = 1.9464, lr_0 = 2.3972e-04
Loss = 1.1456e-03, PNorm = 99.7586, GNorm = 1.4182, lr_0 = 2.2956e-04
Validation rmse = 0.982818
Epoch 19
Loss = 9.1463e-04, PNorm = 99.7740, GNorm = 0.4461, lr_0 = 2.1889e-04
Loss = 1.0378e-03, PNorm = 99.7874, GNorm = 0.4963, lr_0 = 2.0962e-04
Validation rmse = 0.928961
Epoch 20
Loss = 1.0401e-03, PNorm = 99.8005, GNorm = 0.3793, lr_0 = 2.0074e-04
Loss = 9.2731e-04, PNorm = 99.8114, GNorm = 0.4605, lr_0 = 1.9224e-04
Validation rmse = 0.970986
Epoch 21
Loss = 8.9851e-04, PNorm = 99.8230, GNorm = 0.9638, lr_0 = 1.8409e-04
Loss = 1.0150e-03, PNorm = 99.8333, GNorm = 0.8668, lr_0 = 1.7630e-04
Validation rmse = 0.949982
Epoch 22
Loss = 1.0632e-03, PNorm = 99.8448, GNorm = 0.4321, lr_0 = 1.6810e-04
Loss = 7.4840e-04, PNorm = 99.8551, GNorm = 0.5518, lr_0 = 1.6098e-04
Validation rmse = 0.987146
Epoch 23
Loss = 8.5754e-04, PNorm = 99.8662, GNorm = 0.4880, lr_0 = 1.5416e-04
Loss = 8.7084e-04, PNorm = 99.8746, GNorm = 0.8348, lr_0 = 1.4763e-04
Loss = 1.0754e-03, PNorm = 99.8759, GNorm = 0.5079, lr_0 = 1.4699e-04
Validation rmse = 0.995056
Epoch 24
Loss = 9.8387e-04, PNorm = 99.8875, GNorm = 0.3541, lr_0 = 1.4077e-04
Loss = 7.3547e-04, PNorm = 99.8950, GNorm = 0.6802, lr_0 = 1.3480e-04
Validation rmse = 0.982174
Epoch 25
Loss = 7.8752e-04, PNorm = 99.9034, GNorm = 0.4048, lr_0 = 1.2909e-04
Loss = 8.0571e-04, PNorm = 99.9106, GNorm = 0.5036, lr_0 = 1.2362e-04
Validation rmse = 0.971803
Epoch 26
Loss = 7.9050e-04, PNorm = 99.9187, GNorm = 0.6060, lr_0 = 1.1839e-04
Validation rmse = 1.042905
Epoch 27
Loss = 9.9407e-04, PNorm = 99.9255, GNorm = 1.1529, lr_0 = 1.1288e-04
Loss = 6.8997e-04, PNorm = 99.9328, GNorm = 0.5326, lr_0 = 1.0810e-04
Validation rmse = 0.978451
Epoch 28
Loss = 6.6015e-04, PNorm = 99.9390, GNorm = 0.4470, lr_0 = 1.0352e-04
Loss = 7.9613e-04, PNorm = 99.9463, GNorm = 0.6058, lr_0 = 1.0000e-04
Validation rmse = 1.006573
Epoch 29
Loss = 4.5652e-04, PNorm = 99.9529, GNorm = 0.4217, lr_0 = 1.0000e-04
Loss = 8.2432e-04, PNorm = 99.9599, GNorm = 0.6817, lr_0 = 1.0000e-04
Validation rmse = 0.990448
Model 0 best validation rmse = 0.845116 on epoch 13
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.871185
Ensemble test rmse = 0.871185
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.15000000000000002_ffn_num_layers_3_hidden_size_2300/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total scaffolds = 195 | train scaffolds = 55 | val scaffolds = 64 | test scaffolds = 76
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2300, bias=False)
      (W_h): Linear(in_features=2300, out_features=2300, bias=False)
      (W_o): Linear(in_features=2433, out_features=2300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=2304, out_features=2300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.15000000000000002, inplace=False)
    (4): Linear(in_features=2300, out_features=2300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.15000000000000002, inplace=False)
    (7): Linear(in_features=2300, out_features=1, bias=True)
  )
)
Number of parameters = 21,822,401
Moving model to cuda
Epoch 0
Loss = 1.4441e-02, PNorm = 97.7641, GNorm = 1.3330, lr_0 = 3.6053e-04
Validation rmse = 1.346466
Epoch 1
Loss = 6.7026e-03, PNorm = 97.8957, GNorm = 2.0100, lr_0 = 6.2105e-04
Loss = 5.3419e-03, PNorm = 98.0733, GNorm = 0.8286, lr_0 = 8.5789e-04
Validation rmse = 1.210793
Epoch 2
Loss = 3.0151e-03, PNorm = 98.2477, GNorm = 0.8887, lr_0 = 9.8284e-04
Loss = 4.0406e-03, PNorm = 98.3818, GNorm = 3.5547, lr_0 = 9.4120e-04
Validation rmse = 1.047792
Epoch 3
Loss = 3.4798e-03, PNorm = 98.4927, GNorm = 1.0670, lr_0 = 8.9744e-04
Loss = 4.1182e-03, PNorm = 98.5755, GNorm = 0.9990, lr_0 = 8.5943e-04
Validation rmse = 1.289685
Epoch 4
Loss = 3.1671e-03, PNorm = 98.6431, GNorm = 1.0689, lr_0 = 8.2303e-04
Loss = 3.2219e-03, PNorm = 98.7132, GNorm = 3.2202, lr_0 = 7.8816e-04
Validation rmse = 1.033048
Epoch 5
Loss = 2.3144e-03, PNorm = 98.7762, GNorm = 1.7557, lr_0 = 7.5478e-04
Loss = 2.6662e-03, PNorm = 98.8312, GNorm = 1.7581, lr_0 = 7.2281e-04
Validation rmse = 1.224111
Epoch 6
Loss = 2.3749e-03, PNorm = 98.8934, GNorm = 0.9826, lr_0 = 6.8920e-04
Loss = 2.8454e-03, PNorm = 98.9463, GNorm = 0.6190, lr_0 = 6.6001e-04
Validation rmse = 1.073053
Epoch 7
Loss = 2.4359e-03, PNorm = 98.9878, GNorm = 0.7649, lr_0 = 6.3205e-04
Loss = 2.1706e-03, PNorm = 99.0258, GNorm = 1.0075, lr_0 = 6.0528e-04
Validation rmse = 1.218640
Epoch 8
Loss = 2.5084e-03, PNorm = 99.0726, GNorm = 0.5448, lr_0 = 5.7714e-04
Loss = 1.9067e-03, PNorm = 99.1149, GNorm = 0.6662, lr_0 = 5.5269e-04
Validation rmse = 0.962526
Epoch 9
Loss = 1.7848e-03, PNorm = 99.1432, GNorm = 0.7448, lr_0 = 5.2928e-04
Loss = 1.8114e-03, PNorm = 99.1741, GNorm = 0.9914, lr_0 = 5.0686e-04
Validation rmse = 0.971271
Epoch 10
Loss = 2.1100e-03, PNorm = 99.2000, GNorm = 0.7539, lr_0 = 4.8539e-04
Loss = 1.8294e-03, PNorm = 99.2317, GNorm = 0.5853, lr_0 = 4.6483e-04
Validation rmse = 0.967492
Epoch 11
Loss = 1.9139e-03, PNorm = 99.2726, GNorm = 0.7054, lr_0 = 4.4322e-04
Loss = 1.4522e-03, PNorm = 99.3037, GNorm = 0.7030, lr_0 = 4.2444e-04
Validation rmse = 0.950775
Epoch 12
Loss = 1.6554e-03, PNorm = 99.3343, GNorm = 0.4588, lr_0 = 4.0646e-04
Loss = 1.5608e-03, PNorm = 99.3632, GNorm = 0.6351, lr_0 = 3.8925e-04
Validation rmse = 1.007570
Epoch 13
Loss = 1.5744e-03, PNorm = 99.3858, GNorm = 0.4967, lr_0 = 3.7276e-04
Loss = 1.7260e-03, PNorm = 99.4144, GNorm = 1.0964, lr_0 = 3.5697e-04
Validation rmse = 0.955643
Epoch 14
Loss = 1.4540e-03, PNorm = 99.4443, GNorm = 0.9244, lr_0 = 3.4037e-04
Loss = 1.3920e-03, PNorm = 99.4674, GNorm = 0.9374, lr_0 = 3.2596e-04
Validation rmse = 0.987065
Epoch 15
Loss = 1.2824e-03, PNorm = 99.4848, GNorm = 0.3052, lr_0 = 3.1215e-04
Loss = 1.4876e-03, PNorm = 99.5074, GNorm = 0.7523, lr_0 = 2.9893e-04
Validation rmse = 1.038271
Epoch 16
Loss = 1.1303e-03, PNorm = 99.5326, GNorm = 0.3664, lr_0 = 2.8503e-04
Loss = 1.1697e-03, PNorm = 99.5523, GNorm = 0.4429, lr_0 = 2.7295e-04
Validation rmse = 0.934357
Epoch 17
Loss = 1.3352e-03, PNorm = 99.5717, GNorm = 0.4689, lr_0 = 2.6139e-04
Loss = 1.3099e-03, PNorm = 99.5882, GNorm = 2.1595, lr_0 = 2.5032e-04
Validation rmse = 1.218182
Epoch 18
Loss = 1.3283e-03, PNorm = 99.6060, GNorm = 0.4654, lr_0 = 2.3972e-04
Loss = 1.2925e-03, PNorm = 99.6247, GNorm = 0.5453, lr_0 = 2.2956e-04
Validation rmse = 1.039424
Epoch 19
Loss = 1.2283e-03, PNorm = 99.6414, GNorm = 0.8249, lr_0 = 2.1889e-04
Loss = 1.1092e-03, PNorm = 99.6563, GNorm = 0.6095, lr_0 = 2.0962e-04
Validation rmse = 0.940606
Epoch 20
Loss = 1.1509e-03, PNorm = 99.6667, GNorm = 0.3677, lr_0 = 2.0074e-04
Loss = 1.1507e-03, PNorm = 99.6799, GNorm = 0.8079, lr_0 = 1.9224e-04
Validation rmse = 0.991427
Epoch 21
Loss = 1.1480e-03, PNorm = 99.6934, GNorm = 0.4652, lr_0 = 1.8409e-04
Loss = 9.1649e-04, PNorm = 99.7064, GNorm = 0.3325, lr_0 = 1.7630e-04
Validation rmse = 1.006378
Epoch 22
Loss = 9.3288e-04, PNorm = 99.7178, GNorm = 0.3768, lr_0 = 1.6810e-04
Loss = 7.9341e-04, PNorm = 99.7286, GNorm = 0.4686, lr_0 = 1.6098e-04
Validation rmse = 0.931426
Epoch 23
Loss = 9.2461e-04, PNorm = 99.7380, GNorm = 1.0255, lr_0 = 1.5416e-04
Loss = 1.2053e-03, PNorm = 99.7481, GNorm = 0.4001, lr_0 = 1.4763e-04
Loss = 1.1341e-03, PNorm = 99.7487, GNorm = 0.5245, lr_0 = 1.4699e-04
Validation rmse = 0.992278
Epoch 24
Loss = 8.3459e-04, PNorm = 99.7589, GNorm = 0.4597, lr_0 = 1.4077e-04
Loss = 9.0734e-04, PNorm = 99.7667, GNorm = 0.5630, lr_0 = 1.3480e-04
Validation rmse = 0.976044
Epoch 25
Loss = 1.0464e-03, PNorm = 99.7781, GNorm = 0.4120, lr_0 = 1.2909e-04
Loss = 7.6366e-04, PNorm = 99.7847, GNorm = 0.4476, lr_0 = 1.2362e-04
Validation rmse = 0.976720
Epoch 26
Loss = 8.2635e-04, PNorm = 99.7927, GNorm = 0.2883, lr_0 = 1.1839e-04
Validation rmse = 1.008440
Epoch 27
Loss = 8.6724e-04, PNorm = 99.8009, GNorm = 0.5175, lr_0 = 1.1288e-04
Loss = 8.2432e-04, PNorm = 99.8076, GNorm = 0.9267, lr_0 = 1.0810e-04
Validation rmse = 1.063932
Epoch 28
Loss = 6.1171e-04, PNorm = 99.8154, GNorm = 0.7093, lr_0 = 1.0352e-04
Loss = 7.7432e-04, PNorm = 99.8220, GNorm = 0.4761, lr_0 = 1.0000e-04
Validation rmse = 0.970893
Epoch 29
Loss = 6.7756e-04, PNorm = 99.8302, GNorm = 0.5525, lr_0 = 1.0000e-04
Loss = 8.3644e-04, PNorm = 99.8390, GNorm = 0.4509, lr_0 = 1.0000e-04
Validation rmse = 1.034721
Model 0 best validation rmse = 0.931426 on epoch 22
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.983691
Ensemble test rmse = 0.983691
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.15000000000000002_ffn_num_layers_3_hidden_size_2300/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total scaffolds = 195 | train scaffolds = 80 | val scaffolds = 54 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2300, bias=False)
      (W_h): Linear(in_features=2300, out_features=2300, bias=False)
      (W_o): Linear(in_features=2433, out_features=2300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=2304, out_features=2300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.15000000000000002, inplace=False)
    (4): Linear(in_features=2300, out_features=2300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.15000000000000002, inplace=False)
    (7): Linear(in_features=2300, out_features=1, bias=True)
  )
)
Number of parameters = 21,822,401
Moving model to cuda
Epoch 0
Loss = 1.4765e-02, PNorm = 97.7607, GNorm = 2.3823, lr_0 = 3.6053e-04
Validation rmse = 1.281097
Epoch 1
Loss = 5.0699e-03, PNorm = 97.8952, GNorm = 0.9327, lr_0 = 6.2105e-04
Loss = 4.1543e-03, PNorm = 98.0628, GNorm = 1.1327, lr_0 = 8.5789e-04
Validation rmse = 1.183533
Epoch 2
Loss = 3.4870e-03, PNorm = 98.2298, GNorm = 2.0723, lr_0 = 9.8284e-04
Loss = 3.9391e-03, PNorm = 98.3571, GNorm = 3.2955, lr_0 = 9.4120e-04
Validation rmse = 1.294497
Epoch 3
Loss = 3.7263e-03, PNorm = 98.4777, GNorm = 0.8263, lr_0 = 8.9744e-04
Loss = 4.1645e-03, PNorm = 98.5839, GNorm = 1.3141, lr_0 = 8.5943e-04
Validation rmse = 1.017066
Epoch 4
Loss = 3.2883e-03, PNorm = 98.6788, GNorm = 2.3056, lr_0 = 8.2303e-04
Loss = 2.9048e-03, PNorm = 98.7518, GNorm = 0.8875, lr_0 = 7.8816e-04
Validation rmse = 1.023241
Epoch 5
Loss = 2.0010e-03, PNorm = 98.8162, GNorm = 0.5237, lr_0 = 7.5478e-04
Loss = 1.9523e-03, PNorm = 98.8725, GNorm = 1.0491, lr_0 = 7.2281e-04
Validation rmse = 1.024904
Epoch 6
Loss = 2.3617e-03, PNorm = 98.9280, GNorm = 0.6216, lr_0 = 6.8920e-04
Loss = 2.7323e-03, PNorm = 98.9791, GNorm = 0.9231, lr_0 = 6.6001e-04
Validation rmse = 1.009892
Epoch 7
Loss = 1.9629e-03, PNorm = 99.0340, GNorm = 0.6646, lr_0 = 6.3205e-04
Loss = 2.2157e-03, PNorm = 99.0843, GNorm = 0.8791, lr_0 = 6.0528e-04
Validation rmse = 1.056094
Epoch 8
Loss = 2.1009e-03, PNorm = 99.1388, GNorm = 1.5429, lr_0 = 5.7714e-04
Loss = 1.7696e-03, PNorm = 99.1933, GNorm = 0.4786, lr_0 = 5.5269e-04
Validation rmse = 1.034140
Epoch 9
Loss = 1.4977e-03, PNorm = 99.2426, GNorm = 0.9527, lr_0 = 5.2928e-04
Loss = 1.7064e-03, PNorm = 99.2862, GNorm = 0.5386, lr_0 = 5.0686e-04
Validation rmse = 1.139143
Epoch 10
Loss = 1.7386e-03, PNorm = 99.3244, GNorm = 0.3519, lr_0 = 4.8539e-04
Loss = 1.5349e-03, PNorm = 99.3634, GNorm = 0.3816, lr_0 = 4.6483e-04
Validation rmse = 1.027253
Epoch 11
Loss = 1.5148e-03, PNorm = 99.4042, GNorm = 0.7163, lr_0 = 4.4322e-04
Loss = 1.6408e-03, PNorm = 99.4408, GNorm = 1.1868, lr_0 = 4.2444e-04
Validation rmse = 1.098214
Epoch 12
Loss = 1.4255e-03, PNorm = 99.4757, GNorm = 0.3809, lr_0 = 4.0646e-04
Loss = 1.6307e-03, PNorm = 99.5058, GNorm = 0.5415, lr_0 = 3.8925e-04
Validation rmse = 1.008888
Epoch 13
Loss = 1.5189e-03, PNorm = 99.5324, GNorm = 0.4704, lr_0 = 3.7276e-04
Loss = 1.4686e-03, PNorm = 99.5601, GNorm = 0.5156, lr_0 = 3.5697e-04
Validation rmse = 1.038646
Epoch 14
Loss = 1.1608e-03, PNorm = 99.5839, GNorm = 1.1761, lr_0 = 3.4037e-04
Loss = 1.4747e-03, PNorm = 99.6059, GNorm = 1.1017, lr_0 = 3.2596e-04
Validation rmse = 1.141459
Epoch 15
Loss = 1.1604e-03, PNorm = 99.6278, GNorm = 0.9008, lr_0 = 3.1215e-04
Loss = 1.2564e-03, PNorm = 99.6467, GNorm = 0.8766, lr_0 = 2.9893e-04
Validation rmse = 1.057616
Epoch 16
Loss = 8.9437e-04, PNorm = 99.6694, GNorm = 0.6648, lr_0 = 2.8503e-04
Loss = 1.1776e-03, PNorm = 99.6873, GNorm = 0.4487, lr_0 = 2.7295e-04
Validation rmse = 1.008316
Epoch 17
Loss = 8.9568e-04, PNorm = 99.7027, GNorm = 0.3774, lr_0 = 2.6139e-04
Loss = 1.1139e-03, PNorm = 99.7180, GNorm = 0.5539, lr_0 = 2.5032e-04
Validation rmse = 1.078652
Epoch 18
Loss = 1.2076e-03, PNorm = 99.7335, GNorm = 1.1854, lr_0 = 2.3972e-04
Loss = 1.0266e-03, PNorm = 99.7504, GNorm = 0.8830, lr_0 = 2.2956e-04
Validation rmse = 1.103487
Epoch 19
Loss = 1.0568e-03, PNorm = 99.7705, GNorm = 0.4431, lr_0 = 2.1889e-04
Loss = 9.8799e-04, PNorm = 99.7854, GNorm = 0.3744, lr_0 = 2.0962e-04
Validation rmse = 1.132205
Epoch 20
Loss = 8.3331e-04, PNorm = 99.7973, GNorm = 0.5395, lr_0 = 2.0074e-04
Loss = 9.7755e-04, PNorm = 99.8121, GNorm = 0.5751, lr_0 = 1.9224e-04
Validation rmse = 1.110986
Epoch 21
Loss = 8.2262e-04, PNorm = 99.8253, GNorm = 0.4942, lr_0 = 1.8409e-04
Loss = 9.5772e-04, PNorm = 99.8347, GNorm = 1.0245, lr_0 = 1.7630e-04
Validation rmse = 1.130016
Epoch 22
Loss = 1.1963e-03, PNorm = 99.8502, GNorm = 0.8856, lr_0 = 1.6810e-04
Loss = 8.4293e-04, PNorm = 99.8619, GNorm = 0.3310, lr_0 = 1.6098e-04
Validation rmse = 1.111785
Epoch 23
Loss = 7.1942e-04, PNorm = 99.8702, GNorm = 0.6168, lr_0 = 1.5416e-04
Loss = 7.8299e-04, PNorm = 99.8789, GNorm = 0.5340, lr_0 = 1.4763e-04
Loss = 1.6356e-03, PNorm = 99.8800, GNorm = 0.4440, lr_0 = 1.4699e-04
Validation rmse = 1.056209
Epoch 24
Loss = 6.5142e-04, PNorm = 99.8877, GNorm = 0.2499, lr_0 = 1.4077e-04
Loss = 7.8765e-04, PNorm = 99.8963, GNorm = 1.0254, lr_0 = 1.3480e-04
Validation rmse = 1.087529
Epoch 25
Loss = 7.7465e-04, PNorm = 99.9027, GNorm = 0.2706, lr_0 = 1.2909e-04
Loss = 8.5807e-04, PNorm = 99.9099, GNorm = 1.4528, lr_0 = 1.2362e-04
Validation rmse = 1.063749
Epoch 26
Loss = 8.2008e-04, PNorm = 99.9178, GNorm = 0.4035, lr_0 = 1.1839e-04
Validation rmse = 1.078222
Epoch 27
Loss = 7.8036e-04, PNorm = 99.9252, GNorm = 0.3076, lr_0 = 1.1288e-04
Loss = 7.1243e-04, PNorm = 99.9330, GNorm = 0.5035, lr_0 = 1.0810e-04
Validation rmse = 1.098976
Epoch 28
Loss = 5.9249e-04, PNorm = 99.9387, GNorm = 0.3570, lr_0 = 1.0352e-04
Loss = 6.3424e-04, PNorm = 99.9456, GNorm = 0.5076, lr_0 = 1.0000e-04
Validation rmse = 1.075538
Epoch 29
Loss = 7.7355e-04, PNorm = 99.9522, GNorm = 0.2621, lr_0 = 1.0000e-04
Loss = 6.1348e-04, PNorm = 99.9593, GNorm = 0.2668, lr_0 = 1.0000e-04
Validation rmse = 1.076616
Model 0 best validation rmse = 1.008316 on epoch 16
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.844550
Ensemble test rmse = 0.844550
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.15000000000000002_ffn_num_layers_3_hidden_size_2300/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 49 | test scaffolds = 62
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2300, bias=False)
      (W_h): Linear(in_features=2300, out_features=2300, bias=False)
      (W_o): Linear(in_features=2433, out_features=2300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=2304, out_features=2300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.15000000000000002, inplace=False)
    (4): Linear(in_features=2300, out_features=2300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.15000000000000002, inplace=False)
    (7): Linear(in_features=2300, out_features=1, bias=True)
  )
)
Number of parameters = 21,822,401
Moving model to cuda
Epoch 0
Loss = 1.1400e-02, PNorm = 97.7627, GNorm = 1.9294, lr_0 = 3.6053e-04
Validation rmse = 1.271350
Epoch 1
Loss = 5.3324e-03, PNorm = 97.8942, GNorm = 1.0094, lr_0 = 6.2105e-04
Loss = 4.7846e-03, PNorm = 98.0675, GNorm = 1.4524, lr_0 = 8.5789e-04
Validation rmse = 1.112092
Epoch 2
Loss = 4.0185e-03, PNorm = 98.2602, GNorm = 1.6980, lr_0 = 9.8284e-04
Loss = 4.0226e-03, PNorm = 98.4269, GNorm = 1.1227, lr_0 = 9.4120e-04
Validation rmse = 1.128543
Epoch 3
Loss = 3.4632e-03, PNorm = 98.5693, GNorm = 1.1989, lr_0 = 8.9744e-04
Loss = 2.9357e-03, PNorm = 98.6662, GNorm = 0.7689, lr_0 = 8.5943e-04
Validation rmse = 0.908113
Epoch 4
Loss = 3.7953e-03, PNorm = 98.7492, GNorm = 0.9779, lr_0 = 8.2303e-04
Loss = 2.8832e-03, PNorm = 98.8250, GNorm = 1.4833, lr_0 = 7.8816e-04
Validation rmse = 0.850597
Epoch 5
Loss = 1.5495e-03, PNorm = 98.8873, GNorm = 0.5742, lr_0 = 7.5478e-04
Loss = 2.3930e-03, PNorm = 98.9447, GNorm = 0.7779, lr_0 = 7.2281e-04
Validation rmse = 0.958398
Epoch 6
Loss = 1.9332e-03, PNorm = 99.0006, GNorm = 0.5253, lr_0 = 6.8920e-04
Loss = 2.1656e-03, PNorm = 99.0515, GNorm = 0.7642, lr_0 = 6.6001e-04
Validation rmse = 0.867073
Epoch 7
Loss = 1.7518e-03, PNorm = 99.0964, GNorm = 0.7870, lr_0 = 6.3205e-04
Loss = 2.5597e-03, PNorm = 99.1415, GNorm = 0.5181, lr_0 = 6.0528e-04
Validation rmse = 0.966334
Epoch 8
Loss = 2.2225e-03, PNorm = 99.1940, GNorm = 1.2396, lr_0 = 5.7714e-04
Loss = 2.2709e-03, PNorm = 99.2373, GNorm = 0.7540, lr_0 = 5.5269e-04
Validation rmse = 0.888786
Epoch 9
Loss = 1.4077e-03, PNorm = 99.2763, GNorm = 0.7553, lr_0 = 5.2928e-04
Loss = 1.7643e-03, PNorm = 99.3109, GNorm = 0.9067, lr_0 = 5.0686e-04
Validation rmse = 0.815247
Epoch 10
Loss = 1.9884e-03, PNorm = 99.3405, GNorm = 1.1024, lr_0 = 4.8539e-04
Loss = 1.7791e-03, PNorm = 99.3716, GNorm = 0.6140, lr_0 = 4.6483e-04
Validation rmse = 0.935677
Epoch 11
Loss = 1.6385e-03, PNorm = 99.4077, GNorm = 0.4630, lr_0 = 4.4322e-04
Loss = 1.3457e-03, PNorm = 99.4343, GNorm = 0.4469, lr_0 = 4.2444e-04
Validation rmse = 0.789680
Epoch 12
Loss = 1.1540e-03, PNorm = 99.4627, GNorm = 0.8813, lr_0 = 4.0646e-04
Loss = 1.2933e-03, PNorm = 99.4832, GNorm = 0.4219, lr_0 = 3.8925e-04
Validation rmse = 0.837774
Epoch 13
Loss = 1.1893e-03, PNorm = 99.5068, GNorm = 0.8258, lr_0 = 3.7276e-04
Loss = 1.6074e-03, PNorm = 99.5331, GNorm = 0.6178, lr_0 = 3.5697e-04
Validation rmse = 0.945584
Epoch 14
Loss = 1.0419e-03, PNorm = 99.5599, GNorm = 0.4552, lr_0 = 3.4037e-04
Loss = 1.5769e-03, PNorm = 99.5859, GNorm = 0.7596, lr_0 = 3.2596e-04
Validation rmse = 0.802739
Epoch 15
Loss = 1.4879e-03, PNorm = 99.6082, GNorm = 0.8383, lr_0 = 3.1215e-04
Loss = 1.5495e-03, PNorm = 99.6325, GNorm = 0.7525, lr_0 = 2.9893e-04
Validation rmse = 0.818479
Epoch 16
Loss = 1.0764e-03, PNorm = 99.6534, GNorm = 0.3100, lr_0 = 2.8503e-04
Loss = 1.2682e-03, PNorm = 99.6743, GNorm = 1.3354, lr_0 = 2.7295e-04
Validation rmse = 0.812449
Epoch 17
Loss = 9.5533e-04, PNorm = 99.6910, GNorm = 0.2545, lr_0 = 2.6139e-04
Loss = 1.2115e-03, PNorm = 99.7070, GNorm = 0.7733, lr_0 = 2.5032e-04
Validation rmse = 0.937249
Epoch 18
Loss = 1.4367e-03, PNorm = 99.7226, GNorm = 0.7705, lr_0 = 2.3972e-04
Loss = 1.2265e-03, PNorm = 99.7403, GNorm = 0.6426, lr_0 = 2.2956e-04
Validation rmse = 0.888607
Epoch 19
Loss = 1.0261e-03, PNorm = 99.7518, GNorm = 0.3010, lr_0 = 2.1889e-04
Loss = 1.2212e-03, PNorm = 99.7669, GNorm = 0.6763, lr_0 = 2.0962e-04
Validation rmse = 0.927130
Epoch 20
Loss = 1.1936e-03, PNorm = 99.7826, GNorm = 0.4719, lr_0 = 2.0074e-04
Loss = 1.2179e-03, PNorm = 99.7950, GNorm = 0.9868, lr_0 = 1.9224e-04
Validation rmse = 0.941879
Epoch 21
Loss = 1.2360e-03, PNorm = 99.8071, GNorm = 0.8881, lr_0 = 1.8409e-04
Loss = 9.8886e-04, PNorm = 99.8194, GNorm = 0.8615, lr_0 = 1.7630e-04
Validation rmse = 0.902789
Epoch 22
Loss = 9.6772e-04, PNorm = 99.8305, GNorm = 0.3934, lr_0 = 1.6810e-04
Loss = 9.5909e-04, PNorm = 99.8414, GNorm = 0.2930, lr_0 = 1.6098e-04
Validation rmse = 0.832931
Epoch 23
Loss = 1.1690e-03, PNorm = 99.8485, GNorm = 0.6064, lr_0 = 1.5416e-04
Loss = 9.8350e-04, PNorm = 99.8593, GNorm = 1.1301, lr_0 = 1.4763e-04
Loss = 1.3598e-03, PNorm = 99.8602, GNorm = 0.7756, lr_0 = 1.4699e-04
Validation rmse = 0.814908
Epoch 24
Loss = 8.2436e-04, PNorm = 99.8689, GNorm = 0.5309, lr_0 = 1.4077e-04
Loss = 9.6371e-04, PNorm = 99.8779, GNorm = 0.9343, lr_0 = 1.3480e-04
Validation rmse = 0.800412
Epoch 25
Loss = 7.5074e-04, PNorm = 99.8849, GNorm = 0.6266, lr_0 = 1.2909e-04
Loss = 1.3761e-03, PNorm = 99.8947, GNorm = 1.0741, lr_0 = 1.2362e-04
Validation rmse = 0.825344
Epoch 26
Loss = 8.2771e-04, PNorm = 99.9034, GNorm = 0.4172, lr_0 = 1.1839e-04
Validation rmse = 0.822575
Epoch 27
Loss = 8.3875e-04, PNorm = 99.9146, GNorm = 0.5550, lr_0 = 1.1288e-04
Loss = 7.3215e-04, PNorm = 99.9217, GNorm = 0.5947, lr_0 = 1.0810e-04
Validation rmse = 0.766679
Epoch 28
Loss = 5.9173e-04, PNorm = 99.9288, GNorm = 0.7633, lr_0 = 1.0352e-04
Loss = 7.7415e-04, PNorm = 99.9339, GNorm = 0.5013, lr_0 = 1.0000e-04
Validation rmse = 0.828280
Epoch 29
Loss = 6.6458e-04, PNorm = 99.9397, GNorm = 0.4666, lr_0 = 1.0000e-04
Loss = 9.3690e-04, PNorm = 99.9474, GNorm = 0.3853, lr_0 = 1.0000e-04
Validation rmse = 0.774013
Model 0 best validation rmse = 0.766679 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.958246
Ensemble test rmse = 0.958246
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.15000000000000002_ffn_num_layers_3_hidden_size_2300/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total scaffolds = 195 | train scaffolds = 94 | val scaffolds = 55 | test scaffolds = 46
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2300, bias=False)
      (W_h): Linear(in_features=2300, out_features=2300, bias=False)
      (W_o): Linear(in_features=2433, out_features=2300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=2304, out_features=2300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.15000000000000002, inplace=False)
    (4): Linear(in_features=2300, out_features=2300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.15000000000000002, inplace=False)
    (7): Linear(in_features=2300, out_features=1, bias=True)
  )
)
Number of parameters = 21,822,401
Moving model to cuda
Epoch 0
Loss = 1.0590e-02, PNorm = 97.7652, GNorm = 1.9709, lr_0 = 3.6053e-04
Validation rmse = 1.370010
Epoch 1
Loss = 3.4372e-03, PNorm = 97.8946, GNorm = 1.9156, lr_0 = 6.2105e-04
Loss = 4.0968e-03, PNorm = 98.0512, GNorm = 1.0458, lr_0 = 8.5789e-04
Validation rmse = 1.231455
Epoch 2
Loss = 5.2869e-03, PNorm = 98.2346, GNorm = 1.4707, lr_0 = 9.8284e-04
Loss = 3.7736e-03, PNorm = 98.4079, GNorm = 1.7282, lr_0 = 9.4120e-04
Validation rmse = 1.162027
Epoch 3
Loss = 3.8129e-03, PNorm = 98.5452, GNorm = 3.0739, lr_0 = 8.9744e-04
Loss = 3.2520e-03, PNorm = 98.6467, GNorm = 1.1109, lr_0 = 8.5943e-04
Validation rmse = 1.165223
Epoch 4
Loss = 3.3907e-03, PNorm = 98.7266, GNorm = 0.8975, lr_0 = 8.2303e-04
Loss = 2.4230e-03, PNorm = 98.8013, GNorm = 1.9387, lr_0 = 7.8816e-04
Validation rmse = 0.966285
Epoch 5
Loss = 2.6174e-03, PNorm = 98.8695, GNorm = 1.1016, lr_0 = 7.5478e-04
Loss = 2.4927e-03, PNorm = 98.9289, GNorm = 1.3541, lr_0 = 7.2281e-04
Validation rmse = 1.103234
Epoch 6
Loss = 3.0121e-03, PNorm = 98.9949, GNorm = 0.8075, lr_0 = 6.8920e-04
Loss = 2.4066e-03, PNorm = 99.0511, GNorm = 0.4641, lr_0 = 6.6001e-04
Validation rmse = 1.001828
Epoch 7
Loss = 1.8535e-03, PNorm = 99.1005, GNorm = 0.3540, lr_0 = 6.3205e-04
Loss = 2.0920e-03, PNorm = 99.1439, GNorm = 1.0641, lr_0 = 6.0528e-04
Validation rmse = 1.028790
Epoch 8
Loss = 1.6780e-03, PNorm = 99.1793, GNorm = 0.5784, lr_0 = 5.7714e-04
Loss = 1.7634e-03, PNorm = 99.2154, GNorm = 0.4509, lr_0 = 5.5269e-04
Validation rmse = 1.078833
Epoch 9
Loss = 1.7066e-03, PNorm = 99.2458, GNorm = 0.5071, lr_0 = 5.2928e-04
Loss = 1.6869e-03, PNorm = 99.2828, GNorm = 0.3544, lr_0 = 5.0686e-04
Validation rmse = 0.970555
Epoch 10
Loss = 1.3651e-03, PNorm = 99.3153, GNorm = 0.4069, lr_0 = 4.8539e-04
Loss = 1.8420e-03, PNorm = 99.3478, GNorm = 1.5039, lr_0 = 4.6483e-04
Validation rmse = 1.089399
Epoch 11
Loss = 1.4064e-03, PNorm = 99.3836, GNorm = 0.7247, lr_0 = 4.4322e-04
Loss = 1.4837e-03, PNorm = 99.4160, GNorm = 1.2535, lr_0 = 4.2444e-04
Validation rmse = 1.085060
Epoch 12
Loss = 1.1504e-03, PNorm = 99.4460, GNorm = 0.3626, lr_0 = 4.0646e-04
Loss = 1.5021e-03, PNorm = 99.4723, GNorm = 0.5238, lr_0 = 3.8925e-04
Validation rmse = 1.038976
Epoch 13
Loss = 1.3023e-03, PNorm = 99.4965, GNorm = 1.2081, lr_0 = 3.7276e-04
Loss = 1.4511e-03, PNorm = 99.5169, GNorm = 0.6721, lr_0 = 3.5697e-04
Validation rmse = 1.029405
Epoch 14
Loss = 1.5291e-03, PNorm = 99.5459, GNorm = 1.1128, lr_0 = 3.4037e-04
Loss = 1.2284e-03, PNorm = 99.5715, GNorm = 0.4759, lr_0 = 3.2596e-04
Validation rmse = 1.064679
Epoch 15
Loss = 1.1607e-03, PNorm = 99.6002, GNorm = 0.4832, lr_0 = 3.1215e-04
Loss = 1.1984e-03, PNorm = 99.6240, GNorm = 0.5773, lr_0 = 2.9893e-04
Validation rmse = 0.944024
Epoch 16
Loss = 1.1356e-03, PNorm = 99.6467, GNorm = 0.7509, lr_0 = 2.8503e-04
Loss = 1.3060e-03, PNorm = 99.6668, GNorm = 0.3550, lr_0 = 2.7295e-04
Validation rmse = 1.034469
Epoch 17
Loss = 1.1384e-03, PNorm = 99.6867, GNorm = 0.9035, lr_0 = 2.6139e-04
Loss = 1.3591e-03, PNorm = 99.7073, GNorm = 0.3186, lr_0 = 2.5032e-04
Validation rmse = 1.117744
Epoch 18
Loss = 1.1842e-03, PNorm = 99.7254, GNorm = 1.4950, lr_0 = 2.3972e-04
Loss = 1.1297e-03, PNorm = 99.7437, GNorm = 1.0810, lr_0 = 2.2956e-04
Validation rmse = 1.047787
Epoch 19
Loss = 8.0468e-04, PNorm = 99.7638, GNorm = 0.4063, lr_0 = 2.1889e-04
Loss = 1.0714e-03, PNorm = 99.7786, GNorm = 0.3929, lr_0 = 2.0962e-04
Validation rmse = 1.031584
Epoch 20
Loss = 9.3180e-04, PNorm = 99.7936, GNorm = 0.3615, lr_0 = 2.0074e-04
Loss = 1.1316e-03, PNorm = 99.8071, GNorm = 0.4680, lr_0 = 1.9224e-04
Validation rmse = 1.004347
Epoch 21
Loss = 1.0228e-03, PNorm = 99.8178, GNorm = 1.4021, lr_0 = 1.8409e-04
Loss = 8.9868e-04, PNorm = 99.8313, GNorm = 0.4914, lr_0 = 1.7630e-04
Validation rmse = 1.029217
Epoch 22
Loss = 8.1593e-04, PNorm = 99.8449, GNorm = 0.3108, lr_0 = 1.6810e-04
Loss = 9.7335e-04, PNorm = 99.8569, GNorm = 0.8411, lr_0 = 1.6098e-04
Validation rmse = 0.984518
Epoch 23
Loss = 9.1260e-04, PNorm = 99.8658, GNorm = 0.3580, lr_0 = 1.5416e-04
Loss = 1.0016e-03, PNorm = 99.8765, GNorm = 0.9070, lr_0 = 1.4763e-04
Loss = 7.2244e-04, PNorm = 99.8778, GNorm = 0.3258, lr_0 = 1.4699e-04
Validation rmse = 1.145313
Epoch 24
Loss = 8.4511e-04, PNorm = 99.8881, GNorm = 0.2025, lr_0 = 1.4077e-04
Loss = 1.1042e-03, PNorm = 99.8975, GNorm = 0.4860, lr_0 = 1.3480e-04
Validation rmse = 1.067749
Epoch 25
Loss = 8.0852e-04, PNorm = 99.9072, GNorm = 0.6487, lr_0 = 1.2909e-04
Loss = 9.1944e-04, PNorm = 99.9170, GNorm = 0.5604, lr_0 = 1.2362e-04
Validation rmse = 1.003936
Epoch 26
Loss = 8.4816e-04, PNorm = 99.9241, GNorm = 0.7998, lr_0 = 1.1839e-04
Validation rmse = 1.012040
Epoch 27
Loss = 8.5011e-04, PNorm = 99.9325, GNorm = 0.7034, lr_0 = 1.1288e-04
Loss = 7.7058e-04, PNorm = 99.9397, GNorm = 0.6682, lr_0 = 1.0810e-04
Validation rmse = 1.013139
Epoch 28
Loss = 8.4943e-04, PNorm = 99.9465, GNorm = 0.5180, lr_0 = 1.0352e-04
Loss = 7.5830e-04, PNorm = 99.9533, GNorm = 0.8251, lr_0 = 1.0000e-04
Validation rmse = 0.979133
Epoch 29
Loss = 6.9457e-04, PNorm = 99.9597, GNorm = 0.4462, lr_0 = 1.0000e-04
Loss = 7.0184e-04, PNorm = 99.9670, GNorm = 0.4629, lr_0 = 1.0000e-04
Validation rmse = 1.033728
Model 0 best validation rmse = 0.944024 on epoch 15
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.021407
Ensemble test rmse = 1.021407
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.15000000000000002_ffn_num_layers_3_hidden_size_2300/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total scaffolds = 195 | train scaffolds = 64 | val scaffolds = 68 | test scaffolds = 63
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2300, bias=False)
      (W_h): Linear(in_features=2300, out_features=2300, bias=False)
      (W_o): Linear(in_features=2433, out_features=2300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=2304, out_features=2300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.15000000000000002, inplace=False)
    (4): Linear(in_features=2300, out_features=2300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.15000000000000002, inplace=False)
    (7): Linear(in_features=2300, out_features=1, bias=True)
  )
)
Number of parameters = 21,822,401
Moving model to cuda
Epoch 0
Loss = 1.6137e-02, PNorm = 97.7592, GNorm = 3.6192, lr_0 = 3.6053e-04
Validation rmse = 1.552904
Epoch 1
Loss = 3.1867e-03, PNorm = 97.9074, GNorm = 0.9250, lr_0 = 6.2105e-04
Loss = 4.8030e-03, PNorm = 98.0909, GNorm = 1.6784, lr_0 = 8.5789e-04
Validation rmse = 1.200826
Epoch 2
Loss = 3.4479e-03, PNorm = 98.2660, GNorm = 0.9560, lr_0 = 9.8284e-04
Loss = 3.6931e-03, PNorm = 98.4026, GNorm = 0.6872, lr_0 = 9.4120e-04
Validation rmse = 1.158847
Epoch 3
Loss = 2.4447e-03, PNorm = 98.5183, GNorm = 2.2146, lr_0 = 8.9744e-04
Loss = 2.8029e-03, PNorm = 98.6005, GNorm = 1.0126, lr_0 = 8.5943e-04
Validation rmse = 1.035572
Epoch 4
Loss = 2.3595e-03, PNorm = 98.6760, GNorm = 1.2996, lr_0 = 8.2303e-04
Loss = 3.0013e-03, PNorm = 98.7475, GNorm = 0.7163, lr_0 = 7.8816e-04
Validation rmse = 1.035289
Epoch 5
Loss = 3.0570e-03, PNorm = 98.8085, GNorm = 1.7965, lr_0 = 7.5478e-04
Loss = 2.5586e-03, PNorm = 98.8610, GNorm = 0.8531, lr_0 = 7.2281e-04
Validation rmse = 1.141206
Epoch 6
Loss = 2.6238e-03, PNorm = 98.9208, GNorm = 0.7129, lr_0 = 6.8920e-04
Loss = 2.1179e-03, PNorm = 98.9816, GNorm = 1.0156, lr_0 = 6.6001e-04
Validation rmse = 1.002802
Epoch 7
Loss = 1.6137e-03, PNorm = 99.0270, GNorm = 0.6096, lr_0 = 6.3205e-04
Loss = 1.8563e-03, PNorm = 99.0734, GNorm = 0.8217, lr_0 = 6.0528e-04
Validation rmse = 1.045030
Epoch 8
Loss = 1.8419e-03, PNorm = 99.1212, GNorm = 0.7121, lr_0 = 5.7714e-04
Loss = 1.6268e-03, PNorm = 99.1623, GNorm = 0.9390, lr_0 = 5.5269e-04
Validation rmse = 1.208535
Epoch 9
Loss = 1.6160e-03, PNorm = 99.1962, GNorm = 0.4173, lr_0 = 5.2928e-04
Loss = 1.5340e-03, PNorm = 99.2299, GNorm = 0.6316, lr_0 = 5.0686e-04
Validation rmse = 1.081470
Epoch 10
Loss = 1.9081e-03, PNorm = 99.2648, GNorm = 1.3391, lr_0 = 4.8539e-04
Loss = 1.7273e-03, PNorm = 99.2992, GNorm = 0.9231, lr_0 = 4.6483e-04
Validation rmse = 1.033387
Epoch 11
Loss = 1.3403e-03, PNorm = 99.3307, GNorm = 0.4854, lr_0 = 4.4322e-04
Loss = 1.6126e-03, PNorm = 99.3566, GNorm = 1.8289, lr_0 = 4.2444e-04
Validation rmse = 0.989500
Epoch 12
Loss = 1.5020e-03, PNorm = 99.3844, GNorm = 0.3737, lr_0 = 4.0646e-04
Loss = 1.8097e-03, PNorm = 99.4092, GNorm = 0.7280, lr_0 = 3.8925e-04
Validation rmse = 0.985230
Epoch 13
Loss = 1.3799e-03, PNorm = 99.4383, GNorm = 0.5283, lr_0 = 3.7276e-04
Loss = 1.4247e-03, PNorm = 99.4650, GNorm = 0.5156, lr_0 = 3.5697e-04
Validation rmse = 1.303069
Epoch 14
Loss = 1.3602e-03, PNorm = 99.4914, GNorm = 1.2256, lr_0 = 3.4037e-04
Loss = 1.5552e-03, PNorm = 99.5139, GNorm = 0.7921, lr_0 = 3.2596e-04
Validation rmse = 1.076578
Epoch 15
Loss = 1.4103e-03, PNorm = 99.5379, GNorm = 0.3516, lr_0 = 3.1215e-04
Loss = 1.2265e-03, PNorm = 99.5589, GNorm = 0.5993, lr_0 = 2.9893e-04
Validation rmse = 1.140226
Epoch 16
Loss = 1.1773e-03, PNorm = 99.5816, GNorm = 0.3848, lr_0 = 2.8503e-04
Loss = 1.0945e-03, PNorm = 99.6021, GNorm = 0.9987, lr_0 = 2.7295e-04
Validation rmse = 1.130118
Epoch 17
Loss = 9.8064e-04, PNorm = 99.6200, GNorm = 0.4793, lr_0 = 2.6139e-04
Loss = 1.1152e-03, PNorm = 99.6329, GNorm = 0.7869, lr_0 = 2.5032e-04
Validation rmse = 1.156991
Epoch 18
Loss = 1.2033e-03, PNorm = 99.6482, GNorm = 0.8432, lr_0 = 2.3972e-04
Loss = 1.2078e-03, PNorm = 99.6636, GNorm = 0.8225, lr_0 = 2.2956e-04
Validation rmse = 1.096165
Epoch 19
Loss = 1.2610e-03, PNorm = 99.6792, GNorm = 0.5544, lr_0 = 2.1889e-04
Loss = 1.1116e-03, PNorm = 99.6951, GNorm = 0.6626, lr_0 = 2.0962e-04
Validation rmse = 1.026747
Epoch 20
Loss = 1.2151e-03, PNorm = 99.7097, GNorm = 0.7689, lr_0 = 2.0074e-04
Loss = 9.2021e-04, PNorm = 99.7240, GNorm = 0.3234, lr_0 = 1.9224e-04
Validation rmse = 1.192007
Epoch 21
Loss = 8.5862e-04, PNorm = 99.7364, GNorm = 0.6084, lr_0 = 1.8409e-04
Loss = 1.0714e-03, PNorm = 99.7473, GNorm = 0.6484, lr_0 = 1.7630e-04
Validation rmse = 1.124462
Epoch 22
Loss = 9.3847e-04, PNorm = 99.7584, GNorm = 0.8351, lr_0 = 1.6810e-04
Loss = 9.2982e-04, PNorm = 99.7675, GNorm = 1.1516, lr_0 = 1.6098e-04
Validation rmse = 1.090338
Epoch 23
Loss = 8.6368e-04, PNorm = 99.7773, GNorm = 0.5007, lr_0 = 1.5416e-04
Loss = 9.1656e-04, PNorm = 99.7853, GNorm = 0.5588, lr_0 = 1.4763e-04
Loss = 1.4297e-03, PNorm = 99.7859, GNorm = 0.6349, lr_0 = 1.4699e-04
Validation rmse = 1.073274
Epoch 24
Loss = 9.0601e-04, PNorm = 99.7947, GNorm = 0.5273, lr_0 = 1.4077e-04
Loss = 8.7035e-04, PNorm = 99.8037, GNorm = 0.2918, lr_0 = 1.3480e-04
Validation rmse = 1.076101
Epoch 25
Loss = 7.6734e-04, PNorm = 99.8122, GNorm = 0.6056, lr_0 = 1.2909e-04
Loss = 7.1817e-04, PNorm = 99.8195, GNorm = 0.4264, lr_0 = 1.2362e-04
Validation rmse = 1.047651
Epoch 26
Loss = 7.2432e-04, PNorm = 99.8250, GNorm = 0.3128, lr_0 = 1.1839e-04
Validation rmse = 1.091816
Epoch 27
Loss = 8.2012e-04, PNorm = 99.8333, GNorm = 0.5346, lr_0 = 1.1288e-04
Loss = 6.1686e-04, PNorm = 99.8390, GNorm = 0.4096, lr_0 = 1.0810e-04
Validation rmse = 1.064727
Epoch 28
Loss = 4.4234e-04, PNorm = 99.8450, GNorm = 0.3801, lr_0 = 1.0352e-04
Loss = 7.8512e-04, PNorm = 99.8498, GNorm = 0.6123, lr_0 = 1.0000e-04
Validation rmse = 1.128767
Epoch 29
Loss = 7.1663e-04, PNorm = 99.8565, GNorm = 0.7339, lr_0 = 1.0000e-04
Loss = 7.8048e-04, PNorm = 99.8630, GNorm = 0.6847, lr_0 = 1.0000e-04
Validation rmse = 1.083031
Model 0 best validation rmse = 0.985230 on epoch 12
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.798748
Ensemble test rmse = 0.798748
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.15000000000000002_ffn_num_layers_3_hidden_size_2300/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total scaffolds = 195 | train scaffolds = 69 | val scaffolds = 65 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2300, bias=False)
      (W_h): Linear(in_features=2300, out_features=2300, bias=False)
      (W_o): Linear(in_features=2433, out_features=2300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=2304, out_features=2300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.15000000000000002, inplace=False)
    (4): Linear(in_features=2300, out_features=2300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.15000000000000002, inplace=False)
    (7): Linear(in_features=2300, out_features=1, bias=True)
  )
)
Number of parameters = 21,822,401
Moving model to cuda
Epoch 0
Loss = 1.2535e-02, PNorm = 97.7640, GNorm = 2.1197, lr_0 = 3.6053e-04
Validation rmse = 2.291132
Epoch 1
Loss = 5.9073e-03, PNorm = 97.8986, GNorm = 3.0457, lr_0 = 6.2105e-04
Loss = 5.4998e-03, PNorm = 98.0654, GNorm = 1.2989, lr_0 = 8.5789e-04
Validation rmse = 1.435854
Epoch 2
Loss = 2.7816e-03, PNorm = 98.2476, GNorm = 1.2628, lr_0 = 9.8284e-04
Loss = 3.8601e-03, PNorm = 98.3990, GNorm = 1.2178, lr_0 = 9.4120e-04
Validation rmse = 1.195028
Epoch 3
Loss = 3.9717e-03, PNorm = 98.5294, GNorm = 0.9193, lr_0 = 8.9744e-04
Loss = 3.3580e-03, PNorm = 98.6272, GNorm = 0.7951, lr_0 = 8.5943e-04
Validation rmse = 1.341147
Epoch 4
Loss = 2.8537e-03, PNorm = 98.7078, GNorm = 0.8992, lr_0 = 8.2303e-04
Loss = 3.3963e-03, PNorm = 98.7807, GNorm = 0.6983, lr_0 = 7.8816e-04
Validation rmse = 1.082301
Epoch 5
Loss = 2.5872e-03, PNorm = 98.8594, GNorm = 0.6700, lr_0 = 7.5478e-04
Loss = 2.8548e-03, PNorm = 98.9258, GNorm = 1.0718, lr_0 = 7.2281e-04
Validation rmse = 1.316231
Epoch 6
Loss = 3.5164e-03, PNorm = 98.9965, GNorm = 2.2417, lr_0 = 6.8920e-04
Loss = 3.2022e-03, PNorm = 99.0598, GNorm = 1.5294, lr_0 = 6.6001e-04
Validation rmse = 1.225298
Epoch 7
Loss = 2.2289e-03, PNorm = 99.1247, GNorm = 0.9344, lr_0 = 6.3205e-04
Loss = 3.1456e-03, PNorm = 99.1764, GNorm = 0.4977, lr_0 = 6.0528e-04
Validation rmse = 1.262091
Epoch 8
Loss = 2.3477e-03, PNorm = 99.2289, GNorm = 0.8119, lr_0 = 5.7714e-04
Loss = 2.5034e-03, PNorm = 99.2699, GNorm = 0.7110, lr_0 = 5.5269e-04
Validation rmse = 1.465424
Epoch 9
Loss = 2.0585e-03, PNorm = 99.3151, GNorm = 0.5124, lr_0 = 5.2928e-04
Loss = 1.8214e-03, PNorm = 99.3513, GNorm = 0.8029, lr_0 = 5.0686e-04
Validation rmse = 1.386380
Epoch 10
Loss = 1.4932e-03, PNorm = 99.3868, GNorm = 0.4583, lr_0 = 4.8539e-04
Loss = 1.5262e-03, PNorm = 99.4167, GNorm = 0.5565, lr_0 = 4.6483e-04
Validation rmse = 1.193865
Epoch 11
Loss = 1.9372e-03, PNorm = 99.4504, GNorm = 0.6255, lr_0 = 4.4322e-04
Loss = 1.8814e-03, PNorm = 99.4821, GNorm = 0.5835, lr_0 = 4.2444e-04
Validation rmse = 1.236830
Epoch 12
Loss = 1.6133e-03, PNorm = 99.5106, GNorm = 0.5539, lr_0 = 4.0646e-04
Loss = 1.7675e-03, PNorm = 99.5401, GNorm = 1.0053, lr_0 = 3.8925e-04
Validation rmse = 1.175176
Epoch 13
Loss = 1.5161e-03, PNorm = 99.5689, GNorm = 0.8483, lr_0 = 3.7276e-04
Loss = 1.6768e-03, PNorm = 99.5962, GNorm = 0.3920, lr_0 = 3.5697e-04
Validation rmse = 1.313916
Epoch 14
Loss = 1.3616e-03, PNorm = 99.6222, GNorm = 0.6500, lr_0 = 3.4037e-04
Loss = 1.5397e-03, PNorm = 99.6433, GNorm = 0.5702, lr_0 = 3.2596e-04
Validation rmse = 1.371578
Epoch 15
Loss = 1.1739e-03, PNorm = 99.6674, GNorm = 0.5079, lr_0 = 3.1215e-04
Loss = 1.5347e-03, PNorm = 99.6881, GNorm = 0.6141, lr_0 = 2.9893e-04
Validation rmse = 1.574286
Epoch 16
Loss = 1.5151e-03, PNorm = 99.7101, GNorm = 0.6720, lr_0 = 2.8503e-04
Loss = 1.1871e-03, PNorm = 99.7274, GNorm = 0.5633, lr_0 = 2.7295e-04
Validation rmse = 1.359263
Epoch 17
Loss = 1.1230e-03, PNorm = 99.7447, GNorm = 0.6126, lr_0 = 2.6139e-04
Loss = 1.2039e-03, PNorm = 99.7623, GNorm = 0.9129, lr_0 = 2.5032e-04
Validation rmse = 1.179225
Epoch 18
Loss = 1.2867e-03, PNorm = 99.7782, GNorm = 0.5324, lr_0 = 2.3972e-04
Loss = 1.2024e-03, PNorm = 99.7989, GNorm = 0.5701, lr_0 = 2.2956e-04
Validation rmse = 1.281702
Epoch 19
Loss = 1.2561e-03, PNorm = 99.8141, GNorm = 1.1167, lr_0 = 2.1889e-04
Loss = 1.0828e-03, PNorm = 99.8306, GNorm = 0.2812, lr_0 = 2.0962e-04
Validation rmse = 1.213276
Epoch 20
Loss = 1.4426e-03, PNorm = 99.8457, GNorm = 0.6373, lr_0 = 2.0074e-04
Loss = 9.3120e-04, PNorm = 99.8574, GNorm = 0.5356, lr_0 = 1.9224e-04
Validation rmse = 1.343293
Epoch 21
Loss = 8.2667e-04, PNorm = 99.8681, GNorm = 0.6993, lr_0 = 1.8409e-04
Loss = 1.2841e-03, PNorm = 99.8804, GNorm = 0.6214, lr_0 = 1.7630e-04
Validation rmse = 1.441028
Epoch 22
Loss = 1.1151e-03, PNorm = 99.8943, GNorm = 1.0012, lr_0 = 1.6810e-04
Loss = 9.9286e-04, PNorm = 99.9071, GNorm = 0.6098, lr_0 = 1.6098e-04
Validation rmse = 1.309978
Epoch 23
Loss = 9.7947e-04, PNorm = 99.9175, GNorm = 0.4509, lr_0 = 1.5416e-04
Loss = 8.2076e-04, PNorm = 99.9273, GNorm = 0.3416, lr_0 = 1.4763e-04
Loss = 1.2148e-03, PNorm = 99.9278, GNorm = 1.3448, lr_0 = 1.4699e-04
Validation rmse = 1.353456
Epoch 24
Loss = 1.0328e-03, PNorm = 99.9375, GNorm = 1.1043, lr_0 = 1.4077e-04
Loss = 1.0986e-03, PNorm = 99.9469, GNorm = 1.1374, lr_0 = 1.3480e-04
Validation rmse = 1.344368
Epoch 25
Loss = 1.1355e-03, PNorm = 99.9568, GNorm = 0.2602, lr_0 = 1.2909e-04
Loss = 8.5159e-04, PNorm = 99.9658, GNorm = 0.8543, lr_0 = 1.2362e-04
Validation rmse = 1.290875
Epoch 26
Loss = 9.2679e-04, PNorm = 99.9739, GNorm = 0.3985, lr_0 = 1.1839e-04
Validation rmse = 1.338124
Epoch 27
Loss = 6.3828e-04, PNorm = 99.9823, GNorm = 0.8890, lr_0 = 1.1288e-04
Loss = 7.0179e-04, PNorm = 99.9901, GNorm = 0.6067, lr_0 = 1.0810e-04
Validation rmse = 1.407153
Epoch 28
Loss = 6.1534e-04, PNorm = 99.9977, GNorm = 0.2677, lr_0 = 1.0352e-04
Loss = 7.1306e-04, PNorm = 100.0035, GNorm = 0.3863, lr_0 = 1.0000e-04
Validation rmse = 1.430170
Epoch 29
Loss = 7.4788e-04, PNorm = 100.0104, GNorm = 0.3974, lr_0 = 1.0000e-04
Loss = 7.2226e-04, PNorm = 100.0150, GNorm = 0.5054, lr_0 = 1.0000e-04
Validation rmse = 1.365222
Model 0 best validation rmse = 1.082301 on epoch 4
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.045673
Ensemble test rmse = 1.045673
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.15000000000000002_ffn_num_layers_3_hidden_size_2300/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total scaffolds = 195 | train scaffolds = 75 | val scaffolds = 42 | test scaffolds = 78
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2300, bias=False)
      (W_h): Linear(in_features=2300, out_features=2300, bias=False)
      (W_o): Linear(in_features=2433, out_features=2300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=2304, out_features=2300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.15000000000000002, inplace=False)
    (4): Linear(in_features=2300, out_features=2300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.15000000000000002, inplace=False)
    (7): Linear(in_features=2300, out_features=1, bias=True)
  )
)
Number of parameters = 21,822,401
Moving model to cuda
Epoch 0
Loss = 1.4411e-02, PNorm = 97.7609, GNorm = 5.1555, lr_0 = 3.6053e-04
Validation rmse = 1.447161
Epoch 1
Loss = 3.0674e-03, PNorm = 97.9047, GNorm = 1.6562, lr_0 = 6.2105e-04
Loss = 4.8362e-03, PNorm = 98.0799, GNorm = 2.0222, lr_0 = 8.5789e-04
Validation rmse = 1.146412
Epoch 2
Loss = 4.5384e-03, PNorm = 98.2571, GNorm = 2.9634, lr_0 = 9.8284e-04
Loss = 3.4123e-03, PNorm = 98.3983, GNorm = 0.7156, lr_0 = 9.4120e-04
Validation rmse = 1.089889
Epoch 3
Loss = 2.2180e-03, PNorm = 98.5146, GNorm = 0.8041, lr_0 = 8.9744e-04
Loss = 3.2093e-03, PNorm = 98.6001, GNorm = 2.0456, lr_0 = 8.5943e-04
Validation rmse = 1.077669
Epoch 4
Loss = 3.1257e-03, PNorm = 98.6837, GNorm = 0.6550, lr_0 = 8.2303e-04
Loss = 3.3166e-03, PNorm = 98.7592, GNorm = 1.1876, lr_0 = 7.8816e-04
Validation rmse = 1.110726
Epoch 5
Loss = 2.8317e-03, PNorm = 98.8253, GNorm = 0.5162, lr_0 = 7.5478e-04
Loss = 2.6428e-03, PNorm = 98.8956, GNorm = 0.5469, lr_0 = 7.2281e-04
Validation rmse = 0.991272
Epoch 6
Loss = 1.8300e-03, PNorm = 98.9566, GNorm = 0.5784, lr_0 = 6.8920e-04
Loss = 1.8653e-03, PNorm = 99.0063, GNorm = 0.7286, lr_0 = 6.6001e-04
Validation rmse = 0.985503
Epoch 7
Loss = 2.2817e-03, PNorm = 99.0521, GNorm = 0.4809, lr_0 = 6.3205e-04
Loss = 1.6847e-03, PNorm = 99.0961, GNorm = 0.8844, lr_0 = 6.0528e-04
Validation rmse = 1.035280
Epoch 8
Loss = 2.6422e-03, PNorm = 99.1423, GNorm = 1.6256, lr_0 = 5.7714e-04
Loss = 1.8645e-03, PNorm = 99.1845, GNorm = 1.4658, lr_0 = 5.5269e-04
Validation rmse = 1.011479
Epoch 9
Loss = 1.9377e-03, PNorm = 99.2328, GNorm = 0.5438, lr_0 = 5.2928e-04
Loss = 1.5750e-03, PNorm = 99.2764, GNorm = 0.6326, lr_0 = 5.0686e-04
Validation rmse = 0.943889
Epoch 10
Loss = 1.3554e-03, PNorm = 99.3160, GNorm = 0.5663, lr_0 = 4.8539e-04
Loss = 1.6240e-03, PNorm = 99.3523, GNorm = 1.0559, lr_0 = 4.6483e-04
Validation rmse = 0.956884
Epoch 11
Loss = 1.6063e-03, PNorm = 99.3855, GNorm = 0.9243, lr_0 = 4.4322e-04
Loss = 1.5701e-03, PNorm = 99.4183, GNorm = 1.3668, lr_0 = 4.2444e-04
Validation rmse = 0.981884
Epoch 12
Loss = 1.6298e-03, PNorm = 99.4513, GNorm = 1.3147, lr_0 = 4.0646e-04
Loss = 1.2887e-03, PNorm = 99.4803, GNorm = 0.4117, lr_0 = 3.8925e-04
Validation rmse = 0.887264
Epoch 13
Loss = 1.2159e-03, PNorm = 99.5068, GNorm = 0.6007, lr_0 = 3.7276e-04
Loss = 1.1575e-03, PNorm = 99.5313, GNorm = 0.6442, lr_0 = 3.5697e-04
Validation rmse = 0.904929
Epoch 14
Loss = 1.3554e-03, PNorm = 99.5602, GNorm = 0.6935, lr_0 = 3.4037e-04
Loss = 1.0699e-03, PNorm = 99.5824, GNorm = 0.3687, lr_0 = 3.2596e-04
Validation rmse = 0.869424
Epoch 15
Loss = 1.0817e-03, PNorm = 99.6035, GNorm = 0.5564, lr_0 = 3.1215e-04
Loss = 1.1381e-03, PNorm = 99.6221, GNorm = 1.0659, lr_0 = 2.9893e-04
Validation rmse = 1.013616
Epoch 16
Loss = 1.1036e-03, PNorm = 99.6442, GNorm = 0.6711, lr_0 = 2.8503e-04
Loss = 1.1594e-03, PNorm = 99.6674, GNorm = 0.8085, lr_0 = 2.7295e-04
Validation rmse = 0.871473
Epoch 17
Loss = 1.0599e-03, PNorm = 99.6810, GNorm = 0.4743, lr_0 = 2.6139e-04
Loss = 1.1542e-03, PNorm = 99.7005, GNorm = 0.4087, lr_0 = 2.5032e-04
Validation rmse = 0.893519
Epoch 18
Loss = 8.8431e-04, PNorm = 99.7176, GNorm = 0.4720, lr_0 = 2.3972e-04
Loss = 1.0138e-03, PNorm = 99.7343, GNorm = 0.3381, lr_0 = 2.2956e-04
Validation rmse = 0.886382
Epoch 19
Loss = 1.0665e-03, PNorm = 99.7529, GNorm = 0.9018, lr_0 = 2.1889e-04
Loss = 1.0569e-03, PNorm = 99.7669, GNorm = 1.1750, lr_0 = 2.0962e-04
Validation rmse = 0.898920
Epoch 20
Loss = 9.1639e-04, PNorm = 99.7778, GNorm = 0.5991, lr_0 = 2.0074e-04
Loss = 1.0121e-03, PNorm = 99.7904, GNorm = 1.1746, lr_0 = 1.9224e-04
Validation rmse = 0.884219
Epoch 21
Loss = 8.5782e-04, PNorm = 99.8021, GNorm = 0.3995, lr_0 = 1.8409e-04
Loss = 1.0142e-03, PNorm = 99.8129, GNorm = 0.7018, lr_0 = 1.7630e-04
Validation rmse = 0.947343
Epoch 22
Loss = 9.5941e-04, PNorm = 99.8257, GNorm = 1.0916, lr_0 = 1.6810e-04
Loss = 7.1608e-04, PNorm = 99.8365, GNorm = 0.4209, lr_0 = 1.6098e-04
Validation rmse = 0.957581
Epoch 23
Loss = 8.4453e-04, PNorm = 99.8452, GNorm = 0.8235, lr_0 = 1.5416e-04
Loss = 7.7121e-04, PNorm = 99.8552, GNorm = 0.6762, lr_0 = 1.4763e-04
Loss = 1.3799e-03, PNorm = 99.8561, GNorm = 0.6199, lr_0 = 1.4699e-04
Validation rmse = 0.954311
Epoch 24
Loss = 6.7446e-04, PNorm = 99.8625, GNorm = 0.4173, lr_0 = 1.4077e-04
Loss = 7.8783e-04, PNorm = 99.8731, GNorm = 0.6541, lr_0 = 1.3480e-04
Validation rmse = 0.885701
Epoch 25
Loss = 7.1196e-04, PNorm = 99.8796, GNorm = 0.6820, lr_0 = 1.2909e-04
Loss = 8.9920e-04, PNorm = 99.8861, GNorm = 0.8937, lr_0 = 1.2362e-04
Validation rmse = 0.929038
Epoch 26
Loss = 1.0165e-03, PNorm = 99.8961, GNorm = 0.3743, lr_0 = 1.1839e-04
Validation rmse = 0.970959
Epoch 27
Loss = 1.3722e-03, PNorm = 99.9037, GNorm = 1.3841, lr_0 = 1.1288e-04
Loss = 6.9745e-04, PNorm = 99.9110, GNorm = 0.9144, lr_0 = 1.0810e-04
Validation rmse = 0.933202
Epoch 28
Loss = 5.1017e-04, PNorm = 99.9182, GNorm = 0.2897, lr_0 = 1.0352e-04
Loss = 7.2013e-04, PNorm = 99.9246, GNorm = 0.3145, lr_0 = 1.0000e-04
Validation rmse = 0.985198
Epoch 29
Loss = 6.8649e-04, PNorm = 99.9315, GNorm = 0.4668, lr_0 = 1.0000e-04
Loss = 5.3720e-04, PNorm = 99.9375, GNorm = 0.9903, lr_0 = 1.0000e-04
Validation rmse = 0.997504
Model 0 best validation rmse = 0.869424 on epoch 14
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.035330
Ensemble test rmse = 1.035330
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.15000000000000002_ffn_num_layers_3_hidden_size_2300/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 58 | test scaffolds = 53
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2300, bias=False)
      (W_h): Linear(in_features=2300, out_features=2300, bias=False)
      (W_o): Linear(in_features=2433, out_features=2300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=2304, out_features=2300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.15000000000000002, inplace=False)
    (4): Linear(in_features=2300, out_features=2300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.15000000000000002, inplace=False)
    (7): Linear(in_features=2300, out_features=1, bias=True)
  )
)
Number of parameters = 21,822,401
Moving model to cuda
Epoch 0
Loss = 1.3779e-02, PNorm = 97.7647, GNorm = 2.8374, lr_0 = 3.6053e-04
Validation rmse = 1.482821
Epoch 1
Loss = 5.0114e-03, PNorm = 97.9017, GNorm = 3.4084, lr_0 = 6.2105e-04
Loss = 4.0441e-03, PNorm = 98.0626, GNorm = 1.4425, lr_0 = 8.5789e-04
Validation rmse = 0.976826
Epoch 2
Loss = 4.1148e-03, PNorm = 98.2344, GNorm = 1.2277, lr_0 = 9.8284e-04
Loss = 4.2839e-03, PNorm = 98.3852, GNorm = 2.6132, lr_0 = 9.4120e-04
Validation rmse = 1.264958
Epoch 3
Loss = 5.4104e-03, PNorm = 98.5157, GNorm = 2.1724, lr_0 = 8.9744e-04
Loss = 3.8709e-03, PNorm = 98.6185, GNorm = 1.3773, lr_0 = 8.5943e-04
Validation rmse = 0.882570
Epoch 4
Loss = 2.9583e-03, PNorm = 98.7146, GNorm = 0.4363, lr_0 = 8.2303e-04
Loss = 2.2595e-03, PNorm = 98.7917, GNorm = 0.5780, lr_0 = 7.8816e-04
Validation rmse = 0.907011
Epoch 5
Loss = 2.8519e-03, PNorm = 98.8490, GNorm = 1.0333, lr_0 = 7.5478e-04
Loss = 2.5794e-03, PNorm = 98.9054, GNorm = 1.1754, lr_0 = 7.2281e-04
Validation rmse = 0.891794
Epoch 6
Loss = 2.2888e-03, PNorm = 98.9677, GNorm = 1.8008, lr_0 = 6.8920e-04
Loss = 2.3509e-03, PNorm = 99.0168, GNorm = 1.0480, lr_0 = 6.6001e-04
Validation rmse = 0.918881
Epoch 7
Loss = 2.2637e-03, PNorm = 99.0669, GNorm = 0.9449, lr_0 = 6.3205e-04
Loss = 2.3132e-03, PNorm = 99.1133, GNorm = 1.4502, lr_0 = 6.0528e-04
Validation rmse = 0.877041
Epoch 8
Loss = 1.4893e-03, PNorm = 99.1562, GNorm = 0.7994, lr_0 = 5.7714e-04
Loss = 1.9913e-03, PNorm = 99.1948, GNorm = 0.9856, lr_0 = 5.5269e-04
Validation rmse = 0.854180
Epoch 9
Loss = 1.8103e-03, PNorm = 99.2317, GNorm = 0.7894, lr_0 = 5.2928e-04
Loss = 1.6917e-03, PNorm = 99.2683, GNorm = 1.4995, lr_0 = 5.0686e-04
Validation rmse = 0.856901
Epoch 10
Loss = 1.4729e-03, PNorm = 99.3023, GNorm = 0.6168, lr_0 = 4.8539e-04
Loss = 1.5966e-03, PNorm = 99.3317, GNorm = 0.6673, lr_0 = 4.6483e-04
Validation rmse = 0.825422
Epoch 11
Loss = 1.6422e-03, PNorm = 99.3653, GNorm = 0.7241, lr_0 = 4.4322e-04
Loss = 1.6196e-03, PNorm = 99.3943, GNorm = 0.4786, lr_0 = 4.2444e-04
Validation rmse = 0.828591
Epoch 12
Loss = 1.6007e-03, PNorm = 99.4260, GNorm = 0.4188, lr_0 = 4.0646e-04
Loss = 1.7177e-03, PNorm = 99.4589, GNorm = 0.3918, lr_0 = 3.8925e-04
Validation rmse = 0.866248
Epoch 13
Loss = 1.7636e-03, PNorm = 99.4853, GNorm = 0.5878, lr_0 = 3.7276e-04
Loss = 1.3619e-03, PNorm = 99.5091, GNorm = 0.3545, lr_0 = 3.5697e-04
Validation rmse = 0.970520
Epoch 14
Loss = 1.4495e-03, PNorm = 99.5366, GNorm = 1.1042, lr_0 = 3.4037e-04
Loss = 1.6185e-03, PNorm = 99.5608, GNorm = 0.8062, lr_0 = 3.2596e-04
Validation rmse = 0.857640
Epoch 15
Loss = 1.1534e-03, PNorm = 99.5830, GNorm = 0.2659, lr_0 = 3.1215e-04
Loss = 1.5312e-03, PNorm = 99.6002, GNorm = 1.4672, lr_0 = 2.9893e-04
Validation rmse = 0.794510
Epoch 16
Loss = 1.5319e-03, PNorm = 99.6216, GNorm = 2.1363, lr_0 = 2.8503e-04
Loss = 1.2668e-03, PNorm = 99.6385, GNorm = 0.6242, lr_0 = 2.7295e-04
Validation rmse = 0.942407
Epoch 17
Loss = 1.6184e-03, PNorm = 99.6544, GNorm = 1.0785, lr_0 = 2.6139e-04
Loss = 1.4142e-03, PNorm = 99.6726, GNorm = 1.0088, lr_0 = 2.5032e-04
Validation rmse = 0.820221
Epoch 18
Loss = 1.0957e-03, PNorm = 99.6911, GNorm = 0.5412, lr_0 = 2.3972e-04
Loss = 1.4845e-03, PNorm = 99.7056, GNorm = 0.5591, lr_0 = 2.2956e-04
Validation rmse = 0.799541
Epoch 19
Loss = 1.1239e-03, PNorm = 99.7189, GNorm = 0.7712, lr_0 = 2.1889e-04
Loss = 1.3475e-03, PNorm = 99.7334, GNorm = 0.3254, lr_0 = 2.0962e-04
Validation rmse = 0.818125
Epoch 20
Loss = 1.1119e-03, PNorm = 99.7473, GNorm = 0.5264, lr_0 = 2.0074e-04
Loss = 9.9922e-04, PNorm = 99.7610, GNorm = 0.4294, lr_0 = 1.9224e-04
Validation rmse = 0.792150
Epoch 21
Loss = 1.1053e-03, PNorm = 99.7711, GNorm = 1.2722, lr_0 = 1.8409e-04
Loss = 1.1580e-03, PNorm = 99.7823, GNorm = 0.7661, lr_0 = 1.7630e-04
Validation rmse = 0.801397
Epoch 22
Loss = 9.0823e-04, PNorm = 99.7931, GNorm = 0.3218, lr_0 = 1.6810e-04
Loss = 9.5052e-04, PNorm = 99.8044, GNorm = 1.0737, lr_0 = 1.6098e-04
Validation rmse = 0.778938
Epoch 23
Loss = 1.0541e-03, PNorm = 99.8116, GNorm = 0.7516, lr_0 = 1.5416e-04
Loss = 9.4255e-04, PNorm = 99.8211, GNorm = 0.2661, lr_0 = 1.4763e-04
Loss = 3.2253e-03, PNorm = 99.8220, GNorm = 0.8853, lr_0 = 1.4699e-04
Validation rmse = 0.769276
Epoch 24
Loss = 8.9098e-04, PNorm = 99.8305, GNorm = 0.3762, lr_0 = 1.4077e-04
Loss = 8.4638e-04, PNorm = 99.8383, GNorm = 0.7315, lr_0 = 1.3480e-04
Validation rmse = 0.821068
Epoch 25
Loss = 9.6406e-04, PNorm = 99.8461, GNorm = 0.8556, lr_0 = 1.2909e-04
Loss = 8.4826e-04, PNorm = 99.8532, GNorm = 0.4612, lr_0 = 1.2362e-04
Validation rmse = 0.827090
Epoch 26
Loss = 8.8081e-04, PNorm = 99.8614, GNorm = 0.4247, lr_0 = 1.1839e-04
Validation rmse = 0.832238
Epoch 27
Loss = 1.0864e-03, PNorm = 99.8697, GNorm = 0.4161, lr_0 = 1.1288e-04
Loss = 1.1067e-03, PNorm = 99.8786, GNorm = 0.4596, lr_0 = 1.0810e-04
Validation rmse = 0.840118
Epoch 28
Loss = 4.7480e-04, PNorm = 99.8875, GNorm = 0.2515, lr_0 = 1.0352e-04
Loss = 8.1089e-04, PNorm = 99.8955, GNorm = 0.3548, lr_0 = 1.0000e-04
Validation rmse = 0.842686
Epoch 29
Loss = 8.8173e-04, PNorm = 99.9039, GNorm = 0.6695, lr_0 = 1.0000e-04
Loss = 8.4544e-04, PNorm = 99.9104, GNorm = 0.3714, lr_0 = 1.0000e-04
Validation rmse = 0.804650
Model 0 best validation rmse = 0.769276 on epoch 23
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.273674
Ensemble test rmse = 1.273674
10-fold cross validation
	Seed 0 ==> test rmse = 0.877505
	Seed 1 ==> test rmse = 0.871185
	Seed 2 ==> test rmse = 0.983691
	Seed 3 ==> test rmse = 0.844550
	Seed 4 ==> test rmse = 0.958246
	Seed 5 ==> test rmse = 1.021407
	Seed 6 ==> test rmse = 0.798748
	Seed 7 ==> test rmse = 1.045673
	Seed 8 ==> test rmse = 1.035330
	Seed 9 ==> test rmse = 1.273674
Overall test rmse = 0.971001 +/- 0.129829
Elapsed time = 0:08:10
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_2_dropout_0.30000000000000004_ffn_num_layers_2_hidden_size_1400/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total scaffolds = 195 | train scaffolds = 91 | val scaffolds = 66 | test scaffolds = 38
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=1404, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,281,801
Moving model to cuda
Epoch 0
Loss = 1.4825e-02, PNorm = 67.3621, GNorm = 7.1374, lr_0 = 3.6053e-04
Validation rmse = 1.700404
Epoch 1
Loss = 9.6113e-03, PNorm = 67.4395, GNorm = 6.5976, lr_0 = 6.2105e-04
Loss = 7.0848e-03, PNorm = 67.5406, GNorm = 3.5068, lr_0 = 8.5789e-04
Validation rmse = 1.015810
Epoch 2
Loss = 7.1799e-03, PNorm = 67.6607, GNorm = 1.2967, lr_0 = 9.8284e-04
Loss = 5.3744e-03, PNorm = 67.7681, GNorm = 1.1329, lr_0 = 9.4120e-04
Validation rmse = 1.066477
Epoch 3
Loss = 2.4442e-03, PNorm = 67.8573, GNorm = 1.3711, lr_0 = 8.9744e-04
Loss = 4.3922e-03, PNorm = 67.9210, GNorm = 1.0432, lr_0 = 8.5943e-04
Validation rmse = 0.988684
Epoch 4
Loss = 4.6530e-03, PNorm = 67.9909, GNorm = 1.2282, lr_0 = 8.2303e-04
Loss = 3.5187e-03, PNorm = 68.0477, GNorm = 0.5914, lr_0 = 7.8816e-04
Validation rmse = 1.024134
Epoch 5
Loss = 2.9566e-03, PNorm = 68.0956, GNorm = 2.0743, lr_0 = 7.5478e-04
Loss = 2.7291e-03, PNorm = 68.1435, GNorm = 0.8396, lr_0 = 7.2281e-04
Validation rmse = 1.025811
Epoch 6
Loss = 2.9079e-03, PNorm = 68.1950, GNorm = 1.1584, lr_0 = 6.8920e-04
Loss = 3.1521e-03, PNorm = 68.2444, GNorm = 1.3679, lr_0 = 6.6001e-04
Validation rmse = 1.350171
Epoch 7
Loss = 3.7285e-03, PNorm = 68.2933, GNorm = 3.5445, lr_0 = 6.3205e-04
Loss = 2.6935e-03, PNorm = 68.3378, GNorm = 1.1624, lr_0 = 6.0528e-04
Validation rmse = 1.147379
Epoch 8
Loss = 2.8021e-03, PNorm = 68.3850, GNorm = 1.1856, lr_0 = 5.7714e-04
Loss = 2.4131e-03, PNorm = 68.4192, GNorm = 1.1191, lr_0 = 5.5269e-04
Validation rmse = 0.982325
Epoch 9
Loss = 3.0778e-03, PNorm = 68.4550, GNorm = 1.0416, lr_0 = 5.2928e-04
Loss = 2.9226e-03, PNorm = 68.4960, GNorm = 1.2843, lr_0 = 5.0686e-04
Validation rmse = 1.129992
Epoch 10
Loss = 2.7069e-03, PNorm = 68.5218, GNorm = 1.0323, lr_0 = 4.8539e-04
Loss = 2.5658e-03, PNorm = 68.5513, GNorm = 1.4851, lr_0 = 4.6483e-04
Validation rmse = 1.061959
Epoch 11
Loss = 2.1890e-03, PNorm = 68.5825, GNorm = 1.0806, lr_0 = 4.4322e-04
Loss = 1.8083e-03, PNorm = 68.6084, GNorm = 1.1547, lr_0 = 4.2444e-04
Validation rmse = 1.006728
Epoch 12
Loss = 2.0036e-03, PNorm = 68.6282, GNorm = 0.5624, lr_0 = 4.0646e-04
Loss = 2.1511e-03, PNorm = 68.6457, GNorm = 1.0719, lr_0 = 3.8925e-04
Validation rmse = 1.024017
Epoch 13
Loss = 1.5061e-03, PNorm = 68.6639, GNorm = 0.3996, lr_0 = 3.7276e-04
Loss = 2.1850e-03, PNorm = 68.6799, GNorm = 0.8750, lr_0 = 3.5697e-04
Validation rmse = 1.144350
Epoch 14
Loss = 1.9286e-03, PNorm = 68.7003, GNorm = 0.9994, lr_0 = 3.4037e-04
Loss = 1.8123e-03, PNorm = 68.7172, GNorm = 1.5134, lr_0 = 3.2596e-04
Validation rmse = 1.039255
Epoch 15
Loss = 1.9170e-03, PNorm = 68.7318, GNorm = 0.8911, lr_0 = 3.1215e-04
Loss = 1.7338e-03, PNorm = 68.7489, GNorm = 0.9499, lr_0 = 2.9893e-04
Validation rmse = 1.128449
Epoch 16
Loss = 2.0533e-03, PNorm = 68.7605, GNorm = 1.0174, lr_0 = 2.8503e-04
Loss = 1.8951e-03, PNorm = 68.7726, GNorm = 0.5628, lr_0 = 2.7295e-04
Validation rmse = 1.122612
Epoch 17
Loss = 1.9502e-03, PNorm = 68.7901, GNorm = 1.5649, lr_0 = 2.6139e-04
Loss = 2.2121e-03, PNorm = 68.8043, GNorm = 1.6667, lr_0 = 2.5032e-04
Validation rmse = 1.129799
Epoch 18
Loss = 1.8113e-03, PNorm = 68.8154, GNorm = 1.2404, lr_0 = 2.3972e-04
Loss = 1.9904e-03, PNorm = 68.8265, GNorm = 1.5028, lr_0 = 2.2956e-04
Validation rmse = 0.990287
Epoch 19
Loss = 1.7210e-03, PNorm = 68.8412, GNorm = 1.1323, lr_0 = 2.1889e-04
Loss = 2.0107e-03, PNorm = 68.8495, GNorm = 0.7001, lr_0 = 2.0962e-04
Validation rmse = 1.069165
Epoch 20
Loss = 1.6742e-03, PNorm = 68.8602, GNorm = 0.7710, lr_0 = 2.0074e-04
Loss = 1.6368e-03, PNorm = 68.8670, GNorm = 0.7714, lr_0 = 1.9224e-04
Validation rmse = 1.110146
Epoch 21
Loss = 1.6906e-03, PNorm = 68.8770, GNorm = 0.4098, lr_0 = 1.8409e-04
Loss = 1.6440e-03, PNorm = 68.8851, GNorm = 0.8249, lr_0 = 1.7630e-04
Validation rmse = 1.031694
Epoch 22
Loss = 1.5373e-03, PNorm = 68.8962, GNorm = 0.9319, lr_0 = 1.6810e-04
Loss = 1.8937e-03, PNorm = 68.9031, GNorm = 0.6500, lr_0 = 1.6098e-04
Validation rmse = 1.038700
Epoch 23
Loss = 1.6332e-03, PNorm = 68.9104, GNorm = 0.9121, lr_0 = 1.5416e-04
Loss = 1.5633e-03, PNorm = 68.9174, GNorm = 1.5629, lr_0 = 1.4763e-04
Loss = 2.1136e-03, PNorm = 68.9185, GNorm = 1.2777, lr_0 = 1.4699e-04
Validation rmse = 1.056637
Epoch 24
Loss = 1.5307e-03, PNorm = 68.9238, GNorm = 1.2182, lr_0 = 1.4077e-04
Loss = 1.5737e-03, PNorm = 68.9306, GNorm = 1.0416, lr_0 = 1.3480e-04
Validation rmse = 1.089744
Epoch 25
Loss = 1.5978e-03, PNorm = 68.9363, GNorm = 1.3277, lr_0 = 1.2909e-04
Loss = 1.6103e-03, PNorm = 68.9426, GNorm = 1.8027, lr_0 = 1.2362e-04
Validation rmse = 1.052200
Epoch 26
Loss = 1.6602e-03, PNorm = 68.9481, GNorm = 0.9227, lr_0 = 1.1839e-04
Validation rmse = 1.021239
Epoch 27
Loss = 8.5235e-04, PNorm = 68.9563, GNorm = 0.8569, lr_0 = 1.1288e-04
Loss = 1.6573e-03, PNorm = 68.9595, GNorm = 0.7319, lr_0 = 1.0810e-04
Validation rmse = 1.023255
Epoch 28
Loss = 2.4977e-03, PNorm = 68.9635, GNorm = 1.0955, lr_0 = 1.0352e-04
Loss = 1.5517e-03, PNorm = 68.9675, GNorm = 0.7823, lr_0 = 1.0000e-04
Validation rmse = 1.025778
Epoch 29
Loss = 1.6193e-03, PNorm = 68.9743, GNorm = 1.0041, lr_0 = 1.0000e-04
Loss = 1.5539e-03, PNorm = 68.9784, GNorm = 1.2978, lr_0 = 1.0000e-04
Validation rmse = 1.008711
Model 0 best validation rmse = 0.982325 on epoch 8
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.027402
Ensemble test rmse = 1.027402
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_2_dropout_0.30000000000000004_ffn_num_layers_2_hidden_size_1400/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total scaffolds = 195 | train scaffolds = 76 | val scaffolds = 60 | test scaffolds = 59
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=1404, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,281,801
Moving model to cuda
Epoch 0
Loss = 1.6515e-02, PNorm = 67.3621, GNorm = 6.1230, lr_0 = 3.6053e-04
Validation rmse = 1.477199
Epoch 1
Loss = 7.4741e-03, PNorm = 67.4449, GNorm = 5.4718, lr_0 = 6.2105e-04
Loss = 6.4358e-03, PNorm = 67.5464, GNorm = 4.6842, lr_0 = 8.5789e-04
Validation rmse = 1.854648
Epoch 2
Loss = 1.0552e-02, PNorm = 67.6605, GNorm = 5.8445, lr_0 = 9.8284e-04
Loss = 5.2170e-03, PNorm = 67.7673, GNorm = 2.7609, lr_0 = 9.4120e-04
Validation rmse = 1.129667
Epoch 3
Loss = 4.5944e-03, PNorm = 67.8573, GNorm = 1.4316, lr_0 = 8.9744e-04
Loss = 4.2185e-03, PNorm = 67.9289, GNorm = 1.4961, lr_0 = 8.5943e-04
Validation rmse = 1.093416
Epoch 4
Loss = 2.2186e-03, PNorm = 67.9890, GNorm = 0.7654, lr_0 = 8.2303e-04
Loss = 3.1751e-03, PNorm = 68.0448, GNorm = 0.8689, lr_0 = 7.8816e-04
Validation rmse = 1.102252
Epoch 5
Loss = 3.6209e-03, PNorm = 68.0971, GNorm = 1.0854, lr_0 = 7.5478e-04
Loss = 3.7032e-03, PNorm = 68.1533, GNorm = 1.5698, lr_0 = 7.2281e-04
Validation rmse = 1.191310
Epoch 6
Loss = 3.8947e-03, PNorm = 68.2063, GNorm = 1.4901, lr_0 = 6.8920e-04
Loss = 3.0660e-03, PNorm = 68.2629, GNorm = 1.0072, lr_0 = 6.6001e-04
Validation rmse = 1.278721
Epoch 7
Loss = 2.5987e-03, PNorm = 68.3013, GNorm = 1.3051, lr_0 = 6.3205e-04
Loss = 3.2083e-03, PNorm = 68.3409, GNorm = 1.3930, lr_0 = 6.0528e-04
Validation rmse = 1.172491
Epoch 8
Loss = 3.8032e-03, PNorm = 68.3813, GNorm = 1.7840, lr_0 = 5.7714e-04
Loss = 2.8708e-03, PNorm = 68.4198, GNorm = 0.7296, lr_0 = 5.5269e-04
Validation rmse = 1.127633
Epoch 9
Loss = 1.8352e-03, PNorm = 68.4551, GNorm = 0.7036, lr_0 = 5.2928e-04
Loss = 2.7821e-03, PNorm = 68.4829, GNorm = 1.9079, lr_0 = 5.0686e-04
Validation rmse = 1.138521
Epoch 10
Loss = 2.6108e-03, PNorm = 68.5144, GNorm = 0.9164, lr_0 = 4.8539e-04
Loss = 1.7980e-03, PNorm = 68.5378, GNorm = 1.8154, lr_0 = 4.6483e-04
Validation rmse = 1.020251
Epoch 11
Loss = 2.5681e-03, PNorm = 68.5673, GNorm = 1.6001, lr_0 = 4.4322e-04
Loss = 2.4397e-03, PNorm = 68.5903, GNorm = 1.1326, lr_0 = 4.2444e-04
Validation rmse = 1.072854
Epoch 12
Loss = 1.8211e-03, PNorm = 68.6159, GNorm = 2.1814, lr_0 = 4.0646e-04
Loss = 2.2416e-03, PNorm = 68.6291, GNorm = 0.9237, lr_0 = 3.8925e-04
Validation rmse = 1.051180
Epoch 13
Loss = 1.9310e-03, PNorm = 68.6492, GNorm = 0.7467, lr_0 = 3.7276e-04
Loss = 1.8193e-03, PNorm = 68.6679, GNorm = 0.9770, lr_0 = 3.5697e-04
Validation rmse = 1.054926
Epoch 14
Loss = 1.8839e-03, PNorm = 68.6857, GNorm = 1.4874, lr_0 = 3.4037e-04
Loss = 1.8389e-03, PNorm = 68.7072, GNorm = 0.9696, lr_0 = 3.2596e-04
Validation rmse = 1.066536
Epoch 15
Loss = 1.8505e-03, PNorm = 68.7202, GNorm = 0.9257, lr_0 = 3.1215e-04
Loss = 1.6898e-03, PNorm = 68.7387, GNorm = 0.5947, lr_0 = 2.9893e-04
Validation rmse = 1.036221
Epoch 16
Loss = 1.6858e-03, PNorm = 68.7509, GNorm = 0.7340, lr_0 = 2.8503e-04
Loss = 2.0623e-03, PNorm = 68.7625, GNorm = 0.7706, lr_0 = 2.7295e-04
Validation rmse = 1.083260
Epoch 17
Loss = 1.5218e-03, PNorm = 68.7762, GNorm = 1.1473, lr_0 = 2.6139e-04
Loss = 1.6938e-03, PNorm = 68.7881, GNorm = 1.0318, lr_0 = 2.5032e-04
Validation rmse = 1.079134
Epoch 18
Loss = 1.7933e-03, PNorm = 68.7986, GNorm = 1.6016, lr_0 = 2.3972e-04
Loss = 1.5066e-03, PNorm = 68.8089, GNorm = 2.0010, lr_0 = 2.2956e-04
Validation rmse = 1.080413
Epoch 19
Loss = 1.4156e-03, PNorm = 68.8232, GNorm = 0.5337, lr_0 = 2.1889e-04
Loss = 1.7722e-03, PNorm = 68.8314, GNorm = 0.6288, lr_0 = 2.0962e-04
Validation rmse = 1.082363
Epoch 20
Loss = 1.5145e-03, PNorm = 68.8416, GNorm = 0.9754, lr_0 = 2.0074e-04
Loss = 1.6769e-03, PNorm = 68.8511, GNorm = 0.6613, lr_0 = 1.9224e-04
Validation rmse = 1.078205
Epoch 21
Loss = 1.4069e-03, PNorm = 68.8594, GNorm = 1.1613, lr_0 = 1.8409e-04
Loss = 2.0038e-03, PNorm = 68.8676, GNorm = 1.6361, lr_0 = 1.7630e-04
Validation rmse = 1.087783
Epoch 22
Loss = 1.6990e-03, PNorm = 68.8795, GNorm = 1.5971, lr_0 = 1.6810e-04
Loss = 1.3562e-03, PNorm = 68.8875, GNorm = 1.1990, lr_0 = 1.6098e-04
Validation rmse = 1.098061
Epoch 23
Loss = 1.5320e-03, PNorm = 68.8926, GNorm = 0.5639, lr_0 = 1.5416e-04
Loss = 1.7471e-03, PNorm = 68.8994, GNorm = 0.8424, lr_0 = 1.4763e-04
Loss = 2.1072e-03, PNorm = 68.8999, GNorm = 1.2654, lr_0 = 1.4699e-04
Validation rmse = 1.075684
Epoch 24
Loss = 1.7205e-03, PNorm = 68.9091, GNorm = 0.6133, lr_0 = 1.4077e-04
Loss = 1.3372e-03, PNorm = 68.9165, GNorm = 0.8402, lr_0 = 1.3480e-04
Validation rmse = 1.143421
Epoch 25
Loss = 1.3493e-03, PNorm = 68.9215, GNorm = 0.6674, lr_0 = 1.2909e-04
Loss = 1.6178e-03, PNorm = 68.9291, GNorm = 1.7229, lr_0 = 1.2362e-04
Validation rmse = 1.082873
Epoch 26
Loss = 1.5585e-03, PNorm = 68.9346, GNorm = 0.8636, lr_0 = 1.1839e-04
Validation rmse = 1.134178
Epoch 27
Loss = 1.6369e-03, PNorm = 68.9403, GNorm = 1.7082, lr_0 = 1.1288e-04
Loss = 1.1783e-03, PNorm = 68.9458, GNorm = 0.4757, lr_0 = 1.0810e-04
Validation rmse = 1.094752
Epoch 28
Loss = 1.0356e-03, PNorm = 68.9494, GNorm = 0.4745, lr_0 = 1.0352e-04
Loss = 1.4061e-03, PNorm = 68.9534, GNorm = 1.2258, lr_0 = 1.0000e-04
Validation rmse = 1.062468
Epoch 29
Loss = 1.0089e-03, PNorm = 68.9595, GNorm = 0.7222, lr_0 = 1.0000e-04
Loss = 1.5293e-03, PNorm = 68.9662, GNorm = 0.7419, lr_0 = 1.0000e-04
Validation rmse = 1.097623
Model 0 best validation rmse = 1.020251 on epoch 10
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.093964
Ensemble test rmse = 1.093964
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_2_dropout_0.30000000000000004_ffn_num_layers_2_hidden_size_1400/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total scaffolds = 195 | train scaffolds = 55 | val scaffolds = 64 | test scaffolds = 76
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=1404, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,281,801
Moving model to cuda
Epoch 0
Loss = 1.6608e-02, PNorm = 67.3589, GNorm = 2.5315, lr_0 = 3.6053e-04
Validation rmse = 1.431805
Epoch 1
Loss = 9.2562e-03, PNorm = 67.4460, GNorm = 3.0177, lr_0 = 6.2105e-04
Loss = 7.0701e-03, PNorm = 67.5447, GNorm = 7.0730, lr_0 = 8.5789e-04
Validation rmse = 1.149529
Epoch 2
Loss = 9.0600e-03, PNorm = 67.6609, GNorm = 1.6858, lr_0 = 9.8284e-04
Loss = 4.5235e-03, PNorm = 67.7707, GNorm = 2.2168, lr_0 = 9.4120e-04
Validation rmse = 1.154002
Epoch 3
Loss = 4.5981e-03, PNorm = 67.8663, GNorm = 1.9128, lr_0 = 8.9744e-04
Loss = 4.2185e-03, PNorm = 67.9418, GNorm = 1.9253, lr_0 = 8.5943e-04
Validation rmse = 1.217580
Epoch 4
Loss = 2.7972e-03, PNorm = 67.9953, GNorm = 0.5221, lr_0 = 8.2303e-04
Loss = 3.6868e-03, PNorm = 68.0547, GNorm = 1.6056, lr_0 = 7.8816e-04
Validation rmse = 1.288997
Epoch 5
Loss = 2.9507e-03, PNorm = 68.1083, GNorm = 1.3949, lr_0 = 7.5478e-04
Loss = 3.2247e-03, PNorm = 68.1559, GNorm = 1.2093, lr_0 = 7.2281e-04
Validation rmse = 1.112566
Epoch 6
Loss = 2.7225e-03, PNorm = 68.2073, GNorm = 0.7848, lr_0 = 6.8920e-04
Loss = 3.0348e-03, PNorm = 68.2525, GNorm = 0.9668, lr_0 = 6.6001e-04
Validation rmse = 1.214479
Epoch 7
Loss = 3.2065e-03, PNorm = 68.2981, GNorm = 0.8157, lr_0 = 6.3205e-04
Loss = 2.9381e-03, PNorm = 68.3335, GNorm = 3.8472, lr_0 = 6.0528e-04
Validation rmse = 1.276020
Epoch 8
Loss = 3.5533e-03, PNorm = 68.3777, GNorm = 1.2141, lr_0 = 5.7714e-04
Loss = 2.9363e-03, PNorm = 68.4213, GNorm = 1.8828, lr_0 = 5.5269e-04
Validation rmse = 1.074630
Epoch 9
Loss = 2.6631e-03, PNorm = 68.4519, GNorm = 1.1417, lr_0 = 5.2928e-04
Loss = 2.2984e-03, PNorm = 68.4883, GNorm = 0.6166, lr_0 = 5.0686e-04
Validation rmse = 1.119648
Epoch 10
Loss = 2.1211e-03, PNorm = 68.5169, GNorm = 0.7147, lr_0 = 4.8539e-04
Loss = 2.4040e-03, PNorm = 68.5388, GNorm = 0.9007, lr_0 = 4.6483e-04
Validation rmse = 1.085897
Epoch 11
Loss = 3.7662e-03, PNorm = 68.5650, GNorm = 2.6199, lr_0 = 4.4322e-04
Loss = 2.4790e-03, PNorm = 68.5951, GNorm = 0.4958, lr_0 = 4.2444e-04
Validation rmse = 1.140076
Epoch 12
Loss = 2.1665e-03, PNorm = 68.6172, GNorm = 0.7655, lr_0 = 4.0646e-04
Loss = 2.1671e-03, PNorm = 68.6341, GNorm = 0.6879, lr_0 = 3.8925e-04
Validation rmse = 1.123946
Epoch 13
Loss = 2.6074e-03, PNorm = 68.6517, GNorm = 1.3009, lr_0 = 3.7276e-04
Loss = 2.1118e-03, PNorm = 68.6730, GNorm = 1.2023, lr_0 = 3.5697e-04
Validation rmse = 1.176046
Epoch 14
Loss = 2.5836e-03, PNorm = 68.6935, GNorm = 1.4355, lr_0 = 3.4037e-04
Loss = 2.2864e-03, PNorm = 68.7107, GNorm = 1.6462, lr_0 = 3.2596e-04
Validation rmse = 1.171569
Epoch 15
Loss = 1.8833e-03, PNorm = 68.7309, GNorm = 1.1529, lr_0 = 3.1215e-04
Loss = 2.1128e-03, PNorm = 68.7456, GNorm = 0.5550, lr_0 = 2.9893e-04
Validation rmse = 1.229324
Epoch 16
Loss = 1.9978e-03, PNorm = 68.7648, GNorm = 2.1826, lr_0 = 2.8503e-04
Loss = 2.2179e-03, PNorm = 68.7768, GNorm = 0.6657, lr_0 = 2.7295e-04
Validation rmse = 1.180155
Epoch 17
Loss = 1.9216e-03, PNorm = 68.7927, GNorm = 1.3182, lr_0 = 2.6139e-04
Loss = 2.0013e-03, PNorm = 68.8016, GNorm = 1.8789, lr_0 = 2.5032e-04
Validation rmse = 1.254402
Epoch 18
Loss = 1.9495e-03, PNorm = 68.8175, GNorm = 1.0040, lr_0 = 2.3972e-04
Loss = 2.1449e-03, PNorm = 68.8261, GNorm = 0.7531, lr_0 = 2.2956e-04
Validation rmse = 1.182065
Epoch 19
Loss = 2.1849e-03, PNorm = 68.8382, GNorm = 1.8168, lr_0 = 2.1889e-04
Loss = 1.5956e-03, PNorm = 68.8497, GNorm = 1.2589, lr_0 = 2.0962e-04
Validation rmse = 1.153735
Epoch 20
Loss = 1.7291e-03, PNorm = 68.8547, GNorm = 1.1696, lr_0 = 2.0074e-04
Loss = 1.9565e-03, PNorm = 68.8652, GNorm = 0.8006, lr_0 = 1.9224e-04
Validation rmse = 1.100855
Epoch 21
Loss = 1.7632e-03, PNorm = 68.8707, GNorm = 0.9588, lr_0 = 1.8409e-04
Loss = 1.7687e-03, PNorm = 68.8802, GNorm = 0.4081, lr_0 = 1.7630e-04
Validation rmse = 1.210192
Epoch 22
Loss = 1.5715e-03, PNorm = 68.8888, GNorm = 0.6176, lr_0 = 1.6810e-04
Loss = 1.8286e-03, PNorm = 68.8943, GNorm = 0.5820, lr_0 = 1.6098e-04
Validation rmse = 1.119643
Epoch 23
Loss = 1.3516e-03, PNorm = 68.9008, GNorm = 0.7458, lr_0 = 1.5416e-04
Loss = 1.5578e-03, PNorm = 68.9088, GNorm = 0.9456, lr_0 = 1.4763e-04
Loss = 2.1786e-03, PNorm = 68.9092, GNorm = 0.8551, lr_0 = 1.4699e-04
Validation rmse = 1.148029
Epoch 24
Loss = 1.4630e-03, PNorm = 68.9134, GNorm = 1.2454, lr_0 = 1.4077e-04
Loss = 1.8506e-03, PNorm = 68.9188, GNorm = 0.8689, lr_0 = 1.3480e-04
Validation rmse = 1.180099
Epoch 25
Loss = 1.7604e-03, PNorm = 68.9262, GNorm = 0.9239, lr_0 = 1.2909e-04
Loss = 1.5236e-03, PNorm = 68.9299, GNorm = 1.4423, lr_0 = 1.2362e-04
Validation rmse = 1.160762
Epoch 26
Loss = 1.4804e-03, PNorm = 68.9371, GNorm = 0.8823, lr_0 = 1.1839e-04
Validation rmse = 1.160241
Epoch 27
Loss = 1.8368e-03, PNorm = 68.9420, GNorm = 0.7187, lr_0 = 1.1288e-04
Loss = 1.2447e-03, PNorm = 68.9460, GNorm = 1.0371, lr_0 = 1.0810e-04
Validation rmse = 1.146457
Epoch 28
Loss = 1.0616e-03, PNorm = 68.9488, GNorm = 0.5941, lr_0 = 1.0352e-04
Loss = 1.4344e-03, PNorm = 68.9525, GNorm = 0.8962, lr_0 = 1.0000e-04
Validation rmse = 1.151132
Epoch 29
Loss = 1.4724e-03, PNorm = 68.9580, GNorm = 1.0027, lr_0 = 1.0000e-04
Loss = 1.6011e-03, PNorm = 68.9617, GNorm = 1.1296, lr_0 = 1.0000e-04
Validation rmse = 1.154414
Model 0 best validation rmse = 1.074630 on epoch 8
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.160240
Ensemble test rmse = 1.160240
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_2_dropout_0.30000000000000004_ffn_num_layers_2_hidden_size_1400/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total scaffolds = 195 | train scaffolds = 80 | val scaffolds = 54 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=1404, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,281,801
Moving model to cuda
Epoch 0
Loss = 1.5579e-02, PNorm = 67.3648, GNorm = 7.6264, lr_0 = 3.6053e-04
Validation rmse = 1.301883
Epoch 1
Loss = 5.4230e-03, PNorm = 67.4407, GNorm = 1.8978, lr_0 = 6.2105e-04
Loss = 7.5711e-03, PNorm = 67.5360, GNorm = 3.8607, lr_0 = 8.5789e-04
Validation rmse = 1.454571
Epoch 2
Loss = 3.4130e-03, PNorm = 67.6551, GNorm = 1.3430, lr_0 = 9.8284e-04
Loss = 4.7693e-03, PNorm = 67.7605, GNorm = 1.9605, lr_0 = 9.4120e-04
Validation rmse = 1.362726
Epoch 3
Loss = 4.4012e-03, PNorm = 67.8486, GNorm = 1.0186, lr_0 = 8.9744e-04
Loss = 4.2324e-03, PNorm = 67.9201, GNorm = 1.6608, lr_0 = 8.5943e-04
Validation rmse = 1.216869
Epoch 4
Loss = 5.3753e-03, PNorm = 67.9976, GNorm = 3.2500, lr_0 = 8.2303e-04
Loss = 4.3234e-03, PNorm = 68.0723, GNorm = 1.5617, lr_0 = 7.8816e-04
Validation rmse = 1.159121
Epoch 5
Loss = 3.0401e-03, PNorm = 68.1353, GNorm = 1.4073, lr_0 = 7.5478e-04
Loss = 2.8296e-03, PNorm = 68.1912, GNorm = 0.9446, lr_0 = 7.2281e-04
Validation rmse = 1.104954
Epoch 6
Loss = 3.1611e-03, PNorm = 68.2388, GNorm = 0.7628, lr_0 = 6.8920e-04
Loss = 2.9744e-03, PNorm = 68.2794, GNorm = 0.9142, lr_0 = 6.6001e-04
Validation rmse = 1.068920
Epoch 7
Loss = 2.4062e-03, PNorm = 68.3195, GNorm = 0.9214, lr_0 = 6.3205e-04
Loss = 2.5750e-03, PNorm = 68.3644, GNorm = 0.7195, lr_0 = 6.0528e-04
Validation rmse = 1.159168
Epoch 8
Loss = 2.9716e-03, PNorm = 68.4095, GNorm = 2.8059, lr_0 = 5.7714e-04
Loss = 3.0230e-03, PNorm = 68.4568, GNorm = 1.8131, lr_0 = 5.5269e-04
Validation rmse = 1.154914
Epoch 9
Loss = 2.4582e-03, PNorm = 68.4900, GNorm = 1.5906, lr_0 = 5.2928e-04
Loss = 2.4452e-03, PNorm = 68.5293, GNorm = 0.4339, lr_0 = 5.0686e-04
Validation rmse = 1.128931
Epoch 10
Loss = 2.1946e-03, PNorm = 68.5589, GNorm = 0.6998, lr_0 = 4.8539e-04
Loss = 2.2517e-03, PNorm = 68.5849, GNorm = 1.2587, lr_0 = 4.6483e-04
Validation rmse = 1.085584
Epoch 11
Loss = 2.0474e-03, PNorm = 68.6169, GNorm = 0.9222, lr_0 = 4.4322e-04
Loss = 2.1633e-03, PNorm = 68.6437, GNorm = 0.5834, lr_0 = 4.2444e-04
Validation rmse = 1.123077
Epoch 12
Loss = 2.1413e-03, PNorm = 68.6689, GNorm = 1.1655, lr_0 = 4.0646e-04
Loss = 2.1953e-03, PNorm = 68.6886, GNorm = 1.8948, lr_0 = 3.8925e-04
Validation rmse = 1.138441
Epoch 13
Loss = 2.0086e-03, PNorm = 68.7128, GNorm = 0.9353, lr_0 = 3.7276e-04
Loss = 1.7971e-03, PNorm = 68.7286, GNorm = 0.7549, lr_0 = 3.5697e-04
Validation rmse = 1.125430
Epoch 14
Loss = 1.7551e-03, PNorm = 68.7474, GNorm = 0.8752, lr_0 = 3.4037e-04
Loss = 2.0577e-03, PNorm = 68.7638, GNorm = 2.8756, lr_0 = 3.2596e-04
Validation rmse = 1.383377
Epoch 15
Loss = 2.3120e-03, PNorm = 68.7820, GNorm = 1.7588, lr_0 = 3.1215e-04
Loss = 2.1331e-03, PNorm = 68.7987, GNorm = 1.9084, lr_0 = 2.9893e-04
Validation rmse = 1.082769
Epoch 16
Loss = 1.7780e-03, PNorm = 68.8156, GNorm = 0.6876, lr_0 = 2.8503e-04
Loss = 1.5993e-03, PNorm = 68.8288, GNorm = 0.8276, lr_0 = 2.7295e-04
Validation rmse = 1.099540
Epoch 17
Loss = 1.5821e-03, PNorm = 68.8423, GNorm = 0.7093, lr_0 = 2.6139e-04
Loss = 1.9911e-03, PNorm = 68.8548, GNorm = 0.4760, lr_0 = 2.5032e-04
Validation rmse = 1.050646
Epoch 18
Loss = 1.7257e-03, PNorm = 68.8672, GNorm = 0.7121, lr_0 = 2.3972e-04
Loss = 1.7373e-03, PNorm = 68.8797, GNorm = 0.6571, lr_0 = 2.2956e-04
Validation rmse = 1.104848
Epoch 19
Loss = 1.7850e-03, PNorm = 68.8941, GNorm = 0.6247, lr_0 = 2.1889e-04
Loss = 1.3251e-03, PNorm = 68.9067, GNorm = 0.4775, lr_0 = 2.0962e-04
Validation rmse = 1.094891
Epoch 20
Loss = 1.4577e-03, PNorm = 68.9122, GNorm = 1.0937, lr_0 = 2.0074e-04
Loss = 1.7170e-03, PNorm = 68.9217, GNorm = 1.0158, lr_0 = 1.9224e-04
Validation rmse = 1.139953
Epoch 21
Loss = 1.5288e-03, PNorm = 68.9294, GNorm = 0.8386, lr_0 = 1.8409e-04
Loss = 1.6220e-03, PNorm = 68.9386, GNorm = 0.8984, lr_0 = 1.7630e-04
Validation rmse = 1.139233
Epoch 22
Loss = 1.8138e-03, PNorm = 68.9502, GNorm = 2.8903, lr_0 = 1.6810e-04
Loss = 1.5167e-03, PNorm = 68.9591, GNorm = 0.3948, lr_0 = 1.6098e-04
Validation rmse = 1.188182
Epoch 23
Loss = 1.5282e-03, PNorm = 68.9668, GNorm = 1.9656, lr_0 = 1.5416e-04
Loss = 1.5950e-03, PNorm = 68.9734, GNorm = 1.1265, lr_0 = 1.4763e-04
Loss = 2.7412e-03, PNorm = 68.9742, GNorm = 0.8957, lr_0 = 1.4699e-04
Validation rmse = 1.085623
Epoch 24
Loss = 1.5549e-03, PNorm = 68.9804, GNorm = 0.7794, lr_0 = 1.4077e-04
Loss = 1.6039e-03, PNorm = 68.9880, GNorm = 0.7367, lr_0 = 1.3480e-04
Validation rmse = 1.135059
Epoch 25
Loss = 1.4264e-03, PNorm = 68.9946, GNorm = 0.4752, lr_0 = 1.2909e-04
Loss = 1.6198e-03, PNorm = 69.0011, GNorm = 1.6043, lr_0 = 1.2362e-04
Validation rmse = 1.106243
Epoch 26
Loss = 1.5624e-03, PNorm = 69.0052, GNorm = 1.1369, lr_0 = 1.1839e-04
Validation rmse = 1.179777
Epoch 27
Loss = 2.5191e-03, PNorm = 69.0111, GNorm = 1.3697, lr_0 = 1.1288e-04
Loss = 1.4983e-03, PNorm = 69.0187, GNorm = 0.3959, lr_0 = 1.0810e-04
Validation rmse = 1.115965
Epoch 28
Loss = 1.7211e-03, PNorm = 69.0206, GNorm = 1.5393, lr_0 = 1.0352e-04
Loss = 1.2505e-03, PNorm = 69.0271, GNorm = 0.3942, lr_0 = 1.0000e-04
Validation rmse = 1.109835
Epoch 29
Loss = 1.4276e-03, PNorm = 69.0331, GNorm = 0.5195, lr_0 = 1.0000e-04
Loss = 1.2000e-03, PNorm = 69.0362, GNorm = 0.5431, lr_0 = 1.0000e-04
Validation rmse = 1.117836
Model 0 best validation rmse = 1.050646 on epoch 17
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.983591
Ensemble test rmse = 0.983591
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_2_dropout_0.30000000000000004_ffn_num_layers_2_hidden_size_1400/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 49 | test scaffolds = 62
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=1404, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,281,801
Moving model to cuda
Epoch 0
Loss = 1.6324e-02, PNorm = 67.3577, GNorm = 3.5422, lr_0 = 3.6053e-04
Validation rmse = 1.087757
Epoch 1
Loss = 6.0119e-03, PNorm = 67.4419, GNorm = 1.7101, lr_0 = 6.2105e-04
Loss = 6.9195e-03, PNorm = 67.5428, GNorm = 5.7122, lr_0 = 8.5789e-04
Validation rmse = 1.148755
Epoch 2
Loss = 5.9059e-03, PNorm = 67.6575, GNorm = 2.7614, lr_0 = 9.8284e-04
Loss = 4.9466e-03, PNorm = 67.7562, GNorm = 1.4420, lr_0 = 9.4120e-04
Validation rmse = 1.194524
Epoch 3
Loss = 4.3868e-03, PNorm = 67.8386, GNorm = 2.7263, lr_0 = 8.9744e-04
Loss = 4.0741e-03, PNorm = 67.9067, GNorm = 1.4040, lr_0 = 8.5943e-04
Validation rmse = 1.052010
Epoch 4
Loss = 5.8213e-03, PNorm = 67.9686, GNorm = 3.6906, lr_0 = 8.2303e-04
Loss = 3.8648e-03, PNorm = 68.0385, GNorm = 2.4282, lr_0 = 7.8816e-04
Validation rmse = 0.898269
Epoch 5
Loss = 2.9421e-03, PNorm = 68.0912, GNorm = 0.7439, lr_0 = 7.5478e-04
Loss = 3.0784e-03, PNorm = 68.1434, GNorm = 0.8070, lr_0 = 7.2281e-04
Validation rmse = 0.958483
Epoch 6
Loss = 2.5292e-03, PNorm = 68.1946, GNorm = 0.7474, lr_0 = 6.8920e-04
Loss = 2.9927e-03, PNorm = 68.2450, GNorm = 0.7961, lr_0 = 6.6001e-04
Validation rmse = 1.023746
Epoch 7
Loss = 2.3918e-03, PNorm = 68.2904, GNorm = 2.3214, lr_0 = 6.3205e-04
Loss = 3.1761e-03, PNorm = 68.3317, GNorm = 0.7343, lr_0 = 6.0528e-04
Validation rmse = 1.545455
Epoch 8
Loss = 3.2040e-03, PNorm = 68.3755, GNorm = 1.6008, lr_0 = 5.7714e-04
Loss = 2.4180e-03, PNorm = 68.4094, GNorm = 1.0591, lr_0 = 5.5269e-04
Validation rmse = 0.945664
Epoch 9
Loss = 1.4756e-03, PNorm = 68.4416, GNorm = 0.4323, lr_0 = 5.2928e-04
Loss = 2.4522e-03, PNorm = 68.4696, GNorm = 0.9028, lr_0 = 5.0686e-04
Validation rmse = 0.947361
Epoch 10
Loss = 2.2180e-03, PNorm = 68.4964, GNorm = 0.9612, lr_0 = 4.8539e-04
Loss = 2.3493e-03, PNorm = 68.5242, GNorm = 0.9578, lr_0 = 4.6483e-04
Validation rmse = 1.164077
Epoch 11
Loss = 2.3331e-03, PNorm = 68.5507, GNorm = 2.0846, lr_0 = 4.4322e-04
Loss = 2.3442e-03, PNorm = 68.5782, GNorm = 0.8816, lr_0 = 4.2444e-04
Validation rmse = 0.947760
Epoch 12
Loss = 1.5219e-03, PNorm = 68.6076, GNorm = 1.1401, lr_0 = 4.0646e-04
Loss = 2.2817e-03, PNorm = 68.6279, GNorm = 1.1715, lr_0 = 3.8925e-04
Validation rmse = 1.293978
Epoch 13
Loss = 2.0385e-03, PNorm = 68.6484, GNorm = 0.8137, lr_0 = 3.7276e-04
Loss = 2.2921e-03, PNorm = 68.6707, GNorm = 1.7563, lr_0 = 3.5697e-04
Validation rmse = 0.973312
Epoch 14
Loss = 1.8486e-03, PNorm = 68.6889, GNorm = 1.0217, lr_0 = 3.4037e-04
Loss = 1.9033e-03, PNorm = 68.7054, GNorm = 1.3145, lr_0 = 3.2596e-04
Validation rmse = 0.934489
Epoch 15
Loss = 1.7071e-03, PNorm = 68.7232, GNorm = 1.4416, lr_0 = 3.1215e-04
Loss = 2.0243e-03, PNorm = 68.7367, GNorm = 0.7124, lr_0 = 2.9893e-04
Validation rmse = 1.258452
Epoch 16
Loss = 2.1489e-03, PNorm = 68.7543, GNorm = 1.6306, lr_0 = 2.8503e-04
Loss = 1.9901e-03, PNorm = 68.7647, GNorm = 1.8069, lr_0 = 2.7295e-04
Validation rmse = 1.009097
Epoch 17
Loss = 1.6078e-03, PNorm = 68.7789, GNorm = 0.6023, lr_0 = 2.6139e-04
Loss = 1.9350e-03, PNorm = 68.7897, GNorm = 1.0413, lr_0 = 2.5032e-04
Validation rmse = 0.994142
Epoch 18
Loss = 1.9092e-03, PNorm = 68.8020, GNorm = 0.5569, lr_0 = 2.3972e-04
Loss = 1.4718e-03, PNorm = 68.8153, GNorm = 0.5824, lr_0 = 2.2956e-04
Validation rmse = 1.037873
Epoch 19
Loss = 1.7362e-03, PNorm = 68.8254, GNorm = 1.1448, lr_0 = 2.1889e-04
Loss = 1.8437e-03, PNorm = 68.8359, GNorm = 1.9607, lr_0 = 2.0962e-04
Validation rmse = 1.135958
Epoch 20
Loss = 1.7611e-03, PNorm = 68.8430, GNorm = 1.0454, lr_0 = 2.0074e-04
Loss = 1.6764e-03, PNorm = 68.8502, GNorm = 2.8609, lr_0 = 1.9224e-04
Validation rmse = 1.116888
Epoch 21
Loss = 1.9044e-03, PNorm = 68.8581, GNorm = 1.0997, lr_0 = 1.8409e-04
Loss = 1.6654e-03, PNorm = 68.8650, GNorm = 0.8876, lr_0 = 1.7630e-04
Validation rmse = 1.079920
Epoch 22
Loss = 1.6843e-03, PNorm = 68.8726, GNorm = 1.2601, lr_0 = 1.6810e-04
Loss = 1.7096e-03, PNorm = 68.8813, GNorm = 1.1496, lr_0 = 1.6098e-04
Validation rmse = 1.110281
Epoch 23
Loss = 1.6918e-03, PNorm = 68.8864, GNorm = 1.2388, lr_0 = 1.5416e-04
Loss = 1.3701e-03, PNorm = 68.8936, GNorm = 0.5952, lr_0 = 1.4763e-04
Loss = 1.6351e-03, PNorm = 68.8945, GNorm = 0.6442, lr_0 = 1.4699e-04
Validation rmse = 0.934768
Epoch 24
Loss = 1.4843e-03, PNorm = 68.9007, GNorm = 1.0246, lr_0 = 1.4077e-04
Loss = 2.0108e-03, PNorm = 68.9053, GNorm = 1.1520, lr_0 = 1.3480e-04
Validation rmse = 1.218424
Epoch 25
Loss = 1.5744e-03, PNorm = 68.9103, GNorm = 0.6631, lr_0 = 1.2909e-04
Loss = 1.7879e-03, PNorm = 68.9151, GNorm = 1.6833, lr_0 = 1.2362e-04
Validation rmse = 0.968717
Epoch 26
Loss = 1.3851e-03, PNorm = 68.9212, GNorm = 0.6144, lr_0 = 1.1839e-04
Validation rmse = 1.013382
Epoch 27
Loss = 1.2538e-03, PNorm = 68.9262, GNorm = 1.0372, lr_0 = 1.1288e-04
Loss = 1.4852e-03, PNorm = 68.9288, GNorm = 1.5115, lr_0 = 1.0810e-04
Validation rmse = 0.923989
Epoch 28
Loss = 8.7521e-04, PNorm = 68.9343, GNorm = 1.0584, lr_0 = 1.0352e-04
Loss = 1.6230e-03, PNorm = 68.9386, GNorm = 0.6192, lr_0 = 1.0000e-04
Validation rmse = 1.044877
Epoch 29
Loss = 1.1013e-03, PNorm = 68.9443, GNorm = 0.9384, lr_0 = 1.0000e-04
Loss = 1.4867e-03, PNorm = 68.9498, GNorm = 1.6716, lr_0 = 1.0000e-04
Validation rmse = 0.947987
Model 0 best validation rmse = 0.898269 on epoch 4
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.205621
Ensemble test rmse = 1.205621
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_2_dropout_0.30000000000000004_ffn_num_layers_2_hidden_size_1400/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total scaffolds = 195 | train scaffolds = 94 | val scaffolds = 55 | test scaffolds = 46
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=1404, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,281,801
Moving model to cuda
Epoch 0
Loss = 1.5252e-02, PNorm = 67.3602, GNorm = 5.4289, lr_0 = 3.6053e-04
Validation rmse = 1.465888
Epoch 1
Loss = 5.8248e-03, PNorm = 67.4418, GNorm = 2.2211, lr_0 = 6.2105e-04
Loss = 5.6797e-03, PNorm = 67.5362, GNorm = 1.4112, lr_0 = 8.5789e-04
Validation rmse = 1.395668
Epoch 2
Loss = 6.0476e-03, PNorm = 67.6630, GNorm = 1.8640, lr_0 = 9.8284e-04
Loss = 4.8777e-03, PNorm = 67.7756, GNorm = 1.8099, lr_0 = 9.4120e-04
Validation rmse = 1.498051
Epoch 3
Loss = 4.8252e-03, PNorm = 67.8723, GNorm = 1.0346, lr_0 = 8.9744e-04
Loss = 4.8916e-03, PNorm = 67.9549, GNorm = 0.8094, lr_0 = 8.5943e-04
Validation rmse = 1.335522
Epoch 4
Loss = 3.6183e-03, PNorm = 68.0130, GNorm = 1.3724, lr_0 = 8.2303e-04
Loss = 3.6796e-03, PNorm = 68.0721, GNorm = 1.8985, lr_0 = 7.8816e-04
Validation rmse = 1.199712
Epoch 5
Loss = 2.3420e-03, PNorm = 68.1234, GNorm = 0.8575, lr_0 = 7.5478e-04
Loss = 3.6319e-03, PNorm = 68.1710, GNorm = 1.3030, lr_0 = 7.2281e-04
Validation rmse = 1.279931
Epoch 6
Loss = 3.1616e-03, PNorm = 68.2234, GNorm = 0.7461, lr_0 = 6.8920e-04
Loss = 2.9488e-03, PNorm = 68.2792, GNorm = 1.0804, lr_0 = 6.6001e-04
Validation rmse = 1.211988
Epoch 7
Loss = 2.9437e-03, PNorm = 68.3109, GNorm = 1.2617, lr_0 = 6.3205e-04
Loss = 2.8006e-03, PNorm = 68.3495, GNorm = 0.7741, lr_0 = 6.0528e-04
Validation rmse = 1.097882
Epoch 8
Loss = 3.1537e-03, PNorm = 68.3894, GNorm = 0.7467, lr_0 = 5.7714e-04
Loss = 3.0344e-03, PNorm = 68.4254, GNorm = 1.8787, lr_0 = 5.5269e-04
Validation rmse = 1.270462
Epoch 9
Loss = 2.2916e-03, PNorm = 68.4539, GNorm = 1.2217, lr_0 = 5.2928e-04
Loss = 2.6820e-03, PNorm = 68.4833, GNorm = 0.5548, lr_0 = 5.0686e-04
Validation rmse = 1.205722
Epoch 10
Loss = 2.3721e-03, PNorm = 68.5135, GNorm = 0.6607, lr_0 = 4.8539e-04
Loss = 2.5273e-03, PNorm = 68.5453, GNorm = 2.8674, lr_0 = 4.6483e-04
Validation rmse = 1.294280
Epoch 11
Loss = 2.0514e-03, PNorm = 68.5750, GNorm = 1.4574, lr_0 = 4.4322e-04
Loss = 2.1972e-03, PNorm = 68.6018, GNorm = 1.3960, lr_0 = 4.2444e-04
Validation rmse = 1.189744
Epoch 12
Loss = 1.9375e-03, PNorm = 68.6244, GNorm = 1.2907, lr_0 = 4.0646e-04
Loss = 2.4134e-03, PNorm = 68.6457, GNorm = 1.1298, lr_0 = 3.8925e-04
Validation rmse = 1.157230
Epoch 13
Loss = 2.0033e-03, PNorm = 68.6652, GNorm = 0.6877, lr_0 = 3.7276e-04
Loss = 2.2847e-03, PNorm = 68.6795, GNorm = 1.7197, lr_0 = 3.5697e-04
Validation rmse = 1.514088
Epoch 14
Loss = 2.9233e-03, PNorm = 68.7021, GNorm = 2.9936, lr_0 = 3.4037e-04
Loss = 2.2338e-03, PNorm = 68.7227, GNorm = 1.8523, lr_0 = 3.2596e-04
Validation rmse = 1.346901
Epoch 15
Loss = 2.2127e-03, PNorm = 68.7429, GNorm = 1.9749, lr_0 = 3.1215e-04
Loss = 2.2679e-03, PNorm = 68.7627, GNorm = 1.2135, lr_0 = 2.9893e-04
Validation rmse = 1.200024
Epoch 16
Loss = 2.0568e-03, PNorm = 68.7754, GNorm = 1.1829, lr_0 = 2.8503e-04
Loss = 1.8958e-03, PNorm = 68.7887, GNorm = 0.7380, lr_0 = 2.7295e-04
Validation rmse = 1.204439
Epoch 17
Loss = 1.8280e-03, PNorm = 68.8040, GNorm = 0.5999, lr_0 = 2.6139e-04
Loss = 1.9437e-03, PNorm = 68.8144, GNorm = 0.9857, lr_0 = 2.5032e-04
Validation rmse = 1.200480
Epoch 18
Loss = 2.0593e-03, PNorm = 68.8254, GNorm = 1.1975, lr_0 = 2.3972e-04
Loss = 1.7294e-03, PNorm = 68.8399, GNorm = 1.1403, lr_0 = 2.2956e-04
Validation rmse = 1.120693
Epoch 19
Loss = 1.6084e-03, PNorm = 68.8454, GNorm = 1.8690, lr_0 = 2.1889e-04
Loss = 1.8196e-03, PNorm = 68.8584, GNorm = 1.3003, lr_0 = 2.0962e-04
Validation rmse = 1.116273
Epoch 20
Loss = 1.7796e-03, PNorm = 68.8678, GNorm = 0.9244, lr_0 = 2.0074e-04
Loss = 1.8461e-03, PNorm = 68.8786, GNorm = 1.7392, lr_0 = 1.9224e-04
Validation rmse = 1.199262
Epoch 21
Loss = 1.6257e-03, PNorm = 68.8847, GNorm = 1.5541, lr_0 = 1.8409e-04
Loss = 2.0388e-03, PNorm = 68.8958, GNorm = 2.1298, lr_0 = 1.7630e-04
Validation rmse = 1.125138
Epoch 22
Loss = 1.5802e-03, PNorm = 68.9038, GNorm = 0.8386, lr_0 = 1.6810e-04
Loss = 1.6542e-03, PNorm = 68.9126, GNorm = 0.6881, lr_0 = 1.6098e-04
Validation rmse = 1.157750
Epoch 23
Loss = 1.6077e-03, PNorm = 68.9206, GNorm = 0.8209, lr_0 = 1.5416e-04
Loss = 1.5603e-03, PNorm = 68.9253, GNorm = 0.6548, lr_0 = 1.4763e-04
Loss = 7.4652e-04, PNorm = 68.9259, GNorm = 0.4170, lr_0 = 1.4699e-04
Validation rmse = 1.199777
Epoch 24
Loss = 1.4982e-03, PNorm = 68.9334, GNorm = 0.4619, lr_0 = 1.4077e-04
Loss = 1.6416e-03, PNorm = 68.9398, GNorm = 0.8702, lr_0 = 1.3480e-04
Validation rmse = 1.194013
Epoch 25
Loss = 1.6359e-03, PNorm = 68.9460, GNorm = 1.0048, lr_0 = 1.2909e-04
Loss = 1.7066e-03, PNorm = 68.9529, GNorm = 1.9575, lr_0 = 1.2362e-04
Validation rmse = 1.171792
Epoch 26
Loss = 1.5880e-03, PNorm = 68.9578, GNorm = 0.8957, lr_0 = 1.1839e-04
Validation rmse = 1.132481
Epoch 27
Loss = 1.7470e-03, PNorm = 68.9639, GNorm = 0.6143, lr_0 = 1.1288e-04
Loss = 1.5049e-03, PNorm = 68.9688, GNorm = 0.6929, lr_0 = 1.0810e-04
Validation rmse = 1.162003
Epoch 28
Loss = 1.0934e-03, PNorm = 68.9743, GNorm = 0.6217, lr_0 = 1.0352e-04
Loss = 1.5563e-03, PNorm = 68.9783, GNorm = 1.0676, lr_0 = 1.0000e-04
Validation rmse = 1.117674
Epoch 29
Loss = 1.8020e-03, PNorm = 68.9834, GNorm = 1.0031, lr_0 = 1.0000e-04
Loss = 1.3809e-03, PNorm = 68.9891, GNorm = 0.5703, lr_0 = 1.0000e-04
Validation rmse = 1.105275
Model 0 best validation rmse = 1.097882 on epoch 7
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.187309
Ensemble test rmse = 1.187309
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_2_dropout_0.30000000000000004_ffn_num_layers_2_hidden_size_1400/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total scaffolds = 195 | train scaffolds = 64 | val scaffolds = 68 | test scaffolds = 63
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=1404, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,281,801
Moving model to cuda
Epoch 0
Loss = 1.6445e-02, PNorm = 67.3598, GNorm = 4.6949, lr_0 = 3.6053e-04
Validation rmse = 1.742949
Epoch 1
Loss = 9.6610e-03, PNorm = 67.4363, GNorm = 5.9729, lr_0 = 6.2105e-04
Loss = 5.8437e-03, PNorm = 67.5323, GNorm = 1.2109, lr_0 = 8.5789e-04
Validation rmse = 1.336159
Epoch 2
Loss = 6.7039e-03, PNorm = 67.6424, GNorm = 3.5041, lr_0 = 9.8284e-04
Loss = 4.9277e-03, PNorm = 67.7460, GNorm = 1.2705, lr_0 = 9.4120e-04
Validation rmse = 1.249969
Epoch 3
Loss = 4.0409e-03, PNorm = 67.8501, GNorm = 3.6443, lr_0 = 8.9744e-04
Loss = 4.3391e-03, PNorm = 67.9299, GNorm = 1.1764, lr_0 = 8.5943e-04
Validation rmse = 1.185614
Epoch 4
Loss = 3.5287e-03, PNorm = 68.0063, GNorm = 0.7783, lr_0 = 8.2303e-04
Loss = 3.8497e-03, PNorm = 68.0761, GNorm = 1.7006, lr_0 = 7.8816e-04
Validation rmse = 1.173466
Epoch 5
Loss = 3.7824e-03, PNorm = 68.1289, GNorm = 1.3023, lr_0 = 7.5478e-04
Loss = 2.8744e-03, PNorm = 68.1674, GNorm = 0.7776, lr_0 = 7.2281e-04
Validation rmse = 1.497003
Epoch 6
Loss = 3.6915e-03, PNorm = 68.2114, GNorm = 0.8473, lr_0 = 6.8920e-04
Loss = 3.6199e-03, PNorm = 68.2618, GNorm = 1.5079, lr_0 = 6.6001e-04
Validation rmse = 1.048035
Epoch 7
Loss = 2.9272e-03, PNorm = 68.3113, GNorm = 1.1911, lr_0 = 6.3205e-04
Loss = 2.8792e-03, PNorm = 68.3592, GNorm = 2.0411, lr_0 = 6.0528e-04
Validation rmse = 1.043780
Epoch 8
Loss = 2.6043e-03, PNorm = 68.3985, GNorm = 0.5085, lr_0 = 5.7714e-04
Loss = 2.5722e-03, PNorm = 68.4345, GNorm = 0.9459, lr_0 = 5.5269e-04
Validation rmse = 1.253011
Epoch 9
Loss = 2.6244e-03, PNorm = 68.4652, GNorm = 0.8836, lr_0 = 5.2928e-04
Loss = 2.1914e-03, PNorm = 68.4980, GNorm = 0.7602, lr_0 = 5.0686e-04
Validation rmse = 1.038259
Epoch 10
Loss = 2.8805e-03, PNorm = 68.5361, GNorm = 0.7781, lr_0 = 4.8539e-04
Loss = 1.9985e-03, PNorm = 68.5689, GNorm = 1.2207, lr_0 = 4.6483e-04
Validation rmse = 1.070194
Epoch 11
Loss = 2.4308e-03, PNorm = 68.5964, GNorm = 1.0960, lr_0 = 4.4322e-04
Loss = 2.1747e-03, PNorm = 68.6223, GNorm = 1.4636, lr_0 = 4.2444e-04
Validation rmse = 1.024470
Epoch 12
Loss = 2.1179e-03, PNorm = 68.6444, GNorm = 1.5223, lr_0 = 4.0646e-04
Loss = 2.2360e-03, PNorm = 68.6650, GNorm = 0.7741, lr_0 = 3.8925e-04
Validation rmse = 1.108018
Epoch 13
Loss = 1.8073e-03, PNorm = 68.6891, GNorm = 0.6150, lr_0 = 3.7276e-04
Loss = 2.3202e-03, PNorm = 68.7165, GNorm = 2.0952, lr_0 = 3.5697e-04
Validation rmse = 1.364485
Epoch 14
Loss = 1.9397e-03, PNorm = 68.7395, GNorm = 0.6249, lr_0 = 3.4037e-04
Loss = 2.1826e-03, PNorm = 68.7640, GNorm = 1.1138, lr_0 = 3.2596e-04
Validation rmse = 1.061838
Epoch 15
Loss = 1.9227e-03, PNorm = 68.7809, GNorm = 1.1302, lr_0 = 3.1215e-04
Loss = 1.7882e-03, PNorm = 68.7970, GNorm = 1.5547, lr_0 = 2.9893e-04
Validation rmse = 1.062982
Epoch 16
Loss = 1.7199e-03, PNorm = 68.8177, GNorm = 0.6929, lr_0 = 2.8503e-04
Loss = 1.7834e-03, PNorm = 68.8286, GNorm = 1.5062, lr_0 = 2.7295e-04
Validation rmse = 1.170800
Epoch 17
Loss = 2.0233e-03, PNorm = 68.8444, GNorm = 0.4787, lr_0 = 2.6139e-04
Loss = 1.7480e-03, PNorm = 68.8547, GNorm = 1.7669, lr_0 = 2.5032e-04
Validation rmse = 1.146719
Epoch 18
Loss = 2.2158e-03, PNorm = 68.8693, GNorm = 1.7319, lr_0 = 2.3972e-04
Loss = 1.8976e-03, PNorm = 68.8862, GNorm = 1.1620, lr_0 = 2.2956e-04
Validation rmse = 1.119750
Epoch 19
Loss = 1.5601e-03, PNorm = 68.9026, GNorm = 0.4677, lr_0 = 2.1889e-04
Loss = 1.7288e-03, PNorm = 68.9122, GNorm = 0.6260, lr_0 = 2.0962e-04
Validation rmse = 1.095480
Epoch 20
Loss = 1.8036e-03, PNorm = 68.9246, GNorm = 0.6415, lr_0 = 2.0074e-04
Loss = 1.6562e-03, PNorm = 68.9325, GNorm = 1.2060, lr_0 = 1.9224e-04
Validation rmse = 1.122312
Epoch 21
Loss = 1.4091e-03, PNorm = 68.9449, GNorm = 0.7988, lr_0 = 1.8409e-04
Loss = 1.4664e-03, PNorm = 68.9551, GNorm = 0.5451, lr_0 = 1.7630e-04
Validation rmse = 1.068257
Epoch 22
Loss = 1.5389e-03, PNorm = 68.9637, GNorm = 0.6011, lr_0 = 1.6810e-04
Loss = 1.3697e-03, PNorm = 68.9703, GNorm = 0.4688, lr_0 = 1.6098e-04
Validation rmse = 1.099813
Epoch 23
Loss = 1.5391e-03, PNorm = 68.9786, GNorm = 0.6946, lr_0 = 1.5416e-04
Loss = 1.4216e-03, PNorm = 68.9854, GNorm = 0.5835, lr_0 = 1.4763e-04
Loss = 3.7012e-03, PNorm = 68.9856, GNorm = 1.6595, lr_0 = 1.4699e-04
Validation rmse = 1.061110
Epoch 24
Loss = 1.4372e-03, PNorm = 68.9915, GNorm = 1.0014, lr_0 = 1.4077e-04
Loss = 1.5327e-03, PNorm = 69.0021, GNorm = 1.1185, lr_0 = 1.3480e-04
Validation rmse = 1.145057
Epoch 25
Loss = 1.4257e-03, PNorm = 69.0053, GNorm = 1.6061, lr_0 = 1.2909e-04
Loss = 1.4460e-03, PNorm = 69.0119, GNorm = 0.9536, lr_0 = 1.2362e-04
Validation rmse = 1.063696
Epoch 26
Loss = 1.3354e-03, PNorm = 69.0173, GNorm = 0.5126, lr_0 = 1.1839e-04
Validation rmse = 1.095396
Epoch 27
Loss = 1.4506e-03, PNorm = 69.0226, GNorm = 0.8337, lr_0 = 1.1288e-04
Loss = 1.1656e-03, PNorm = 69.0256, GNorm = 0.7331, lr_0 = 1.0810e-04
Validation rmse = 1.053454
Epoch 28
Loss = 1.4299e-03, PNorm = 69.0313, GNorm = 1.3934, lr_0 = 1.0352e-04
Loss = 1.4633e-03, PNorm = 69.0362, GNorm = 0.9899, lr_0 = 1.0000e-04
Validation rmse = 1.150711
Epoch 29
Loss = 1.6402e-03, PNorm = 69.0415, GNorm = 1.2549, lr_0 = 1.0000e-04
Loss = 1.3833e-03, PNorm = 69.0481, GNorm = 0.9380, lr_0 = 1.0000e-04
Validation rmse = 1.116948
Model 0 best validation rmse = 1.024470 on epoch 11
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.901034
Ensemble test rmse = 0.901034
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_2_dropout_0.30000000000000004_ffn_num_layers_2_hidden_size_1400/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total scaffolds = 195 | train scaffolds = 69 | val scaffolds = 65 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=1404, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,281,801
Moving model to cuda
Epoch 0
Loss = 1.6350e-02, PNorm = 67.3628, GNorm = 10.0534, lr_0 = 3.6053e-04
Validation rmse = 2.431141
Epoch 1
Loss = 1.1938e-02, PNorm = 67.4408, GNorm = 6.8111, lr_0 = 6.2105e-04
Loss = 6.5422e-03, PNorm = 67.5459, GNorm = 1.8121, lr_0 = 8.5789e-04
Validation rmse = 1.344874
Epoch 2
Loss = 4.4867e-03, PNorm = 67.6585, GNorm = 1.2339, lr_0 = 9.8284e-04
Loss = 4.6090e-03, PNorm = 67.7569, GNorm = 1.1085, lr_0 = 9.4120e-04
Validation rmse = 2.076817
Epoch 3
Loss = 4.9114e-03, PNorm = 67.8430, GNorm = 0.6416, lr_0 = 8.9744e-04
Loss = 4.6891e-03, PNorm = 67.9207, GNorm = 2.5531, lr_0 = 8.5943e-04
Validation rmse = 1.301941
Epoch 4
Loss = 3.1842e-03, PNorm = 67.9845, GNorm = 1.2656, lr_0 = 8.2303e-04
Loss = 3.3546e-03, PNorm = 68.0472, GNorm = 1.8115, lr_0 = 7.8816e-04
Validation rmse = 1.279626
Epoch 5
Loss = 2.9456e-03, PNorm = 68.1001, GNorm = 0.9008, lr_0 = 7.5478e-04
Loss = 3.0028e-03, PNorm = 68.1511, GNorm = 1.0300, lr_0 = 7.2281e-04
Validation rmse = 1.329140
Epoch 6
Loss = 2.8912e-03, PNorm = 68.2055, GNorm = 1.1964, lr_0 = 6.8920e-04
Loss = 2.7933e-03, PNorm = 68.2535, GNorm = 1.0010, lr_0 = 6.6001e-04
Validation rmse = 1.329590
Epoch 7
Loss = 2.7662e-03, PNorm = 68.2974, GNorm = 3.4219, lr_0 = 6.3205e-04
Loss = 3.4915e-03, PNorm = 68.3413, GNorm = 1.1258, lr_0 = 6.0528e-04
Validation rmse = 1.270029
Epoch 8
Loss = 2.5254e-03, PNorm = 68.3814, GNorm = 1.0877, lr_0 = 5.7714e-04
Loss = 3.0997e-03, PNorm = 68.4173, GNorm = 0.6474, lr_0 = 5.5269e-04
Validation rmse = 1.301800
Epoch 9
Loss = 2.7198e-03, PNorm = 68.4483, GNorm = 0.6014, lr_0 = 5.2928e-04
Loss = 2.7204e-03, PNorm = 68.4860, GNorm = 1.3333, lr_0 = 5.0686e-04
Validation rmse = 1.635627
Epoch 10
Loss = 2.6246e-03, PNorm = 68.5091, GNorm = 1.6874, lr_0 = 4.8539e-04
Loss = 2.3660e-03, PNorm = 68.5431, GNorm = 0.6720, lr_0 = 4.6483e-04
Validation rmse = 1.335853
Epoch 11
Loss = 2.7028e-03, PNorm = 68.5724, GNorm = 0.8672, lr_0 = 4.4322e-04
Loss = 1.9639e-03, PNorm = 68.6011, GNorm = 0.9475, lr_0 = 4.2444e-04
Validation rmse = 1.403661
Epoch 12
Loss = 2.1866e-03, PNorm = 68.6222, GNorm = 0.8589, lr_0 = 4.0646e-04
Loss = 2.1013e-03, PNorm = 68.6414, GNorm = 0.7595, lr_0 = 3.8925e-04
Validation rmse = 1.193684
Epoch 13
Loss = 2.5863e-03, PNorm = 68.6618, GNorm = 1.4541, lr_0 = 3.7276e-04
Loss = 2.5438e-03, PNorm = 68.6826, GNorm = 1.6143, lr_0 = 3.5697e-04
Validation rmse = 1.296515
Epoch 14
Loss = 1.9442e-03, PNorm = 68.7078, GNorm = 0.4914, lr_0 = 3.4037e-04
Loss = 2.3031e-03, PNorm = 68.7261, GNorm = 2.3111, lr_0 = 3.2596e-04
Validation rmse = 1.302590
Epoch 15
Loss = 2.1125e-03, PNorm = 68.7444, GNorm = 1.9052, lr_0 = 3.1215e-04
Loss = 2.3294e-03, PNorm = 68.7662, GNorm = 0.8849, lr_0 = 2.9893e-04
Validation rmse = 1.499065
Epoch 16
Loss = 1.8838e-03, PNorm = 68.7840, GNorm = 0.8620, lr_0 = 2.8503e-04
Loss = 2.0724e-03, PNorm = 68.7958, GNorm = 0.6191, lr_0 = 2.7295e-04
Validation rmse = 1.622149
Epoch 17
Loss = 1.7662e-03, PNorm = 68.8073, GNorm = 0.6657, lr_0 = 2.6139e-04
Loss = 1.7063e-03, PNorm = 68.8182, GNorm = 0.9067, lr_0 = 2.5032e-04
Validation rmse = 1.370979
Epoch 18
Loss = 1.5690e-03, PNorm = 68.8294, GNorm = 1.1961, lr_0 = 2.3972e-04
Loss = 1.8427e-03, PNorm = 68.8391, GNorm = 0.5424, lr_0 = 2.2956e-04
Validation rmse = 1.389159
Epoch 19
Loss = 1.9298e-03, PNorm = 68.8479, GNorm = 2.1474, lr_0 = 2.1889e-04
Loss = 1.6727e-03, PNorm = 68.8610, GNorm = 0.6313, lr_0 = 2.0962e-04
Validation rmse = 1.368781
Epoch 20
Loss = 1.7445e-03, PNorm = 68.8705, GNorm = 0.6236, lr_0 = 2.0074e-04
Loss = 1.6428e-03, PNorm = 68.8766, GNorm = 0.9703, lr_0 = 1.9224e-04
Validation rmse = 1.464337
Epoch 21
Loss = 1.5443e-03, PNorm = 68.8873, GNorm = 0.6843, lr_0 = 1.8409e-04
Loss = 1.5713e-03, PNorm = 68.8965, GNorm = 0.7231, lr_0 = 1.7630e-04
Validation rmse = 1.556064
Epoch 22
Loss = 1.6503e-03, PNorm = 68.9033, GNorm = 1.9322, lr_0 = 1.6810e-04
Loss = 1.7964e-03, PNorm = 68.9130, GNorm = 1.4754, lr_0 = 1.6098e-04
Validation rmse = 1.408197
Epoch 23
Loss = 1.5289e-03, PNorm = 68.9216, GNorm = 0.7262, lr_0 = 1.5416e-04
Loss = 1.5575e-03, PNorm = 68.9306, GNorm = 0.6363, lr_0 = 1.4763e-04
Loss = 3.7018e-03, PNorm = 68.9311, GNorm = 2.2281, lr_0 = 1.4699e-04
Validation rmse = 1.300159
Epoch 24
Loss = 1.7571e-03, PNorm = 68.9350, GNorm = 1.2181, lr_0 = 1.4077e-04
Loss = 1.9714e-03, PNorm = 68.9442, GNorm = 1.4870, lr_0 = 1.3480e-04
Validation rmse = 1.413159
Epoch 25
Loss = 1.3814e-03, PNorm = 68.9511, GNorm = 0.8404, lr_0 = 1.2909e-04
Loss = 1.7349e-03, PNorm = 68.9562, GNorm = 2.0806, lr_0 = 1.2362e-04
Validation rmse = 1.342508
Epoch 26
Loss = 1.4853e-03, PNorm = 68.9611, GNorm = 0.6875, lr_0 = 1.1839e-04
Validation rmse = 1.488772
Epoch 27
Loss = 9.4084e-04, PNorm = 68.9667, GNorm = 0.9722, lr_0 = 1.1288e-04
Loss = 1.3675e-03, PNorm = 68.9724, GNorm = 0.8538, lr_0 = 1.0810e-04
Validation rmse = 1.457283
Epoch 28
Loss = 2.4177e-03, PNorm = 68.9766, GNorm = 0.7653, lr_0 = 1.0352e-04
Loss = 1.2693e-03, PNorm = 68.9823, GNorm = 0.6106, lr_0 = 1.0000e-04
Validation rmse = 1.402602
Epoch 29
Loss = 1.9542e-03, PNorm = 68.9881, GNorm = 1.2809, lr_0 = 1.0000e-04
Loss = 1.3296e-03, PNorm = 68.9915, GNorm = 0.6604, lr_0 = 1.0000e-04
Validation rmse = 1.499326
Model 0 best validation rmse = 1.193684 on epoch 12
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.007430
Ensemble test rmse = 1.007430
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_2_dropout_0.30000000000000004_ffn_num_layers_2_hidden_size_1400/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total scaffolds = 195 | train scaffolds = 75 | val scaffolds = 42 | test scaffolds = 78
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=1404, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,281,801
Moving model to cuda
Epoch 0
Loss = 1.5132e-02, PNorm = 67.3611, GNorm = 4.5115, lr_0 = 3.6053e-04
Validation rmse = 1.408249
Epoch 1
Loss = 7.2079e-03, PNorm = 67.4383, GNorm = 4.7896, lr_0 = 6.2105e-04
Loss = 6.4229e-03, PNorm = 67.5354, GNorm = 1.8389, lr_0 = 8.5789e-04
Validation rmse = 1.294125
Epoch 2
Loss = 7.2966e-03, PNorm = 67.6517, GNorm = 3.8405, lr_0 = 9.8284e-04
Loss = 5.0577e-03, PNorm = 67.7600, GNorm = 1.1785, lr_0 = 9.4120e-04
Validation rmse = 1.227445
Epoch 3
Loss = 4.2536e-03, PNorm = 67.8545, GNorm = 1.5971, lr_0 = 8.9744e-04
Loss = 3.7275e-03, PNorm = 67.9328, GNorm = 0.8916, lr_0 = 8.5943e-04
Validation rmse = 1.119217
Epoch 4
Loss = 3.7436e-03, PNorm = 67.9993, GNorm = 1.5419, lr_0 = 8.2303e-04
Loss = 3.2989e-03, PNorm = 68.0527, GNorm = 0.8898, lr_0 = 7.8816e-04
Validation rmse = 1.175533
Epoch 5
Loss = 2.4992e-03, PNorm = 68.1052, GNorm = 0.9681, lr_0 = 7.5478e-04
Loss = 2.9399e-03, PNorm = 68.1585, GNorm = 1.3682, lr_0 = 7.2281e-04
Validation rmse = 1.171953
Epoch 6
Loss = 3.0113e-03, PNorm = 68.2089, GNorm = 2.1303, lr_0 = 6.8920e-04
Loss = 2.8344e-03, PNorm = 68.2601, GNorm = 1.0523, lr_0 = 6.6001e-04
Validation rmse = 1.083774
Epoch 7
Loss = 2.5349e-03, PNorm = 68.2981, GNorm = 1.1880, lr_0 = 6.3205e-04
Loss = 2.5482e-03, PNorm = 68.3381, GNorm = 0.9993, lr_0 = 6.0528e-04
Validation rmse = 1.255748
Epoch 8
Loss = 2.8317e-03, PNorm = 68.3748, GNorm = 1.0164, lr_0 = 5.7714e-04
Loss = 2.5032e-03, PNorm = 68.4074, GNorm = 1.5956, lr_0 = 5.5269e-04
Validation rmse = 1.103747
Epoch 9
Loss = 2.0084e-03, PNorm = 68.4409, GNorm = 1.4191, lr_0 = 5.2928e-04
Loss = 2.3079e-03, PNorm = 68.4689, GNorm = 0.9669, lr_0 = 5.0686e-04
Validation rmse = 1.118471
Epoch 10
Loss = 2.2957e-03, PNorm = 68.5004, GNorm = 0.6715, lr_0 = 4.8539e-04
Loss = 2.4282e-03, PNorm = 68.5280, GNorm = 0.8386, lr_0 = 4.6483e-04
Validation rmse = 1.073624
Epoch 11
Loss = 2.5088e-03, PNorm = 68.5568, GNorm = 1.8299, lr_0 = 4.4322e-04
Loss = 2.1333e-03, PNorm = 68.5795, GNorm = 2.0124, lr_0 = 4.2444e-04
Validation rmse = 1.049386
Epoch 12
Loss = 2.2073e-03, PNorm = 68.6040, GNorm = 1.5967, lr_0 = 4.0646e-04
Loss = 1.7331e-03, PNorm = 68.6239, GNorm = 0.6225, lr_0 = 3.8925e-04
Validation rmse = 1.058971
Epoch 13
Loss = 2.0691e-03, PNorm = 68.6425, GNorm = 0.9550, lr_0 = 3.7276e-04
Loss = 1.7745e-03, PNorm = 68.6599, GNorm = 1.3368, lr_0 = 3.5697e-04
Validation rmse = 1.030725
Epoch 14
Loss = 1.7705e-03, PNorm = 68.6781, GNorm = 0.8311, lr_0 = 3.4037e-04
Loss = 2.0536e-03, PNorm = 68.6944, GNorm = 1.9841, lr_0 = 3.2596e-04
Validation rmse = 0.999293
Epoch 15
Loss = 2.1799e-03, PNorm = 68.7099, GNorm = 2.5392, lr_0 = 3.1215e-04
Loss = 1.9226e-03, PNorm = 68.7264, GNorm = 1.1937, lr_0 = 2.9893e-04
Validation rmse = 1.089181
Epoch 16
Loss = 1.6132e-03, PNorm = 68.7451, GNorm = 0.4994, lr_0 = 2.8503e-04
Loss = 1.9176e-03, PNorm = 68.7607, GNorm = 1.4451, lr_0 = 2.7295e-04
Validation rmse = 1.135263
Epoch 17
Loss = 1.5694e-03, PNorm = 68.7714, GNorm = 0.8820, lr_0 = 2.6139e-04
Loss = 2.1925e-03, PNorm = 68.7862, GNorm = 0.7329, lr_0 = 2.5032e-04
Validation rmse = 1.118470
Epoch 18
Loss = 1.7870e-03, PNorm = 68.7946, GNorm = 0.7444, lr_0 = 2.3972e-04
Loss = 1.6846e-03, PNorm = 68.8048, GNorm = 0.7652, lr_0 = 2.2956e-04
Validation rmse = 1.070646
Epoch 19
Loss = 1.4930e-03, PNorm = 68.8167, GNorm = 1.5898, lr_0 = 2.1889e-04
Loss = 1.7577e-03, PNorm = 68.8235, GNorm = 0.5391, lr_0 = 2.0962e-04
Validation rmse = 1.010683
Epoch 20
Loss = 1.2775e-03, PNorm = 68.8345, GNorm = 0.5843, lr_0 = 2.0074e-04
Loss = 1.7617e-03, PNorm = 68.8389, GNorm = 0.9223, lr_0 = 1.9224e-04
Validation rmse = 1.011405
Epoch 21
Loss = 1.5698e-03, PNorm = 68.8509, GNorm = 2.4205, lr_0 = 1.8409e-04
Loss = 1.6946e-03, PNorm = 68.8595, GNorm = 0.8331, lr_0 = 1.7630e-04
Validation rmse = 1.029765
Epoch 22
Loss = 1.7813e-03, PNorm = 68.8697, GNorm = 1.1079, lr_0 = 1.6810e-04
Loss = 1.5983e-03, PNorm = 68.8786, GNorm = 1.7735, lr_0 = 1.6098e-04
Validation rmse = 0.985967
Epoch 23
Loss = 1.5863e-03, PNorm = 68.8871, GNorm = 1.2634, lr_0 = 1.5416e-04
Loss = 1.4230e-03, PNorm = 68.8944, GNorm = 0.4460, lr_0 = 1.4763e-04
Loss = 2.0049e-03, PNorm = 68.8954, GNorm = 0.6134, lr_0 = 1.4699e-04
Validation rmse = 1.059868
Epoch 24
Loss = 1.3903e-03, PNorm = 68.9002, GNorm = 1.2257, lr_0 = 1.4077e-04
Loss = 1.4928e-03, PNorm = 68.9077, GNorm = 0.6929, lr_0 = 1.3480e-04
Validation rmse = 0.986490
Epoch 25
Loss = 1.4869e-03, PNorm = 68.9133, GNorm = 1.0370, lr_0 = 1.2909e-04
Loss = 1.5567e-03, PNorm = 68.9206, GNorm = 1.7260, lr_0 = 1.2362e-04
Validation rmse = 1.046830
Epoch 26
Loss = 1.4962e-03, PNorm = 68.9235, GNorm = 0.9046, lr_0 = 1.1839e-04
Validation rmse = 1.080292
Epoch 27
Loss = 2.6813e-03, PNorm = 68.9279, GNorm = 2.6357, lr_0 = 1.1288e-04
Loss = 1.3514e-03, PNorm = 68.9321, GNorm = 1.4500, lr_0 = 1.0810e-04
Validation rmse = 0.997306
Epoch 28
Loss = 1.8095e-03, PNorm = 68.9366, GNorm = 1.1634, lr_0 = 1.0352e-04
Loss = 1.4391e-03, PNorm = 68.9398, GNorm = 1.2856, lr_0 = 1.0000e-04
Validation rmse = 1.228687
Epoch 29
Loss = 1.8525e-03, PNorm = 68.9475, GNorm = 1.3490, lr_0 = 1.0000e-04
Loss = 1.3954e-03, PNorm = 68.9506, GNorm = 1.9852, lr_0 = 1.0000e-04
Validation rmse = 1.027279
Model 0 best validation rmse = 0.985967 on epoch 22
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.183825
Ensemble test rmse = 1.183825
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_2_dropout_0.30000000000000004_ffn_num_layers_2_hidden_size_1400/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 58 | test scaffolds = 53
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=1404, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,281,801
Moving model to cuda
Epoch 0
Loss = 1.7309e-02, PNorm = 67.3591, GNorm = 2.3142, lr_0 = 3.6053e-04
Validation rmse = 1.412504
Epoch 1
Loss = 6.2714e-03, PNorm = 67.4350, GNorm = 5.0360, lr_0 = 6.2105e-04
Loss = 6.2783e-03, PNorm = 67.5370, GNorm = 0.9938, lr_0 = 8.5789e-04
Validation rmse = 1.584509
Epoch 2
Loss = 6.4139e-03, PNorm = 67.6505, GNorm = 4.4245, lr_0 = 9.8284e-04
Loss = 6.2337e-03, PNorm = 67.7556, GNorm = 1.0571, lr_0 = 9.4120e-04
Validation rmse = 1.072009
Epoch 3
Loss = 4.3493e-03, PNorm = 67.8544, GNorm = 0.9295, lr_0 = 8.9744e-04
Loss = 4.1063e-03, PNorm = 67.9266, GNorm = 1.8525, lr_0 = 8.5943e-04
Validation rmse = 1.225590
Epoch 4
Loss = 4.1144e-03, PNorm = 67.9864, GNorm = 2.1070, lr_0 = 8.2303e-04
Loss = 3.4961e-03, PNorm = 68.0395, GNorm = 0.8495, lr_0 = 7.8816e-04
Validation rmse = 1.077038
Epoch 5
Loss = 2.7925e-03, PNorm = 68.0853, GNorm = 0.9643, lr_0 = 7.5478e-04
Loss = 2.9711e-03, PNorm = 68.1382, GNorm = 0.7697, lr_0 = 7.2281e-04
Validation rmse = 1.085569
Epoch 6
Loss = 3.0981e-03, PNorm = 68.1877, GNorm = 2.3417, lr_0 = 6.8920e-04
Loss = 2.8371e-03, PNorm = 68.2335, GNorm = 1.6197, lr_0 = 6.6001e-04
Validation rmse = 1.092122
Epoch 7
Loss = 2.7237e-03, PNorm = 68.2763, GNorm = 1.5841, lr_0 = 6.3205e-04
Loss = 2.9687e-03, PNorm = 68.3176, GNorm = 1.3211, lr_0 = 6.0528e-04
Validation rmse = 1.128779
Epoch 8
Loss = 2.3877e-03, PNorm = 68.3556, GNorm = 0.5768, lr_0 = 5.7714e-04
Loss = 2.4789e-03, PNorm = 68.3920, GNorm = 1.1139, lr_0 = 5.5269e-04
Validation rmse = 1.045458
Epoch 9
Loss = 2.4043e-03, PNorm = 68.4215, GNorm = 0.7348, lr_0 = 5.2928e-04
Loss = 2.2882e-03, PNorm = 68.4542, GNorm = 1.6287, lr_0 = 5.0686e-04
Validation rmse = 1.069176
Epoch 10
Loss = 2.0305e-03, PNorm = 68.4824, GNorm = 1.6567, lr_0 = 4.8539e-04
Loss = 2.2684e-03, PNorm = 68.5115, GNorm = 0.9628, lr_0 = 4.6483e-04
Validation rmse = 1.106936
Epoch 11
Loss = 2.3227e-03, PNorm = 68.5399, GNorm = 1.5586, lr_0 = 4.4322e-04
Loss = 2.2911e-03, PNorm = 68.5646, GNorm = 0.9849, lr_0 = 4.2444e-04
Validation rmse = 1.041563
Epoch 12
Loss = 1.7494e-03, PNorm = 68.5891, GNorm = 0.5240, lr_0 = 4.0646e-04
Loss = 2.3793e-03, PNorm = 68.6136, GNorm = 1.7467, lr_0 = 3.8925e-04
Validation rmse = 1.122555
Epoch 13
Loss = 1.8616e-03, PNorm = 68.6349, GNorm = 0.9269, lr_0 = 3.7276e-04
Loss = 2.1157e-03, PNorm = 68.6496, GNorm = 1.2717, lr_0 = 3.5697e-04
Validation rmse = 1.029338
Epoch 14
Loss = 2.2663e-03, PNorm = 68.6702, GNorm = 0.9318, lr_0 = 3.4037e-04
Loss = 2.0085e-03, PNorm = 68.6903, GNorm = 1.5287, lr_0 = 3.2596e-04
Validation rmse = 1.023764
Epoch 15
Loss = 1.9957e-03, PNorm = 68.7077, GNorm = 1.0998, lr_0 = 3.1215e-04
Loss = 2.3092e-03, PNorm = 68.7220, GNorm = 2.1182, lr_0 = 2.9893e-04
Validation rmse = 1.058758
Epoch 16
Loss = 2.1502e-03, PNorm = 68.7364, GNorm = 2.0044, lr_0 = 2.8503e-04
Loss = 1.9440e-03, PNorm = 68.7511, GNorm = 0.7918, lr_0 = 2.7295e-04
Validation rmse = 1.088918
Epoch 17
Loss = 1.8109e-03, PNorm = 68.7647, GNorm = 1.1812, lr_0 = 2.6139e-04
Loss = 2.0426e-03, PNorm = 68.7792, GNorm = 1.2900, lr_0 = 2.5032e-04
Validation rmse = 1.027855
Epoch 18
Loss = 1.7912e-03, PNorm = 68.7929, GNorm = 0.4481, lr_0 = 2.3972e-04
Loss = 1.9428e-03, PNorm = 68.8050, GNorm = 0.8759, lr_0 = 2.2956e-04
Validation rmse = 0.948410
Epoch 19
Loss = 1.5979e-03, PNorm = 68.8118, GNorm = 0.8893, lr_0 = 2.1889e-04
Loss = 1.9992e-03, PNorm = 68.8222, GNorm = 1.3197, lr_0 = 2.0962e-04
Validation rmse = 1.074747
Epoch 20
Loss = 2.3309e-03, PNorm = 68.8313, GNorm = 0.9108, lr_0 = 2.0074e-04
Loss = 1.4183e-03, PNorm = 68.8387, GNorm = 0.7327, lr_0 = 1.9224e-04
Validation rmse = 0.959703
Epoch 21
Loss = 1.3788e-03, PNorm = 68.8455, GNorm = 1.3044, lr_0 = 1.8409e-04
Loss = 1.6177e-03, PNorm = 68.8548, GNorm = 1.0200, lr_0 = 1.7630e-04
Validation rmse = 0.961036
Epoch 22
Loss = 1.8506e-03, PNorm = 68.8638, GNorm = 1.3482, lr_0 = 1.6810e-04
Loss = 1.7789e-03, PNorm = 68.8716, GNorm = 2.1597, lr_0 = 1.6098e-04
Validation rmse = 0.949345
Epoch 23
Loss = 1.4695e-03, PNorm = 68.8797, GNorm = 1.2297, lr_0 = 1.5416e-04
Loss = 1.7691e-03, PNorm = 68.8864, GNorm = 0.6400, lr_0 = 1.4763e-04
Loss = 2.7218e-03, PNorm = 68.8872, GNorm = 1.0060, lr_0 = 1.4699e-04
Validation rmse = 0.959141
Epoch 24
Loss = 1.7189e-03, PNorm = 68.8931, GNorm = 0.7835, lr_0 = 1.4077e-04
Loss = 1.6350e-03, PNorm = 68.9008, GNorm = 0.7949, lr_0 = 1.3480e-04
Validation rmse = 0.991063
Epoch 25
Loss = 1.5137e-03, PNorm = 68.9051, GNorm = 0.8446, lr_0 = 1.2909e-04
Loss = 1.6092e-03, PNorm = 68.9100, GNorm = 0.9698, lr_0 = 1.2362e-04
Validation rmse = 0.970991
Epoch 26
Loss = 1.4960e-03, PNorm = 68.9162, GNorm = 0.6683, lr_0 = 1.1839e-04
Validation rmse = 0.970275
Epoch 27
Loss = 1.7382e-03, PNorm = 68.9209, GNorm = 1.2081, lr_0 = 1.1288e-04
Loss = 1.5029e-03, PNorm = 68.9255, GNorm = 0.9977, lr_0 = 1.0810e-04
Validation rmse = 0.980595
Epoch 28
Loss = 1.1715e-03, PNorm = 68.9308, GNorm = 1.0174, lr_0 = 1.0352e-04
Loss = 1.5634e-03, PNorm = 68.9354, GNorm = 0.5779, lr_0 = 1.0000e-04
Validation rmse = 0.973152
Epoch 29
Loss = 1.5845e-03, PNorm = 68.9414, GNorm = 1.1095, lr_0 = 1.0000e-04
Loss = 1.4993e-03, PNorm = 68.9433, GNorm = 0.6152, lr_0 = 1.0000e-04
Validation rmse = 1.001310
Model 0 best validation rmse = 0.948410 on epoch 18
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.349921
Ensemble test rmse = 1.349921
10-fold cross validation
	Seed 0 ==> test rmse = 1.027402
	Seed 1 ==> test rmse = 1.093964
	Seed 2 ==> test rmse = 1.160240
	Seed 3 ==> test rmse = 0.983591
	Seed 4 ==> test rmse = 1.205621
	Seed 5 ==> test rmse = 1.187309
	Seed 6 ==> test rmse = 0.901034
	Seed 7 ==> test rmse = 1.007430
	Seed 8 ==> test rmse = 1.183825
	Seed 9 ==> test rmse = 1.349921
Overall test rmse = 1.110034 +/- 0.125659
Elapsed time = 0:06:03
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_500/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total scaffolds = 195 | train scaffolds = 91 | val scaffolds = 66 | test scaffolds = 38
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=504, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=500, out_features=500, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 1,144,001
Moving model to cuda
Epoch 0
Loss = 1.9740e-02, PNorm = 47.8848, GNorm = 7.4042, lr_0 = 3.6053e-04
Validation rmse = 1.149127
Epoch 1
Loss = 9.3269e-03, PNorm = 47.9073, GNorm = 5.3718, lr_0 = 6.2105e-04
Loss = 9.3840e-03, PNorm = 47.9351, GNorm = 2.5654, lr_0 = 8.5789e-04
Validation rmse = 1.362761
Epoch 2
Loss = 5.6512e-03, PNorm = 47.9716, GNorm = 4.3449, lr_0 = 9.8284e-04
Loss = 5.9692e-03, PNorm = 48.0067, GNorm = 1.6199, lr_0 = 9.4120e-04
Validation rmse = 1.098254
Epoch 3
Loss = 3.8868e-03, PNorm = 48.0319, GNorm = 2.3441, lr_0 = 8.9744e-04
Loss = 5.2149e-03, PNorm = 48.0494, GNorm = 2.2087, lr_0 = 8.5943e-04
Validation rmse = 1.102073
Epoch 4
Loss = 4.2272e-03, PNorm = 48.0687, GNorm = 1.2074, lr_0 = 8.2303e-04
Loss = 4.2223e-03, PNorm = 48.0820, GNorm = 1.7806, lr_0 = 7.8816e-04
Validation rmse = 1.166405
Epoch 5
Loss = 2.6522e-03, PNorm = 48.0960, GNorm = 1.5929, lr_0 = 7.5478e-04
Loss = 3.6880e-03, PNorm = 48.1095, GNorm = 1.5072, lr_0 = 7.2281e-04
Validation rmse = 1.096365
Epoch 6
Loss = 3.5368e-03, PNorm = 48.1235, GNorm = 1.1658, lr_0 = 6.8920e-04
Loss = 3.6910e-03, PNorm = 48.1366, GNorm = 2.1277, lr_0 = 6.6001e-04
Validation rmse = 1.306782
Epoch 7
Loss = 3.3667e-03, PNorm = 48.1482, GNorm = 2.3967, lr_0 = 6.3205e-04
Loss = 3.2254e-03, PNorm = 48.1599, GNorm = 2.1464, lr_0 = 6.0528e-04
Validation rmse = 1.004242
Epoch 8
Loss = 2.6732e-03, PNorm = 48.1711, GNorm = 1.2859, lr_0 = 5.7714e-04
Loss = 3.0045e-03, PNorm = 48.1805, GNorm = 2.1998, lr_0 = 5.5269e-04
Validation rmse = 1.034365
Epoch 9
Loss = 3.1725e-03, PNorm = 48.1892, GNorm = 5.2119, lr_0 = 5.2928e-04
Loss = 3.4816e-03, PNorm = 48.2020, GNorm = 1.2224, lr_0 = 5.0686e-04
Validation rmse = 0.985728
Epoch 10
Loss = 2.8110e-03, PNorm = 48.2095, GNorm = 3.9441, lr_0 = 4.8539e-04
Loss = 3.1526e-03, PNorm = 48.2180, GNorm = 2.0188, lr_0 = 4.6483e-04
Validation rmse = 1.083714
Epoch 11
Loss = 2.5267e-03, PNorm = 48.2303, GNorm = 0.6446, lr_0 = 4.4322e-04
Loss = 3.0501e-03, PNorm = 48.2344, GNorm = 1.3784, lr_0 = 4.2444e-04
Validation rmse = 1.123522
Epoch 12
Loss = 2.5488e-03, PNorm = 48.2416, GNorm = 1.7017, lr_0 = 4.0646e-04
Loss = 2.5344e-03, PNorm = 48.2460, GNorm = 1.0402, lr_0 = 3.8925e-04
Validation rmse = 1.052197
Epoch 13
Loss = 2.7027e-03, PNorm = 48.2490, GNorm = 0.7948, lr_0 = 3.7276e-04
Loss = 2.7068e-03, PNorm = 48.2539, GNorm = 0.7679, lr_0 = 3.5697e-04
Validation rmse = 1.009677
Epoch 14
Loss = 2.5388e-03, PNorm = 48.2593, GNorm = 0.8540, lr_0 = 3.4037e-04
Loss = 2.6330e-03, PNorm = 48.2631, GNorm = 2.6754, lr_0 = 3.2596e-04
Validation rmse = 1.072451
Epoch 15
Loss = 2.0727e-03, PNorm = 48.2688, GNorm = 0.9842, lr_0 = 3.1215e-04
Loss = 2.4719e-03, PNorm = 48.2727, GNorm = 1.3329, lr_0 = 2.9893e-04
Validation rmse = 1.135945
Epoch 16
Loss = 2.5859e-03, PNorm = 48.2766, GNorm = 3.3176, lr_0 = 2.8503e-04
Loss = 2.3178e-03, PNorm = 48.2815, GNorm = 0.9555, lr_0 = 2.7295e-04
Validation rmse = 1.018751
Epoch 17
Loss = 2.3265e-03, PNorm = 48.2842, GNorm = 0.7619, lr_0 = 2.6139e-04
Loss = 2.4608e-03, PNorm = 48.2881, GNorm = 2.0708, lr_0 = 2.5032e-04
Validation rmse = 1.006979
Epoch 18
Loss = 2.0742e-03, PNorm = 48.2898, GNorm = 1.4903, lr_0 = 2.3972e-04
Loss = 2.3531e-03, PNorm = 48.2930, GNorm = 3.0262, lr_0 = 2.2956e-04
Validation rmse = 0.983067
Epoch 19
Loss = 1.9988e-03, PNorm = 48.2962, GNorm = 0.8853, lr_0 = 2.1889e-04
Loss = 2.2883e-03, PNorm = 48.2975, GNorm = 1.5778, lr_0 = 2.0962e-04
Validation rmse = 1.040516
Epoch 20
Loss = 2.0506e-03, PNorm = 48.3009, GNorm = 0.7004, lr_0 = 2.0074e-04
Loss = 2.1588e-03, PNorm = 48.3036, GNorm = 2.0175, lr_0 = 1.9224e-04
Validation rmse = 0.969914
Epoch 21
Loss = 2.0321e-03, PNorm = 48.3053, GNorm = 0.5955, lr_0 = 1.8409e-04
Loss = 2.1149e-03, PNorm = 48.3082, GNorm = 1.7049, lr_0 = 1.7630e-04
Validation rmse = 0.999725
Epoch 22
Loss = 1.8832e-03, PNorm = 48.3107, GNorm = 1.3920, lr_0 = 1.6810e-04
Loss = 2.2288e-03, PNorm = 48.3123, GNorm = 0.8118, lr_0 = 1.6098e-04
Validation rmse = 0.987212
Epoch 23
Loss = 2.0326e-03, PNorm = 48.3144, GNorm = 1.4111, lr_0 = 1.5416e-04
Loss = 2.0230e-03, PNorm = 48.3159, GNorm = 1.1363, lr_0 = 1.4763e-04
Loss = 4.3746e-03, PNorm = 48.3162, GNorm = 3.3362, lr_0 = 1.4699e-04
Validation rmse = 0.974466
Epoch 24
Loss = 2.1321e-03, PNorm = 48.3183, GNorm = 1.4799, lr_0 = 1.4077e-04
Loss = 1.8225e-03, PNorm = 48.3194, GNorm = 0.8404, lr_0 = 1.3480e-04
Validation rmse = 1.019130
Epoch 25
Loss = 1.8235e-03, PNorm = 48.3201, GNorm = 0.8890, lr_0 = 1.2909e-04
Loss = 2.2514e-03, PNorm = 48.3218, GNorm = 2.2478, lr_0 = 1.2362e-04
Validation rmse = 1.066515
Epoch 26
Loss = 1.8440e-03, PNorm = 48.3232, GNorm = 0.7186, lr_0 = 1.1839e-04
Validation rmse = 1.026146
Epoch 27
Loss = 1.5783e-03, PNorm = 48.3250, GNorm = 1.6782, lr_0 = 1.1288e-04
Loss = 1.9895e-03, PNorm = 48.3262, GNorm = 2.9437, lr_0 = 1.0810e-04
Validation rmse = 1.031209
Epoch 28
Loss = 2.4174e-03, PNorm = 48.3272, GNorm = 0.8617, lr_0 = 1.0352e-04
Loss = 1.7475e-03, PNorm = 48.3292, GNorm = 0.9655, lr_0 = 1.0000e-04
Validation rmse = 1.051787
Epoch 29
Loss = 2.0488e-03, PNorm = 48.3301, GNorm = 2.7822, lr_0 = 1.0000e-04
Loss = 2.0117e-03, PNorm = 48.3317, GNorm = 1.1556, lr_0 = 1.0000e-04
Validation rmse = 0.976615
Model 0 best validation rmse = 0.969914 on epoch 20
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.986765
Ensemble test rmse = 0.986765
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_500/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total scaffolds = 195 | train scaffolds = 76 | val scaffolds = 60 | test scaffolds = 59
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=504, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=500, out_features=500, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 1,144,001
Moving model to cuda
Epoch 0
Loss = 1.9196e-02, PNorm = 47.8846, GNorm = 7.3751, lr_0 = 3.6053e-04
Validation rmse = 2.123315
Epoch 1
Loss = 1.1684e-02, PNorm = 47.9075, GNorm = 8.2268, lr_0 = 6.2105e-04
Loss = 7.6057e-03, PNorm = 47.9364, GNorm = 2.1824, lr_0 = 8.5789e-04
Validation rmse = 1.436930
Epoch 2
Loss = 6.4696e-03, PNorm = 47.9710, GNorm = 3.0543, lr_0 = 9.8284e-04
Loss = 5.3941e-03, PNorm = 48.0004, GNorm = 1.8971, lr_0 = 9.4120e-04
Validation rmse = 1.324239
Epoch 3
Loss = 4.6056e-03, PNorm = 48.0270, GNorm = 3.3345, lr_0 = 8.9744e-04
Loss = 4.4459e-03, PNorm = 48.0489, GNorm = 1.9422, lr_0 = 8.5943e-04
Validation rmse = 1.309812
Epoch 4
Loss = 2.8519e-03, PNorm = 48.0673, GNorm = 2.5579, lr_0 = 8.2303e-04
Loss = 4.0404e-03, PNorm = 48.0856, GNorm = 4.1570, lr_0 = 7.8816e-04
Validation rmse = 1.431237
Epoch 5
Loss = 3.5852e-03, PNorm = 48.1000, GNorm = 1.3150, lr_0 = 7.5478e-04
Loss = 4.8709e-03, PNorm = 48.1136, GNorm = 5.0016, lr_0 = 7.2281e-04
Validation rmse = 1.295075
Epoch 6
Loss = 4.7255e-03, PNorm = 48.1341, GNorm = 2.2348, lr_0 = 6.8920e-04
Loss = 3.9182e-03, PNorm = 48.1486, GNorm = 2.6364, lr_0 = 6.6001e-04
Validation rmse = 1.284893
Epoch 7
Loss = 3.5736e-03, PNorm = 48.1634, GNorm = 1.3891, lr_0 = 6.3205e-04
Loss = 3.5345e-03, PNorm = 48.1735, GNorm = 1.5896, lr_0 = 6.0528e-04
Validation rmse = 1.266049
Epoch 8
Loss = 2.6306e-03, PNorm = 48.1867, GNorm = 1.6956, lr_0 = 5.7714e-04
Loss = 4.8393e-03, PNorm = 48.1956, GNorm = 5.5630, lr_0 = 5.5269e-04
Validation rmse = 1.203715
Epoch 9
Loss = 3.2292e-03, PNorm = 48.2064, GNorm = 0.8515, lr_0 = 5.2928e-04
Loss = 3.1068e-03, PNorm = 48.2164, GNorm = 1.6342, lr_0 = 5.0686e-04
Validation rmse = 1.141937
Epoch 10
Loss = 2.6134e-03, PNorm = 48.2232, GNorm = 1.4775, lr_0 = 4.8539e-04
Loss = 2.5907e-03, PNorm = 48.2308, GNorm = 1.9024, lr_0 = 4.6483e-04
Validation rmse = 1.127124
Epoch 11
Loss = 3.2793e-03, PNorm = 48.2389, GNorm = 2.3673, lr_0 = 4.4322e-04
Loss = 3.0445e-03, PNorm = 48.2456, GNorm = 1.3952, lr_0 = 4.2444e-04
Validation rmse = 1.086662
Epoch 12
Loss = 2.1593e-03, PNorm = 48.2523, GNorm = 1.9583, lr_0 = 4.0646e-04
Loss = 2.8857e-03, PNorm = 48.2561, GNorm = 2.6106, lr_0 = 3.8925e-04
Validation rmse = 1.104942
Epoch 13
Loss = 2.6640e-03, PNorm = 48.2633, GNorm = 1.3533, lr_0 = 3.7276e-04
Loss = 2.5376e-03, PNorm = 48.2678, GNorm = 0.9098, lr_0 = 3.5697e-04
Validation rmse = 1.097054
Epoch 14
Loss = 2.2901e-03, PNorm = 48.2734, GNorm = 2.4758, lr_0 = 3.4037e-04
Loss = 2.1095e-03, PNorm = 48.2796, GNorm = 0.8914, lr_0 = 3.2596e-04
Validation rmse = 1.045007
Epoch 15
Loss = 2.1294e-03, PNorm = 48.2828, GNorm = 1.2784, lr_0 = 3.1215e-04
Loss = 2.4105e-03, PNorm = 48.2875, GNorm = 1.3527, lr_0 = 2.9893e-04
Validation rmse = 1.146585
Epoch 16
Loss = 2.4018e-03, PNorm = 48.2909, GNorm = 0.9449, lr_0 = 2.8503e-04
Loss = 2.2660e-03, PNorm = 48.2956, GNorm = 1.4067, lr_0 = 2.7295e-04
Validation rmse = 1.128956
Epoch 17
Loss = 2.0908e-03, PNorm = 48.2983, GNorm = 2.4602, lr_0 = 2.6139e-04
Loss = 2.2971e-03, PNorm = 48.3002, GNorm = 0.9748, lr_0 = 2.5032e-04
Validation rmse = 1.152805
Epoch 18
Loss = 2.0192e-03, PNorm = 48.3027, GNorm = 1.0471, lr_0 = 2.3972e-04
Loss = 1.9120e-03, PNorm = 48.3049, GNorm = 1.9056, lr_0 = 2.2956e-04
Validation rmse = 1.094635
Epoch 19
Loss = 1.9576e-03, PNorm = 48.3087, GNorm = 6.4036, lr_0 = 2.1889e-04
Loss = 2.3469e-03, PNorm = 48.3100, GNorm = 0.9774, lr_0 = 2.0962e-04
Validation rmse = 1.082299
Epoch 20
Loss = 1.8727e-03, PNorm = 48.3126, GNorm = 1.9266, lr_0 = 2.0074e-04
Loss = 2.1846e-03, PNorm = 48.3152, GNorm = 0.8011, lr_0 = 1.9224e-04
Validation rmse = 1.047178
Epoch 21
Loss = 1.8168e-03, PNorm = 48.3176, GNorm = 1.4644, lr_0 = 1.8409e-04
Loss = 2.1442e-03, PNorm = 48.3191, GNorm = 0.7205, lr_0 = 1.7630e-04
Validation rmse = 1.273511
Epoch 22
Loss = 2.0852e-03, PNorm = 48.3219, GNorm = 2.1986, lr_0 = 1.6810e-04
Loss = 1.9254e-03, PNorm = 48.3235, GNorm = 1.4317, lr_0 = 1.6098e-04
Validation rmse = 1.179260
Epoch 23
Loss = 2.4053e-03, PNorm = 48.3254, GNorm = 1.5659, lr_0 = 1.5416e-04
Loss = 1.8464e-03, PNorm = 48.3277, GNorm = 1.6730, lr_0 = 1.4763e-04
Loss = 2.3951e-03, PNorm = 48.3279, GNorm = 2.2694, lr_0 = 1.4699e-04
Validation rmse = 1.071123
Epoch 24
Loss = 2.0348e-03, PNorm = 48.3290, GNorm = 0.6999, lr_0 = 1.4077e-04
Loss = 1.9886e-03, PNorm = 48.3306, GNorm = 1.4518, lr_0 = 1.3480e-04
Validation rmse = 1.257677
Epoch 25
Loss = 1.6903e-03, PNorm = 48.3324, GNorm = 1.3430, lr_0 = 1.2909e-04
Loss = 2.2078e-03, PNorm = 48.3344, GNorm = 1.4756, lr_0 = 1.2362e-04
Validation rmse = 1.150637
Epoch 26
Loss = 1.8621e-03, PNorm = 48.3353, GNorm = 2.8230, lr_0 = 1.1839e-04
Validation rmse = 1.168588
Epoch 27
Loss = 1.9221e-03, PNorm = 48.3374, GNorm = 1.3944, lr_0 = 1.1288e-04
Loss = 1.6751e-03, PNorm = 48.3391, GNorm = 0.6263, lr_0 = 1.0810e-04
Validation rmse = 1.182916
Epoch 28
Loss = 1.8316e-03, PNorm = 48.3397, GNorm = 0.8773, lr_0 = 1.0352e-04
Loss = 1.9161e-03, PNorm = 48.3419, GNorm = 1.9270, lr_0 = 1.0000e-04
Validation rmse = 1.244028
Epoch 29
Loss = 1.3334e-03, PNorm = 48.3424, GNorm = 0.6754, lr_0 = 1.0000e-04
Loss = 1.9379e-03, PNorm = 48.3443, GNorm = 1.5806, lr_0 = 1.0000e-04
Validation rmse = 1.167914
Model 0 best validation rmse = 1.045007 on epoch 14
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.171239
Ensemble test rmse = 1.171239
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_500/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total scaffolds = 195 | train scaffolds = 55 | val scaffolds = 64 | test scaffolds = 76
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=504, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=500, out_features=500, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 1,144,001
Moving model to cuda
Epoch 0
Loss = 1.9171e-02, PNorm = 47.8851, GNorm = 3.2770, lr_0 = 3.6053e-04
Validation rmse = 1.443493
Epoch 1
Loss = 7.2534e-03, PNorm = 47.9069, GNorm = 2.3655, lr_0 = 6.2105e-04
Loss = 7.7774e-03, PNorm = 47.9404, GNorm = 1.6354, lr_0 = 8.5789e-04
Validation rmse = 1.303364
Epoch 2
Loss = 5.6527e-03, PNorm = 47.9756, GNorm = 1.7102, lr_0 = 9.8284e-04
Loss = 5.1053e-03, PNorm = 48.0082, GNorm = 3.1408, lr_0 = 9.4120e-04
Validation rmse = 1.261088
Epoch 3
Loss = 5.1707e-03, PNorm = 48.0359, GNorm = 1.7458, lr_0 = 8.9744e-04
Loss = 5.1128e-03, PNorm = 48.0556, GNorm = 1.3606, lr_0 = 8.5943e-04
Validation rmse = 1.205116
Epoch 4
Loss = 3.9833e-03, PNorm = 48.0730, GNorm = 1.3624, lr_0 = 8.2303e-04
Loss = 4.9842e-03, PNorm = 48.0917, GNorm = 1.4081, lr_0 = 7.8816e-04
Validation rmse = 1.286074
Epoch 5
Loss = 3.1357e-03, PNorm = 48.1071, GNorm = 1.7592, lr_0 = 7.5478e-04
Loss = 3.8071e-03, PNorm = 48.1178, GNorm = 2.5596, lr_0 = 7.2281e-04
Validation rmse = 1.324707
Epoch 6
Loss = 4.0359e-03, PNorm = 48.1330, GNorm = 3.0884, lr_0 = 6.8920e-04
Loss = 4.9521e-03, PNorm = 48.1464, GNorm = 2.8696, lr_0 = 6.6001e-04
Validation rmse = 1.443966
Epoch 7
Loss = 5.4894e-03, PNorm = 48.1589, GNorm = 2.7209, lr_0 = 6.3205e-04
Loss = 3.6234e-03, PNorm = 48.1716, GNorm = 1.3479, lr_0 = 6.0528e-04
Validation rmse = 1.140013
Epoch 8
Loss = 3.9434e-03, PNorm = 48.1828, GNorm = 1.2448, lr_0 = 5.7714e-04
Loss = 3.2308e-03, PNorm = 48.1955, GNorm = 0.6742, lr_0 = 5.5269e-04
Validation rmse = 1.225449
Epoch 9
Loss = 2.3199e-03, PNorm = 48.2029, GNorm = 0.8193, lr_0 = 5.2928e-04
Loss = 2.7609e-03, PNorm = 48.2136, GNorm = 1.4886, lr_0 = 5.0686e-04
Validation rmse = 1.148143
Epoch 10
Loss = 2.5668e-03, PNorm = 48.2214, GNorm = 1.2131, lr_0 = 4.8539e-04
Loss = 2.8513e-03, PNorm = 48.2286, GNorm = 1.3706, lr_0 = 4.6483e-04
Validation rmse = 1.149069
Epoch 11
Loss = 3.1401e-03, PNorm = 48.2371, GNorm = 3.9468, lr_0 = 4.4322e-04
Loss = 2.6449e-03, PNorm = 48.2439, GNorm = 3.7508, lr_0 = 4.2444e-04
Validation rmse = 1.103339
Epoch 12
Loss = 2.8517e-03, PNorm = 48.2527, GNorm = 2.0785, lr_0 = 4.0646e-04
Loss = 2.4871e-03, PNorm = 48.2580, GNorm = 1.2581, lr_0 = 3.8925e-04
Validation rmse = 1.163562
Epoch 13
Loss = 2.6469e-03, PNorm = 48.2648, GNorm = 2.5302, lr_0 = 3.7276e-04
Loss = 2.5258e-03, PNorm = 48.2711, GNorm = 1.3264, lr_0 = 3.5697e-04
Validation rmse = 1.179178
Epoch 14
Loss = 2.7078e-03, PNorm = 48.2774, GNorm = 1.2347, lr_0 = 3.4037e-04
Loss = 2.4511e-03, PNorm = 48.2843, GNorm = 1.3432, lr_0 = 3.2596e-04
Validation rmse = 1.178018
Epoch 15
Loss = 2.3730e-03, PNorm = 48.2903, GNorm = 1.2391, lr_0 = 3.1215e-04
Loss = 2.4195e-03, PNorm = 48.2932, GNorm = 1.8224, lr_0 = 2.9893e-04
Validation rmse = 1.250470
Epoch 16
Loss = 2.5343e-03, PNorm = 48.2988, GNorm = 2.3550, lr_0 = 2.8503e-04
Loss = 2.7658e-03, PNorm = 48.3025, GNorm = 2.0989, lr_0 = 2.7295e-04
Validation rmse = 1.333132
Epoch 17
Loss = 2.5892e-03, PNorm = 48.3077, GNorm = 3.2643, lr_0 = 2.6139e-04
Loss = 2.5863e-03, PNorm = 48.3113, GNorm = 3.7333, lr_0 = 2.5032e-04
Validation rmse = 1.231833
Epoch 18
Loss = 2.9798e-03, PNorm = 48.3166, GNorm = 2.6552, lr_0 = 2.3972e-04
Loss = 2.3756e-03, PNorm = 48.3200, GNorm = 0.8226, lr_0 = 2.2956e-04
Validation rmse = 1.103042
Epoch 19
Loss = 2.8568e-03, PNorm = 48.3241, GNorm = 2.2838, lr_0 = 2.1889e-04
Loss = 2.2411e-03, PNorm = 48.3269, GNorm = 0.6978, lr_0 = 2.0962e-04
Validation rmse = 1.133855
Epoch 20
Loss = 2.3069e-03, PNorm = 48.3293, GNorm = 1.7751, lr_0 = 2.0074e-04
Loss = 2.1297e-03, PNorm = 48.3323, GNorm = 1.0179, lr_0 = 1.9224e-04
Validation rmse = 1.215628
Epoch 21
Loss = 2.1373e-03, PNorm = 48.3337, GNorm = 1.8269, lr_0 = 1.8409e-04
Loss = 2.2193e-03, PNorm = 48.3369, GNorm = 0.8848, lr_0 = 1.7630e-04
Validation rmse = 1.114748
Epoch 22
Loss = 1.8470e-03, PNorm = 48.3391, GNorm = 0.8499, lr_0 = 1.6810e-04
Loss = 1.9291e-03, PNorm = 48.3406, GNorm = 0.9976, lr_0 = 1.6098e-04
Validation rmse = 1.159062
Epoch 23
Loss = 1.6860e-03, PNorm = 48.3425, GNorm = 2.1165, lr_0 = 1.5416e-04
Loss = 1.8829e-03, PNorm = 48.3446, GNorm = 1.1618, lr_0 = 1.4763e-04
Loss = 4.2226e-03, PNorm = 48.3446, GNorm = 2.0296, lr_0 = 1.4699e-04
Validation rmse = 1.157390
Epoch 24
Loss = 1.7918e-03, PNorm = 48.3461, GNorm = 1.7080, lr_0 = 1.4077e-04
Loss = 2.2251e-03, PNorm = 48.3469, GNorm = 1.2724, lr_0 = 1.3480e-04
Validation rmse = 1.133782
Epoch 25
Loss = 2.3574e-03, PNorm = 48.3482, GNorm = 0.9575, lr_0 = 1.2909e-04
Loss = 2.1305e-03, PNorm = 48.3493, GNorm = 2.3696, lr_0 = 1.2362e-04
Validation rmse = 1.126551
Epoch 26
Loss = 2.0313e-03, PNorm = 48.3517, GNorm = 1.1234, lr_0 = 1.1839e-04
Validation rmse = 1.144185
Epoch 27
Loss = 1.4717e-03, PNorm = 48.3531, GNorm = 1.5139, lr_0 = 1.1288e-04
Loss = 1.9371e-03, PNorm = 48.3542, GNorm = 1.9446, lr_0 = 1.0810e-04
Validation rmse = 1.128313
Epoch 28
Loss = 2.2085e-03, PNorm = 48.3554, GNorm = 1.0785, lr_0 = 1.0352e-04
Loss = 1.6743e-03, PNorm = 48.3567, GNorm = 0.7518, lr_0 = 1.0000e-04
Validation rmse = 1.124709
Epoch 29
Loss = 1.8961e-03, PNorm = 48.3586, GNorm = 1.2979, lr_0 = 1.0000e-04
Loss = 2.1569e-03, PNorm = 48.3590, GNorm = 1.8630, lr_0 = 1.0000e-04
Validation rmse = 1.108856
Model 0 best validation rmse = 1.103042 on epoch 18
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.116240
Ensemble test rmse = 1.116240
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_500/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total scaffolds = 195 | train scaffolds = 80 | val scaffolds = 54 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=504, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=500, out_features=500, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 1,144,001
Moving model to cuda
Epoch 0
Loss = 2.0325e-02, PNorm = 47.8853, GNorm = 4.9424, lr_0 = 3.6053e-04
Validation rmse = 2.781350
Epoch 1
Loss = 1.8587e-02, PNorm = 47.9093, GNorm = 18.0132, lr_0 = 6.2105e-04
Loss = 8.0241e-03, PNorm = 47.9375, GNorm = 2.2227, lr_0 = 8.5789e-04
Validation rmse = 1.657488
Epoch 2
Loss = 7.4300e-03, PNorm = 47.9714, GNorm = 1.9908, lr_0 = 9.8284e-04
Loss = 5.2327e-03, PNorm = 48.0078, GNorm = 2.3680, lr_0 = 9.4120e-04
Validation rmse = 1.454130
Epoch 3
Loss = 6.1736e-03, PNorm = 48.0318, GNorm = 1.0085, lr_0 = 8.9744e-04
Loss = 4.6591e-03, PNorm = 48.0521, GNorm = 2.1066, lr_0 = 8.5943e-04
Validation rmse = 1.284793
Epoch 4
Loss = 4.5276e-03, PNorm = 48.0713, GNorm = 4.3365, lr_0 = 8.2303e-04
Loss = 5.5062e-03, PNorm = 48.0832, GNorm = 1.4023, lr_0 = 7.8816e-04
Validation rmse = 1.184926
Epoch 5
Loss = 5.0143e-03, PNorm = 48.1010, GNorm = 1.8164, lr_0 = 7.5478e-04
Loss = 3.2745e-03, PNorm = 48.1139, GNorm = 0.8941, lr_0 = 7.2281e-04
Validation rmse = 1.128990
Epoch 6
Loss = 3.1054e-03, PNorm = 48.1281, GNorm = 1.6924, lr_0 = 6.8920e-04
Loss = 3.1482e-03, PNorm = 48.1371, GNorm = 1.3260, lr_0 = 6.6001e-04
Validation rmse = 1.242715
Epoch 7
Loss = 3.2494e-03, PNorm = 48.1482, GNorm = 1.5983, lr_0 = 6.3205e-04
Loss = 3.4989e-03, PNorm = 48.1585, GNorm = 2.6844, lr_0 = 6.0528e-04
Validation rmse = 1.173176
Epoch 8
Loss = 3.1253e-03, PNorm = 48.1719, GNorm = 2.7320, lr_0 = 5.7714e-04
Loss = 3.0830e-03, PNorm = 48.1807, GNorm = 0.7932, lr_0 = 5.5269e-04
Validation rmse = 1.210382
Epoch 9
Loss = 2.9872e-03, PNorm = 48.1905, GNorm = 3.1966, lr_0 = 5.2928e-04
Loss = 2.2273e-03, PNorm = 48.1997, GNorm = 1.1485, lr_0 = 5.0686e-04
Validation rmse = 1.155726
Epoch 10
Loss = 2.6739e-03, PNorm = 48.2079, GNorm = 0.7936, lr_0 = 4.8539e-04
Loss = 2.9304e-03, PNorm = 48.2131, GNorm = 2.0010, lr_0 = 4.6483e-04
Validation rmse = 1.120725
Epoch 11
Loss = 2.3511e-03, PNorm = 48.2233, GNorm = 0.9494, lr_0 = 4.4322e-04
Loss = 2.3618e-03, PNorm = 48.2294, GNorm = 1.1243, lr_0 = 4.2444e-04
Validation rmse = 1.237265
Epoch 12
Loss = 2.9148e-03, PNorm = 48.2331, GNorm = 0.8850, lr_0 = 4.0646e-04
Loss = 2.3990e-03, PNorm = 48.2400, GNorm = 1.5407, lr_0 = 3.8925e-04
Validation rmse = 1.162437
Epoch 13
Loss = 2.4063e-03, PNorm = 48.2451, GNorm = 1.6840, lr_0 = 3.7276e-04
Loss = 2.3922e-03, PNorm = 48.2490, GNorm = 1.7194, lr_0 = 3.5697e-04
Validation rmse = 1.155979
Epoch 14
Loss = 2.3956e-03, PNorm = 48.2556, GNorm = 5.7838, lr_0 = 3.4037e-04
Loss = 2.3013e-03, PNorm = 48.2606, GNorm = 1.8374, lr_0 = 3.2596e-04
Validation rmse = 1.185069
Epoch 15
Loss = 2.1906e-03, PNorm = 48.2652, GNorm = 3.0145, lr_0 = 3.1215e-04
Loss = 2.6813e-03, PNorm = 48.2691, GNorm = 2.1858, lr_0 = 2.9893e-04
Validation rmse = 1.161991
Epoch 16
Loss = 1.9098e-03, PNorm = 48.2733, GNorm = 1.0597, lr_0 = 2.8503e-04
Loss = 2.2495e-03, PNorm = 48.2780, GNorm = 1.4765, lr_0 = 2.7295e-04
Validation rmse = 1.162135
Epoch 17
Loss = 1.8824e-03, PNorm = 48.2817, GNorm = 1.3663, lr_0 = 2.6139e-04
Loss = 2.0889e-03, PNorm = 48.2862, GNorm = 1.1505, lr_0 = 2.5032e-04
Validation rmse = 1.226839
Epoch 18
Loss = 2.0446e-03, PNorm = 48.2891, GNorm = 2.2399, lr_0 = 2.3972e-04
Loss = 1.8703e-03, PNorm = 48.2926, GNorm = 0.9434, lr_0 = 2.2956e-04
Validation rmse = 1.198811
Epoch 19
Loss = 2.0637e-03, PNorm = 48.2953, GNorm = 1.2090, lr_0 = 2.1889e-04
Loss = 1.9626e-03, PNorm = 48.2975, GNorm = 3.7580, lr_0 = 2.0962e-04
Validation rmse = 1.318933
Epoch 20
Loss = 2.1799e-03, PNorm = 48.2989, GNorm = 3.6443, lr_0 = 2.0074e-04
Loss = 2.1907e-03, PNorm = 48.3020, GNorm = 0.9922, lr_0 = 1.9224e-04
Validation rmse = 1.159372
Epoch 21
Loss = 2.0499e-03, PNorm = 48.3043, GNorm = 1.2803, lr_0 = 1.8409e-04
Loss = 2.1952e-03, PNorm = 48.3063, GNorm = 2.4410, lr_0 = 1.7630e-04
Validation rmse = 1.128430
Epoch 22
Loss = 2.1095e-03, PNorm = 48.3092, GNorm = 0.8457, lr_0 = 1.6810e-04
Loss = 2.0215e-03, PNorm = 48.3120, GNorm = 1.2780, lr_0 = 1.6098e-04
Validation rmse = 1.242260
Epoch 23
Loss = 1.8863e-03, PNorm = 48.3124, GNorm = 2.3150, lr_0 = 1.5416e-04
Loss = 1.9653e-03, PNorm = 48.3140, GNorm = 0.9820, lr_0 = 1.4763e-04
Loss = 4.4436e-03, PNorm = 48.3142, GNorm = 1.1049, lr_0 = 1.4699e-04
Validation rmse = 1.222521
Epoch 24
Loss = 1.8496e-03, PNorm = 48.3160, GNorm = 1.2763, lr_0 = 1.4077e-04
Loss = 1.6965e-03, PNorm = 48.3178, GNorm = 1.6836, lr_0 = 1.3480e-04
Validation rmse = 1.196152
Epoch 25
Loss = 1.8719e-03, PNorm = 48.3196, GNorm = 1.3076, lr_0 = 1.2909e-04
Loss = 1.6340e-03, PNorm = 48.3208, GNorm = 1.2701, lr_0 = 1.2362e-04
Validation rmse = 1.258154
Epoch 26
Loss = 1.9566e-03, PNorm = 48.3214, GNorm = 0.9646, lr_0 = 1.1839e-04
Validation rmse = 1.399765
Epoch 27
Loss = 2.1448e-03, PNorm = 48.3228, GNorm = 2.5788, lr_0 = 1.1288e-04
Loss = 2.1001e-03, PNorm = 48.3247, GNorm = 0.8641, lr_0 = 1.0810e-04
Validation rmse = 1.208736
Epoch 28
Loss = 1.6524e-03, PNorm = 48.3244, GNorm = 2.0767, lr_0 = 1.0352e-04
Loss = 1.5566e-03, PNorm = 48.3259, GNorm = 1.0455, lr_0 = 1.0000e-04
Validation rmse = 1.158842
Epoch 29
Loss = 1.4487e-03, PNorm = 48.3279, GNorm = 2.3860, lr_0 = 1.0000e-04
Loss = 1.6827e-03, PNorm = 48.3283, GNorm = 1.2090, lr_0 = 1.0000e-04
Validation rmse = 1.322064
Model 0 best validation rmse = 1.120725 on epoch 10
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.092693
Ensemble test rmse = 1.092693
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_500/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 49 | test scaffolds = 62
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=504, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=500, out_features=500, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 1,144,001
Moving model to cuda
Epoch 0
Loss = 2.0687e-02, PNorm = 47.8856, GNorm = 5.4219, lr_0 = 3.6053e-04
Validation rmse = 1.351050
Epoch 1
Loss = 7.8103e-03, PNorm = 47.9092, GNorm = 2.7196, lr_0 = 6.2105e-04
Loss = 7.0999e-03, PNorm = 47.9379, GNorm = 9.4428, lr_0 = 8.5789e-04
Validation rmse = 1.470498
Epoch 2
Loss = 8.3068e-03, PNorm = 47.9706, GNorm = 3.1159, lr_0 = 9.8284e-04
Loss = 5.3697e-03, PNorm = 48.0019, GNorm = 1.2081, lr_0 = 9.4120e-04
Validation rmse = 1.524099
Epoch 3
Loss = 5.3043e-03, PNorm = 48.0262, GNorm = 1.3018, lr_0 = 8.9744e-04
Loss = 5.4859e-03, PNorm = 48.0432, GNorm = 1.4224, lr_0 = 8.5943e-04
Validation rmse = 1.056426
Epoch 4
Loss = 5.4934e-03, PNorm = 48.0580, GNorm = 1.2140, lr_0 = 8.2303e-04
Loss = 4.2615e-03, PNorm = 48.0697, GNorm = 1.4363, lr_0 = 7.8816e-04
Validation rmse = 1.232029
Epoch 5
Loss = 2.6851e-03, PNorm = 48.0836, GNorm = 0.8397, lr_0 = 7.5478e-04
Loss = 4.2728e-03, PNorm = 48.0977, GNorm = 2.4000, lr_0 = 7.2281e-04
Validation rmse = 1.007225
Epoch 6
Loss = 3.7959e-03, PNorm = 48.1134, GNorm = 2.7401, lr_0 = 6.8920e-04
Loss = 4.5867e-03, PNorm = 48.1282, GNorm = 3.3490, lr_0 = 6.6001e-04
Validation rmse = 1.134631
Epoch 7
Loss = 3.0146e-03, PNorm = 48.1419, GNorm = 1.1780, lr_0 = 6.3205e-04
Loss = 5.0889e-03, PNorm = 48.1547, GNorm = 2.7849, lr_0 = 6.0528e-04
Validation rmse = 1.037315
Epoch 8
Loss = 4.1713e-03, PNorm = 48.1742, GNorm = 1.9202, lr_0 = 5.7714e-04
Loss = 3.9959e-03, PNorm = 48.1844, GNorm = 1.4829, lr_0 = 5.5269e-04
Validation rmse = 1.029649
Epoch 9
Loss = 2.8443e-03, PNorm = 48.1981, GNorm = 2.1417, lr_0 = 5.2928e-04
Loss = 3.3346e-03, PNorm = 48.2068, GNorm = 1.4757, lr_0 = 5.0686e-04
Validation rmse = 1.367098
Epoch 10
Loss = 3.4033e-03, PNorm = 48.2160, GNorm = 1.5569, lr_0 = 4.8539e-04
Loss = 3.3936e-03, PNorm = 48.2270, GNorm = 1.2755, lr_0 = 4.6483e-04
Validation rmse = 1.159877
Epoch 11
Loss = 3.6226e-03, PNorm = 48.2336, GNorm = 1.6756, lr_0 = 4.4322e-04
Loss = 2.9628e-03, PNorm = 48.2428, GNorm = 1.5258, lr_0 = 4.2444e-04
Validation rmse = 1.293365
Epoch 12
Loss = 2.3269e-03, PNorm = 48.2479, GNorm = 2.2578, lr_0 = 4.0646e-04
Loss = 2.7270e-03, PNorm = 48.2552, GNorm = 1.3764, lr_0 = 3.8925e-04
Validation rmse = 1.198603
Epoch 13
Loss = 2.1569e-03, PNorm = 48.2599, GNorm = 2.2050, lr_0 = 3.7276e-04
Loss = 2.5103e-03, PNorm = 48.2666, GNorm = 1.5623, lr_0 = 3.5697e-04
Validation rmse = 1.260024
Epoch 14
Loss = 2.1412e-03, PNorm = 48.2714, GNorm = 1.4772, lr_0 = 3.4037e-04
Loss = 2.6476e-03, PNorm = 48.2762, GNorm = 0.7239, lr_0 = 3.2596e-04
Validation rmse = 1.014136
Epoch 15
Loss = 2.2465e-03, PNorm = 48.2805, GNorm = 0.7078, lr_0 = 3.1215e-04
Loss = 2.6927e-03, PNorm = 48.2832, GNorm = 2.2008, lr_0 = 2.9893e-04
Validation rmse = 1.151063
Epoch 16
Loss = 2.1642e-03, PNorm = 48.2886, GNorm = 1.1870, lr_0 = 2.8503e-04
Loss = 2.2002e-03, PNorm = 48.2906, GNorm = 0.6434, lr_0 = 2.7295e-04
Validation rmse = 1.029981
Epoch 17
Loss = 2.2335e-03, PNorm = 48.2949, GNorm = 1.0459, lr_0 = 2.6139e-04
Loss = 2.3648e-03, PNorm = 48.2972, GNorm = 1.4904, lr_0 = 2.5032e-04
Validation rmse = 1.222686
Epoch 18
Loss = 2.2953e-03, PNorm = 48.3001, GNorm = 1.1542, lr_0 = 2.3972e-04
Loss = 2.2950e-03, PNorm = 48.3025, GNorm = 1.8226, lr_0 = 2.2956e-04
Validation rmse = 0.963629
Epoch 19
Loss = 2.0922e-03, PNorm = 48.3055, GNorm = 1.0251, lr_0 = 2.1889e-04
Loss = 2.1325e-03, PNorm = 48.3086, GNorm = 0.8778, lr_0 = 2.0962e-04
Validation rmse = 1.222398
Epoch 20
Loss = 2.1987e-03, PNorm = 48.3118, GNorm = 1.3176, lr_0 = 2.0074e-04
Loss = 1.9157e-03, PNorm = 48.3131, GNorm = 1.8732, lr_0 = 1.9224e-04
Validation rmse = 1.344851
Epoch 21
Loss = 2.2848e-03, PNorm = 48.3154, GNorm = 1.9114, lr_0 = 1.8409e-04
Loss = 2.1396e-03, PNorm = 48.3182, GNorm = 1.8825, lr_0 = 1.7630e-04
Validation rmse = 1.036870
Epoch 22
Loss = 2.0776e-03, PNorm = 48.3209, GNorm = 1.3156, lr_0 = 1.6810e-04
Loss = 1.9496e-03, PNorm = 48.3216, GNorm = 0.6589, lr_0 = 1.6098e-04
Validation rmse = 1.282292
Epoch 23
Loss = 2.0774e-03, PNorm = 48.3243, GNorm = 2.2422, lr_0 = 1.5416e-04
Loss = 2.0307e-03, PNorm = 48.3256, GNorm = 1.2903, lr_0 = 1.4763e-04
Loss = 3.7230e-03, PNorm = 48.3257, GNorm = 0.9082, lr_0 = 1.4699e-04
Validation rmse = 1.133171
Epoch 24
Loss = 1.8175e-03, PNorm = 48.3271, GNorm = 1.4464, lr_0 = 1.4077e-04
Loss = 2.0317e-03, PNorm = 48.3286, GNorm = 0.8897, lr_0 = 1.3480e-04
Validation rmse = 1.436645
Epoch 25
Loss = 1.9660e-03, PNorm = 48.3303, GNorm = 1.3493, lr_0 = 1.2909e-04
Loss = 2.4913e-03, PNorm = 48.3317, GNorm = 1.3848, lr_0 = 1.2362e-04
Validation rmse = 1.105862
Epoch 26
Loss = 1.8091e-03, PNorm = 48.3328, GNorm = 0.6470, lr_0 = 1.1839e-04
Validation rmse = 1.080311
Epoch 27
Loss = 1.8395e-03, PNorm = 48.3348, GNorm = 2.0494, lr_0 = 1.1288e-04
Loss = 1.7805e-03, PNorm = 48.3351, GNorm = 0.8948, lr_0 = 1.0810e-04
Validation rmse = 1.112345
Epoch 28
Loss = 1.2654e-03, PNorm = 48.3366, GNorm = 1.0496, lr_0 = 1.0352e-04
Loss = 1.8053e-03, PNorm = 48.3374, GNorm = 0.6999, lr_0 = 1.0000e-04
Validation rmse = 1.149408
Epoch 29
Loss = 1.4607e-03, PNorm = 48.3382, GNorm = 0.8353, lr_0 = 1.0000e-04
Loss = 1.7928e-03, PNorm = 48.3393, GNorm = 0.8052, lr_0 = 1.0000e-04
Validation rmse = 1.184265
Model 0 best validation rmse = 0.963629 on epoch 18
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.114840
Ensemble test rmse = 1.114840
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_500/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total scaffolds = 195 | train scaffolds = 94 | val scaffolds = 55 | test scaffolds = 46
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=504, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=500, out_features=500, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 1,144,001
Moving model to cuda
Epoch 0
Loss = 1.8893e-02, PNorm = 47.8864, GNorm = 8.7086, lr_0 = 3.6053e-04
Validation rmse = 1.748225
Epoch 1
Loss = 1.1603e-02, PNorm = 47.9079, GNorm = 8.0912, lr_0 = 6.2105e-04
Loss = 7.4017e-03, PNorm = 47.9374, GNorm = 2.8434, lr_0 = 8.5789e-04
Validation rmse = 1.729492
Epoch 2
Loss = 7.2098e-03, PNorm = 47.9720, GNorm = 3.0903, lr_0 = 9.8284e-04
Loss = 5.5127e-03, PNorm = 48.0054, GNorm = 1.5212, lr_0 = 9.4120e-04
Validation rmse = 1.466198
Epoch 3
Loss = 7.0861e-03, PNorm = 48.0301, GNorm = 1.8865, lr_0 = 8.9744e-04
Loss = 4.9207e-03, PNorm = 48.0499, GNorm = 1.7242, lr_0 = 8.5943e-04
Validation rmse = 1.468761
Epoch 4
Loss = 4.0174e-03, PNorm = 48.0632, GNorm = 1.4576, lr_0 = 8.2303e-04
Loss = 4.8125e-03, PNorm = 48.0759, GNorm = 1.4036, lr_0 = 7.8816e-04
Validation rmse = 1.226713
Epoch 5
Loss = 4.8815e-03, PNorm = 48.0916, GNorm = 4.3849, lr_0 = 7.5478e-04
Loss = 4.4073e-03, PNorm = 48.1017, GNorm = 2.4997, lr_0 = 7.2281e-04
Validation rmse = 1.262285
Epoch 6
Loss = 4.2514e-03, PNorm = 48.1175, GNorm = 1.2028, lr_0 = 6.8920e-04
Loss = 3.9543e-03, PNorm = 48.1314, GNorm = 2.2454, lr_0 = 6.6001e-04
Validation rmse = 1.495820
Epoch 7
Loss = 4.0999e-03, PNorm = 48.1372, GNorm = 1.6706, lr_0 = 6.3205e-04
Loss = 3.4250e-03, PNorm = 48.1486, GNorm = 1.9967, lr_0 = 6.0528e-04
Validation rmse = 1.465199
Epoch 8
Loss = 3.3989e-03, PNorm = 48.1567, GNorm = 0.6588, lr_0 = 5.7714e-04
Loss = 3.6556e-03, PNorm = 48.1662, GNorm = 1.4306, lr_0 = 5.5269e-04
Validation rmse = 1.244925
Epoch 9
Loss = 3.1336e-03, PNorm = 48.1754, GNorm = 1.8226, lr_0 = 5.2928e-04
Loss = 2.8510e-03, PNorm = 48.1832, GNorm = 1.6226, lr_0 = 5.0686e-04
Validation rmse = 1.244362
Epoch 10
Loss = 3.2598e-03, PNorm = 48.1904, GNorm = 2.2359, lr_0 = 4.8539e-04
Loss = 3.4520e-03, PNorm = 48.1979, GNorm = 1.9390, lr_0 = 4.6483e-04
Validation rmse = 1.255669
Epoch 11
Loss = 2.6370e-03, PNorm = 48.2060, GNorm = 2.2115, lr_0 = 4.4322e-04
Loss = 3.2329e-03, PNorm = 48.2157, GNorm = 4.8283, lr_0 = 4.2444e-04
Validation rmse = 1.414340
Epoch 12
Loss = 2.7507e-03, PNorm = 48.2205, GNorm = 1.2025, lr_0 = 4.0646e-04
Loss = 2.8899e-03, PNorm = 48.2265, GNorm = 2.0600, lr_0 = 3.8925e-04
Validation rmse = 1.204811
Epoch 13
Loss = 2.4744e-03, PNorm = 48.2326, GNorm = 0.8518, lr_0 = 3.7276e-04
Loss = 2.6390e-03, PNorm = 48.2364, GNorm = 0.9586, lr_0 = 3.5697e-04
Validation rmse = 1.475048
Epoch 14
Loss = 2.7857e-03, PNorm = 48.2432, GNorm = 1.1428, lr_0 = 3.4037e-04
Loss = 2.2866e-03, PNorm = 48.2486, GNorm = 1.9582, lr_0 = 3.2596e-04
Validation rmse = 1.235723
Epoch 15
Loss = 2.4878e-03, PNorm = 48.2538, GNorm = 1.1993, lr_0 = 3.1215e-04
Loss = 2.3525e-03, PNorm = 48.2584, GNorm = 0.9475, lr_0 = 2.9893e-04
Validation rmse = 1.081784
Epoch 16
Loss = 2.4594e-03, PNorm = 48.2614, GNorm = 1.9009, lr_0 = 2.8503e-04
Loss = 2.3386e-03, PNorm = 48.2663, GNorm = 0.9788, lr_0 = 2.7295e-04
Validation rmse = 1.077328
Epoch 17
Loss = 2.4939e-03, PNorm = 48.2694, GNorm = 2.0376, lr_0 = 2.6139e-04
Loss = 2.1638e-03, PNorm = 48.2735, GNorm = 0.9132, lr_0 = 2.5032e-04
Validation rmse = 1.129988
Epoch 18
Loss = 2.2550e-03, PNorm = 48.2758, GNorm = 1.0933, lr_0 = 2.3972e-04
Loss = 2.4258e-03, PNorm = 48.2801, GNorm = 1.6958, lr_0 = 2.2956e-04
Validation rmse = 1.189643
Epoch 19
Loss = 2.7293e-03, PNorm = 48.2823, GNorm = 1.6486, lr_0 = 2.1889e-04
Loss = 2.8003e-03, PNorm = 48.2862, GNorm = 1.8171, lr_0 = 2.0962e-04
Validation rmse = 1.132216
Epoch 20
Loss = 2.6628e-03, PNorm = 48.2884, GNorm = 1.6474, lr_0 = 2.0074e-04
Loss = 2.4807e-03, PNorm = 48.2937, GNorm = 1.9941, lr_0 = 1.9224e-04
Validation rmse = 1.080246
Epoch 21
Loss = 2.1264e-03, PNorm = 48.2948, GNorm = 1.8579, lr_0 = 1.8409e-04
Loss = 2.1210e-03, PNorm = 48.2977, GNorm = 1.5365, lr_0 = 1.7630e-04
Validation rmse = 1.200786
Epoch 22
Loss = 2.2578e-03, PNorm = 48.2995, GNorm = 0.8900, lr_0 = 1.6810e-04
Loss = 2.3961e-03, PNorm = 48.3020, GNorm = 0.6694, lr_0 = 1.6098e-04
Validation rmse = 1.161418
Epoch 23
Loss = 2.0605e-03, PNorm = 48.3037, GNorm = 1.5718, lr_0 = 1.5416e-04
Loss = 1.8871e-03, PNorm = 48.3053, GNorm = 1.3100, lr_0 = 1.4763e-04
Loss = 2.0819e-03, PNorm = 48.3055, GNorm = 1.8052, lr_0 = 1.4699e-04
Validation rmse = 1.124437
Epoch 24
Loss = 1.9465e-03, PNorm = 48.3074, GNorm = 0.8416, lr_0 = 1.4077e-04
Loss = 2.0368e-03, PNorm = 48.3084, GNorm = 2.1865, lr_0 = 1.3480e-04
Validation rmse = 1.250692
Epoch 25
Loss = 1.9403e-03, PNorm = 48.3100, GNorm = 2.3729, lr_0 = 1.2909e-04
Loss = 2.1086e-03, PNorm = 48.3119, GNorm = 1.8853, lr_0 = 1.2362e-04
Validation rmse = 1.157515
Epoch 26
Loss = 1.8598e-03, PNorm = 48.3133, GNorm = 1.0041, lr_0 = 1.1839e-04
Validation rmse = 1.108995
Epoch 27
Loss = 2.1721e-03, PNorm = 48.3150, GNorm = 0.8786, lr_0 = 1.1288e-04
Loss = 1.9751e-03, PNorm = 48.3159, GNorm = 1.4630, lr_0 = 1.0810e-04
Validation rmse = 1.100964
Epoch 28
Loss = 1.0220e-03, PNorm = 48.3165, GNorm = 0.6422, lr_0 = 1.0352e-04
Loss = 1.9062e-03, PNorm = 48.3176, GNorm = 1.0732, lr_0 = 1.0000e-04
Validation rmse = 1.138078
Epoch 29
Loss = 1.9871e-03, PNorm = 48.3188, GNorm = 2.7458, lr_0 = 1.0000e-04
Loss = 1.8764e-03, PNorm = 48.3198, GNorm = 1.0681, lr_0 = 1.0000e-04
Validation rmse = 1.069234
Model 0 best validation rmse = 1.069234 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.183250
Ensemble test rmse = 1.183250
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_500/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total scaffolds = 195 | train scaffolds = 64 | val scaffolds = 68 | test scaffolds = 63
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=504, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=500, out_features=500, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 1,144,001
Moving model to cuda
Epoch 0
Loss = 1.9391e-02, PNorm = 47.8846, GNorm = 3.0516, lr_0 = 3.6053e-04
Validation rmse = 1.290968
Epoch 1
Loss = 8.0770e-03, PNorm = 47.9071, GNorm = 4.5614, lr_0 = 6.2105e-04
Loss = 7.3453e-03, PNorm = 47.9350, GNorm = 4.8575, lr_0 = 8.5789e-04
Validation rmse = 1.376029
Epoch 2
Loss = 4.9911e-03, PNorm = 47.9713, GNorm = 2.1861, lr_0 = 9.8284e-04
Loss = 5.4662e-03, PNorm = 48.0025, GNorm = 1.4186, lr_0 = 9.4120e-04
Validation rmse = 1.489839
Epoch 3
Loss = 4.8243e-03, PNorm = 48.0284, GNorm = 2.9136, lr_0 = 8.9744e-04
Loss = 5.0718e-03, PNorm = 48.0486, GNorm = 2.1587, lr_0 = 8.5943e-04
Validation rmse = 1.477133
Epoch 4
Loss = 3.8300e-03, PNorm = 48.0627, GNorm = 0.7183, lr_0 = 8.2303e-04
Loss = 5.2119e-03, PNorm = 48.0786, GNorm = 1.1443, lr_0 = 7.8816e-04
Validation rmse = 1.242335
Epoch 5
Loss = 3.4130e-03, PNorm = 48.0907, GNorm = 1.1007, lr_0 = 7.5478e-04
Loss = 3.5064e-03, PNorm = 48.1037, GNorm = 1.1535, lr_0 = 7.2281e-04
Validation rmse = 1.426055
Epoch 6
Loss = 4.2786e-03, PNorm = 48.1174, GNorm = 1.9614, lr_0 = 6.8920e-04
Loss = 3.6357e-03, PNorm = 48.1338, GNorm = 1.2839, lr_0 = 6.6001e-04
Validation rmse = 1.150398
Epoch 7
Loss = 2.8357e-03, PNorm = 48.1468, GNorm = 1.6218, lr_0 = 6.3205e-04
Loss = 3.2957e-03, PNorm = 48.1577, GNorm = 2.2047, lr_0 = 6.0528e-04
Validation rmse = 1.217780
Epoch 8
Loss = 3.3285e-03, PNorm = 48.1684, GNorm = 1.1423, lr_0 = 5.7714e-04
Loss = 2.9650e-03, PNorm = 48.1784, GNorm = 0.9280, lr_0 = 5.5269e-04
Validation rmse = 1.347178
Epoch 9
Loss = 2.4566e-03, PNorm = 48.1873, GNorm = 2.4056, lr_0 = 5.2928e-04
Loss = 2.7356e-03, PNorm = 48.1972, GNorm = 0.7566, lr_0 = 5.0686e-04
Validation rmse = 1.227253
Epoch 10
Loss = 2.8364e-03, PNorm = 48.2058, GNorm = 1.1547, lr_0 = 4.8539e-04
Loss = 2.4467e-03, PNorm = 48.2147, GNorm = 1.3034, lr_0 = 4.6483e-04
Validation rmse = 1.104739
Epoch 11
Loss = 2.8151e-03, PNorm = 48.2200, GNorm = 1.0617, lr_0 = 4.4322e-04
Loss = 2.9166e-03, PNorm = 48.2279, GNorm = 2.7762, lr_0 = 4.2444e-04
Validation rmse = 1.146218
Epoch 12
Loss = 2.5425e-03, PNorm = 48.2355, GNorm = 1.0545, lr_0 = 4.0646e-04
Loss = 2.7981e-03, PNorm = 48.2390, GNorm = 1.6155, lr_0 = 3.8925e-04
Validation rmse = 1.153873
Epoch 13
Loss = 2.5794e-03, PNorm = 48.2464, GNorm = 0.7922, lr_0 = 3.7276e-04
Loss = 2.5159e-03, PNorm = 48.2519, GNorm = 0.8929, lr_0 = 3.5697e-04
Validation rmse = 1.181415
Epoch 14
Loss = 2.4589e-03, PNorm = 48.2562, GNorm = 0.9751, lr_0 = 3.4037e-04
Loss = 2.7997e-03, PNorm = 48.2634, GNorm = 1.6835, lr_0 = 3.2596e-04
Validation rmse = 1.621624
Epoch 15
Loss = 2.5332e-03, PNorm = 48.2649, GNorm = 1.4657, lr_0 = 3.1215e-04
Loss = 2.7710e-03, PNorm = 48.2706, GNorm = 2.7369, lr_0 = 2.9893e-04
Validation rmse = 1.176138
Epoch 16
Loss = 1.9210e-03, PNorm = 48.2780, GNorm = 1.0075, lr_0 = 2.8503e-04
Loss = 2.1202e-03, PNorm = 48.2805, GNorm = 0.9470, lr_0 = 2.7295e-04
Validation rmse = 1.145489
Epoch 17
Loss = 2.3451e-03, PNorm = 48.2849, GNorm = 2.4995, lr_0 = 2.6139e-04
Loss = 2.1568e-03, PNorm = 48.2890, GNorm = 1.6265, lr_0 = 2.5032e-04
Validation rmse = 1.131087
Epoch 18
Loss = 2.4975e-03, PNorm = 48.2907, GNorm = 1.0177, lr_0 = 2.3972e-04
Loss = 2.0903e-03, PNorm = 48.2939, GNorm = 1.7883, lr_0 = 2.2956e-04
Validation rmse = 1.128392
Epoch 19
Loss = 2.5392e-03, PNorm = 48.2968, GNorm = 1.7614, lr_0 = 2.1889e-04
Loss = 2.1303e-03, PNorm = 48.2995, GNorm = 0.8326, lr_0 = 2.0962e-04
Validation rmse = 1.185446
Epoch 20
Loss = 1.9656e-03, PNorm = 48.3032, GNorm = 2.2990, lr_0 = 2.0074e-04
Loss = 2.0264e-03, PNorm = 48.3046, GNorm = 0.8170, lr_0 = 1.9224e-04
Validation rmse = 1.191328
Epoch 21
Loss = 1.9586e-03, PNorm = 48.3080, GNorm = 1.3398, lr_0 = 1.8409e-04
Loss = 2.2112e-03, PNorm = 48.3104, GNorm = 2.0836, lr_0 = 1.7630e-04
Validation rmse = 1.242010
Epoch 22
Loss = 2.2589e-03, PNorm = 48.3138, GNorm = 0.8488, lr_0 = 1.6810e-04
Loss = 1.9803e-03, PNorm = 48.3143, GNorm = 0.6509, lr_0 = 1.6098e-04
Validation rmse = 1.288019
Epoch 23
Loss = 2.0655e-03, PNorm = 48.3168, GNorm = 1.1977, lr_0 = 1.5416e-04
Loss = 1.8774e-03, PNorm = 48.3186, GNorm = 0.9570, lr_0 = 1.4763e-04
Loss = 4.3639e-03, PNorm = 48.3187, GNorm = 1.5496, lr_0 = 1.4699e-04
Validation rmse = 1.202491
Epoch 24
Loss = 1.9351e-03, PNorm = 48.3198, GNorm = 0.8654, lr_0 = 1.4077e-04
Loss = 1.7864e-03, PNorm = 48.3224, GNorm = 2.3285, lr_0 = 1.3480e-04
Validation rmse = 1.290025
Epoch 25
Loss = 1.8517e-03, PNorm = 48.3243, GNorm = 1.8168, lr_0 = 1.2909e-04
Loss = 1.8238e-03, PNorm = 48.3258, GNorm = 2.1769, lr_0 = 1.2362e-04
Validation rmse = 1.186892
Epoch 26
Loss = 1.6849e-03, PNorm = 48.3256, GNorm = 1.0079, lr_0 = 1.1839e-04
Validation rmse = 1.249400
Epoch 27
Loss = 2.5901e-03, PNorm = 48.3283, GNorm = 1.2133, lr_0 = 1.1288e-04
Loss = 1.7987e-03, PNorm = 48.3289, GNorm = 0.7386, lr_0 = 1.0810e-04
Validation rmse = 1.214278
Epoch 28
Loss = 1.2915e-03, PNorm = 48.3306, GNorm = 1.5869, lr_0 = 1.0352e-04
Loss = 1.9090e-03, PNorm = 48.3315, GNorm = 1.3033, lr_0 = 1.0000e-04
Validation rmse = 1.297633
Epoch 29
Loss = 1.8113e-03, PNorm = 48.3323, GNorm = 1.4645, lr_0 = 1.0000e-04
Loss = 1.6571e-03, PNorm = 48.3338, GNorm = 2.0775, lr_0 = 1.0000e-04
Validation rmse = 1.309204
Model 0 best validation rmse = 1.104739 on epoch 10
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.968258
Ensemble test rmse = 0.968258
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_500/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total scaffolds = 195 | train scaffolds = 69 | val scaffolds = 65 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=504, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=500, out_features=500, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 1,144,001
Moving model to cuda
Epoch 0
Loss = 1.8646e-02, PNorm = 47.8859, GNorm = 7.2374, lr_0 = 3.6053e-04
Validation rmse = 1.489649
Epoch 1
Loss = 6.7386e-03, PNorm = 47.9077, GNorm = 2.4283, lr_0 = 6.2105e-04
Loss = 7.5539e-03, PNorm = 47.9363, GNorm = 2.1724, lr_0 = 8.5789e-04
Validation rmse = 2.245245
Epoch 2
Loss = 5.3128e-03, PNorm = 47.9725, GNorm = 2.1493, lr_0 = 9.8284e-04
Loss = 5.2793e-03, PNorm = 48.0085, GNorm = 4.5800, lr_0 = 9.4120e-04
Validation rmse = 2.280869
Epoch 3
Loss = 5.2467e-03, PNorm = 48.0326, GNorm = 1.8185, lr_0 = 8.9744e-04
Loss = 5.6654e-03, PNorm = 48.0557, GNorm = 1.4614, lr_0 = 8.5943e-04
Validation rmse = 1.774681
Epoch 4
Loss = 4.8789e-03, PNorm = 48.0741, GNorm = 1.2644, lr_0 = 8.2303e-04
Loss = 4.3774e-03, PNorm = 48.0904, GNorm = 3.2530, lr_0 = 7.8816e-04
Validation rmse = 1.340752
Epoch 5
Loss = 4.5718e-03, PNorm = 48.1042, GNorm = 1.9456, lr_0 = 7.5478e-04
Loss = 3.5929e-03, PNorm = 48.1146, GNorm = 0.6753, lr_0 = 7.2281e-04
Validation rmse = 1.750230
Epoch 6
Loss = 4.0365e-03, PNorm = 48.1249, GNorm = 4.1957, lr_0 = 6.8920e-04
Loss = 4.3984e-03, PNorm = 48.1384, GNorm = 3.0783, lr_0 = 6.6001e-04
Validation rmse = 1.864070
Epoch 7
Loss = 4.3248e-03, PNorm = 48.1530, GNorm = 1.3905, lr_0 = 6.3205e-04
Loss = 3.9569e-03, PNorm = 48.1638, GNorm = 2.8535, lr_0 = 6.0528e-04
Validation rmse = 1.352896
Epoch 8
Loss = 4.3269e-03, PNorm = 48.1757, GNorm = 2.0135, lr_0 = 5.7714e-04
Loss = 3.5176e-03, PNorm = 48.1879, GNorm = 2.3368, lr_0 = 5.5269e-04
Validation rmse = 1.630796
Epoch 9
Loss = 3.4542e-03, PNorm = 48.1942, GNorm = 1.6404, lr_0 = 5.2928e-04
Loss = 3.1373e-03, PNorm = 48.2048, GNorm = 1.9064, lr_0 = 5.0686e-04
Validation rmse = 1.764972
Epoch 10
Loss = 3.3353e-03, PNorm = 48.2119, GNorm = 1.4275, lr_0 = 4.8539e-04
Loss = 3.1364e-03, PNorm = 48.2188, GNorm = 1.2863, lr_0 = 4.6483e-04
Validation rmse = 1.571150
Epoch 11
Loss = 2.9817e-03, PNorm = 48.2283, GNorm = 1.1866, lr_0 = 4.4322e-04
Loss = 2.7216e-03, PNorm = 48.2345, GNorm = 2.6303, lr_0 = 4.2444e-04
Validation rmse = 1.299378
Epoch 12
Loss = 2.9885e-03, PNorm = 48.2398, GNorm = 2.6487, lr_0 = 4.0646e-04
Loss = 2.9650e-03, PNorm = 48.2489, GNorm = 0.6377, lr_0 = 3.8925e-04
Validation rmse = 1.416127
Epoch 13
Loss = 3.5712e-03, PNorm = 48.2556, GNorm = 0.8516, lr_0 = 3.7276e-04
Loss = 2.6870e-03, PNorm = 48.2632, GNorm = 1.0230, lr_0 = 3.5697e-04
Validation rmse = 1.443180
Epoch 14
Loss = 2.5561e-03, PNorm = 48.2716, GNorm = 1.2291, lr_0 = 3.4037e-04
Loss = 2.4724e-03, PNorm = 48.2748, GNorm = 1.0042, lr_0 = 3.2596e-04
Validation rmse = 1.617070
Epoch 15
Loss = 2.3079e-03, PNorm = 48.2802, GNorm = 1.4807, lr_0 = 3.1215e-04
Loss = 2.5743e-03, PNorm = 48.2857, GNorm = 1.4397, lr_0 = 2.9893e-04
Validation rmse = 1.485468
Epoch 16
Loss = 2.4412e-03, PNorm = 48.2886, GNorm = 0.7566, lr_0 = 2.8503e-04
Loss = 2.0303e-03, PNorm = 48.2929, GNorm = 1.2440, lr_0 = 2.7295e-04
Validation rmse = 1.703828
Epoch 17
Loss = 2.4195e-03, PNorm = 48.2960, GNorm = 1.2414, lr_0 = 2.6139e-04
Loss = 2.2317e-03, PNorm = 48.3008, GNorm = 1.5594, lr_0 = 2.5032e-04
Validation rmse = 1.378765
Epoch 18
Loss = 1.8352e-03, PNorm = 48.3038, GNorm = 1.3357, lr_0 = 2.3972e-04
Loss = 2.2882e-03, PNorm = 48.3075, GNorm = 0.7200, lr_0 = 2.2956e-04
Validation rmse = 1.429595
Epoch 19
Loss = 2.1311e-03, PNorm = 48.3102, GNorm = 1.6648, lr_0 = 2.1889e-04
Loss = 1.9456e-03, PNorm = 48.3135, GNorm = 1.7756, lr_0 = 2.0962e-04
Validation rmse = 1.377842
Epoch 20
Loss = 2.3453e-03, PNorm = 48.3164, GNorm = 1.0938, lr_0 = 2.0074e-04
Loss = 1.9018e-03, PNorm = 48.3193, GNorm = 0.7791, lr_0 = 1.9224e-04
Validation rmse = 1.529459
Epoch 21
Loss = 2.1291e-03, PNorm = 48.3214, GNorm = 1.6270, lr_0 = 1.8409e-04
Loss = 1.9799e-03, PNorm = 48.3250, GNorm = 1.1541, lr_0 = 1.7630e-04
Validation rmse = 1.645061
Epoch 22
Loss = 1.9087e-03, PNorm = 48.3259, GNorm = 1.6461, lr_0 = 1.6810e-04
Loss = 1.9360e-03, PNorm = 48.3294, GNorm = 1.7259, lr_0 = 1.6098e-04
Validation rmse = 1.493338
Epoch 23
Loss = 1.8012e-03, PNorm = 48.3321, GNorm = 0.9765, lr_0 = 1.5416e-04
Loss = 2.1001e-03, PNorm = 48.3332, GNorm = 1.7278, lr_0 = 1.4763e-04
Loss = 4.0701e-03, PNorm = 48.3334, GNorm = 1.2407, lr_0 = 1.4699e-04
Validation rmse = 1.455464
Epoch 24
Loss = 2.0013e-03, PNorm = 48.3353, GNorm = 0.6193, lr_0 = 1.4077e-04
Loss = 1.9250e-03, PNorm = 48.3372, GNorm = 1.2996, lr_0 = 1.3480e-04
Validation rmse = 1.486687
Epoch 25
Loss = 1.7691e-03, PNorm = 48.3387, GNorm = 1.2701, lr_0 = 1.2909e-04
Loss = 2.2022e-03, PNorm = 48.3400, GNorm = 2.6293, lr_0 = 1.2362e-04
Validation rmse = 1.496358
Epoch 26
Loss = 1.9016e-03, PNorm = 48.3423, GNorm = 1.5425, lr_0 = 1.1839e-04
Validation rmse = 1.572143
Epoch 27
Loss = 1.1822e-03, PNorm = 48.3428, GNorm = 1.1484, lr_0 = 1.1288e-04
Loss = 1.7538e-03, PNorm = 48.3447, GNorm = 1.1473, lr_0 = 1.0810e-04
Validation rmse = 1.515709
Epoch 28
Loss = 2.2291e-03, PNorm = 48.3459, GNorm = 1.7740, lr_0 = 1.0352e-04
Loss = 1.6060e-03, PNorm = 48.3465, GNorm = 0.9830, lr_0 = 1.0000e-04
Validation rmse = 1.581781
Epoch 29
Loss = 2.1934e-03, PNorm = 48.3487, GNorm = 1.7657, lr_0 = 1.0000e-04
Loss = 1.7354e-03, PNorm = 48.3499, GNorm = 1.0401, lr_0 = 1.0000e-04
Validation rmse = 1.566112
Model 0 best validation rmse = 1.299378 on epoch 11
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.038967
Ensemble test rmse = 1.038967
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_500/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total scaffolds = 195 | train scaffolds = 75 | val scaffolds = 42 | test scaffolds = 78
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=504, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=500, out_features=500, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 1,144,001
Moving model to cuda
Epoch 0
Loss = 1.8781e-02, PNorm = 47.8859, GNorm = 4.5468, lr_0 = 3.6053e-04
Validation rmse = 2.002911
Epoch 1
Loss = 8.7007e-03, PNorm = 47.9098, GNorm = 4.8918, lr_0 = 6.2105e-04
Loss = 8.8346e-03, PNorm = 47.9390, GNorm = 5.0989, lr_0 = 8.5789e-04
Validation rmse = 1.135343
Epoch 2
Loss = 6.2876e-03, PNorm = 47.9750, GNorm = 4.0922, lr_0 = 9.8284e-04
Loss = 5.3700e-03, PNorm = 48.0057, GNorm = 2.7120, lr_0 = 9.4120e-04
Validation rmse = 1.331230
Epoch 3
Loss = 3.5031e-03, PNorm = 48.0314, GNorm = 1.0737, lr_0 = 8.9744e-04
Loss = 4.5745e-03, PNorm = 48.0514, GNorm = 2.4356, lr_0 = 8.5943e-04
Validation rmse = 1.267476
Epoch 4
Loss = 4.3642e-03, PNorm = 48.0689, GNorm = 1.6555, lr_0 = 8.2303e-04
Loss = 4.6890e-03, PNorm = 48.0828, GNorm = 1.3205, lr_0 = 7.8816e-04
Validation rmse = 1.189609
Epoch 5
Loss = 2.5135e-03, PNorm = 48.0986, GNorm = 0.8828, lr_0 = 7.5478e-04
Loss = 3.9615e-03, PNorm = 48.1091, GNorm = 1.2998, lr_0 = 7.2281e-04
Validation rmse = 1.369073
Epoch 6
Loss = 3.1583e-03, PNorm = 48.1240, GNorm = 1.4718, lr_0 = 6.8920e-04
Loss = 3.2014e-03, PNorm = 48.1359, GNorm = 1.7808, lr_0 = 6.6001e-04
Validation rmse = 1.297798
Epoch 7
Loss = 3.7399e-03, PNorm = 48.1466, GNorm = 3.2061, lr_0 = 6.3205e-04
Loss = 3.3863e-03, PNorm = 48.1562, GNorm = 2.9050, lr_0 = 6.0528e-04
Validation rmse = 1.094990
Epoch 8
Loss = 3.3024e-03, PNorm = 48.1669, GNorm = 1.5576, lr_0 = 5.7714e-04
Loss = 2.4136e-03, PNorm = 48.1774, GNorm = 1.5260, lr_0 = 5.5269e-04
Validation rmse = 1.129189
Epoch 9
Loss = 2.4527e-03, PNorm = 48.1861, GNorm = 1.6229, lr_0 = 5.2928e-04
Loss = 2.8646e-03, PNorm = 48.1919, GNorm = 2.7037, lr_0 = 5.0686e-04
Validation rmse = 1.111046
Epoch 10
Loss = 2.5948e-03, PNorm = 48.2018, GNorm = 1.0416, lr_0 = 4.8539e-04
Loss = 2.9969e-03, PNorm = 48.2086, GNorm = 1.3803, lr_0 = 4.6483e-04
Validation rmse = 1.314428
Epoch 11
Loss = 2.6234e-03, PNorm = 48.2191, GNorm = 1.5866, lr_0 = 4.4322e-04
Loss = 2.5014e-03, PNorm = 48.2281, GNorm = 1.3723, lr_0 = 4.2444e-04
Validation rmse = 1.217731
Epoch 12
Loss = 2.3437e-03, PNorm = 48.2337, GNorm = 1.4325, lr_0 = 4.0646e-04
Loss = 2.5732e-03, PNorm = 48.2414, GNorm = 1.3635, lr_0 = 3.8925e-04
Validation rmse = 1.109248
Epoch 13
Loss = 2.7121e-03, PNorm = 48.2455, GNorm = 0.7689, lr_0 = 3.7276e-04
Loss = 2.5280e-03, PNorm = 48.2524, GNorm = 3.3803, lr_0 = 3.5697e-04
Validation rmse = 1.224760
Epoch 14
Loss = 2.4325e-03, PNorm = 48.2567, GNorm = 0.9989, lr_0 = 3.4037e-04
Loss = 2.0017e-03, PNorm = 48.2625, GNorm = 1.8952, lr_0 = 3.2596e-04
Validation rmse = 1.065531
Epoch 15
Loss = 1.9123e-03, PNorm = 48.2666, GNorm = 1.6107, lr_0 = 3.1215e-04
Loss = 2.1147e-03, PNorm = 48.2714, GNorm = 1.1035, lr_0 = 2.9893e-04
Validation rmse = 1.081717
Epoch 16
Loss = 1.7034e-03, PNorm = 48.2762, GNorm = 1.1283, lr_0 = 2.8503e-04
Loss = 2.5281e-03, PNorm = 48.2803, GNorm = 1.3986, lr_0 = 2.7295e-04
Validation rmse = 1.099328
Epoch 17
Loss = 1.9046e-03, PNorm = 48.2831, GNorm = 0.8767, lr_0 = 2.6139e-04
Loss = 2.4031e-03, PNorm = 48.2870, GNorm = 0.9430, lr_0 = 2.5032e-04
Validation rmse = 1.299836
Epoch 18
Loss = 2.2099e-03, PNorm = 48.2902, GNorm = 0.9457, lr_0 = 2.3972e-04
Loss = 2.0056e-03, PNorm = 48.2929, GNorm = 0.8097, lr_0 = 2.2956e-04
Validation rmse = 1.201562
Epoch 19
Loss = 1.9715e-03, PNorm = 48.2953, GNorm = 1.2758, lr_0 = 2.1889e-04
Loss = 1.8693e-03, PNorm = 48.2969, GNorm = 1.2207, lr_0 = 2.0962e-04
Validation rmse = 1.147930
Epoch 20
Loss = 2.0527e-03, PNorm = 48.2993, GNorm = 0.8979, lr_0 = 2.0074e-04
Loss = 2.0042e-03, PNorm = 48.3017, GNorm = 0.8716, lr_0 = 1.9224e-04
Validation rmse = 1.133829
Epoch 21
Loss = 2.1829e-03, PNorm = 48.3038, GNorm = 2.7352, lr_0 = 1.8409e-04
Loss = 2.1044e-03, PNorm = 48.3069, GNorm = 1.4657, lr_0 = 1.7630e-04
Validation rmse = 1.189653
Epoch 22
Loss = 1.9630e-03, PNorm = 48.3091, GNorm = 0.8247, lr_0 = 1.6810e-04
Loss = 1.8228e-03, PNorm = 48.3105, GNorm = 0.7268, lr_0 = 1.6098e-04
Validation rmse = 1.154275
Epoch 23
Loss = 1.9374e-03, PNorm = 48.3123, GNorm = 1.5388, lr_0 = 1.5416e-04
Loss = 1.7891e-03, PNorm = 48.3138, GNorm = 1.4896, lr_0 = 1.4763e-04
Loss = 2.8277e-03, PNorm = 48.3139, GNorm = 1.6496, lr_0 = 1.4699e-04
Validation rmse = 1.202890
Epoch 24
Loss = 1.6400e-03, PNorm = 48.3148, GNorm = 0.9135, lr_0 = 1.4077e-04
Loss = 1.7971e-03, PNorm = 48.3173, GNorm = 1.1751, lr_0 = 1.3480e-04
Validation rmse = 1.110471
Epoch 25
Loss = 1.9288e-03, PNorm = 48.3183, GNorm = 2.1128, lr_0 = 1.2909e-04
Loss = 1.7363e-03, PNorm = 48.3203, GNorm = 1.4139, lr_0 = 1.2362e-04
Validation rmse = 1.125522
Epoch 26
Loss = 2.1442e-03, PNorm = 48.3209, GNorm = 2.3652, lr_0 = 1.1839e-04
Validation rmse = 1.240799
Epoch 27
Loss = 3.0823e-03, PNorm = 48.3220, GNorm = 2.9961, lr_0 = 1.1288e-04
Loss = 1.7282e-03, PNorm = 48.3229, GNorm = 1.3202, lr_0 = 1.0810e-04
Validation rmse = 1.105376
Epoch 28
Loss = 1.5156e-03, PNorm = 48.3245, GNorm = 0.9800, lr_0 = 1.0352e-04
Loss = 1.8179e-03, PNorm = 48.3257, GNorm = 1.2704, lr_0 = 1.0000e-04
Validation rmse = 1.120543
Epoch 29
Loss = 1.3101e-03, PNorm = 48.3271, GNorm = 1.0511, lr_0 = 1.0000e-04
Loss = 1.6120e-03, PNorm = 48.3285, GNorm = 0.9204, lr_0 = 1.0000e-04
Validation rmse = 1.195211
Model 0 best validation rmse = 1.065531 on epoch 14
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.178728
Ensemble test rmse = 1.178728
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_500/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 58 | test scaffolds = 53
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=504, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=500, out_features=500, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 1,144,001
Moving model to cuda
Epoch 0
Loss = 1.8933e-02, PNorm = 47.8851, GNorm = 3.0757, lr_0 = 3.6053e-04
Validation rmse = 1.459663
Epoch 1
Loss = 8.7376e-03, PNorm = 47.9067, GNorm = 3.8855, lr_0 = 6.2105e-04
Loss = 8.5466e-03, PNorm = 47.9348, GNorm = 4.9140, lr_0 = 8.5789e-04
Validation rmse = 1.563587
Epoch 2
Loss = 7.4527e-03, PNorm = 47.9706, GNorm = 2.7891, lr_0 = 9.8284e-04
Loss = 7.3660e-03, PNorm = 48.0022, GNorm = 3.2284, lr_0 = 9.4120e-04
Validation rmse = 1.214948
Epoch 3
Loss = 5.2488e-03, PNorm = 48.0339, GNorm = 1.4647, lr_0 = 8.9744e-04
Loss = 4.9170e-03, PNorm = 48.0547, GNorm = 4.3989, lr_0 = 8.5943e-04
Validation rmse = 1.216777
Epoch 4
Loss = 4.1621e-03, PNorm = 48.0703, GNorm = 1.7661, lr_0 = 8.2303e-04
Loss = 4.3053e-03, PNorm = 48.0884, GNorm = 1.3752, lr_0 = 7.8816e-04
Validation rmse = 1.342361
Epoch 5
Loss = 4.3644e-03, PNorm = 48.1017, GNorm = 2.5443, lr_0 = 7.5478e-04
Loss = 3.7804e-03, PNorm = 48.1144, GNorm = 1.4177, lr_0 = 7.2281e-04
Validation rmse = 1.194979
Epoch 6
Loss = 3.3918e-03, PNorm = 48.1320, GNorm = 1.3551, lr_0 = 6.8920e-04
Loss = 3.7337e-03, PNorm = 48.1430, GNorm = 1.3387, lr_0 = 6.6001e-04
Validation rmse = 1.284931
Epoch 7
Loss = 3.1641e-03, PNorm = 48.1552, GNorm = 0.9760, lr_0 = 6.3205e-04
Loss = 3.3840e-03, PNorm = 48.1689, GNorm = 2.1239, lr_0 = 6.0528e-04
Validation rmse = 1.192968
Epoch 8
Loss = 2.4575e-03, PNorm = 48.1800, GNorm = 0.8119, lr_0 = 5.7714e-04
Loss = 2.7855e-03, PNorm = 48.1905, GNorm = 0.9108, lr_0 = 5.5269e-04
Validation rmse = 1.227658
Epoch 9
Loss = 3.4468e-03, PNorm = 48.1994, GNorm = 2.1421, lr_0 = 5.2928e-04
Loss = 2.7832e-03, PNorm = 48.2076, GNorm = 2.1955, lr_0 = 5.0686e-04
Validation rmse = 1.129170
Epoch 10
Loss = 2.6133e-03, PNorm = 48.2155, GNorm = 2.1290, lr_0 = 4.8539e-04
Loss = 2.9818e-03, PNorm = 48.2216, GNorm = 3.4678, lr_0 = 4.6483e-04
Validation rmse = 1.092593
Epoch 11
Loss = 2.9960e-03, PNorm = 48.2313, GNorm = 1.9676, lr_0 = 4.4322e-04
Loss = 2.9956e-03, PNorm = 48.2370, GNorm = 2.4291, lr_0 = 4.2444e-04
Validation rmse = 1.158387
Epoch 12
Loss = 3.0376e-03, PNorm = 48.2446, GNorm = 1.4364, lr_0 = 4.0646e-04
Loss = 3.2631e-03, PNorm = 48.2512, GNorm = 2.1486, lr_0 = 3.8925e-04
Validation rmse = 1.024385
Epoch 13
Loss = 2.1815e-03, PNorm = 48.2577, GNorm = 1.0620, lr_0 = 3.7276e-04
Loss = 2.6521e-03, PNorm = 48.2611, GNorm = 3.3132, lr_0 = 3.5697e-04
Validation rmse = 1.110715
Epoch 14
Loss = 2.4907e-03, PNorm = 48.2685, GNorm = 1.0105, lr_0 = 3.4037e-04
Loss = 2.5921e-03, PNorm = 48.2719, GNorm = 1.6227, lr_0 = 3.2596e-04
Validation rmse = 1.203636
Epoch 15
Loss = 2.2641e-03, PNorm = 48.2773, GNorm = 0.5901, lr_0 = 3.1215e-04
Loss = 2.4732e-03, PNorm = 48.2803, GNorm = 2.0322, lr_0 = 2.9893e-04
Validation rmse = 1.057872
Epoch 16
Loss = 2.7436e-03, PNorm = 48.2844, GNorm = 3.5936, lr_0 = 2.8503e-04
Loss = 2.2952e-03, PNorm = 48.2883, GNorm = 1.7819, lr_0 = 2.7295e-04
Validation rmse = 1.078123
Epoch 17
Loss = 2.2758e-03, PNorm = 48.2912, GNorm = 1.7569, lr_0 = 2.6139e-04
Loss = 2.6386e-03, PNorm = 48.2940, GNorm = 2.0214, lr_0 = 2.5032e-04
Validation rmse = 1.064049
Epoch 18
Loss = 1.9693e-03, PNorm = 48.2981, GNorm = 0.6842, lr_0 = 2.3972e-04
Loss = 2.3537e-03, PNorm = 48.3013, GNorm = 1.2067, lr_0 = 2.2956e-04
Validation rmse = 1.123382
Epoch 19
Loss = 2.3297e-03, PNorm = 48.3031, GNorm = 1.7794, lr_0 = 2.1889e-04
Loss = 2.5217e-03, PNorm = 48.3070, GNorm = 1.4718, lr_0 = 2.0962e-04
Validation rmse = 1.220595
Epoch 20
Loss = 2.8013e-03, PNorm = 48.3101, GNorm = 0.7251, lr_0 = 2.0074e-04
Loss = 1.8398e-03, PNorm = 48.3131, GNorm = 1.2575, lr_0 = 1.9224e-04
Validation rmse = 1.017495
Epoch 21
Loss = 1.9757e-03, PNorm = 48.3150, GNorm = 0.7771, lr_0 = 1.8409e-04
Loss = 2.0520e-03, PNorm = 48.3176, GNorm = 2.1107, lr_0 = 1.7630e-04
Validation rmse = 0.978823
Epoch 22
Loss = 2.4179e-03, PNorm = 48.3188, GNorm = 2.5831, lr_0 = 1.6810e-04
Loss = 1.9385e-03, PNorm = 48.3215, GNorm = 2.6630, lr_0 = 1.6098e-04
Validation rmse = 1.009093
Epoch 23
Loss = 1.9790e-03, PNorm = 48.3235, GNorm = 1.0991, lr_0 = 1.5416e-04
Loss = 2.1908e-03, PNorm = 48.3242, GNorm = 1.5180, lr_0 = 1.4763e-04
Loss = 5.7032e-03, PNorm = 48.3242, GNorm = 2.9513, lr_0 = 1.4699e-04
Validation rmse = 1.073401
Epoch 24
Loss = 2.0679e-03, PNorm = 48.3263, GNorm = 1.0188, lr_0 = 1.4077e-04
Loss = 2.0616e-03, PNorm = 48.3287, GNorm = 1.2871, lr_0 = 1.3480e-04
Validation rmse = 1.068044
Epoch 25
Loss = 2.0432e-03, PNorm = 48.3302, GNorm = 1.7179, lr_0 = 1.2909e-04
Loss = 1.7770e-03, PNorm = 48.3318, GNorm = 1.9315, lr_0 = 1.2362e-04
Validation rmse = 1.032307
Epoch 26
Loss = 1.9436e-03, PNorm = 48.3333, GNorm = 0.8510, lr_0 = 1.1839e-04
Validation rmse = 1.013787
Epoch 27
Loss = 1.8931e-03, PNorm = 48.3347, GNorm = 1.1773, lr_0 = 1.1288e-04
Loss = 2.0315e-03, PNorm = 48.3357, GNorm = 2.3029, lr_0 = 1.0810e-04
Validation rmse = 0.970267
Epoch 28
Loss = 2.1455e-03, PNorm = 48.3372, GNorm = 2.4739, lr_0 = 1.0352e-04
Loss = 1.9996e-03, PNorm = 48.3383, GNorm = 0.8746, lr_0 = 1.0000e-04
Validation rmse = 0.959557
Epoch 29
Loss = 2.2530e-03, PNorm = 48.3393, GNorm = 1.5279, lr_0 = 1.0000e-04
Loss = 1.9874e-03, PNorm = 48.3402, GNorm = 1.6234, lr_0 = 1.0000e-04
Validation rmse = 0.988716
Model 0 best validation rmse = 0.959557 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.299016
Ensemble test rmse = 1.299016
10-fold cross validation
	Seed 0 ==> test rmse = 0.986765
	Seed 1 ==> test rmse = 1.171239
	Seed 2 ==> test rmse = 1.116240
	Seed 3 ==> test rmse = 1.092693
	Seed 4 ==> test rmse = 1.114840
	Seed 5 ==> test rmse = 1.183250
	Seed 6 ==> test rmse = 0.968258
	Seed 7 ==> test rmse = 1.038967
	Seed 8 ==> test rmse = 1.178728
	Seed 9 ==> test rmse = 1.299016
Overall test rmse = 1.115000 +/- 0.094869
Elapsed time = 0:06:54
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.1_ffn_num_layers_2_hidden_size_1100/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total scaffolds = 195 | train scaffolds = 91 | val scaffolds = 66 | test scaffolds = 38
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1104, out_features=1100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 3,945,701
Moving model to cuda
Epoch 0
Loss = 1.2844e-02, PNorm = 60.2472, GNorm = 9.5254, lr_0 = 3.6053e-04
Validation rmse = 1.424368
Epoch 1
Loss = 3.8082e-03, PNorm = 60.2977, GNorm = 2.3147, lr_0 = 6.2105e-04
Loss = 4.1462e-03, PNorm = 60.3594, GNorm = 1.2321, lr_0 = 8.5789e-04
Validation rmse = 1.087199
Epoch 2
Loss = 5.0970e-03, PNorm = 60.4240, GNorm = 1.1302, lr_0 = 9.8284e-04
Loss = 3.3701e-03, PNorm = 60.4755, GNorm = 1.1682, lr_0 = 9.4120e-04
Validation rmse = 0.949873
Epoch 3
Loss = 2.0743e-03, PNorm = 60.5277, GNorm = 0.9610, lr_0 = 8.9744e-04
Loss = 2.3231e-03, PNorm = 60.5629, GNorm = 0.8846, lr_0 = 8.5943e-04
Validation rmse = 1.075287
Epoch 4
Loss = 3.7616e-03, PNorm = 60.6014, GNorm = 1.5304, lr_0 = 8.2303e-04
Loss = 2.1202e-03, PNorm = 60.6351, GNorm = 0.7990, lr_0 = 7.8816e-04
Validation rmse = 1.031819
Epoch 5
Loss = 2.2736e-03, PNorm = 60.6685, GNorm = 1.4098, lr_0 = 7.5478e-04
Loss = 2.0191e-03, PNorm = 60.6986, GNorm = 1.6896, lr_0 = 7.2281e-04
Validation rmse = 0.959901
Epoch 6
Loss = 1.5216e-03, PNorm = 60.7288, GNorm = 0.3847, lr_0 = 6.8920e-04
Loss = 1.8189e-03, PNorm = 60.7569, GNorm = 1.5475, lr_0 = 6.6001e-04
Validation rmse = 1.463852
Epoch 7
Loss = 2.6919e-03, PNorm = 60.7842, GNorm = 2.0070, lr_0 = 6.3205e-04
Loss = 2.1057e-03, PNorm = 60.8096, GNorm = 1.0901, lr_0 = 6.0528e-04
Validation rmse = 0.803542
Epoch 8
Loss = 1.5082e-03, PNorm = 60.8410, GNorm = 0.5998, lr_0 = 5.7714e-04
Loss = 1.6033e-03, PNorm = 60.8627, GNorm = 0.5216, lr_0 = 5.5269e-04
Validation rmse = 0.931766
Epoch 9
Loss = 1.5168e-03, PNorm = 60.8886, GNorm = 2.4690, lr_0 = 5.2928e-04
Loss = 1.9627e-03, PNorm = 60.9151, GNorm = 1.2230, lr_0 = 5.0686e-04
Validation rmse = 0.883038
Epoch 10
Loss = 1.7580e-03, PNorm = 60.9327, GNorm = 2.0814, lr_0 = 4.8539e-04
Loss = 1.7051e-03, PNorm = 60.9583, GNorm = 0.9783, lr_0 = 4.6483e-04
Validation rmse = 0.913174
Epoch 11
Loss = 1.3855e-03, PNorm = 60.9838, GNorm = 0.3203, lr_0 = 4.4322e-04
Loss = 1.3057e-03, PNorm = 61.0032, GNorm = 0.4074, lr_0 = 4.2444e-04
Validation rmse = 0.917208
Epoch 12
Loss = 1.2646e-03, PNorm = 61.0189, GNorm = 0.2876, lr_0 = 4.0646e-04
Loss = 1.2266e-03, PNorm = 61.0349, GNorm = 0.7621, lr_0 = 3.8925e-04
Validation rmse = 0.886822
Epoch 13
Loss = 9.6271e-04, PNorm = 61.0531, GNorm = 0.8070, lr_0 = 3.7276e-04
Loss = 1.3677e-03, PNorm = 61.0716, GNorm = 0.4122, lr_0 = 3.5697e-04
Validation rmse = 1.034003
Epoch 14
Loss = 9.7672e-04, PNorm = 61.0876, GNorm = 0.2800, lr_0 = 3.4037e-04
Loss = 1.1114e-03, PNorm = 61.1034, GNorm = 0.3767, lr_0 = 3.2596e-04
Validation rmse = 1.083484
Epoch 15
Loss = 1.1341e-03, PNorm = 61.1174, GNorm = 0.2875, lr_0 = 3.1215e-04
Loss = 1.1216e-03, PNorm = 61.1311, GNorm = 1.2117, lr_0 = 2.9893e-04
Validation rmse = 0.889966
Epoch 16
Loss = 1.2944e-03, PNorm = 61.1455, GNorm = 0.3199, lr_0 = 2.8503e-04
Loss = 9.8057e-04, PNorm = 61.1593, GNorm = 0.5275, lr_0 = 2.7295e-04
Validation rmse = 0.961352
Epoch 17
Loss = 8.9703e-04, PNorm = 61.1752, GNorm = 0.5374, lr_0 = 2.6139e-04
Loss = 1.2509e-03, PNorm = 61.1884, GNorm = 1.3648, lr_0 = 2.5032e-04
Validation rmse = 0.919952
Epoch 18
Loss = 8.3409e-04, PNorm = 61.2018, GNorm = 0.5773, lr_0 = 2.3972e-04
Loss = 8.7352e-04, PNorm = 61.2148, GNorm = 0.5395, lr_0 = 2.2956e-04
Validation rmse = 0.949051
Epoch 19
Loss = 9.3121e-04, PNorm = 61.2273, GNorm = 0.8231, lr_0 = 2.1889e-04
Loss = 9.2756e-04, PNorm = 61.2372, GNorm = 0.3749, lr_0 = 2.0962e-04
Validation rmse = 1.067979
Epoch 20
Loss = 8.6890e-04, PNorm = 61.2450, GNorm = 0.2947, lr_0 = 2.0074e-04
Loss = 9.2294e-04, PNorm = 61.2538, GNorm = 0.7222, lr_0 = 1.9224e-04
Validation rmse = 0.938557
Epoch 21
Loss = 8.6165e-04, PNorm = 61.2650, GNorm = 0.8360, lr_0 = 1.8409e-04
Loss = 8.7728e-04, PNorm = 61.2747, GNorm = 0.9923, lr_0 = 1.7630e-04
Validation rmse = 0.889218
Epoch 22
Loss = 8.1727e-04, PNorm = 61.2853, GNorm = 0.3620, lr_0 = 1.6810e-04
Loss = 9.0252e-04, PNorm = 61.2922, GNorm = 0.5650, lr_0 = 1.6098e-04
Validation rmse = 0.935040
Epoch 23
Loss = 7.5758e-04, PNorm = 61.2988, GNorm = 0.7236, lr_0 = 1.5416e-04
Loss = 8.7704e-04, PNorm = 61.3070, GNorm = 1.7812, lr_0 = 1.4763e-04
Loss = 1.4485e-03, PNorm = 61.3079, GNorm = 1.1949, lr_0 = 1.4699e-04
Validation rmse = 0.992481
Epoch 24
Loss = 9.7136e-04, PNorm = 61.3154, GNorm = 1.0145, lr_0 = 1.4077e-04
Loss = 8.5823e-04, PNorm = 61.3231, GNorm = 0.6961, lr_0 = 1.3480e-04
Validation rmse = 0.967961
Epoch 25
Loss = 7.4671e-04, PNorm = 61.3297, GNorm = 0.8846, lr_0 = 1.2909e-04
Loss = 7.4492e-04, PNorm = 61.3362, GNorm = 0.5682, lr_0 = 1.2362e-04
Validation rmse = 0.975279
Epoch 26
Loss = 7.2947e-04, PNorm = 61.3409, GNorm = 0.5447, lr_0 = 1.1839e-04
Validation rmse = 0.947429
Epoch 27
Loss = 6.2212e-04, PNorm = 61.3478, GNorm = 0.6293, lr_0 = 1.1288e-04
Loss = 8.3599e-04, PNorm = 61.3527, GNorm = 0.6760, lr_0 = 1.0810e-04
Validation rmse = 0.928340
Epoch 28
Loss = 1.1876e-03, PNorm = 61.3581, GNorm = 0.6863, lr_0 = 1.0352e-04
Loss = 6.9308e-04, PNorm = 61.3619, GNorm = 0.5627, lr_0 = 1.0000e-04
Validation rmse = 0.858146
Epoch 29
Loss = 6.9393e-04, PNorm = 61.3674, GNorm = 1.0579, lr_0 = 1.0000e-04
Loss = 8.0781e-04, PNorm = 61.3730, GNorm = 0.4095, lr_0 = 1.0000e-04
Validation rmse = 0.968038
Model 0 best validation rmse = 0.803542 on epoch 7
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.876177
Ensemble test rmse = 0.876177
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.1_ffn_num_layers_2_hidden_size_1100/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total scaffolds = 195 | train scaffolds = 76 | val scaffolds = 60 | test scaffolds = 59
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1104, out_features=1100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 3,945,701
Moving model to cuda
Epoch 0
Loss = 1.3802e-02, PNorm = 60.2485, GNorm = 6.5158, lr_0 = 3.6053e-04
Validation rmse = 1.654162
Epoch 1
Loss = 5.7894e-03, PNorm = 60.2957, GNorm = 5.9784, lr_0 = 6.2105e-04
Loss = 4.5138e-03, PNorm = 60.3513, GNorm = 1.6894, lr_0 = 8.5789e-04
Validation rmse = 1.201394
Epoch 2
Loss = 3.8662e-03, PNorm = 60.4122, GNorm = 2.3596, lr_0 = 9.8284e-04
Loss = 2.8060e-03, PNorm = 60.4618, GNorm = 0.7769, lr_0 = 9.4120e-04
Validation rmse = 1.074083
Epoch 3
Loss = 2.3152e-03, PNorm = 60.5039, GNorm = 1.7505, lr_0 = 8.9744e-04
Loss = 2.7039e-03, PNorm = 60.5406, GNorm = 0.3303, lr_0 = 8.5943e-04
Validation rmse = 1.014802
Epoch 4
Loss = 1.6795e-03, PNorm = 60.5730, GNorm = 0.4802, lr_0 = 8.2303e-04
Loss = 2.1359e-03, PNorm = 60.6058, GNorm = 1.8379, lr_0 = 7.8816e-04
Validation rmse = 1.050027
Epoch 5
Loss = 1.7652e-03, PNorm = 60.6337, GNorm = 1.5066, lr_0 = 7.5478e-04
Loss = 2.1256e-03, PNorm = 60.6650, GNorm = 2.5920, lr_0 = 7.2281e-04
Validation rmse = 1.010671
Epoch 6
Loss = 1.9098e-03, PNorm = 60.6970, GNorm = 1.9602, lr_0 = 6.8920e-04
Loss = 2.0621e-03, PNorm = 60.7308, GNorm = 0.5280, lr_0 = 6.6001e-04
Validation rmse = 0.912231
Epoch 7
Loss = 1.7686e-03, PNorm = 60.7583, GNorm = 0.7678, lr_0 = 6.3205e-04
Loss = 2.0457e-03, PNorm = 60.7867, GNorm = 1.4782, lr_0 = 6.0528e-04
Validation rmse = 0.916133
Epoch 8
Loss = 2.0114e-03, PNorm = 60.8143, GNorm = 0.7138, lr_0 = 5.7714e-04
Loss = 1.5453e-03, PNorm = 60.8372, GNorm = 1.1362, lr_0 = 5.5269e-04
Validation rmse = 0.909036
Epoch 9
Loss = 1.1879e-03, PNorm = 60.8591, GNorm = 0.6331, lr_0 = 5.2928e-04
Loss = 1.5855e-03, PNorm = 60.8792, GNorm = 1.6509, lr_0 = 5.0686e-04
Validation rmse = 0.937468
Epoch 10
Loss = 1.2440e-03, PNorm = 60.8991, GNorm = 0.4115, lr_0 = 4.8539e-04
Loss = 1.0283e-03, PNorm = 60.9200, GNorm = 1.1752, lr_0 = 4.6483e-04
Validation rmse = 0.838824
Epoch 11
Loss = 1.6973e-03, PNorm = 60.9408, GNorm = 1.7931, lr_0 = 4.4322e-04
Loss = 1.4174e-03, PNorm = 60.9570, GNorm = 0.5116, lr_0 = 4.2444e-04
Validation rmse = 0.883044
Epoch 12
Loss = 1.0112e-03, PNorm = 60.9769, GNorm = 0.4348, lr_0 = 4.0646e-04
Loss = 1.4999e-03, PNorm = 60.9918, GNorm = 1.6535, lr_0 = 3.8925e-04
Validation rmse = 0.908268
Epoch 13
Loss = 1.8963e-03, PNorm = 61.0065, GNorm = 0.8180, lr_0 = 3.7276e-04
Loss = 1.3119e-03, PNorm = 61.0240, GNorm = 1.2944, lr_0 = 3.5697e-04
Validation rmse = 0.854283
Epoch 14
Loss = 1.0657e-03, PNorm = 61.0452, GNorm = 1.2352, lr_0 = 3.4037e-04
Loss = 1.2341e-03, PNorm = 61.0623, GNorm = 0.3837, lr_0 = 3.2596e-04
Validation rmse = 0.968056
Epoch 15
Loss = 1.2720e-03, PNorm = 61.0745, GNorm = 0.7035, lr_0 = 3.1215e-04
Loss = 9.6364e-04, PNorm = 61.0878, GNorm = 0.6801, lr_0 = 2.9893e-04
Validation rmse = 0.834690
Epoch 16
Loss = 9.8430e-04, PNorm = 61.0992, GNorm = 0.5387, lr_0 = 2.8503e-04
Loss = 1.0933e-03, PNorm = 61.1103, GNorm = 0.5407, lr_0 = 2.7295e-04
Validation rmse = 0.899817
Epoch 17
Loss = 8.6990e-04, PNorm = 61.1231, GNorm = 1.7685, lr_0 = 2.6139e-04
Loss = 9.8579e-04, PNorm = 61.1348, GNorm = 0.6175, lr_0 = 2.5032e-04
Validation rmse = 0.902463
Epoch 18
Loss = 7.9819e-04, PNorm = 61.1466, GNorm = 0.4394, lr_0 = 2.3972e-04
Loss = 9.1274e-04, PNorm = 61.1569, GNorm = 0.9888, lr_0 = 2.2956e-04
Validation rmse = 0.874730
Epoch 19
Loss = 8.1962e-04, PNorm = 61.1679, GNorm = 0.8844, lr_0 = 2.1889e-04
Loss = 9.3880e-04, PNorm = 61.1759, GNorm = 0.4991, lr_0 = 2.0962e-04
Validation rmse = 0.884370
Epoch 20
Loss = 9.7909e-04, PNorm = 61.1878, GNorm = 0.3931, lr_0 = 2.0074e-04
Loss = 1.1415e-03, PNorm = 61.1963, GNorm = 0.4198, lr_0 = 1.9224e-04
Validation rmse = 0.898901
Epoch 21
Loss = 9.4935e-04, PNorm = 61.2059, GNorm = 1.4111, lr_0 = 1.8409e-04
Loss = 9.5638e-04, PNorm = 61.2142, GNorm = 1.4773, lr_0 = 1.7630e-04
Validation rmse = 0.851722
Epoch 22
Loss = 8.9682e-04, PNorm = 61.2237, GNorm = 0.7214, lr_0 = 1.6810e-04
Loss = 7.8458e-04, PNorm = 61.2305, GNorm = 0.4898, lr_0 = 1.6098e-04
Validation rmse = 0.925164
Epoch 23
Loss = 9.2600e-04, PNorm = 61.2390, GNorm = 0.4409, lr_0 = 1.5416e-04
Loss = 7.9072e-04, PNorm = 61.2455, GNorm = 0.3413, lr_0 = 1.4763e-04
Loss = 6.2679e-04, PNorm = 61.2460, GNorm = 0.2646, lr_0 = 1.4699e-04
Validation rmse = 0.917815
Epoch 24
Loss = 8.7752e-04, PNorm = 61.2535, GNorm = 0.4785, lr_0 = 1.4077e-04
Loss = 7.5048e-04, PNorm = 61.2586, GNorm = 0.6055, lr_0 = 1.3480e-04
Validation rmse = 0.944271
Epoch 25
Loss = 7.8411e-04, PNorm = 61.2644, GNorm = 0.5907, lr_0 = 1.2909e-04
Loss = 7.6781e-04, PNorm = 61.2692, GNorm = 0.6010, lr_0 = 1.2362e-04
Validation rmse = 0.910914
Epoch 26
Loss = 8.1593e-04, PNorm = 61.2748, GNorm = 0.2742, lr_0 = 1.1839e-04
Validation rmse = 0.888787
Epoch 27
Loss = 1.4254e-03, PNorm = 61.2803, GNorm = 1.2977, lr_0 = 1.1288e-04
Loss = 7.2807e-04, PNorm = 61.2856, GNorm = 0.6329, lr_0 = 1.0810e-04
Validation rmse = 0.936910
Epoch 28
Loss = 5.6225e-04, PNorm = 61.2898, GNorm = 0.6680, lr_0 = 1.0352e-04
Loss = 8.8802e-04, PNorm = 61.2940, GNorm = 1.4082, lr_0 = 1.0000e-04
Validation rmse = 0.955853
Epoch 29
Loss = 6.4917e-04, PNorm = 61.2986, GNorm = 0.8437, lr_0 = 1.0000e-04
Loss = 7.4920e-04, PNorm = 61.3041, GNorm = 0.5590, lr_0 = 1.0000e-04
Validation rmse = 0.971012
Model 0 best validation rmse = 0.834690 on epoch 15
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.907703
Ensemble test rmse = 0.907703
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.1_ffn_num_layers_2_hidden_size_1100/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total scaffolds = 195 | train scaffolds = 55 | val scaffolds = 64 | test scaffolds = 76
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1104, out_features=1100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 3,945,701
Moving model to cuda
Epoch 0
Loss = 1.4085e-02, PNorm = 60.2461, GNorm = 2.9530, lr_0 = 3.6053e-04
Validation rmse = 1.574430
Epoch 1
Loss = 4.1330e-03, PNorm = 60.2957, GNorm = 2.7433, lr_0 = 6.2105e-04
Loss = 4.4860e-03, PNorm = 60.3490, GNorm = 4.4179, lr_0 = 8.5789e-04
Validation rmse = 1.214548
Epoch 2
Loss = 4.1898e-03, PNorm = 60.4088, GNorm = 1.5930, lr_0 = 9.8284e-04
Loss = 3.0087e-03, PNorm = 60.4564, GNorm = 3.1821, lr_0 = 9.4120e-04
Validation rmse = 1.121329
Epoch 3
Loss = 3.4623e-03, PNorm = 60.5008, GNorm = 1.6777, lr_0 = 8.9744e-04
Loss = 2.6464e-03, PNorm = 60.5383, GNorm = 0.7489, lr_0 = 8.5943e-04
Validation rmse = 1.095529
Epoch 4
Loss = 2.0319e-03, PNorm = 60.5675, GNorm = 0.5360, lr_0 = 8.2303e-04
Loss = 2.2678e-03, PNorm = 60.5973, GNorm = 0.7323, lr_0 = 7.8816e-04
Validation rmse = 1.118924
Epoch 5
Loss = 1.8354e-03, PNorm = 60.6298, GNorm = 0.6401, lr_0 = 7.5478e-04
Loss = 1.8772e-03, PNorm = 60.6567, GNorm = 0.8715, lr_0 = 7.2281e-04
Validation rmse = 1.008020
Epoch 6
Loss = 1.7801e-03, PNorm = 60.6903, GNorm = 1.0012, lr_0 = 6.8920e-04
Loss = 1.9839e-03, PNorm = 60.7201, GNorm = 0.7615, lr_0 = 6.6001e-04
Validation rmse = 1.029451
Epoch 7
Loss = 2.2084e-03, PNorm = 60.7464, GNorm = 0.8098, lr_0 = 6.3205e-04
Loss = 1.5026e-03, PNorm = 60.7691, GNorm = 0.5076, lr_0 = 6.0528e-04
Validation rmse = 1.057898
Epoch 8
Loss = 2.6511e-03, PNorm = 60.7973, GNorm = 0.9742, lr_0 = 5.7714e-04
Loss = 1.6215e-03, PNorm = 60.8244, GNorm = 0.3585, lr_0 = 5.5269e-04
Validation rmse = 0.964243
Epoch 9
Loss = 1.3297e-03, PNorm = 60.8452, GNorm = 0.9731, lr_0 = 5.2928e-04
Loss = 1.4139e-03, PNorm = 60.8691, GNorm = 0.4416, lr_0 = 5.0686e-04
Validation rmse = 0.983972
Epoch 10
Loss = 1.2708e-03, PNorm = 60.8879, GNorm = 0.6762, lr_0 = 4.8539e-04
Loss = 1.5588e-03, PNorm = 60.9052, GNorm = 0.6538, lr_0 = 4.6483e-04
Validation rmse = 1.056750
Epoch 11
Loss = 1.5952e-03, PNorm = 60.9282, GNorm = 0.3289, lr_0 = 4.4322e-04
Loss = 1.5946e-03, PNorm = 60.9478, GNorm = 0.4436, lr_0 = 4.2444e-04
Validation rmse = 0.961402
Epoch 12
Loss = 1.1852e-03, PNorm = 60.9670, GNorm = 1.2048, lr_0 = 4.0646e-04
Loss = 1.5234e-03, PNorm = 60.9866, GNorm = 0.5768, lr_0 = 3.8925e-04
Validation rmse = 0.937210
Epoch 13
Loss = 1.3889e-03, PNorm = 61.0075, GNorm = 0.8046, lr_0 = 3.7276e-04
Loss = 1.2058e-03, PNorm = 61.0222, GNorm = 1.0824, lr_0 = 3.5697e-04
Validation rmse = 1.046369
Epoch 14
Loss = 1.4595e-03, PNorm = 61.0394, GNorm = 1.6768, lr_0 = 3.4037e-04
Loss = 1.2581e-03, PNorm = 61.0578, GNorm = 0.7581, lr_0 = 3.2596e-04
Validation rmse = 0.952934
Epoch 15
Loss = 1.0936e-03, PNorm = 61.0712, GNorm = 0.4601, lr_0 = 3.1215e-04
Loss = 1.1997e-03, PNorm = 61.0859, GNorm = 0.6685, lr_0 = 2.9893e-04
Validation rmse = 0.999930
Epoch 16
Loss = 1.2977e-03, PNorm = 61.1010, GNorm = 0.8985, lr_0 = 2.8503e-04
Loss = 1.4288e-03, PNorm = 61.1146, GNorm = 0.8359, lr_0 = 2.7295e-04
Validation rmse = 0.964444
Epoch 17
Loss = 1.2291e-03, PNorm = 61.1274, GNorm = 1.5930, lr_0 = 2.6139e-04
Loss = 1.1747e-03, PNorm = 61.1416, GNorm = 1.2543, lr_0 = 2.5032e-04
Validation rmse = 1.106086
Epoch 18
Loss = 9.6994e-04, PNorm = 61.1536, GNorm = 0.3839, lr_0 = 2.3972e-04
Loss = 1.1706e-03, PNorm = 61.1657, GNorm = 0.4870, lr_0 = 2.2956e-04
Validation rmse = 1.034243
Epoch 19
Loss = 1.2815e-03, PNorm = 61.1775, GNorm = 2.0693, lr_0 = 2.1889e-04
Loss = 1.2922e-03, PNorm = 61.1902, GNorm = 1.1972, lr_0 = 2.0962e-04
Validation rmse = 0.953356
Epoch 20
Loss = 1.0458e-03, PNorm = 61.1988, GNorm = 0.6727, lr_0 = 2.0074e-04
Loss = 1.0691e-03, PNorm = 61.2094, GNorm = 0.8580, lr_0 = 1.9224e-04
Validation rmse = 0.989563
Epoch 21
Loss = 1.0499e-03, PNorm = 61.2182, GNorm = 0.9898, lr_0 = 1.8409e-04
Loss = 9.6661e-04, PNorm = 61.2277, GNorm = 0.4085, lr_0 = 1.7630e-04
Validation rmse = 1.055885
Epoch 22
Loss = 1.0219e-03, PNorm = 61.2385, GNorm = 0.8064, lr_0 = 1.6810e-04
Loss = 8.8162e-04, PNorm = 61.2485, GNorm = 0.3476, lr_0 = 1.6098e-04
Validation rmse = 0.997922
Epoch 23
Loss = 7.3868e-04, PNorm = 61.2558, GNorm = 0.5437, lr_0 = 1.5416e-04
Loss = 1.0655e-03, PNorm = 61.2636, GNorm = 0.6355, lr_0 = 1.4763e-04
Loss = 2.8002e-03, PNorm = 61.2641, GNorm = 1.1358, lr_0 = 1.4699e-04
Validation rmse = 0.975553
Epoch 24
Loss = 7.8563e-04, PNorm = 61.2720, GNorm = 0.9412, lr_0 = 1.4077e-04
Loss = 8.4914e-04, PNorm = 61.2779, GNorm = 0.3976, lr_0 = 1.3480e-04
Validation rmse = 1.020245
Epoch 25
Loss = 8.8909e-04, PNorm = 61.2846, GNorm = 0.3973, lr_0 = 1.2909e-04
Loss = 7.3960e-04, PNorm = 61.2897, GNorm = 0.7459, lr_0 = 1.2362e-04
Validation rmse = 1.010111
Epoch 26
Loss = 1.0035e-03, PNorm = 61.2968, GNorm = 0.9746, lr_0 = 1.1839e-04
Validation rmse = 1.035311
Epoch 27
Loss = 6.6295e-04, PNorm = 61.3028, GNorm = 0.4602, lr_0 = 1.1288e-04
Loss = 8.0733e-04, PNorm = 61.3087, GNorm = 1.1900, lr_0 = 1.0810e-04
Validation rmse = 1.040788
Epoch 28
Loss = 1.0068e-03, PNorm = 61.3135, GNorm = 0.8653, lr_0 = 1.0352e-04
Loss = 6.6520e-04, PNorm = 61.3199, GNorm = 0.3875, lr_0 = 1.0000e-04
Validation rmse = 1.040286
Epoch 29
Loss = 6.2541e-04, PNorm = 61.3250, GNorm = 0.4244, lr_0 = 1.0000e-04
Loss = 7.7429e-04, PNorm = 61.3296, GNorm = 0.9510, lr_0 = 1.0000e-04
Validation rmse = 0.986606
Model 0 best validation rmse = 0.937210 on epoch 12
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.922969
Ensemble test rmse = 0.922969
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.1_ffn_num_layers_2_hidden_size_1100/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total scaffolds = 195 | train scaffolds = 80 | val scaffolds = 54 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1104, out_features=1100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 3,945,701
Moving model to cuda
Epoch 0
Loss = 1.2101e-02, PNorm = 60.2498, GNorm = 18.6971, lr_0 = 3.6053e-04
Validation rmse = 1.829547
Epoch 1
Loss = 8.9073e-03, PNorm = 60.2942, GNorm = 8.5938, lr_0 = 6.2105e-04
Loss = 4.7743e-03, PNorm = 60.3502, GNorm = 3.3806, lr_0 = 8.5789e-04
Validation rmse = 1.112799
Epoch 2
Loss = 3.1246e-03, PNorm = 60.4139, GNorm = 1.1758, lr_0 = 9.8284e-04
Loss = 2.7821e-03, PNorm = 60.4679, GNorm = 1.0179, lr_0 = 9.4120e-04
Validation rmse = 1.115697
Epoch 3
Loss = 3.7615e-03, PNorm = 60.5153, GNorm = 0.4557, lr_0 = 8.9744e-04
Loss = 2.8340e-03, PNorm = 60.5531, GNorm = 1.3239, lr_0 = 8.5943e-04
Validation rmse = 1.264714
Epoch 4
Loss = 2.6808e-03, PNorm = 60.5945, GNorm = 2.4899, lr_0 = 8.2303e-04
Loss = 2.7926e-03, PNorm = 60.6317, GNorm = 0.8511, lr_0 = 7.8816e-04
Validation rmse = 1.081901
Epoch 5
Loss = 2.6735e-03, PNorm = 60.6666, GNorm = 1.1966, lr_0 = 7.5478e-04
Loss = 1.9179e-03, PNorm = 60.6998, GNorm = 0.3305, lr_0 = 7.2281e-04
Validation rmse = 0.989673
Epoch 6
Loss = 1.4973e-03, PNorm = 60.7337, GNorm = 0.6432, lr_0 = 6.8920e-04
Loss = 2.0829e-03, PNorm = 60.7629, GNorm = 0.9166, lr_0 = 6.6001e-04
Validation rmse = 1.002390
Epoch 7
Loss = 1.5672e-03, PNorm = 60.7862, GNorm = 0.7510, lr_0 = 6.3205e-04
Loss = 1.6225e-03, PNorm = 60.8121, GNorm = 0.4312, lr_0 = 6.0528e-04
Validation rmse = 0.995341
Epoch 8
Loss = 1.4826e-03, PNorm = 60.8421, GNorm = 0.8540, lr_0 = 5.7714e-04
Loss = 1.5403e-03, PNorm = 60.8666, GNorm = 1.1004, lr_0 = 5.5269e-04
Validation rmse = 1.034444
Epoch 9
Loss = 1.3989e-03, PNorm = 60.8899, GNorm = 1.4663, lr_0 = 5.2928e-04
Loss = 1.5403e-03, PNorm = 60.9146, GNorm = 0.9249, lr_0 = 5.0686e-04
Validation rmse = 1.031467
Epoch 10
Loss = 1.5930e-03, PNorm = 60.9336, GNorm = 0.9333, lr_0 = 4.8539e-04
Loss = 1.3774e-03, PNorm = 60.9518, GNorm = 1.0256, lr_0 = 4.6483e-04
Validation rmse = 0.971673
Epoch 11
Loss = 1.0619e-03, PNorm = 60.9745, GNorm = 0.9410, lr_0 = 4.4322e-04
Loss = 1.3368e-03, PNorm = 60.9918, GNorm = 0.3629, lr_0 = 4.2444e-04
Validation rmse = 0.984079
Epoch 12
Loss = 1.2781e-03, PNorm = 61.0119, GNorm = 1.3533, lr_0 = 4.0646e-04
Loss = 1.0717e-03, PNorm = 61.0324, GNorm = 0.7752, lr_0 = 3.8925e-04
Validation rmse = 1.030092
Epoch 13
Loss = 1.0328e-03, PNorm = 61.0474, GNorm = 0.7915, lr_0 = 3.7276e-04
Loss = 1.1689e-03, PNorm = 61.0628, GNorm = 0.6595, lr_0 = 3.5697e-04
Validation rmse = 1.005684
Epoch 14
Loss = 8.6595e-04, PNorm = 61.0783, GNorm = 0.7086, lr_0 = 3.4037e-04
Loss = 1.0464e-03, PNorm = 61.0908, GNorm = 0.8416, lr_0 = 3.2596e-04
Validation rmse = 1.093939
Epoch 15
Loss = 9.3813e-04, PNorm = 61.1043, GNorm = 0.8503, lr_0 = 3.1215e-04
Loss = 9.4149e-04, PNorm = 61.1194, GNorm = 0.9800, lr_0 = 2.9893e-04
Validation rmse = 1.061083
Epoch 16
Loss = 8.6663e-04, PNorm = 61.1349, GNorm = 0.8704, lr_0 = 2.8503e-04
Loss = 9.3626e-04, PNorm = 61.1475, GNorm = 0.5057, lr_0 = 2.7295e-04
Validation rmse = 1.003120
Epoch 17
Loss = 9.5361e-04, PNorm = 61.1613, GNorm = 0.8515, lr_0 = 2.6139e-04
Loss = 8.6223e-04, PNorm = 61.1734, GNorm = 0.6755, lr_0 = 2.5032e-04
Validation rmse = 1.131042
Epoch 18
Loss = 9.4147e-04, PNorm = 61.1848, GNorm = 0.5863, lr_0 = 2.3972e-04
Loss = 8.8084e-04, PNorm = 61.1948, GNorm = 0.5127, lr_0 = 2.2956e-04
Validation rmse = 1.151496
Epoch 19
Loss = 9.6618e-04, PNorm = 61.2081, GNorm = 0.3115, lr_0 = 2.1889e-04
Loss = 8.3847e-04, PNorm = 61.2151, GNorm = 0.5983, lr_0 = 2.0962e-04
Validation rmse = 1.060917
Epoch 20
Loss = 7.1857e-04, PNorm = 61.2244, GNorm = 0.6160, lr_0 = 2.0074e-04
Loss = 9.2075e-04, PNorm = 61.2331, GNorm = 0.6274, lr_0 = 1.9224e-04
Validation rmse = 1.080744
Epoch 21
Loss = 6.8713e-04, PNorm = 61.2430, GNorm = 0.3297, lr_0 = 1.8409e-04
Loss = 7.7431e-04, PNorm = 61.2501, GNorm = 0.9892, lr_0 = 1.7630e-04
Validation rmse = 1.057086
Epoch 22
Loss = 8.9579e-04, PNorm = 61.2586, GNorm = 0.3413, lr_0 = 1.6810e-04
Loss = 7.2595e-04, PNorm = 61.2663, GNorm = 0.6031, lr_0 = 1.6098e-04
Validation rmse = 1.121201
Epoch 23
Loss = 6.0923e-04, PNorm = 61.2725, GNorm = 0.5253, lr_0 = 1.5416e-04
Loss = 7.1014e-04, PNorm = 61.2781, GNorm = 0.5019, lr_0 = 1.4763e-04
Loss = 1.1254e-03, PNorm = 61.2791, GNorm = 0.6956, lr_0 = 1.4699e-04
Validation rmse = 1.043532
Epoch 24
Loss = 7.0136e-04, PNorm = 61.2859, GNorm = 0.3984, lr_0 = 1.4077e-04
Loss = 6.5694e-04, PNorm = 61.2933, GNorm = 0.5916, lr_0 = 1.3480e-04
Validation rmse = 1.071893
Epoch 25
Loss = 7.7007e-04, PNorm = 61.2979, GNorm = 0.3677, lr_0 = 1.2909e-04
Loss = 6.5473e-04, PNorm = 61.3032, GNorm = 0.8011, lr_0 = 1.2362e-04
Validation rmse = 1.046334
Epoch 26
Loss = 7.3378e-04, PNorm = 61.3082, GNorm = 0.5128, lr_0 = 1.1839e-04
Validation rmse = 1.075680
Epoch 27
Loss = 1.0367e-03, PNorm = 61.3136, GNorm = 0.4308, lr_0 = 1.1288e-04
Loss = 6.4477e-04, PNorm = 61.3198, GNorm = 0.7257, lr_0 = 1.0810e-04
Validation rmse = 1.056301
Epoch 28
Loss = 4.2028e-04, PNorm = 61.3235, GNorm = 0.5335, lr_0 = 1.0352e-04
Loss = 7.0787e-04, PNorm = 61.3273, GNorm = 0.9330, lr_0 = 1.0000e-04
Validation rmse = 1.060581
Epoch 29
Loss = 6.4520e-04, PNorm = 61.3315, GNorm = 0.4359, lr_0 = 1.0000e-04
Loss = 5.7835e-04, PNorm = 61.3364, GNorm = 0.4486, lr_0 = 1.0000e-04
Validation rmse = 1.050707
Model 0 best validation rmse = 0.971673 on epoch 10
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.905568
Ensemble test rmse = 0.905568
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.1_ffn_num_layers_2_hidden_size_1100/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 49 | test scaffolds = 62
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1104, out_features=1100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 3,945,701
Moving model to cuda
Epoch 0
Loss = 1.3457e-02, PNorm = 60.2459, GNorm = 9.4547, lr_0 = 3.6053e-04
Validation rmse = 1.089673
Epoch 1
Loss = 4.6585e-03, PNorm = 60.2988, GNorm = 1.0396, lr_0 = 6.2105e-04
Loss = 4.1908e-03, PNorm = 60.3539, GNorm = 1.5099, lr_0 = 8.5789e-04
Validation rmse = 1.208654
Epoch 2
Loss = 4.4464e-03, PNorm = 60.4161, GNorm = 4.6685, lr_0 = 9.8284e-04
Loss = 3.8059e-03, PNorm = 60.4705, GNorm = 0.8498, lr_0 = 9.4120e-04
Validation rmse = 1.136817
Epoch 3
Loss = 3.4954e-03, PNorm = 60.5170, GNorm = 0.6216, lr_0 = 8.9744e-04
Loss = 2.8838e-03, PNorm = 60.5570, GNorm = 1.0964, lr_0 = 8.5943e-04
Validation rmse = 0.889398
Epoch 4
Loss = 3.2453e-03, PNorm = 60.5934, GNorm = 1.0299, lr_0 = 8.2303e-04
Loss = 2.1992e-03, PNorm = 60.6300, GNorm = 1.1473, lr_0 = 7.8816e-04
Validation rmse = 0.879804
Epoch 5
Loss = 1.9323e-03, PNorm = 60.6627, GNorm = 0.6127, lr_0 = 7.5478e-04
Loss = 1.6947e-03, PNorm = 60.6968, GNorm = 0.9970, lr_0 = 7.2281e-04
Validation rmse = 0.871182
Epoch 6
Loss = 1.8338e-03, PNorm = 60.7285, GNorm = 1.3881, lr_0 = 6.8920e-04
Loss = 2.1128e-03, PNorm = 60.7605, GNorm = 0.5170, lr_0 = 6.6001e-04
Validation rmse = 0.838036
Epoch 7
Loss = 1.3340e-03, PNorm = 60.7916, GNorm = 0.8728, lr_0 = 6.3205e-04
Loss = 2.2166e-03, PNorm = 60.8230, GNorm = 1.5037, lr_0 = 6.0528e-04
Validation rmse = 0.922047
Epoch 8
Loss = 1.9140e-03, PNorm = 60.8537, GNorm = 2.3212, lr_0 = 5.7714e-04
Loss = 1.5977e-03, PNorm = 60.8796, GNorm = 0.7156, lr_0 = 5.5269e-04
Validation rmse = 0.886672
Epoch 9
Loss = 1.5061e-03, PNorm = 60.9049, GNorm = 0.9289, lr_0 = 5.2928e-04
Loss = 1.6618e-03, PNorm = 60.9300, GNorm = 0.8232, lr_0 = 5.0686e-04
Validation rmse = 0.825270
Epoch 10
Loss = 1.6330e-03, PNorm = 60.9497, GNorm = 0.7079, lr_0 = 4.8539e-04
Loss = 1.7816e-03, PNorm = 60.9735, GNorm = 0.7587, lr_0 = 4.6483e-04
Validation rmse = 0.831566
Epoch 11
Loss = 1.6379e-03, PNorm = 60.9963, GNorm = 0.7116, lr_0 = 4.4322e-04
Loss = 1.3436e-03, PNorm = 61.0163, GNorm = 0.4212, lr_0 = 4.2444e-04
Validation rmse = 0.812327
Epoch 12
Loss = 9.6084e-04, PNorm = 61.0345, GNorm = 1.1123, lr_0 = 4.0646e-04
Loss = 1.2978e-03, PNorm = 61.0498, GNorm = 0.4451, lr_0 = 3.8925e-04
Validation rmse = 0.919813
Epoch 13
Loss = 1.2516e-03, PNorm = 61.0678, GNorm = 0.7740, lr_0 = 3.7276e-04
Loss = 1.3820e-03, PNorm = 61.0881, GNorm = 0.6094, lr_0 = 3.5697e-04
Validation rmse = 0.820664
Epoch 14
Loss = 1.1061e-03, PNorm = 61.1057, GNorm = 0.8826, lr_0 = 3.4037e-04
Loss = 1.2924e-03, PNorm = 61.1208, GNorm = 1.0951, lr_0 = 3.2596e-04
Validation rmse = 0.834844
Epoch 15
Loss = 9.0363e-04, PNorm = 61.1348, GNorm = 0.4033, lr_0 = 3.1215e-04
Loss = 1.2694e-03, PNorm = 61.1493, GNorm = 0.3872, lr_0 = 2.9893e-04
Validation rmse = 0.800061
Epoch 16
Loss = 9.7671e-04, PNorm = 61.1637, GNorm = 0.7527, lr_0 = 2.8503e-04
Loss = 1.2347e-03, PNorm = 61.1768, GNorm = 0.6807, lr_0 = 2.7295e-04
Validation rmse = 0.792639
Epoch 17
Loss = 1.0654e-03, PNorm = 61.1895, GNorm = 0.6686, lr_0 = 2.6139e-04
Loss = 1.1407e-03, PNorm = 61.2057, GNorm = 0.9983, lr_0 = 2.5032e-04
Validation rmse = 0.831053
Epoch 18
Loss = 1.3144e-03, PNorm = 61.2202, GNorm = 0.9028, lr_0 = 2.3972e-04
Loss = 1.0974e-03, PNorm = 61.2364, GNorm = 1.1461, lr_0 = 2.2956e-04
Validation rmse = 0.863511
Epoch 19
Loss = 9.0967e-04, PNorm = 61.2488, GNorm = 0.3259, lr_0 = 2.1889e-04
Loss = 1.1783e-03, PNorm = 61.2609, GNorm = 0.6644, lr_0 = 2.0962e-04
Validation rmse = 0.787808
Epoch 20
Loss = 9.8633e-04, PNorm = 61.2709, GNorm = 0.6943, lr_0 = 2.0074e-04
Loss = 1.1252e-03, PNorm = 61.2834, GNorm = 1.5498, lr_0 = 1.9224e-04
Validation rmse = 0.980259
Epoch 21
Loss = 1.0842e-03, PNorm = 61.2938, GNorm = 0.5431, lr_0 = 1.8409e-04
Loss = 9.5446e-04, PNorm = 61.3024, GNorm = 0.5903, lr_0 = 1.7630e-04
Validation rmse = 0.799404
Epoch 22
Loss = 8.9692e-04, PNorm = 61.3130, GNorm = 1.2154, lr_0 = 1.6810e-04
Loss = 9.4436e-04, PNorm = 61.3228, GNorm = 0.4404, lr_0 = 1.6098e-04
Validation rmse = 0.804199
Epoch 23
Loss = 9.5438e-04, PNorm = 61.3300, GNorm = 0.6769, lr_0 = 1.5416e-04
Loss = 9.6372e-04, PNorm = 61.3387, GNorm = 0.8404, lr_0 = 1.4763e-04
Loss = 1.4542e-03, PNorm = 61.3394, GNorm = 0.9303, lr_0 = 1.4699e-04
Validation rmse = 0.761122
Epoch 24
Loss = 7.9632e-04, PNorm = 61.3469, GNorm = 0.4430, lr_0 = 1.4077e-04
Loss = 9.7150e-04, PNorm = 61.3544, GNorm = 0.6965, lr_0 = 1.3480e-04
Validation rmse = 0.769421
Epoch 25
Loss = 7.6473e-04, PNorm = 61.3614, GNorm = 1.2951, lr_0 = 1.2909e-04
Loss = 8.9935e-04, PNorm = 61.3681, GNorm = 0.8144, lr_0 = 1.2362e-04
Validation rmse = 0.753947
Epoch 26
Loss = 8.1751e-04, PNorm = 61.3762, GNorm = 0.5395, lr_0 = 1.1839e-04
Validation rmse = 0.775859
Epoch 27
Loss = 5.2400e-04, PNorm = 61.3838, GNorm = 0.6583, lr_0 = 1.1288e-04
Loss = 6.9304e-04, PNorm = 61.3885, GNorm = 0.4765, lr_0 = 1.0810e-04
Validation rmse = 0.756474
Epoch 28
Loss = 3.6762e-04, PNorm = 61.3954, GNorm = 0.4596, lr_0 = 1.0352e-04
Loss = 8.8031e-04, PNorm = 61.3995, GNorm = 0.7205, lr_0 = 1.0000e-04
Validation rmse = 0.778083
Epoch 29
Loss = 7.5630e-04, PNorm = 61.4049, GNorm = 0.3646, lr_0 = 1.0000e-04
Loss = 7.8721e-04, PNorm = 61.4116, GNorm = 0.6208, lr_0 = 1.0000e-04
Validation rmse = 0.757364
Model 0 best validation rmse = 0.753947 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.954297
Ensemble test rmse = 0.954297
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.1_ffn_num_layers_2_hidden_size_1100/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total scaffolds = 195 | train scaffolds = 94 | val scaffolds = 55 | test scaffolds = 46
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1104, out_features=1100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 3,945,701
Moving model to cuda
Epoch 0
Loss = 1.1644e-02, PNorm = 60.2498, GNorm = 3.8894, lr_0 = 3.6053e-04
Validation rmse = 1.572307
Epoch 1
Loss = 4.5321e-03, PNorm = 60.2995, GNorm = 3.7439, lr_0 = 6.2105e-04
Loss = 3.2318e-03, PNorm = 60.3545, GNorm = 1.1091, lr_0 = 8.5789e-04
Validation rmse = 1.197370
Epoch 2
Loss = 2.1278e-03, PNorm = 60.4169, GNorm = 0.9122, lr_0 = 9.8284e-04
Loss = 2.9327e-03, PNorm = 60.4747, GNorm = 2.8358, lr_0 = 9.4120e-04
Validation rmse = 1.165449
Epoch 3
Loss = 2.9632e-03, PNorm = 60.5239, GNorm = 0.5260, lr_0 = 8.9744e-04
Loss = 2.6182e-03, PNorm = 60.5664, GNorm = 1.4946, lr_0 = 8.5943e-04
Validation rmse = 1.082852
Epoch 4
Loss = 1.9897e-03, PNorm = 60.6008, GNorm = 1.8976, lr_0 = 8.2303e-04
Loss = 2.2825e-03, PNorm = 60.6367, GNorm = 1.3498, lr_0 = 7.8816e-04
Validation rmse = 0.975510
Epoch 5
Loss = 2.0104e-03, PNorm = 60.6669, GNorm = 0.9857, lr_0 = 7.5478e-04
Loss = 1.9511e-03, PNorm = 60.6944, GNorm = 2.7983, lr_0 = 7.2281e-04
Validation rmse = 1.028837
Epoch 6
Loss = 2.3228e-03, PNorm = 60.7263, GNorm = 1.7120, lr_0 = 6.8920e-04
Loss = 2.1245e-03, PNorm = 60.7573, GNorm = 0.7211, lr_0 = 6.6001e-04
Validation rmse = 0.998966
Epoch 7
Loss = 1.9011e-03, PNorm = 60.7827, GNorm = 0.4512, lr_0 = 6.3205e-04
Loss = 1.5865e-03, PNorm = 60.8081, GNorm = 0.9806, lr_0 = 6.0528e-04
Validation rmse = 0.875461
Epoch 8
Loss = 1.8792e-03, PNorm = 60.8327, GNorm = 0.9050, lr_0 = 5.7714e-04
Loss = 1.5959e-03, PNorm = 60.8591, GNorm = 1.6495, lr_0 = 5.5269e-04
Validation rmse = 0.986681
Epoch 9
Loss = 1.4111e-03, PNorm = 60.8801, GNorm = 0.5069, lr_0 = 5.2928e-04
Loss = 1.5042e-03, PNorm = 60.9028, GNorm = 0.5260, lr_0 = 5.0686e-04
Validation rmse = 0.917971
Epoch 10
Loss = 1.4475e-03, PNorm = 60.9264, GNorm = 1.5230, lr_0 = 4.8539e-04
Loss = 1.5538e-03, PNorm = 60.9465, GNorm = 1.6607, lr_0 = 4.6483e-04
Validation rmse = 1.073727
Epoch 11
Loss = 1.2531e-03, PNorm = 60.9674, GNorm = 0.6649, lr_0 = 4.4322e-04
Loss = 1.3345e-03, PNorm = 60.9864, GNorm = 1.4391, lr_0 = 4.2444e-04
Validation rmse = 0.955573
Epoch 12
Loss = 9.2467e-04, PNorm = 61.0039, GNorm = 0.6490, lr_0 = 4.0646e-04
Loss = 1.3507e-03, PNorm = 61.0206, GNorm = 0.9533, lr_0 = 3.8925e-04
Validation rmse = 0.895049
Epoch 13
Loss = 1.3252e-03, PNorm = 61.0358, GNorm = 1.5803, lr_0 = 3.7276e-04
Loss = 1.3423e-03, PNorm = 61.0511, GNorm = 1.1887, lr_0 = 3.5697e-04
Validation rmse = 0.986706
Epoch 14
Loss = 1.2533e-03, PNorm = 61.0722, GNorm = 0.5119, lr_0 = 3.4037e-04
Loss = 1.0330e-03, PNorm = 61.0859, GNorm = 0.4926, lr_0 = 3.2596e-04
Validation rmse = 0.957109
Epoch 15
Loss = 1.2402e-03, PNorm = 61.1004, GNorm = 0.8822, lr_0 = 3.1215e-04
Loss = 1.1043e-03, PNorm = 61.1182, GNorm = 0.7095, lr_0 = 2.9893e-04
Validation rmse = 0.928976
Epoch 16
Loss = 9.3842e-04, PNorm = 61.1321, GNorm = 0.8332, lr_0 = 2.8503e-04
Loss = 1.2077e-03, PNorm = 61.1427, GNorm = 1.4808, lr_0 = 2.7295e-04
Validation rmse = 0.914695
Epoch 17
Loss = 9.4451e-04, PNorm = 61.1548, GNorm = 1.0019, lr_0 = 2.6139e-04
Loss = 1.0690e-03, PNorm = 61.1653, GNorm = 1.0910, lr_0 = 2.5032e-04
Validation rmse = 0.940363
Epoch 18
Loss = 8.6070e-04, PNorm = 61.1758, GNorm = 0.4027, lr_0 = 2.3972e-04
Loss = 8.9536e-04, PNorm = 61.1864, GNorm = 0.7954, lr_0 = 2.2956e-04
Validation rmse = 0.973459
Epoch 19
Loss = 8.4633e-04, PNorm = 61.1980, GNorm = 0.6286, lr_0 = 2.1889e-04
Loss = 9.7281e-04, PNorm = 61.2062, GNorm = 0.5775, lr_0 = 2.0962e-04
Validation rmse = 0.973586
Epoch 20
Loss = 8.4746e-04, PNorm = 61.2179, GNorm = 0.3857, lr_0 = 2.0074e-04
Loss = 1.0239e-03, PNorm = 61.2259, GNorm = 0.6359, lr_0 = 1.9224e-04
Validation rmse = 0.970793
Epoch 21
Loss = 8.8866e-04, PNorm = 61.2335, GNorm = 1.8034, lr_0 = 1.8409e-04
Loss = 1.0448e-03, PNorm = 61.2427, GNorm = 1.5274, lr_0 = 1.7630e-04
Validation rmse = 0.960796
Epoch 22
Loss = 7.2644e-04, PNorm = 61.2532, GNorm = 0.3315, lr_0 = 1.6810e-04
Loss = 9.1510e-04, PNorm = 61.2619, GNorm = 1.2190, lr_0 = 1.6098e-04
Validation rmse = 0.950611
Epoch 23
Loss = 9.0565e-04, PNorm = 61.2693, GNorm = 0.3782, lr_0 = 1.5416e-04
Loss = 7.7472e-04, PNorm = 61.2767, GNorm = 0.7347, lr_0 = 1.4763e-04
Loss = 5.0536e-04, PNorm = 61.2774, GNorm = 0.3989, lr_0 = 1.4699e-04
Validation rmse = 0.969563
Epoch 24
Loss = 8.4234e-04, PNorm = 61.2842, GNorm = 0.4154, lr_0 = 1.4077e-04
Loss = 8.8704e-04, PNorm = 61.2908, GNorm = 0.8947, lr_0 = 1.3480e-04
Validation rmse = 1.019772
Epoch 25
Loss = 7.5852e-04, PNorm = 61.2980, GNorm = 0.5458, lr_0 = 1.2909e-04
Loss = 9.0222e-04, PNorm = 61.3029, GNorm = 0.9996, lr_0 = 1.2362e-04
Validation rmse = 0.988815
Epoch 26
Loss = 7.4379e-04, PNorm = 61.3088, GNorm = 0.4885, lr_0 = 1.1839e-04
Validation rmse = 0.958166
Epoch 27
Loss = 6.7999e-04, PNorm = 61.3142, GNorm = 0.6387, lr_0 = 1.1288e-04
Loss = 7.7878e-04, PNorm = 61.3190, GNorm = 0.4769, lr_0 = 1.0810e-04
Validation rmse = 0.918285
Epoch 28
Loss = 6.4980e-04, PNorm = 61.3237, GNorm = 0.4837, lr_0 = 1.0352e-04
Loss = 7.6762e-04, PNorm = 61.3293, GNorm = 0.6492, lr_0 = 1.0000e-04
Validation rmse = 0.933160
Epoch 29
Loss = 6.4717e-04, PNorm = 61.3344, GNorm = 0.3544, lr_0 = 1.0000e-04
Loss = 6.8207e-04, PNorm = 61.3390, GNorm = 0.2468, lr_0 = 1.0000e-04
Validation rmse = 0.969875
Model 0 best validation rmse = 0.875461 on epoch 7
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.016522
Ensemble test rmse = 1.016522
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.1_ffn_num_layers_2_hidden_size_1100/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total scaffolds = 195 | train scaffolds = 64 | val scaffolds = 68 | test scaffolds = 63
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1104, out_features=1100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 3,945,701
Moving model to cuda
Epoch 0
Loss = 1.3433e-02, PNorm = 60.2473, GNorm = 6.0372, lr_0 = 3.6053e-04
Validation rmse = 1.394834
Epoch 1
Loss = 3.1585e-03, PNorm = 60.2963, GNorm = 1.7309, lr_0 = 6.2105e-04
Loss = 4.5406e-03, PNorm = 60.3531, GNorm = 0.5887, lr_0 = 8.5789e-04
Validation rmse = 1.275471
Epoch 2
Loss = 3.2340e-03, PNorm = 60.4110, GNorm = 1.5920, lr_0 = 9.8284e-04
Loss = 3.0433e-03, PNorm = 60.4583, GNorm = 1.1872, lr_0 = 9.4120e-04
Validation rmse = 1.240645
Epoch 3
Loss = 1.9559e-03, PNorm = 60.5054, GNorm = 1.5445, lr_0 = 8.9744e-04
Loss = 1.8110e-03, PNorm = 60.5396, GNorm = 1.0564, lr_0 = 8.5943e-04
Validation rmse = 1.236561
Epoch 4
Loss = 2.3123e-03, PNorm = 60.5772, GNorm = 1.0168, lr_0 = 8.2303e-04
Loss = 2.6188e-03, PNorm = 60.6185, GNorm = 1.8198, lr_0 = 7.8816e-04
Validation rmse = 1.173320
Epoch 5
Loss = 1.9518e-03, PNorm = 60.6547, GNorm = 0.8106, lr_0 = 7.5478e-04
Loss = 2.1632e-03, PNorm = 60.6851, GNorm = 0.7331, lr_0 = 7.2281e-04
Validation rmse = 1.310623
Epoch 6
Loss = 2.3810e-03, PNorm = 60.7136, GNorm = 1.3562, lr_0 = 6.8920e-04
Loss = 2.0879e-03, PNorm = 60.7494, GNorm = 1.9073, lr_0 = 6.6001e-04
Validation rmse = 1.073574
Epoch 7
Loss = 1.8813e-03, PNorm = 60.7763, GNorm = 0.6106, lr_0 = 6.3205e-04
Loss = 1.6252e-03, PNorm = 60.8002, GNorm = 1.2467, lr_0 = 6.0528e-04
Validation rmse = 1.028707
Epoch 8
Loss = 1.4437e-03, PNorm = 60.8249, GNorm = 0.9229, lr_0 = 5.7714e-04
Loss = 1.4609e-03, PNorm = 60.8462, GNorm = 0.7446, lr_0 = 5.5269e-04
Validation rmse = 1.215857
Epoch 9
Loss = 1.5941e-03, PNorm = 60.8682, GNorm = 0.4041, lr_0 = 5.2928e-04
Loss = 1.5471e-03, PNorm = 60.8890, GNorm = 0.5210, lr_0 = 5.0686e-04
Validation rmse = 0.990768
Epoch 10
Loss = 1.6755e-03, PNorm = 60.9135, GNorm = 1.0197, lr_0 = 4.8539e-04
Loss = 1.3452e-03, PNorm = 60.9394, GNorm = 0.6700, lr_0 = 4.6483e-04
Validation rmse = 1.043225
Epoch 11
Loss = 1.7379e-03, PNorm = 60.9595, GNorm = 0.5407, lr_0 = 4.4322e-04
Loss = 1.3218e-03, PNorm = 60.9809, GNorm = 0.9106, lr_0 = 4.2444e-04
Validation rmse = 0.989041
Epoch 12
Loss = 1.3264e-03, PNorm = 60.9993, GNorm = 0.7581, lr_0 = 4.0646e-04
Loss = 1.5019e-03, PNorm = 61.0178, GNorm = 0.9381, lr_0 = 3.8925e-04
Validation rmse = 1.022526
Epoch 13
Loss = 1.1398e-03, PNorm = 61.0387, GNorm = 0.5253, lr_0 = 3.7276e-04
Loss = 1.1948e-03, PNorm = 61.0577, GNorm = 0.3426, lr_0 = 3.5697e-04
Validation rmse = 1.065963
Epoch 14
Loss = 1.2249e-03, PNorm = 61.0740, GNorm = 0.8814, lr_0 = 3.4037e-04
Loss = 1.2021e-03, PNorm = 61.0904, GNorm = 0.4754, lr_0 = 3.2596e-04
Validation rmse = 1.054021
Epoch 15
Loss = 1.1653e-03, PNorm = 61.1029, GNorm = 0.4181, lr_0 = 3.1215e-04
Loss = 1.1078e-03, PNorm = 61.1165, GNorm = 1.3478, lr_0 = 2.9893e-04
Validation rmse = 1.055002
Epoch 16
Loss = 1.0383e-03, PNorm = 61.1326, GNorm = 0.4945, lr_0 = 2.8503e-04
Loss = 9.8197e-04, PNorm = 61.1455, GNorm = 1.0157, lr_0 = 2.7295e-04
Validation rmse = 1.077470
Epoch 17
Loss = 1.0226e-03, PNorm = 61.1576, GNorm = 0.3888, lr_0 = 2.6139e-04
Loss = 1.0941e-03, PNorm = 61.1655, GNorm = 0.9870, lr_0 = 2.5032e-04
Validation rmse = 1.101530
Epoch 18
Loss = 1.3761e-03, PNorm = 61.1784, GNorm = 1.2428, lr_0 = 2.3972e-04
Loss = 1.1677e-03, PNorm = 61.1934, GNorm = 0.4505, lr_0 = 2.2956e-04
Validation rmse = 1.095535
Epoch 19
Loss = 8.4000e-04, PNorm = 61.2092, GNorm = 0.3535, lr_0 = 2.1889e-04
Loss = 9.1845e-04, PNorm = 61.2175, GNorm = 1.1426, lr_0 = 2.0962e-04
Validation rmse = 1.041776
Epoch 20
Loss = 9.2208e-04, PNorm = 61.2265, GNorm = 0.6235, lr_0 = 2.0074e-04
Loss = 9.2851e-04, PNorm = 61.2343, GNorm = 0.5857, lr_0 = 1.9224e-04
Validation rmse = 1.003655
Epoch 21
Loss = 9.3126e-04, PNorm = 61.2446, GNorm = 0.5804, lr_0 = 1.8409e-04
Loss = 7.9991e-04, PNorm = 61.2525, GNorm = 0.5160, lr_0 = 1.7630e-04
Validation rmse = 1.041011
Epoch 22
Loss = 8.2761e-04, PNorm = 61.2612, GNorm = 0.3456, lr_0 = 1.6810e-04
Loss = 7.3357e-04, PNorm = 61.2688, GNorm = 0.3643, lr_0 = 1.6098e-04
Validation rmse = 1.022432
Epoch 23
Loss = 7.4711e-04, PNorm = 61.2770, GNorm = 0.6835, lr_0 = 1.5416e-04
Loss = 7.9641e-04, PNorm = 61.2836, GNorm = 0.5377, lr_0 = 1.4763e-04
Loss = 1.9524e-03, PNorm = 61.2841, GNorm = 0.7731, lr_0 = 1.4699e-04
Validation rmse = 0.999741
Epoch 24
Loss = 7.7583e-04, PNorm = 61.2905, GNorm = 0.3255, lr_0 = 1.4077e-04
Loss = 8.9323e-04, PNorm = 61.2966, GNorm = 0.5378, lr_0 = 1.3480e-04
Validation rmse = 0.997506
Epoch 25
Loss = 6.8292e-04, PNorm = 61.3012, GNorm = 0.5402, lr_0 = 1.2909e-04
Loss = 7.9254e-04, PNorm = 61.3074, GNorm = 1.2122, lr_0 = 1.2362e-04
Validation rmse = 0.981639
Epoch 26
Loss = 6.9708e-04, PNorm = 61.3124, GNorm = 0.4864, lr_0 = 1.1839e-04
Validation rmse = 0.991148
Epoch 27
Loss = 8.5248e-04, PNorm = 61.3189, GNorm = 1.0284, lr_0 = 1.1288e-04
Loss = 6.4907e-04, PNorm = 61.3240, GNorm = 0.4728, lr_0 = 1.0810e-04
Validation rmse = 0.990664
Epoch 28
Loss = 5.5264e-04, PNorm = 61.3303, GNorm = 0.9363, lr_0 = 1.0352e-04
Loss = 6.3588e-04, PNorm = 61.3339, GNorm = 0.3431, lr_0 = 1.0000e-04
Validation rmse = 1.067623
Epoch 29
Loss = 7.5530e-04, PNorm = 61.3396, GNorm = 1.0124, lr_0 = 1.0000e-04
Loss = 6.8096e-04, PNorm = 61.3437, GNorm = 0.7009, lr_0 = 1.0000e-04
Validation rmse = 0.999727
Model 0 best validation rmse = 0.981639 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.734475
Ensemble test rmse = 0.734475
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.1_ffn_num_layers_2_hidden_size_1100/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total scaffolds = 195 | train scaffolds = 69 | val scaffolds = 65 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1104, out_features=1100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 3,945,701
Moving model to cuda
Epoch 0
Loss = 1.4469e-02, PNorm = 60.2461, GNorm = 7.1294, lr_0 = 3.6053e-04
Validation rmse = 1.992409
Epoch 1
Loss = 5.7517e-03, PNorm = 60.2951, GNorm = 5.1866, lr_0 = 6.2105e-04
Loss = 4.2729e-03, PNorm = 60.3553, GNorm = 2.1631, lr_0 = 8.5789e-04
Validation rmse = 1.266932
Epoch 2
Loss = 3.6569e-03, PNorm = 60.4186, GNorm = 1.0672, lr_0 = 9.8284e-04
Loss = 3.1145e-03, PNorm = 60.4753, GNorm = 1.5627, lr_0 = 9.4120e-04
Validation rmse = 1.206295
Epoch 3
Loss = 2.5816e-03, PNorm = 60.5289, GNorm = 1.0883, lr_0 = 8.9744e-04
Loss = 2.4845e-03, PNorm = 60.5674, GNorm = 1.5421, lr_0 = 8.5943e-04
Validation rmse = 1.386624
Epoch 4
Loss = 2.2844e-03, PNorm = 60.6035, GNorm = 1.6551, lr_0 = 8.2303e-04
Loss = 2.1519e-03, PNorm = 60.6377, GNorm = 1.1150, lr_0 = 7.8816e-04
Validation rmse = 1.454841
Epoch 5
Loss = 2.2640e-03, PNorm = 60.6726, GNorm = 1.2882, lr_0 = 7.5478e-04
Loss = 1.5755e-03, PNorm = 60.7055, GNorm = 0.5442, lr_0 = 7.2281e-04
Validation rmse = 1.358403
Epoch 6
Loss = 2.4861e-03, PNorm = 60.7396, GNorm = 3.0616, lr_0 = 6.8920e-04
Loss = 1.7136e-03, PNorm = 60.7683, GNorm = 0.8053, lr_0 = 6.6001e-04
Validation rmse = 1.132640
Epoch 7
Loss = 1.5978e-03, PNorm = 60.7922, GNorm = 0.3916, lr_0 = 6.3205e-04
Loss = 1.7796e-03, PNorm = 60.8152, GNorm = 0.6777, lr_0 = 6.0528e-04
Validation rmse = 1.395737
Epoch 8
Loss = 1.5872e-03, PNorm = 60.8388, GNorm = 1.0313, lr_0 = 5.7714e-04
Loss = 1.6531e-03, PNorm = 60.8621, GNorm = 0.8609, lr_0 = 5.5269e-04
Validation rmse = 1.248541
Epoch 9
Loss = 1.6564e-03, PNorm = 60.8825, GNorm = 0.4679, lr_0 = 5.2928e-04
Loss = 1.4523e-03, PNorm = 60.9054, GNorm = 0.7928, lr_0 = 5.0686e-04
Validation rmse = 1.255679
Epoch 10
Loss = 1.4202e-03, PNorm = 60.9241, GNorm = 0.7227, lr_0 = 4.8539e-04
Loss = 1.3441e-03, PNorm = 60.9431, GNorm = 1.0128, lr_0 = 4.6483e-04
Validation rmse = 1.306704
Epoch 11
Loss = 1.4355e-03, PNorm = 60.9652, GNorm = 1.6416, lr_0 = 4.4322e-04
Loss = 1.2271e-03, PNorm = 60.9831, GNorm = 0.2644, lr_0 = 4.2444e-04
Validation rmse = 1.222816
Epoch 12
Loss = 1.2798e-03, PNorm = 60.9990, GNorm = 0.4703, lr_0 = 4.0646e-04
Loss = 1.1519e-03, PNorm = 61.0184, GNorm = 0.6641, lr_0 = 3.8925e-04
Validation rmse = 1.185472
Epoch 13
Loss = 1.9481e-03, PNorm = 61.0369, GNorm = 2.0306, lr_0 = 3.7276e-04
Loss = 1.6382e-03, PNorm = 61.0577, GNorm = 0.9332, lr_0 = 3.5697e-04
Validation rmse = 1.359942
Epoch 14
Loss = 1.4608e-03, PNorm = 61.0764, GNorm = 1.0987, lr_0 = 3.4037e-04
Loss = 1.1138e-03, PNorm = 61.0902, GNorm = 1.2749, lr_0 = 3.2596e-04
Validation rmse = 1.226405
Epoch 15
Loss = 1.0804e-03, PNorm = 61.1020, GNorm = 0.5782, lr_0 = 3.1215e-04
Loss = 1.0954e-03, PNorm = 61.1143, GNorm = 0.3187, lr_0 = 2.9893e-04
Validation rmse = 1.304629
Epoch 16
Loss = 1.0403e-03, PNorm = 61.1315, GNorm = 0.6601, lr_0 = 2.8503e-04
Loss = 9.3142e-04, PNorm = 61.1420, GNorm = 0.3568, lr_0 = 2.7295e-04
Validation rmse = 1.218342
Epoch 17
Loss = 9.5530e-04, PNorm = 61.1523, GNorm = 0.6714, lr_0 = 2.6139e-04
Loss = 1.1292e-03, PNorm = 61.1623, GNorm = 1.5567, lr_0 = 2.5032e-04
Validation rmse = 1.174748
Epoch 18
Loss = 1.0654e-03, PNorm = 61.1732, GNorm = 0.5714, lr_0 = 2.3972e-04
Loss = 9.8942e-04, PNorm = 61.1852, GNorm = 0.6777, lr_0 = 2.2956e-04
Validation rmse = 1.255837
Epoch 19
Loss = 7.6330e-04, PNorm = 61.1954, GNorm = 0.4779, lr_0 = 2.1889e-04
Loss = 8.7164e-04, PNorm = 61.2047, GNorm = 0.6328, lr_0 = 2.0962e-04
Validation rmse = 1.253030
Epoch 20
Loss = 9.9577e-04, PNorm = 61.2129, GNorm = 0.7003, lr_0 = 2.0074e-04
Loss = 9.2230e-04, PNorm = 61.2225, GNorm = 0.5951, lr_0 = 1.9224e-04
Validation rmse = 1.244004
Epoch 21
Loss = 8.3213e-04, PNorm = 61.2299, GNorm = 1.0912, lr_0 = 1.8409e-04
Loss = 8.6419e-04, PNorm = 61.2384, GNorm = 0.8492, lr_0 = 1.7630e-04
Validation rmse = 1.298803
Epoch 22
Loss = 7.4097e-04, PNorm = 61.2470, GNorm = 0.6886, lr_0 = 1.6810e-04
Loss = 9.4237e-04, PNorm = 61.2543, GNorm = 0.7676, lr_0 = 1.6098e-04
Validation rmse = 1.263724
Epoch 23
Loss = 1.0257e-03, PNorm = 61.2622, GNorm = 0.5563, lr_0 = 1.5416e-04
Loss = 8.2608e-04, PNorm = 61.2703, GNorm = 0.7780, lr_0 = 1.4763e-04
Loss = 1.8908e-03, PNorm = 61.2707, GNorm = 2.4441, lr_0 = 1.4699e-04
Validation rmse = 1.264067
Epoch 24
Loss = 9.3675e-04, PNorm = 61.2768, GNorm = 1.1255, lr_0 = 1.4077e-04
Loss = 7.6471e-04, PNorm = 61.2823, GNorm = 0.4507, lr_0 = 1.3480e-04
Validation rmse = 1.226258
Epoch 25
Loss = 7.8295e-04, PNorm = 61.2880, GNorm = 0.4172, lr_0 = 1.2909e-04
Loss = 9.1455e-04, PNorm = 61.2937, GNorm = 0.4995, lr_0 = 1.2362e-04
Validation rmse = 1.251480
Epoch 26
Loss = 8.0673e-04, PNorm = 61.2977, GNorm = 0.4306, lr_0 = 1.1839e-04
Validation rmse = 1.274377
Epoch 27
Loss = 5.6649e-04, PNorm = 61.3036, GNorm = 1.0961, lr_0 = 1.1288e-04
Loss = 7.2473e-04, PNorm = 61.3086, GNorm = 0.9792, lr_0 = 1.0810e-04
Validation rmse = 1.292225
Epoch 28
Loss = 7.8032e-04, PNorm = 61.3133, GNorm = 0.3638, lr_0 = 1.0352e-04
Loss = 7.0915e-04, PNorm = 61.3183, GNorm = 0.4292, lr_0 = 1.0000e-04
Validation rmse = 1.310854
Epoch 29
Loss = 7.7822e-04, PNorm = 61.3225, GNorm = 0.5250, lr_0 = 1.0000e-04
Loss = 6.0242e-04, PNorm = 61.3260, GNorm = 0.3079, lr_0 = 1.0000e-04
Validation rmse = 1.292191
Model 0 best validation rmse = 1.132640 on epoch 6
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.972294
Ensemble test rmse = 0.972294
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.1_ffn_num_layers_2_hidden_size_1100/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total scaffolds = 195 | train scaffolds = 75 | val scaffolds = 42 | test scaffolds = 78
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1104, out_features=1100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 3,945,701
Moving model to cuda
Epoch 0
Loss = 1.2567e-02, PNorm = 60.2486, GNorm = 6.1148, lr_0 = 3.6053e-04
Validation rmse = 1.205076
Epoch 1
Loss = 1.9933e-03, PNorm = 60.2974, GNorm = 1.7448, lr_0 = 6.2105e-04
Loss = 3.6801e-03, PNorm = 60.3517, GNorm = 3.5908, lr_0 = 8.5789e-04
Validation rmse = 1.125913
Epoch 2
Loss = 3.1299e-03, PNorm = 60.4075, GNorm = 0.8810, lr_0 = 9.8284e-04
Loss = 2.8171e-03, PNorm = 60.4560, GNorm = 2.3049, lr_0 = 9.4120e-04
Validation rmse = 1.093552
Epoch 3
Loss = 1.8191e-03, PNorm = 60.5017, GNorm = 0.9205, lr_0 = 8.9744e-04
Loss = 2.5425e-03, PNorm = 60.5374, GNorm = 1.0218, lr_0 = 8.5943e-04
Validation rmse = 1.033074
Epoch 4
Loss = 2.7475e-03, PNorm = 60.5731, GNorm = 0.9052, lr_0 = 8.2303e-04
Loss = 2.1383e-03, PNorm = 60.6018, GNorm = 0.7898, lr_0 = 7.8816e-04
Validation rmse = 0.971327
Epoch 5
Loss = 1.7858e-03, PNorm = 60.6277, GNorm = 0.7453, lr_0 = 7.5478e-04
Loss = 2.3908e-03, PNorm = 60.6541, GNorm = 1.5140, lr_0 = 7.2281e-04
Validation rmse = 1.013416
Epoch 6
Loss = 1.2883e-03, PNorm = 60.6848, GNorm = 0.6420, lr_0 = 6.8920e-04
Loss = 1.7871e-03, PNorm = 60.7101, GNorm = 1.4718, lr_0 = 6.6001e-04
Validation rmse = 1.125306
Epoch 7
Loss = 2.2029e-03, PNorm = 60.7361, GNorm = 1.7835, lr_0 = 6.3205e-04
Loss = 2.5664e-03, PNorm = 60.7645, GNorm = 1.6980, lr_0 = 6.0528e-04
Validation rmse = 0.919461
Epoch 8
Loss = 1.8479e-03, PNorm = 60.7962, GNorm = 0.3938, lr_0 = 5.7714e-04
Loss = 1.4019e-03, PNorm = 60.8223, GNorm = 1.1747, lr_0 = 5.5269e-04
Validation rmse = 0.968113
Epoch 9
Loss = 1.1553e-03, PNorm = 60.8426, GNorm = 0.5163, lr_0 = 5.2928e-04
Loss = 1.4142e-03, PNorm = 60.8621, GNorm = 1.1467, lr_0 = 5.0686e-04
Validation rmse = 0.889007
Epoch 10
Loss = 1.0969e-03, PNorm = 60.8822, GNorm = 0.4083, lr_0 = 4.8539e-04
Loss = 1.3549e-03, PNorm = 60.8996, GNorm = 0.7485, lr_0 = 4.6483e-04
Validation rmse = 0.892863
Epoch 11
Loss = 1.2601e-03, PNorm = 60.9158, GNorm = 0.3487, lr_0 = 4.4322e-04
Loss = 1.1719e-03, PNorm = 60.9342, GNorm = 0.4367, lr_0 = 4.2444e-04
Validation rmse = 0.871717
Epoch 12
Loss = 9.1598e-04, PNorm = 60.9496, GNorm = 0.8598, lr_0 = 4.0646e-04
Loss = 1.1941e-03, PNorm = 60.9644, GNorm = 1.1721, lr_0 = 3.8925e-04
Validation rmse = 0.892165
Epoch 13
Loss = 1.3394e-03, PNorm = 60.9804, GNorm = 1.3638, lr_0 = 3.7276e-04
Loss = 1.2189e-03, PNorm = 60.9986, GNorm = 1.0711, lr_0 = 3.5697e-04
Validation rmse = 0.870377
Epoch 14
Loss = 1.1035e-03, PNorm = 61.0176, GNorm = 0.3443, lr_0 = 3.4037e-04
Loss = 1.2222e-03, PNorm = 61.0301, GNorm = 1.2153, lr_0 = 3.2596e-04
Validation rmse = 0.875259
Epoch 15
Loss = 1.0248e-03, PNorm = 61.0454, GNorm = 1.3103, lr_0 = 3.1215e-04
Loss = 1.1834e-03, PNorm = 61.0599, GNorm = 0.3794, lr_0 = 2.9893e-04
Validation rmse = 0.945396
Epoch 16
Loss = 9.6878e-04, PNorm = 61.0744, GNorm = 0.3937, lr_0 = 2.8503e-04
Loss = 1.1269e-03, PNorm = 61.0891, GNorm = 0.6542, lr_0 = 2.7295e-04
Validation rmse = 0.906667
Epoch 17
Loss = 1.0335e-03, PNorm = 61.1001, GNorm = 0.3792, lr_0 = 2.6139e-04
Loss = 9.6930e-04, PNorm = 61.1115, GNorm = 0.3280, lr_0 = 2.5032e-04
Validation rmse = 0.940271
Epoch 18
Loss = 1.0350e-03, PNorm = 61.1195, GNorm = 0.4673, lr_0 = 2.3972e-04
Loss = 1.0945e-03, PNorm = 61.1299, GNorm = 0.8819, lr_0 = 2.2956e-04
Validation rmse = 0.942774
Epoch 19
Loss = 9.3565e-04, PNorm = 61.1418, GNorm = 0.5288, lr_0 = 2.1889e-04
Loss = 9.0359e-04, PNorm = 61.1517, GNorm = 0.3117, lr_0 = 2.0962e-04
Validation rmse = 0.928317
Epoch 20
Loss = 7.9634e-04, PNorm = 61.1625, GNorm = 0.4851, lr_0 = 2.0074e-04
Loss = 1.0148e-03, PNorm = 61.1715, GNorm = 0.6848, lr_0 = 1.9224e-04
Validation rmse = 0.929112
Epoch 21
Loss = 8.7129e-04, PNorm = 61.1820, GNorm = 0.4968, lr_0 = 1.8409e-04
Loss = 8.9307e-04, PNorm = 61.1908, GNorm = 0.4216, lr_0 = 1.7630e-04
Validation rmse = 0.973577
Epoch 22
Loss = 9.1259e-04, PNorm = 61.2000, GNorm = 0.8034, lr_0 = 1.6810e-04
Loss = 7.9666e-04, PNorm = 61.2075, GNorm = 0.6722, lr_0 = 1.6098e-04
Validation rmse = 0.941924
Epoch 23
Loss = 8.6062e-04, PNorm = 61.2146, GNorm = 0.7339, lr_0 = 1.5416e-04
Loss = 7.4457e-04, PNorm = 61.2231, GNorm = 0.7057, lr_0 = 1.4763e-04
Loss = 8.8487e-04, PNorm = 61.2237, GNorm = 0.5804, lr_0 = 1.4699e-04
Validation rmse = 0.909944
Epoch 24
Loss = 8.5169e-04, PNorm = 61.2288, GNorm = 0.9796, lr_0 = 1.4077e-04
Loss = 9.6573e-04, PNorm = 61.2379, GNorm = 0.6494, lr_0 = 1.3480e-04
Validation rmse = 0.924952
Epoch 25
Loss = 7.6835e-04, PNorm = 61.2435, GNorm = 0.7774, lr_0 = 1.2909e-04
Loss = 7.8645e-04, PNorm = 61.2489, GNorm = 0.9321, lr_0 = 1.2362e-04
Validation rmse = 0.955722
Epoch 26
Loss = 9.0356e-04, PNorm = 61.2553, GNorm = 1.0651, lr_0 = 1.1839e-04
Validation rmse = 0.923159
Epoch 27
Loss = 8.6922e-04, PNorm = 61.2615, GNorm = 0.6001, lr_0 = 1.1288e-04
Loss = 6.4299e-04, PNorm = 61.2664, GNorm = 0.8282, lr_0 = 1.0810e-04
Validation rmse = 0.951677
Epoch 28
Loss = 7.1562e-04, PNorm = 61.2714, GNorm = 0.9481, lr_0 = 1.0352e-04
Loss = 7.0205e-04, PNorm = 61.2761, GNorm = 0.6130, lr_0 = 1.0000e-04
Validation rmse = 0.954526
Epoch 29
Loss = 5.3968e-04, PNorm = 61.2818, GNorm = 0.3710, lr_0 = 1.0000e-04
Loss = 6.2570e-04, PNorm = 61.2857, GNorm = 0.4256, lr_0 = 1.0000e-04
Validation rmse = 0.949905
Model 0 best validation rmse = 0.870377 on epoch 13
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.983059
Ensemble test rmse = 0.983059
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.1_ffn_num_layers_2_hidden_size_1100/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 58 | test scaffolds = 53
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1104, out_features=1100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 3,945,701
Moving model to cuda
Epoch 0
Loss = 1.4419e-02, PNorm = 60.2472, GNorm = 4.5554, lr_0 = 3.6053e-04
Validation rmse = 1.285785
Epoch 1
Loss = 4.5520e-03, PNorm = 60.2988, GNorm = 1.7262, lr_0 = 6.2105e-04
Loss = 4.2320e-03, PNorm = 60.3621, GNorm = 2.0946, lr_0 = 8.5789e-04
Validation rmse = 1.052862
Epoch 2
Loss = 2.3313e-03, PNorm = 60.4254, GNorm = 0.6013, lr_0 = 9.8284e-04
Loss = 3.3956e-03, PNorm = 60.4811, GNorm = 4.7765, lr_0 = 9.4120e-04
Validation rmse = 1.219011
Epoch 3
Loss = 4.7287e-03, PNorm = 60.5323, GNorm = 2.7387, lr_0 = 8.9744e-04
Loss = 3.9103e-03, PNorm = 60.5759, GNorm = 1.4387, lr_0 = 8.5943e-04
Validation rmse = 0.877306
Epoch 4
Loss = 3.3517e-03, PNorm = 60.6207, GNorm = 1.9650, lr_0 = 8.2303e-04
Loss = 2.3308e-03, PNorm = 60.6574, GNorm = 1.0829, lr_0 = 7.8816e-04
Validation rmse = 0.906967
Epoch 5
Loss = 1.5957e-03, PNorm = 60.6866, GNorm = 0.7919, lr_0 = 7.5478e-04
Loss = 2.2082e-03, PNorm = 60.7185, GNorm = 0.7749, lr_0 = 7.2281e-04
Validation rmse = 0.846201
Epoch 6
Loss = 3.1564e-03, PNorm = 60.7474, GNorm = 3.1281, lr_0 = 6.8920e-04
Loss = 2.0906e-03, PNorm = 60.7781, GNorm = 0.7835, lr_0 = 6.6001e-04
Validation rmse = 0.906297
Epoch 7
Loss = 1.7670e-03, PNorm = 60.8110, GNorm = 1.7417, lr_0 = 6.3205e-04
Loss = 1.7717e-03, PNorm = 60.8364, GNorm = 0.5825, lr_0 = 6.0528e-04
Validation rmse = 0.840928
Epoch 8
Loss = 1.8821e-03, PNorm = 60.8601, GNorm = 1.1247, lr_0 = 5.7714e-04
Loss = 1.7292e-03, PNorm = 60.8842, GNorm = 0.6778, lr_0 = 5.5269e-04
Validation rmse = 0.888328
Epoch 9
Loss = 1.7262e-03, PNorm = 60.9053, GNorm = 0.8522, lr_0 = 5.2928e-04
Loss = 1.7493e-03, PNorm = 60.9307, GNorm = 1.0140, lr_0 = 5.0686e-04
Validation rmse = 0.895729
Epoch 10
Loss = 1.5477e-03, PNorm = 60.9521, GNorm = 1.4763, lr_0 = 4.8539e-04
Loss = 1.5080e-03, PNorm = 60.9779, GNorm = 1.1237, lr_0 = 4.6483e-04
Validation rmse = 0.827721
Epoch 11
Loss = 1.3135e-03, PNorm = 61.0042, GNorm = 0.8850, lr_0 = 4.4322e-04
Loss = 1.4809e-03, PNorm = 61.0246, GNorm = 0.5004, lr_0 = 4.2444e-04
Validation rmse = 0.823370
Epoch 12
Loss = 1.3284e-03, PNorm = 61.0448, GNorm = 0.5612, lr_0 = 4.0646e-04
Loss = 1.4724e-03, PNorm = 61.0639, GNorm = 0.8204, lr_0 = 3.8925e-04
Validation rmse = 0.857694
Epoch 13
Loss = 1.2516e-03, PNorm = 61.0788, GNorm = 1.1680, lr_0 = 3.7276e-04
Loss = 1.4127e-03, PNorm = 61.0977, GNorm = 0.7413, lr_0 = 3.5697e-04
Validation rmse = 0.845176
Epoch 14
Loss = 1.2983e-03, PNorm = 61.1167, GNorm = 1.2435, lr_0 = 3.4037e-04
Loss = 1.3508e-03, PNorm = 61.1331, GNorm = 0.6896, lr_0 = 3.2596e-04
Validation rmse = 0.796462
Epoch 15
Loss = 1.1603e-03, PNorm = 61.1446, GNorm = 0.6902, lr_0 = 3.1215e-04
Loss = 1.2164e-03, PNorm = 61.1597, GNorm = 0.5028, lr_0 = 2.9893e-04
Validation rmse = 0.848326
Epoch 16
Loss = 1.3935e-03, PNorm = 61.1781, GNorm = 0.4268, lr_0 = 2.8503e-04
Loss = 1.0556e-03, PNorm = 61.1917, GNorm = 1.0391, lr_0 = 2.7295e-04
Validation rmse = 0.804374
Epoch 17
Loss = 1.0001e-03, PNorm = 61.2057, GNorm = 0.8517, lr_0 = 2.6139e-04
Loss = 1.2610e-03, PNorm = 61.2169, GNorm = 0.9770, lr_0 = 2.5032e-04
Validation rmse = 0.803876
Epoch 18
Loss = 1.0319e-03, PNorm = 61.2309, GNorm = 0.3288, lr_0 = 2.3972e-04
Loss = 1.4116e-03, PNorm = 61.2432, GNorm = 1.5643, lr_0 = 2.2956e-04
Validation rmse = 0.792353
Epoch 19
Loss = 1.1511e-03, PNorm = 61.2528, GNorm = 0.8627, lr_0 = 2.1889e-04
Loss = 1.1807e-03, PNorm = 61.2665, GNorm = 0.6627, lr_0 = 2.0962e-04
Validation rmse = 0.777576
Epoch 20
Loss = 1.0408e-03, PNorm = 61.2775, GNorm = 1.0108, lr_0 = 2.0074e-04
Loss = 1.0073e-03, PNorm = 61.2878, GNorm = 0.3838, lr_0 = 1.9224e-04
Validation rmse = 0.762046
Epoch 21
Loss = 1.0294e-03, PNorm = 61.2948, GNorm = 1.2677, lr_0 = 1.8409e-04
Loss = 9.3627e-04, PNorm = 61.3050, GNorm = 0.6805, lr_0 = 1.7630e-04
Validation rmse = 0.772180
Epoch 22
Loss = 1.1181e-03, PNorm = 61.3139, GNorm = 0.9767, lr_0 = 1.6810e-04
Loss = 9.0214e-04, PNorm = 61.3224, GNorm = 0.5532, lr_0 = 1.6098e-04
Validation rmse = 0.769138
Epoch 23
Loss = 8.9892e-04, PNorm = 61.3302, GNorm = 0.2808, lr_0 = 1.5416e-04
Loss = 9.0091e-04, PNorm = 61.3382, GNorm = 0.5511, lr_0 = 1.4763e-04
Loss = 2.5382e-03, PNorm = 61.3390, GNorm = 1.1143, lr_0 = 1.4699e-04
Validation rmse = 0.781889
Epoch 24
Loss = 8.8702e-04, PNorm = 61.3460, GNorm = 0.5098, lr_0 = 1.4077e-04
Loss = 1.0782e-03, PNorm = 61.3527, GNorm = 0.5462, lr_0 = 1.3480e-04
Validation rmse = 0.802772
Epoch 25
Loss = 8.3794e-04, PNorm = 61.3594, GNorm = 0.4481, lr_0 = 1.2909e-04
Loss = 8.4785e-04, PNorm = 61.3659, GNorm = 0.8260, lr_0 = 1.2362e-04
Validation rmse = 0.811360
Epoch 26
Loss = 8.6822e-04, PNorm = 61.3719, GNorm = 0.2590, lr_0 = 1.1839e-04
Validation rmse = 0.809368
Epoch 27
Loss = 6.6692e-04, PNorm = 61.3786, GNorm = 0.3216, lr_0 = 1.1288e-04
Loss = 7.8048e-04, PNorm = 61.3835, GNorm = 0.8006, lr_0 = 1.0810e-04
Validation rmse = 0.811071
Epoch 28
Loss = 4.3266e-04, PNorm = 61.3887, GNorm = 0.2716, lr_0 = 1.0352e-04
Loss = 7.9784e-04, PNorm = 61.3944, GNorm = 0.7318, lr_0 = 1.0000e-04
Validation rmse = 0.827860
Epoch 29
Loss = 8.2402e-04, PNorm = 61.4001, GNorm = 0.6866, lr_0 = 1.0000e-04
Loss = 8.6809e-04, PNorm = 61.4048, GNorm = 0.9240, lr_0 = 1.0000e-04
Validation rmse = 0.802905
Model 0 best validation rmse = 0.762046 on epoch 20
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.174832
Ensemble test rmse = 1.174832
10-fold cross validation
	Seed 0 ==> test rmse = 0.876177
	Seed 1 ==> test rmse = 0.907703
	Seed 2 ==> test rmse = 0.922969
	Seed 3 ==> test rmse = 0.905568
	Seed 4 ==> test rmse = 0.954297
	Seed 5 ==> test rmse = 1.016522
	Seed 6 ==> test rmse = 0.734475
	Seed 7 ==> test rmse = 0.972294
	Seed 8 ==> test rmse = 0.983059
	Seed 9 ==> test rmse = 1.174832
Overall test rmse = 0.944790 +/- 0.106163
Elapsed time = 0:06:41
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.05_ffn_num_layers_2_hidden_size_1400/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total scaffolds = 195 | train scaffolds = 91 | val scaffolds = 66 | test scaffolds = 38
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1404, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,281,801
Moving model to cuda
Epoch 0
Loss = 1.3239e-02, PNorm = 67.3601, GNorm = 8.6922, lr_0 = 3.6053e-04
Validation rmse = 1.360579
Epoch 1
Loss = 4.5697e-03, PNorm = 67.4303, GNorm = 3.1059, lr_0 = 6.2105e-04
Loss = 4.1538e-03, PNorm = 67.5196, GNorm = 0.7204, lr_0 = 8.5789e-04
Validation rmse = 0.967459
Epoch 2
Loss = 4.5820e-03, PNorm = 67.6148, GNorm = 0.6166, lr_0 = 9.8284e-04
Loss = 2.9743e-03, PNorm = 67.6996, GNorm = 0.9404, lr_0 = 9.4120e-04
Validation rmse = 0.860397
Epoch 3
Loss = 1.1332e-03, PNorm = 67.7785, GNorm = 0.3462, lr_0 = 8.9744e-04
Loss = 1.9653e-03, PNorm = 67.8311, GNorm = 1.3280, lr_0 = 8.5943e-04
Validation rmse = 0.824413
Epoch 4
Loss = 2.8719e-03, PNorm = 67.8934, GNorm = 0.8718, lr_0 = 8.2303e-04
Loss = 1.5876e-03, PNorm = 67.9423, GNorm = 0.5207, lr_0 = 7.8816e-04
Validation rmse = 0.878743
Epoch 5
Loss = 1.2316e-03, PNorm = 67.9886, GNorm = 1.1030, lr_0 = 7.5478e-04
Loss = 1.9479e-03, PNorm = 68.0285, GNorm = 1.8841, lr_0 = 7.2281e-04
Validation rmse = 0.802019
Epoch 6
Loss = 1.6573e-03, PNorm = 68.0834, GNorm = 0.8626, lr_0 = 6.8920e-04
Loss = 1.5343e-03, PNorm = 68.1243, GNorm = 0.8215, lr_0 = 6.6001e-04
Validation rmse = 1.211728
Epoch 7
Loss = 1.7476e-03, PNorm = 68.1655, GNorm = 1.1370, lr_0 = 6.3205e-04
Loss = 1.5108e-03, PNorm = 68.2082, GNorm = 0.5450, lr_0 = 6.0528e-04
Validation rmse = 0.884436
Epoch 8
Loss = 1.2462e-03, PNorm = 68.2542, GNorm = 0.5484, lr_0 = 5.7714e-04
Loss = 1.4401e-03, PNorm = 68.2916, GNorm = 0.6122, lr_0 = 5.5269e-04
Validation rmse = 0.757654
Epoch 9
Loss = 1.1083e-03, PNorm = 68.3267, GNorm = 1.6440, lr_0 = 5.2928e-04
Loss = 1.4633e-03, PNorm = 68.3637, GNorm = 1.2578, lr_0 = 5.0686e-04
Validation rmse = 0.812045
Epoch 10
Loss = 1.2429e-03, PNorm = 68.3925, GNorm = 1.3195, lr_0 = 4.8539e-04
Loss = 1.3802e-03, PNorm = 68.4269, GNorm = 0.6340, lr_0 = 4.6483e-04
Validation rmse = 0.842343
Epoch 11
Loss = 1.2067e-03, PNorm = 68.4625, GNorm = 0.5232, lr_0 = 4.4322e-04
Loss = 1.1951e-03, PNorm = 68.4937, GNorm = 0.4445, lr_0 = 4.2444e-04
Validation rmse = 0.867743
Epoch 12
Loss = 1.2815e-03, PNorm = 68.5206, GNorm = 0.6076, lr_0 = 4.0646e-04
Loss = 1.2267e-03, PNorm = 68.5467, GNorm = 0.6281, lr_0 = 3.8925e-04
Validation rmse = 0.904056
Epoch 13
Loss = 9.4283e-04, PNorm = 68.5767, GNorm = 0.6575, lr_0 = 3.7276e-04
Loss = 9.2354e-04, PNorm = 68.6061, GNorm = 0.5426, lr_0 = 3.5697e-04
Validation rmse = 0.955373
Epoch 14
Loss = 1.0688e-03, PNorm = 68.6318, GNorm = 0.6569, lr_0 = 3.4037e-04
Loss = 1.0562e-03, PNorm = 68.6575, GNorm = 0.2987, lr_0 = 3.2596e-04
Validation rmse = 0.930907
Epoch 15
Loss = 1.3074e-03, PNorm = 68.6786, GNorm = 0.3758, lr_0 = 3.1215e-04
Loss = 8.9891e-04, PNorm = 68.7044, GNorm = 0.4289, lr_0 = 2.9893e-04
Validation rmse = 0.861733
Epoch 16
Loss = 7.6810e-04, PNorm = 68.7259, GNorm = 0.2786, lr_0 = 2.8503e-04
Loss = 9.7643e-04, PNorm = 68.7442, GNorm = 0.3600, lr_0 = 2.7295e-04
Validation rmse = 0.881553
Epoch 17
Loss = 9.5053e-04, PNorm = 68.7670, GNorm = 0.7015, lr_0 = 2.6139e-04
Loss = 9.7927e-04, PNorm = 68.7834, GNorm = 0.6041, lr_0 = 2.5032e-04
Validation rmse = 0.907189
Epoch 18
Loss = 7.9248e-04, PNorm = 68.7989, GNorm = 0.6501, lr_0 = 2.3972e-04
Loss = 7.9895e-04, PNorm = 68.8163, GNorm = 0.3755, lr_0 = 2.2956e-04
Validation rmse = 0.896862
Epoch 19
Loss = 9.6586e-04, PNorm = 68.8385, GNorm = 0.3060, lr_0 = 2.1889e-04
Loss = 9.0882e-04, PNorm = 68.8597, GNorm = 0.5121, lr_0 = 2.0962e-04
Validation rmse = 0.914171
Epoch 20
Loss = 6.7761e-04, PNorm = 68.8725, GNorm = 0.5560, lr_0 = 2.0074e-04
Loss = 7.5234e-04, PNorm = 68.8875, GNorm = 0.7449, lr_0 = 1.9224e-04
Validation rmse = 0.936434
Epoch 21
Loss = 7.4516e-04, PNorm = 68.9029, GNorm = 0.3283, lr_0 = 1.8409e-04
Loss = 6.8090e-04, PNorm = 68.9168, GNorm = 0.6054, lr_0 = 1.7630e-04
Validation rmse = 0.841402
Epoch 22
Loss = 6.8898e-04, PNorm = 68.9317, GNorm = 0.3438, lr_0 = 1.6810e-04
Loss = 7.4858e-04, PNorm = 68.9425, GNorm = 0.3131, lr_0 = 1.6098e-04
Validation rmse = 0.888485
Epoch 23
Loss = 6.8993e-04, PNorm = 68.9529, GNorm = 0.3741, lr_0 = 1.5416e-04
Loss = 8.1047e-04, PNorm = 68.9656, GNorm = 0.6756, lr_0 = 1.4763e-04
Loss = 1.0044e-03, PNorm = 68.9669, GNorm = 0.5581, lr_0 = 1.4699e-04
Validation rmse = 0.895464
Epoch 24
Loss = 6.3721e-04, PNorm = 68.9765, GNorm = 0.3431, lr_0 = 1.4077e-04
Loss = 7.4297e-04, PNorm = 68.9890, GNorm = 0.5341, lr_0 = 1.3480e-04
Validation rmse = 0.864106
Epoch 25
Loss = 6.6670e-04, PNorm = 68.9973, GNorm = 0.3701, lr_0 = 1.2909e-04
Loss = 7.1738e-04, PNorm = 69.0052, GNorm = 0.3787, lr_0 = 1.2362e-04
Validation rmse = 0.937725
Epoch 26
Loss = 6.5325e-04, PNorm = 69.0138, GNorm = 0.6787, lr_0 = 1.1839e-04
Validation rmse = 0.923166
Epoch 27
Loss = 5.1450e-04, PNorm = 69.0253, GNorm = 0.3204, lr_0 = 1.1288e-04
Loss = 9.6326e-04, PNorm = 69.0346, GNorm = 0.8110, lr_0 = 1.0810e-04
Validation rmse = 0.850585
Epoch 28
Loss = 7.5866e-04, PNorm = 69.0446, GNorm = 0.3734, lr_0 = 1.0352e-04
Loss = 5.8914e-04, PNorm = 69.0506, GNorm = 0.3040, lr_0 = 1.0000e-04
Validation rmse = 0.879853
Epoch 29
Loss = 5.0186e-04, PNorm = 69.0587, GNorm = 0.5610, lr_0 = 1.0000e-04
Loss = 6.9771e-04, PNorm = 69.0657, GNorm = 0.3267, lr_0 = 1.0000e-04
Validation rmse = 0.901144
Model 0 best validation rmse = 0.757654 on epoch 8
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.814562
Ensemble test rmse = 0.814562
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.05_ffn_num_layers_2_hidden_size_1400/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total scaffolds = 195 | train scaffolds = 76 | val scaffolds = 60 | test scaffolds = 59
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1404, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,281,801
Moving model to cuda
Epoch 0
Loss = 1.2960e-02, PNorm = 67.3635, GNorm = 1.5355, lr_0 = 3.6053e-04
Validation rmse = 1.516997
Epoch 1
Loss = 5.3396e-03, PNorm = 67.4263, GNorm = 3.4789, lr_0 = 6.2105e-04
Loss = 5.4785e-03, PNorm = 67.5048, GNorm = 3.6977, lr_0 = 8.5789e-04
Validation rmse = 1.191114
Epoch 2
Loss = 4.8758e-03, PNorm = 67.5868, GNorm = 2.8952, lr_0 = 9.8284e-04
Loss = 2.2132e-03, PNorm = 67.6590, GNorm = 0.7500, lr_0 = 9.4120e-04
Validation rmse = 1.046243
Epoch 3
Loss = 3.0067e-03, PNorm = 67.7224, GNorm = 1.3796, lr_0 = 8.9744e-04
Loss = 2.8685e-03, PNorm = 67.7823, GNorm = 1.1897, lr_0 = 8.5943e-04
Validation rmse = 0.930124
Epoch 4
Loss = 1.3469e-03, PNorm = 67.8336, GNorm = 0.5204, lr_0 = 8.2303e-04
Loss = 1.9825e-03, PNorm = 67.8813, GNorm = 1.1938, lr_0 = 7.8816e-04
Validation rmse = 0.976829
Epoch 5
Loss = 1.7281e-03, PNorm = 67.9222, GNorm = 1.0091, lr_0 = 7.5478e-04
Loss = 1.9868e-03, PNorm = 67.9649, GNorm = 1.0258, lr_0 = 7.2281e-04
Validation rmse = 0.902057
Epoch 6
Loss = 1.9613e-03, PNorm = 68.0078, GNorm = 0.6815, lr_0 = 6.8920e-04
Loss = 1.5645e-03, PNorm = 68.0535, GNorm = 0.7395, lr_0 = 6.6001e-04
Validation rmse = 0.899231
Epoch 7
Loss = 1.3084e-03, PNorm = 68.0905, GNorm = 0.7345, lr_0 = 6.3205e-04
Loss = 1.7800e-03, PNorm = 68.1322, GNorm = 0.5542, lr_0 = 6.0528e-04
Validation rmse = 0.882108
Epoch 8
Loss = 1.7373e-03, PNorm = 68.1723, GNorm = 1.1703, lr_0 = 5.7714e-04
Loss = 1.5789e-03, PNorm = 68.2142, GNorm = 1.0001, lr_0 = 5.5269e-04
Validation rmse = 0.793881
Epoch 9
Loss = 9.3404e-04, PNorm = 68.2505, GNorm = 0.4981, lr_0 = 5.2928e-04
Loss = 1.3543e-03, PNorm = 68.2822, GNorm = 1.1980, lr_0 = 5.0686e-04
Validation rmse = 0.941566
Epoch 10
Loss = 1.3914e-03, PNorm = 68.3189, GNorm = 0.3331, lr_0 = 4.8539e-04
Loss = 1.0468e-03, PNorm = 68.3529, GNorm = 1.3209, lr_0 = 4.6483e-04
Validation rmse = 0.791395
Epoch 11
Loss = 1.8975e-03, PNorm = 68.3883, GNorm = 0.5783, lr_0 = 4.4322e-04
Loss = 1.1010e-03, PNorm = 68.4166, GNorm = 0.4560, lr_0 = 4.2444e-04
Validation rmse = 0.815593
Epoch 12
Loss = 1.0021e-03, PNorm = 68.4457, GNorm = 0.3431, lr_0 = 4.0646e-04
Loss = 1.1809e-03, PNorm = 68.4722, GNorm = 0.3771, lr_0 = 3.8925e-04
Validation rmse = 0.846872
Epoch 13
Loss = 1.4211e-03, PNorm = 68.4978, GNorm = 0.6800, lr_0 = 3.7276e-04
Loss = 1.0871e-03, PNorm = 68.5252, GNorm = 0.8496, lr_0 = 3.5697e-04
Validation rmse = 0.790108
Epoch 14
Loss = 8.8510e-04, PNorm = 68.5520, GNorm = 0.6940, lr_0 = 3.4037e-04
Loss = 9.1945e-04, PNorm = 68.5744, GNorm = 0.6663, lr_0 = 3.2596e-04
Validation rmse = 0.836650
Epoch 15
Loss = 1.2500e-03, PNorm = 68.5949, GNorm = 0.3857, lr_0 = 3.1215e-04
Loss = 8.7419e-04, PNorm = 68.6167, GNorm = 0.3835, lr_0 = 2.9893e-04
Validation rmse = 0.837477
Epoch 16
Loss = 9.1937e-04, PNorm = 68.6369, GNorm = 0.3340, lr_0 = 2.8503e-04
Loss = 1.0247e-03, PNorm = 68.6603, GNorm = 0.8524, lr_0 = 2.7295e-04
Validation rmse = 0.884794
Epoch 17
Loss = 8.6116e-04, PNorm = 68.6835, GNorm = 0.4522, lr_0 = 2.6139e-04
Loss = 9.3499e-04, PNorm = 68.6999, GNorm = 0.7326, lr_0 = 2.5032e-04
Validation rmse = 0.821332
Epoch 18
Loss = 9.6264e-04, PNorm = 68.7148, GNorm = 0.6564, lr_0 = 2.3972e-04
Loss = 1.0449e-03, PNorm = 68.7324, GNorm = 0.6101, lr_0 = 2.2956e-04
Validation rmse = 0.816932
Epoch 19
Loss = 5.8092e-04, PNorm = 68.7490, GNorm = 0.5166, lr_0 = 2.1889e-04
Loss = 8.8479e-04, PNorm = 68.7638, GNorm = 0.7772, lr_0 = 2.0962e-04
Validation rmse = 0.857358
Epoch 20
Loss = 8.5709e-04, PNorm = 68.7767, GNorm = 1.0871, lr_0 = 2.0074e-04
Loss = 8.2516e-04, PNorm = 68.7890, GNorm = 0.4720, lr_0 = 1.9224e-04
Validation rmse = 0.827753
Epoch 21
Loss = 9.3184e-04, PNorm = 68.8042, GNorm = 0.8973, lr_0 = 1.8409e-04
Loss = 8.5712e-04, PNorm = 68.8172, GNorm = 0.3350, lr_0 = 1.7630e-04
Validation rmse = 0.812049
Epoch 22
Loss = 8.2150e-04, PNorm = 68.8341, GNorm = 0.5376, lr_0 = 1.6810e-04
Loss = 6.4680e-04, PNorm = 68.8465, GNorm = 0.7477, lr_0 = 1.6098e-04
Validation rmse = 0.849486
Epoch 23
Loss = 8.6572e-04, PNorm = 68.8583, GNorm = 0.3278, lr_0 = 1.5416e-04
Loss = 8.5556e-04, PNorm = 68.8690, GNorm = 0.6947, lr_0 = 1.4763e-04
Loss = 7.1162e-04, PNorm = 68.8702, GNorm = 0.3861, lr_0 = 1.4699e-04
Validation rmse = 0.829546
Epoch 24
Loss = 7.1072e-04, PNorm = 68.8829, GNorm = 0.6801, lr_0 = 1.4077e-04
Loss = 7.3430e-04, PNorm = 68.8917, GNorm = 0.5153, lr_0 = 1.3480e-04
Validation rmse = 0.854515
Epoch 25
Loss = 7.6774e-04, PNorm = 68.9009, GNorm = 0.3817, lr_0 = 1.2909e-04
Loss = 8.3063e-04, PNorm = 68.9101, GNorm = 0.4079, lr_0 = 1.2362e-04
Validation rmse = 0.825799
Epoch 26
Loss = 6.6349e-04, PNorm = 68.9209, GNorm = 0.5950, lr_0 = 1.1839e-04
Validation rmse = 0.849878
Epoch 27
Loss = 7.2795e-04, PNorm = 68.9300, GNorm = 0.9641, lr_0 = 1.1288e-04
Loss = 6.2009e-04, PNorm = 68.9395, GNorm = 0.5825, lr_0 = 1.0810e-04
Validation rmse = 0.839877
Epoch 28
Loss = 3.8922e-04, PNorm = 68.9466, GNorm = 0.3098, lr_0 = 1.0352e-04
Loss = 7.6164e-04, PNorm = 68.9540, GNorm = 0.6339, lr_0 = 1.0000e-04
Validation rmse = 0.846443
Epoch 29
Loss = 4.1166e-04, PNorm = 68.9633, GNorm = 0.2784, lr_0 = 1.0000e-04
Loss = 7.2678e-04, PNorm = 68.9734, GNorm = 0.3319, lr_0 = 1.0000e-04
Validation rmse = 0.836955
Model 0 best validation rmse = 0.790108 on epoch 13
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.886986
Ensemble test rmse = 0.886986
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.05_ffn_num_layers_2_hidden_size_1400/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total scaffolds = 195 | train scaffolds = 55 | val scaffolds = 64 | test scaffolds = 76
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1404, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,281,801
Moving model to cuda
Epoch 0
Loss = 1.3169e-02, PNorm = 67.3599, GNorm = 2.1858, lr_0 = 3.6053e-04
Validation rmse = 1.263140
Epoch 1
Loss = 5.2694e-03, PNorm = 67.4282, GNorm = 1.6274, lr_0 = 6.2105e-04
Loss = 5.4941e-03, PNorm = 67.5113, GNorm = 4.5850, lr_0 = 8.5789e-04
Validation rmse = 1.172767
Epoch 2
Loss = 3.8949e-03, PNorm = 67.5982, GNorm = 0.9840, lr_0 = 9.8284e-04
Loss = 2.7695e-03, PNorm = 67.6731, GNorm = 2.1053, lr_0 = 9.4120e-04
Validation rmse = 1.056595
Epoch 3
Loss = 2.3136e-03, PNorm = 67.7404, GNorm = 1.0631, lr_0 = 8.9744e-04
Loss = 2.4975e-03, PNorm = 67.7939, GNorm = 0.7842, lr_0 = 8.5943e-04
Validation rmse = 1.331065
Epoch 4
Loss = 2.1268e-03, PNorm = 67.8406, GNorm = 1.8132, lr_0 = 8.2303e-04
Loss = 2.6084e-03, PNorm = 67.8927, GNorm = 1.9683, lr_0 = 7.8816e-04
Validation rmse = 1.045257
Epoch 5
Loss = 1.4208e-03, PNorm = 67.9374, GNorm = 0.4063, lr_0 = 7.5478e-04
Loss = 1.8534e-03, PNorm = 67.9819, GNorm = 0.7869, lr_0 = 7.2281e-04
Validation rmse = 0.934088
Epoch 6
Loss = 1.4925e-03, PNorm = 68.0375, GNorm = 0.7518, lr_0 = 6.8920e-04
Loss = 1.9109e-03, PNorm = 68.0766, GNorm = 1.5637, lr_0 = 6.6001e-04
Validation rmse = 0.976285
Epoch 7
Loss = 2.5505e-03, PNorm = 68.1170, GNorm = 1.1501, lr_0 = 6.3205e-04
Loss = 1.7940e-03, PNorm = 68.1609, GNorm = 0.4100, lr_0 = 6.0528e-04
Validation rmse = 0.885981
Epoch 8
Loss = 2.1786e-03, PNorm = 68.2083, GNorm = 0.3515, lr_0 = 5.7714e-04
Loss = 1.4611e-03, PNorm = 68.2468, GNorm = 0.5819, lr_0 = 5.5269e-04
Validation rmse = 0.842879
Epoch 9
Loss = 1.3104e-03, PNorm = 68.2805, GNorm = 0.8544, lr_0 = 5.2928e-04
Loss = 1.4952e-03, PNorm = 68.3140, GNorm = 0.9965, lr_0 = 5.0686e-04
Validation rmse = 0.846953
Epoch 10
Loss = 1.3357e-03, PNorm = 68.3424, GNorm = 0.7133, lr_0 = 4.8539e-04
Loss = 1.4328e-03, PNorm = 68.3774, GNorm = 0.8376, lr_0 = 4.6483e-04
Validation rmse = 0.896893
Epoch 11
Loss = 1.5487e-03, PNorm = 68.4163, GNorm = 0.9200, lr_0 = 4.4322e-04
Loss = 1.1756e-03, PNorm = 68.4477, GNorm = 0.3949, lr_0 = 4.2444e-04
Validation rmse = 0.838673
Epoch 12
Loss = 1.7110e-03, PNorm = 68.4753, GNorm = 0.5680, lr_0 = 4.0646e-04
Loss = 1.3434e-03, PNorm = 68.5002, GNorm = 0.6522, lr_0 = 3.8925e-04
Validation rmse = 0.823468
Epoch 13
Loss = 1.3383e-03, PNorm = 68.5300, GNorm = 0.9192, lr_0 = 3.7276e-04
Loss = 1.1752e-03, PNorm = 68.5609, GNorm = 0.7812, lr_0 = 3.5697e-04
Validation rmse = 0.908417
Epoch 14
Loss = 1.2438e-03, PNorm = 68.5942, GNorm = 0.4148, lr_0 = 3.4037e-04
Loss = 9.8163e-04, PNorm = 68.6230, GNorm = 0.3479, lr_0 = 3.2596e-04
Validation rmse = 0.816752
Epoch 15
Loss = 9.3446e-04, PNorm = 68.6446, GNorm = 0.5899, lr_0 = 3.1215e-04
Loss = 1.1465e-03, PNorm = 68.6680, GNorm = 0.5076, lr_0 = 2.9893e-04
Validation rmse = 0.833912
Epoch 16
Loss = 9.7299e-04, PNorm = 68.6958, GNorm = 0.3986, lr_0 = 2.8503e-04
Loss = 9.7812e-04, PNorm = 68.7200, GNorm = 0.7517, lr_0 = 2.7295e-04
Validation rmse = 0.809512
Epoch 17
Loss = 1.2985e-03, PNorm = 68.7443, GNorm = 0.6701, lr_0 = 2.6139e-04
Loss = 1.0121e-03, PNorm = 68.7644, GNorm = 1.2936, lr_0 = 2.5032e-04
Validation rmse = 1.032403
Epoch 18
Loss = 9.7524e-04, PNorm = 68.7858, GNorm = 0.8956, lr_0 = 2.3972e-04
Loss = 1.2058e-03, PNorm = 68.8084, GNorm = 0.3764, lr_0 = 2.2956e-04
Validation rmse = 0.801071
Epoch 19
Loss = 1.0720e-03, PNorm = 68.8307, GNorm = 0.8494, lr_0 = 2.1889e-04
Loss = 9.4939e-04, PNorm = 68.8490, GNorm = 0.4636, lr_0 = 2.0962e-04
Validation rmse = 0.825787
Epoch 20
Loss = 1.0370e-03, PNorm = 68.8619, GNorm = 0.6779, lr_0 = 2.0074e-04
Loss = 8.8576e-04, PNorm = 68.8805, GNorm = 0.3343, lr_0 = 1.9224e-04
Validation rmse = 0.828650
Epoch 21
Loss = 8.9160e-04, PNorm = 68.8917, GNorm = 0.3851, lr_0 = 1.8409e-04
Loss = 8.4094e-04, PNorm = 68.9089, GNorm = 0.2933, lr_0 = 1.7630e-04
Validation rmse = 0.828203
Epoch 22
Loss = 9.1495e-04, PNorm = 68.9268, GNorm = 0.4959, lr_0 = 1.6810e-04
Loss = 1.0242e-03, PNorm = 68.9440, GNorm = 0.7241, lr_0 = 1.6098e-04
Validation rmse = 0.840367
Epoch 23
Loss = 7.4027e-04, PNorm = 68.9587, GNorm = 0.7422, lr_0 = 1.5416e-04
Loss = 9.2268e-04, PNorm = 68.9713, GNorm = 0.4099, lr_0 = 1.4763e-04
Loss = 1.2975e-03, PNorm = 68.9721, GNorm = 0.7845, lr_0 = 1.4699e-04
Validation rmse = 0.848598
Epoch 24
Loss = 7.2217e-04, PNorm = 68.9839, GNorm = 0.3499, lr_0 = 1.4077e-04
Loss = 7.2993e-04, PNorm = 68.9967, GNorm = 0.1834, lr_0 = 1.3480e-04
Validation rmse = 0.858506
Epoch 25
Loss = 7.7914e-04, PNorm = 69.0094, GNorm = 0.2201, lr_0 = 1.2909e-04
Loss = 7.4034e-04, PNorm = 69.0203, GNorm = 0.2740, lr_0 = 1.2362e-04
Validation rmse = 0.833217
Epoch 26
Loss = 6.9877e-04, PNorm = 69.0307, GNorm = 0.4709, lr_0 = 1.1839e-04
Validation rmse = 0.868881
Epoch 27
Loss = 6.2878e-04, PNorm = 69.0412, GNorm = 0.2630, lr_0 = 1.1288e-04
Loss = 7.0029e-04, PNorm = 69.0501, GNorm = 0.5364, lr_0 = 1.0810e-04
Validation rmse = 0.846376
Epoch 28
Loss = 1.1299e-03, PNorm = 69.0603, GNorm = 0.4466, lr_0 = 1.0352e-04
Loss = 6.4253e-04, PNorm = 69.0701, GNorm = 0.4753, lr_0 = 1.0000e-04
Validation rmse = 0.875897
Epoch 29
Loss = 4.9559e-04, PNorm = 69.0790, GNorm = 0.2032, lr_0 = 1.0000e-04
Loss = 6.4550e-04, PNorm = 69.0871, GNorm = 0.4765, lr_0 = 1.0000e-04
Validation rmse = 0.847000
Model 0 best validation rmse = 0.801071 on epoch 18
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.890531
Ensemble test rmse = 0.890531
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.05_ffn_num_layers_2_hidden_size_1400/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total scaffolds = 195 | train scaffolds = 80 | val scaffolds = 54 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1404, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,281,801
Moving model to cuda
Epoch 0
Loss = 1.3545e-02, PNorm = 67.3629, GNorm = 17.8628, lr_0 = 3.6053e-04
Validation rmse = 1.336526
Epoch 1
Loss = 4.7140e-03, PNorm = 67.4266, GNorm = 1.0280, lr_0 = 6.2105e-04
Loss = 4.0768e-03, PNorm = 67.5110, GNorm = 1.4315, lr_0 = 8.5789e-04
Validation rmse = 1.109166
Epoch 2
Loss = 2.6243e-03, PNorm = 67.5937, GNorm = 0.8002, lr_0 = 9.8284e-04
Loss = 2.5038e-03, PNorm = 67.6667, GNorm = 2.2784, lr_0 = 9.4120e-04
Validation rmse = 1.087537
Epoch 3
Loss = 2.7608e-03, PNorm = 67.7366, GNorm = 1.6733, lr_0 = 8.9744e-04
Loss = 2.3287e-03, PNorm = 67.7937, GNorm = 0.7898, lr_0 = 8.5943e-04
Validation rmse = 1.007155
Epoch 4
Loss = 2.0565e-03, PNorm = 67.8507, GNorm = 1.3960, lr_0 = 8.2303e-04
Loss = 2.3382e-03, PNorm = 67.9029, GNorm = 1.0468, lr_0 = 7.8816e-04
Validation rmse = 1.016813
Epoch 5
Loss = 1.7027e-03, PNorm = 67.9591, GNorm = 0.8451, lr_0 = 7.5478e-04
Loss = 1.7289e-03, PNorm = 68.0020, GNorm = 0.9141, lr_0 = 7.2281e-04
Validation rmse = 0.994097
Epoch 6
Loss = 1.3747e-03, PNorm = 68.0514, GNorm = 0.5584, lr_0 = 6.8920e-04
Loss = 1.7544e-03, PNorm = 68.0952, GNorm = 1.7145, lr_0 = 6.6001e-04
Validation rmse = 0.944949
Epoch 7
Loss = 1.3696e-03, PNorm = 68.1434, GNorm = 0.8123, lr_0 = 6.3205e-04
Loss = 1.3798e-03, PNorm = 68.1858, GNorm = 0.7089, lr_0 = 6.0528e-04
Validation rmse = 1.036810
Epoch 8
Loss = 1.7848e-03, PNorm = 68.2323, GNorm = 0.3097, lr_0 = 5.7714e-04
Loss = 1.3435e-03, PNorm = 68.2763, GNorm = 0.4952, lr_0 = 5.5269e-04
Validation rmse = 0.951393
Epoch 9
Loss = 1.1446e-03, PNorm = 68.3125, GNorm = 0.6193, lr_0 = 5.2928e-04
Loss = 1.2713e-03, PNorm = 68.3546, GNorm = 0.4348, lr_0 = 5.0686e-04
Validation rmse = 0.979269
Epoch 10
Loss = 1.3512e-03, PNorm = 68.3897, GNorm = 0.4656, lr_0 = 4.8539e-04
Loss = 1.0141e-03, PNorm = 68.4223, GNorm = 0.4784, lr_0 = 4.6483e-04
Validation rmse = 0.967997
Epoch 11
Loss = 7.1692e-04, PNorm = 68.4541, GNorm = 0.5906, lr_0 = 4.4322e-04
Loss = 1.1561e-03, PNorm = 68.4826, GNorm = 0.2001, lr_0 = 4.2444e-04
Validation rmse = 0.982422
Epoch 12
Loss = 8.7297e-04, PNorm = 68.5149, GNorm = 0.4748, lr_0 = 4.0646e-04
Loss = 1.0671e-03, PNorm = 68.5461, GNorm = 0.5293, lr_0 = 3.8925e-04
Validation rmse = 0.978465
Epoch 13
Loss = 1.1809e-03, PNorm = 68.5736, GNorm = 1.5242, lr_0 = 3.7276e-04
Loss = 9.6536e-04, PNorm = 68.6042, GNorm = 0.7258, lr_0 = 3.5697e-04
Validation rmse = 0.975703
Epoch 14
Loss = 1.0475e-03, PNorm = 68.6298, GNorm = 0.9492, lr_0 = 3.4037e-04
Loss = 8.4827e-04, PNorm = 68.6537, GNorm = 0.6357, lr_0 = 3.2596e-04
Validation rmse = 0.995068
Epoch 15
Loss = 8.0749e-04, PNorm = 68.6786, GNorm = 0.4959, lr_0 = 3.1215e-04
Loss = 9.6924e-04, PNorm = 68.6991, GNorm = 0.4190, lr_0 = 2.9893e-04
Validation rmse = 1.009846
Epoch 16
Loss = 8.9013e-04, PNorm = 68.7206, GNorm = 0.8564, lr_0 = 2.8503e-04
Loss = 8.7110e-04, PNorm = 68.7425, GNorm = 0.4198, lr_0 = 2.7295e-04
Validation rmse = 0.958478
Epoch 17
Loss = 7.5399e-04, PNorm = 68.7651, GNorm = 0.4077, lr_0 = 2.6139e-04
Loss = 9.2505e-04, PNorm = 68.7846, GNorm = 0.2930, lr_0 = 2.5032e-04
Validation rmse = 0.997164
Epoch 18
Loss = 9.3214e-04, PNorm = 68.8005, GNorm = 0.6442, lr_0 = 2.3972e-04
Loss = 8.5066e-04, PNorm = 68.8204, GNorm = 0.8555, lr_0 = 2.2956e-04
Validation rmse = 1.009892
Epoch 19
Loss = 7.8585e-04, PNorm = 68.8427, GNorm = 0.3480, lr_0 = 2.1889e-04
Loss = 8.8242e-04, PNorm = 68.8602, GNorm = 0.2207, lr_0 = 2.0962e-04
Validation rmse = 1.003674
Epoch 20
Loss = 7.1146e-04, PNorm = 68.8744, GNorm = 0.5705, lr_0 = 2.0074e-04
Loss = 9.0911e-04, PNorm = 68.8907, GNorm = 0.3978, lr_0 = 1.9224e-04
Validation rmse = 1.029205
Epoch 21
Loss = 6.5902e-04, PNorm = 68.9084, GNorm = 0.3216, lr_0 = 1.8409e-04
Loss = 7.5053e-04, PNorm = 68.9207, GNorm = 0.9075, lr_0 = 1.7630e-04
Validation rmse = 0.985216
Epoch 22
Loss = 8.4104e-04, PNorm = 68.9394, GNorm = 0.5427, lr_0 = 1.6810e-04
Loss = 5.9837e-04, PNorm = 68.9529, GNorm = 0.3119, lr_0 = 1.6098e-04
Validation rmse = 0.968824
Epoch 23
Loss = 5.0768e-04, PNorm = 68.9630, GNorm = 0.7284, lr_0 = 1.5416e-04
Loss = 7.0201e-04, PNorm = 68.9746, GNorm = 0.2958, lr_0 = 1.4763e-04
Loss = 2.1114e-03, PNorm = 68.9758, GNorm = 0.4791, lr_0 = 1.4699e-04
Validation rmse = 0.994941
Epoch 24
Loss = 6.6161e-04, PNorm = 68.9887, GNorm = 0.5599, lr_0 = 1.4077e-04
Loss = 7.0052e-04, PNorm = 69.0014, GNorm = 0.8671, lr_0 = 1.3480e-04
Validation rmse = 0.970801
Epoch 25
Loss = 7.6950e-04, PNorm = 69.0119, GNorm = 0.1697, lr_0 = 1.2909e-04
Loss = 6.0720e-04, PNorm = 69.0203, GNorm = 0.7706, lr_0 = 1.2362e-04
Validation rmse = 0.969786
Epoch 26
Loss = 6.7170e-04, PNorm = 69.0299, GNorm = 0.5699, lr_0 = 1.1839e-04
Validation rmse = 0.999828
Epoch 27
Loss = 1.5218e-03, PNorm = 69.0390, GNorm = 0.3494, lr_0 = 1.1288e-04
Loss = 5.3355e-04, PNorm = 69.0491, GNorm = 0.3848, lr_0 = 1.0810e-04
Validation rmse = 0.984669
Epoch 28
Loss = 3.0918e-04, PNorm = 69.0562, GNorm = 0.1714, lr_0 = 1.0352e-04
Loss = 5.9060e-04, PNorm = 69.0654, GNorm = 0.4270, lr_0 = 1.0000e-04
Validation rmse = 0.974562
Epoch 29
Loss = 5.9631e-04, PNorm = 69.0748, GNorm = 0.3159, lr_0 = 1.0000e-04
Loss = 5.9737e-04, PNorm = 69.0838, GNorm = 0.3241, lr_0 = 1.0000e-04
Validation rmse = 0.986923
Model 0 best validation rmse = 0.944949 on epoch 6
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.790166
Ensemble test rmse = 0.790166
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.05_ffn_num_layers_2_hidden_size_1400/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 49 | test scaffolds = 62
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1404, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,281,801
Moving model to cuda
Epoch 0
Loss = 1.4489e-02, PNorm = 67.3589, GNorm = 1.9239, lr_0 = 3.6053e-04
Validation rmse = 1.357136
Epoch 1
Loss = 4.7143e-03, PNorm = 67.4323, GNorm = 2.6772, lr_0 = 6.2105e-04
Loss = 3.2812e-03, PNorm = 67.5158, GNorm = 1.1598, lr_0 = 8.5789e-04
Validation rmse = 1.170849
Epoch 2
Loss = 2.4687e-03, PNorm = 67.5954, GNorm = 1.9382, lr_0 = 9.8284e-04
Loss = 2.7808e-03, PNorm = 67.6643, GNorm = 0.4121, lr_0 = 9.4120e-04
Validation rmse = 1.072548
Epoch 3
Loss = 2.2757e-03, PNorm = 67.7345, GNorm = 1.6176, lr_0 = 8.9744e-04
Loss = 2.7101e-03, PNorm = 67.7907, GNorm = 0.9197, lr_0 = 8.5943e-04
Validation rmse = 0.934817
Epoch 4
Loss = 3.1697e-03, PNorm = 67.8507, GNorm = 0.6512, lr_0 = 8.2303e-04
Loss = 2.0486e-03, PNorm = 67.9048, GNorm = 0.7336, lr_0 = 7.8816e-04
Validation rmse = 0.820474
Epoch 5
Loss = 1.3172e-03, PNorm = 67.9525, GNorm = 0.4611, lr_0 = 7.5478e-04
Loss = 1.7743e-03, PNorm = 68.0008, GNorm = 0.8969, lr_0 = 7.2281e-04
Validation rmse = 0.843730
Epoch 6
Loss = 1.6729e-03, PNorm = 68.0523, GNorm = 0.4748, lr_0 = 6.8920e-04
Loss = 1.8761e-03, PNorm = 68.0957, GNorm = 0.5667, lr_0 = 6.6001e-04
Validation rmse = 0.873737
Epoch 7
Loss = 1.3655e-03, PNorm = 68.1390, GNorm = 0.7543, lr_0 = 6.3205e-04
Loss = 1.7870e-03, PNorm = 68.1859, GNorm = 0.9505, lr_0 = 6.0528e-04
Validation rmse = 0.801252
Epoch 8
Loss = 1.5032e-03, PNorm = 68.2279, GNorm = 0.5675, lr_0 = 5.7714e-04
Loss = 1.3563e-03, PNorm = 68.2633, GNorm = 0.5818, lr_0 = 5.5269e-04
Validation rmse = 0.803705
Epoch 9
Loss = 1.0894e-03, PNorm = 68.2996, GNorm = 0.8097, lr_0 = 5.2928e-04
Loss = 1.3695e-03, PNorm = 68.3391, GNorm = 0.8121, lr_0 = 5.0686e-04
Validation rmse = 0.733829
Epoch 10
Loss = 1.2375e-03, PNorm = 68.3739, GNorm = 0.9624, lr_0 = 4.8539e-04
Loss = 1.4313e-03, PNorm = 68.4025, GNorm = 0.6464, lr_0 = 4.6483e-04
Validation rmse = 0.802402
Epoch 11
Loss = 1.6280e-03, PNorm = 68.4350, GNorm = 0.3001, lr_0 = 4.4322e-04
Loss = 1.0035e-03, PNorm = 68.4613, GNorm = 0.2486, lr_0 = 4.2444e-04
Validation rmse = 0.744265
Epoch 12
Loss = 6.8351e-04, PNorm = 68.4886, GNorm = 0.4948, lr_0 = 4.0646e-04
Loss = 1.2872e-03, PNorm = 68.5156, GNorm = 0.8043, lr_0 = 3.8925e-04
Validation rmse = 0.746001
Epoch 13
Loss = 8.1454e-04, PNorm = 68.5429, GNorm = 0.3429, lr_0 = 3.7276e-04
Loss = 1.2703e-03, PNorm = 68.5710, GNorm = 0.6568, lr_0 = 3.5697e-04
Validation rmse = 0.774799
Epoch 14
Loss = 9.6247e-04, PNorm = 68.5953, GNorm = 0.4595, lr_0 = 3.4037e-04
Loss = 1.0145e-03, PNorm = 68.6217, GNorm = 0.5548, lr_0 = 3.2596e-04
Validation rmse = 0.759646
Epoch 15
Loss = 1.0946e-03, PNorm = 68.6455, GNorm = 0.4318, lr_0 = 3.1215e-04
Loss = 1.2876e-03, PNorm = 68.6712, GNorm = 0.3078, lr_0 = 2.9893e-04
Validation rmse = 0.732690
Epoch 16
Loss = 8.8784e-04, PNorm = 68.6956, GNorm = 0.7305, lr_0 = 2.8503e-04
Loss = 1.2300e-03, PNorm = 68.7179, GNorm = 0.2991, lr_0 = 2.7295e-04
Validation rmse = 0.710549
Epoch 17
Loss = 9.0086e-04, PNorm = 68.7359, GNorm = 0.2679, lr_0 = 2.6139e-04
Loss = 1.1488e-03, PNorm = 68.7570, GNorm = 0.1782, lr_0 = 2.5032e-04
Validation rmse = 0.716634
Epoch 18
Loss = 9.2867e-04, PNorm = 68.7786, GNorm = 0.4107, lr_0 = 2.3972e-04
Loss = 8.1349e-04, PNorm = 68.7985, GNorm = 0.3171, lr_0 = 2.2956e-04
Validation rmse = 0.711260
Epoch 19
Loss = 8.0565e-04, PNorm = 68.8164, GNorm = 0.2766, lr_0 = 2.1889e-04
Loss = 9.6077e-04, PNorm = 68.8331, GNorm = 0.2200, lr_0 = 2.0962e-04
Validation rmse = 0.740021
Epoch 20
Loss = 1.0132e-03, PNorm = 68.8484, GNorm = 0.2926, lr_0 = 2.0074e-04
Loss = 8.6520e-04, PNorm = 68.8657, GNorm = 1.2282, lr_0 = 1.9224e-04
Validation rmse = 0.876344
Epoch 21
Loss = 9.6052e-04, PNorm = 68.8832, GNorm = 0.4008, lr_0 = 1.8409e-04
Loss = 9.3646e-04, PNorm = 68.8979, GNorm = 1.1787, lr_0 = 1.7630e-04
Validation rmse = 0.728401
Epoch 22
Loss = 9.1982e-04, PNorm = 68.9167, GNorm = 0.5489, lr_0 = 1.6810e-04
Loss = 9.3357e-04, PNorm = 68.9309, GNorm = 0.3829, lr_0 = 1.6098e-04
Validation rmse = 0.758595
Epoch 23
Loss = 7.9297e-04, PNorm = 68.9441, GNorm = 0.2992, lr_0 = 1.5416e-04
Loss = 8.8306e-04, PNorm = 68.9580, GNorm = 0.2857, lr_0 = 1.4763e-04
Loss = 1.1789e-03, PNorm = 68.9594, GNorm = 0.4232, lr_0 = 1.4699e-04
Validation rmse = 0.721678
Epoch 24
Loss = 7.4814e-04, PNorm = 68.9710, GNorm = 0.4033, lr_0 = 1.4077e-04
Loss = 8.4089e-04, PNorm = 68.9831, GNorm = 0.6336, lr_0 = 1.3480e-04
Validation rmse = 0.823344
Epoch 25
Loss = 6.3649e-04, PNorm = 68.9940, GNorm = 0.5124, lr_0 = 1.2909e-04
Loss = 8.2203e-04, PNorm = 69.0049, GNorm = 0.8479, lr_0 = 1.2362e-04
Validation rmse = 0.723085
Epoch 26
Loss = 7.2338e-04, PNorm = 69.0168, GNorm = 0.2890, lr_0 = 1.1839e-04
Validation rmse = 0.721741
Epoch 27
Loss = 5.5408e-04, PNorm = 69.0288, GNorm = 0.4472, lr_0 = 1.1288e-04
Loss = 8.3742e-04, PNorm = 69.0373, GNorm = 0.6086, lr_0 = 1.0810e-04
Validation rmse = 0.696444
Epoch 28
Loss = 3.4014e-04, PNorm = 69.0486, GNorm = 0.4914, lr_0 = 1.0352e-04
Loss = 7.3207e-04, PNorm = 69.0561, GNorm = 0.2247, lr_0 = 1.0000e-04
Validation rmse = 0.758612
Epoch 29
Loss = 5.2124e-04, PNorm = 69.0645, GNorm = 0.3606, lr_0 = 1.0000e-04
Loss = 6.5448e-04, PNorm = 69.0734, GNorm = 0.2985, lr_0 = 1.0000e-04
Validation rmse = 0.709177
Model 0 best validation rmse = 0.696444 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.873721
Ensemble test rmse = 0.873721
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.05_ffn_num_layers_2_hidden_size_1400/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total scaffolds = 195 | train scaffolds = 94 | val scaffolds = 55 | test scaffolds = 46
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1404, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,281,801
Moving model to cuda
Epoch 0
Loss = 1.3883e-02, PNorm = 67.3606, GNorm = 12.6875, lr_0 = 3.6053e-04
Validation rmse = 1.514107
Epoch 1
Loss = 3.8725e-03, PNorm = 67.4316, GNorm = 1.0953, lr_0 = 6.2105e-04
Loss = 4.1490e-03, PNorm = 67.5178, GNorm = 2.5264, lr_0 = 8.5789e-04
Validation rmse = 1.489590
Epoch 2
Loss = 4.1570e-03, PNorm = 67.6148, GNorm = 1.0444, lr_0 = 9.8284e-04
Loss = 3.1793e-03, PNorm = 67.7056, GNorm = 0.5720, lr_0 = 9.4120e-04
Validation rmse = 1.122601
Epoch 3
Loss = 2.5488e-03, PNorm = 67.7877, GNorm = 1.3391, lr_0 = 8.9744e-04
Loss = 2.2320e-03, PNorm = 67.8551, GNorm = 0.6315, lr_0 = 8.5943e-04
Validation rmse = 1.113090
Epoch 4
Loss = 1.2819e-03, PNorm = 67.9080, GNorm = 0.9824, lr_0 = 8.2303e-04
Loss = 1.9251e-03, PNorm = 67.9659, GNorm = 0.7624, lr_0 = 7.8816e-04
Validation rmse = 1.060817
Epoch 5
Loss = 1.6118e-03, PNorm = 68.0029, GNorm = 0.5370, lr_0 = 7.5478e-04
Loss = 2.0917e-03, PNorm = 68.0441, GNorm = 0.9629, lr_0 = 7.2281e-04
Validation rmse = 0.961014
Epoch 6
Loss = 2.1612e-03, PNorm = 68.0977, GNorm = 0.5609, lr_0 = 6.8920e-04
Loss = 1.8789e-03, PNorm = 68.1487, GNorm = 0.7175, lr_0 = 6.6001e-04
Validation rmse = 1.053700
Epoch 7
Loss = 1.9824e-03, PNorm = 68.1904, GNorm = 0.5267, lr_0 = 6.3205e-04
Loss = 1.8368e-03, PNorm = 68.2402, GNorm = 0.4998, lr_0 = 6.0528e-04
Validation rmse = 0.960366
Epoch 8
Loss = 1.1826e-03, PNorm = 68.2889, GNorm = 0.3485, lr_0 = 5.7714e-04
Loss = 1.5579e-03, PNorm = 68.3323, GNorm = 0.4595, lr_0 = 5.5269e-04
Validation rmse = 0.974652
Epoch 9
Loss = 1.8245e-03, PNorm = 68.3653, GNorm = 0.4359, lr_0 = 5.2928e-04
Loss = 1.4378e-03, PNorm = 68.4065, GNorm = 0.3880, lr_0 = 5.0686e-04
Validation rmse = 0.970397
Epoch 10
Loss = 1.2576e-03, PNorm = 68.4371, GNorm = 1.1264, lr_0 = 4.8539e-04
Loss = 1.4000e-03, PNorm = 68.4687, GNorm = 0.4206, lr_0 = 4.6483e-04
Validation rmse = 0.923451
Epoch 11
Loss = 1.0252e-03, PNorm = 68.5072, GNorm = 0.3376, lr_0 = 4.4322e-04
Loss = 1.3280e-03, PNorm = 68.5389, GNorm = 0.3226, lr_0 = 4.2444e-04
Validation rmse = 0.880828
Epoch 12
Loss = 1.2776e-03, PNorm = 68.5689, GNorm = 0.8725, lr_0 = 4.0646e-04
Loss = 1.1694e-03, PNorm = 68.6005, GNorm = 0.7823, lr_0 = 3.8925e-04
Validation rmse = 0.957870
Epoch 13
Loss = 9.4709e-04, PNorm = 68.6265, GNorm = 0.4253, lr_0 = 3.7276e-04
Loss = 1.1659e-03, PNorm = 68.6483, GNorm = 0.5092, lr_0 = 3.5697e-04
Validation rmse = 1.076039
Epoch 14
Loss = 1.2548e-03, PNorm = 68.6792, GNorm = 0.8471, lr_0 = 3.4037e-04
Loss = 8.8066e-04, PNorm = 68.7015, GNorm = 0.4154, lr_0 = 3.2596e-04
Validation rmse = 0.950674
Epoch 15
Loss = 1.0783e-03, PNorm = 68.7279, GNorm = 0.6274, lr_0 = 3.1215e-04
Loss = 1.0063e-03, PNorm = 68.7532, GNorm = 0.3967, lr_0 = 2.9893e-04
Validation rmse = 0.913348
Epoch 16
Loss = 9.8120e-04, PNorm = 68.7753, GNorm = 0.2891, lr_0 = 2.8503e-04
Loss = 9.4042e-04, PNorm = 68.7962, GNorm = 0.3782, lr_0 = 2.7295e-04
Validation rmse = 0.942507
Epoch 17
Loss = 9.1520e-04, PNorm = 68.8199, GNorm = 0.4979, lr_0 = 2.6139e-04
Loss = 1.0568e-03, PNorm = 68.8400, GNorm = 0.4453, lr_0 = 2.5032e-04
Validation rmse = 0.944365
Epoch 18
Loss = 7.4391e-04, PNorm = 68.8584, GNorm = 0.2602, lr_0 = 2.3972e-04
Loss = 9.4130e-04, PNorm = 68.8795, GNorm = 0.5774, lr_0 = 2.2956e-04
Validation rmse = 0.959803
Epoch 19
Loss = 7.4499e-04, PNorm = 68.8980, GNorm = 0.3790, lr_0 = 2.1889e-04
Loss = 1.0150e-03, PNorm = 68.9138, GNorm = 0.2905, lr_0 = 2.0962e-04
Validation rmse = 0.927379
Epoch 20
Loss = 9.8751e-04, PNorm = 68.9287, GNorm = 0.2555, lr_0 = 2.0074e-04
Loss = 8.1969e-04, PNorm = 68.9455, GNorm = 0.5618, lr_0 = 1.9224e-04
Validation rmse = 0.908949
Epoch 21
Loss = 7.9400e-04, PNorm = 68.9576, GNorm = 0.6452, lr_0 = 1.8409e-04
Loss = 9.3175e-04, PNorm = 68.9733, GNorm = 0.5512, lr_0 = 1.7630e-04
Validation rmse = 0.935782
Epoch 22
Loss = 7.6309e-04, PNorm = 68.9887, GNorm = 0.4268, lr_0 = 1.6810e-04
Loss = 7.6877e-04, PNorm = 69.0026, GNorm = 0.5843, lr_0 = 1.6098e-04
Validation rmse = 0.908933
Epoch 23
Loss = 7.7169e-04, PNorm = 69.0162, GNorm = 0.5758, lr_0 = 1.5416e-04
Loss = 8.0305e-04, PNorm = 69.0281, GNorm = 0.6378, lr_0 = 1.4763e-04
Loss = 8.8209e-04, PNorm = 69.0293, GNorm = 0.3293, lr_0 = 1.4699e-04
Validation rmse = 0.962691
Epoch 24
Loss = 7.2537e-04, PNorm = 69.0416, GNorm = 0.2870, lr_0 = 1.4077e-04
Loss = 7.9585e-04, PNorm = 69.0520, GNorm = 0.3355, lr_0 = 1.3480e-04
Validation rmse = 0.950007
Epoch 25
Loss = 6.5512e-04, PNorm = 69.0634, GNorm = 0.2533, lr_0 = 1.2909e-04
Loss = 7.7354e-04, PNorm = 69.0728, GNorm = 0.9548, lr_0 = 1.2362e-04
Validation rmse = 0.924152
Epoch 26
Loss = 6.7280e-04, PNorm = 69.0823, GNorm = 0.7893, lr_0 = 1.1839e-04
Validation rmse = 0.923527
Epoch 27
Loss = 7.4870e-04, PNorm = 69.0940, GNorm = 0.3736, lr_0 = 1.1288e-04
Loss = 7.7126e-04, PNorm = 69.1033, GNorm = 0.3512, lr_0 = 1.0810e-04
Validation rmse = 0.916735
Epoch 28
Loss = 1.4908e-03, PNorm = 69.1127, GNorm = 0.5043, lr_0 = 1.0352e-04
Loss = 6.5964e-04, PNorm = 69.1223, GNorm = 0.4665, lr_0 = 1.0000e-04
Validation rmse = 0.917623
Epoch 29
Loss = 5.7387e-04, PNorm = 69.1308, GNorm = 0.3593, lr_0 = 1.0000e-04
Loss = 6.5623e-04, PNorm = 69.1396, GNorm = 0.4002, lr_0 = 1.0000e-04
Validation rmse = 0.941151
Model 0 best validation rmse = 0.880828 on epoch 11
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.941129
Ensemble test rmse = 0.941129
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.05_ffn_num_layers_2_hidden_size_1400/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total scaffolds = 195 | train scaffolds = 64 | val scaffolds = 68 | test scaffolds = 63
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1404, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,281,801
Moving model to cuda
Epoch 0
Loss = 1.4447e-02, PNorm = 67.3605, GNorm = 1.0980, lr_0 = 3.6053e-04
Validation rmse = 1.326104
Epoch 1
Loss = 3.8180e-03, PNorm = 67.4333, GNorm = 2.0504, lr_0 = 6.2105e-04
Loss = 4.1291e-03, PNorm = 67.5241, GNorm = 1.6958, lr_0 = 8.5789e-04
Validation rmse = 1.253064
Epoch 2
Loss = 2.0775e-03, PNorm = 67.6177, GNorm = 0.4524, lr_0 = 9.8284e-04
Loss = 2.5868e-03, PNorm = 67.7029, GNorm = 0.9831, lr_0 = 9.4120e-04
Validation rmse = 1.285121
Epoch 3
Loss = 2.2671e-03, PNorm = 67.7769, GNorm = 1.1424, lr_0 = 8.9744e-04
Loss = 2.1599e-03, PNorm = 67.8368, GNorm = 0.4476, lr_0 = 8.5943e-04
Validation rmse = 1.118522
Epoch 4
Loss = 1.8767e-03, PNorm = 67.8991, GNorm = 0.5403, lr_0 = 8.2303e-04
Loss = 2.3379e-03, PNorm = 67.9571, GNorm = 0.7840, lr_0 = 7.8816e-04
Validation rmse = 1.097289
Epoch 5
Loss = 1.5607e-03, PNorm = 68.0000, GNorm = 0.5983, lr_0 = 7.5478e-04
Loss = 1.6876e-03, PNorm = 68.0438, GNorm = 0.3797, lr_0 = 7.2281e-04
Validation rmse = 1.165796
Epoch 6
Loss = 1.7322e-03, PNorm = 68.0916, GNorm = 0.3411, lr_0 = 6.8920e-04
Loss = 1.5098e-03, PNorm = 68.1412, GNorm = 0.4525, lr_0 = 6.6001e-04
Validation rmse = 0.995056
Epoch 7
Loss = 1.8727e-03, PNorm = 68.1800, GNorm = 0.4670, lr_0 = 6.3205e-04
Loss = 1.5168e-03, PNorm = 68.2266, GNorm = 0.9176, lr_0 = 6.0528e-04
Validation rmse = 0.995185
Epoch 8
Loss = 1.1644e-03, PNorm = 68.2739, GNorm = 0.4129, lr_0 = 5.7714e-04
Loss = 1.4104e-03, PNorm = 68.3145, GNorm = 1.0866, lr_0 = 5.5269e-04
Validation rmse = 0.944343
Epoch 9
Loss = 1.0825e-03, PNorm = 68.3527, GNorm = 0.2013, lr_0 = 5.2928e-04
Loss = 1.1963e-03, PNorm = 68.3893, GNorm = 0.6172, lr_0 = 5.0686e-04
Validation rmse = 0.939303
Epoch 10
Loss = 1.2826e-03, PNorm = 68.4231, GNorm = 0.3206, lr_0 = 4.8539e-04
Loss = 9.9938e-04, PNorm = 68.4582, GNorm = 0.5807, lr_0 = 4.6483e-04
Validation rmse = 0.994686
Epoch 11
Loss = 1.1200e-03, PNorm = 68.4890, GNorm = 0.2981, lr_0 = 4.4322e-04
Loss = 1.2177e-03, PNorm = 68.5227, GNorm = 0.5587, lr_0 = 4.2444e-04
Validation rmse = 0.912395
Epoch 12
Loss = 7.6856e-04, PNorm = 68.5558, GNorm = 0.3744, lr_0 = 4.0646e-04
Loss = 1.1379e-03, PNorm = 68.5849, GNorm = 0.7759, lr_0 = 3.8925e-04
Validation rmse = 0.970868
Epoch 13
Loss = 8.5351e-04, PNorm = 68.6109, GNorm = 0.4194, lr_0 = 3.7276e-04
Loss = 9.5199e-04, PNorm = 68.6382, GNorm = 0.3517, lr_0 = 3.5697e-04
Validation rmse = 1.101635
Epoch 14
Loss = 9.3092e-04, PNorm = 68.6641, GNorm = 0.6084, lr_0 = 3.4037e-04
Loss = 1.1496e-03, PNorm = 68.6915, GNorm = 0.6060, lr_0 = 3.2596e-04
Validation rmse = 1.002365
Epoch 15
Loss = 9.7357e-04, PNorm = 68.7153, GNorm = 0.3007, lr_0 = 3.1215e-04
Loss = 8.8033e-04, PNorm = 68.7376, GNorm = 0.4099, lr_0 = 2.9893e-04
Validation rmse = 1.082788
Epoch 16
Loss = 8.1631e-04, PNorm = 68.7649, GNorm = 0.6708, lr_0 = 2.8503e-04
Loss = 8.1854e-04, PNorm = 68.7876, GNorm = 1.5482, lr_0 = 2.7295e-04
Validation rmse = 1.136559
Epoch 17
Loss = 9.9709e-04, PNorm = 68.8104, GNorm = 0.3252, lr_0 = 2.6139e-04
Loss = 9.1818e-04, PNorm = 68.8275, GNorm = 0.7012, lr_0 = 2.5032e-04
Validation rmse = 1.004124
Epoch 18
Loss = 9.8063e-04, PNorm = 68.8483, GNorm = 0.3595, lr_0 = 2.3972e-04
Loss = 9.1740e-04, PNorm = 68.8685, GNorm = 0.4428, lr_0 = 2.2956e-04
Validation rmse = 1.019586
Epoch 19
Loss = 6.8397e-04, PNorm = 68.8886, GNorm = 0.1823, lr_0 = 2.1889e-04
Loss = 7.1274e-04, PNorm = 68.9048, GNorm = 0.4439, lr_0 = 2.0962e-04
Validation rmse = 1.019514
Epoch 20
Loss = 7.3684e-04, PNorm = 68.9228, GNorm = 0.5686, lr_0 = 2.0074e-04
Loss = 8.2091e-04, PNorm = 68.9368, GNorm = 0.4320, lr_0 = 1.9224e-04
Validation rmse = 1.021933
Epoch 21
Loss = 7.4224e-04, PNorm = 68.9525, GNorm = 0.4991, lr_0 = 1.8409e-04
Loss = 7.4684e-04, PNorm = 68.9634, GNorm = 0.4017, lr_0 = 1.7630e-04
Validation rmse = 1.001505
Epoch 22
Loss = 6.6607e-04, PNorm = 68.9781, GNorm = 0.3344, lr_0 = 1.6810e-04
Loss = 7.0775e-04, PNorm = 68.9910, GNorm = 0.2367, lr_0 = 1.6098e-04
Validation rmse = 0.976436
Epoch 23
Loss = 6.0625e-04, PNorm = 69.0030, GNorm = 0.2985, lr_0 = 1.5416e-04
Loss = 6.7410e-04, PNorm = 69.0128, GNorm = 0.2182, lr_0 = 1.4763e-04
Loss = 1.1027e-03, PNorm = 69.0139, GNorm = 0.3005, lr_0 = 1.4699e-04
Validation rmse = 1.010118
Epoch 24
Loss = 6.8562e-04, PNorm = 69.0257, GNorm = 0.3073, lr_0 = 1.4077e-04
Loss = 5.3718e-04, PNorm = 69.0367, GNorm = 0.3366, lr_0 = 1.3480e-04
Validation rmse = 1.003880
Epoch 25
Loss = 6.3408e-04, PNorm = 69.0446, GNorm = 0.5987, lr_0 = 1.2909e-04
Loss = 7.1762e-04, PNorm = 69.0540, GNorm = 0.6047, lr_0 = 1.2362e-04
Validation rmse = 0.989984
Epoch 26
Loss = 5.5070e-04, PNorm = 69.0650, GNorm = 0.2861, lr_0 = 1.1839e-04
Validation rmse = 1.007517
Epoch 27
Loss = 8.6234e-04, PNorm = 69.0749, GNorm = 0.7932, lr_0 = 1.1288e-04
Loss = 5.3585e-04, PNorm = 69.0842, GNorm = 0.3418, lr_0 = 1.0810e-04
Validation rmse = 1.002009
Epoch 28
Loss = 6.7927e-04, PNorm = 69.0930, GNorm = 0.5911, lr_0 = 1.0352e-04
Loss = 6.0867e-04, PNorm = 69.0990, GNorm = 0.3433, lr_0 = 1.0000e-04
Validation rmse = 1.032061
Epoch 29
Loss = 6.5847e-04, PNorm = 69.1079, GNorm = 0.6796, lr_0 = 1.0000e-04
Loss = 5.9833e-04, PNorm = 69.1156, GNorm = 0.4582, lr_0 = 1.0000e-04
Validation rmse = 1.062188
Model 0 best validation rmse = 0.912395 on epoch 11
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.765664
Ensemble test rmse = 0.765664
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.05_ffn_num_layers_2_hidden_size_1400/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total scaffolds = 195 | train scaffolds = 69 | val scaffolds = 65 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1404, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,281,801
Moving model to cuda
Epoch 0
Loss = 1.2928e-02, PNorm = 67.3619, GNorm = 2.1464, lr_0 = 3.6053e-04
Validation rmse = 1.553273
Epoch 1
Loss = 4.2452e-03, PNorm = 67.4265, GNorm = 4.0651, lr_0 = 6.2105e-04
Loss = 4.5570e-03, PNorm = 67.5059, GNorm = 0.5953, lr_0 = 8.5789e-04
Validation rmse = 1.526429
Epoch 2
Loss = 2.8490e-03, PNorm = 67.5980, GNorm = 1.2589, lr_0 = 9.8284e-04
Loss = 2.6398e-03, PNorm = 67.6805, GNorm = 1.8695, lr_0 = 9.4120e-04
Validation rmse = 1.316528
Epoch 3
Loss = 1.8197e-03, PNorm = 67.7570, GNorm = 0.9990, lr_0 = 8.9744e-04
Loss = 2.0620e-03, PNorm = 67.8135, GNorm = 1.6446, lr_0 = 8.5943e-04
Validation rmse = 1.300012
Epoch 4
Loss = 1.9148e-03, PNorm = 67.8670, GNorm = 0.8906, lr_0 = 8.2303e-04
Loss = 1.7570e-03, PNorm = 67.9142, GNorm = 1.2919, lr_0 = 7.8816e-04
Validation rmse = 1.345035
Epoch 5
Loss = 1.5248e-03, PNorm = 67.9683, GNorm = 0.5788, lr_0 = 7.5478e-04
Loss = 1.6102e-03, PNorm = 68.0230, GNorm = 0.6040, lr_0 = 7.2281e-04
Validation rmse = 1.197015
Epoch 6
Loss = 2.1396e-03, PNorm = 68.0807, GNorm = 2.0451, lr_0 = 6.8920e-04
Loss = 1.9733e-03, PNorm = 68.1364, GNorm = 1.3299, lr_0 = 6.6001e-04
Validation rmse = 1.289077
Epoch 7
Loss = 1.9276e-03, PNorm = 68.1884, GNorm = 0.6103, lr_0 = 6.3205e-04
Loss = 1.7097e-03, PNorm = 68.2347, GNorm = 0.8984, lr_0 = 6.0528e-04
Validation rmse = 1.252089
Epoch 8
Loss = 1.5319e-03, PNorm = 68.2805, GNorm = 0.7863, lr_0 = 5.7714e-04
Loss = 1.4843e-03, PNorm = 68.3152, GNorm = 0.3708, lr_0 = 5.5269e-04
Validation rmse = 1.430424
Epoch 9
Loss = 1.6235e-03, PNorm = 68.3512, GNorm = 0.7922, lr_0 = 5.2928e-04
Loss = 1.5324e-03, PNorm = 68.3854, GNorm = 1.2115, lr_0 = 5.0686e-04
Validation rmse = 1.450549
Epoch 10
Loss = 1.3283e-03, PNorm = 68.4133, GNorm = 0.9114, lr_0 = 4.8539e-04
Loss = 1.1584e-03, PNorm = 68.4466, GNorm = 0.6605, lr_0 = 4.6483e-04
Validation rmse = 1.246578
Epoch 11
Loss = 1.3491e-03, PNorm = 68.4786, GNorm = 0.9158, lr_0 = 4.4322e-04
Loss = 1.3283e-03, PNorm = 68.5111, GNorm = 0.5296, lr_0 = 4.2444e-04
Validation rmse = 1.279642
Epoch 12
Loss = 1.0132e-03, PNorm = 68.5392, GNorm = 0.2979, lr_0 = 4.0646e-04
Loss = 1.0394e-03, PNorm = 68.5618, GNorm = 0.2423, lr_0 = 3.8925e-04
Validation rmse = 1.226785
Epoch 13
Loss = 1.1918e-03, PNorm = 68.5882, GNorm = 0.5050, lr_0 = 3.7276e-04
Loss = 9.8652e-04, PNorm = 68.6141, GNorm = 0.4353, lr_0 = 3.5697e-04
Validation rmse = 1.322105
Epoch 14
Loss = 8.3043e-04, PNorm = 68.6388, GNorm = 0.3824, lr_0 = 3.4037e-04
Loss = 1.0845e-03, PNorm = 68.6600, GNorm = 0.4761, lr_0 = 3.2596e-04
Validation rmse = 1.296235
Epoch 15
Loss = 1.0241e-03, PNorm = 68.6831, GNorm = 0.4330, lr_0 = 3.1215e-04
Loss = 8.3375e-04, PNorm = 68.7039, GNorm = 0.1980, lr_0 = 2.9893e-04
Validation rmse = 1.385222
Epoch 16
Loss = 8.2464e-04, PNorm = 68.7290, GNorm = 0.4178, lr_0 = 2.8503e-04
Loss = 9.3057e-04, PNorm = 68.7464, GNorm = 0.2561, lr_0 = 2.7295e-04
Validation rmse = 1.362920
Epoch 17
Loss = 7.6268e-04, PNorm = 68.7639, GNorm = 0.4415, lr_0 = 2.6139e-04
Loss = 8.4339e-04, PNorm = 68.7844, GNorm = 0.5789, lr_0 = 2.5032e-04
Validation rmse = 1.283826
Epoch 18
Loss = 1.2138e-03, PNorm = 68.8019, GNorm = 0.5830, lr_0 = 2.3972e-04
Loss = 9.2415e-04, PNorm = 68.8195, GNorm = 0.2120, lr_0 = 2.2956e-04
Validation rmse = 1.252497
Epoch 19
Loss = 9.8362e-04, PNorm = 68.8374, GNorm = 0.5491, lr_0 = 2.1889e-04
Loss = 7.7788e-04, PNorm = 68.8558, GNorm = 0.3425, lr_0 = 2.0962e-04
Validation rmse = 1.282982
Epoch 20
Loss = 1.0320e-03, PNorm = 68.8745, GNorm = 0.6789, lr_0 = 2.0074e-04
Loss = 7.7164e-04, PNorm = 68.8856, GNorm = 0.3631, lr_0 = 1.9224e-04
Validation rmse = 1.355124
Epoch 21
Loss = 6.6620e-04, PNorm = 68.9001, GNorm = 0.5730, lr_0 = 1.8409e-04
Loss = 8.7451e-04, PNorm = 68.9148, GNorm = 0.4471, lr_0 = 1.7630e-04
Validation rmse = 1.476932
Epoch 22
Loss = 6.4696e-04, PNorm = 68.9299, GNorm = 0.7404, lr_0 = 1.6810e-04
Loss = 7.4686e-04, PNorm = 68.9405, GNorm = 0.7440, lr_0 = 1.6098e-04
Validation rmse = 1.343119
Epoch 23
Loss = 8.1521e-04, PNorm = 68.9548, GNorm = 0.2854, lr_0 = 1.5416e-04
Loss = 6.6800e-04, PNorm = 68.9676, GNorm = 0.2649, lr_0 = 1.4763e-04
Loss = 7.0100e-04, PNorm = 68.9687, GNorm = 0.7713, lr_0 = 1.4699e-04
Validation rmse = 1.298953
Epoch 24
Loss = 6.1496e-04, PNorm = 68.9780, GNorm = 0.3274, lr_0 = 1.4077e-04
Loss = 6.7046e-04, PNorm = 68.9870, GNorm = 0.5348, lr_0 = 1.3480e-04
Validation rmse = 1.324599
Epoch 25
Loss = 7.2083e-04, PNorm = 68.9941, GNorm = 0.5042, lr_0 = 1.2909e-04
Loss = 8.3850e-04, PNorm = 69.0043, GNorm = 0.7628, lr_0 = 1.2362e-04
Validation rmse = 1.248332
Epoch 26
Loss = 6.6063e-04, PNorm = 69.0109, GNorm = 0.3086, lr_0 = 1.1839e-04
Validation rmse = 1.284139
Epoch 27
Loss = 4.3188e-04, PNorm = 69.0205, GNorm = 0.4721, lr_0 = 1.1288e-04
Loss = 6.0119e-04, PNorm = 69.0285, GNorm = 0.2844, lr_0 = 1.0810e-04
Validation rmse = 1.360390
Epoch 28
Loss = 2.8457e-04, PNorm = 69.0375, GNorm = 0.2600, lr_0 = 1.0352e-04
Loss = 7.4093e-04, PNorm = 69.0466, GNorm = 0.7052, lr_0 = 1.0000e-04
Validation rmse = 1.384478
Epoch 29
Loss = 6.9127e-04, PNorm = 69.0541, GNorm = 0.4400, lr_0 = 1.0000e-04
Loss = 5.9027e-04, PNorm = 69.0615, GNorm = 0.5214, lr_0 = 1.0000e-04
Validation rmse = 1.307311
Model 0 best validation rmse = 1.197015 on epoch 5
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.818112
Ensemble test rmse = 0.818112
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.05_ffn_num_layers_2_hidden_size_1400/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total scaffolds = 195 | train scaffolds = 75 | val scaffolds = 42 | test scaffolds = 78
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1404, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,281,801
Moving model to cuda
Epoch 0
Loss = 1.3967e-02, PNorm = 67.3577, GNorm = 7.1435, lr_0 = 3.6053e-04
Validation rmse = 1.260326
Epoch 1
Loss = 2.2868e-03, PNorm = 67.4293, GNorm = 0.5493, lr_0 = 6.2105e-04
Loss = 4.6612e-03, PNorm = 67.5168, GNorm = 3.7623, lr_0 = 8.5789e-04
Validation rmse = 1.040633
Epoch 2
Loss = 3.3489e-03, PNorm = 67.6127, GNorm = 1.0565, lr_0 = 9.8284e-04
Loss = 2.3521e-03, PNorm = 67.6895, GNorm = 0.8066, lr_0 = 9.4120e-04
Validation rmse = 0.992386
Epoch 3
Loss = 1.4376e-03, PNorm = 67.7594, GNorm = 0.3444, lr_0 = 8.9744e-04
Loss = 1.9008e-03, PNorm = 67.8161, GNorm = 1.0327, lr_0 = 8.5943e-04
Validation rmse = 1.005919
Epoch 4
Loss = 2.1646e-03, PNorm = 67.8769, GNorm = 1.7934, lr_0 = 8.2303e-04
Loss = 1.6846e-03, PNorm = 67.9282, GNorm = 0.3316, lr_0 = 7.8816e-04
Validation rmse = 0.877391
Epoch 5
Loss = 1.4050e-03, PNorm = 67.9697, GNorm = 1.4912, lr_0 = 7.5478e-04
Loss = 1.7478e-03, PNorm = 68.0164, GNorm = 1.2310, lr_0 = 7.2281e-04
Validation rmse = 0.888057
Epoch 6
Loss = 1.1412e-03, PNorm = 68.0609, GNorm = 0.3959, lr_0 = 6.8920e-04
Loss = 1.8208e-03, PNorm = 68.1015, GNorm = 1.9172, lr_0 = 6.6001e-04
Validation rmse = 0.918844
Epoch 7
Loss = 1.5063e-03, PNorm = 68.1403, GNorm = 1.2195, lr_0 = 6.3205e-04
Loss = 1.6320e-03, PNorm = 68.1783, GNorm = 0.6368, lr_0 = 6.0528e-04
Validation rmse = 0.851050
Epoch 8
Loss = 1.8321e-03, PNorm = 68.2247, GNorm = 0.5604, lr_0 = 5.7714e-04
Loss = 1.0614e-03, PNorm = 68.2642, GNorm = 0.4061, lr_0 = 5.5269e-04
Validation rmse = 0.912572
Epoch 9
Loss = 1.3267e-03, PNorm = 68.2968, GNorm = 1.0548, lr_0 = 5.2928e-04
Loss = 1.2024e-03, PNorm = 68.3283, GNorm = 0.8198, lr_0 = 5.0686e-04
Validation rmse = 0.851244
Epoch 10
Loss = 9.5486e-04, PNorm = 68.3569, GNorm = 0.4014, lr_0 = 4.8539e-04
Loss = 9.9199e-04, PNorm = 68.3912, GNorm = 0.3360, lr_0 = 4.6483e-04
Validation rmse = 0.797533
Epoch 11
Loss = 1.0015e-03, PNorm = 68.4192, GNorm = 0.5603, lr_0 = 4.4322e-04
Loss = 8.1637e-04, PNorm = 68.4505, GNorm = 0.2163, lr_0 = 4.2444e-04
Validation rmse = 0.800847
Epoch 12
Loss = 8.4988e-04, PNorm = 68.4776, GNorm = 0.2601, lr_0 = 4.0646e-04
Loss = 7.3961e-04, PNorm = 68.4998, GNorm = 0.4128, lr_0 = 3.8925e-04
Validation rmse = 0.769360
Epoch 13
Loss = 9.1225e-04, PNorm = 68.5207, GNorm = 0.4333, lr_0 = 3.7276e-04
Loss = 8.6651e-04, PNorm = 68.5449, GNorm = 0.5505, lr_0 = 3.5697e-04
Validation rmse = 0.757793
Epoch 14
Loss = 8.3139e-04, PNorm = 68.5751, GNorm = 0.6313, lr_0 = 3.4037e-04
Loss = 1.1459e-03, PNorm = 68.5998, GNorm = 1.0381, lr_0 = 3.2596e-04
Validation rmse = 0.788476
Epoch 15
Loss = 7.8870e-04, PNorm = 68.6228, GNorm = 0.5378, lr_0 = 3.1215e-04
Loss = 8.4112e-04, PNorm = 68.6421, GNorm = 0.4880, lr_0 = 2.9893e-04
Validation rmse = 0.831995
Epoch 16
Loss = 7.7679e-04, PNorm = 68.6660, GNorm = 0.5191, lr_0 = 2.8503e-04
Loss = 7.8163e-04, PNorm = 68.6893, GNorm = 0.5032, lr_0 = 2.7295e-04
Validation rmse = 0.761103
Epoch 17
Loss = 7.4284e-04, PNorm = 68.7020, GNorm = 0.3064, lr_0 = 2.6139e-04
Loss = 8.7555e-04, PNorm = 68.7230, GNorm = 0.4853, lr_0 = 2.5032e-04
Validation rmse = 0.811327
Epoch 18
Loss = 7.4273e-04, PNorm = 68.7393, GNorm = 0.5857, lr_0 = 2.3972e-04
Loss = 8.1890e-04, PNorm = 68.7544, GNorm = 0.3767, lr_0 = 2.2956e-04
Validation rmse = 0.837427
Epoch 19
Loss = 8.3990e-04, PNorm = 68.7722, GNorm = 1.0972, lr_0 = 2.1889e-04
Loss = 7.5396e-04, PNorm = 68.7857, GNorm = 0.2612, lr_0 = 2.0962e-04
Validation rmse = 0.811947
Epoch 20
Loss = 6.3905e-04, PNorm = 68.7993, GNorm = 0.4190, lr_0 = 2.0074e-04
Loss = 8.4535e-04, PNorm = 68.8153, GNorm = 0.2936, lr_0 = 1.9224e-04
Validation rmse = 0.866909
Epoch 21
Loss = 8.5160e-04, PNorm = 68.8302, GNorm = 0.7228, lr_0 = 1.8409e-04
Loss = 6.7476e-04, PNorm = 68.8453, GNorm = 0.4360, lr_0 = 1.7630e-04
Validation rmse = 0.823456
Epoch 22
Loss = 7.1224e-04, PNorm = 68.8617, GNorm = 0.2428, lr_0 = 1.6810e-04
Loss = 7.3315e-04, PNorm = 68.8766, GNorm = 0.5934, lr_0 = 1.6098e-04
Validation rmse = 0.798490
Epoch 23
Loss = 6.5242e-04, PNorm = 68.8874, GNorm = 0.5007, lr_0 = 1.5416e-04
Loss = 6.5293e-04, PNorm = 68.8988, GNorm = 0.2608, lr_0 = 1.4763e-04
Loss = 9.7918e-04, PNorm = 68.9001, GNorm = 0.4930, lr_0 = 1.4699e-04
Validation rmse = 0.820522
Epoch 24
Loss = 6.4266e-04, PNorm = 68.9061, GNorm = 0.5400, lr_0 = 1.4077e-04
Loss = 6.8280e-04, PNorm = 68.9188, GNorm = 0.4287, lr_0 = 1.3480e-04
Validation rmse = 0.786762
Epoch 25
Loss = 6.3164e-04, PNorm = 68.9281, GNorm = 0.7801, lr_0 = 1.2909e-04
Loss = 5.9509e-04, PNorm = 68.9379, GNorm = 0.6392, lr_0 = 1.2362e-04
Validation rmse = 0.820691
Epoch 26
Loss = 6.7657e-04, PNorm = 68.9472, GNorm = 0.8668, lr_0 = 1.1839e-04
Validation rmse = 0.806369
Epoch 27
Loss = 1.4884e-03, PNorm = 68.9561, GNorm = 0.9738, lr_0 = 1.1288e-04
Loss = 5.3623e-04, PNorm = 68.9643, GNorm = 0.5097, lr_0 = 1.0810e-04
Validation rmse = 0.821694
Epoch 28
Loss = 3.9398e-04, PNorm = 68.9715, GNorm = 0.2993, lr_0 = 1.0352e-04
Loss = 6.1836e-04, PNorm = 68.9797, GNorm = 0.2417, lr_0 = 1.0000e-04
Validation rmse = 0.845287
Epoch 29
Loss = 6.0237e-04, PNorm = 68.9877, GNorm = 0.4712, lr_0 = 1.0000e-04
Loss = 4.8828e-04, PNorm = 68.9950, GNorm = 0.5440, lr_0 = 1.0000e-04
Validation rmse = 0.821708
Model 0 best validation rmse = 0.757793 on epoch 13
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.976665
Ensemble test rmse = 0.976665
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.05_ffn_num_layers_2_hidden_size_1400/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 58 | test scaffolds = 53
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1404, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,281,801
Moving model to cuda
Epoch 0
Loss = 1.4779e-02, PNorm = 67.3601, GNorm = 3.6543, lr_0 = 3.6053e-04
Validation rmse = 1.282804
Epoch 1
Loss = 5.6138e-03, PNorm = 67.4318, GNorm = 3.3289, lr_0 = 6.2105e-04
Loss = 4.3795e-03, PNorm = 67.5218, GNorm = 1.1109, lr_0 = 8.5789e-04
Validation rmse = 1.093615
Epoch 2
Loss = 2.1742e-03, PNorm = 67.6145, GNorm = 0.5595, lr_0 = 9.8284e-04
Loss = 2.9207e-03, PNorm = 67.6959, GNorm = 2.6819, lr_0 = 9.4120e-04
Validation rmse = 1.276726
Epoch 3
Loss = 4.7039e-03, PNorm = 67.7736, GNorm = 2.0945, lr_0 = 8.9744e-04
Loss = 2.9798e-03, PNorm = 67.8409, GNorm = 0.8509, lr_0 = 8.5943e-04
Validation rmse = 0.884770
Epoch 4
Loss = 2.6077e-03, PNorm = 67.9034, GNorm = 1.0830, lr_0 = 8.2303e-04
Loss = 1.9563e-03, PNorm = 67.9563, GNorm = 0.6644, lr_0 = 7.8816e-04
Validation rmse = 0.889132
Epoch 5
Loss = 1.6787e-03, PNorm = 67.9951, GNorm = 0.6654, lr_0 = 7.5478e-04
Loss = 1.9213e-03, PNorm = 68.0388, GNorm = 0.9552, lr_0 = 7.2281e-04
Validation rmse = 0.837277
Epoch 6
Loss = 1.9946e-03, PNorm = 68.0788, GNorm = 1.4565, lr_0 = 6.8920e-04
Loss = 1.8516e-03, PNorm = 68.1115, GNorm = 1.0881, lr_0 = 6.6001e-04
Validation rmse = 0.829818
Epoch 7
Loss = 1.7914e-03, PNorm = 68.1538, GNorm = 0.8574, lr_0 = 6.3205e-04
Loss = 1.5790e-03, PNorm = 68.1872, GNorm = 0.6645, lr_0 = 6.0528e-04
Validation rmse = 0.775242
Epoch 8
Loss = 1.2409e-03, PNorm = 68.2201, GNorm = 0.5568, lr_0 = 5.7714e-04
Loss = 1.3034e-03, PNorm = 68.2533, GNorm = 0.5953, lr_0 = 5.5269e-04
Validation rmse = 0.808885
Epoch 9
Loss = 1.3637e-03, PNorm = 68.2800, GNorm = 0.6031, lr_0 = 5.2928e-04
Loss = 1.2777e-03, PNorm = 68.3082, GNorm = 0.9389, lr_0 = 5.0686e-04
Validation rmse = 0.806669
Epoch 10
Loss = 1.0431e-03, PNorm = 68.3347, GNorm = 1.2348, lr_0 = 4.8539e-04
Loss = 1.2335e-03, PNorm = 68.3598, GNorm = 0.4415, lr_0 = 4.6483e-04
Validation rmse = 0.798430
Epoch 11
Loss = 1.3884e-03, PNorm = 68.3920, GNorm = 0.5086, lr_0 = 4.4322e-04
Loss = 1.4030e-03, PNorm = 68.4229, GNorm = 0.4211, lr_0 = 4.2444e-04
Validation rmse = 0.781054
Epoch 12
Loss = 1.1670e-03, PNorm = 68.4517, GNorm = 0.4672, lr_0 = 4.0646e-04
Loss = 1.1185e-03, PNorm = 68.4763, GNorm = 0.4633, lr_0 = 3.8925e-04
Validation rmse = 0.753619
Epoch 13
Loss = 8.1547e-04, PNorm = 68.4937, GNorm = 0.4458, lr_0 = 3.7276e-04
Loss = 1.0557e-03, PNorm = 68.5124, GNorm = 0.5295, lr_0 = 3.5697e-04
Validation rmse = 0.816352
Epoch 14
Loss = 1.0888e-03, PNorm = 68.5392, GNorm = 1.1997, lr_0 = 3.4037e-04
Loss = 1.0898e-03, PNorm = 68.5611, GNorm = 0.5518, lr_0 = 3.2596e-04
Validation rmse = 0.740269
Epoch 15
Loss = 1.0283e-03, PNorm = 68.5820, GNorm = 0.3789, lr_0 = 3.1215e-04
Loss = 1.1478e-03, PNorm = 68.6032, GNorm = 0.8935, lr_0 = 2.9893e-04
Validation rmse = 0.774489
Epoch 16
Loss = 1.0457e-03, PNorm = 68.6271, GNorm = 1.7193, lr_0 = 2.8503e-04
Loss = 9.9162e-04, PNorm = 68.6442, GNorm = 0.5258, lr_0 = 2.7295e-04
Validation rmse = 0.784914
Epoch 17
Loss = 8.7988e-04, PNorm = 68.6627, GNorm = 0.5072, lr_0 = 2.6139e-04
Loss = 1.1167e-03, PNorm = 68.6799, GNorm = 0.8403, lr_0 = 2.5032e-04
Validation rmse = 0.776598
Epoch 18
Loss = 9.4016e-04, PNorm = 68.6982, GNorm = 0.3386, lr_0 = 2.3972e-04
Loss = 1.0483e-03, PNorm = 68.7117, GNorm = 0.7169, lr_0 = 2.2956e-04
Validation rmse = 0.721068
Epoch 19
Loss = 1.1478e-03, PNorm = 68.7271, GNorm = 0.9074, lr_0 = 2.1889e-04
Loss = 1.0645e-03, PNorm = 68.7460, GNorm = 0.2177, lr_0 = 2.0962e-04
Validation rmse = 0.725664
Epoch 20
Loss = 8.9527e-04, PNorm = 68.7619, GNorm = 0.2219, lr_0 = 2.0074e-04
Loss = 6.5544e-04, PNorm = 68.7748, GNorm = 0.3334, lr_0 = 1.9224e-04
Validation rmse = 0.720741
Epoch 21
Loss = 7.6651e-04, PNorm = 68.7850, GNorm = 0.3751, lr_0 = 1.8409e-04
Loss = 9.4849e-04, PNorm = 68.7988, GNorm = 0.6207, lr_0 = 1.7630e-04
Validation rmse = 0.736341
Epoch 22
Loss = 1.0145e-03, PNorm = 68.8123, GNorm = 0.8713, lr_0 = 1.6810e-04
Loss = 7.9829e-04, PNorm = 68.8236, GNorm = 0.6072, lr_0 = 1.6098e-04
Validation rmse = 0.724607
Epoch 23
Loss = 7.5037e-04, PNorm = 68.8353, GNorm = 0.3586, lr_0 = 1.5416e-04
Loss = 9.4964e-04, PNorm = 68.8463, GNorm = 0.4750, lr_0 = 1.4763e-04
Loss = 1.9673e-03, PNorm = 68.8475, GNorm = 0.9923, lr_0 = 1.4699e-04
Validation rmse = 0.721732
Epoch 24
Loss = 8.7712e-04, PNorm = 68.8564, GNorm = 0.2637, lr_0 = 1.4077e-04
Loss = 8.0487e-04, PNorm = 68.8654, GNorm = 0.4443, lr_0 = 1.3480e-04
Validation rmse = 0.753699
Epoch 25
Loss = 7.8332e-04, PNorm = 68.8752, GNorm = 0.3714, lr_0 = 1.2909e-04
Loss = 6.7366e-04, PNorm = 68.8843, GNorm = 0.3310, lr_0 = 1.2362e-04
Validation rmse = 0.748876
Epoch 26
Loss = 4.9843e-04, PNorm = 68.8940, GNorm = 0.1944, lr_0 = 1.1839e-04
Validation rmse = 0.714354
Epoch 27
Loss = 1.4847e-03, PNorm = 68.9045, GNorm = 0.3800, lr_0 = 1.1288e-04
Loss = 6.7743e-04, PNorm = 68.9125, GNorm = 0.3196, lr_0 = 1.0810e-04
Validation rmse = 0.724788
Epoch 28
Loss = 3.9677e-04, PNorm = 68.9203, GNorm = 0.2558, lr_0 = 1.0352e-04
Loss = 7.3328e-04, PNorm = 68.9294, GNorm = 0.5837, lr_0 = 1.0000e-04
Validation rmse = 0.734700
Epoch 29
Loss = 6.4699e-04, PNorm = 68.9400, GNorm = 0.5273, lr_0 = 1.0000e-04
Loss = 6.2923e-04, PNorm = 68.9468, GNorm = 0.3738, lr_0 = 1.0000e-04
Validation rmse = 0.740641
Model 0 best validation rmse = 0.714354 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.333101
Ensemble test rmse = 1.333101
10-fold cross validation
	Seed 0 ==> test rmse = 0.814562
	Seed 1 ==> test rmse = 0.886986
	Seed 2 ==> test rmse = 0.890531
	Seed 3 ==> test rmse = 0.790166
	Seed 4 ==> test rmse = 0.873721
	Seed 5 ==> test rmse = 0.941129
	Seed 6 ==> test rmse = 0.765664
	Seed 7 ==> test rmse = 0.818112
	Seed 8 ==> test rmse = 0.976665
	Seed 9 ==> test rmse = 1.333101
Overall test rmse = 0.909064 +/- 0.154722
Elapsed time = 0:07:01
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1500,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.25_ffn_num_layers_1_hidden_size_1500/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total scaffolds = 195 | train scaffolds = 91 | val scaffolds = 66 | test scaffolds = 38
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1500, bias=False)
      (W_h): Linear(in_features=1500, out_features=1500, bias=False)
      (W_o): Linear(in_features=1633, out_features=1500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1504, out_features=1, bias=True)
  )
)
Number of parameters = 4,923,005
Moving model to cuda
Epoch 0
Loss = 1.6837e-02, PNorm = 57.7689, GNorm = 4.1086, lr_0 = 3.6053e-04
Validation rmse = 1.509206
Epoch 1
Loss = 5.8040e-03, PNorm = 57.8318, GNorm = 2.7581, lr_0 = 6.2105e-04
Loss = 5.2768e-03, PNorm = 57.9073, GNorm = 1.8224, lr_0 = 8.5789e-04
Validation rmse = 1.630988
Epoch 2
Loss = 4.3059e-03, PNorm = 57.9828, GNorm = 1.8406, lr_0 = 9.8284e-04
Loss = 4.1980e-03, PNorm = 58.0484, GNorm = 1.3615, lr_0 = 9.4120e-04
Validation rmse = 1.429661
Epoch 3
Loss = 3.6093e-03, PNorm = 58.1126, GNorm = 3.5459, lr_0 = 8.9744e-04
Loss = 4.1468e-03, PNorm = 58.1637, GNorm = 2.8436, lr_0 = 8.5943e-04
Validation rmse = 1.328445
Epoch 4
Loss = 4.2239e-03, PNorm = 58.2069, GNorm = 1.2130, lr_0 = 8.2303e-04
Loss = 3.0109e-03, PNorm = 58.2489, GNorm = 4.3726, lr_0 = 7.8816e-04
Validation rmse = 1.409083
Epoch 5
Loss = 2.9811e-03, PNorm = 58.2871, GNorm = 1.3569, lr_0 = 7.5478e-04
Loss = 2.8486e-03, PNorm = 58.3217, GNorm = 0.9511, lr_0 = 7.2281e-04
Validation rmse = 1.348028
Epoch 6
Loss = 2.3597e-03, PNorm = 58.3611, GNorm = 2.7312, lr_0 = 6.8920e-04
Loss = 2.3845e-03, PNorm = 58.3900, GNorm = 2.1435, lr_0 = 6.6001e-04
Validation rmse = 1.587424
Epoch 7
Loss = 3.8984e-03, PNorm = 58.4204, GNorm = 3.0626, lr_0 = 6.3205e-04
Loss = 2.3754e-03, PNorm = 58.4540, GNorm = 1.0200, lr_0 = 6.0528e-04
Validation rmse = 1.040542
Epoch 8
Loss = 2.0510e-03, PNorm = 58.4837, GNorm = 1.0287, lr_0 = 5.7714e-04
Loss = 1.9620e-03, PNorm = 58.5134, GNorm = 0.9921, lr_0 = 5.5269e-04
Validation rmse = 1.205987
Epoch 9
Loss = 2.1686e-03, PNorm = 58.5398, GNorm = 4.0641, lr_0 = 5.2928e-04
Loss = 2.0589e-03, PNorm = 58.5645, GNorm = 1.2801, lr_0 = 5.0686e-04
Validation rmse = 1.077032
Epoch 10
Loss = 2.0229e-03, PNorm = 58.5831, GNorm = 2.3923, lr_0 = 4.8539e-04
Loss = 1.8100e-03, PNorm = 58.6037, GNorm = 0.5250, lr_0 = 4.6483e-04
Validation rmse = 1.078827
Epoch 11
Loss = 1.4463e-03, PNorm = 58.6238, GNorm = 0.7753, lr_0 = 4.4322e-04
Loss = 1.6015e-03, PNorm = 58.6402, GNorm = 1.8467, lr_0 = 4.2444e-04
Validation rmse = 1.013782
Epoch 12
Loss = 1.6213e-03, PNorm = 58.6541, GNorm = 0.8318, lr_0 = 4.0646e-04
Loss = 1.5889e-03, PNorm = 58.6667, GNorm = 0.5849, lr_0 = 3.8925e-04
Validation rmse = 1.020447
Epoch 13
Loss = 1.3618e-03, PNorm = 58.6830, GNorm = 0.3427, lr_0 = 3.7276e-04
Loss = 1.6947e-03, PNorm = 58.6984, GNorm = 0.7668, lr_0 = 3.5697e-04
Validation rmse = 1.058563
Epoch 14
Loss = 1.4251e-03, PNorm = 58.7145, GNorm = 0.9334, lr_0 = 3.4037e-04
Loss = 1.5100e-03, PNorm = 58.7286, GNorm = 1.2059, lr_0 = 3.2596e-04
Validation rmse = 1.012556
Epoch 15
Loss = 1.3979e-03, PNorm = 58.7422, GNorm = 0.7474, lr_0 = 3.1215e-04
Loss = 1.3307e-03, PNorm = 58.7536, GNorm = 1.8787, lr_0 = 2.9893e-04
Validation rmse = 1.144683
Epoch 16
Loss = 1.4641e-03, PNorm = 58.7647, GNorm = 0.7911, lr_0 = 2.8503e-04
Loss = 1.4161e-03, PNorm = 58.7752, GNorm = 1.6072, lr_0 = 2.7295e-04
Validation rmse = 1.029961
Epoch 17
Loss = 1.3866e-03, PNorm = 58.7863, GNorm = 2.0061, lr_0 = 2.6139e-04
Loss = 1.5828e-03, PNorm = 58.7992, GNorm = 0.5912, lr_0 = 2.5032e-04
Validation rmse = 0.971797
Epoch 18
Loss = 1.1041e-03, PNorm = 58.8086, GNorm = 0.5349, lr_0 = 2.3972e-04
Loss = 1.2740e-03, PNorm = 58.8195, GNorm = 0.8962, lr_0 = 2.2956e-04
Validation rmse = 1.052277
Epoch 19
Loss = 1.2117e-03, PNorm = 58.8330, GNorm = 1.3797, lr_0 = 2.1889e-04
Loss = 1.4229e-03, PNorm = 58.8412, GNorm = 0.5865, lr_0 = 2.0962e-04
Validation rmse = 1.158583
Epoch 20
Loss = 1.2061e-03, PNorm = 58.8510, GNorm = 0.3427, lr_0 = 2.0074e-04
Loss = 1.3092e-03, PNorm = 58.8592, GNorm = 0.8270, lr_0 = 1.9224e-04
Validation rmse = 1.050806
Epoch 21
Loss = 1.1827e-03, PNorm = 58.8691, GNorm = 0.6180, lr_0 = 1.8409e-04
Loss = 1.1594e-03, PNorm = 58.8769, GNorm = 0.5326, lr_0 = 1.7630e-04
Validation rmse = 1.004314
Epoch 22
Loss = 9.5622e-04, PNorm = 58.8866, GNorm = 0.8880, lr_0 = 1.6810e-04
Loss = 1.4465e-03, PNorm = 58.8927, GNorm = 0.8042, lr_0 = 1.6098e-04
Validation rmse = 0.969600
Epoch 23
Loss = 1.1540e-03, PNorm = 58.8994, GNorm = 0.6854, lr_0 = 1.5416e-04
Loss = 1.1742e-03, PNorm = 58.9059, GNorm = 0.8533, lr_0 = 1.4763e-04
Loss = 1.7148e-03, PNorm = 58.9066, GNorm = 0.9759, lr_0 = 1.4699e-04
Validation rmse = 1.051866
Epoch 24
Loss = 1.2489e-03, PNorm = 58.9122, GNorm = 0.7270, lr_0 = 1.4077e-04
Loss = 1.0825e-03, PNorm = 58.9197, GNorm = 0.4906, lr_0 = 1.3480e-04
Validation rmse = 1.022873
Epoch 25
Loss = 1.1577e-03, PNorm = 58.9252, GNorm = 0.8493, lr_0 = 1.2909e-04
Loss = 1.1338e-03, PNorm = 58.9308, GNorm = 0.6424, lr_0 = 1.2362e-04
Validation rmse = 1.057793
Epoch 26
Loss = 1.0683e-03, PNorm = 58.9356, GNorm = 1.2584, lr_0 = 1.1839e-04
Validation rmse = 1.043597
Epoch 27
Loss = 7.5655e-04, PNorm = 58.9413, GNorm = 1.1477, lr_0 = 1.1288e-04
Loss = 1.1720e-03, PNorm = 58.9457, GNorm = 1.1003, lr_0 = 1.0810e-04
Validation rmse = 0.995293
Epoch 28
Loss = 1.6563e-03, PNorm = 58.9496, GNorm = 0.7154, lr_0 = 1.0352e-04
Loss = 1.0198e-03, PNorm = 58.9547, GNorm = 0.7400, lr_0 = 1.0000e-04
Validation rmse = 0.992616
Epoch 29
Loss = 1.1731e-03, PNorm = 58.9592, GNorm = 0.6132, lr_0 = 1.0000e-04
Loss = 1.1799e-03, PNorm = 58.9638, GNorm = 0.5026, lr_0 = 1.0000e-04
Validation rmse = 1.022485
Model 0 best validation rmse = 0.969600 on epoch 22
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.890236
Ensemble test rmse = 0.890236
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1500,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.25_ffn_num_layers_1_hidden_size_1500/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total scaffolds = 195 | train scaffolds = 76 | val scaffolds = 60 | test scaffolds = 59
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1500, bias=False)
      (W_h): Linear(in_features=1500, out_features=1500, bias=False)
      (W_o): Linear(in_features=1633, out_features=1500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1504, out_features=1, bias=True)
  )
)
Number of parameters = 4,923,005
Moving model to cuda
Epoch 0
Loss = 1.8185e-02, PNorm = 57.7700, GNorm = 4.5085, lr_0 = 3.6053e-04
Validation rmse = 1.648643
Epoch 1
Loss = 6.6216e-03, PNorm = 57.8297, GNorm = 2.4845, lr_0 = 6.2105e-04
Loss = 6.5637e-03, PNorm = 57.9092, GNorm = 1.9512, lr_0 = 8.5789e-04
Validation rmse = 1.646951
Epoch 2
Loss = 6.7628e-03, PNorm = 57.9894, GNorm = 5.0477, lr_0 = 9.8284e-04
Loss = 4.7692e-03, PNorm = 58.0620, GNorm = 2.9065, lr_0 = 9.4120e-04
Validation rmse = 1.408663
Epoch 3
Loss = 4.3272e-03, PNorm = 58.1208, GNorm = 2.0841, lr_0 = 8.9744e-04
Loss = 3.7736e-03, PNorm = 58.1712, GNorm = 1.0421, lr_0 = 8.5943e-04
Validation rmse = 1.358808
Epoch 4
Loss = 2.1824e-03, PNorm = 58.2089, GNorm = 1.0420, lr_0 = 8.2303e-04
Loss = 2.9860e-03, PNorm = 58.2474, GNorm = 1.7756, lr_0 = 7.8816e-04
Validation rmse = 1.419640
Epoch 5
Loss = 2.6406e-03, PNorm = 58.2805, GNorm = 1.3963, lr_0 = 7.5478e-04
Loss = 2.4778e-03, PNorm = 58.3170, GNorm = 1.2625, lr_0 = 7.2281e-04
Validation rmse = 1.163469
Epoch 6
Loss = 2.2287e-03, PNorm = 58.3470, GNorm = 0.8737, lr_0 = 6.8920e-04
Loss = 2.4647e-03, PNorm = 58.3842, GNorm = 0.9467, lr_0 = 6.6001e-04
Validation rmse = 1.359067
Epoch 7
Loss = 2.4491e-03, PNorm = 58.4152, GNorm = 1.9114, lr_0 = 6.3205e-04
Loss = 3.0996e-03, PNorm = 58.4459, GNorm = 1.5295, lr_0 = 6.0528e-04
Validation rmse = 1.197438
Epoch 8
Loss = 2.2259e-03, PNorm = 58.4785, GNorm = 0.6439, lr_0 = 5.7714e-04
Loss = 2.0259e-03, PNorm = 58.5029, GNorm = 1.8085, lr_0 = 5.5269e-04
Validation rmse = 1.083445
Epoch 9
Loss = 1.6421e-03, PNorm = 58.5271, GNorm = 0.8731, lr_0 = 5.2928e-04
Loss = 1.8953e-03, PNorm = 58.5473, GNorm = 0.7120, lr_0 = 5.0686e-04
Validation rmse = 1.103142
Epoch 10
Loss = 1.5692e-03, PNorm = 58.5671, GNorm = 1.5545, lr_0 = 4.8539e-04
Loss = 1.6214e-03, PNorm = 58.5853, GNorm = 0.8954, lr_0 = 4.6483e-04
Validation rmse = 1.031914
Epoch 11
Loss = 2.1536e-03, PNorm = 58.6052, GNorm = 2.4607, lr_0 = 4.4322e-04
Loss = 1.8640e-03, PNorm = 58.6217, GNorm = 2.0733, lr_0 = 4.2444e-04
Validation rmse = 1.113335
Epoch 12
Loss = 1.3166e-03, PNorm = 58.6406, GNorm = 1.1044, lr_0 = 4.0646e-04
Loss = 1.5284e-03, PNorm = 58.6532, GNorm = 1.1344, lr_0 = 3.8925e-04
Validation rmse = 1.152522
Epoch 13
Loss = 1.9860e-03, PNorm = 58.6663, GNorm = 2.0176, lr_0 = 3.7276e-04
Loss = 1.6116e-03, PNorm = 58.6819, GNorm = 0.8172, lr_0 = 3.5697e-04
Validation rmse = 1.025103
Epoch 14
Loss = 1.4767e-03, PNorm = 58.6995, GNorm = 1.5627, lr_0 = 3.4037e-04
Loss = 1.5902e-03, PNorm = 58.7142, GNorm = 1.3288, lr_0 = 3.2596e-04
Validation rmse = 1.121951
Epoch 15
Loss = 1.6683e-03, PNorm = 58.7245, GNorm = 1.0171, lr_0 = 3.1215e-04
Loss = 1.3344e-03, PNorm = 58.7387, GNorm = 0.6988, lr_0 = 2.9893e-04
Validation rmse = 0.995050
Epoch 16
Loss = 1.2239e-03, PNorm = 58.7506, GNorm = 0.6711, lr_0 = 2.8503e-04
Loss = 1.5034e-03, PNorm = 58.7592, GNorm = 1.1239, lr_0 = 2.7295e-04
Validation rmse = 1.013341
Epoch 17
Loss = 1.1712e-03, PNorm = 58.7729, GNorm = 1.1002, lr_0 = 2.6139e-04
Loss = 1.3521e-03, PNorm = 58.7826, GNorm = 0.7364, lr_0 = 2.5032e-04
Validation rmse = 1.022786
Epoch 18
Loss = 1.2710e-03, PNorm = 58.7928, GNorm = 1.0563, lr_0 = 2.3972e-04
Loss = 1.2730e-03, PNorm = 58.8001, GNorm = 2.0221, lr_0 = 2.2956e-04
Validation rmse = 1.005270
Epoch 19
Loss = 1.0110e-03, PNorm = 58.8105, GNorm = 0.9108, lr_0 = 2.1889e-04
Loss = 1.3698e-03, PNorm = 58.8177, GNorm = 0.6999, lr_0 = 2.0962e-04
Validation rmse = 0.996181
Epoch 20
Loss = 1.0531e-03, PNorm = 58.8258, GNorm = 0.5248, lr_0 = 2.0074e-04
Loss = 1.2880e-03, PNorm = 58.8349, GNorm = 0.5450, lr_0 = 1.9224e-04
Validation rmse = 0.973186
Epoch 21
Loss = 9.9658e-04, PNorm = 58.8414, GNorm = 1.5437, lr_0 = 1.8409e-04
Loss = 1.3369e-03, PNorm = 58.8477, GNorm = 0.9805, lr_0 = 1.7630e-04
Validation rmse = 0.987822
Epoch 22
Loss = 1.2786e-03, PNorm = 58.8554, GNorm = 1.5881, lr_0 = 1.6810e-04
Loss = 1.0056e-03, PNorm = 58.8616, GNorm = 1.2399, lr_0 = 1.6098e-04
Validation rmse = 1.013634
Epoch 23
Loss = 1.3427e-03, PNorm = 58.8688, GNorm = 1.3331, lr_0 = 1.5416e-04
Loss = 1.0806e-03, PNorm = 58.8751, GNorm = 0.5938, lr_0 = 1.4763e-04
Loss = 1.5893e-03, PNorm = 58.8757, GNorm = 1.5045, lr_0 = 1.4699e-04
Validation rmse = 0.966950
Epoch 24
Loss = 1.2290e-03, PNorm = 58.8830, GNorm = 0.7007, lr_0 = 1.4077e-04
Loss = 1.0437e-03, PNorm = 58.8874, GNorm = 0.5107, lr_0 = 1.3480e-04
Validation rmse = 1.033998
Epoch 25
Loss = 9.2013e-04, PNorm = 58.8928, GNorm = 0.4886, lr_0 = 1.2909e-04
Loss = 1.2421e-03, PNorm = 58.8972, GNorm = 1.4517, lr_0 = 1.2362e-04
Validation rmse = 1.001167
Epoch 26
Loss = 1.1115e-03, PNorm = 58.9031, GNorm = 0.8024, lr_0 = 1.1839e-04
Validation rmse = 1.035551
Epoch 27
Loss = 1.2898e-03, PNorm = 58.9083, GNorm = 1.4108, lr_0 = 1.1288e-04
Loss = 1.0331e-03, PNorm = 58.9124, GNorm = 0.4777, lr_0 = 1.0810e-04
Validation rmse = 0.997222
Epoch 28
Loss = 9.5073e-04, PNorm = 58.9173, GNorm = 0.4383, lr_0 = 1.0352e-04
Loss = 1.1055e-03, PNorm = 58.9222, GNorm = 1.6973, lr_0 = 1.0000e-04
Validation rmse = 1.034586
Epoch 29
Loss = 7.5682e-04, PNorm = 58.9272, GNorm = 0.5515, lr_0 = 1.0000e-04
Loss = 1.1515e-03, PNorm = 58.9328, GNorm = 0.9110, lr_0 = 1.0000e-04
Validation rmse = 1.052008
Model 0 best validation rmse = 0.966950 on epoch 23
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.005187
Ensemble test rmse = 1.005187
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1500,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.25_ffn_num_layers_1_hidden_size_1500/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total scaffolds = 195 | train scaffolds = 55 | val scaffolds = 64 | test scaffolds = 76
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1500, bias=False)
      (W_h): Linear(in_features=1500, out_features=1500, bias=False)
      (W_o): Linear(in_features=1633, out_features=1500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1504, out_features=1, bias=True)
  )
)
Number of parameters = 4,923,005
Moving model to cuda
Epoch 0
Loss = 1.5331e-02, PNorm = 57.7714, GNorm = 8.1618, lr_0 = 3.6053e-04
Validation rmse = 2.128294
Epoch 1
Loss = 1.0307e-02, PNorm = 57.8328, GNorm = 8.1439, lr_0 = 6.2105e-04
Loss = 8.2777e-03, PNorm = 57.9167, GNorm = 7.4544, lr_0 = 8.5789e-04
Validation rmse = 1.456757
Epoch 2
Loss = 5.8107e-03, PNorm = 58.0042, GNorm = 1.3319, lr_0 = 9.8284e-04
Loss = 4.9790e-03, PNorm = 58.0745, GNorm = 1.3908, lr_0 = 9.4120e-04
Validation rmse = 1.359513
Epoch 3
Loss = 4.0488e-03, PNorm = 58.1330, GNorm = 1.1259, lr_0 = 8.9744e-04
Loss = 4.1295e-03, PNorm = 58.1803, GNorm = 2.7788, lr_0 = 8.5943e-04
Validation rmse = 1.414175
Epoch 4
Loss = 3.1003e-03, PNorm = 58.2227, GNorm = 2.9317, lr_0 = 8.2303e-04
Loss = 3.8542e-03, PNorm = 58.2649, GNorm = 5.7825, lr_0 = 7.8816e-04
Validation rmse = 1.366522
Epoch 5
Loss = 2.6862e-03, PNorm = 58.3112, GNorm = 1.2535, lr_0 = 7.5478e-04
Loss = 2.6813e-03, PNorm = 58.3518, GNorm = 0.6427, lr_0 = 7.2281e-04
Validation rmse = 1.249930
Epoch 6
Loss = 1.9890e-03, PNorm = 58.3952, GNorm = 0.5182, lr_0 = 6.8920e-04
Loss = 2.2048e-03, PNorm = 58.4284, GNorm = 0.8466, lr_0 = 6.6001e-04
Validation rmse = 1.196563
Epoch 7
Loss = 2.5948e-03, PNorm = 58.4592, GNorm = 2.6896, lr_0 = 6.3205e-04
Loss = 1.9277e-03, PNorm = 58.4896, GNorm = 1.1251, lr_0 = 6.0528e-04
Validation rmse = 1.197719
Epoch 8
Loss = 2.6297e-03, PNorm = 58.5242, GNorm = 1.9425, lr_0 = 5.7714e-04
Loss = 2.1497e-03, PNorm = 58.5552, GNorm = 1.4720, lr_0 = 5.5269e-04
Validation rmse = 1.127700
Epoch 9
Loss = 1.7543e-03, PNorm = 58.5767, GNorm = 0.7549, lr_0 = 5.2928e-04
Loss = 1.7903e-03, PNorm = 58.6030, GNorm = 0.6934, lr_0 = 5.0686e-04
Validation rmse = 1.111333
Epoch 10
Loss = 1.6776e-03, PNorm = 58.6209, GNorm = 1.8336, lr_0 = 4.8539e-04
Loss = 1.7029e-03, PNorm = 58.6373, GNorm = 0.9174, lr_0 = 4.6483e-04
Validation rmse = 1.152064
Epoch 11
Loss = 1.9507e-03, PNorm = 58.6583, GNorm = 0.4742, lr_0 = 4.4322e-04
Loss = 2.1956e-03, PNorm = 58.6794, GNorm = 1.0723, lr_0 = 4.2444e-04
Validation rmse = 1.096883
Epoch 12
Loss = 1.8381e-03, PNorm = 58.7005, GNorm = 0.8168, lr_0 = 4.0646e-04
Loss = 1.7506e-03, PNorm = 58.7179, GNorm = 0.9401, lr_0 = 3.8925e-04
Validation rmse = 1.110245
Epoch 13
Loss = 2.0952e-03, PNorm = 58.7321, GNorm = 1.5892, lr_0 = 3.7276e-04
Loss = 1.8789e-03, PNorm = 58.7470, GNorm = 1.4375, lr_0 = 3.5697e-04
Validation rmse = 1.184626
Epoch 14
Loss = 1.8979e-03, PNorm = 58.7646, GNorm = 1.3073, lr_0 = 3.4037e-04
Loss = 1.3792e-03, PNorm = 58.7781, GNorm = 0.8872, lr_0 = 3.2596e-04
Validation rmse = 1.136157
Epoch 15
Loss = 1.5212e-03, PNorm = 58.7908, GNorm = 1.5946, lr_0 = 3.1215e-04
Loss = 1.5890e-03, PNorm = 58.8014, GNorm = 1.2025, lr_0 = 2.9893e-04
Validation rmse = 1.107700
Epoch 16
Loss = 1.4875e-03, PNorm = 58.8133, GNorm = 1.2262, lr_0 = 2.8503e-04
Loss = 1.6391e-03, PNorm = 58.8233, GNorm = 1.2989, lr_0 = 2.7295e-04
Validation rmse = 1.104320
Epoch 17
Loss = 1.4127e-03, PNorm = 58.8355, GNorm = 1.8419, lr_0 = 2.6139e-04
Loss = 1.5694e-03, PNorm = 58.8443, GNorm = 2.2882, lr_0 = 2.5032e-04
Validation rmse = 1.162737
Epoch 18
Loss = 1.5521e-03, PNorm = 58.8556, GNorm = 1.1314, lr_0 = 2.3972e-04
Loss = 1.5660e-03, PNorm = 58.8665, GNorm = 0.5976, lr_0 = 2.2956e-04
Validation rmse = 1.080029
Epoch 19
Loss = 1.9931e-03, PNorm = 58.8773, GNorm = 1.9607, lr_0 = 2.1889e-04
Loss = 1.3652e-03, PNorm = 58.8887, GNorm = 0.8648, lr_0 = 2.0962e-04
Validation rmse = 1.034019
Epoch 20
Loss = 1.4224e-03, PNorm = 58.8954, GNorm = 0.6651, lr_0 = 2.0074e-04
Loss = 1.3750e-03, PNorm = 58.9047, GNorm = 1.1797, lr_0 = 1.9224e-04
Validation rmse = 1.080517
Epoch 21
Loss = 1.4334e-03, PNorm = 58.9107, GNorm = 1.1883, lr_0 = 1.8409e-04
Loss = 1.4302e-03, PNorm = 58.9182, GNorm = 0.8771, lr_0 = 1.7630e-04
Validation rmse = 1.085075
Epoch 22
Loss = 1.3404e-03, PNorm = 58.9257, GNorm = 0.5583, lr_0 = 1.6810e-04
Loss = 1.0667e-03, PNorm = 58.9328, GNorm = 1.0586, lr_0 = 1.6098e-04
Validation rmse = 1.057727
Epoch 23
Loss = 1.1014e-03, PNorm = 58.9391, GNorm = 1.0240, lr_0 = 1.5416e-04
Loss = 1.4206e-03, PNorm = 58.9459, GNorm = 0.7840, lr_0 = 1.4763e-04
Loss = 3.0561e-03, PNorm = 58.9462, GNorm = 1.2441, lr_0 = 1.4699e-04
Validation rmse = 1.052037
Epoch 24
Loss = 1.1151e-03, PNorm = 58.9518, GNorm = 2.0025, lr_0 = 1.4077e-04
Loss = 1.3992e-03, PNorm = 58.9564, GNorm = 0.4996, lr_0 = 1.3480e-04
Validation rmse = 1.053690
Epoch 25
Loss = 1.3815e-03, PNorm = 58.9614, GNorm = 0.4560, lr_0 = 1.2909e-04
Loss = 1.0785e-03, PNorm = 58.9666, GNorm = 0.6482, lr_0 = 1.2362e-04
Validation rmse = 1.054154
Epoch 26
Loss = 1.3144e-03, PNorm = 58.9720, GNorm = 0.6751, lr_0 = 1.1839e-04
Validation rmse = 1.040810
Epoch 27
Loss = 9.8493e-04, PNorm = 58.9768, GNorm = 0.6262, lr_0 = 1.1288e-04
Loss = 1.1724e-03, PNorm = 58.9811, GNorm = 0.8333, lr_0 = 1.0810e-04
Validation rmse = 1.064054
Epoch 28
Loss = 1.2813e-03, PNorm = 58.9849, GNorm = 0.6791, lr_0 = 1.0352e-04
Loss = 9.6065e-04, PNorm = 58.9887, GNorm = 0.9648, lr_0 = 1.0000e-04
Validation rmse = 1.052196
Epoch 29
Loss = 1.3684e-03, PNorm = 58.9934, GNorm = 0.8851, lr_0 = 1.0000e-04
Loss = 1.2148e-03, PNorm = 58.9974, GNorm = 0.7223, lr_0 = 1.0000e-04
Validation rmse = 1.064496
Model 0 best validation rmse = 1.034019 on epoch 19
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.042489
Ensemble test rmse = 1.042489
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1500,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.25_ffn_num_layers_1_hidden_size_1500/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total scaffolds = 195 | train scaffolds = 80 | val scaffolds = 54 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1500, bias=False)
      (W_h): Linear(in_features=1500, out_features=1500, bias=False)
      (W_o): Linear(in_features=1633, out_features=1500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1504, out_features=1, bias=True)
  )
)
Number of parameters = 4,923,005
Moving model to cuda
Epoch 0
Loss = 1.5886e-02, PNorm = 57.7722, GNorm = 7.6494, lr_0 = 3.6053e-04
Validation rmse = 1.645401
Epoch 1
Loss = 6.7670e-03, PNorm = 57.8359, GNorm = 6.2577, lr_0 = 6.2105e-04
Loss = 6.3882e-03, PNorm = 57.9103, GNorm = 3.4457, lr_0 = 8.5789e-04
Validation rmse = 1.284017
Epoch 2
Loss = 3.5552e-03, PNorm = 57.9999, GNorm = 1.7304, lr_0 = 9.8284e-04
Loss = 4.3832e-03, PNorm = 58.0760, GNorm = 1.6734, lr_0 = 9.4120e-04
Validation rmse = 1.246362
Epoch 3
Loss = 3.3930e-03, PNorm = 58.1404, GNorm = 1.7923, lr_0 = 8.9744e-04
Loss = 3.2447e-03, PNorm = 58.1883, GNorm = 4.0880, lr_0 = 8.5943e-04
Validation rmse = 1.269389
Epoch 4
Loss = 2.6979e-03, PNorm = 58.2337, GNorm = 1.5655, lr_0 = 8.2303e-04
Loss = 3.8599e-03, PNorm = 58.2825, GNorm = 0.9043, lr_0 = 7.8816e-04
Validation rmse = 1.449746
Epoch 5
Loss = 3.6919e-03, PNorm = 58.3251, GNorm = 3.2290, lr_0 = 7.5478e-04
Loss = 2.8530e-03, PNorm = 58.3637, GNorm = 1.9406, lr_0 = 7.2281e-04
Validation rmse = 1.233747
Epoch 6
Loss = 2.3708e-03, PNorm = 58.4005, GNorm = 1.0568, lr_0 = 6.8920e-04
Loss = 2.4521e-03, PNorm = 58.4302, GNorm = 2.3586, lr_0 = 6.6001e-04
Validation rmse = 1.153817
Epoch 7
Loss = 1.7633e-03, PNorm = 58.4599, GNorm = 1.1884, lr_0 = 6.3205e-04
Loss = 1.7358e-03, PNorm = 58.4862, GNorm = 0.7848, lr_0 = 6.0528e-04
Validation rmse = 1.162807
Epoch 8
Loss = 2.2381e-03, PNorm = 58.5173, GNorm = 1.1283, lr_0 = 5.7714e-04
Loss = 1.7756e-03, PNorm = 58.5437, GNorm = 1.0599, lr_0 = 5.5269e-04
Validation rmse = 1.377224
Epoch 9
Loss = 1.8135e-03, PNorm = 58.5665, GNorm = 1.4365, lr_0 = 5.2928e-04
Loss = 1.6621e-03, PNorm = 58.5872, GNorm = 1.0505, lr_0 = 5.0686e-04
Validation rmse = 1.142303
Epoch 10
Loss = 2.0784e-03, PNorm = 58.6102, GNorm = 0.7103, lr_0 = 4.8539e-04
Loss = 1.6620e-03, PNorm = 58.6311, GNorm = 1.5886, lr_0 = 4.6483e-04
Validation rmse = 1.158038
Epoch 11
Loss = 1.3084e-03, PNorm = 58.6520, GNorm = 2.0867, lr_0 = 4.4322e-04
Loss = 1.9366e-03, PNorm = 58.6714, GNorm = 1.3464, lr_0 = 4.2444e-04
Validation rmse = 1.080803
Epoch 12
Loss = 1.4305e-03, PNorm = 58.6896, GNorm = 2.4748, lr_0 = 4.0646e-04
Loss = 1.3011e-03, PNorm = 58.7089, GNorm = 0.8404, lr_0 = 3.8925e-04
Validation rmse = 1.139366
Epoch 13
Loss = 1.2041e-03, PNorm = 58.7231, GNorm = 0.5348, lr_0 = 3.7276e-04
Loss = 1.2273e-03, PNorm = 58.7354, GNorm = 0.3158, lr_0 = 3.5697e-04
Validation rmse = 1.084646
Epoch 14
Loss = 1.4231e-03, PNorm = 58.7500, GNorm = 2.9556, lr_0 = 3.4037e-04
Loss = 1.3386e-03, PNorm = 58.7622, GNorm = 0.6876, lr_0 = 3.2596e-04
Validation rmse = 1.067626
Epoch 15
Loss = 1.4473e-03, PNorm = 58.7754, GNorm = 1.1672, lr_0 = 3.1215e-04
Loss = 1.2951e-03, PNorm = 58.7885, GNorm = 1.0407, lr_0 = 2.9893e-04
Validation rmse = 1.057032
Epoch 16
Loss = 1.2199e-03, PNorm = 58.8038, GNorm = 1.0891, lr_0 = 2.8503e-04
Loss = 1.3252e-03, PNorm = 58.8186, GNorm = 1.0357, lr_0 = 2.7295e-04
Validation rmse = 1.086266
Epoch 17
Loss = 9.1317e-04, PNorm = 58.8299, GNorm = 0.6828, lr_0 = 2.6139e-04
Loss = 1.2369e-03, PNorm = 58.8392, GNorm = 0.5354, lr_0 = 2.5032e-04
Validation rmse = 1.194241
Epoch 18
Loss = 1.1201e-03, PNorm = 58.8502, GNorm = 2.0975, lr_0 = 2.3972e-04
Loss = 1.2683e-03, PNorm = 58.8589, GNorm = 0.7381, lr_0 = 2.2956e-04
Validation rmse = 1.087381
Epoch 19
Loss = 1.1956e-03, PNorm = 58.8712, GNorm = 0.9060, lr_0 = 2.1889e-04
Loss = 1.0678e-03, PNorm = 58.8795, GNorm = 0.4369, lr_0 = 2.0962e-04
Validation rmse = 1.100181
Epoch 20
Loss = 1.1649e-03, PNorm = 58.8854, GNorm = 1.4188, lr_0 = 2.0074e-04
Loss = 1.1947e-03, PNorm = 58.8938, GNorm = 0.7540, lr_0 = 1.9224e-04
Validation rmse = 1.099644
Epoch 21
Loss = 1.0185e-03, PNorm = 58.9028, GNorm = 0.3854, lr_0 = 1.8409e-04
Loss = 1.1455e-03, PNorm = 58.9094, GNorm = 1.2280, lr_0 = 1.7630e-04
Validation rmse = 1.079741
Epoch 22
Loss = 1.1128e-03, PNorm = 58.9175, GNorm = 0.5373, lr_0 = 1.6810e-04
Loss = 9.2620e-04, PNorm = 58.9249, GNorm = 0.6352, lr_0 = 1.6098e-04
Validation rmse = 1.081072
Epoch 23
Loss = 9.0983e-04, PNorm = 58.9303, GNorm = 0.3157, lr_0 = 1.5416e-04
Loss = 1.0500e-03, PNorm = 58.9367, GNorm = 0.7269, lr_0 = 1.4763e-04
Loss = 1.1702e-03, PNorm = 58.9374, GNorm = 0.5675, lr_0 = 1.4699e-04
Validation rmse = 1.059685
Epoch 24
Loss = 9.6583e-04, PNorm = 58.9435, GNorm = 0.5596, lr_0 = 1.4077e-04
Loss = 1.0136e-03, PNorm = 58.9499, GNorm = 0.5013, lr_0 = 1.3480e-04
Validation rmse = 1.102855
Epoch 25
Loss = 9.5815e-04, PNorm = 58.9549, GNorm = 1.2869, lr_0 = 1.2909e-04
Loss = 9.6428e-04, PNorm = 58.9596, GNorm = 0.7464, lr_0 = 1.2362e-04
Validation rmse = 1.070604
Epoch 26
Loss = 1.0535e-03, PNorm = 58.9639, GNorm = 1.3141, lr_0 = 1.1839e-04
Validation rmse = 1.103207
Epoch 27
Loss = 1.2862e-03, PNorm = 58.9696, GNorm = 0.4121, lr_0 = 1.1288e-04
Loss = 9.3457e-04, PNorm = 58.9755, GNorm = 0.4339, lr_0 = 1.0810e-04
Validation rmse = 1.088372
Epoch 28
Loss = 8.7964e-04, PNorm = 58.9789, GNorm = 0.6542, lr_0 = 1.0352e-04
Loss = 8.2221e-04, PNorm = 58.9824, GNorm = 0.6792, lr_0 = 1.0000e-04
Validation rmse = 1.102372
Epoch 29
Loss = 9.0277e-04, PNorm = 58.9866, GNorm = 0.3835, lr_0 = 1.0000e-04
Loss = 8.3393e-04, PNorm = 58.9908, GNorm = 0.6507, lr_0 = 1.0000e-04
Validation rmse = 1.090917
Model 0 best validation rmse = 1.057032 on epoch 15
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.065690
Ensemble test rmse = 1.065690
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1500,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.25_ffn_num_layers_1_hidden_size_1500/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 49 | test scaffolds = 62
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1500, bias=False)
      (W_h): Linear(in_features=1500, out_features=1500, bias=False)
      (W_o): Linear(in_features=1633, out_features=1500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1504, out_features=1, bias=True)
  )
)
Number of parameters = 4,923,005
Moving model to cuda
Epoch 0
Loss = 1.8493e-02, PNorm = 57.7690, GNorm = 3.9386, lr_0 = 3.6053e-04
Validation rmse = 1.432697
Epoch 1
Loss = 1.0080e-02, PNorm = 57.8355, GNorm = 5.4536, lr_0 = 6.2105e-04
Loss = 6.5282e-03, PNorm = 57.9172, GNorm = 1.7666, lr_0 = 8.5789e-04
Validation rmse = 1.413600
Epoch 2
Loss = 6.3503e-03, PNorm = 58.0107, GNorm = 4.7686, lr_0 = 9.8284e-04
Loss = 6.6683e-03, PNorm = 58.0949, GNorm = 0.7440, lr_0 = 9.4120e-04
Validation rmse = 1.357418
Epoch 3
Loss = 6.0192e-03, PNorm = 58.1735, GNorm = 4.4578, lr_0 = 8.9744e-04
Loss = 4.1424e-03, PNorm = 58.2290, GNorm = 1.8929, lr_0 = 8.5943e-04
Validation rmse = 1.198327
Epoch 4
Loss = 3.3354e-03, PNorm = 58.2742, GNorm = 1.4040, lr_0 = 8.2303e-04
Loss = 2.9003e-03, PNorm = 58.3156, GNorm = 2.5077, lr_0 = 7.8816e-04
Validation rmse = 1.170018
Epoch 5
Loss = 3.1934e-03, PNorm = 58.3518, GNorm = 2.7398, lr_0 = 7.5478e-04
Loss = 3.0552e-03, PNorm = 58.3890, GNorm = 1.2114, lr_0 = 7.2281e-04
Validation rmse = 1.147539
Epoch 6
Loss = 2.5935e-03, PNorm = 58.4283, GNorm = 1.5685, lr_0 = 6.8920e-04
Loss = 2.6028e-03, PNorm = 58.4606, GNorm = 1.1722, lr_0 = 6.6001e-04
Validation rmse = 1.163622
Epoch 7
Loss = 1.5430e-03, PNorm = 58.4924, GNorm = 1.1106, lr_0 = 6.3205e-04
Loss = 2.6149e-03, PNorm = 58.5247, GNorm = 0.8475, lr_0 = 6.0528e-04
Validation rmse = 1.385591
Epoch 8
Loss = 2.1465e-03, PNorm = 58.5527, GNorm = 0.7327, lr_0 = 5.7714e-04
Loss = 2.0920e-03, PNorm = 58.5747, GNorm = 0.6429, lr_0 = 5.5269e-04
Validation rmse = 0.954880
Epoch 9
Loss = 1.8605e-03, PNorm = 58.5982, GNorm = 0.9068, lr_0 = 5.2928e-04
Loss = 2.1406e-03, PNorm = 58.6182, GNorm = 0.5755, lr_0 = 5.0686e-04
Validation rmse = 0.996672
Epoch 10
Loss = 1.8398e-03, PNorm = 58.6357, GNorm = 1.9178, lr_0 = 4.8539e-04
Loss = 2.1937e-03, PNorm = 58.6557, GNorm = 1.2666, lr_0 = 4.6483e-04
Validation rmse = 1.002041
Epoch 11
Loss = 2.1100e-03, PNorm = 58.6761, GNorm = 1.2270, lr_0 = 4.4322e-04
Loss = 1.5813e-03, PNorm = 58.6938, GNorm = 1.5381, lr_0 = 4.2444e-04
Validation rmse = 0.982826
Epoch 12
Loss = 1.3875e-03, PNorm = 58.7070, GNorm = 1.5283, lr_0 = 4.0646e-04
Loss = 1.5856e-03, PNorm = 58.7197, GNorm = 0.5736, lr_0 = 3.8925e-04
Validation rmse = 1.016163
Epoch 13
Loss = 1.4700e-03, PNorm = 58.7327, GNorm = 1.5425, lr_0 = 3.7276e-04
Loss = 2.0030e-03, PNorm = 58.7473, GNorm = 2.6685, lr_0 = 3.5697e-04
Validation rmse = 1.121050
Epoch 14
Loss = 1.2543e-03, PNorm = 58.7606, GNorm = 0.4701, lr_0 = 3.4037e-04
Loss = 1.6309e-03, PNorm = 58.7712, GNorm = 1.3449, lr_0 = 3.2596e-04
Validation rmse = 0.908581
Epoch 15
Loss = 1.2480e-03, PNorm = 58.7814, GNorm = 0.3981, lr_0 = 3.1215e-04
Loss = 1.6775e-03, PNorm = 58.7908, GNorm = 0.7744, lr_0 = 2.9893e-04
Validation rmse = 0.962538
Epoch 16
Loss = 1.2896e-03, PNorm = 58.8018, GNorm = 1.1187, lr_0 = 2.8503e-04
Loss = 1.7662e-03, PNorm = 58.8110, GNorm = 0.4418, lr_0 = 2.7295e-04
Validation rmse = 0.918042
Epoch 17
Loss = 1.2930e-03, PNorm = 58.8211, GNorm = 0.4493, lr_0 = 2.6139e-04
Loss = 1.4632e-03, PNorm = 58.8276, GNorm = 0.3898, lr_0 = 2.5032e-04
Validation rmse = 0.908750
Epoch 18
Loss = 1.5479e-03, PNorm = 58.8370, GNorm = 0.8708, lr_0 = 2.3972e-04
Loss = 1.3743e-03, PNorm = 58.8464, GNorm = 1.4945, lr_0 = 2.2956e-04
Validation rmse = 0.915103
Epoch 19
Loss = 1.3724e-03, PNorm = 58.8538, GNorm = 0.7698, lr_0 = 2.1889e-04
Loss = 1.4065e-03, PNorm = 58.8619, GNorm = 1.1779, lr_0 = 2.0962e-04
Validation rmse = 1.006891
Epoch 20
Loss = 1.4074e-03, PNorm = 58.8688, GNorm = 0.9817, lr_0 = 2.0074e-04
Loss = 1.3712e-03, PNorm = 58.8749, GNorm = 1.9660, lr_0 = 1.9224e-04
Validation rmse = 1.008487
Epoch 21
Loss = 1.1473e-03, PNorm = 58.8816, GNorm = 1.1075, lr_0 = 1.8409e-04
Loss = 1.3668e-03, PNorm = 58.8891, GNorm = 1.2845, lr_0 = 1.7630e-04
Validation rmse = 0.916303
Epoch 22
Loss = 1.0116e-03, PNorm = 58.8964, GNorm = 0.5893, lr_0 = 1.6810e-04
Loss = 1.3070e-03, PNorm = 58.9021, GNorm = 0.4566, lr_0 = 1.6098e-04
Validation rmse = 0.948581
Epoch 23
Loss = 1.2952e-03, PNorm = 58.9071, GNorm = 0.6031, lr_0 = 1.5416e-04
Loss = 1.0790e-03, PNorm = 58.9122, GNorm = 0.8974, lr_0 = 1.4763e-04
Loss = 1.9770e-03, PNorm = 58.9128, GNorm = 0.4340, lr_0 = 1.4699e-04
Validation rmse = 0.900351
Epoch 24
Loss = 1.1246e-03, PNorm = 58.9181, GNorm = 0.4904, lr_0 = 1.4077e-04
Loss = 1.2331e-03, PNorm = 58.9228, GNorm = 0.7568, lr_0 = 1.3480e-04
Validation rmse = 1.022032
Epoch 25
Loss = 1.0223e-03, PNorm = 58.9270, GNorm = 0.8055, lr_0 = 1.2909e-04
Loss = 1.4470e-03, PNorm = 58.9305, GNorm = 1.3652, lr_0 = 1.2362e-04
Validation rmse = 0.930933
Epoch 26
Loss = 1.0795e-03, PNorm = 58.9353, GNorm = 0.6025, lr_0 = 1.1839e-04
Validation rmse = 0.900545
Epoch 27
Loss = 1.0359e-03, PNorm = 58.9410, GNorm = 0.6924, lr_0 = 1.1288e-04
Loss = 9.8547e-04, PNorm = 58.9436, GNorm = 0.7694, lr_0 = 1.0810e-04
Validation rmse = 0.870545
Epoch 28
Loss = 6.0490e-04, PNorm = 58.9476, GNorm = 0.9203, lr_0 = 1.0352e-04
Loss = 1.1787e-03, PNorm = 58.9513, GNorm = 0.5847, lr_0 = 1.0000e-04
Validation rmse = 0.970541
Epoch 29
Loss = 7.7977e-04, PNorm = 58.9558, GNorm = 0.7619, lr_0 = 1.0000e-04
Loss = 1.0863e-03, PNorm = 58.9603, GNorm = 0.9897, lr_0 = 1.0000e-04
Validation rmse = 0.904649
Model 0 best validation rmse = 0.870545 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.076682
Ensemble test rmse = 1.076682
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1500,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.25_ffn_num_layers_1_hidden_size_1500/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total scaffolds = 195 | train scaffolds = 94 | val scaffolds = 55 | test scaffolds = 46
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1500, bias=False)
      (W_h): Linear(in_features=1500, out_features=1500, bias=False)
      (W_o): Linear(in_features=1633, out_features=1500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1504, out_features=1, bias=True)
  )
)
Number of parameters = 4,923,005
Moving model to cuda
Epoch 0
Loss = 1.7093e-02, PNorm = 57.7712, GNorm = 11.4756, lr_0 = 3.6053e-04
Validation rmse = 1.760937
Epoch 1
Loss = 6.5584e-03, PNorm = 57.8364, GNorm = 3.4493, lr_0 = 6.2105e-04
Loss = 7.0376e-03, PNorm = 57.9221, GNorm = 4.6103, lr_0 = 8.5789e-04
Validation rmse = 1.910441
Epoch 2
Loss = 6.8799e-03, PNorm = 58.0228, GNorm = 2.2619, lr_0 = 9.8284e-04
Loss = 5.5194e-03, PNorm = 58.1087, GNorm = 1.4586, lr_0 = 9.4120e-04
Validation rmse = 1.573201
Epoch 3
Loss = 4.6690e-03, PNorm = 58.1786, GNorm = 2.9222, lr_0 = 8.9744e-04
Loss = 4.0217e-03, PNorm = 58.2304, GNorm = 1.9366, lr_0 = 8.5943e-04
Validation rmse = 1.434762
Epoch 4
Loss = 2.5465e-03, PNorm = 58.2747, GNorm = 1.2507, lr_0 = 8.2303e-04
Loss = 3.1624e-03, PNorm = 58.3188, GNorm = 2.7812, lr_0 = 7.8816e-04
Validation rmse = 1.366321
Epoch 5
Loss = 2.4623e-03, PNorm = 58.3582, GNorm = 1.2180, lr_0 = 7.5478e-04
Loss = 2.8090e-03, PNorm = 58.3966, GNorm = 1.7839, lr_0 = 7.2281e-04
Validation rmse = 1.333277
Epoch 6
Loss = 2.7151e-03, PNorm = 58.4342, GNorm = 1.2040, lr_0 = 6.8920e-04
Loss = 2.2600e-03, PNorm = 58.4736, GNorm = 0.6738, lr_0 = 6.6001e-04
Validation rmse = 1.353891
Epoch 7
Loss = 2.2121e-03, PNorm = 58.5006, GNorm = 0.9133, lr_0 = 6.3205e-04
Loss = 1.9563e-03, PNorm = 58.5363, GNorm = 0.8622, lr_0 = 6.0528e-04
Validation rmse = 1.258799
Epoch 8
Loss = 1.9931e-03, PNorm = 58.5664, GNorm = 1.2869, lr_0 = 5.7714e-04
Loss = 2.2827e-03, PNorm = 58.5989, GNorm = 0.8701, lr_0 = 5.5269e-04
Validation rmse = 1.284716
Epoch 9
Loss = 2.1926e-03, PNorm = 58.6256, GNorm = 1.3449, lr_0 = 5.2928e-04
Loss = 1.8673e-03, PNorm = 58.6526, GNorm = 0.5740, lr_0 = 5.0686e-04
Validation rmse = 1.232699
Epoch 10
Loss = 1.9193e-03, PNorm = 58.6740, GNorm = 0.5542, lr_0 = 4.8539e-04
Loss = 1.8132e-03, PNorm = 58.6949, GNorm = 1.8229, lr_0 = 4.6483e-04
Validation rmse = 1.156919
Epoch 11
Loss = 1.5631e-03, PNorm = 58.7200, GNorm = 1.3403, lr_0 = 4.4322e-04
Loss = 1.7196e-03, PNorm = 58.7402, GNorm = 1.6114, lr_0 = 4.2444e-04
Validation rmse = 1.222100
Epoch 12
Loss = 1.1868e-03, PNorm = 58.7592, GNorm = 0.9014, lr_0 = 4.0646e-04
Loss = 1.6836e-03, PNorm = 58.7790, GNorm = 0.8576, lr_0 = 3.8925e-04
Validation rmse = 1.177793
Epoch 13
Loss = 1.3265e-03, PNorm = 58.7952, GNorm = 1.1913, lr_0 = 3.7276e-04
Loss = 1.4935e-03, PNorm = 58.8069, GNorm = 0.8180, lr_0 = 3.5697e-04
Validation rmse = 1.194208
Epoch 14
Loss = 1.8210e-03, PNorm = 58.8263, GNorm = 0.6784, lr_0 = 3.4037e-04
Loss = 1.2874e-03, PNorm = 58.8426, GNorm = 0.5838, lr_0 = 3.2596e-04
Validation rmse = 1.116011
Epoch 15
Loss = 1.4435e-03, PNorm = 58.8587, GNorm = 0.7923, lr_0 = 3.1215e-04
Loss = 1.4514e-03, PNorm = 58.8718, GNorm = 1.2045, lr_0 = 2.9893e-04
Validation rmse = 1.094506
Epoch 16
Loss = 1.4248e-03, PNorm = 58.8839, GNorm = 0.8722, lr_0 = 2.8503e-04
Loss = 1.5415e-03, PNorm = 58.8973, GNorm = 0.6839, lr_0 = 2.7295e-04
Validation rmse = 1.174981
Epoch 17
Loss = 1.4017e-03, PNorm = 58.9106, GNorm = 0.7173, lr_0 = 2.6139e-04
Loss = 1.2501e-03, PNorm = 58.9207, GNorm = 0.4834, lr_0 = 2.5032e-04
Validation rmse = 1.137981
Epoch 18
Loss = 1.1774e-03, PNorm = 58.9322, GNorm = 0.8779, lr_0 = 2.3972e-04
Loss = 1.2015e-03, PNorm = 58.9434, GNorm = 0.4975, lr_0 = 2.2956e-04
Validation rmse = 1.122581
Epoch 19
Loss = 1.0698e-03, PNorm = 58.9519, GNorm = 0.9419, lr_0 = 2.1889e-04
Loss = 1.3402e-03, PNorm = 58.9623, GNorm = 0.6088, lr_0 = 2.0962e-04
Validation rmse = 1.159414
Epoch 20
Loss = 1.2628e-03, PNorm = 58.9718, GNorm = 0.7544, lr_0 = 2.0074e-04
Loss = 1.2488e-03, PNorm = 58.9805, GNorm = 0.7983, lr_0 = 1.9224e-04
Validation rmse = 1.109416
Epoch 21
Loss = 1.2135e-03, PNorm = 58.9905, GNorm = 1.0555, lr_0 = 1.8409e-04
Loss = 1.1491e-03, PNorm = 58.9986, GNorm = 0.4753, lr_0 = 1.7630e-04
Validation rmse = 1.111606
Epoch 22
Loss = 9.7178e-04, PNorm = 59.0060, GNorm = 0.6573, lr_0 = 1.6810e-04
Loss = 1.3602e-03, PNorm = 59.0130, GNorm = 0.4646, lr_0 = 1.6098e-04
Validation rmse = 1.076689
Epoch 23
Loss = 1.3375e-03, PNorm = 59.0218, GNorm = 1.5237, lr_0 = 1.5416e-04
Loss = 1.0315e-03, PNorm = 59.0286, GNorm = 0.5047, lr_0 = 1.4763e-04
Loss = 7.5381e-04, PNorm = 59.0291, GNorm = 0.4027, lr_0 = 1.4699e-04
Validation rmse = 1.156290
Epoch 24
Loss = 1.0910e-03, PNorm = 59.0356, GNorm = 1.1264, lr_0 = 1.4077e-04
Loss = 1.1441e-03, PNorm = 59.0419, GNorm = 1.0010, lr_0 = 1.3480e-04
Validation rmse = 1.126704
Epoch 25
Loss = 1.0451e-03, PNorm = 59.0470, GNorm = 0.8575, lr_0 = 1.2909e-04
Loss = 1.2357e-03, PNorm = 59.0521, GNorm = 1.6542, lr_0 = 1.2362e-04
Validation rmse = 1.094723
Epoch 26
Loss = 1.0620e-03, PNorm = 59.0582, GNorm = 1.1997, lr_0 = 1.1839e-04
Validation rmse = 1.072871
Epoch 27
Loss = 1.3080e-03, PNorm = 59.0642, GNorm = 0.6813, lr_0 = 1.1288e-04
Loss = 1.0021e-03, PNorm = 59.0692, GNorm = 0.7779, lr_0 = 1.0810e-04
Validation rmse = 1.049621
Epoch 28
Loss = 9.8118e-04, PNorm = 59.0749, GNorm = 0.4957, lr_0 = 1.0352e-04
Loss = 1.1130e-03, PNorm = 59.0802, GNorm = 1.7463, lr_0 = 1.0000e-04
Validation rmse = 1.055903
Epoch 29
Loss = 8.9696e-04, PNorm = 59.0845, GNorm = 0.3677, lr_0 = 1.0000e-04
Loss = 9.8622e-04, PNorm = 59.0891, GNorm = 0.3386, lr_0 = 1.0000e-04
Validation rmse = 1.084559
Model 0 best validation rmse = 1.049621 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.178304
Ensemble test rmse = 1.178304
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1500,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.25_ffn_num_layers_1_hidden_size_1500/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total scaffolds = 195 | train scaffolds = 64 | val scaffolds = 68 | test scaffolds = 63
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1500, bias=False)
      (W_h): Linear(in_features=1500, out_features=1500, bias=False)
      (W_o): Linear(in_features=1633, out_features=1500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1504, out_features=1, bias=True)
  )
)
Number of parameters = 4,923,005
Moving model to cuda
Epoch 0
Loss = 1.9325e-02, PNorm = 57.7707, GNorm = 6.4877, lr_0 = 3.6053e-04
Validation rmse = 1.746564
Epoch 1
Loss = 6.6139e-03, PNorm = 57.8376, GNorm = 2.7597, lr_0 = 6.2105e-04
Loss = 7.0490e-03, PNorm = 57.9209, GNorm = 4.7500, lr_0 = 8.5789e-04
Validation rmse = 1.641491
Epoch 2
Loss = 6.0320e-03, PNorm = 58.0037, GNorm = 1.7758, lr_0 = 9.8284e-04
Loss = 5.4610e-03, PNorm = 58.0773, GNorm = 2.1275, lr_0 = 9.4120e-04
Validation rmse = 1.324492
Epoch 3
Loss = 3.2425e-03, PNorm = 58.1359, GNorm = 1.3416, lr_0 = 8.9744e-04
Loss = 3.3376e-03, PNorm = 58.1822, GNorm = 3.7754, lr_0 = 8.5943e-04
Validation rmse = 1.457419
Epoch 4
Loss = 3.6774e-03, PNorm = 58.2235, GNorm = 2.5332, lr_0 = 8.2303e-04
Loss = 4.1327e-03, PNorm = 58.2761, GNorm = 2.6532, lr_0 = 7.8816e-04
Validation rmse = 1.333182
Epoch 5
Loss = 3.9430e-03, PNorm = 58.3182, GNorm = 3.0988, lr_0 = 7.5478e-04
Loss = 2.9872e-03, PNorm = 58.3574, GNorm = 1.3271, lr_0 = 7.2281e-04
Validation rmse = 1.655226
Epoch 6
Loss = 3.2619e-03, PNorm = 58.3944, GNorm = 1.4281, lr_0 = 6.8920e-04
Loss = 2.9203e-03, PNorm = 58.4386, GNorm = 0.8475, lr_0 = 6.6001e-04
Validation rmse = 1.161729
Epoch 7
Loss = 2.1760e-03, PNorm = 58.4711, GNorm = 0.7504, lr_0 = 6.3205e-04
Loss = 2.0337e-03, PNorm = 58.5018, GNorm = 0.9868, lr_0 = 6.0528e-04
Validation rmse = 1.156134
Epoch 8
Loss = 1.6621e-03, PNorm = 58.5325, GNorm = 0.4373, lr_0 = 5.7714e-04
Loss = 1.9254e-03, PNorm = 58.5559, GNorm = 0.4513, lr_0 = 5.5269e-04
Validation rmse = 1.227566
Epoch 9
Loss = 1.8280e-03, PNorm = 58.5802, GNorm = 1.9268, lr_0 = 5.2928e-04
Loss = 1.7114e-03, PNorm = 58.6034, GNorm = 0.9152, lr_0 = 5.0686e-04
Validation rmse = 1.166839
Epoch 10
Loss = 1.8901e-03, PNorm = 58.6306, GNorm = 1.1477, lr_0 = 4.8539e-04
Loss = 1.5082e-03, PNorm = 58.6533, GNorm = 0.4441, lr_0 = 4.6483e-04
Validation rmse = 1.051345
Epoch 11
Loss = 1.7619e-03, PNorm = 58.6731, GNorm = 0.9017, lr_0 = 4.4322e-04
Loss = 1.4199e-03, PNorm = 58.6913, GNorm = 1.2323, lr_0 = 4.2444e-04
Validation rmse = 1.084406
Epoch 12
Loss = 1.3416e-03, PNorm = 58.7094, GNorm = 0.6746, lr_0 = 4.0646e-04
Loss = 1.5775e-03, PNorm = 58.7251, GNorm = 1.3403, lr_0 = 3.8925e-04
Validation rmse = 1.076593
Epoch 13
Loss = 1.2893e-03, PNorm = 58.7428, GNorm = 0.5641, lr_0 = 3.7276e-04
Loss = 1.5444e-03, PNorm = 58.7612, GNorm = 0.8848, lr_0 = 3.5697e-04
Validation rmse = 1.206941
Epoch 14
Loss = 1.1824e-03, PNorm = 58.7765, GNorm = 1.4270, lr_0 = 3.4037e-04
Loss = 1.4579e-03, PNorm = 58.7913, GNorm = 0.4923, lr_0 = 3.2596e-04
Validation rmse = 1.031910
Epoch 15
Loss = 1.2626e-03, PNorm = 58.8055, GNorm = 1.1369, lr_0 = 3.1215e-04
Loss = 1.4442e-03, PNorm = 58.8207, GNorm = 1.3815, lr_0 = 2.9893e-04
Validation rmse = 1.155328
Epoch 16
Loss = 1.3453e-03, PNorm = 58.8368, GNorm = 1.7664, lr_0 = 2.8503e-04
Loss = 1.3171e-03, PNorm = 58.8482, GNorm = 2.3262, lr_0 = 2.7295e-04
Validation rmse = 1.186550
Epoch 17
Loss = 1.3525e-03, PNorm = 58.8611, GNorm = 0.5137, lr_0 = 2.6139e-04
Loss = 1.2165e-03, PNorm = 58.8699, GNorm = 0.8984, lr_0 = 2.5032e-04
Validation rmse = 1.155550
Epoch 18
Loss = 1.5607e-03, PNorm = 58.8844, GNorm = 1.9951, lr_0 = 2.3972e-04
Loss = 1.3805e-03, PNorm = 58.8961, GNorm = 1.0286, lr_0 = 2.2956e-04
Validation rmse = 1.101070
Epoch 19
Loss = 1.1075e-03, PNorm = 58.9095, GNorm = 0.5490, lr_0 = 2.1889e-04
Loss = 1.1566e-03, PNorm = 58.9197, GNorm = 0.5360, lr_0 = 2.0962e-04
Validation rmse = 1.082234
Epoch 20
Loss = 1.0906e-03, PNorm = 58.9264, GNorm = 0.5440, lr_0 = 2.0074e-04
Loss = 1.0313e-03, PNorm = 58.9344, GNorm = 0.8588, lr_0 = 1.9224e-04
Validation rmse = 1.168090
Epoch 21
Loss = 1.1601e-03, PNorm = 58.9438, GNorm = 1.0048, lr_0 = 1.8409e-04
Loss = 1.1435e-03, PNorm = 58.9514, GNorm = 1.1370, lr_0 = 1.7630e-04
Validation rmse = 1.093006
Epoch 22
Loss = 1.1793e-03, PNorm = 58.9580, GNorm = 0.6283, lr_0 = 1.6810e-04
Loss = 1.0845e-03, PNorm = 58.9644, GNorm = 1.0264, lr_0 = 1.6098e-04
Validation rmse = 1.047595
Epoch 23
Loss = 1.0841e-03, PNorm = 58.9725, GNorm = 0.2957, lr_0 = 1.5416e-04
Loss = 9.8198e-04, PNorm = 58.9776, GNorm = 0.2999, lr_0 = 1.4763e-04
Loss = 2.3449e-03, PNorm = 58.9781, GNorm = 0.9206, lr_0 = 1.4699e-04
Validation rmse = 1.050706
Epoch 24
Loss = 1.0624e-03, PNorm = 58.9840, GNorm = 0.8939, lr_0 = 1.4077e-04
Loss = 1.0170e-03, PNorm = 58.9902, GNorm = 0.7270, lr_0 = 1.3480e-04
Validation rmse = 1.057945
Epoch 25
Loss = 9.4705e-04, PNorm = 58.9955, GNorm = 0.8742, lr_0 = 1.2909e-04
Loss = 1.0333e-03, PNorm = 59.0010, GNorm = 1.0109, lr_0 = 1.2362e-04
Validation rmse = 1.020433
Epoch 26
Loss = 9.1786e-04, PNorm = 59.0058, GNorm = 0.5383, lr_0 = 1.1839e-04
Validation rmse = 1.040875
Epoch 27
Loss = 1.0338e-03, PNorm = 59.0121, GNorm = 0.9148, lr_0 = 1.1288e-04
Loss = 8.5168e-04, PNorm = 59.0158, GNorm = 0.4426, lr_0 = 1.0810e-04
Validation rmse = 1.029864
Epoch 28
Loss = 1.0001e-03, PNorm = 59.0208, GNorm = 1.3711, lr_0 = 1.0352e-04
Loss = 9.3874e-04, PNorm = 59.0248, GNorm = 1.0766, lr_0 = 1.0000e-04
Validation rmse = 1.099453
Epoch 29
Loss = 9.0491e-04, PNorm = 59.0295, GNorm = 1.2815, lr_0 = 1.0000e-04
Loss = 9.9367e-04, PNorm = 59.0342, GNorm = 0.7745, lr_0 = 1.0000e-04
Validation rmse = 1.040111
Model 0 best validation rmse = 1.020433 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.960598
Ensemble test rmse = 0.960598
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1500,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.25_ffn_num_layers_1_hidden_size_1500/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total scaffolds = 195 | train scaffolds = 69 | val scaffolds = 65 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1500, bias=False)
      (W_h): Linear(in_features=1500, out_features=1500, bias=False)
      (W_o): Linear(in_features=1633, out_features=1500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1504, out_features=1, bias=True)
  )
)
Number of parameters = 4,923,005
Moving model to cuda
Epoch 0
Loss = 1.7877e-02, PNorm = 57.7697, GNorm = 11.0329, lr_0 = 3.6053e-04
Validation rmse = 2.043116
Epoch 1
Loss = 8.7769e-03, PNorm = 57.8339, GNorm = 5.3776, lr_0 = 6.2105e-04
Loss = 6.9184e-03, PNorm = 57.9109, GNorm = 6.9802, lr_0 = 8.5789e-04
Validation rmse = 1.576941
Epoch 2
Loss = 5.8333e-03, PNorm = 58.0004, GNorm = 3.3199, lr_0 = 9.8284e-04
Loss = 5.3894e-03, PNorm = 58.0829, GNorm = 1.7504, lr_0 = 9.4120e-04
Validation rmse = 2.059118
Epoch 3
Loss = 3.6436e-03, PNorm = 58.1530, GNorm = 1.4687, lr_0 = 8.9744e-04
Loss = 3.8257e-03, PNorm = 58.2042, GNorm = 1.9843, lr_0 = 8.5943e-04
Validation rmse = 1.756720
Epoch 4
Loss = 3.8465e-03, PNorm = 58.2465, GNorm = 2.5812, lr_0 = 8.2303e-04
Loss = 3.0570e-03, PNorm = 58.2915, GNorm = 0.9939, lr_0 = 7.8816e-04
Validation rmse = 1.780268
Epoch 5
Loss = 3.2179e-03, PNorm = 58.3347, GNorm = 1.3212, lr_0 = 7.5478e-04
Loss = 2.3508e-03, PNorm = 58.3752, GNorm = 0.4639, lr_0 = 7.2281e-04
Validation rmse = 1.814920
Epoch 6
Loss = 4.6998e-03, PNorm = 58.4160, GNorm = 5.3280, lr_0 = 6.8920e-04
Loss = 3.6837e-03, PNorm = 58.4679, GNorm = 1.8713, lr_0 = 6.6001e-04
Validation rmse = 1.957576
Epoch 7
Loss = 2.9024e-03, PNorm = 58.5090, GNorm = 3.4583, lr_0 = 6.3205e-04
Loss = 3.8524e-03, PNorm = 58.5445, GNorm = 2.1133, lr_0 = 6.0528e-04
Validation rmse = 1.600295
Epoch 8
Loss = 2.8063e-03, PNorm = 58.5831, GNorm = 1.9773, lr_0 = 5.7714e-04
Loss = 2.4900e-03, PNorm = 58.6095, GNorm = 1.8547, lr_0 = 5.5269e-04
Validation rmse = 1.414664
Epoch 9
Loss = 2.1169e-03, PNorm = 58.6355, GNorm = 1.0238, lr_0 = 5.2928e-04
Loss = 1.9027e-03, PNorm = 58.6583, GNorm = 0.8996, lr_0 = 5.0686e-04
Validation rmse = 1.512991
Epoch 10
Loss = 1.8438e-03, PNorm = 58.6731, GNorm = 0.6648, lr_0 = 4.8539e-04
Loss = 1.6859e-03, PNorm = 58.6907, GNorm = 0.5065, lr_0 = 4.6483e-04
Validation rmse = 1.428312
Epoch 11
Loss = 1.4284e-03, PNorm = 58.7091, GNorm = 0.4903, lr_0 = 4.4322e-04
Loss = 1.6045e-03, PNorm = 58.7221, GNorm = 1.4366, lr_0 = 4.2444e-04
Validation rmse = 1.317965
Epoch 12
Loss = 1.5465e-03, PNorm = 58.7367, GNorm = 0.4310, lr_0 = 4.0646e-04
Loss = 1.4903e-03, PNorm = 58.7513, GNorm = 1.3118, lr_0 = 3.8925e-04
Validation rmse = 1.274511
Epoch 13
Loss = 1.6570e-03, PNorm = 58.7661, GNorm = 1.2235, lr_0 = 3.7276e-04
Loss = 1.7793e-03, PNorm = 58.7792, GNorm = 0.8748, lr_0 = 3.5697e-04
Validation rmse = 1.539564
Epoch 14
Loss = 1.4637e-03, PNorm = 58.7935, GNorm = 1.1024, lr_0 = 3.4037e-04
Loss = 1.6306e-03, PNorm = 58.8072, GNorm = 0.3716, lr_0 = 3.2596e-04
Validation rmse = 1.447741
Epoch 15
Loss = 1.2699e-03, PNorm = 58.8172, GNorm = 1.1546, lr_0 = 3.1215e-04
Loss = 1.5505e-03, PNorm = 58.8299, GNorm = 0.6427, lr_0 = 2.9893e-04
Validation rmse = 1.601714
Epoch 16
Loss = 1.4620e-03, PNorm = 58.8451, GNorm = 1.4125, lr_0 = 2.8503e-04
Loss = 1.4723e-03, PNorm = 58.8557, GNorm = 0.3501, lr_0 = 2.7295e-04
Validation rmse = 1.579318
Epoch 17
Loss = 1.3422e-03, PNorm = 58.8674, GNorm = 0.4432, lr_0 = 2.6139e-04
Loss = 1.4731e-03, PNorm = 58.8763, GNorm = 0.4653, lr_0 = 2.5032e-04
Validation rmse = 1.412751
Epoch 18
Loss = 1.2183e-03, PNorm = 58.8855, GNorm = 1.4980, lr_0 = 2.3972e-04
Loss = 1.3519e-03, PNorm = 58.8949, GNorm = 0.5304, lr_0 = 2.2956e-04
Validation rmse = 1.433569
Epoch 19
Loss = 1.3846e-03, PNorm = 58.9037, GNorm = 1.0012, lr_0 = 2.1889e-04
Loss = 1.0887e-03, PNorm = 58.9121, GNorm = 0.4079, lr_0 = 2.0962e-04
Validation rmse = 1.334683
Epoch 20
Loss = 1.4866e-03, PNorm = 58.9192, GNorm = 0.5059, lr_0 = 2.0074e-04
Loss = 1.0707e-03, PNorm = 58.9275, GNorm = 0.5093, lr_0 = 1.9224e-04
Validation rmse = 1.393495
Epoch 21
Loss = 1.3024e-03, PNorm = 58.9334, GNorm = 1.3699, lr_0 = 1.8409e-04
Loss = 1.3403e-03, PNorm = 58.9413, GNorm = 0.5817, lr_0 = 1.7630e-04
Validation rmse = 1.559939
Epoch 22
Loss = 1.2579e-03, PNorm = 58.9481, GNorm = 1.7402, lr_0 = 1.6810e-04
Loss = 1.2910e-03, PNorm = 58.9561, GNorm = 0.7450, lr_0 = 1.6098e-04
Validation rmse = 1.433031
Epoch 23
Loss = 1.2231e-03, PNorm = 58.9629, GNorm = 0.3261, lr_0 = 1.5416e-04
Loss = 1.1821e-03, PNorm = 58.9685, GNorm = 0.4389, lr_0 = 1.4763e-04
Loss = 1.5911e-03, PNorm = 58.9689, GNorm = 1.0470, lr_0 = 1.4699e-04
Validation rmse = 1.368817
Epoch 24
Loss = 1.1473e-03, PNorm = 58.9743, GNorm = 0.4680, lr_0 = 1.4077e-04
Loss = 1.2340e-03, PNorm = 58.9810, GNorm = 0.7786, lr_0 = 1.3480e-04
Validation rmse = 1.330530
Epoch 25
Loss = 1.1379e-03, PNorm = 58.9858, GNorm = 0.5006, lr_0 = 1.2909e-04
Loss = 1.3020e-03, PNorm = 58.9920, GNorm = 1.0260, lr_0 = 1.2362e-04
Validation rmse = 1.421003
Epoch 26
Loss = 1.1102e-03, PNorm = 58.9952, GNorm = 0.6659, lr_0 = 1.1839e-04
Validation rmse = 1.465306
Epoch 27
Loss = 1.2102e-03, PNorm = 58.9990, GNorm = 0.7952, lr_0 = 1.1288e-04
Loss = 1.0417e-03, PNorm = 59.0039, GNorm = 1.8314, lr_0 = 1.0810e-04
Validation rmse = 1.447633
Epoch 28
Loss = 1.0681e-03, PNorm = 59.0076, GNorm = 0.4170, lr_0 = 1.0352e-04
Loss = 1.0449e-03, PNorm = 59.0127, GNorm = 0.9356, lr_0 = 1.0000e-04
Validation rmse = 1.448239
Epoch 29
Loss = 1.2923e-03, PNorm = 59.0170, GNorm = 1.2389, lr_0 = 1.0000e-04
Loss = 9.6595e-04, PNorm = 59.0205, GNorm = 0.5249, lr_0 = 1.0000e-04
Validation rmse = 1.384407
Model 0 best validation rmse = 1.274511 on epoch 12
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.033393
Ensemble test rmse = 1.033393
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1500,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.25_ffn_num_layers_1_hidden_size_1500/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total scaffolds = 195 | train scaffolds = 75 | val scaffolds = 42 | test scaffolds = 78
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1500, bias=False)
      (W_h): Linear(in_features=1500, out_features=1500, bias=False)
      (W_o): Linear(in_features=1633, out_features=1500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1504, out_features=1, bias=True)
  )
)
Number of parameters = 4,923,005
Moving model to cuda
Epoch 0
Loss = 1.4978e-02, PNorm = 57.7706, GNorm = 10.1573, lr_0 = 3.6053e-04
Validation rmse = 1.639776
Epoch 1
Loss = 5.1732e-03, PNorm = 57.8295, GNorm = 2.3426, lr_0 = 6.2105e-04
Loss = 5.8457e-03, PNorm = 57.9022, GNorm = 2.6891, lr_0 = 8.5789e-04
Validation rmse = 1.633206
Epoch 2
Loss = 6.2488e-03, PNorm = 57.9787, GNorm = 5.7222, lr_0 = 9.8284e-04
Loss = 5.4102e-03, PNorm = 58.0545, GNorm = 3.7075, lr_0 = 9.4120e-04
Validation rmse = 1.577376
Epoch 3
Loss = 3.2274e-03, PNorm = 58.1126, GNorm = 0.8338, lr_0 = 8.9744e-04
Loss = 3.3749e-03, PNorm = 58.1546, GNorm = 3.1677, lr_0 = 8.5943e-04
Validation rmse = 1.428258
Epoch 4
Loss = 3.1174e-03, PNorm = 58.1950, GNorm = 2.8883, lr_0 = 8.2303e-04
Loss = 2.8519e-03, PNorm = 58.2322, GNorm = 1.5643, lr_0 = 7.8816e-04
Validation rmse = 1.306029
Epoch 5
Loss = 1.9381e-03, PNorm = 58.2681, GNorm = 1.6005, lr_0 = 7.5478e-04
Loss = 2.2162e-03, PNorm = 58.3047, GNorm = 0.7494, lr_0 = 7.2281e-04
Validation rmse = 1.244476
Epoch 6
Loss = 1.5805e-03, PNorm = 58.3395, GNorm = 1.5596, lr_0 = 6.8920e-04
Loss = 2.2986e-03, PNorm = 58.3682, GNorm = 2.8623, lr_0 = 6.6001e-04
Validation rmse = 1.293989
Epoch 7
Loss = 2.7903e-03, PNorm = 58.4006, GNorm = 4.5202, lr_0 = 6.3205e-04
Loss = 2.2192e-03, PNorm = 58.4321, GNorm = 1.0076, lr_0 = 6.0528e-04
Validation rmse = 1.253533
Epoch 8
Loss = 2.3304e-03, PNorm = 58.4637, GNorm = 1.1175, lr_0 = 5.7714e-04
Loss = 1.8125e-03, PNorm = 58.4878, GNorm = 2.2610, lr_0 = 5.5269e-04
Validation rmse = 1.252675
Epoch 9
Loss = 1.7182e-03, PNorm = 58.5116, GNorm = 2.4744, lr_0 = 5.2928e-04
Loss = 1.7068e-03, PNorm = 58.5343, GNorm = 0.4768, lr_0 = 5.0686e-04
Validation rmse = 1.177776
Epoch 10
Loss = 1.3914e-03, PNorm = 58.5548, GNorm = 0.6290, lr_0 = 4.8539e-04
Loss = 1.6944e-03, PNorm = 58.5743, GNorm = 1.2374, lr_0 = 4.6483e-04
Validation rmse = 1.131111
Epoch 11
Loss = 1.8040e-03, PNorm = 58.5908, GNorm = 2.2127, lr_0 = 4.4322e-04
Loss = 1.5777e-03, PNorm = 58.6050, GNorm = 0.7005, lr_0 = 4.2444e-04
Validation rmse = 1.137665
Epoch 12
Loss = 1.5031e-03, PNorm = 58.6233, GNorm = 1.5557, lr_0 = 4.0646e-04
Loss = 1.5052e-03, PNorm = 58.6406, GNorm = 1.1872, lr_0 = 3.8925e-04
Validation rmse = 1.120879
Epoch 13
Loss = 1.5300e-03, PNorm = 58.6566, GNorm = 1.1527, lr_0 = 3.7276e-04
Loss = 1.3695e-03, PNorm = 58.6722, GNorm = 0.8366, lr_0 = 3.5697e-04
Validation rmse = 1.056396
Epoch 14
Loss = 1.3977e-03, PNorm = 58.6853, GNorm = 0.8230, lr_0 = 3.4037e-04
Loss = 1.4972e-03, PNorm = 58.6990, GNorm = 2.3477, lr_0 = 3.2596e-04
Validation rmse = 1.061897
Epoch 15
Loss = 1.3721e-03, PNorm = 58.7110, GNorm = 2.4541, lr_0 = 3.1215e-04
Loss = 1.5534e-03, PNorm = 58.7234, GNorm = 0.8805, lr_0 = 2.9893e-04
Validation rmse = 1.111804
Epoch 16
Loss = 1.1935e-03, PNorm = 58.7387, GNorm = 0.6179, lr_0 = 2.8503e-04
Loss = 1.3867e-03, PNorm = 58.7507, GNorm = 0.5033, lr_0 = 2.7295e-04
Validation rmse = 1.078768
Epoch 17
Loss = 1.2478e-03, PNorm = 58.7574, GNorm = 0.6412, lr_0 = 2.6139e-04
Loss = 1.4300e-03, PNorm = 58.7694, GNorm = 0.9159, lr_0 = 2.5032e-04
Validation rmse = 1.122031
Epoch 18
Loss = 1.4491e-03, PNorm = 58.7786, GNorm = 0.8115, lr_0 = 2.3972e-04
Loss = 1.2463e-03, PNorm = 58.7866, GNorm = 1.0001, lr_0 = 2.2956e-04
Validation rmse = 1.077179
Epoch 19
Loss = 1.2502e-03, PNorm = 58.7969, GNorm = 0.6670, lr_0 = 2.1889e-04
Loss = 1.1962e-03, PNorm = 58.8041, GNorm = 0.4860, lr_0 = 2.0962e-04
Validation rmse = 1.057507
Epoch 20
Loss = 1.0508e-03, PNorm = 58.8136, GNorm = 0.6305, lr_0 = 2.0074e-04
Loss = 1.3654e-03, PNorm = 58.8209, GNorm = 0.6564, lr_0 = 1.9224e-04
Validation rmse = 1.054860
Epoch 21
Loss = 1.1169e-03, PNorm = 58.8297, GNorm = 1.6051, lr_0 = 1.8409e-04
Loss = 1.3738e-03, PNorm = 58.8379, GNorm = 0.5899, lr_0 = 1.7630e-04
Validation rmse = 1.137579
Epoch 22
Loss = 1.2489e-03, PNorm = 58.8466, GNorm = 0.6372, lr_0 = 1.6810e-04
Loss = 1.1794e-03, PNorm = 58.8530, GNorm = 1.3169, lr_0 = 1.6098e-04
Validation rmse = 1.035893
Epoch 23
Loss = 1.2449e-03, PNorm = 58.8596, GNorm = 1.1876, lr_0 = 1.5416e-04
Loss = 1.1400e-03, PNorm = 58.8649, GNorm = 1.0120, lr_0 = 1.4763e-04
Loss = 1.2952e-03, PNorm = 58.8653, GNorm = 1.6090, lr_0 = 1.4699e-04
Validation rmse = 1.096101
Epoch 24
Loss = 1.0001e-03, PNorm = 58.8696, GNorm = 0.6166, lr_0 = 1.4077e-04
Loss = 1.1280e-03, PNorm = 58.8768, GNorm = 0.6325, lr_0 = 1.3480e-04
Validation rmse = 1.043834
Epoch 25
Loss = 1.1762e-03, PNorm = 58.8807, GNorm = 1.1207, lr_0 = 1.2909e-04
Loss = 1.0894e-03, PNorm = 58.8852, GNorm = 0.7588, lr_0 = 1.2362e-04
Validation rmse = 1.046678
Epoch 26
Loss = 1.2277e-03, PNorm = 58.8900, GNorm = 0.8213, lr_0 = 1.1839e-04
Validation rmse = 1.029090
Epoch 27
Loss = 1.5082e-03, PNorm = 58.8953, GNorm = 1.4669, lr_0 = 1.1288e-04
Loss = 8.5273e-04, PNorm = 58.8995, GNorm = 1.2820, lr_0 = 1.0810e-04
Validation rmse = 1.048009
Epoch 28
Loss = 9.7559e-04, PNorm = 58.9038, GNorm = 0.8795, lr_0 = 1.0352e-04
Loss = 1.0368e-03, PNorm = 58.9075, GNorm = 0.5400, lr_0 = 1.0000e-04
Validation rmse = 1.066035
Epoch 29
Loss = 7.7890e-04, PNorm = 58.9130, GNorm = 0.5033, lr_0 = 1.0000e-04
Loss = 8.4269e-04, PNorm = 58.9164, GNorm = 0.7874, lr_0 = 1.0000e-04
Validation rmse = 1.042348
Model 0 best validation rmse = 1.029090 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.100004
Ensemble test rmse = 1.100004
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1500,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.25_ffn_num_layers_1_hidden_size_1500/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 58 | test scaffolds = 53
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1500, bias=False)
      (W_h): Linear(in_features=1500, out_features=1500, bias=False)
      (W_o): Linear(in_features=1633, out_features=1500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1504, out_features=1, bias=True)
  )
)
Number of parameters = 4,923,005
Moving model to cuda
Epoch 0
Loss = 1.9869e-02, PNorm = 57.7687, GNorm = 6.3775, lr_0 = 3.6053e-04
Validation rmse = 2.042177
Epoch 1
Loss = 1.1365e-02, PNorm = 57.8363, GNorm = 7.5359, lr_0 = 6.2105e-04
Loss = 9.0333e-03, PNorm = 57.9242, GNorm = 6.9932, lr_0 = 8.5789e-04
Validation rmse = 1.516613
Epoch 2
Loss = 7.2424e-03, PNorm = 58.0219, GNorm = 3.0828, lr_0 = 9.8284e-04
Loss = 6.1124e-03, PNorm = 58.0995, GNorm = 2.3773, lr_0 = 9.4120e-04
Validation rmse = 1.540223
Epoch 3
Loss = 5.3081e-03, PNorm = 58.1586, GNorm = 3.2883, lr_0 = 8.9744e-04
Loss = 4.1515e-03, PNorm = 58.2070, GNorm = 1.9042, lr_0 = 8.5943e-04
Validation rmse = 1.200445
Epoch 4
Loss = 3.8406e-03, PNorm = 58.2512, GNorm = 2.6751, lr_0 = 8.2303e-04
Loss = 2.8282e-03, PNorm = 58.2936, GNorm = 1.2740, lr_0 = 7.8816e-04
Validation rmse = 1.205680
Epoch 5
Loss = 2.5004e-03, PNorm = 58.3322, GNorm = 1.3168, lr_0 = 7.5478e-04
Loss = 2.6975e-03, PNorm = 58.3698, GNorm = 0.8059, lr_0 = 7.2281e-04
Validation rmse = 1.157113
Epoch 6
Loss = 2.5859e-03, PNorm = 58.4035, GNorm = 1.4861, lr_0 = 6.8920e-04
Loss = 2.6376e-03, PNorm = 58.4298, GNorm = 2.6735, lr_0 = 6.6001e-04
Validation rmse = 1.184685
Epoch 7
Loss = 2.7427e-03, PNorm = 58.4565, GNorm = 1.5916, lr_0 = 6.3205e-04
Loss = 2.6938e-03, PNorm = 58.4876, GNorm = 2.3531, lr_0 = 6.0528e-04
Validation rmse = 1.161817
Epoch 8
Loss = 1.7077e-03, PNorm = 58.5169, GNorm = 0.7225, lr_0 = 5.7714e-04
Loss = 2.1129e-03, PNorm = 58.5396, GNorm = 2.1775, lr_0 = 5.5269e-04
Validation rmse = 1.288675
Epoch 9
Loss = 2.5430e-03, PNorm = 58.5661, GNorm = 2.8496, lr_0 = 5.2928e-04
Loss = 1.7955e-03, PNorm = 58.5937, GNorm = 1.1203, lr_0 = 5.0686e-04
Validation rmse = 1.063295
Epoch 10
Loss = 1.8662e-03, PNorm = 58.6151, GNorm = 1.9293, lr_0 = 4.8539e-04
Loss = 1.9442e-03, PNorm = 58.6335, GNorm = 1.4938, lr_0 = 4.6483e-04
Validation rmse = 1.061535
Epoch 11
Loss = 1.9245e-03, PNorm = 58.6570, GNorm = 0.6364, lr_0 = 4.4322e-04
Loss = 1.7801e-03, PNorm = 58.6763, GNorm = 0.7612, lr_0 = 4.2444e-04
Validation rmse = 1.043024
Epoch 12
Loss = 1.7679e-03, PNorm = 58.6933, GNorm = 0.8646, lr_0 = 4.0646e-04
Loss = 1.9072e-03, PNorm = 58.7108, GNorm = 1.0463, lr_0 = 3.8925e-04
Validation rmse = 0.990230
Epoch 13
Loss = 1.4101e-03, PNorm = 58.7229, GNorm = 0.7117, lr_0 = 3.7276e-04
Loss = 1.5754e-03, PNorm = 58.7371, GNorm = 1.8477, lr_0 = 3.5697e-04
Validation rmse = 1.084416
Epoch 14
Loss = 1.6379e-03, PNorm = 58.7561, GNorm = 1.3904, lr_0 = 3.4037e-04
Loss = 1.6118e-03, PNorm = 58.7700, GNorm = 0.5081, lr_0 = 3.2596e-04
Validation rmse = 0.960528
Epoch 15
Loss = 1.2656e-03, PNorm = 58.7822, GNorm = 0.7845, lr_0 = 3.1215e-04
Loss = 1.5969e-03, PNorm = 58.7954, GNorm = 1.7326, lr_0 = 2.9893e-04
Validation rmse = 0.987713
Epoch 16
Loss = 1.5665e-03, PNorm = 58.8122, GNorm = 1.3682, lr_0 = 2.8503e-04
Loss = 1.4747e-03, PNorm = 58.8228, GNorm = 0.8267, lr_0 = 2.7295e-04
Validation rmse = 0.999637
Epoch 17
Loss = 1.4142e-03, PNorm = 58.8339, GNorm = 0.6926, lr_0 = 2.6139e-04
Loss = 1.4747e-03, PNorm = 58.8449, GNorm = 1.0582, lr_0 = 2.5032e-04
Validation rmse = 0.936388
Epoch 18
Loss = 1.1758e-03, PNorm = 58.8565, GNorm = 0.3264, lr_0 = 2.3972e-04
Loss = 1.4791e-03, PNorm = 58.8665, GNorm = 0.6224, lr_0 = 2.2956e-04
Validation rmse = 0.930741
Epoch 19
Loss = 1.3849e-03, PNorm = 58.8748, GNorm = 0.9432, lr_0 = 2.1889e-04
Loss = 1.4698e-03, PNorm = 58.8850, GNorm = 0.4275, lr_0 = 2.0962e-04
Validation rmse = 1.035940
Epoch 20
Loss = 1.5406e-03, PNorm = 58.8957, GNorm = 1.1052, lr_0 = 2.0074e-04
Loss = 1.2879e-03, PNorm = 58.9027, GNorm = 0.8892, lr_0 = 1.9224e-04
Validation rmse = 0.932926
Epoch 21
Loss = 1.1292e-03, PNorm = 58.9094, GNorm = 1.3349, lr_0 = 1.8409e-04
Loss = 1.2167e-03, PNorm = 58.9167, GNorm = 0.4889, lr_0 = 1.7630e-04
Validation rmse = 0.970393
Epoch 22
Loss = 1.4053e-03, PNorm = 58.9244, GNorm = 1.4446, lr_0 = 1.6810e-04
Loss = 1.2256e-03, PNorm = 58.9317, GNorm = 1.2874, lr_0 = 1.6098e-04
Validation rmse = 0.939101
Epoch 23
Loss = 1.1284e-03, PNorm = 58.9378, GNorm = 0.7481, lr_0 = 1.5416e-04
Loss = 1.2503e-03, PNorm = 58.9443, GNorm = 0.7354, lr_0 = 1.4763e-04
Loss = 1.4943e-03, PNorm = 58.9451, GNorm = 0.4631, lr_0 = 1.4699e-04
Validation rmse = 0.958535
Epoch 24
Loss = 1.1855e-03, PNorm = 58.9512, GNorm = 0.7692, lr_0 = 1.4077e-04
Loss = 1.2238e-03, PNorm = 58.9560, GNorm = 1.2682, lr_0 = 1.3480e-04
Validation rmse = 0.944320
Epoch 25
Loss = 1.1720e-03, PNorm = 58.9611, GNorm = 0.5678, lr_0 = 1.2909e-04
Loss = 1.1357e-03, PNorm = 58.9659, GNorm = 0.7176, lr_0 = 1.2362e-04
Validation rmse = 0.958832
Epoch 26
Loss = 1.0473e-03, PNorm = 58.9715, GNorm = 0.5103, lr_0 = 1.1839e-04
Validation rmse = 0.944541
Epoch 27
Loss = 1.1537e-03, PNorm = 58.9771, GNorm = 1.6362, lr_0 = 1.1288e-04
Loss = 1.1987e-03, PNorm = 58.9812, GNorm = 1.7567, lr_0 = 1.0810e-04
Validation rmse = 0.928108
Epoch 28
Loss = 1.3666e-03, PNorm = 58.9855, GNorm = 0.4858, lr_0 = 1.0352e-04
Loss = 1.0479e-03, PNorm = 58.9890, GNorm = 1.1367, lr_0 = 1.0000e-04
Validation rmse = 0.936149
Epoch 29
Loss = 1.2819e-03, PNorm = 58.9935, GNorm = 1.0476, lr_0 = 1.0000e-04
Loss = 1.0421e-03, PNorm = 58.9971, GNorm = 0.9167, lr_0 = 1.0000e-04
Validation rmse = 0.928552
Model 0 best validation rmse = 0.928108 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.325339
Ensemble test rmse = 1.325339
10-fold cross validation
	Seed 0 ==> test rmse = 0.890236
	Seed 1 ==> test rmse = 1.005187
	Seed 2 ==> test rmse = 1.042489
	Seed 3 ==> test rmse = 1.065690
	Seed 4 ==> test rmse = 1.076682
	Seed 5 ==> test rmse = 1.178304
	Seed 6 ==> test rmse = 0.960598
	Seed 7 ==> test rmse = 1.033393
	Seed 8 ==> test rmse = 1.100004
	Seed 9 ==> test rmse = 1.325339
Overall test rmse = 1.067792 +/- 0.113324
Elapsed time = 0:06:53
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.35000000000000003_ffn_num_layers_1_hidden_size_1100/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total scaffolds = 195 | train scaffolds = 91 | val scaffolds = 66 | test scaffolds = 38
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003, inplace=False)
    (1): Linear(in_features=1104, out_features=1, bias=True)
  )
)
Number of parameters = 2,730,205
Moving model to cuda
Epoch 0
Loss = 1.9301e-02, PNorm = 50.2373, GNorm = 4.1269, lr_0 = 3.6053e-04
Validation rmse = 1.691129
Epoch 1
Loss = 1.0109e-02, PNorm = 50.2694, GNorm = 3.7770, lr_0 = 6.2105e-04
Loss = 8.8376e-03, PNorm = 50.3203, GNorm = 2.8299, lr_0 = 8.5789e-04
Validation rmse = 1.396499
Epoch 2
Loss = 4.7119e-03, PNorm = 50.3755, GNorm = 1.4800, lr_0 = 9.8284e-04
Loss = 5.6686e-03, PNorm = 50.4148, GNorm = 6.7531, lr_0 = 9.4120e-04
Validation rmse = 1.969253
Epoch 3
Loss = 7.0838e-03, PNorm = 50.4507, GNorm = 5.1002, lr_0 = 8.9744e-04
Loss = 6.1982e-03, PNorm = 50.4865, GNorm = 2.9286, lr_0 = 8.5943e-04
Validation rmse = 1.347784
Epoch 4
Loss = 5.2587e-03, PNorm = 50.5119, GNorm = 3.3105, lr_0 = 8.2303e-04
Loss = 3.3468e-03, PNorm = 50.5327, GNorm = 1.4713, lr_0 = 7.8816e-04
Validation rmse = 1.505256
Epoch 5
Loss = 2.6386e-03, PNorm = 50.5495, GNorm = 1.8712, lr_0 = 7.5478e-04
Loss = 2.9158e-03, PNorm = 50.5639, GNorm = 2.2350, lr_0 = 7.2281e-04
Validation rmse = 1.462714
Epoch 6
Loss = 2.4034e-03, PNorm = 50.5812, GNorm = 0.9878, lr_0 = 6.8920e-04
Loss = 2.5025e-03, PNorm = 50.5949, GNorm = 0.6888, lr_0 = 6.6001e-04
Validation rmse = 1.410629
Epoch 7
Loss = 3.3378e-03, PNorm = 50.6076, GNorm = 4.6534, lr_0 = 6.3205e-04
Loss = 2.5003e-03, PNorm = 50.6228, GNorm = 1.2031, lr_0 = 6.0528e-04
Validation rmse = 1.190967
Epoch 8
Loss = 2.5507e-03, PNorm = 50.6394, GNorm = 1.5690, lr_0 = 5.7714e-04
Loss = 2.1487e-03, PNorm = 50.6525, GNorm = 1.0417, lr_0 = 5.5269e-04
Validation rmse = 1.323030
Epoch 9
Loss = 2.2075e-03, PNorm = 50.6647, GNorm = 4.6603, lr_0 = 5.2928e-04
Loss = 2.3664e-03, PNorm = 50.6803, GNorm = 1.3000, lr_0 = 5.0686e-04
Validation rmse = 1.256096
Epoch 10
Loss = 2.1694e-03, PNorm = 50.6910, GNorm = 2.3260, lr_0 = 4.8539e-04
Loss = 2.3272e-03, PNorm = 50.7039, GNorm = 0.7474, lr_0 = 4.6483e-04
Validation rmse = 1.081284
Epoch 11
Loss = 1.5281e-03, PNorm = 50.7151, GNorm = 0.8605, lr_0 = 4.4322e-04
Loss = 1.9750e-03, PNorm = 50.7230, GNorm = 1.1709, lr_0 = 4.2444e-04
Validation rmse = 1.135392
Epoch 12
Loss = 1.9273e-03, PNorm = 50.7311, GNorm = 0.8050, lr_0 = 4.0646e-04
Loss = 2.1978e-03, PNorm = 50.7388, GNorm = 1.2904, lr_0 = 3.8925e-04
Validation rmse = 1.163231
Epoch 13
Loss = 2.1057e-03, PNorm = 50.7490, GNorm = 0.5394, lr_0 = 3.7276e-04
Loss = 2.3326e-03, PNorm = 50.7585, GNorm = 2.1445, lr_0 = 3.5697e-04
Validation rmse = 1.265362
Epoch 14
Loss = 1.9901e-03, PNorm = 50.7681, GNorm = 2.1842, lr_0 = 3.4037e-04
Loss = 1.9128e-03, PNorm = 50.7766, GNorm = 1.8589, lr_0 = 3.2596e-04
Validation rmse = 1.079145
Epoch 15
Loss = 1.4070e-03, PNorm = 50.7822, GNorm = 0.8664, lr_0 = 3.1215e-04
Loss = 1.5847e-03, PNorm = 50.7868, GNorm = 1.6178, lr_0 = 2.9893e-04
Validation rmse = 1.117537
Epoch 16
Loss = 1.6531e-03, PNorm = 50.7916, GNorm = 1.8036, lr_0 = 2.8503e-04
Loss = 1.6277e-03, PNorm = 50.7971, GNorm = 0.5829, lr_0 = 2.7295e-04
Validation rmse = 1.095197
Epoch 17
Loss = 1.4452e-03, PNorm = 50.8015, GNorm = 1.4452, lr_0 = 2.6139e-04
Loss = 1.5882e-03, PNorm = 50.8068, GNorm = 0.9820, lr_0 = 2.5032e-04
Validation rmse = 1.065093
Epoch 18
Loss = 1.2356e-03, PNorm = 50.8099, GNorm = 0.9202, lr_0 = 2.3972e-04
Loss = 1.5376e-03, PNorm = 50.8136, GNorm = 1.1382, lr_0 = 2.2956e-04
Validation rmse = 1.034234
Epoch 19
Loss = 1.3911e-03, PNorm = 50.8183, GNorm = 0.9156, lr_0 = 2.1889e-04
Loss = 1.6488e-03, PNorm = 50.8207, GNorm = 0.8741, lr_0 = 2.0962e-04
Validation rmse = 1.035542
Epoch 20
Loss = 1.4321e-03, PNorm = 50.8253, GNorm = 0.8487, lr_0 = 2.0074e-04
Loss = 1.6195e-03, PNorm = 50.8275, GNorm = 2.4759, lr_0 = 1.9224e-04
Validation rmse = 1.043544
Epoch 21
Loss = 1.5060e-03, PNorm = 50.8316, GNorm = 1.3252, lr_0 = 1.8409e-04
Loss = 1.5091e-03, PNorm = 50.8354, GNorm = 0.6181, lr_0 = 1.7630e-04
Validation rmse = 1.010708
Epoch 22
Loss = 1.3394e-03, PNorm = 50.8406, GNorm = 1.6672, lr_0 = 1.6810e-04
Loss = 1.6143e-03, PNorm = 50.8424, GNorm = 0.7418, lr_0 = 1.6098e-04
Validation rmse = 1.036494
Epoch 23
Loss = 1.4599e-03, PNorm = 50.8457, GNorm = 1.0394, lr_0 = 1.5416e-04
Loss = 1.2656e-03, PNorm = 50.8481, GNorm = 0.9481, lr_0 = 1.4763e-04
Loss = 2.3793e-03, PNorm = 50.8484, GNorm = 1.8346, lr_0 = 1.4699e-04
Validation rmse = 1.000800
Epoch 24
Loss = 1.3604e-03, PNorm = 50.8508, GNorm = 1.5697, lr_0 = 1.4077e-04
Loss = 1.3349e-03, PNorm = 50.8531, GNorm = 0.5342, lr_0 = 1.3480e-04
Validation rmse = 1.037682
Epoch 25
Loss = 1.3542e-03, PNorm = 50.8548, GNorm = 0.9506, lr_0 = 1.2909e-04
Loss = 1.3245e-03, PNorm = 50.8570, GNorm = 0.8298, lr_0 = 1.2362e-04
Validation rmse = 1.048031
Epoch 26
Loss = 1.3759e-03, PNorm = 50.8585, GNorm = 2.1312, lr_0 = 1.1839e-04
Validation rmse = 1.044912
Epoch 27
Loss = 1.0072e-03, PNorm = 50.8610, GNorm = 1.8561, lr_0 = 1.1288e-04
Loss = 1.2680e-03, PNorm = 50.8628, GNorm = 0.8055, lr_0 = 1.0810e-04
Validation rmse = 1.015495
Epoch 28
Loss = 1.7611e-03, PNorm = 50.8644, GNorm = 0.7141, lr_0 = 1.0352e-04
Loss = 1.2820e-03, PNorm = 50.8667, GNorm = 0.5631, lr_0 = 1.0000e-04
Validation rmse = 1.065191
Epoch 29
Loss = 1.5262e-03, PNorm = 50.8688, GNorm = 1.5859, lr_0 = 1.0000e-04
Loss = 1.4314e-03, PNorm = 50.8708, GNorm = 0.6341, lr_0 = 1.0000e-04
Validation rmse = 1.047666
Model 0 best validation rmse = 1.000800 on epoch 23
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.983831
Ensemble test rmse = 0.983831
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.35000000000000003_ffn_num_layers_1_hidden_size_1100/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total scaffolds = 195 | train scaffolds = 76 | val scaffolds = 60 | test scaffolds = 59
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003, inplace=False)
    (1): Linear(in_features=1104, out_features=1, bias=True)
  )
)
Number of parameters = 2,730,205
Moving model to cuda
Epoch 0
Loss = 1.8412e-02, PNorm = 50.2378, GNorm = 11.5289, lr_0 = 3.6053e-04
Validation rmse = 1.751332
Epoch 1
Loss = 1.1045e-02, PNorm = 50.2697, GNorm = 3.5836, lr_0 = 6.2105e-04
Loss = 9.0132e-03, PNorm = 50.3189, GNorm = 9.0015, lr_0 = 8.5789e-04
Validation rmse = 1.715896
Epoch 2
Loss = 1.0464e-02, PNorm = 50.3770, GNorm = 5.3115, lr_0 = 9.8284e-04
Loss = 5.9577e-03, PNorm = 50.4255, GNorm = 3.7993, lr_0 = 9.4120e-04
Validation rmse = 1.695585
Epoch 3
Loss = 5.0855e-03, PNorm = 50.4603, GNorm = 1.0400, lr_0 = 8.9744e-04
Loss = 4.9318e-03, PNorm = 50.4858, GNorm = 4.6047, lr_0 = 8.5943e-04
Validation rmse = 1.403943
Epoch 4
Loss = 3.2231e-03, PNorm = 50.5068, GNorm = 1.2578, lr_0 = 8.2303e-04
Loss = 3.6269e-03, PNorm = 50.5278, GNorm = 0.9120, lr_0 = 7.8816e-04
Validation rmse = 1.407892
Epoch 5
Loss = 3.4500e-03, PNorm = 50.5458, GNorm = 2.2186, lr_0 = 7.5478e-04
Loss = 3.1621e-03, PNorm = 50.5646, GNorm = 1.7799, lr_0 = 7.2281e-04
Validation rmse = 1.374732
Epoch 6
Loss = 3.1663e-03, PNorm = 50.5818, GNorm = 1.2635, lr_0 = 6.8920e-04
Loss = 2.8250e-03, PNorm = 50.6023, GNorm = 1.6128, lr_0 = 6.6001e-04
Validation rmse = 1.633442
Epoch 7
Loss = 3.2894e-03, PNorm = 50.6175, GNorm = 1.7567, lr_0 = 6.3205e-04
Loss = 3.0030e-03, PNorm = 50.6329, GNorm = 2.9546, lr_0 = 6.0528e-04
Validation rmse = 1.287231
Epoch 8
Loss = 2.5477e-03, PNorm = 50.6499, GNorm = 1.6989, lr_0 = 5.7714e-04
Loss = 2.1813e-03, PNorm = 50.6648, GNorm = 1.5399, lr_0 = 5.5269e-04
Validation rmse = 1.306738
Epoch 9
Loss = 1.8761e-03, PNorm = 50.6779, GNorm = 1.2029, lr_0 = 5.2928e-04
Loss = 1.9887e-03, PNorm = 50.6876, GNorm = 0.6683, lr_0 = 5.0686e-04
Validation rmse = 1.202608
Epoch 10
Loss = 1.9187e-03, PNorm = 50.6975, GNorm = 1.0753, lr_0 = 4.8539e-04
Loss = 1.6590e-03, PNorm = 50.7065, GNorm = 1.2171, lr_0 = 4.6483e-04
Validation rmse = 1.054032
Epoch 11
Loss = 2.1711e-03, PNorm = 50.7175, GNorm = 2.9790, lr_0 = 4.4322e-04
Loss = 2.1071e-03, PNorm = 50.7262, GNorm = 3.8352, lr_0 = 4.2444e-04
Validation rmse = 1.228194
Epoch 12
Loss = 1.5777e-03, PNorm = 50.7358, GNorm = 0.6308, lr_0 = 4.0646e-04
Loss = 1.9855e-03, PNorm = 50.7436, GNorm = 2.3925, lr_0 = 3.8925e-04
Validation rmse = 1.258335
Epoch 13
Loss = 2.2754e-03, PNorm = 50.7511, GNorm = 1.1927, lr_0 = 3.7276e-04
Loss = 1.7652e-03, PNorm = 50.7582, GNorm = 1.1753, lr_0 = 3.5697e-04
Validation rmse = 1.203049
Epoch 14
Loss = 1.5966e-03, PNorm = 50.7667, GNorm = 2.1384, lr_0 = 3.4037e-04
Loss = 1.9159e-03, PNorm = 50.7733, GNorm = 1.2814, lr_0 = 3.2596e-04
Validation rmse = 1.220311
Epoch 15
Loss = 1.9525e-03, PNorm = 50.7779, GNorm = 0.8680, lr_0 = 3.1215e-04
Loss = 1.5310e-03, PNorm = 50.7850, GNorm = 1.1709, lr_0 = 2.9893e-04
Validation rmse = 1.097209
Epoch 16
Loss = 1.2577e-03, PNorm = 50.7902, GNorm = 1.1019, lr_0 = 2.8503e-04
Loss = 1.6025e-03, PNorm = 50.7944, GNorm = 1.2622, lr_0 = 2.7295e-04
Validation rmse = 1.161378
Epoch 17
Loss = 1.4856e-03, PNorm = 50.7996, GNorm = 1.8530, lr_0 = 2.6139e-04
Loss = 1.5213e-03, PNorm = 50.8035, GNorm = 1.0878, lr_0 = 2.5032e-04
Validation rmse = 1.103291
Epoch 18
Loss = 1.6324e-03, PNorm = 50.8077, GNorm = 1.5016, lr_0 = 2.3972e-04
Loss = 1.5100e-03, PNorm = 50.8111, GNorm = 2.5792, lr_0 = 2.2956e-04
Validation rmse = 1.211859
Epoch 19
Loss = 1.2693e-03, PNorm = 50.8149, GNorm = 2.6849, lr_0 = 2.1889e-04
Loss = 1.6830e-03, PNorm = 50.8178, GNorm = 0.7968, lr_0 = 2.0962e-04
Validation rmse = 1.163971
Epoch 20
Loss = 1.2679e-03, PNorm = 50.8213, GNorm = 0.6606, lr_0 = 2.0074e-04
Loss = 1.6112e-03, PNorm = 50.8253, GNorm = 0.5877, lr_0 = 1.9224e-04
Validation rmse = 1.254698
Epoch 21
Loss = 1.4357e-03, PNorm = 50.8285, GNorm = 1.7701, lr_0 = 1.8409e-04
Loss = 1.5226e-03, PNorm = 50.8311, GNorm = 1.3484, lr_0 = 1.7630e-04
Validation rmse = 1.218014
Epoch 22
Loss = 1.4057e-03, PNorm = 50.8342, GNorm = 1.5662, lr_0 = 1.6810e-04
Loss = 1.3407e-03, PNorm = 50.8364, GNorm = 2.3875, lr_0 = 1.6098e-04
Validation rmse = 1.124017
Epoch 23
Loss = 1.3728e-03, PNorm = 50.8394, GNorm = 0.7172, lr_0 = 1.5416e-04
Loss = 1.4050e-03, PNorm = 50.8412, GNorm = 1.1499, lr_0 = 1.4763e-04
Loss = 1.4410e-03, PNorm = 50.8415, GNorm = 1.2890, lr_0 = 1.4699e-04
Validation rmse = 1.109633
Epoch 24
Loss = 1.6148e-03, PNorm = 50.8445, GNorm = 1.3455, lr_0 = 1.4077e-04
Loss = 1.3014e-03, PNorm = 50.8465, GNorm = 1.6314, lr_0 = 1.3480e-04
Validation rmse = 1.230849
Epoch 25
Loss = 1.3049e-03, PNorm = 50.8495, GNorm = 1.2977, lr_0 = 1.2909e-04
Loss = 1.4110e-03, PNorm = 50.8513, GNorm = 1.2451, lr_0 = 1.2362e-04
Validation rmse = 1.144437
Epoch 26
Loss = 1.1833e-03, PNorm = 50.8540, GNorm = 1.0940, lr_0 = 1.1839e-04
Validation rmse = 1.278458
Epoch 27
Loss = 1.7600e-03, PNorm = 50.8556, GNorm = 2.6799, lr_0 = 1.1288e-04
Loss = 1.3223e-03, PNorm = 50.8579, GNorm = 1.7067, lr_0 = 1.0810e-04
Validation rmse = 1.198503
Epoch 28
Loss = 1.0730e-03, PNorm = 50.8594, GNorm = 0.4796, lr_0 = 1.0352e-04
Loss = 1.3771e-03, PNorm = 50.8617, GNorm = 0.7953, lr_0 = 1.0000e-04
Validation rmse = 1.191966
Epoch 29
Loss = 9.7372e-04, PNorm = 50.8635, GNorm = 0.6205, lr_0 = 1.0000e-04
Loss = 1.4400e-03, PNorm = 50.8665, GNorm = 1.8276, lr_0 = 1.0000e-04
Validation rmse = 1.185032
Model 0 best validation rmse = 1.054032 on epoch 10
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.128564
Ensemble test rmse = 1.128564
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.35000000000000003_ffn_num_layers_1_hidden_size_1100/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total scaffolds = 195 | train scaffolds = 55 | val scaffolds = 64 | test scaffolds = 76
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003, inplace=False)
    (1): Linear(in_features=1104, out_features=1, bias=True)
  )
)
Number of parameters = 2,730,205
Moving model to cuda
Epoch 0
Loss = 1.5682e-02, PNorm = 50.2416, GNorm = 9.8934, lr_0 = 3.6053e-04
Validation rmse = 1.591599
Epoch 1
Loss = 5.9644e-03, PNorm = 50.2792, GNorm = 2.4220, lr_0 = 6.2105e-04
Loss = 8.5006e-03, PNorm = 50.3297, GNorm = 3.8761, lr_0 = 8.5789e-04
Validation rmse = 1.404879
Epoch 2
Loss = 6.6707e-03, PNorm = 50.3875, GNorm = 2.4162, lr_0 = 9.8284e-04
Loss = 5.6452e-03, PNorm = 50.4363, GNorm = 3.9491, lr_0 = 9.4120e-04
Validation rmse = 1.471606
Epoch 3
Loss = 4.4883e-03, PNorm = 50.4763, GNorm = 2.4889, lr_0 = 8.9744e-04
Loss = 4.0347e-03, PNorm = 50.5039, GNorm = 3.6915, lr_0 = 8.5943e-04
Validation rmse = 1.326334
Epoch 4
Loss = 3.4590e-03, PNorm = 50.5297, GNorm = 2.0432, lr_0 = 8.2303e-04
Loss = 4.6098e-03, PNorm = 50.5624, GNorm = 3.4530, lr_0 = 7.8816e-04
Validation rmse = 1.500762
Epoch 5
Loss = 3.5399e-03, PNorm = 50.5881, GNorm = 1.6664, lr_0 = 7.5478e-04
Loss = 3.0346e-03, PNorm = 50.6075, GNorm = 1.7454, lr_0 = 7.2281e-04
Validation rmse = 1.287999
Epoch 6
Loss = 2.5177e-03, PNorm = 50.6296, GNorm = 0.8918, lr_0 = 6.8920e-04
Loss = 2.5659e-03, PNorm = 50.6489, GNorm = 1.2160, lr_0 = 6.6001e-04
Validation rmse = 1.332286
Epoch 7
Loss = 3.1937e-03, PNorm = 50.6657, GNorm = 3.5309, lr_0 = 6.3205e-04
Loss = 2.2884e-03, PNorm = 50.6813, GNorm = 1.2020, lr_0 = 6.0528e-04
Validation rmse = 1.225525
Epoch 8
Loss = 3.0547e-03, PNorm = 50.6999, GNorm = 1.7476, lr_0 = 5.7714e-04
Loss = 2.4610e-03, PNorm = 50.7187, GNorm = 0.8305, lr_0 = 5.5269e-04
Validation rmse = 1.282695
Epoch 9
Loss = 1.9558e-03, PNorm = 50.7337, GNorm = 1.7471, lr_0 = 5.2928e-04
Loss = 2.0489e-03, PNorm = 50.7480, GNorm = 1.1445, lr_0 = 5.0686e-04
Validation rmse = 1.231473
Epoch 10
Loss = 2.0378e-03, PNorm = 50.7589, GNorm = 2.4095, lr_0 = 4.8539e-04
Loss = 2.0656e-03, PNorm = 50.7718, GNorm = 1.7870, lr_0 = 4.6483e-04
Validation rmse = 1.213106
Epoch 11
Loss = 2.2868e-03, PNorm = 50.7842, GNorm = 1.1864, lr_0 = 4.4322e-04
Loss = 2.4436e-03, PNorm = 50.7956, GNorm = 2.1678, lr_0 = 4.2444e-04
Validation rmse = 1.240660
Epoch 12
Loss = 2.1264e-03, PNorm = 50.8088, GNorm = 1.1742, lr_0 = 4.0646e-04
Loss = 1.7692e-03, PNorm = 50.8186, GNorm = 1.6338, lr_0 = 3.8925e-04
Validation rmse = 1.336948
Epoch 13
Loss = 2.3818e-03, PNorm = 50.8291, GNorm = 1.2461, lr_0 = 3.7276e-04
Loss = 1.9819e-03, PNorm = 50.8379, GNorm = 1.2931, lr_0 = 3.5697e-04
Validation rmse = 1.258207
Epoch 14
Loss = 1.9490e-03, PNorm = 50.8475, GNorm = 1.4067, lr_0 = 3.4037e-04
Loss = 1.8320e-03, PNorm = 50.8541, GNorm = 2.0189, lr_0 = 3.2596e-04
Validation rmse = 1.165215
Epoch 15
Loss = 1.7744e-03, PNorm = 50.8626, GNorm = 1.7510, lr_0 = 3.1215e-04
Loss = 1.6874e-03, PNorm = 50.8690, GNorm = 1.1647, lr_0 = 2.9893e-04
Validation rmse = 1.197793
Epoch 16
Loss = 1.6323e-03, PNorm = 50.8759, GNorm = 1.5242, lr_0 = 2.8503e-04
Loss = 1.8648e-03, PNorm = 50.8819, GNorm = 2.1419, lr_0 = 2.7295e-04
Validation rmse = 1.211132
Epoch 17
Loss = 1.6285e-03, PNorm = 50.8884, GNorm = 2.8255, lr_0 = 2.6139e-04
Loss = 1.6394e-03, PNorm = 50.8940, GNorm = 3.6274, lr_0 = 2.5032e-04
Validation rmse = 1.156036
Epoch 18
Loss = 1.8009e-03, PNorm = 50.9014, GNorm = 1.3885, lr_0 = 2.3972e-04
Loss = 1.7161e-03, PNorm = 50.9064, GNorm = 1.1254, lr_0 = 2.2956e-04
Validation rmse = 1.137634
Epoch 19
Loss = 1.9982e-03, PNorm = 50.9109, GNorm = 2.0114, lr_0 = 2.1889e-04
Loss = 1.5368e-03, PNorm = 50.9172, GNorm = 1.0086, lr_0 = 2.0962e-04
Validation rmse = 1.161209
Epoch 20
Loss = 1.4055e-03, PNorm = 50.9202, GNorm = 0.8511, lr_0 = 2.0074e-04
Loss = 1.5730e-03, PNorm = 50.9242, GNorm = 1.0823, lr_0 = 1.9224e-04
Validation rmse = 1.183925
Epoch 21
Loss = 1.5851e-03, PNorm = 50.9270, GNorm = 1.3527, lr_0 = 1.8409e-04
Loss = 1.6131e-03, PNorm = 50.9307, GNorm = 1.2605, lr_0 = 1.7630e-04
Validation rmse = 1.135499
Epoch 22
Loss = 1.5296e-03, PNorm = 50.9345, GNorm = 0.7691, lr_0 = 1.6810e-04
Loss = 1.3164e-03, PNorm = 50.9379, GNorm = 0.5959, lr_0 = 1.6098e-04
Validation rmse = 1.157520
Epoch 23
Loss = 1.1974e-03, PNorm = 50.9409, GNorm = 2.1795, lr_0 = 1.5416e-04
Loss = 1.5742e-03, PNorm = 50.9438, GNorm = 1.6694, lr_0 = 1.4763e-04
Loss = 3.6210e-03, PNorm = 50.9440, GNorm = 1.9759, lr_0 = 1.4699e-04
Validation rmse = 1.237396
Epoch 24
Loss = 1.3826e-03, PNorm = 50.9464, GNorm = 2.5083, lr_0 = 1.4077e-04
Loss = 1.5813e-03, PNorm = 50.9482, GNorm = 0.8339, lr_0 = 1.3480e-04
Validation rmse = 1.116813
Epoch 25
Loss = 1.7183e-03, PNorm = 50.9504, GNorm = 0.5224, lr_0 = 1.2909e-04
Loss = 1.1404e-03, PNorm = 50.9524, GNorm = 1.7641, lr_0 = 1.2362e-04
Validation rmse = 1.167209
Epoch 26
Loss = 1.3244e-03, PNorm = 50.9551, GNorm = 0.7297, lr_0 = 1.1839e-04
Validation rmse = 1.180572
Epoch 27
Loss = 9.0059e-04, PNorm = 50.9575, GNorm = 0.6311, lr_0 = 1.1288e-04
Loss = 1.2840e-03, PNorm = 50.9595, GNorm = 1.4614, lr_0 = 1.0810e-04
Validation rmse = 1.143855
Epoch 28
Loss = 1.1705e-03, PNorm = 50.9613, GNorm = 1.6315, lr_0 = 1.0352e-04
Loss = 1.2980e-03, PNorm = 50.9639, GNorm = 0.9501, lr_0 = 1.0000e-04
Validation rmse = 1.140597
Epoch 29
Loss = 1.5389e-03, PNorm = 50.9659, GNorm = 1.3023, lr_0 = 1.0000e-04
Loss = 1.4025e-03, PNorm = 50.9675, GNorm = 1.4605, lr_0 = 1.0000e-04
Validation rmse = 1.164174
Model 0 best validation rmse = 1.116813 on epoch 24
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.092923
Ensemble test rmse = 1.092923
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.35000000000000003_ffn_num_layers_1_hidden_size_1100/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total scaffolds = 195 | train scaffolds = 80 | val scaffolds = 54 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003, inplace=False)
    (1): Linear(in_features=1104, out_features=1, bias=True)
  )
)
Number of parameters = 2,730,205
Moving model to cuda
Epoch 0
Loss = 2.1773e-02, PNorm = 50.2379, GNorm = 27.0640, lr_0 = 3.6053e-04
Validation rmse = 1.842282
Epoch 1
Loss = 1.6131e-02, PNorm = 50.2706, GNorm = 8.9024, lr_0 = 6.2105e-04
Loss = 1.1484e-02, PNorm = 50.3255, GNorm = 6.5956, lr_0 = 8.5789e-04
Validation rmse = 1.739103
Epoch 2
Loss = 7.9561e-03, PNorm = 50.3790, GNorm = 2.2791, lr_0 = 9.8284e-04
Loss = 6.1510e-03, PNorm = 50.4167, GNorm = 3.5221, lr_0 = 9.4120e-04
Validation rmse = 1.543125
Epoch 3
Loss = 5.3194e-03, PNorm = 50.4509, GNorm = 1.6485, lr_0 = 8.9744e-04
Loss = 4.9008e-03, PNorm = 50.4707, GNorm = 1.6277, lr_0 = 8.5943e-04
Validation rmse = 1.395598
Epoch 4
Loss = 2.7904e-03, PNorm = 50.4938, GNorm = 1.1660, lr_0 = 8.2303e-04
Loss = 4.1183e-03, PNorm = 50.5156, GNorm = 2.2614, lr_0 = 7.8816e-04
Validation rmse = 1.385415
Epoch 5
Loss = 4.9713e-03, PNorm = 50.5338, GNorm = 4.6253, lr_0 = 7.5478e-04
Loss = 3.3418e-03, PNorm = 50.5560, GNorm = 0.7576, lr_0 = 7.2281e-04
Validation rmse = 1.451187
Epoch 6
Loss = 3.0169e-03, PNorm = 50.5773, GNorm = 1.0141, lr_0 = 6.8920e-04
Loss = 2.9188e-03, PNorm = 50.5912, GNorm = 2.4353, lr_0 = 6.6001e-04
Validation rmse = 1.353204
Epoch 7
Loss = 1.7911e-03, PNorm = 50.6059, GNorm = 0.8863, lr_0 = 6.3205e-04
Loss = 2.0854e-03, PNorm = 50.6157, GNorm = 1.0874, lr_0 = 6.0528e-04
Validation rmse = 1.221187
Epoch 8
Loss = 2.4822e-03, PNorm = 50.6300, GNorm = 1.1683, lr_0 = 5.7714e-04
Loss = 2.0344e-03, PNorm = 50.6436, GNorm = 2.1606, lr_0 = 5.5269e-04
Validation rmse = 1.344073
Epoch 9
Loss = 2.1578e-03, PNorm = 50.6541, GNorm = 1.1754, lr_0 = 5.2928e-04
Loss = 2.1462e-03, PNorm = 50.6655, GNorm = 1.8664, lr_0 = 5.0686e-04
Validation rmse = 1.229668
Epoch 10
Loss = 1.9245e-03, PNorm = 50.6775, GNorm = 1.8442, lr_0 = 4.8539e-04
Loss = 1.9116e-03, PNorm = 50.6884, GNorm = 1.1524, lr_0 = 4.6483e-04
Validation rmse = 1.206676
Epoch 11
Loss = 1.8043e-03, PNorm = 50.7003, GNorm = 2.0544, lr_0 = 4.4322e-04
Loss = 2.1239e-03, PNorm = 50.7096, GNorm = 0.8556, lr_0 = 4.2444e-04
Validation rmse = 1.094894
Epoch 12
Loss = 2.0456e-03, PNorm = 50.7209, GNorm = 4.8205, lr_0 = 4.0646e-04
Loss = 1.6881e-03, PNorm = 50.7308, GNorm = 1.3028, lr_0 = 3.8925e-04
Validation rmse = 1.324681
Epoch 13
Loss = 1.5033e-03, PNorm = 50.7392, GNorm = 1.7163, lr_0 = 3.7276e-04
Loss = 1.6181e-03, PNorm = 50.7456, GNorm = 1.6883, lr_0 = 3.5697e-04
Validation rmse = 1.135237
Epoch 14
Loss = 1.8683e-03, PNorm = 50.7520, GNorm = 4.5972, lr_0 = 3.4037e-04
Loss = 1.6954e-03, PNorm = 50.7590, GNorm = 0.9186, lr_0 = 3.2596e-04
Validation rmse = 1.179493
Epoch 15
Loss = 1.8173e-03, PNorm = 50.7675, GNorm = 3.2587, lr_0 = 3.1215e-04
Loss = 1.8174e-03, PNorm = 50.7729, GNorm = 2.3505, lr_0 = 2.9893e-04
Validation rmse = 1.237007
Epoch 16
Loss = 1.7926e-03, PNorm = 50.7802, GNorm = 1.6685, lr_0 = 2.8503e-04
Loss = 1.7942e-03, PNorm = 50.7881, GNorm = 0.5214, lr_0 = 2.7295e-04
Validation rmse = 1.077616
Epoch 17
Loss = 1.3376e-03, PNorm = 50.7926, GNorm = 1.1324, lr_0 = 2.6139e-04
Loss = 1.5571e-03, PNorm = 50.7985, GNorm = 0.8135, lr_0 = 2.5032e-04
Validation rmse = 1.170389
Epoch 18
Loss = 1.4309e-03, PNorm = 50.8021, GNorm = 1.1604, lr_0 = 2.3972e-04
Loss = 1.4138e-03, PNorm = 50.8061, GNorm = 0.6426, lr_0 = 2.2956e-04
Validation rmse = 1.104158
Epoch 19
Loss = 1.6426e-03, PNorm = 50.8105, GNorm = 1.3416, lr_0 = 2.1889e-04
Loss = 1.3831e-03, PNorm = 50.8157, GNorm = 0.8176, lr_0 = 2.0962e-04
Validation rmse = 1.122553
Epoch 20
Loss = 1.2279e-03, PNorm = 50.8167, GNorm = 0.6664, lr_0 = 2.0074e-04
Loss = 1.3814e-03, PNorm = 50.8201, GNorm = 1.4311, lr_0 = 1.9224e-04
Validation rmse = 1.156901
Epoch 21
Loss = 1.1886e-03, PNorm = 50.8232, GNorm = 0.5540, lr_0 = 1.8409e-04
Loss = 1.2947e-03, PNorm = 50.8264, GNorm = 1.4413, lr_0 = 1.7630e-04
Validation rmse = 1.169079
Epoch 22
Loss = 1.3954e-03, PNorm = 50.8292, GNorm = 1.4062, lr_0 = 1.6810e-04
Loss = 1.2958e-03, PNorm = 50.8330, GNorm = 1.3757, lr_0 = 1.6098e-04
Validation rmse = 1.180489
Epoch 23
Loss = 1.2107e-03, PNorm = 50.8347, GNorm = 1.1114, lr_0 = 1.5416e-04
Loss = 1.2896e-03, PNorm = 50.8379, GNorm = 1.9238, lr_0 = 1.4763e-04
Loss = 2.1526e-03, PNorm = 50.8381, GNorm = 1.4822, lr_0 = 1.4699e-04
Validation rmse = 1.146271
Epoch 24
Loss = 1.2284e-03, PNorm = 50.8397, GNorm = 0.6730, lr_0 = 1.4077e-04
Loss = 1.3036e-03, PNorm = 50.8423, GNorm = 1.3079, lr_0 = 1.3480e-04
Validation rmse = 1.136338
Epoch 25
Loss = 1.1764e-03, PNorm = 50.8441, GNorm = 0.6987, lr_0 = 1.2909e-04
Loss = 1.2680e-03, PNorm = 50.8465, GNorm = 2.8633, lr_0 = 1.2362e-04
Validation rmse = 1.187672
Epoch 26
Loss = 1.2913e-03, PNorm = 50.8477, GNorm = 0.9309, lr_0 = 1.1839e-04
Validation rmse = 1.230223
Epoch 27
Loss = 1.8714e-03, PNorm = 50.8497, GNorm = 1.1730, lr_0 = 1.1288e-04
Loss = 1.1587e-03, PNorm = 50.8520, GNorm = 0.5990, lr_0 = 1.0810e-04
Validation rmse = 1.098637
Epoch 28
Loss = 1.2891e-03, PNorm = 50.8533, GNorm = 1.7217, lr_0 = 1.0352e-04
Loss = 1.1118e-03, PNorm = 50.8550, GNorm = 0.4503, lr_0 = 1.0000e-04
Validation rmse = 1.215082
Epoch 29
Loss = 1.1566e-03, PNorm = 50.8569, GNorm = 0.9201, lr_0 = 1.0000e-04
Loss = 1.0893e-03, PNorm = 50.8586, GNorm = 0.8465, lr_0 = 1.0000e-04
Validation rmse = 1.128828
Model 0 best validation rmse = 1.077616 on epoch 16
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.122548
Ensemble test rmse = 1.122548
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.35000000000000003_ffn_num_layers_1_hidden_size_1100/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 49 | test scaffolds = 62
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003, inplace=False)
    (1): Linear(in_features=1104, out_features=1, bias=True)
  )
)
Number of parameters = 2,730,205
Moving model to cuda
Epoch 0
Loss = 2.1696e-02, PNorm = 50.2375, GNorm = 4.1160, lr_0 = 3.6053e-04
Validation rmse = 1.385728
Epoch 1
Loss = 1.3084e-02, PNorm = 50.2692, GNorm = 4.0374, lr_0 = 6.2105e-04
Loss = 8.0917e-03, PNorm = 50.3193, GNorm = 4.1198, lr_0 = 8.5789e-04
Validation rmse = 1.427862
Epoch 2
Loss = 8.3382e-03, PNorm = 50.3697, GNorm = 4.2158, lr_0 = 9.8284e-04
Loss = 8.1278e-03, PNorm = 50.4186, GNorm = 1.6030, lr_0 = 9.4120e-04
Validation rmse = 1.645980
Epoch 3
Loss = 5.6228e-03, PNorm = 50.4625, GNorm = 2.1026, lr_0 = 8.9744e-04
Loss = 4.2124e-03, PNorm = 50.4908, GNorm = 1.3585, lr_0 = 8.5943e-04
Validation rmse = 1.601003
Epoch 4
Loss = 3.8127e-03, PNorm = 50.5102, GNorm = 2.6222, lr_0 = 8.2303e-04
Loss = 3.4227e-03, PNorm = 50.5286, GNorm = 6.2318, lr_0 = 7.8816e-04
Validation rmse = 1.571641
Epoch 5
Loss = 4.1934e-03, PNorm = 50.5452, GNorm = 4.2588, lr_0 = 7.5478e-04
Loss = 3.9453e-03, PNorm = 50.5654, GNorm = 1.6680, lr_0 = 7.2281e-04
Validation rmse = 1.093297
Epoch 6
Loss = 3.1470e-03, PNorm = 50.5824, GNorm = 3.7686, lr_0 = 6.8920e-04
Loss = 3.5529e-03, PNorm = 50.5981, GNorm = 1.2371, lr_0 = 6.6001e-04
Validation rmse = 1.322333
Epoch 7
Loss = 2.3166e-03, PNorm = 50.6163, GNorm = 1.9539, lr_0 = 6.3205e-04
Loss = 3.5430e-03, PNorm = 50.6307, GNorm = 1.7776, lr_0 = 6.0528e-04
Validation rmse = 1.684655
Epoch 8
Loss = 2.3842e-03, PNorm = 50.6457, GNorm = 1.2575, lr_0 = 5.7714e-04
Loss = 2.4978e-03, PNorm = 50.6577, GNorm = 1.0753, lr_0 = 5.5269e-04
Validation rmse = 1.118471
Epoch 9
Loss = 2.0806e-03, PNorm = 50.6700, GNorm = 1.5127, lr_0 = 5.2928e-04
Loss = 2.2877e-03, PNorm = 50.6818, GNorm = 0.8137, lr_0 = 5.0686e-04
Validation rmse = 1.240684
Epoch 10
Loss = 2.1455e-03, PNorm = 50.6916, GNorm = 1.5660, lr_0 = 4.8539e-04
Loss = 2.1851e-03, PNorm = 50.7017, GNorm = 0.8877, lr_0 = 4.6483e-04
Validation rmse = 1.308253
Epoch 11
Loss = 2.3177e-03, PNorm = 50.7111, GNorm = 1.1077, lr_0 = 4.4322e-04
Loss = 1.9461e-03, PNorm = 50.7203, GNorm = 1.3035, lr_0 = 4.2444e-04
Validation rmse = 1.364601
Epoch 12
Loss = 1.7144e-03, PNorm = 50.7269, GNorm = 0.6317, lr_0 = 4.0646e-04
Loss = 1.7765e-03, PNorm = 50.7335, GNorm = 0.9085, lr_0 = 3.8925e-04
Validation rmse = 1.164530
Epoch 13
Loss = 1.3881e-03, PNorm = 50.7400, GNorm = 0.7884, lr_0 = 3.7276e-04
Loss = 1.8917e-03, PNorm = 50.7476, GNorm = 1.0399, lr_0 = 3.5697e-04
Validation rmse = 1.085123
Epoch 14
Loss = 1.7190e-03, PNorm = 50.7534, GNorm = 2.5589, lr_0 = 3.4037e-04
Loss = 1.7085e-03, PNorm = 50.7596, GNorm = 0.9906, lr_0 = 3.2596e-04
Validation rmse = 1.086398
Epoch 15
Loss = 1.3360e-03, PNorm = 50.7648, GNorm = 0.5859, lr_0 = 3.1215e-04
Loss = 1.7580e-03, PNorm = 50.7688, GNorm = 1.8145, lr_0 = 2.9893e-04
Validation rmse = 1.198849
Epoch 16
Loss = 1.5637e-03, PNorm = 50.7741, GNorm = 1.9430, lr_0 = 2.8503e-04
Loss = 1.9607e-03, PNorm = 50.7785, GNorm = 0.7161, lr_0 = 2.7295e-04
Validation rmse = 1.110100
Epoch 17
Loss = 1.6121e-03, PNorm = 50.7843, GNorm = 1.1166, lr_0 = 2.6139e-04
Loss = 1.8017e-03, PNorm = 50.7872, GNorm = 1.3074, lr_0 = 2.5032e-04
Validation rmse = 1.258626
Epoch 18
Loss = 1.8376e-03, PNorm = 50.7929, GNorm = 1.3724, lr_0 = 2.3972e-04
Loss = 1.6685e-03, PNorm = 50.7968, GNorm = 1.6163, lr_0 = 2.2956e-04
Validation rmse = 1.172982
Epoch 19
Loss = 1.5273e-03, PNorm = 50.8007, GNorm = 0.9107, lr_0 = 2.1889e-04
Loss = 1.6793e-03, PNorm = 50.8051, GNorm = 1.3812, lr_0 = 2.0962e-04
Validation rmse = 1.329051
Epoch 20
Loss = 1.5897e-03, PNorm = 50.8092, GNorm = 1.0905, lr_0 = 2.0074e-04
Loss = 1.3979e-03, PNorm = 50.8122, GNorm = 2.1257, lr_0 = 1.9224e-04
Validation rmse = 1.366208
Epoch 21
Loss = 1.5014e-03, PNorm = 50.8153, GNorm = 1.1201, lr_0 = 1.8409e-04
Loss = 1.5658e-03, PNorm = 50.8186, GNorm = 1.6095, lr_0 = 1.7630e-04
Validation rmse = 1.182078
Epoch 22
Loss = 1.3601e-03, PNorm = 50.8222, GNorm = 1.2028, lr_0 = 1.6810e-04
Loss = 1.5595e-03, PNorm = 50.8244, GNorm = 0.5073, lr_0 = 1.6098e-04
Validation rmse = 1.193869
Epoch 23
Loss = 1.4268e-03, PNorm = 50.8269, GNorm = 0.8244, lr_0 = 1.5416e-04
Loss = 1.3311e-03, PNorm = 50.8290, GNorm = 1.3025, lr_0 = 1.4763e-04
Loss = 1.7339e-03, PNorm = 50.8293, GNorm = 1.3420, lr_0 = 1.4699e-04
Validation rmse = 1.125912
Epoch 24
Loss = 1.2918e-03, PNorm = 50.8314, GNorm = 0.7668, lr_0 = 1.4077e-04
Loss = 1.3747e-03, PNorm = 50.8333, GNorm = 1.0087, lr_0 = 1.3480e-04
Validation rmse = 1.236458
Epoch 25
Loss = 1.2015e-03, PNorm = 50.8355, GNorm = 0.6926, lr_0 = 1.2909e-04
Loss = 1.5928e-03, PNorm = 50.8374, GNorm = 1.7900, lr_0 = 1.2362e-04
Validation rmse = 1.142931
Epoch 26
Loss = 1.2256e-03, PNorm = 50.8389, GNorm = 0.6453, lr_0 = 1.1839e-04
Validation rmse = 1.107874
Epoch 27
Loss = 9.1983e-04, PNorm = 50.8415, GNorm = 0.7780, lr_0 = 1.1288e-04
Loss = 1.1616e-03, PNorm = 50.8421, GNorm = 1.4647, lr_0 = 1.0810e-04
Validation rmse = 1.068634
Epoch 28
Loss = 9.6671e-04, PNorm = 50.8437, GNorm = 1.5012, lr_0 = 1.0352e-04
Loss = 1.2767e-03, PNorm = 50.8453, GNorm = 0.6687, lr_0 = 1.0000e-04
Validation rmse = 1.241109
Epoch 29
Loss = 1.0500e-03, PNorm = 50.8464, GNorm = 0.8571, lr_0 = 1.0000e-04
Loss = 1.3974e-03, PNorm = 50.8481, GNorm = 1.7798, lr_0 = 1.0000e-04
Validation rmse = 1.056563
Model 0 best validation rmse = 1.056563 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.203772
Ensemble test rmse = 1.203772
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.35000000000000003_ffn_num_layers_1_hidden_size_1100/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total scaffolds = 195 | train scaffolds = 94 | val scaffolds = 55 | test scaffolds = 46
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003, inplace=False)
    (1): Linear(in_features=1104, out_features=1, bias=True)
  )
)
Number of parameters = 2,730,205
Moving model to cuda
Epoch 0
Loss = 2.1053e-02, PNorm = 50.2372, GNorm = 7.4371, lr_0 = 3.6053e-04
Validation rmse = 2.009773
Epoch 1
Loss = 1.0238e-02, PNorm = 50.2709, GNorm = 4.1108, lr_0 = 6.2105e-04
Loss = 6.2895e-03, PNorm = 50.3152, GNorm = 2.2048, lr_0 = 8.5789e-04
Validation rmse = 1.884028
Epoch 2
Loss = 7.4988e-03, PNorm = 50.3675, GNorm = 4.1611, lr_0 = 9.8284e-04
Loss = 5.9321e-03, PNorm = 50.4149, GNorm = 1.5353, lr_0 = 9.4120e-04
Validation rmse = 1.991980
Epoch 3
Loss = 6.1873e-03, PNorm = 50.4523, GNorm = 1.7931, lr_0 = 8.9744e-04
Loss = 5.3911e-03, PNorm = 50.4881, GNorm = 1.2832, lr_0 = 8.5943e-04
Validation rmse = 1.521510
Epoch 4
Loss = 3.2143e-03, PNorm = 50.5077, GNorm = 1.6223, lr_0 = 8.2303e-04
Loss = 3.5042e-03, PNorm = 50.5258, GNorm = 2.8030, lr_0 = 7.8816e-04
Validation rmse = 1.434526
Epoch 5
Loss = 3.0152e-03, PNorm = 50.5454, GNorm = 3.2636, lr_0 = 7.5478e-04
Loss = 2.7754e-03, PNorm = 50.5620, GNorm = 0.9309, lr_0 = 7.2281e-04
Validation rmse = 1.307314
Epoch 6
Loss = 3.6696e-03, PNorm = 50.5792, GNorm = 1.9471, lr_0 = 6.8920e-04
Loss = 3.2567e-03, PNorm = 50.5988, GNorm = 1.1755, lr_0 = 6.6001e-04
Validation rmse = 1.387878
Epoch 7
Loss = 2.6246e-03, PNorm = 50.6131, GNorm = 1.2718, lr_0 = 6.3205e-04
Loss = 2.3537e-03, PNorm = 50.6302, GNorm = 0.9174, lr_0 = 6.0528e-04
Validation rmse = 1.211912
Epoch 8
Loss = 2.0556e-03, PNorm = 50.6433, GNorm = 1.8556, lr_0 = 5.7714e-04
Loss = 2.7540e-03, PNorm = 50.6581, GNorm = 4.4438, lr_0 = 5.5269e-04
Validation rmse = 1.245728
Epoch 9
Loss = 2.6700e-03, PNorm = 50.6724, GNorm = 1.0936, lr_0 = 5.2928e-04
Loss = 2.5236e-03, PNorm = 50.6871, GNorm = 1.1426, lr_0 = 5.0686e-04
Validation rmse = 1.244568
Epoch 10
Loss = 2.0539e-03, PNorm = 50.7004, GNorm = 1.4905, lr_0 = 4.8539e-04
Loss = 2.3279e-03, PNorm = 50.7120, GNorm = 3.1374, lr_0 = 4.6483e-04
Validation rmse = 1.354321
Epoch 11
Loss = 1.7239e-03, PNorm = 50.7256, GNorm = 1.1882, lr_0 = 4.4322e-04
Loss = 1.8551e-03, PNorm = 50.7374, GNorm = 1.7097, lr_0 = 4.2444e-04
Validation rmse = 1.134663
Epoch 12
Loss = 1.7846e-03, PNorm = 50.7462, GNorm = 1.5938, lr_0 = 4.0646e-04
Loss = 1.9636e-03, PNorm = 50.7562, GNorm = 0.9170, lr_0 = 3.8925e-04
Validation rmse = 1.395931
Epoch 13
Loss = 2.0182e-03, PNorm = 50.7656, GNorm = 3.2682, lr_0 = 3.7276e-04
Loss = 1.9951e-03, PNorm = 50.7728, GNorm = 1.7993, lr_0 = 3.5697e-04
Validation rmse = 1.335093
Epoch 14
Loss = 2.2851e-03, PNorm = 50.7817, GNorm = 0.8398, lr_0 = 3.4037e-04
Loss = 1.6665e-03, PNorm = 50.7890, GNorm = 0.6212, lr_0 = 3.2596e-04
Validation rmse = 1.199314
Epoch 15
Loss = 1.7411e-03, PNorm = 50.7961, GNorm = 1.0715, lr_0 = 3.1215e-04
Loss = 1.6644e-03, PNorm = 50.8028, GNorm = 0.7181, lr_0 = 2.9893e-04
Validation rmse = 1.120389
Epoch 16
Loss = 1.5391e-03, PNorm = 50.8090, GNorm = 1.2716, lr_0 = 2.8503e-04
Loss = 1.7845e-03, PNorm = 50.8153, GNorm = 1.1278, lr_0 = 2.7295e-04
Validation rmse = 1.241933
Epoch 17
Loss = 1.7765e-03, PNorm = 50.8224, GNorm = 1.5982, lr_0 = 2.6139e-04
Loss = 1.6574e-03, PNorm = 50.8261, GNorm = 0.6846, lr_0 = 2.5032e-04
Validation rmse = 1.157218
Epoch 18
Loss = 1.6902e-03, PNorm = 50.8309, GNorm = 1.6375, lr_0 = 2.3972e-04
Loss = 1.5363e-03, PNorm = 50.8371, GNorm = 1.0704, lr_0 = 2.2956e-04
Validation rmse = 1.148034
Epoch 19
Loss = 1.5295e-03, PNorm = 50.8412, GNorm = 1.0953, lr_0 = 2.1889e-04
Loss = 1.7439e-03, PNorm = 50.8463, GNorm = 0.7941, lr_0 = 2.0962e-04
Validation rmse = 1.132769
Epoch 20
Loss = 1.8247e-03, PNorm = 50.8519, GNorm = 1.0359, lr_0 = 2.0074e-04
Loss = 1.5920e-03, PNorm = 50.8558, GNorm = 1.8033, lr_0 = 1.9224e-04
Validation rmse = 1.107347
Epoch 21
Loss = 1.4025e-03, PNorm = 50.8589, GNorm = 1.6689, lr_0 = 1.8409e-04
Loss = 1.5727e-03, PNorm = 50.8628, GNorm = 1.9371, lr_0 = 1.7630e-04
Validation rmse = 1.198450
Epoch 22
Loss = 1.3528e-03, PNorm = 50.8656, GNorm = 0.7916, lr_0 = 1.6810e-04
Loss = 1.5295e-03, PNorm = 50.8700, GNorm = 0.7195, lr_0 = 1.6098e-04
Validation rmse = 1.102533
Epoch 23
Loss = 1.5081e-03, PNorm = 50.8732, GNorm = 1.3242, lr_0 = 1.5416e-04
Loss = 1.3395e-03, PNorm = 50.8759, GNorm = 0.7827, lr_0 = 1.4763e-04
Loss = 9.7712e-04, PNorm = 50.8761, GNorm = 0.7819, lr_0 = 1.4699e-04
Validation rmse = 1.215426
Epoch 24
Loss = 1.3372e-03, PNorm = 50.8779, GNorm = 0.7919, lr_0 = 1.4077e-04
Loss = 1.5220e-03, PNorm = 50.8803, GNorm = 1.0723, lr_0 = 1.3480e-04
Validation rmse = 1.257093
Epoch 25
Loss = 1.3673e-03, PNorm = 50.8831, GNorm = 1.5717, lr_0 = 1.2909e-04
Loss = 1.6081e-03, PNorm = 50.8850, GNorm = 1.9043, lr_0 = 1.2362e-04
Validation rmse = 1.209624
Epoch 26
Loss = 1.4063e-03, PNorm = 50.8881, GNorm = 1.6633, lr_0 = 1.1839e-04
Validation rmse = 1.125504
Epoch 27
Loss = 1.4400e-03, PNorm = 50.8905, GNorm = 0.9087, lr_0 = 1.1288e-04
Loss = 1.1575e-03, PNorm = 50.8925, GNorm = 0.9696, lr_0 = 1.0810e-04
Validation rmse = 1.063987
Epoch 28
Loss = 9.1720e-04, PNorm = 50.8950, GNorm = 0.7029, lr_0 = 1.0352e-04
Loss = 1.4760e-03, PNorm = 50.8964, GNorm = 1.3998, lr_0 = 1.0000e-04
Validation rmse = 1.053495
Epoch 29
Loss = 1.1099e-03, PNorm = 50.8986, GNorm = 0.6721, lr_0 = 1.0000e-04
Loss = 1.2867e-03, PNorm = 50.9010, GNorm = 0.6585, lr_0 = 1.0000e-04
Validation rmse = 1.171510
Model 0 best validation rmse = 1.053495 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.158542
Ensemble test rmse = 1.158542
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.35000000000000003_ffn_num_layers_1_hidden_size_1100/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total scaffolds = 195 | train scaffolds = 64 | val scaffolds = 68 | test scaffolds = 63
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003, inplace=False)
    (1): Linear(in_features=1104, out_features=1, bias=True)
  )
)
Number of parameters = 2,730,205
Moving model to cuda
Epoch 0
Loss = 2.0075e-02, PNorm = 50.2383, GNorm = 13.1948, lr_0 = 3.6053e-04
Validation rmse = 1.799998
Epoch 1
Loss = 1.0386e-02, PNorm = 50.2708, GNorm = 3.4626, lr_0 = 6.2105e-04
Loss = 8.2506e-03, PNorm = 50.3218, GNorm = 6.5041, lr_0 = 8.5789e-04
Validation rmse = 1.983628
Epoch 2
Loss = 7.6064e-03, PNorm = 50.3726, GNorm = 2.9472, lr_0 = 9.8284e-04
Loss = 6.1527e-03, PNorm = 50.4208, GNorm = 2.6989, lr_0 = 9.4120e-04
Validation rmse = 1.466573
Epoch 3
Loss = 3.3403e-03, PNorm = 50.4558, GNorm = 2.6645, lr_0 = 8.9744e-04
Loss = 4.0186e-03, PNorm = 50.4805, GNorm = 4.6862, lr_0 = 8.5943e-04
Validation rmse = 1.373833
Epoch 4
Loss = 3.3972e-03, PNorm = 50.5017, GNorm = 2.9294, lr_0 = 8.2303e-04
Loss = 4.0201e-03, PNorm = 50.5294, GNorm = 2.9085, lr_0 = 7.8816e-04
Validation rmse = 1.356752
Epoch 5
Loss = 3.5370e-03, PNorm = 50.5492, GNorm = 1.7375, lr_0 = 7.5478e-04
Loss = 3.3903e-03, PNorm = 50.5688, GNorm = 2.1522, lr_0 = 7.2281e-04
Validation rmse = 1.605482
Epoch 6
Loss = 3.3517e-03, PNorm = 50.5890, GNorm = 4.4385, lr_0 = 6.8920e-04
Loss = 3.0321e-03, PNorm = 50.6092, GNorm = 1.7750, lr_0 = 6.6001e-04
Validation rmse = 1.304282
Epoch 7
Loss = 2.7541e-03, PNorm = 50.6242, GNorm = 2.9076, lr_0 = 6.3205e-04
Loss = 2.3336e-03, PNorm = 50.6356, GNorm = 1.0058, lr_0 = 6.0528e-04
Validation rmse = 1.266049
Epoch 8
Loss = 2.3524e-03, PNorm = 50.6491, GNorm = 1.0511, lr_0 = 5.7714e-04
Loss = 3.1375e-03, PNorm = 50.6651, GNorm = 2.6453, lr_0 = 5.5269e-04
Validation rmse = 1.683543
Epoch 9
Loss = 2.9774e-03, PNorm = 50.6795, GNorm = 2.3607, lr_0 = 5.2928e-04
Loss = 2.2967e-03, PNorm = 50.6957, GNorm = 0.8139, lr_0 = 5.0686e-04
Validation rmse = 1.267399
Epoch 10
Loss = 2.1020e-03, PNorm = 50.7110, GNorm = 1.3730, lr_0 = 4.8539e-04
Loss = 1.7752e-03, PNorm = 50.7215, GNorm = 0.6788, lr_0 = 4.6483e-04
Validation rmse = 1.187286
Epoch 11
Loss = 1.7966e-03, PNorm = 50.7331, GNorm = 0.5629, lr_0 = 4.4322e-04
Loss = 1.8100e-03, PNorm = 50.7432, GNorm = 1.2181, lr_0 = 4.2444e-04
Validation rmse = 1.127726
Epoch 12
Loss = 1.6791e-03, PNorm = 50.7525, GNorm = 1.6927, lr_0 = 4.0646e-04
Loss = 1.7621e-03, PNorm = 50.7613, GNorm = 1.7545, lr_0 = 3.8925e-04
Validation rmse = 1.219387
Epoch 13
Loss = 1.6159e-03, PNorm = 50.7699, GNorm = 0.8119, lr_0 = 3.7276e-04
Loss = 1.5328e-03, PNorm = 50.7791, GNorm = 2.2138, lr_0 = 3.5697e-04
Validation rmse = 1.377698
Epoch 14
Loss = 1.5523e-03, PNorm = 50.7861, GNorm = 0.8610, lr_0 = 3.4037e-04
Loss = 1.7743e-03, PNorm = 50.7933, GNorm = 0.9048, lr_0 = 3.2596e-04
Validation rmse = 1.154153
Epoch 15
Loss = 1.4774e-03, PNorm = 50.8013, GNorm = 1.3867, lr_0 = 3.1215e-04
Loss = 1.7024e-03, PNorm = 50.8078, GNorm = 2.5076, lr_0 = 2.9893e-04
Validation rmse = 1.299481
Epoch 16
Loss = 1.5019e-03, PNorm = 50.8160, GNorm = 1.1033, lr_0 = 2.8503e-04
Loss = 1.4852e-03, PNorm = 50.8208, GNorm = 3.8700, lr_0 = 2.7295e-04
Validation rmse = 1.407207
Epoch 17
Loss = 1.6130e-03, PNorm = 50.8262, GNorm = 0.8063, lr_0 = 2.6139e-04
Loss = 1.6903e-03, PNorm = 50.8296, GNorm = 1.9301, lr_0 = 2.5032e-04
Validation rmse = 1.330998
Epoch 18
Loss = 2.1373e-03, PNorm = 50.8361, GNorm = 1.1148, lr_0 = 2.3972e-04
Loss = 1.8009e-03, PNorm = 50.8426, GNorm = 1.2301, lr_0 = 2.2956e-04
Validation rmse = 1.118670
Epoch 19
Loss = 1.5865e-03, PNorm = 50.8490, GNorm = 1.2220, lr_0 = 2.1889e-04
Loss = 1.4358e-03, PNorm = 50.8544, GNorm = 0.8903, lr_0 = 2.0962e-04
Validation rmse = 1.261951
Epoch 20
Loss = 1.3573e-03, PNorm = 50.8572, GNorm = 0.7712, lr_0 = 2.0074e-04
Loss = 1.3881e-03, PNorm = 50.8612, GNorm = 0.4830, lr_0 = 1.9224e-04
Validation rmse = 1.218398
Epoch 21
Loss = 1.3134e-03, PNorm = 50.8654, GNorm = 1.3763, lr_0 = 1.8409e-04
Loss = 1.4254e-03, PNorm = 50.8682, GNorm = 0.8877, lr_0 = 1.7630e-04
Validation rmse = 1.239794
Epoch 22
Loss = 1.3713e-03, PNorm = 50.8710, GNorm = 0.7599, lr_0 = 1.6810e-04
Loss = 1.3331e-03, PNorm = 50.8736, GNorm = 1.1202, lr_0 = 1.6098e-04
Validation rmse = 1.164088
Epoch 23
Loss = 1.3777e-03, PNorm = 50.8757, GNorm = 0.8445, lr_0 = 1.5416e-04
Loss = 1.1669e-03, PNorm = 50.8783, GNorm = 0.9647, lr_0 = 1.4763e-04
Loss = 2.7349e-03, PNorm = 50.8785, GNorm = 1.6174, lr_0 = 1.4699e-04
Validation rmse = 1.200588
Epoch 24
Loss = 1.2681e-03, PNorm = 50.8821, GNorm = 1.0882, lr_0 = 1.4077e-04
Loss = 1.1995e-03, PNorm = 50.8851, GNorm = 0.9449, lr_0 = 1.3480e-04
Validation rmse = 1.222647
Epoch 25
Loss = 1.2444e-03, PNorm = 50.8868, GNorm = 1.9195, lr_0 = 1.2909e-04
Loss = 1.2588e-03, PNorm = 50.8890, GNorm = 1.6584, lr_0 = 1.2362e-04
Validation rmse = 1.128988
Epoch 26
Loss = 1.2558e-03, PNorm = 50.8898, GNorm = 0.5238, lr_0 = 1.1839e-04
Validation rmse = 1.201594
Epoch 27
Loss = 1.1843e-03, PNorm = 50.8922, GNorm = 0.6394, lr_0 = 1.1288e-04
Loss = 1.1297e-03, PNorm = 50.8935, GNorm = 0.6301, lr_0 = 1.0810e-04
Validation rmse = 1.140706
Epoch 28
Loss = 9.6499e-04, PNorm = 50.8958, GNorm = 1.1466, lr_0 = 1.0352e-04
Loss = 1.2042e-03, PNorm = 50.8963, GNorm = 0.7855, lr_0 = 1.0000e-04
Validation rmse = 1.225882
Epoch 29
Loss = 1.2426e-03, PNorm = 50.8980, GNorm = 1.9901, lr_0 = 1.0000e-04
Loss = 1.1848e-03, PNorm = 50.9003, GNorm = 0.8353, lr_0 = 1.0000e-04
Validation rmse = 1.219130
Model 0 best validation rmse = 1.118670 on epoch 18
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.029708
Ensemble test rmse = 1.029708
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.35000000000000003_ffn_num_layers_1_hidden_size_1100/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total scaffolds = 195 | train scaffolds = 69 | val scaffolds = 65 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003, inplace=False)
    (1): Linear(in_features=1104, out_features=1, bias=True)
  )
)
Number of parameters = 2,730,205
Moving model to cuda
Epoch 0
Loss = 1.9325e-02, PNorm = 50.2388, GNorm = 10.3575, lr_0 = 3.6053e-04
Validation rmse = 2.018176
Epoch 1
Loss = 1.2819e-02, PNorm = 50.2747, GNorm = 4.7181, lr_0 = 6.2105e-04
Loss = 8.9428e-03, PNorm = 50.3254, GNorm = 8.5450, lr_0 = 8.5789e-04
Validation rmse = 1.711153
Epoch 2
Loss = 9.5988e-03, PNorm = 50.3875, GNorm = 3.8211, lr_0 = 9.8284e-04
Loss = 6.9913e-03, PNorm = 50.4372, GNorm = 6.0671, lr_0 = 9.4120e-04
Validation rmse = 2.338514
Epoch 3
Loss = 4.6191e-03, PNorm = 50.4738, GNorm = 1.8517, lr_0 = 8.9744e-04
Loss = 5.4087e-03, PNorm = 50.5031, GNorm = 5.2027, lr_0 = 8.5943e-04
Validation rmse = 1.838773
Epoch 4
Loss = 3.6825e-03, PNorm = 50.5227, GNorm = 1.7109, lr_0 = 8.2303e-04
Loss = 3.5072e-03, PNorm = 50.5426, GNorm = 1.2140, lr_0 = 7.8816e-04
Validation rmse = 1.644067
Epoch 5
Loss = 3.0068e-03, PNorm = 50.5622, GNorm = 1.0133, lr_0 = 7.5478e-04
Loss = 2.4859e-03, PNorm = 50.5800, GNorm = 1.5829, lr_0 = 7.2281e-04
Validation rmse = 1.785157
Epoch 6
Loss = 4.6259e-03, PNorm = 50.6013, GNorm = 5.3842, lr_0 = 6.8920e-04
Loss = 4.1467e-03, PNorm = 50.6258, GNorm = 3.0445, lr_0 = 6.6001e-04
Validation rmse = 2.008212
Epoch 7
Loss = 3.1849e-03, PNorm = 50.6484, GNorm = 2.3463, lr_0 = 6.3205e-04
Loss = 3.4184e-03, PNorm = 50.6675, GNorm = 1.9416, lr_0 = 6.0528e-04
Validation rmse = 1.592051
Epoch 8
Loss = 2.8436e-03, PNorm = 50.6886, GNorm = 1.7851, lr_0 = 5.7714e-04
Loss = 2.8640e-03, PNorm = 50.7053, GNorm = 1.8164, lr_0 = 5.5269e-04
Validation rmse = 1.439280
Epoch 9
Loss = 2.5893e-03, PNorm = 50.7191, GNorm = 1.8866, lr_0 = 5.2928e-04
Loss = 2.4283e-03, PNorm = 50.7346, GNorm = 2.5827, lr_0 = 5.0686e-04
Validation rmse = 1.756051
Epoch 10
Loss = 2.4887e-03, PNorm = 50.7464, GNorm = 3.0559, lr_0 = 4.8539e-04
Loss = 2.0740e-03, PNorm = 50.7584, GNorm = 1.0671, lr_0 = 4.6483e-04
Validation rmse = 1.483466
Epoch 11
Loss = 1.8341e-03, PNorm = 50.7706, GNorm = 0.8093, lr_0 = 4.4322e-04
Loss = 1.8793e-03, PNorm = 50.7789, GNorm = 0.7670, lr_0 = 4.2444e-04
Validation rmse = 1.492549
Epoch 12
Loss = 1.7082e-03, PNorm = 50.7864, GNorm = 0.7549, lr_0 = 4.0646e-04
Loss = 1.6943e-03, PNorm = 50.7946, GNorm = 1.4257, lr_0 = 3.8925e-04
Validation rmse = 1.327297
Epoch 13
Loss = 2.5051e-03, PNorm = 50.8032, GNorm = 2.3854, lr_0 = 3.7276e-04
Loss = 2.1766e-03, PNorm = 50.8129, GNorm = 1.7903, lr_0 = 3.5697e-04
Validation rmse = 1.446992
Epoch 14
Loss = 1.7134e-03, PNorm = 50.8203, GNorm = 1.0291, lr_0 = 3.4037e-04
Loss = 1.6838e-03, PNorm = 50.8281, GNorm = 1.4085, lr_0 = 3.2596e-04
Validation rmse = 1.454550
Epoch 15
Loss = 1.7701e-03, PNorm = 50.8337, GNorm = 2.1059, lr_0 = 3.1215e-04
Loss = 1.8567e-03, PNorm = 50.8410, GNorm = 1.9499, lr_0 = 2.9893e-04
Validation rmse = 1.637524
Epoch 16
Loss = 1.6719e-03, PNorm = 50.8474, GNorm = 0.7171, lr_0 = 2.8503e-04
Loss = 1.6193e-03, PNorm = 50.8511, GNorm = 0.7184, lr_0 = 2.7295e-04
Validation rmse = 1.712907
Epoch 17
Loss = 1.5970e-03, PNorm = 50.8566, GNorm = 0.5800, lr_0 = 2.6139e-04
Loss = 1.8072e-03, PNorm = 50.8608, GNorm = 0.9567, lr_0 = 2.5032e-04
Validation rmse = 1.496318
Epoch 18
Loss = 1.2369e-03, PNorm = 50.8660, GNorm = 0.6405, lr_0 = 2.3972e-04
Loss = 1.5976e-03, PNorm = 50.8704, GNorm = 0.4739, lr_0 = 2.2956e-04
Validation rmse = 1.520617
Epoch 19
Loss = 1.5871e-03, PNorm = 50.8745, GNorm = 1.0940, lr_0 = 2.1889e-04
Loss = 1.4039e-03, PNorm = 50.8783, GNorm = 0.7029, lr_0 = 2.0962e-04
Validation rmse = 1.461531
Epoch 20
Loss = 1.6200e-03, PNorm = 50.8821, GNorm = 0.8348, lr_0 = 2.0074e-04
Loss = 1.2209e-03, PNorm = 50.8856, GNorm = 0.6178, lr_0 = 1.9224e-04
Validation rmse = 1.563877
Epoch 21
Loss = 1.4152e-03, PNorm = 50.8896, GNorm = 1.2083, lr_0 = 1.8409e-04
Loss = 1.5262e-03, PNorm = 50.8936, GNorm = 0.9723, lr_0 = 1.7630e-04
Validation rmse = 1.661667
Epoch 22
Loss = 1.4592e-03, PNorm = 50.8956, GNorm = 2.5668, lr_0 = 1.6810e-04
Loss = 1.4234e-03, PNorm = 50.8991, GNorm = 1.8399, lr_0 = 1.6098e-04
Validation rmse = 1.496184
Epoch 23
Loss = 1.3077e-03, PNorm = 50.9026, GNorm = 1.2815, lr_0 = 1.5416e-04
Loss = 1.2693e-03, PNorm = 50.9051, GNorm = 0.7227, lr_0 = 1.4763e-04
Loss = 2.2682e-03, PNorm = 50.9053, GNorm = 2.4177, lr_0 = 1.4699e-04
Validation rmse = 1.495866
Epoch 24
Loss = 1.3646e-03, PNorm = 50.9075, GNorm = 1.3774, lr_0 = 1.4077e-04
Loss = 1.5466e-03, PNorm = 50.9105, GNorm = 1.0435, lr_0 = 1.3480e-04
Validation rmse = 1.377691
Epoch 25
Loss = 1.3129e-03, PNorm = 50.9123, GNorm = 1.2366, lr_0 = 1.2909e-04
Loss = 1.6018e-03, PNorm = 50.9157, GNorm = 1.4458, lr_0 = 1.2362e-04
Validation rmse = 1.579146
Epoch 26
Loss = 1.2162e-03, PNorm = 50.9174, GNorm = 1.3685, lr_0 = 1.1839e-04
Validation rmse = 1.486880
Epoch 27
Loss = 1.1272e-03, PNorm = 50.9198, GNorm = 1.5713, lr_0 = 1.1288e-04
Loss = 1.2177e-03, PNorm = 50.9223, GNorm = 1.7052, lr_0 = 1.0810e-04
Validation rmse = 1.572784
Epoch 28
Loss = 1.2065e-03, PNorm = 50.9237, GNorm = 1.3711, lr_0 = 1.0352e-04
Loss = 1.2032e-03, PNorm = 50.9261, GNorm = 1.4754, lr_0 = 1.0000e-04
Validation rmse = 1.474216
Epoch 29
Loss = 1.4475e-03, PNorm = 50.9280, GNorm = 1.0085, lr_0 = 1.0000e-04
Loss = 1.1787e-03, PNorm = 50.9291, GNorm = 1.4811, lr_0 = 1.0000e-04
Validation rmse = 1.514488
Model 0 best validation rmse = 1.327297 on epoch 12
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.037311
Ensemble test rmse = 1.037311
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.35000000000000003_ffn_num_layers_1_hidden_size_1100/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total scaffolds = 195 | train scaffolds = 75 | val scaffolds = 42 | test scaffolds = 78
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003, inplace=False)
    (1): Linear(in_features=1104, out_features=1, bias=True)
  )
)
Number of parameters = 2,730,205
Moving model to cuda
Epoch 0
Loss = 1.9786e-02, PNorm = 50.2373, GNorm = 7.5551, lr_0 = 3.6053e-04
Validation rmse = 2.148718
Epoch 1
Loss = 1.0079e-02, PNorm = 50.2726, GNorm = 5.0795, lr_0 = 6.2105e-04
Loss = 7.8341e-03, PNorm = 50.3231, GNorm = 5.8645, lr_0 = 8.5789e-04
Validation rmse = 1.568066
Epoch 2
Loss = 8.2645e-03, PNorm = 50.3757, GNorm = 6.7085, lr_0 = 9.8284e-04
Loss = 4.5676e-03, PNorm = 50.4203, GNorm = 1.0861, lr_0 = 9.4120e-04
Validation rmse = 1.570368
Epoch 3
Loss = 4.5687e-03, PNorm = 50.4524, GNorm = 2.7689, lr_0 = 8.9744e-04
Loss = 3.9861e-03, PNorm = 50.4823, GNorm = 4.0671, lr_0 = 8.5943e-04
Validation rmse = 1.660372
Epoch 4
Loss = 3.6755e-03, PNorm = 50.5047, GNorm = 2.5575, lr_0 = 8.2303e-04
Loss = 3.0589e-03, PNorm = 50.5234, GNorm = 4.1094, lr_0 = 7.8816e-04
Validation rmse = 1.258280
Epoch 5
Loss = 1.9366e-03, PNorm = 50.5409, GNorm = 1.4215, lr_0 = 7.5478e-04
Loss = 3.0279e-03, PNorm = 50.5585, GNorm = 3.3502, lr_0 = 7.2281e-04
Validation rmse = 1.310884
Epoch 6
Loss = 2.3583e-03, PNorm = 50.5759, GNorm = 3.4301, lr_0 = 6.8920e-04
Loss = 2.5066e-03, PNorm = 50.5918, GNorm = 1.6038, lr_0 = 6.6001e-04
Validation rmse = 1.517342
Epoch 7
Loss = 3.0252e-03, PNorm = 50.6081, GNorm = 4.0649, lr_0 = 6.3205e-04
Loss = 2.7080e-03, PNorm = 50.6261, GNorm = 1.9467, lr_0 = 6.0528e-04
Validation rmse = 1.473718
Epoch 8
Loss = 2.7023e-03, PNorm = 50.6420, GNorm = 2.4190, lr_0 = 5.7714e-04
Loss = 2.0162e-03, PNorm = 50.6549, GNorm = 2.4754, lr_0 = 5.5269e-04
Validation rmse = 1.385484
Epoch 9
Loss = 1.7398e-03, PNorm = 50.6711, GNorm = 2.0552, lr_0 = 5.2928e-04
Loss = 1.8263e-03, PNorm = 50.6832, GNorm = 2.0620, lr_0 = 5.0686e-04
Validation rmse = 1.188865
Epoch 10
Loss = 1.4473e-03, PNorm = 50.6941, GNorm = 1.0977, lr_0 = 4.8539e-04
Loss = 1.8340e-03, PNorm = 50.7071, GNorm = 0.9696, lr_0 = 4.6483e-04
Validation rmse = 1.261243
Epoch 11
Loss = 2.0883e-03, PNorm = 50.7176, GNorm = 1.9629, lr_0 = 4.4322e-04
Loss = 1.6569e-03, PNorm = 50.7269, GNorm = 2.6277, lr_0 = 4.2444e-04
Validation rmse = 1.159580
Epoch 12
Loss = 1.7721e-03, PNorm = 50.7372, GNorm = 1.2265, lr_0 = 4.0646e-04
Loss = 1.5473e-03, PNorm = 50.7472, GNorm = 0.8670, lr_0 = 3.8925e-04
Validation rmse = 1.172061
Epoch 13
Loss = 1.3891e-03, PNorm = 50.7553, GNorm = 0.8175, lr_0 = 3.7276e-04
Loss = 1.5730e-03, PNorm = 50.7629, GNorm = 1.2485, lr_0 = 3.5697e-04
Validation rmse = 1.094845
Epoch 14
Loss = 1.4244e-03, PNorm = 50.7725, GNorm = 0.6942, lr_0 = 3.4037e-04
Loss = 1.5492e-03, PNorm = 50.7788, GNorm = 2.0383, lr_0 = 3.2596e-04
Validation rmse = 1.201015
Epoch 15
Loss = 1.6269e-03, PNorm = 50.7834, GNorm = 4.2899, lr_0 = 3.1215e-04
Loss = 1.6816e-03, PNorm = 50.7889, GNorm = 1.3033, lr_0 = 2.9893e-04
Validation rmse = 1.244965
Epoch 16
Loss = 1.3134e-03, PNorm = 50.7964, GNorm = 0.6908, lr_0 = 2.8503e-04
Loss = 1.5261e-03, PNorm = 50.8025, GNorm = 0.7043, lr_0 = 2.7295e-04
Validation rmse = 1.166550
Epoch 17
Loss = 1.4495e-03, PNorm = 50.8064, GNorm = 0.5742, lr_0 = 2.6139e-04
Loss = 1.6042e-03, PNorm = 50.8122, GNorm = 1.1336, lr_0 = 2.5032e-04
Validation rmse = 1.402929
Epoch 18
Loss = 1.6454e-03, PNorm = 50.8165, GNorm = 0.8630, lr_0 = 2.3972e-04
Loss = 1.3959e-03, PNorm = 50.8213, GNorm = 1.0284, lr_0 = 2.2956e-04
Validation rmse = 1.195541
Epoch 19
Loss = 1.3740e-03, PNorm = 50.8260, GNorm = 1.1133, lr_0 = 2.1889e-04
Loss = 1.4349e-03, PNorm = 50.8288, GNorm = 0.7114, lr_0 = 2.0962e-04
Validation rmse = 1.178249
Epoch 20
Loss = 1.2719e-03, PNorm = 50.8334, GNorm = 0.4935, lr_0 = 2.0074e-04
Loss = 1.5573e-03, PNorm = 50.8371, GNorm = 0.9312, lr_0 = 1.9224e-04
Validation rmse = 1.138621
Epoch 21
Loss = 1.3692e-03, PNorm = 50.8415, GNorm = 1.4467, lr_0 = 1.8409e-04
Loss = 1.3969e-03, PNorm = 50.8458, GNorm = 1.1077, lr_0 = 1.7630e-04
Validation rmse = 1.114163
Epoch 22
Loss = 1.2352e-03, PNorm = 50.8494, GNorm = 0.5421, lr_0 = 1.6810e-04
Loss = 1.4039e-03, PNorm = 50.8523, GNorm = 1.8674, lr_0 = 1.6098e-04
Validation rmse = 1.165338
Epoch 23
Loss = 1.2756e-03, PNorm = 50.8552, GNorm = 1.1190, lr_0 = 1.5416e-04
Loss = 1.2313e-03, PNorm = 50.8577, GNorm = 1.1845, lr_0 = 1.4763e-04
Loss = 1.7911e-03, PNorm = 50.8578, GNorm = 1.6438, lr_0 = 1.4699e-04
Validation rmse = 1.238232
Epoch 24
Loss = 1.1013e-03, PNorm = 50.8596, GNorm = 0.6641, lr_0 = 1.4077e-04
Loss = 1.4243e-03, PNorm = 50.8625, GNorm = 0.9473, lr_0 = 1.3480e-04
Validation rmse = 1.169965
Epoch 25
Loss = 1.2475e-03, PNorm = 50.8640, GNorm = 1.1138, lr_0 = 1.2909e-04
Loss = 1.2597e-03, PNorm = 50.8667, GNorm = 1.4777, lr_0 = 1.2362e-04
Validation rmse = 1.199739
Epoch 26
Loss = 1.4036e-03, PNorm = 50.8691, GNorm = 1.1808, lr_0 = 1.1839e-04
Validation rmse = 1.214719
Epoch 27
Loss = 2.2229e-03, PNorm = 50.8713, GNorm = 2.1790, lr_0 = 1.1288e-04
Loss = 1.1599e-03, PNorm = 50.8730, GNorm = 2.1797, lr_0 = 1.0810e-04
Validation rmse = 1.199149
Epoch 28
Loss = 1.0002e-03, PNorm = 50.8748, GNorm = 0.6316, lr_0 = 1.0352e-04
Loss = 1.3129e-03, PNorm = 50.8758, GNorm = 1.3645, lr_0 = 1.0000e-04
Validation rmse = 1.245525
Epoch 29
Loss = 1.2641e-03, PNorm = 50.8788, GNorm = 0.8085, lr_0 = 1.0000e-04
Loss = 1.0969e-03, PNorm = 50.8803, GNorm = 1.1860, lr_0 = 1.0000e-04
Validation rmse = 1.182725
Model 0 best validation rmse = 1.094845 on epoch 13
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.149209
Ensemble test rmse = 1.149209
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.35000000000000003_ffn_num_layers_1_hidden_size_1100/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 58 | test scaffolds = 53
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003, inplace=False)
    (1): Linear(in_features=1104, out_features=1, bias=True)
  )
)
Number of parameters = 2,730,205
Moving model to cuda
Epoch 0
Loss = 2.4182e-02, PNorm = 50.2359, GNorm = 9.9312, lr_0 = 3.6053e-04
Validation rmse = 1.691811
Epoch 1
Loss = 7.5457e-03, PNorm = 50.2680, GNorm = 3.0280, lr_0 = 6.2105e-04
Loss = 8.3462e-03, PNorm = 50.3136, GNorm = 4.9812, lr_0 = 8.5789e-04
Validation rmse = 1.703856
Epoch 2
Loss = 6.8788e-03, PNorm = 50.3646, GNorm = 4.0036, lr_0 = 9.8284e-04
Loss = 7.2975e-03, PNorm = 50.4064, GNorm = 3.8181, lr_0 = 9.4120e-04
Validation rmse = 1.465421
Epoch 3
Loss = 6.9227e-03, PNorm = 50.4473, GNorm = 4.0618, lr_0 = 8.9744e-04
Loss = 5.1813e-03, PNorm = 50.4781, GNorm = 1.2337, lr_0 = 8.5943e-04
Validation rmse = 1.508347
Epoch 4
Loss = 6.0662e-03, PNorm = 50.4968, GNorm = 7.3358, lr_0 = 8.2303e-04
Loss = 3.8028e-03, PNorm = 50.5174, GNorm = 1.5805, lr_0 = 7.8816e-04
Validation rmse = 1.509783
Epoch 5
Loss = 3.0920e-03, PNorm = 50.5330, GNorm = 0.9210, lr_0 = 7.5478e-04
Loss = 3.2561e-03, PNorm = 50.5495, GNorm = 2.3260, lr_0 = 7.2281e-04
Validation rmse = 1.314528
Epoch 6
Loss = 3.8969e-03, PNorm = 50.5656, GNorm = 1.6453, lr_0 = 6.8920e-04
Loss = 2.9385e-03, PNorm = 50.5799, GNorm = 1.7196, lr_0 = 6.6001e-04
Validation rmse = 1.200751
Epoch 7
Loss = 2.8491e-03, PNorm = 50.5963, GNorm = 1.1253, lr_0 = 6.3205e-04
Loss = 2.5123e-03, PNorm = 50.6099, GNorm = 1.6125, lr_0 = 6.0528e-04
Validation rmse = 1.098336
Epoch 8
Loss = 2.5436e-03, PNorm = 50.6231, GNorm = 1.2070, lr_0 = 5.7714e-04
Loss = 2.5240e-03, PNorm = 50.6358, GNorm = 1.5076, lr_0 = 5.5269e-04
Validation rmse = 1.190963
Epoch 9
Loss = 2.7954e-03, PNorm = 50.6494, GNorm = 3.4627, lr_0 = 5.2928e-04
Loss = 2.0759e-03, PNorm = 50.6625, GNorm = 0.9691, lr_0 = 5.0686e-04
Validation rmse = 1.113012
Epoch 10
Loss = 2.5940e-03, PNorm = 50.6733, GNorm = 2.3117, lr_0 = 4.8539e-04
Loss = 2.2443e-03, PNorm = 50.6855, GNorm = 1.1053, lr_0 = 4.6483e-04
Validation rmse = 1.156840
Epoch 11
Loss = 2.4650e-03, PNorm = 50.6963, GNorm = 0.6361, lr_0 = 4.4322e-04
Loss = 2.2502e-03, PNorm = 50.7088, GNorm = 1.9667, lr_0 = 4.2444e-04
Validation rmse = 1.179876
Epoch 12
Loss = 1.8251e-03, PNorm = 50.7194, GNorm = 1.0825, lr_0 = 4.0646e-04
Loss = 2.0559e-03, PNorm = 50.7277, GNorm = 1.2939, lr_0 = 3.8925e-04
Validation rmse = 1.045524
Epoch 13
Loss = 1.6436e-03, PNorm = 50.7347, GNorm = 0.9079, lr_0 = 3.7276e-04
Loss = 1.8868e-03, PNorm = 50.7416, GNorm = 1.9309, lr_0 = 3.5697e-04
Validation rmse = 1.112901
Epoch 14
Loss = 2.0720e-03, PNorm = 50.7500, GNorm = 2.0446, lr_0 = 3.4037e-04
Loss = 1.7430e-03, PNorm = 50.7561, GNorm = 1.1415, lr_0 = 3.2596e-04
Validation rmse = 1.126900
Epoch 15
Loss = 1.4877e-03, PNorm = 50.7612, GNorm = 0.6813, lr_0 = 3.1215e-04
Loss = 1.8968e-03, PNorm = 50.7659, GNorm = 1.2562, lr_0 = 2.9893e-04
Validation rmse = 1.120338
Epoch 16
Loss = 1.8962e-03, PNorm = 50.7729, GNorm = 2.2442, lr_0 = 2.8503e-04
Loss = 1.6435e-03, PNorm = 50.7782, GNorm = 0.9352, lr_0 = 2.7295e-04
Validation rmse = 1.017731
Epoch 17
Loss = 1.6958e-03, PNorm = 50.7836, GNorm = 0.8204, lr_0 = 2.6139e-04
Loss = 1.8630e-03, PNorm = 50.7872, GNorm = 1.3447, lr_0 = 2.5032e-04
Validation rmse = 1.090349
Epoch 18
Loss = 1.4184e-03, PNorm = 50.7920, GNorm = 0.5796, lr_0 = 2.3972e-04
Loss = 1.9522e-03, PNorm = 50.7958, GNorm = 1.1524, lr_0 = 2.2956e-04
Validation rmse = 1.004824
Epoch 19
Loss = 1.6577e-03, PNorm = 50.7993, GNorm = 1.6612, lr_0 = 2.1889e-04
Loss = 1.7489e-03, PNorm = 50.8038, GNorm = 1.0658, lr_0 = 2.0962e-04
Validation rmse = 1.234077
Epoch 20
Loss = 1.8725e-03, PNorm = 50.8087, GNorm = 1.1205, lr_0 = 2.0074e-04
Loss = 1.4784e-03, PNorm = 50.8116, GNorm = 1.2093, lr_0 = 1.9224e-04
Validation rmse = 1.105074
Epoch 21
Loss = 1.3962e-03, PNorm = 50.8151, GNorm = 2.0041, lr_0 = 1.8409e-04
Loss = 1.7047e-03, PNorm = 50.8177, GNorm = 0.9563, lr_0 = 1.7630e-04
Validation rmse = 1.012936
Epoch 22
Loss = 1.6304e-03, PNorm = 50.8210, GNorm = 2.0461, lr_0 = 1.6810e-04
Loss = 1.5589e-03, PNorm = 50.8237, GNorm = 2.0092, lr_0 = 1.6098e-04
Validation rmse = 1.013612
Epoch 23
Loss = 1.3810e-03, PNorm = 50.8255, GNorm = 0.7207, lr_0 = 1.5416e-04
Loss = 1.6499e-03, PNorm = 50.8285, GNorm = 0.7995, lr_0 = 1.4763e-04
Loss = 2.8246e-03, PNorm = 50.8288, GNorm = 1.2957, lr_0 = 1.4699e-04
Validation rmse = 1.038817
Epoch 24
Loss = 1.5535e-03, PNorm = 50.8313, GNorm = 0.8155, lr_0 = 1.4077e-04
Loss = 1.5499e-03, PNorm = 50.8329, GNorm = 1.8960, lr_0 = 1.3480e-04
Validation rmse = 1.007841
Epoch 25
Loss = 1.4797e-03, PNorm = 50.8350, GNorm = 1.0766, lr_0 = 1.2909e-04
Loss = 1.4548e-03, PNorm = 50.8371, GNorm = 0.9368, lr_0 = 1.2362e-04
Validation rmse = 1.006800
Epoch 26
Loss = 1.4254e-03, PNorm = 50.8391, GNorm = 0.7498, lr_0 = 1.1839e-04
Validation rmse = 0.986348
Epoch 27
Loss = 1.0724e-03, PNorm = 50.8415, GNorm = 0.8464, lr_0 = 1.1288e-04
Loss = 1.4144e-03, PNorm = 50.8422, GNorm = 2.3310, lr_0 = 1.0810e-04
Validation rmse = 1.002976
Epoch 28
Loss = 1.3226e-03, PNorm = 50.8437, GNorm = 0.9547, lr_0 = 1.0352e-04
Loss = 1.3629e-03, PNorm = 50.8454, GNorm = 0.6931, lr_0 = 1.0000e-04
Validation rmse = 0.956534
Epoch 29
Loss = 1.4086e-03, PNorm = 50.8475, GNorm = 1.1691, lr_0 = 1.0000e-04
Loss = 1.2947e-03, PNorm = 50.8491, GNorm = 0.6734, lr_0 = 1.0000e-04
Validation rmse = 0.987808
Model 0 best validation rmse = 0.956534 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.341752
Ensemble test rmse = 1.341752
10-fold cross validation
	Seed 0 ==> test rmse = 0.983831
	Seed 1 ==> test rmse = 1.128564
	Seed 2 ==> test rmse = 1.092923
	Seed 3 ==> test rmse = 1.122548
	Seed 4 ==> test rmse = 1.203772
	Seed 5 ==> test rmse = 1.158542
	Seed 6 ==> test rmse = 1.029708
	Seed 7 ==> test rmse = 1.037311
	Seed 8 ==> test rmse = 1.149209
	Seed 9 ==> test rmse = 1.341752
Overall test rmse = 1.124816 +/- 0.096251
Elapsed time = 0:07:06
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total scaffolds = 195 | train scaffolds = 91 | val scaffolds = 66 | test scaffolds = 38
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1704, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,405
Moving model to cuda
Epoch 0
Loss = 1.5598e-02, PNorm = 61.1156, GNorm = 6.1181, lr_0 = 3.6053e-04
Validation rmse = 2.901872
Epoch 1
Loss = 9.7448e-03, PNorm = 61.1898, GNorm = 9.6221, lr_0 = 6.2105e-04
Loss = 9.1499e-03, PNorm = 61.2839, GNorm = 4.1034, lr_0 = 8.5789e-04
Validation rmse = 1.668078
Epoch 2
Loss = 4.3996e-03, PNorm = 61.3888, GNorm = 1.0874, lr_0 = 9.8284e-04
Loss = 4.1168e-03, PNorm = 61.4645, GNorm = 1.3621, lr_0 = 9.4120e-04
Validation rmse = 2.227030
Epoch 3
Loss = 6.1255e-03, PNorm = 61.5250, GNorm = 2.9804, lr_0 = 8.9744e-04
Loss = 3.9613e-03, PNorm = 61.5799, GNorm = 1.7172, lr_0 = 8.5943e-04
Validation rmse = 1.268100
Epoch 4
Loss = 4.5687e-03, PNorm = 61.6188, GNorm = 1.8085, lr_0 = 8.2303e-04
Loss = 2.7957e-03, PNorm = 61.6560, GNorm = 3.8155, lr_0 = 7.8816e-04
Validation rmse = 1.354030
Epoch 5
Loss = 2.5748e-03, PNorm = 61.6874, GNorm = 2.2869, lr_0 = 7.5478e-04
Loss = 2.3977e-03, PNorm = 61.7150, GNorm = 1.4402, lr_0 = 7.2281e-04
Validation rmse = 1.392214
Epoch 6
Loss = 2.0241e-03, PNorm = 61.7490, GNorm = 1.0829, lr_0 = 6.8920e-04
Loss = 2.0919e-03, PNorm = 61.7723, GNorm = 1.0914, lr_0 = 6.6001e-04
Validation rmse = 1.431178
Epoch 7
Loss = 3.0227e-03, PNorm = 61.7971, GNorm = 1.6132, lr_0 = 6.3205e-04
Loss = 2.3067e-03, PNorm = 61.8241, GNorm = 0.8259, lr_0 = 6.0528e-04
Validation rmse = 1.051502
Epoch 8
Loss = 2.1582e-03, PNorm = 61.8536, GNorm = 1.4744, lr_0 = 5.7714e-04
Loss = 1.8305e-03, PNorm = 61.8774, GNorm = 0.6211, lr_0 = 5.5269e-04
Validation rmse = 1.194062
Epoch 9
Loss = 1.9800e-03, PNorm = 61.8971, GNorm = 3.1675, lr_0 = 5.2928e-04
Loss = 1.8642e-03, PNorm = 61.9179, GNorm = 0.7345, lr_0 = 5.0686e-04
Validation rmse = 1.155650
Epoch 10
Loss = 1.7630e-03, PNorm = 61.9311, GNorm = 2.6935, lr_0 = 4.8539e-04
Loss = 1.8293e-03, PNorm = 61.9482, GNorm = 0.8294, lr_0 = 4.6483e-04
Validation rmse = 1.065741
Epoch 11
Loss = 1.2758e-03, PNorm = 61.9650, GNorm = 0.6690, lr_0 = 4.4322e-04
Loss = 1.5432e-03, PNorm = 61.9786, GNorm = 1.5990, lr_0 = 4.2444e-04
Validation rmse = 1.054993
Epoch 12
Loss = 1.6103e-03, PNorm = 61.9900, GNorm = 0.6809, lr_0 = 4.0646e-04
Loss = 1.3796e-03, PNorm = 62.0001, GNorm = 0.3663, lr_0 = 3.8925e-04
Validation rmse = 1.032436
Epoch 13
Loss = 1.2382e-03, PNorm = 62.0124, GNorm = 0.5762, lr_0 = 3.7276e-04
Loss = 2.0774e-03, PNorm = 62.0247, GNorm = 1.7356, lr_0 = 3.5697e-04
Validation rmse = 1.170434
Epoch 14
Loss = 1.5307e-03, PNorm = 62.0412, GNorm = 1.3714, lr_0 = 3.4037e-04
Loss = 1.5495e-03, PNorm = 62.0566, GNorm = 0.8711, lr_0 = 3.2596e-04
Validation rmse = 1.046663
Epoch 15
Loss = 1.4624e-03, PNorm = 62.0654, GNorm = 0.5231, lr_0 = 3.1215e-04
Loss = 1.3887e-03, PNorm = 62.0764, GNorm = 2.0721, lr_0 = 2.9893e-04
Validation rmse = 1.128195
Epoch 16
Loss = 1.3166e-03, PNorm = 62.0856, GNorm = 1.2711, lr_0 = 2.8503e-04
Loss = 1.1936e-03, PNorm = 62.0943, GNorm = 0.5151, lr_0 = 2.7295e-04
Validation rmse = 1.036604
Epoch 17
Loss = 1.1377e-03, PNorm = 62.1035, GNorm = 1.6474, lr_0 = 2.6139e-04
Loss = 1.3451e-03, PNorm = 62.1140, GNorm = 1.2193, lr_0 = 2.5032e-04
Validation rmse = 1.009389
Epoch 18
Loss = 8.5694e-04, PNorm = 62.1230, GNorm = 0.4145, lr_0 = 2.3972e-04
Loss = 1.1770e-03, PNorm = 62.1314, GNorm = 0.7761, lr_0 = 2.2956e-04
Validation rmse = 1.024317
Epoch 19
Loss = 1.1090e-03, PNorm = 62.1403, GNorm = 1.1411, lr_0 = 2.1889e-04
Loss = 1.3716e-03, PNorm = 62.1465, GNorm = 0.4552, lr_0 = 2.0962e-04
Validation rmse = 1.114666
Epoch 20
Loss = 1.2184e-03, PNorm = 62.1532, GNorm = 0.4889, lr_0 = 2.0074e-04
Loss = 1.1755e-03, PNorm = 62.1606, GNorm = 0.7029, lr_0 = 1.9224e-04
Validation rmse = 1.045446
Epoch 21
Loss = 1.1642e-03, PNorm = 62.1670, GNorm = 1.1067, lr_0 = 1.8409e-04
Loss = 1.2652e-03, PNorm = 62.1744, GNorm = 0.5962, lr_0 = 1.7630e-04
Validation rmse = 1.059083
Epoch 22
Loss = 8.9835e-04, PNorm = 62.1827, GNorm = 0.8769, lr_0 = 1.6810e-04
Loss = 1.2978e-03, PNorm = 62.1881, GNorm = 0.8592, lr_0 = 1.6098e-04
Validation rmse = 0.992870
Epoch 23
Loss = 1.0916e-03, PNorm = 62.1934, GNorm = 0.7704, lr_0 = 1.5416e-04
Loss = 1.0626e-03, PNorm = 62.1999, GNorm = 0.6688, lr_0 = 1.4763e-04
Loss = 1.6593e-03, PNorm = 62.2005, GNorm = 0.9419, lr_0 = 1.4699e-04
Validation rmse = 1.053550
Epoch 24
Loss = 1.1975e-03, PNorm = 62.2033, GNorm = 1.0964, lr_0 = 1.4077e-04
Loss = 1.0709e-03, PNorm = 62.2095, GNorm = 0.8690, lr_0 = 1.3480e-04
Validation rmse = 1.028225
Epoch 25
Loss = 1.0983e-03, PNorm = 62.2146, GNorm = 1.3183, lr_0 = 1.2909e-04
Loss = 1.0127e-03, PNorm = 62.2194, GNorm = 0.6257, lr_0 = 1.2362e-04
Validation rmse = 1.053773
Epoch 26
Loss = 1.0070e-03, PNorm = 62.2240, GNorm = 0.9877, lr_0 = 1.1839e-04
Validation rmse = 1.006144
Epoch 27
Loss = 5.6275e-04, PNorm = 62.2278, GNorm = 0.6391, lr_0 = 1.1288e-04
Loss = 1.0808e-03, PNorm = 62.2312, GNorm = 0.9134, lr_0 = 1.0810e-04
Validation rmse = 1.020716
Epoch 28
Loss = 1.4784e-03, PNorm = 62.2353, GNorm = 0.5650, lr_0 = 1.0352e-04
Loss = 9.4832e-04, PNorm = 62.2404, GNorm = 0.4031, lr_0 = 1.0000e-04
Validation rmse = 0.993485
Epoch 29
Loss = 1.0141e-03, PNorm = 62.2445, GNorm = 0.8515, lr_0 = 1.0000e-04
Loss = 1.1009e-03, PNorm = 62.2495, GNorm = 0.5100, lr_0 = 1.0000e-04
Validation rmse = 1.067897
Model 0 best validation rmse = 0.992870 on epoch 22
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.868482
Ensemble test rmse = 0.868482
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total scaffolds = 195 | train scaffolds = 76 | val scaffolds = 60 | test scaffolds = 59
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1704, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,405
Moving model to cuda
Epoch 0
Loss = 1.8614e-02, PNorm = 61.1125, GNorm = 2.9580, lr_0 = 3.6053e-04
Validation rmse = 1.899442
Epoch 1
Loss = 7.4805e-03, PNorm = 61.1863, GNorm = 6.1232, lr_0 = 6.2105e-04
Loss = 7.4687e-03, PNorm = 61.2761, GNorm = 4.2753, lr_0 = 8.5789e-04
Validation rmse = 1.456368
Epoch 2
Loss = 5.6957e-03, PNorm = 61.3793, GNorm = 1.5017, lr_0 = 9.8284e-04
Loss = 4.5971e-03, PNorm = 61.4556, GNorm = 3.2815, lr_0 = 9.4120e-04
Validation rmse = 1.373682
Epoch 3
Loss = 4.5063e-03, PNorm = 61.5192, GNorm = 1.4321, lr_0 = 8.9744e-04
Loss = 3.8615e-03, PNorm = 61.5706, GNorm = 1.3568, lr_0 = 8.5943e-04
Validation rmse = 1.362413
Epoch 4
Loss = 2.5022e-03, PNorm = 61.6135, GNorm = 0.7802, lr_0 = 8.2303e-04
Loss = 2.6494e-03, PNorm = 61.6538, GNorm = 2.8272, lr_0 = 7.8816e-04
Validation rmse = 1.334634
Epoch 5
Loss = 2.3562e-03, PNorm = 61.6806, GNorm = 2.9935, lr_0 = 7.5478e-04
Loss = 2.9050e-03, PNorm = 61.7117, GNorm = 1.7390, lr_0 = 7.2281e-04
Validation rmse = 1.238887
Epoch 6
Loss = 2.1549e-03, PNorm = 61.7422, GNorm = 1.3128, lr_0 = 6.8920e-04
Loss = 2.2091e-03, PNorm = 61.7716, GNorm = 1.3830, lr_0 = 6.6001e-04
Validation rmse = 1.296149
Epoch 7
Loss = 1.8559e-03, PNorm = 61.7958, GNorm = 1.2462, lr_0 = 6.3205e-04
Loss = 2.3309e-03, PNorm = 61.8181, GNorm = 1.4267, lr_0 = 6.0528e-04
Validation rmse = 1.106923
Epoch 8
Loss = 1.7546e-03, PNorm = 61.8432, GNorm = 0.7065, lr_0 = 5.7714e-04
Loss = 1.7164e-03, PNorm = 61.8576, GNorm = 2.7659, lr_0 = 5.5269e-04
Validation rmse = 1.227098
Epoch 9
Loss = 2.0248e-03, PNorm = 61.8730, GNorm = 1.9752, lr_0 = 5.2928e-04
Loss = 1.9839e-03, PNorm = 61.8923, GNorm = 1.8568, lr_0 = 5.0686e-04
Validation rmse = 1.241090
Epoch 10
Loss = 1.6256e-03, PNorm = 61.9140, GNorm = 1.7487, lr_0 = 4.8539e-04
Loss = 1.4618e-03, PNorm = 61.9304, GNorm = 0.8455, lr_0 = 4.6483e-04
Validation rmse = 1.051678
Epoch 11
Loss = 1.8318e-03, PNorm = 61.9443, GNorm = 2.1722, lr_0 = 4.4322e-04
Loss = 1.5804e-03, PNorm = 61.9548, GNorm = 2.3176, lr_0 = 4.2444e-04
Validation rmse = 1.095241
Epoch 12
Loss = 1.1834e-03, PNorm = 61.9697, GNorm = 0.6452, lr_0 = 4.0646e-04
Loss = 1.5637e-03, PNorm = 61.9795, GNorm = 0.7803, lr_0 = 3.8925e-04
Validation rmse = 1.192484
Epoch 13
Loss = 1.9868e-03, PNorm = 61.9908, GNorm = 2.4049, lr_0 = 3.7276e-04
Loss = 1.7034e-03, PNorm = 62.0069, GNorm = 0.5798, lr_0 = 3.5697e-04
Validation rmse = 1.038600
Epoch 14
Loss = 1.4913e-03, PNorm = 62.0221, GNorm = 1.9210, lr_0 = 3.4037e-04
Loss = 1.7459e-03, PNorm = 62.0364, GNorm = 0.7909, lr_0 = 3.2596e-04
Validation rmse = 1.085420
Epoch 15
Loss = 1.7862e-03, PNorm = 62.0460, GNorm = 1.4729, lr_0 = 3.1215e-04
Loss = 1.3081e-03, PNorm = 62.0599, GNorm = 0.3575, lr_0 = 2.9893e-04
Validation rmse = 1.035463
Epoch 16
Loss = 1.0918e-03, PNorm = 62.0697, GNorm = 1.0097, lr_0 = 2.8503e-04
Loss = 1.4794e-03, PNorm = 62.0774, GNorm = 1.5696, lr_0 = 2.7295e-04
Validation rmse = 1.050967
Epoch 17
Loss = 1.1865e-03, PNorm = 62.0865, GNorm = 1.7621, lr_0 = 2.6139e-04
Loss = 1.2655e-03, PNorm = 62.0945, GNorm = 0.8000, lr_0 = 2.5032e-04
Validation rmse = 1.028729
Epoch 18
Loss = 1.2054e-03, PNorm = 62.1023, GNorm = 0.6092, lr_0 = 2.3972e-04
Loss = 1.2470e-03, PNorm = 62.1099, GNorm = 1.7614, lr_0 = 2.2956e-04
Validation rmse = 1.025385
Epoch 19
Loss = 9.3266e-04, PNorm = 62.1182, GNorm = 1.0170, lr_0 = 2.1889e-04
Loss = 1.1729e-03, PNorm = 62.1251, GNorm = 0.4737, lr_0 = 2.0962e-04
Validation rmse = 1.005581
Epoch 20
Loss = 9.4106e-04, PNorm = 62.1318, GNorm = 0.5131, lr_0 = 2.0074e-04
Loss = 1.2193e-03, PNorm = 62.1390, GNorm = 0.5649, lr_0 = 1.9224e-04
Validation rmse = 0.998998
Epoch 21
Loss = 9.2209e-04, PNorm = 62.1442, GNorm = 0.9866, lr_0 = 1.8409e-04
Loss = 1.2875e-03, PNorm = 62.1489, GNorm = 0.7588, lr_0 = 1.7630e-04
Validation rmse = 0.993166
Epoch 22
Loss = 1.2103e-03, PNorm = 62.1556, GNorm = 1.5398, lr_0 = 1.6810e-04
Loss = 1.0225e-03, PNorm = 62.1608, GNorm = 1.3897, lr_0 = 1.6098e-04
Validation rmse = 1.043110
Epoch 23
Loss = 1.1618e-03, PNorm = 62.1668, GNorm = 0.6393, lr_0 = 1.5416e-04
Loss = 1.1070e-03, PNorm = 62.1711, GNorm = 0.9780, lr_0 = 1.4763e-04
Loss = 1.2031e-03, PNorm = 62.1716, GNorm = 0.8422, lr_0 = 1.4699e-04
Validation rmse = 1.011035
Epoch 24
Loss = 1.2164e-03, PNorm = 62.1775, GNorm = 0.5823, lr_0 = 1.4077e-04
Loss = 9.9017e-04, PNorm = 62.1826, GNorm = 0.5815, lr_0 = 1.3480e-04
Validation rmse = 1.037618
Epoch 25
Loss = 9.0375e-04, PNorm = 62.1870, GNorm = 0.4248, lr_0 = 1.2909e-04
Loss = 1.1155e-03, PNorm = 62.1910, GNorm = 1.4373, lr_0 = 1.2362e-04
Validation rmse = 1.021459
Epoch 26
Loss = 1.0797e-03, PNorm = 62.1958, GNorm = 0.8096, lr_0 = 1.1839e-04
Validation rmse = 1.044196
Epoch 27
Loss = 1.1402e-03, PNorm = 62.1996, GNorm = 1.3568, lr_0 = 1.1288e-04
Loss = 9.5227e-04, PNorm = 62.2037, GNorm = 0.6305, lr_0 = 1.0810e-04
Validation rmse = 1.030948
Epoch 28
Loss = 5.8167e-04, PNorm = 62.2072, GNorm = 0.4056, lr_0 = 1.0352e-04
Loss = 9.8310e-04, PNorm = 62.2116, GNorm = 0.5259, lr_0 = 1.0000e-04
Validation rmse = 1.053572
Epoch 29
Loss = 6.1790e-04, PNorm = 62.2146, GNorm = 0.3789, lr_0 = 1.0000e-04
Loss = 9.4237e-04, PNorm = 62.2199, GNorm = 0.9293, lr_0 = 1.0000e-04
Validation rmse = 1.021707
Model 0 best validation rmse = 0.993166 on epoch 21
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.004174
Ensemble test rmse = 1.004174
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total scaffolds = 195 | train scaffolds = 55 | val scaffolds = 64 | test scaffolds = 76
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1704, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,405
Moving model to cuda
Epoch 0
Loss = 2.5304e-02, PNorm = 61.1129, GNorm = 9.5281, lr_0 = 3.6053e-04
Validation rmse = 1.595446
Epoch 1
Loss = 8.6875e-03, PNorm = 61.1862, GNorm = 1.8750, lr_0 = 6.2105e-04
Loss = 9.9504e-03, PNorm = 61.2932, GNorm = 3.4015, lr_0 = 8.5789e-04
Validation rmse = 1.623304
Epoch 2
Loss = 8.0132e-03, PNorm = 61.3961, GNorm = 3.1724, lr_0 = 9.8284e-04
Loss = 5.7724e-03, PNorm = 61.4892, GNorm = 3.9811, lr_0 = 9.4120e-04
Validation rmse = 1.560656
Epoch 3
Loss = 5.0880e-03, PNorm = 61.5520, GNorm = 2.3346, lr_0 = 8.9744e-04
Loss = 4.1826e-03, PNorm = 61.6002, GNorm = 2.9000, lr_0 = 8.5943e-04
Validation rmse = 1.485300
Epoch 4
Loss = 3.3101e-03, PNorm = 61.6366, GNorm = 2.3338, lr_0 = 8.2303e-04
Loss = 3.5728e-03, PNorm = 61.6810, GNorm = 3.9863, lr_0 = 7.8816e-04
Validation rmse = 1.363665
Epoch 5
Loss = 2.0221e-03, PNorm = 61.7196, GNorm = 1.3402, lr_0 = 7.5478e-04
Loss = 2.9132e-03, PNorm = 61.7541, GNorm = 0.6678, lr_0 = 7.2281e-04
Validation rmse = 1.234725
Epoch 6
Loss = 1.9248e-03, PNorm = 61.7944, GNorm = 0.5082, lr_0 = 6.8920e-04
Loss = 2.4313e-03, PNorm = 61.8239, GNorm = 0.9594, lr_0 = 6.6001e-04
Validation rmse = 1.287989
Epoch 7
Loss = 3.3635e-03, PNorm = 61.8531, GNorm = 4.5644, lr_0 = 6.3205e-04
Loss = 1.8765e-03, PNorm = 61.8830, GNorm = 0.7392, lr_0 = 6.0528e-04
Validation rmse = 1.361113
Epoch 8
Loss = 2.6654e-03, PNorm = 61.9133, GNorm = 1.9342, lr_0 = 5.7714e-04
Loss = 2.1405e-03, PNorm = 61.9408, GNorm = 0.5153, lr_0 = 5.5269e-04
Validation rmse = 1.231682
Epoch 9
Loss = 1.5973e-03, PNorm = 61.9591, GNorm = 0.7038, lr_0 = 5.2928e-04
Loss = 1.7114e-03, PNorm = 61.9821, GNorm = 0.6760, lr_0 = 5.0686e-04
Validation rmse = 1.194691
Epoch 10
Loss = 1.7693e-03, PNorm = 61.9982, GNorm = 0.7693, lr_0 = 4.8539e-04
Loss = 1.5544e-03, PNorm = 62.0152, GNorm = 0.4068, lr_0 = 4.6483e-04
Validation rmse = 1.191482
Epoch 11
Loss = 1.9815e-03, PNorm = 62.0365, GNorm = 0.4156, lr_0 = 4.4322e-04
Loss = 1.9930e-03, PNorm = 62.0562, GNorm = 1.6160, lr_0 = 4.2444e-04
Validation rmse = 1.134291
Epoch 12
Loss = 1.7627e-03, PNorm = 62.0747, GNorm = 0.7330, lr_0 = 4.0646e-04
Loss = 1.7345e-03, PNorm = 62.0891, GNorm = 1.2710, lr_0 = 3.8925e-04
Validation rmse = 1.194624
Epoch 13
Loss = 1.9942e-03, PNorm = 62.1026, GNorm = 0.9948, lr_0 = 3.7276e-04
Loss = 1.5633e-03, PNorm = 62.1154, GNorm = 0.6296, lr_0 = 3.5697e-04
Validation rmse = 1.184819
Epoch 14
Loss = 1.9282e-03, PNorm = 62.1305, GNorm = 1.3721, lr_0 = 3.4037e-04
Loss = 1.4512e-03, PNorm = 62.1431, GNorm = 0.5741, lr_0 = 3.2596e-04
Validation rmse = 1.218596
Epoch 15
Loss = 1.4055e-03, PNorm = 62.1553, GNorm = 1.3940, lr_0 = 3.1215e-04
Loss = 1.4238e-03, PNorm = 62.1654, GNorm = 0.9741, lr_0 = 2.9893e-04
Validation rmse = 1.166415
Epoch 16
Loss = 1.3581e-03, PNorm = 62.1766, GNorm = 1.1631, lr_0 = 2.8503e-04
Loss = 1.4331e-03, PNorm = 62.1842, GNorm = 1.8304, lr_0 = 2.7295e-04
Validation rmse = 1.129639
Epoch 17
Loss = 1.3440e-03, PNorm = 62.1941, GNorm = 1.9647, lr_0 = 2.6139e-04
Loss = 1.4936e-03, PNorm = 62.2028, GNorm = 1.5012, lr_0 = 2.5032e-04
Validation rmse = 1.226110
Epoch 18
Loss = 1.4171e-03, PNorm = 62.2137, GNorm = 0.5210, lr_0 = 2.3972e-04
Loss = 1.3445e-03, PNorm = 62.2220, GNorm = 0.5485, lr_0 = 2.2956e-04
Validation rmse = 1.142588
Epoch 19
Loss = 1.6229e-03, PNorm = 62.2311, GNorm = 1.5873, lr_0 = 2.1889e-04
Loss = 1.2776e-03, PNorm = 62.2413, GNorm = 0.8991, lr_0 = 2.0962e-04
Validation rmse = 1.111057
Epoch 20
Loss = 1.1468e-03, PNorm = 62.2458, GNorm = 0.7633, lr_0 = 2.0074e-04
Loss = 1.2458e-03, PNorm = 62.2541, GNorm = 1.1658, lr_0 = 1.9224e-04
Validation rmse = 1.126225
Epoch 21
Loss = 1.2910e-03, PNorm = 62.2596, GNorm = 1.2488, lr_0 = 1.8409e-04
Loss = 1.2633e-03, PNorm = 62.2658, GNorm = 0.9046, lr_0 = 1.7630e-04
Validation rmse = 1.186041
Epoch 22
Loss = 1.2864e-03, PNorm = 62.2730, GNorm = 0.8702, lr_0 = 1.6810e-04
Loss = 1.0582e-03, PNorm = 62.2794, GNorm = 0.5098, lr_0 = 1.6098e-04
Validation rmse = 1.110442
Epoch 23
Loss = 9.6911e-04, PNorm = 62.2858, GNorm = 1.5215, lr_0 = 1.5416e-04
Loss = 1.3179e-03, PNorm = 62.2916, GNorm = 0.5504, lr_0 = 1.4763e-04
Loss = 3.3773e-03, PNorm = 62.2919, GNorm = 1.5485, lr_0 = 1.4699e-04
Validation rmse = 1.113195
Epoch 24
Loss = 1.0305e-03, PNorm = 62.2972, GNorm = 2.0175, lr_0 = 1.4077e-04
Loss = 1.2980e-03, PNorm = 62.3014, GNorm = 0.6223, lr_0 = 1.3480e-04
Validation rmse = 1.157017
Epoch 25
Loss = 1.3215e-03, PNorm = 62.3070, GNorm = 0.4454, lr_0 = 1.2909e-04
Loss = 9.9256e-04, PNorm = 62.3117, GNorm = 1.0562, lr_0 = 1.2362e-04
Validation rmse = 1.100771
Epoch 26
Loss = 1.2486e-03, PNorm = 62.3170, GNorm = 0.6370, lr_0 = 1.1839e-04
Validation rmse = 1.122500
Epoch 27
Loss = 6.5631e-04, PNorm = 62.3214, GNorm = 0.3281, lr_0 = 1.1288e-04
Loss = 1.0728e-03, PNorm = 62.3255, GNorm = 0.9336, lr_0 = 1.0810e-04
Validation rmse = 1.097640
Epoch 28
Loss = 1.1547e-03, PNorm = 62.3295, GNorm = 0.6371, lr_0 = 1.0352e-04
Loss = 9.6299e-04, PNorm = 62.3338, GNorm = 0.6873, lr_0 = 1.0000e-04
Validation rmse = 1.132196
Epoch 29
Loss = 1.1991e-03, PNorm = 62.3384, GNorm = 1.0211, lr_0 = 1.0000e-04
Loss = 1.1727e-03, PNorm = 62.3417, GNorm = 1.1629, lr_0 = 1.0000e-04
Validation rmse = 1.107548
Model 0 best validation rmse = 1.097640 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.067208
Ensemble test rmse = 1.067208
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total scaffolds = 195 | train scaffolds = 80 | val scaffolds = 54 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1704, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,405
Moving model to cuda
Epoch 0
Loss = 2.4461e-02, PNorm = 61.1143, GNorm = 4.3285, lr_0 = 3.6053e-04
Validation rmse = 1.758214
Epoch 1
Loss = 7.6921e-03, PNorm = 61.1914, GNorm = 4.9907, lr_0 = 6.2105e-04
Loss = 8.3554e-03, PNorm = 61.2802, GNorm = 2.8248, lr_0 = 8.5789e-04
Validation rmse = 1.591539
Epoch 2
Loss = 4.4026e-03, PNorm = 61.3796, GNorm = 2.9023, lr_0 = 9.8284e-04
Loss = 5.4482e-03, PNorm = 61.4558, GNorm = 4.2742, lr_0 = 9.4120e-04
Validation rmse = 1.460024
Epoch 3
Loss = 4.0442e-03, PNorm = 61.5188, GNorm = 1.0190, lr_0 = 8.9744e-04
Loss = 3.1497e-03, PNorm = 61.5604, GNorm = 2.1637, lr_0 = 8.5943e-04
Validation rmse = 1.315168
Epoch 4
Loss = 2.0978e-03, PNorm = 61.5970, GNorm = 1.0555, lr_0 = 8.2303e-04
Loss = 3.1039e-03, PNorm = 61.6324, GNorm = 1.6319, lr_0 = 7.8816e-04
Validation rmse = 1.273233
Epoch 5
Loss = 2.0373e-03, PNorm = 61.6643, GNorm = 0.7940, lr_0 = 7.5478e-04
Loss = 2.2332e-03, PNorm = 61.6920, GNorm = 1.6566, lr_0 = 7.2281e-04
Validation rmse = 1.165474
Epoch 6
Loss = 2.1861e-03, PNorm = 61.7222, GNorm = 0.8194, lr_0 = 6.8920e-04
Loss = 1.9920e-03, PNorm = 61.7473, GNorm = 1.3082, lr_0 = 6.6001e-04
Validation rmse = 1.134174
Epoch 7
Loss = 1.5131e-03, PNorm = 61.7714, GNorm = 0.5335, lr_0 = 6.3205e-04
Loss = 1.6257e-03, PNorm = 61.7926, GNorm = 0.6442, lr_0 = 6.0528e-04
Validation rmse = 1.121004
Epoch 8
Loss = 1.9394e-03, PNorm = 61.8158, GNorm = 1.0202, lr_0 = 5.7714e-04
Loss = 1.4272e-03, PNorm = 61.8386, GNorm = 1.3592, lr_0 = 5.5269e-04
Validation rmse = 1.273402
Epoch 9
Loss = 1.9294e-03, PNorm = 61.8552, GNorm = 2.4317, lr_0 = 5.2928e-04
Loss = 1.5887e-03, PNorm = 61.8754, GNorm = 0.8314, lr_0 = 5.0686e-04
Validation rmse = 1.191780
Epoch 10
Loss = 1.9260e-03, PNorm = 61.8914, GNorm = 0.4641, lr_0 = 4.8539e-04
Loss = 1.6257e-03, PNorm = 61.9066, GNorm = 1.3318, lr_0 = 4.6483e-04
Validation rmse = 1.085267
Epoch 11
Loss = 1.0603e-03, PNorm = 61.9255, GNorm = 1.7583, lr_0 = 4.4322e-04
Loss = 1.5368e-03, PNorm = 61.9386, GNorm = 1.6923, lr_0 = 4.2444e-04
Validation rmse = 1.182480
Epoch 12
Loss = 1.3835e-03, PNorm = 61.9538, GNorm = 0.5633, lr_0 = 4.0646e-04
Loss = 1.2232e-03, PNorm = 61.9655, GNorm = 0.9114, lr_0 = 3.8925e-04
Validation rmse = 1.105603
Epoch 13
Loss = 1.2333e-03, PNorm = 61.9763, GNorm = 0.9286, lr_0 = 3.7276e-04
Loss = 1.2593e-03, PNorm = 61.9853, GNorm = 1.2123, lr_0 = 3.5697e-04
Validation rmse = 1.108657
Epoch 14
Loss = 1.2137e-03, PNorm = 61.9965, GNorm = 2.0958, lr_0 = 3.4037e-04
Loss = 1.1370e-03, PNorm = 62.0085, GNorm = 1.0054, lr_0 = 3.2596e-04
Validation rmse = 1.163144
Epoch 15
Loss = 1.3534e-03, PNorm = 62.0208, GNorm = 1.5002, lr_0 = 3.1215e-04
Loss = 1.2777e-03, PNorm = 62.0326, GNorm = 0.6943, lr_0 = 2.9893e-04
Validation rmse = 1.160219
Epoch 16
Loss = 1.2259e-03, PNorm = 62.0462, GNorm = 0.8806, lr_0 = 2.8503e-04
Loss = 1.2931e-03, PNorm = 62.0561, GNorm = 0.4876, lr_0 = 2.7295e-04
Validation rmse = 1.055035
Epoch 17
Loss = 8.8599e-04, PNorm = 62.0630, GNorm = 0.6820, lr_0 = 2.6139e-04
Loss = 1.1956e-03, PNorm = 62.0705, GNorm = 1.1945, lr_0 = 2.5032e-04
Validation rmse = 1.270859
Epoch 18
Loss = 1.1710e-03, PNorm = 62.0793, GNorm = 2.0915, lr_0 = 2.3972e-04
Loss = 1.0326e-03, PNorm = 62.0870, GNorm = 1.0377, lr_0 = 2.2956e-04
Validation rmse = 1.103372
Epoch 19
Loss = 1.0679e-03, PNorm = 62.0968, GNorm = 0.8766, lr_0 = 2.1889e-04
Loss = 1.1023e-03, PNorm = 62.1026, GNorm = 0.6335, lr_0 = 2.0962e-04
Validation rmse = 1.157680
Epoch 20
Loss = 1.0162e-03, PNorm = 62.1076, GNorm = 1.6186, lr_0 = 2.0074e-04
Loss = 1.1390e-03, PNorm = 62.1137, GNorm = 0.8397, lr_0 = 1.9224e-04
Validation rmse = 1.150705
Epoch 21
Loss = 8.7728e-04, PNorm = 62.1204, GNorm = 0.3194, lr_0 = 1.8409e-04
Loss = 1.0881e-03, PNorm = 62.1250, GNorm = 1.3950, lr_0 = 1.7630e-04
Validation rmse = 1.094905
Epoch 22
Loss = 1.0973e-03, PNorm = 62.1322, GNorm = 0.9026, lr_0 = 1.6810e-04
Loss = 9.1505e-04, PNorm = 62.1390, GNorm = 1.1351, lr_0 = 1.6098e-04
Validation rmse = 1.114602
Epoch 23
Loss = 8.9447e-04, PNorm = 62.1438, GNorm = 0.8446, lr_0 = 1.5416e-04
Loss = 8.3181e-04, PNorm = 62.1486, GNorm = 0.4782, lr_0 = 1.4763e-04
Loss = 1.4322e-03, PNorm = 62.1490, GNorm = 0.8081, lr_0 = 1.4699e-04
Validation rmse = 1.110906
Epoch 24
Loss = 8.9429e-04, PNorm = 62.1533, GNorm = 0.5486, lr_0 = 1.4077e-04
Loss = 8.9742e-04, PNorm = 62.1583, GNorm = 0.8497, lr_0 = 1.3480e-04
Validation rmse = 1.083001
Epoch 25
Loss = 8.7837e-04, PNorm = 62.1623, GNorm = 0.6048, lr_0 = 1.2909e-04
Loss = 9.2437e-04, PNorm = 62.1665, GNorm = 1.3666, lr_0 = 1.2362e-04
Validation rmse = 1.102506
Epoch 26
Loss = 9.2924e-04, PNorm = 62.1712, GNorm = 0.7435, lr_0 = 1.1839e-04
Validation rmse = 1.134958
Epoch 27
Loss = 1.4380e-03, PNorm = 62.1752, GNorm = 0.5354, lr_0 = 1.1288e-04
Loss = 8.3757e-04, PNorm = 62.1794, GNorm = 0.7031, lr_0 = 1.0810e-04
Validation rmse = 1.092736
Epoch 28
Loss = 6.0539e-04, PNorm = 62.1819, GNorm = 0.3800, lr_0 = 1.0352e-04
Loss = 8.5785e-04, PNorm = 62.1857, GNorm = 0.4635, lr_0 = 1.0000e-04
Validation rmse = 1.113895
Epoch 29
Loss = 9.6125e-04, PNorm = 62.1888, GNorm = 0.4376, lr_0 = 1.0000e-04
Loss = 8.1817e-04, PNorm = 62.1926, GNorm = 1.1031, lr_0 = 1.0000e-04
Validation rmse = 1.090643
Model 0 best validation rmse = 1.055035 on epoch 16
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.085986
Ensemble test rmse = 1.085986
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 49 | test scaffolds = 62
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1704, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,405
Moving model to cuda
Epoch 0
Loss = 2.0787e-02, PNorm = 61.1126, GNorm = 3.0529, lr_0 = 3.6053e-04
Validation rmse = 1.701211
Epoch 1
Loss = 1.2680e-02, PNorm = 61.1879, GNorm = 7.8294, lr_0 = 6.2105e-04
Loss = 7.4388e-03, PNorm = 61.2826, GNorm = 1.5275, lr_0 = 8.5789e-04
Validation rmse = 1.448766
Epoch 2
Loss = 5.9689e-03, PNorm = 61.3864, GNorm = 5.1690, lr_0 = 9.8284e-04
Loss = 6.7710e-03, PNorm = 61.4780, GNorm = 0.9945, lr_0 = 9.4120e-04
Validation rmse = 1.324892
Epoch 3
Loss = 4.4001e-03, PNorm = 61.5593, GNorm = 3.1192, lr_0 = 8.9744e-04
Loss = 4.0864e-03, PNorm = 61.6122, GNorm = 0.7211, lr_0 = 8.5943e-04
Validation rmse = 1.302241
Epoch 4
Loss = 4.2983e-03, PNorm = 61.6559, GNorm = 4.0460, lr_0 = 8.2303e-04
Loss = 2.6279e-03, PNorm = 61.6932, GNorm = 2.7167, lr_0 = 7.8816e-04
Validation rmse = 1.470171
Epoch 5
Loss = 3.0559e-03, PNorm = 61.7216, GNorm = 2.5808, lr_0 = 7.5478e-04
Loss = 2.8166e-03, PNorm = 61.7510, GNorm = 3.3605, lr_0 = 7.2281e-04
Validation rmse = 1.043185
Epoch 6
Loss = 1.8464e-03, PNorm = 61.7839, GNorm = 1.5209, lr_0 = 6.8920e-04
Loss = 2.0900e-03, PNorm = 61.8030, GNorm = 1.5017, lr_0 = 6.6001e-04
Validation rmse = 1.013807
Epoch 7
Loss = 1.4204e-03, PNorm = 61.8222, GNorm = 1.3593, lr_0 = 6.3205e-04
Loss = 2.4105e-03, PNorm = 61.8410, GNorm = 0.4123, lr_0 = 6.0528e-04
Validation rmse = 1.351380
Epoch 8
Loss = 2.0452e-03, PNorm = 61.8592, GNorm = 0.8088, lr_0 = 5.7714e-04
Loss = 1.8141e-03, PNorm = 61.8754, GNorm = 2.2404, lr_0 = 5.5269e-04
Validation rmse = 1.131949
Epoch 9
Loss = 1.4998e-03, PNorm = 61.8922, GNorm = 1.5305, lr_0 = 5.2928e-04
Loss = 1.9750e-03, PNorm = 61.9083, GNorm = 0.5498, lr_0 = 5.0686e-04
Validation rmse = 1.066042
Epoch 10
Loss = 1.8527e-03, PNorm = 61.9214, GNorm = 2.1663, lr_0 = 4.8539e-04
Loss = 1.8435e-03, PNorm = 61.9377, GNorm = 1.1622, lr_0 = 4.6483e-04
Validation rmse = 1.270006
Epoch 11
Loss = 1.8553e-03, PNorm = 61.9530, GNorm = 0.4090, lr_0 = 4.4322e-04
Loss = 1.6113e-03, PNorm = 61.9643, GNorm = 1.4059, lr_0 = 4.2444e-04
Validation rmse = 1.142146
Epoch 12
Loss = 1.2806e-03, PNorm = 61.9753, GNorm = 0.5954, lr_0 = 4.0646e-04
Loss = 1.4719e-03, PNorm = 61.9854, GNorm = 0.5889, lr_0 = 3.8925e-04
Validation rmse = 1.041754
Epoch 13
Loss = 1.2063e-03, PNorm = 61.9959, GNorm = 1.0591, lr_0 = 3.7276e-04
Loss = 1.5799e-03, PNorm = 62.0073, GNorm = 0.7892, lr_0 = 3.5697e-04
Validation rmse = 1.003584
Epoch 14
Loss = 1.4117e-03, PNorm = 62.0152, GNorm = 1.5169, lr_0 = 3.4037e-04
Loss = 1.5392e-03, PNorm = 62.0244, GNorm = 1.8105, lr_0 = 3.2596e-04
Validation rmse = 0.986055
Epoch 15
Loss = 1.2349e-03, PNorm = 62.0329, GNorm = 0.5544, lr_0 = 3.1215e-04
Loss = 1.5035e-03, PNorm = 62.0400, GNorm = 1.0673, lr_0 = 2.9893e-04
Validation rmse = 0.967068
Epoch 16
Loss = 1.1708e-03, PNorm = 62.0505, GNorm = 1.4173, lr_0 = 2.8503e-04
Loss = 1.5627e-03, PNorm = 62.0566, GNorm = 1.2871, lr_0 = 2.7295e-04
Validation rmse = 0.988809
Epoch 17
Loss = 1.1703e-03, PNorm = 62.0648, GNorm = 0.8861, lr_0 = 2.6139e-04
Loss = 1.2677e-03, PNorm = 62.0719, GNorm = 0.4685, lr_0 = 2.5032e-04
Validation rmse = 1.018207
Epoch 18
Loss = 1.4405e-03, PNorm = 62.0799, GNorm = 1.4494, lr_0 = 2.3972e-04
Loss = 1.2181e-03, PNorm = 62.0877, GNorm = 0.8298, lr_0 = 2.2956e-04
Validation rmse = 1.061430
Epoch 19
Loss = 1.3113e-03, PNorm = 62.0939, GNorm = 1.2822, lr_0 = 2.1889e-04
Loss = 1.2459e-03, PNorm = 62.1016, GNorm = 1.4823, lr_0 = 2.0962e-04
Validation rmse = 1.046010
Epoch 20
Loss = 1.2572e-03, PNorm = 62.1082, GNorm = 0.5383, lr_0 = 2.0074e-04
Loss = 1.2244e-03, PNorm = 62.1144, GNorm = 1.9755, lr_0 = 1.9224e-04
Validation rmse = 1.182456
Epoch 21
Loss = 1.0867e-03, PNorm = 62.1209, GNorm = 0.7259, lr_0 = 1.8409e-04
Loss = 1.3714e-03, PNorm = 62.1279, GNorm = 1.8502, lr_0 = 1.7630e-04
Validation rmse = 0.969361
Epoch 22
Loss = 1.0259e-03, PNorm = 62.1349, GNorm = 1.3517, lr_0 = 1.6810e-04
Loss = 1.3153e-03, PNorm = 62.1398, GNorm = 0.3667, lr_0 = 1.6098e-04
Validation rmse = 0.964020
Epoch 23
Loss = 1.1694e-03, PNorm = 62.1440, GNorm = 1.3805, lr_0 = 1.5416e-04
Loss = 1.1207e-03, PNorm = 62.1491, GNorm = 0.3319, lr_0 = 1.4763e-04
Loss = 1.4240e-03, PNorm = 62.1496, GNorm = 0.6950, lr_0 = 1.4699e-04
Validation rmse = 0.905486
Epoch 24
Loss = 1.0072e-03, PNorm = 62.1526, GNorm = 0.7024, lr_0 = 1.4077e-04
Loss = 1.2325e-03, PNorm = 62.1573, GNorm = 0.8216, lr_0 = 1.3480e-04
Validation rmse = 1.021914
Epoch 25
Loss = 1.0511e-03, PNorm = 62.1610, GNorm = 1.3104, lr_0 = 1.2909e-04
Loss = 1.2785e-03, PNorm = 62.1650, GNorm = 1.2859, lr_0 = 1.2362e-04
Validation rmse = 0.923087
Epoch 26
Loss = 1.0082e-03, PNorm = 62.1688, GNorm = 0.5227, lr_0 = 1.1839e-04
Validation rmse = 0.939457
Epoch 27
Loss = 1.1768e-03, PNorm = 62.1742, GNorm = 1.1199, lr_0 = 1.1288e-04
Loss = 8.6005e-04, PNorm = 62.1761, GNorm = 0.8767, lr_0 = 1.0810e-04
Validation rmse = 0.875895
Epoch 28
Loss = 6.5142e-04, PNorm = 62.1799, GNorm = 0.9937, lr_0 = 1.0352e-04
Loss = 9.9306e-04, PNorm = 62.1831, GNorm = 0.5757, lr_0 = 1.0000e-04
Validation rmse = 0.953546
Epoch 29
Loss = 9.0102e-04, PNorm = 62.1863, GNorm = 0.7337, lr_0 = 1.0000e-04
Loss = 1.0553e-03, PNorm = 62.1900, GNorm = 0.7783, lr_0 = 1.0000e-04
Validation rmse = 0.913626
Model 0 best validation rmse = 0.875895 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.088242
Ensemble test rmse = 1.088242
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total scaffolds = 195 | train scaffolds = 94 | val scaffolds = 55 | test scaffolds = 46
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1704, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,405
Moving model to cuda
Epoch 0
Loss = 1.7825e-02, PNorm = 61.1171, GNorm = 23.7170, lr_0 = 3.6053e-04
Validation rmse = 2.094448
Epoch 1
Loss = 9.6586e-03, PNorm = 61.1923, GNorm = 7.2479, lr_0 = 6.2105e-04
Loss = 5.8777e-03, PNorm = 61.2834, GNorm = 2.3667, lr_0 = 8.5789e-04
Validation rmse = 1.554980
Epoch 2
Loss = 3.5060e-03, PNorm = 61.3808, GNorm = 2.5329, lr_0 = 9.8284e-04
Loss = 4.3617e-03, PNorm = 61.4598, GNorm = 3.4388, lr_0 = 9.4120e-04
Validation rmse = 1.593997
Epoch 3
Loss = 5.4798e-03, PNorm = 61.5174, GNorm = 4.4258, lr_0 = 8.9744e-04
Loss = 4.0354e-03, PNorm = 61.5726, GNorm = 2.9429, lr_0 = 8.5943e-04
Validation rmse = 1.527549
Epoch 4
Loss = 2.8054e-03, PNorm = 61.6147, GNorm = 1.8150, lr_0 = 8.2303e-04
Loss = 3.0107e-03, PNorm = 61.6603, GNorm = 1.5151, lr_0 = 7.8816e-04
Validation rmse = 1.326744
Epoch 5
Loss = 2.0670e-03, PNorm = 61.6961, GNorm = 1.1922, lr_0 = 7.5478e-04
Loss = 2.6120e-03, PNorm = 61.7229, GNorm = 1.6077, lr_0 = 7.2281e-04
Validation rmse = 1.250742
Epoch 6
Loss = 2.6216e-03, PNorm = 61.7559, GNorm = 1.3236, lr_0 = 6.8920e-04
Loss = 2.2841e-03, PNorm = 61.7888, GNorm = 4.0999, lr_0 = 6.6001e-04
Validation rmse = 1.269615
Epoch 7
Loss = 2.0984e-03, PNorm = 61.8124, GNorm = 2.5888, lr_0 = 6.3205e-04
Loss = 1.7618e-03, PNorm = 61.8374, GNorm = 0.7557, lr_0 = 6.0528e-04
Validation rmse = 1.205076
Epoch 8
Loss = 2.3097e-03, PNorm = 61.8570, GNorm = 1.5276, lr_0 = 5.7714e-04
Loss = 2.3543e-03, PNorm = 61.8819, GNorm = 3.0136, lr_0 = 5.5269e-04
Validation rmse = 1.265423
Epoch 9
Loss = 2.1278e-03, PNorm = 61.9045, GNorm = 0.6628, lr_0 = 5.2928e-04
Loss = 2.2473e-03, PNorm = 61.9287, GNorm = 1.2438, lr_0 = 5.0686e-04
Validation rmse = 1.187958
Epoch 10
Loss = 1.4578e-03, PNorm = 61.9471, GNorm = 0.7475, lr_0 = 4.8539e-04
Loss = 1.7104e-03, PNorm = 61.9646, GNorm = 1.8018, lr_0 = 4.6483e-04
Validation rmse = 1.199378
Epoch 11
Loss = 1.2667e-03, PNorm = 61.9818, GNorm = 0.5852, lr_0 = 4.4322e-04
Loss = 1.5444e-03, PNorm = 61.9977, GNorm = 1.4896, lr_0 = 4.2444e-04
Validation rmse = 1.168913
Epoch 12
Loss = 1.1628e-03, PNorm = 62.0102, GNorm = 0.8133, lr_0 = 4.0646e-04
Loss = 1.5702e-03, PNorm = 62.0235, GNorm = 0.4373, lr_0 = 3.8925e-04
Validation rmse = 1.136908
Epoch 13
Loss = 1.2234e-03, PNorm = 62.0366, GNorm = 1.2835, lr_0 = 3.7276e-04
Loss = 1.4635e-03, PNorm = 62.0467, GNorm = 0.9596, lr_0 = 3.5697e-04
Validation rmse = 1.114607
Epoch 14
Loss = 1.4833e-03, PNorm = 62.0648, GNorm = 1.1352, lr_0 = 3.4037e-04
Loss = 1.2706e-03, PNorm = 62.0785, GNorm = 1.4740, lr_0 = 3.2596e-04
Validation rmse = 1.160422
Epoch 15
Loss = 1.4086e-03, PNorm = 62.0904, GNorm = 1.1674, lr_0 = 3.1215e-04
Loss = 1.3802e-03, PNorm = 62.1030, GNorm = 0.8683, lr_0 = 2.9893e-04
Validation rmse = 1.085767
Epoch 16
Loss = 1.3132e-03, PNorm = 62.1127, GNorm = 0.4892, lr_0 = 2.8503e-04
Loss = 1.3453e-03, PNorm = 62.1243, GNorm = 0.9621, lr_0 = 2.7295e-04
Validation rmse = 1.196834
Epoch 17
Loss = 1.1966e-03, PNorm = 62.1340, GNorm = 0.6620, lr_0 = 2.6139e-04
Loss = 1.2062e-03, PNorm = 62.1418, GNorm = 0.5491, lr_0 = 2.5032e-04
Validation rmse = 1.119542
Epoch 18
Loss = 1.1304e-03, PNorm = 62.1507, GNorm = 0.6956, lr_0 = 2.3972e-04
Loss = 1.2018e-03, PNorm = 62.1607, GNorm = 1.4702, lr_0 = 2.2956e-04
Validation rmse = 1.105303
Epoch 19
Loss = 1.0403e-03, PNorm = 62.1683, GNorm = 1.2228, lr_0 = 2.1889e-04
Loss = 1.2760e-03, PNorm = 62.1780, GNorm = 0.5685, lr_0 = 2.0962e-04
Validation rmse = 1.213059
Epoch 20
Loss = 1.1513e-03, PNorm = 62.1859, GNorm = 0.7941, lr_0 = 2.0074e-04
Loss = 1.2353e-03, PNorm = 62.1941, GNorm = 0.8662, lr_0 = 1.9224e-04
Validation rmse = 1.100149
Epoch 21
Loss = 1.0149e-03, PNorm = 62.2011, GNorm = 1.3834, lr_0 = 1.8409e-04
Loss = 1.1247e-03, PNorm = 62.2082, GNorm = 1.0479, lr_0 = 1.7630e-04
Validation rmse = 1.097860
Epoch 22
Loss = 9.1221e-04, PNorm = 62.2138, GNorm = 0.4859, lr_0 = 1.6810e-04
Loss = 1.2023e-03, PNorm = 62.2206, GNorm = 0.8502, lr_0 = 1.6098e-04
Validation rmse = 1.088519
Epoch 23
Loss = 1.1490e-03, PNorm = 62.2273, GNorm = 0.9082, lr_0 = 1.5416e-04
Loss = 9.4025e-04, PNorm = 62.2320, GNorm = 0.7577, lr_0 = 1.4763e-04
Loss = 7.9938e-04, PNorm = 62.2324, GNorm = 0.3985, lr_0 = 1.4699e-04
Validation rmse = 1.122763
Epoch 24
Loss = 9.8507e-04, PNorm = 62.2373, GNorm = 1.2462, lr_0 = 1.4077e-04
Loss = 1.1367e-03, PNorm = 62.2423, GNorm = 0.8006, lr_0 = 1.3480e-04
Validation rmse = 1.172602
Epoch 25
Loss = 9.4891e-04, PNorm = 62.2469, GNorm = 0.5562, lr_0 = 1.2909e-04
Loss = 1.0644e-03, PNorm = 62.2514, GNorm = 1.1368, lr_0 = 1.2362e-04
Validation rmse = 1.095418
Epoch 26
Loss = 9.1139e-04, PNorm = 62.2559, GNorm = 0.6528, lr_0 = 1.1839e-04
Validation rmse = 1.141403
Epoch 27
Loss = 1.3704e-03, PNorm = 62.2607, GNorm = 1.1932, lr_0 = 1.1288e-04
Loss = 8.7313e-04, PNorm = 62.2658, GNorm = 0.7825, lr_0 = 1.0810e-04
Validation rmse = 1.063106
Epoch 28
Loss = 8.0188e-04, PNorm = 62.2683, GNorm = 0.6541, lr_0 = 1.0352e-04
Loss = 9.5865e-04, PNorm = 62.2721, GNorm = 1.0555, lr_0 = 1.0000e-04
Validation rmse = 1.077575
Epoch 29
Loss = 7.3830e-04, PNorm = 62.2756, GNorm = 0.6981, lr_0 = 1.0000e-04
Loss = 9.7318e-04, PNorm = 62.2793, GNorm = 0.4725, lr_0 = 1.0000e-04
Validation rmse = 1.065552
Model 0 best validation rmse = 1.063106 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.161902
Ensemble test rmse = 1.161902
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total scaffolds = 195 | train scaffolds = 64 | val scaffolds = 68 | test scaffolds = 63
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1704, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,405
Moving model to cuda
Epoch 0
Loss = 1.7926e-02, PNorm = 61.1158, GNorm = 6.6807, lr_0 = 3.6053e-04
Validation rmse = 1.540937
Epoch 1
Loss = 9.7766e-03, PNorm = 61.1843, GNorm = 4.5135, lr_0 = 6.2105e-04
Loss = 9.4261e-03, PNorm = 61.2889, GNorm = 6.0501, lr_0 = 8.5789e-04
Validation rmse = 1.570284
Epoch 2
Loss = 5.7032e-03, PNorm = 61.4016, GNorm = 1.9637, lr_0 = 9.8284e-04
Loss = 5.2997e-03, PNorm = 61.4783, GNorm = 1.4512, lr_0 = 9.4120e-04
Validation rmse = 1.386239
Epoch 3
Loss = 2.6416e-03, PNorm = 61.5434, GNorm = 2.7107, lr_0 = 8.9744e-04
Loss = 3.1613e-03, PNorm = 61.5885, GNorm = 1.1306, lr_0 = 8.5943e-04
Validation rmse = 1.329499
Epoch 4
Loss = 2.3758e-03, PNorm = 61.6289, GNorm = 0.8328, lr_0 = 8.2303e-04
Loss = 2.6054e-03, PNorm = 61.6717, GNorm = 1.9545, lr_0 = 7.8816e-04
Validation rmse = 1.325304
Epoch 5
Loss = 2.1009e-03, PNorm = 61.7036, GNorm = 2.2356, lr_0 = 7.5478e-04
Loss = 2.2798e-03, PNorm = 61.7311, GNorm = 2.3092, lr_0 = 7.2281e-04
Validation rmse = 1.404962
Epoch 6
Loss = 1.8582e-03, PNorm = 61.7636, GNorm = 2.6795, lr_0 = 6.8920e-04
Loss = 2.0669e-03, PNorm = 61.7915, GNorm = 1.6373, lr_0 = 6.6001e-04
Validation rmse = 1.180294
Epoch 7
Loss = 2.1387e-03, PNorm = 61.8134, GNorm = 2.2385, lr_0 = 6.3205e-04
Loss = 1.7382e-03, PNorm = 61.8350, GNorm = 1.2949, lr_0 = 6.0528e-04
Validation rmse = 1.401457
Epoch 8
Loss = 2.2507e-03, PNorm = 61.8626, GNorm = 2.3658, lr_0 = 5.7714e-04
Loss = 2.2036e-03, PNorm = 61.8888, GNorm = 0.5935, lr_0 = 5.5269e-04
Validation rmse = 1.349239
Epoch 9
Loss = 1.8371e-03, PNorm = 61.9113, GNorm = 2.5550, lr_0 = 5.2928e-04
Loss = 1.6922e-03, PNorm = 61.9335, GNorm = 1.1106, lr_0 = 5.0686e-04
Validation rmse = 1.161008
Epoch 10
Loss = 1.8903e-03, PNorm = 61.9555, GNorm = 1.1899, lr_0 = 4.8539e-04
Loss = 1.3026e-03, PNorm = 61.9736, GNorm = 1.4425, lr_0 = 4.6483e-04
Validation rmse = 1.051145
Epoch 11
Loss = 1.8245e-03, PNorm = 61.9903, GNorm = 0.4783, lr_0 = 4.4322e-04
Loss = 1.3272e-03, PNorm = 62.0049, GNorm = 2.0448, lr_0 = 4.2444e-04
Validation rmse = 1.086997
Epoch 12
Loss = 1.2535e-03, PNorm = 62.0186, GNorm = 0.7656, lr_0 = 4.0646e-04
Loss = 1.4333e-03, PNorm = 62.0312, GNorm = 1.7253, lr_0 = 3.8925e-04
Validation rmse = 1.100332
Epoch 13
Loss = 1.2744e-03, PNorm = 62.0463, GNorm = 0.8851, lr_0 = 3.7276e-04
Loss = 1.2843e-03, PNorm = 62.0612, GNorm = 0.7859, lr_0 = 3.5697e-04
Validation rmse = 1.243786
Epoch 14
Loss = 1.1261e-03, PNorm = 62.0736, GNorm = 0.9180, lr_0 = 3.4037e-04
Loss = 1.4776e-03, PNorm = 62.0864, GNorm = 1.0527, lr_0 = 3.2596e-04
Validation rmse = 1.069976
Epoch 15
Loss = 1.2335e-03, PNorm = 62.0964, GNorm = 1.4579, lr_0 = 3.1215e-04
Loss = 1.2765e-03, PNorm = 62.1084, GNorm = 1.8759, lr_0 = 2.9893e-04
Validation rmse = 1.136548
Epoch 16
Loss = 1.2994e-03, PNorm = 62.1228, GNorm = 1.0477, lr_0 = 2.8503e-04
Loss = 1.2544e-03, PNorm = 62.1318, GNorm = 2.7149, lr_0 = 2.7295e-04
Validation rmse = 1.200073
Epoch 17
Loss = 1.3013e-03, PNorm = 62.1427, GNorm = 0.4807, lr_0 = 2.6139e-04
Loss = 1.4006e-03, PNorm = 62.1485, GNorm = 2.1943, lr_0 = 2.5032e-04
Validation rmse = 1.228877
Epoch 18
Loss = 1.6937e-03, PNorm = 62.1605, GNorm = 1.8637, lr_0 = 2.3972e-04
Loss = 1.3099e-03, PNorm = 62.1708, GNorm = 0.9263, lr_0 = 2.2956e-04
Validation rmse = 1.084547
Epoch 19
Loss = 1.0125e-03, PNorm = 62.1833, GNorm = 0.4881, lr_0 = 2.1889e-04
Loss = 1.1184e-03, PNorm = 62.1913, GNorm = 0.7829, lr_0 = 2.0962e-04
Validation rmse = 1.088429
Epoch 20
Loss = 1.0331e-03, PNorm = 62.1981, GNorm = 0.4919, lr_0 = 2.0074e-04
Loss = 9.6159e-04, PNorm = 62.2038, GNorm = 0.4476, lr_0 = 1.9224e-04
Validation rmse = 1.085143
Epoch 21
Loss = 9.1838e-04, PNorm = 62.2119, GNorm = 0.7710, lr_0 = 1.8409e-04
Loss = 9.5923e-04, PNorm = 62.2181, GNorm = 0.8546, lr_0 = 1.7630e-04
Validation rmse = 1.154203
Epoch 22
Loss = 1.0879e-03, PNorm = 62.2244, GNorm = 0.6284, lr_0 = 1.6810e-04
Loss = 8.6950e-04, PNorm = 62.2297, GNorm = 0.8102, lr_0 = 1.6098e-04
Validation rmse = 1.065376
Epoch 23
Loss = 9.3208e-04, PNorm = 62.2362, GNorm = 0.6311, lr_0 = 1.5416e-04
Loss = 9.6725e-04, PNorm = 62.2415, GNorm = 0.5063, lr_0 = 1.4763e-04
Loss = 2.2096e-03, PNorm = 62.2420, GNorm = 0.9844, lr_0 = 1.4699e-04
Validation rmse = 1.062857
Epoch 24
Loss = 9.8159e-04, PNorm = 62.2479, GNorm = 0.9672, lr_0 = 1.4077e-04
Loss = 9.4630e-04, PNorm = 62.2526, GNorm = 0.5595, lr_0 = 1.3480e-04
Validation rmse = 1.117757
Epoch 25
Loss = 9.0710e-04, PNorm = 62.2565, GNorm = 1.2344, lr_0 = 1.2909e-04
Loss = 9.5555e-04, PNorm = 62.2615, GNorm = 0.9278, lr_0 = 1.2362e-04
Validation rmse = 1.037079
Epoch 26
Loss = 8.6521e-04, PNorm = 62.2657, GNorm = 0.5772, lr_0 = 1.1839e-04
Validation rmse = 1.049540
Epoch 27
Loss = 1.2324e-03, PNorm = 62.2705, GNorm = 1.2335, lr_0 = 1.1288e-04
Loss = 7.9213e-04, PNorm = 62.2746, GNorm = 0.7038, lr_0 = 1.0810e-04
Validation rmse = 1.068078
Epoch 28
Loss = 8.3100e-04, PNorm = 62.2783, GNorm = 1.0368, lr_0 = 1.0352e-04
Loss = 9.4193e-04, PNorm = 62.2815, GNorm = 0.6199, lr_0 = 1.0000e-04
Validation rmse = 1.118102
Epoch 29
Loss = 9.1261e-04, PNorm = 62.2856, GNorm = 1.0780, lr_0 = 1.0000e-04
Loss = 8.8425e-04, PNorm = 62.2895, GNorm = 1.0124, lr_0 = 1.0000e-04
Validation rmse = 1.053264
Model 0 best validation rmse = 1.037079 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.980438
Ensemble test rmse = 0.980438
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total scaffolds = 195 | train scaffolds = 69 | val scaffolds = 65 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1704, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,405
Moving model to cuda
Epoch 0
Loss = 1.8132e-02, PNorm = 61.1145, GNorm = 3.7025, lr_0 = 3.6053e-04
Validation rmse = 1.589882
Epoch 1
Loss = 9.2270e-03, PNorm = 61.1899, GNorm = 7.7579, lr_0 = 6.2105e-04
Loss = 8.0970e-03, PNorm = 61.2894, GNorm = 4.4836, lr_0 = 8.5789e-04
Validation rmse = 2.083600
Epoch 2
Loss = 4.8567e-03, PNorm = 61.3967, GNorm = 3.4733, lr_0 = 9.8284e-04
Loss = 4.6466e-03, PNorm = 61.4827, GNorm = 2.9154, lr_0 = 9.4120e-04
Validation rmse = 1.636817
Epoch 3
Loss = 4.7653e-03, PNorm = 61.5436, GNorm = 4.9044, lr_0 = 8.9744e-04
Loss = 4.1515e-03, PNorm = 61.6001, GNorm = 2.1395, lr_0 = 8.5943e-04
Validation rmse = 1.519407
Epoch 4
Loss = 3.2974e-03, PNorm = 61.6338, GNorm = 3.3016, lr_0 = 8.2303e-04
Loss = 3.5030e-03, PNorm = 61.6720, GNorm = 2.2723, lr_0 = 7.8816e-04
Validation rmse = 1.486789
Epoch 5
Loss = 2.3343e-03, PNorm = 61.7118, GNorm = 0.8218, lr_0 = 7.5478e-04
Loss = 2.2092e-03, PNorm = 61.7427, GNorm = 1.3293, lr_0 = 7.2281e-04
Validation rmse = 1.776718
Epoch 6
Loss = 4.5068e-03, PNorm = 61.7722, GNorm = 5.2496, lr_0 = 6.8920e-04
Loss = 3.4198e-03, PNorm = 61.8094, GNorm = 0.8310, lr_0 = 6.6001e-04
Validation rmse = 1.714689
Epoch 7
Loss = 2.3710e-03, PNorm = 61.8428, GNorm = 4.7485, lr_0 = 6.3205e-04
Loss = 3.1188e-03, PNorm = 61.8692, GNorm = 1.4140, lr_0 = 6.0528e-04
Validation rmse = 1.389521
Epoch 8
Loss = 2.0392e-03, PNorm = 61.8965, GNorm = 1.1146, lr_0 = 5.7714e-04
Loss = 2.3189e-03, PNorm = 61.9176, GNorm = 1.9378, lr_0 = 5.5269e-04
Validation rmse = 1.455826
Epoch 9
Loss = 1.8291e-03, PNorm = 61.9352, GNorm = 0.7470, lr_0 = 5.2928e-04
Loss = 1.7746e-03, PNorm = 61.9533, GNorm = 1.0025, lr_0 = 5.0686e-04
Validation rmse = 1.513493
Epoch 10
Loss = 1.9742e-03, PNorm = 61.9638, GNorm = 1.6842, lr_0 = 4.8539e-04
Loss = 1.6075e-03, PNorm = 61.9773, GNorm = 0.9519, lr_0 = 4.6483e-04
Validation rmse = 1.375036
Epoch 11
Loss = 1.5532e-03, PNorm = 61.9966, GNorm = 0.7217, lr_0 = 4.4322e-04
Loss = 1.6089e-03, PNorm = 62.0079, GNorm = 0.8962, lr_0 = 4.2444e-04
Validation rmse = 1.273210
Epoch 12
Loss = 1.4004e-03, PNorm = 62.0239, GNorm = 0.6676, lr_0 = 4.0646e-04
Loss = 1.5152e-03, PNorm = 62.0362, GNorm = 1.4353, lr_0 = 3.8925e-04
Validation rmse = 1.260293
Epoch 13
Loss = 1.9630e-03, PNorm = 62.0474, GNorm = 2.0521, lr_0 = 3.7276e-04
Loss = 1.7553e-03, PNorm = 62.0613, GNorm = 1.6136, lr_0 = 3.5697e-04
Validation rmse = 1.457282
Epoch 14
Loss = 1.5156e-03, PNorm = 62.0738, GNorm = 1.2892, lr_0 = 3.4037e-04
Loss = 1.4006e-03, PNorm = 62.0860, GNorm = 1.1873, lr_0 = 3.2596e-04
Validation rmse = 1.358388
Epoch 15
Loss = 1.2532e-03, PNorm = 62.0963, GNorm = 1.7074, lr_0 = 3.1215e-04
Loss = 1.4469e-03, PNorm = 62.1068, GNorm = 0.6068, lr_0 = 2.9893e-04
Validation rmse = 1.581791
Epoch 16
Loss = 1.4082e-03, PNorm = 62.1206, GNorm = 0.9826, lr_0 = 2.8503e-04
Loss = 1.3076e-03, PNorm = 62.1286, GNorm = 0.6591, lr_0 = 2.7295e-04
Validation rmse = 1.527445
Epoch 17
Loss = 1.2469e-03, PNorm = 62.1402, GNorm = 0.6322, lr_0 = 2.6139e-04
Loss = 1.4168e-03, PNorm = 62.1472, GNorm = 0.5377, lr_0 = 2.5032e-04
Validation rmse = 1.389617
Epoch 18
Loss = 1.0682e-03, PNorm = 62.1547, GNorm = 1.2943, lr_0 = 2.3972e-04
Loss = 1.2763e-03, PNorm = 62.1627, GNorm = 0.5325, lr_0 = 2.2956e-04
Validation rmse = 1.396679
Epoch 19
Loss = 1.2834e-03, PNorm = 62.1704, GNorm = 0.8922, lr_0 = 2.1889e-04
Loss = 1.1063e-03, PNorm = 62.1780, GNorm = 0.4830, lr_0 = 2.0962e-04
Validation rmse = 1.343806
Epoch 20
Loss = 1.3052e-03, PNorm = 62.1842, GNorm = 0.6235, lr_0 = 2.0074e-04
Loss = 1.0001e-03, PNorm = 62.1910, GNorm = 0.5163, lr_0 = 1.9224e-04
Validation rmse = 1.385071
Epoch 21
Loss = 1.1571e-03, PNorm = 62.1966, GNorm = 1.3309, lr_0 = 1.8409e-04
Loss = 1.2317e-03, PNorm = 62.2038, GNorm = 0.5347, lr_0 = 1.7630e-04
Validation rmse = 1.486720
Epoch 22
Loss = 1.2019e-03, PNorm = 62.2097, GNorm = 2.2214, lr_0 = 1.6810e-04
Loss = 1.1351e-03, PNorm = 62.2174, GNorm = 0.7447, lr_0 = 1.6098e-04
Validation rmse = 1.324417
Epoch 23
Loss = 1.1361e-03, PNorm = 62.2230, GNorm = 0.4486, lr_0 = 1.5416e-04
Loss = 1.0130e-03, PNorm = 62.2277, GNorm = 0.8899, lr_0 = 1.4763e-04
Loss = 1.8655e-03, PNorm = 62.2282, GNorm = 1.4837, lr_0 = 1.4699e-04
Validation rmse = 1.298446
Epoch 24
Loss = 1.0759e-03, PNorm = 62.2327, GNorm = 0.6743, lr_0 = 1.4077e-04
Loss = 1.2370e-03, PNorm = 62.2383, GNorm = 1.0246, lr_0 = 1.3480e-04
Validation rmse = 1.280973
Epoch 25
Loss = 1.0376e-03, PNorm = 62.2423, GNorm = 0.6202, lr_0 = 1.2909e-04
Loss = 1.1905e-03, PNorm = 62.2480, GNorm = 1.0946, lr_0 = 1.2362e-04
Validation rmse = 1.376484
Epoch 26
Loss = 1.0580e-03, PNorm = 62.2512, GNorm = 1.1992, lr_0 = 1.1839e-04
Validation rmse = 1.388099
Epoch 27
Loss = 7.3106e-04, PNorm = 62.2548, GNorm = 0.9590, lr_0 = 1.1288e-04
Loss = 8.5547e-04, PNorm = 62.2591, GNorm = 1.2741, lr_0 = 1.0810e-04
Validation rmse = 1.362857
Epoch 28
Loss = 8.4726e-04, PNorm = 62.2627, GNorm = 0.4873, lr_0 = 1.0352e-04
Loss = 9.1780e-04, PNorm = 62.2672, GNorm = 0.7728, lr_0 = 1.0000e-04
Validation rmse = 1.394870
Epoch 29
Loss = 1.3594e-03, PNorm = 62.2703, GNorm = 0.9746, lr_0 = 1.0000e-04
Loss = 8.5949e-04, PNorm = 62.2733, GNorm = 0.6356, lr_0 = 1.0000e-04
Validation rmse = 1.335369
Model 0 best validation rmse = 1.260293 on epoch 12
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.147493
Ensemble test rmse = 1.147493
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total scaffolds = 195 | train scaffolds = 75 | val scaffolds = 42 | test scaffolds = 78
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1704, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,405
Moving model to cuda
Epoch 0
Loss = 2.2762e-02, PNorm = 61.1126, GNorm = 3.3085, lr_0 = 3.6053e-04
Validation rmse = 2.035955
Epoch 1
Loss = 8.6383e-03, PNorm = 61.1857, GNorm = 6.3195, lr_0 = 6.2105e-04
Loss = 7.4034e-03, PNorm = 61.2783, GNorm = 1.1460, lr_0 = 8.5789e-04
Validation rmse = 1.851501
Epoch 2
Loss = 6.4011e-03, PNorm = 61.3685, GNorm = 3.5297, lr_0 = 9.8284e-04
Loss = 4.0886e-03, PNorm = 61.4466, GNorm = 2.7910, lr_0 = 9.4120e-04
Validation rmse = 1.576824
Epoch 3
Loss = 4.1527e-03, PNorm = 61.4979, GNorm = 2.3208, lr_0 = 8.9744e-04
Loss = 3.6384e-03, PNorm = 61.5401, GNorm = 4.7562, lr_0 = 8.5943e-04
Validation rmse = 1.522027
Epoch 4
Loss = 2.9988e-03, PNorm = 61.5733, GNorm = 1.3351, lr_0 = 8.2303e-04
Loss = 2.8202e-03, PNorm = 61.6003, GNorm = 2.7628, lr_0 = 7.8816e-04
Validation rmse = 1.270337
Epoch 5
Loss = 1.7888e-03, PNorm = 61.6294, GNorm = 2.3789, lr_0 = 7.5478e-04
Loss = 2.3003e-03, PNorm = 61.6582, GNorm = 0.8267, lr_0 = 7.2281e-04
Validation rmse = 1.296300
Epoch 6
Loss = 1.5829e-03, PNorm = 61.6803, GNorm = 0.9970, lr_0 = 6.8920e-04
Loss = 2.1526e-03, PNorm = 61.7002, GNorm = 2.9329, lr_0 = 6.6001e-04
Validation rmse = 1.234862
Epoch 7
Loss = 2.3155e-03, PNorm = 61.7245, GNorm = 3.7011, lr_0 = 6.3205e-04
Loss = 2.1899e-03, PNorm = 61.7477, GNorm = 1.5272, lr_0 = 6.0528e-04
Validation rmse = 1.226383
Epoch 8
Loss = 2.1616e-03, PNorm = 61.7705, GNorm = 1.6340, lr_0 = 5.7714e-04
Loss = 1.6195e-03, PNorm = 61.7882, GNorm = 3.0329, lr_0 = 5.5269e-04
Validation rmse = 1.249248
Epoch 9
Loss = 1.6115e-03, PNorm = 61.8067, GNorm = 2.8859, lr_0 = 5.2928e-04
Loss = 1.5399e-03, PNorm = 61.8266, GNorm = 0.5389, lr_0 = 5.0686e-04
Validation rmse = 1.221795
Epoch 10
Loss = 1.3405e-03, PNorm = 61.8414, GNorm = 0.8438, lr_0 = 4.8539e-04
Loss = 1.6487e-03, PNorm = 61.8547, GNorm = 0.9665, lr_0 = 4.6483e-04
Validation rmse = 1.124101
Epoch 11
Loss = 1.7838e-03, PNorm = 61.8667, GNorm = 2.2669, lr_0 = 4.4322e-04
Loss = 1.3310e-03, PNorm = 61.8782, GNorm = 0.8879, lr_0 = 4.2444e-04
Validation rmse = 1.146714
Epoch 12
Loss = 1.3293e-03, PNorm = 61.8912, GNorm = 1.7706, lr_0 = 4.0646e-04
Loss = 1.2448e-03, PNorm = 61.9036, GNorm = 0.8178, lr_0 = 3.8925e-04
Validation rmse = 1.093675
Epoch 13
Loss = 1.1267e-03, PNorm = 61.9140, GNorm = 0.7001, lr_0 = 3.7276e-04
Loss = 1.2591e-03, PNorm = 61.9242, GNorm = 0.6234, lr_0 = 3.5697e-04
Validation rmse = 1.035772
Epoch 14
Loss = 1.2741e-03, PNorm = 61.9368, GNorm = 0.5556, lr_0 = 3.4037e-04
Loss = 1.3627e-03, PNorm = 61.9456, GNorm = 2.0768, lr_0 = 3.2596e-04
Validation rmse = 1.087029
Epoch 15
Loss = 1.4204e-03, PNorm = 61.9529, GNorm = 2.3443, lr_0 = 3.1215e-04
Loss = 1.5414e-03, PNorm = 61.9641, GNorm = 0.5030, lr_0 = 2.9893e-04
Validation rmse = 1.122075
Epoch 16
Loss = 1.2433e-03, PNorm = 61.9762, GNorm = 1.0713, lr_0 = 2.8503e-04
Loss = 1.2374e-03, PNorm = 61.9865, GNorm = 0.5154, lr_0 = 2.7295e-04
Validation rmse = 1.090781
Epoch 17
Loss = 1.1308e-03, PNorm = 61.9929, GNorm = 0.6403, lr_0 = 2.6139e-04
Loss = 1.1960e-03, PNorm = 62.0030, GNorm = 0.6090, lr_0 = 2.5032e-04
Validation rmse = 1.085474
Epoch 18
Loss = 1.0733e-03, PNorm = 62.0091, GNorm = 1.0120, lr_0 = 2.3972e-04
Loss = 1.1884e-03, PNorm = 62.0144, GNorm = 1.0757, lr_0 = 2.2956e-04
Validation rmse = 1.115346
Epoch 19
Loss = 1.2661e-03, PNorm = 62.0214, GNorm = 1.3884, lr_0 = 2.1889e-04
Loss = 1.2611e-03, PNorm = 62.0262, GNorm = 0.8308, lr_0 = 2.0962e-04
Validation rmse = 1.104844
Epoch 20
Loss = 1.0790e-03, PNorm = 62.0358, GNorm = 0.4474, lr_0 = 2.0074e-04
Loss = 1.3340e-03, PNorm = 62.0413, GNorm = 0.5581, lr_0 = 1.9224e-04
Validation rmse = 1.064585
Epoch 21
Loss = 1.0568e-03, PNorm = 62.0489, GNorm = 1.6299, lr_0 = 1.8409e-04
Loss = 1.3618e-03, PNorm = 62.0557, GNorm = 1.0324, lr_0 = 1.7630e-04
Validation rmse = 1.123497
Epoch 22
Loss = 1.1568e-03, PNorm = 62.0632, GNorm = 0.6625, lr_0 = 1.6810e-04
Loss = 1.1593e-03, PNorm = 62.0690, GNorm = 1.3507, lr_0 = 1.6098e-04
Validation rmse = 1.038660
Epoch 23
Loss = 1.1036e-03, PNorm = 62.0741, GNorm = 0.8288, lr_0 = 1.5416e-04
Loss = 1.0526e-03, PNorm = 62.0788, GNorm = 0.9011, lr_0 = 1.4763e-04
Loss = 1.4371e-03, PNorm = 62.0792, GNorm = 1.6124, lr_0 = 1.4699e-04
Validation rmse = 1.086714
Epoch 24
Loss = 1.0087e-03, PNorm = 62.0831, GNorm = 0.4561, lr_0 = 1.4077e-04
Loss = 1.0334e-03, PNorm = 62.0890, GNorm = 1.0252, lr_0 = 1.3480e-04
Validation rmse = 1.058275
Epoch 25
Loss = 1.0407e-03, PNorm = 62.0928, GNorm = 0.9884, lr_0 = 1.2909e-04
Loss = 9.4020e-04, PNorm = 62.0976, GNorm = 0.8017, lr_0 = 1.2362e-04
Validation rmse = 1.046113
Epoch 26
Loss = 1.1271e-03, PNorm = 62.1022, GNorm = 0.5540, lr_0 = 1.1839e-04
Validation rmse = 1.077046
Epoch 27
Loss = 2.1678e-03, PNorm = 62.1057, GNorm = 2.4932, lr_0 = 1.1288e-04
Loss = 8.8966e-04, PNorm = 62.1088, GNorm = 1.6523, lr_0 = 1.0810e-04
Validation rmse = 1.046230
Epoch 28
Loss = 7.0983e-04, PNorm = 62.1123, GNorm = 0.4967, lr_0 = 1.0352e-04
Loss = 9.5117e-04, PNorm = 62.1146, GNorm = 1.1472, lr_0 = 1.0000e-04
Validation rmse = 1.101350
Epoch 29
Loss = 7.8414e-04, PNorm = 62.1197, GNorm = 0.6566, lr_0 = 1.0000e-04
Loss = 7.9007e-04, PNorm = 62.1226, GNorm = 0.6311, lr_0 = 1.0000e-04
Validation rmse = 1.038377
Model 0 best validation rmse = 1.035772 on epoch 13
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.122780
Ensemble test rmse = 1.122780
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 58 | test scaffolds = 53
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1704, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,405
Moving model to cuda
Epoch 0
Loss = 1.5833e-02, PNorm = 61.1148, GNorm = 2.9536, lr_0 = 3.6053e-04
Validation rmse = 1.799889
Epoch 1
Loss = 7.0771e-03, PNorm = 61.1881, GNorm = 5.3009, lr_0 = 6.2105e-04
Loss = 7.1675e-03, PNorm = 61.2850, GNorm = 2.3903, lr_0 = 8.5789e-04
Validation rmse = 2.097388
Epoch 2
Loss = 1.1555e-02, PNorm = 61.3862, GNorm = 7.9378, lr_0 = 9.8284e-04
Loss = 6.2214e-03, PNorm = 61.4764, GNorm = 4.7936, lr_0 = 9.4120e-04
Validation rmse = 1.879492
Epoch 3
Loss = 8.7888e-03, PNorm = 61.5514, GNorm = 5.8141, lr_0 = 8.9744e-04
Loss = 5.3102e-03, PNorm = 61.6136, GNorm = 2.2288, lr_0 = 8.5943e-04
Validation rmse = 1.269834
Epoch 4
Loss = 5.0331e-03, PNorm = 61.6592, GNorm = 5.2682, lr_0 = 8.2303e-04
Loss = 3.0669e-03, PNorm = 61.6970, GNorm = 1.5576, lr_0 = 7.8816e-04
Validation rmse = 1.238411
Epoch 5
Loss = 1.9151e-03, PNorm = 61.7275, GNorm = 0.6820, lr_0 = 7.5478e-04
Loss = 2.8749e-03, PNorm = 61.7568, GNorm = 1.0540, lr_0 = 7.2281e-04
Validation rmse = 1.085195
Epoch 6
Loss = 2.7425e-03, PNorm = 61.7850, GNorm = 1.0532, lr_0 = 6.8920e-04
Loss = 2.5634e-03, PNorm = 61.8064, GNorm = 2.7077, lr_0 = 6.6001e-04
Validation rmse = 1.157274
Epoch 7
Loss = 2.5091e-03, PNorm = 61.8285, GNorm = 1.5640, lr_0 = 6.3205e-04
Loss = 2.2854e-03, PNorm = 61.8536, GNorm = 2.0544, lr_0 = 6.0528e-04
Validation rmse = 1.113483
Epoch 8
Loss = 1.6960e-03, PNorm = 61.8752, GNorm = 0.8339, lr_0 = 5.7714e-04
Loss = 1.8982e-03, PNorm = 61.8938, GNorm = 1.1743, lr_0 = 5.5269e-04
Validation rmse = 1.055053
Epoch 9
Loss = 2.2808e-03, PNorm = 61.9142, GNorm = 3.2329, lr_0 = 5.2928e-04
Loss = 1.5492e-03, PNorm = 61.9362, GNorm = 0.7017, lr_0 = 5.0686e-04
Validation rmse = 1.016881
Epoch 10
Loss = 1.6361e-03, PNorm = 61.9512, GNorm = 0.9690, lr_0 = 4.8539e-04
Loss = 1.6917e-03, PNorm = 61.9651, GNorm = 0.9389, lr_0 = 4.6483e-04
Validation rmse = 1.026803
Epoch 11
Loss = 1.8287e-03, PNorm = 61.9818, GNorm = 0.9204, lr_0 = 4.4322e-04
Loss = 1.8517e-03, PNorm = 61.9970, GNorm = 1.7817, lr_0 = 4.2444e-04
Validation rmse = 1.054686
Epoch 12
Loss = 1.5620e-03, PNorm = 62.0115, GNorm = 0.6728, lr_0 = 4.0646e-04
Loss = 1.8469e-03, PNorm = 62.0253, GNorm = 1.3371, lr_0 = 3.8925e-04
Validation rmse = 0.957899
Epoch 13
Loss = 1.4515e-03, PNorm = 62.0370, GNorm = 1.2064, lr_0 = 3.7276e-04
Loss = 1.4743e-03, PNorm = 62.0480, GNorm = 0.8326, lr_0 = 3.5697e-04
Validation rmse = 1.036293
Epoch 14
Loss = 1.5164e-03, PNorm = 62.0635, GNorm = 1.2302, lr_0 = 3.4037e-04
Loss = 1.4135e-03, PNorm = 62.0741, GNorm = 0.5182, lr_0 = 3.2596e-04
Validation rmse = 0.950738
Epoch 15
Loss = 1.0901e-03, PNorm = 62.0829, GNorm = 0.9483, lr_0 = 3.1215e-04
Loss = 1.6016e-03, PNorm = 62.0918, GNorm = 1.5998, lr_0 = 2.9893e-04
Validation rmse = 0.931801
Epoch 16
Loss = 1.5425e-03, PNorm = 62.1029, GNorm = 1.9664, lr_0 = 2.8503e-04
Loss = 1.3753e-03, PNorm = 62.1140, GNorm = 0.7665, lr_0 = 2.7295e-04
Validation rmse = 0.955540
Epoch 17
Loss = 1.3423e-03, PNorm = 62.1239, GNorm = 0.5437, lr_0 = 2.6139e-04
Loss = 1.5355e-03, PNorm = 62.1317, GNorm = 0.9739, lr_0 = 2.5032e-04
Validation rmse = 0.928018
Epoch 18
Loss = 1.1371e-03, PNorm = 62.1424, GNorm = 0.3828, lr_0 = 2.3972e-04
Loss = 1.5221e-03, PNorm = 62.1508, GNorm = 0.8121, lr_0 = 2.2956e-04
Validation rmse = 0.883694
Epoch 19
Loss = 1.3407e-03, PNorm = 62.1576, GNorm = 0.9494, lr_0 = 2.1889e-04
Loss = 1.3770e-03, PNorm = 62.1670, GNorm = 0.6720, lr_0 = 2.0962e-04
Validation rmse = 0.981454
Epoch 20
Loss = 1.5186e-03, PNorm = 62.1755, GNorm = 0.7268, lr_0 = 2.0074e-04
Loss = 1.1890e-03, PNorm = 62.1811, GNorm = 0.9600, lr_0 = 1.9224e-04
Validation rmse = 0.914052
Epoch 21
Loss = 9.9194e-04, PNorm = 62.1864, GNorm = 0.8689, lr_0 = 1.8409e-04
Loss = 1.1248e-03, PNorm = 62.1926, GNorm = 0.6102, lr_0 = 1.7630e-04
Validation rmse = 0.918473
Epoch 22
Loss = 1.3767e-03, PNorm = 62.1982, GNorm = 1.8027, lr_0 = 1.6810e-04
Loss = 1.2690e-03, PNorm = 62.2051, GNorm = 2.0995, lr_0 = 1.6098e-04
Validation rmse = 0.905234
Epoch 23
Loss = 1.1969e-03, PNorm = 62.2104, GNorm = 1.2305, lr_0 = 1.5416e-04
Loss = 1.2604e-03, PNorm = 62.2163, GNorm = 0.6508, lr_0 = 1.4763e-04
Loss = 2.0277e-03, PNorm = 62.2170, GNorm = 0.6455, lr_0 = 1.4699e-04
Validation rmse = 0.917831
Epoch 24
Loss = 1.1553e-03, PNorm = 62.2223, GNorm = 0.9533, lr_0 = 1.4077e-04
Loss = 1.1258e-03, PNorm = 62.2277, GNorm = 0.9853, lr_0 = 1.3480e-04
Validation rmse = 0.920638
Epoch 25
Loss = 1.1561e-03, PNorm = 62.2334, GNorm = 0.6160, lr_0 = 1.2909e-04
Loss = 1.0319e-03, PNorm = 62.2380, GNorm = 0.6643, lr_0 = 1.2362e-04
Validation rmse = 0.948437
Epoch 26
Loss = 1.0230e-03, PNorm = 62.2428, GNorm = 0.6566, lr_0 = 1.1839e-04
Validation rmse = 0.888647
Epoch 27
Loss = 7.7564e-04, PNorm = 62.2485, GNorm = 0.7041, lr_0 = 1.1288e-04
Loss = 1.0476e-03, PNorm = 62.2526, GNorm = 1.4574, lr_0 = 1.0810e-04
Validation rmse = 0.894072
Epoch 28
Loss = 1.0165e-03, PNorm = 62.2568, GNorm = 0.4923, lr_0 = 1.0352e-04
Loss = 9.3821e-04, PNorm = 62.2610, GNorm = 0.4088, lr_0 = 1.0000e-04
Validation rmse = 0.896628
Epoch 29
Loss = 1.2220e-03, PNorm = 62.2655, GNorm = 0.9366, lr_0 = 1.0000e-04
Loss = 9.0621e-04, PNorm = 62.2695, GNorm = 0.8964, lr_0 = 1.0000e-04
Validation rmse = 0.887658
Model 0 best validation rmse = 0.883694 on epoch 18
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.194814
Ensemble test rmse = 1.194814
10-fold cross validation
	Seed 0 ==> test rmse = 0.868482
	Seed 1 ==> test rmse = 1.004174
	Seed 2 ==> test rmse = 1.067208
	Seed 3 ==> test rmse = 1.085986
	Seed 4 ==> test rmse = 1.088242
	Seed 5 ==> test rmse = 1.161902
	Seed 6 ==> test rmse = 0.980438
	Seed 7 ==> test rmse = 1.147493
	Seed 8 ==> test rmse = 1.122780
	Seed 9 ==> test rmse = 1.194814
Overall test rmse = 1.072152 +/- 0.092914
Elapsed time = 0:07:36
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total scaffolds = 195 | train scaffolds = 91 | val scaffolds = 66 | test scaffolds = 38
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=504, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 893,501
Moving model to cuda
Epoch 0
Loss = 1.4140e-02, PNorm = 42.2985, GNorm = 5.4096, lr_0 = 3.6053e-04
Validation rmse = 2.080914
Epoch 1
Loss = 7.6604e-03, PNorm = 42.3208, GNorm = 6.0917, lr_0 = 6.2105e-04
Loss = 6.9374e-03, PNorm = 42.3520, GNorm = 1.5876, lr_0 = 8.5789e-04
Validation rmse = 1.412237
Epoch 2
Loss = 8.8900e-03, PNorm = 42.3871, GNorm = 3.8158, lr_0 = 9.8284e-04
Loss = 4.7427e-03, PNorm = 42.4171, GNorm = 3.0619, lr_0 = 9.4120e-04
Validation rmse = 1.060202
Epoch 3
Loss = 3.0177e-03, PNorm = 42.4475, GNorm = 0.7855, lr_0 = 8.9744e-04
Loss = 3.9099e-03, PNorm = 42.4658, GNorm = 0.6192, lr_0 = 8.5943e-04
Validation rmse = 1.108010
Epoch 4
Loss = 4.5046e-03, PNorm = 42.4897, GNorm = 1.9118, lr_0 = 8.2303e-04
Loss = 3.9739e-03, PNorm = 42.5088, GNorm = 2.0397, lr_0 = 7.8816e-04
Validation rmse = 1.019128
Epoch 5
Loss = 2.4431e-03, PNorm = 42.5269, GNorm = 1.5705, lr_0 = 7.5478e-04
Loss = 3.4739e-03, PNorm = 42.5454, GNorm = 3.0209, lr_0 = 7.2281e-04
Validation rmse = 0.963249
Epoch 6
Loss = 2.6497e-03, PNorm = 42.5630, GNorm = 1.9020, lr_0 = 6.8920e-04
Loss = 3.3006e-03, PNorm = 42.5815, GNorm = 2.5293, lr_0 = 6.6001e-04
Validation rmse = 1.037203
Epoch 7
Loss = 3.2533e-03, PNorm = 42.5982, GNorm = 3.0909, lr_0 = 6.3205e-04
Loss = 2.9109e-03, PNorm = 42.6110, GNorm = 1.6903, lr_0 = 6.0528e-04
Validation rmse = 1.015733
Epoch 8
Loss = 2.6955e-03, PNorm = 42.6273, GNorm = 0.9979, lr_0 = 5.7714e-04
Loss = 2.7652e-03, PNorm = 42.6423, GNorm = 0.5592, lr_0 = 5.5269e-04
Validation rmse = 1.164597
Epoch 9
Loss = 2.8100e-03, PNorm = 42.6544, GNorm = 1.1295, lr_0 = 5.2928e-04
Loss = 2.8759e-03, PNorm = 42.6710, GNorm = 0.8478, lr_0 = 5.0686e-04
Validation rmse = 0.940867
Epoch 10
Loss = 2.2879e-03, PNorm = 42.6819, GNorm = 2.1958, lr_0 = 4.8539e-04
Loss = 2.5164e-03, PNorm = 42.6950, GNorm = 0.7574, lr_0 = 4.6483e-04
Validation rmse = 1.053448
Epoch 11
Loss = 2.4318e-03, PNorm = 42.7078, GNorm = 0.6042, lr_0 = 4.4322e-04
Loss = 2.4007e-03, PNorm = 42.7166, GNorm = 0.6903, lr_0 = 4.2444e-04
Validation rmse = 0.967344
Epoch 12
Loss = 2.1876e-03, PNorm = 42.7281, GNorm = 1.3818, lr_0 = 4.0646e-04
Loss = 2.2908e-03, PNorm = 42.7353, GNorm = 0.6890, lr_0 = 3.8925e-04
Validation rmse = 1.049825
Epoch 13
Loss = 1.8886e-03, PNorm = 42.7426, GNorm = 0.8328, lr_0 = 3.7276e-04
Loss = 2.1959e-03, PNorm = 42.7491, GNorm = 0.6756, lr_0 = 3.5697e-04
Validation rmse = 1.081225
Epoch 14
Loss = 2.2679e-03, PNorm = 42.7574, GNorm = 0.9496, lr_0 = 3.4037e-04
Loss = 2.1168e-03, PNorm = 42.7658, GNorm = 0.8165, lr_0 = 3.2596e-04
Validation rmse = 1.121056
Epoch 15
Loss = 2.0466e-03, PNorm = 42.7728, GNorm = 0.8496, lr_0 = 3.1215e-04
Loss = 1.8360e-03, PNorm = 42.7808, GNorm = 1.7619, lr_0 = 2.9893e-04
Validation rmse = 1.282560
Epoch 16
Loss = 1.8461e-03, PNorm = 42.7885, GNorm = 1.4045, lr_0 = 2.8503e-04
Loss = 2.0336e-03, PNorm = 42.7956, GNorm = 1.1278, lr_0 = 2.7295e-04
Validation rmse = 1.033352
Epoch 17
Loss = 1.9430e-03, PNorm = 42.8010, GNorm = 0.7600, lr_0 = 2.6139e-04
Loss = 2.1101e-03, PNorm = 42.8065, GNorm = 0.7333, lr_0 = 2.5032e-04
Validation rmse = 0.984970
Epoch 18
Loss = 1.6291e-03, PNorm = 42.8104, GNorm = 0.7843, lr_0 = 2.3972e-04
Loss = 1.9265e-03, PNorm = 42.8159, GNorm = 1.1516, lr_0 = 2.2956e-04
Validation rmse = 1.236775
Epoch 19
Loss = 2.0858e-03, PNorm = 42.8232, GNorm = 2.2379, lr_0 = 2.1889e-04
Loss = 1.9213e-03, PNorm = 42.8276, GNorm = 1.6919, lr_0 = 2.0962e-04
Validation rmse = 1.042915
Epoch 20
Loss = 1.7365e-03, PNorm = 42.8333, GNorm = 1.1391, lr_0 = 2.0074e-04
Loss = 1.7251e-03, PNorm = 42.8378, GNorm = 0.9772, lr_0 = 1.9224e-04
Validation rmse = 1.052636
Epoch 21
Loss = 1.7638e-03, PNorm = 42.8409, GNorm = 1.8124, lr_0 = 1.8409e-04
Loss = 1.9851e-03, PNorm = 42.8448, GNorm = 0.9538, lr_0 = 1.7630e-04
Validation rmse = 0.953849
Epoch 22
Loss = 1.4541e-03, PNorm = 42.8499, GNorm = 0.9288, lr_0 = 1.6810e-04
Loss = 1.8909e-03, PNorm = 42.8533, GNorm = 0.8431, lr_0 = 1.6098e-04
Validation rmse = 0.946835
Epoch 23
Loss = 1.8931e-03, PNorm = 42.8558, GNorm = 1.3180, lr_0 = 1.5416e-04
Loss = 1.6531e-03, PNorm = 42.8592, GNorm = 0.6127, lr_0 = 1.4763e-04
Loss = 2.6082e-03, PNorm = 42.8596, GNorm = 1.7393, lr_0 = 1.4699e-04
Validation rmse = 1.059645
Epoch 24
Loss = 1.6238e-03, PNorm = 42.8625, GNorm = 1.0361, lr_0 = 1.4077e-04
Loss = 1.8129e-03, PNorm = 42.8651, GNorm = 0.7725, lr_0 = 1.3480e-04
Validation rmse = 0.989727
Epoch 25
Loss = 1.6987e-03, PNorm = 42.8681, GNorm = 1.0434, lr_0 = 1.2909e-04
Loss = 1.6306e-03, PNorm = 42.8696, GNorm = 1.6628, lr_0 = 1.2362e-04
Validation rmse = 1.027511
Epoch 26
Loss = 1.5444e-03, PNorm = 42.8720, GNorm = 1.1991, lr_0 = 1.1839e-04
Validation rmse = 0.968527
Epoch 27
Loss = 1.3406e-03, PNorm = 42.8756, GNorm = 1.6224, lr_0 = 1.1288e-04
Loss = 1.9335e-03, PNorm = 42.8776, GNorm = 1.6837, lr_0 = 1.0810e-04
Validation rmse = 0.977319
Epoch 28
Loss = 1.6764e-03, PNorm = 42.8794, GNorm = 0.6097, lr_0 = 1.0352e-04
Loss = 1.4986e-03, PNorm = 42.8813, GNorm = 0.7698, lr_0 = 1.0000e-04
Validation rmse = 0.954900
Epoch 29
Loss = 1.7110e-03, PNorm = 42.8831, GNorm = 0.8145, lr_0 = 1.0000e-04
Loss = 1.6411e-03, PNorm = 42.8856, GNorm = 0.8588, lr_0 = 1.0000e-04
Validation rmse = 0.965536
Model 0 best validation rmse = 0.940867 on epoch 9
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.079114
Ensemble test rmse = 1.079114
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total scaffolds = 195 | train scaffolds = 76 | val scaffolds = 60 | test scaffolds = 59
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=504, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 893,501
Moving model to cuda
Epoch 0
Loss = 1.5235e-02, PNorm = 42.2994, GNorm = 3.0585, lr_0 = 3.6053e-04
Validation rmse = 1.501074
Epoch 1
Loss = 7.5018e-03, PNorm = 42.3248, GNorm = 3.4255, lr_0 = 6.2105e-04
Loss = 6.3918e-03, PNorm = 42.3562, GNorm = 4.6149, lr_0 = 8.5789e-04
Validation rmse = 1.206562
Epoch 2
Loss = 5.2823e-03, PNorm = 42.3946, GNorm = 2.0000, lr_0 = 9.8284e-04
Loss = 4.4163e-03, PNorm = 42.4251, GNorm = 2.0191, lr_0 = 9.4120e-04
Validation rmse = 1.143656
Epoch 3
Loss = 4.1585e-03, PNorm = 42.4535, GNorm = 4.8669, lr_0 = 8.9744e-04
Loss = 4.0983e-03, PNorm = 42.4772, GNorm = 1.6268, lr_0 = 8.5943e-04
Validation rmse = 1.084989
Epoch 4
Loss = 2.3744e-03, PNorm = 42.4984, GNorm = 1.2809, lr_0 = 8.2303e-04
Loss = 3.2482e-03, PNorm = 42.5178, GNorm = 1.2564, lr_0 = 7.8816e-04
Validation rmse = 1.118926
Epoch 5
Loss = 3.3898e-03, PNorm = 42.5308, GNorm = 1.1632, lr_0 = 7.5478e-04
Loss = 3.2595e-03, PNorm = 42.5506, GNorm = 1.0873, lr_0 = 7.2281e-04
Validation rmse = 1.098867
Epoch 6
Loss = 2.6389e-03, PNorm = 42.5675, GNorm = 1.8944, lr_0 = 6.8920e-04
Loss = 2.8306e-03, PNorm = 42.5848, GNorm = 1.3555, lr_0 = 6.6001e-04
Validation rmse = 1.051476
Epoch 7
Loss = 2.7128e-03, PNorm = 42.6001, GNorm = 2.0881, lr_0 = 6.3205e-04
Loss = 2.7872e-03, PNorm = 42.6141, GNorm = 1.0620, lr_0 = 6.0528e-04
Validation rmse = 1.174462
Epoch 8
Loss = 2.8652e-03, PNorm = 42.6317, GNorm = 0.7202, lr_0 = 5.7714e-04
Loss = 2.5113e-03, PNorm = 42.6465, GNorm = 2.1594, lr_0 = 5.5269e-04
Validation rmse = 1.013693
Epoch 9
Loss = 2.1138e-03, PNorm = 42.6606, GNorm = 2.0617, lr_0 = 5.2928e-04
Loss = 2.6509e-03, PNorm = 42.6726, GNorm = 2.1181, lr_0 = 5.0686e-04
Validation rmse = 1.202675
Epoch 10
Loss = 2.4942e-03, PNorm = 42.6828, GNorm = 0.6916, lr_0 = 4.8539e-04
Loss = 2.1287e-03, PNorm = 42.6956, GNorm = 2.2306, lr_0 = 4.6483e-04
Validation rmse = 1.006900
Epoch 11
Loss = 2.3783e-03, PNorm = 42.7077, GNorm = 1.1122, lr_0 = 4.4322e-04
Loss = 2.5054e-03, PNorm = 42.7176, GNorm = 0.7308, lr_0 = 4.2444e-04
Validation rmse = 0.977191
Epoch 12
Loss = 1.8951e-03, PNorm = 42.7278, GNorm = 1.0097, lr_0 = 4.0646e-04
Loss = 2.3656e-03, PNorm = 42.7340, GNorm = 2.0669, lr_0 = 3.8925e-04
Validation rmse = 0.946447
Epoch 13
Loss = 2.3373e-03, PNorm = 42.7433, GNorm = 1.0599, lr_0 = 3.7276e-04
Loss = 2.0104e-03, PNorm = 42.7505, GNorm = 0.7952, lr_0 = 3.5697e-04
Validation rmse = 0.990961
Epoch 14
Loss = 2.1026e-03, PNorm = 42.7588, GNorm = 2.5265, lr_0 = 3.4037e-04
Loss = 2.0535e-03, PNorm = 42.7700, GNorm = 0.9940, lr_0 = 3.2596e-04
Validation rmse = 0.993405
Epoch 15
Loss = 2.3295e-03, PNorm = 42.7756, GNorm = 1.0597, lr_0 = 3.1215e-04
Loss = 1.8605e-03, PNorm = 42.7820, GNorm = 1.6116, lr_0 = 2.9893e-04
Validation rmse = 0.974823
Epoch 16
Loss = 2.0202e-03, PNorm = 42.7885, GNorm = 0.5588, lr_0 = 2.8503e-04
Loss = 1.9736e-03, PNorm = 42.7936, GNorm = 0.8699, lr_0 = 2.7295e-04
Validation rmse = 1.018217
Epoch 17
Loss = 1.7813e-03, PNorm = 42.7997, GNorm = 0.8851, lr_0 = 2.6139e-04
Loss = 1.7455e-03, PNorm = 42.8065, GNorm = 1.1838, lr_0 = 2.5032e-04
Validation rmse = 1.000522
Epoch 18
Loss = 1.9105e-03, PNorm = 42.8097, GNorm = 2.5890, lr_0 = 2.3972e-04
Loss = 1.6788e-03, PNorm = 42.8149, GNorm = 1.2903, lr_0 = 2.2956e-04
Validation rmse = 0.958992
Epoch 19
Loss = 1.2592e-03, PNorm = 42.8196, GNorm = 0.6421, lr_0 = 2.1889e-04
Loss = 1.9562e-03, PNorm = 42.8226, GNorm = 0.7055, lr_0 = 2.0962e-04
Validation rmse = 1.027550
Epoch 20
Loss = 1.5599e-03, PNorm = 42.8270, GNorm = 0.7929, lr_0 = 2.0074e-04
Loss = 1.8713e-03, PNorm = 42.8314, GNorm = 0.5040, lr_0 = 1.9224e-04
Validation rmse = 0.953422
Epoch 21
Loss = 1.5159e-03, PNorm = 42.8346, GNorm = 1.1841, lr_0 = 1.8409e-04
Loss = 2.0716e-03, PNorm = 42.8372, GNorm = 1.7671, lr_0 = 1.7630e-04
Validation rmse = 1.063571
Epoch 22
Loss = 1.9699e-03, PNorm = 42.8415, GNorm = 0.9367, lr_0 = 1.6810e-04
Loss = 1.5761e-03, PNorm = 42.8450, GNorm = 2.1618, lr_0 = 1.6098e-04
Validation rmse = 0.997385
Epoch 23
Loss = 1.7479e-03, PNorm = 42.8484, GNorm = 1.4265, lr_0 = 1.5416e-04
Loss = 1.5657e-03, PNorm = 42.8510, GNorm = 0.5908, lr_0 = 1.4763e-04
Loss = 1.7838e-03, PNorm = 42.8513, GNorm = 1.0499, lr_0 = 1.4699e-04
Validation rmse = 0.971499
Epoch 24
Loss = 1.7495e-03, PNorm = 42.8543, GNorm = 0.8282, lr_0 = 1.4077e-04
Loss = 1.5160e-03, PNorm = 42.8557, GNorm = 1.0407, lr_0 = 1.3480e-04
Validation rmse = 1.029204
Epoch 25
Loss = 1.8162e-03, PNorm = 42.8587, GNorm = 1.0072, lr_0 = 1.2909e-04
Loss = 1.7416e-03, PNorm = 42.8623, GNorm = 0.8754, lr_0 = 1.2362e-04
Validation rmse = 0.974660
Epoch 26
Loss = 1.6827e-03, PNorm = 42.8642, GNorm = 1.8226, lr_0 = 1.1839e-04
Validation rmse = 0.969234
Epoch 27
Loss = 1.2636e-03, PNorm = 42.8678, GNorm = 1.6147, lr_0 = 1.1288e-04
Loss = 1.4978e-03, PNorm = 42.8686, GNorm = 0.5659, lr_0 = 1.0810e-04
Validation rmse = 0.979076
Epoch 28
Loss = 1.1320e-03, PNorm = 42.8712, GNorm = 0.4735, lr_0 = 1.0352e-04
Loss = 1.5115e-03, PNorm = 42.8736, GNorm = 0.7808, lr_0 = 1.0000e-04
Validation rmse = 0.982143
Epoch 29
Loss = 1.2734e-03, PNorm = 42.8750, GNorm = 0.8275, lr_0 = 1.0000e-04
Loss = 1.7102e-03, PNorm = 42.8782, GNorm = 0.8093, lr_0 = 1.0000e-04
Validation rmse = 0.987797
Model 0 best validation rmse = 0.946447 on epoch 12
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.016801
Ensemble test rmse = 1.016801
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total scaffolds = 195 | train scaffolds = 55 | val scaffolds = 64 | test scaffolds = 76
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=504, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 893,501
Moving model to cuda
Epoch 0
Loss = 1.5651e-02, PNorm = 42.2986, GNorm = 2.9598, lr_0 = 3.6053e-04
Validation rmse = 1.428640
Epoch 1
Loss = 5.8396e-03, PNorm = 42.3203, GNorm = 1.9296, lr_0 = 6.2105e-04
Loss = 6.6611e-03, PNorm = 42.3524, GNorm = 1.8504, lr_0 = 8.5789e-04
Validation rmse = 1.325430
Epoch 2
Loss = 3.7581e-03, PNorm = 42.3844, GNorm = 2.0150, lr_0 = 9.8284e-04
Loss = 5.9528e-03, PNorm = 42.4092, GNorm = 2.8915, lr_0 = 9.4120e-04
Validation rmse = 1.187503
Epoch 3
Loss = 4.2451e-03, PNorm = 42.4380, GNorm = 1.5478, lr_0 = 8.9744e-04
Loss = 4.1092e-03, PNorm = 42.4590, GNorm = 0.9264, lr_0 = 8.5943e-04
Validation rmse = 1.446883
Epoch 4
Loss = 3.6100e-03, PNorm = 42.4763, GNorm = 2.1165, lr_0 = 8.2303e-04
Loss = 4.9027e-03, PNorm = 42.5014, GNorm = 2.6835, lr_0 = 7.8816e-04
Validation rmse = 1.332449
Epoch 5
Loss = 3.1435e-03, PNorm = 42.5197, GNorm = 1.2835, lr_0 = 7.5478e-04
Loss = 3.3710e-03, PNorm = 42.5383, GNorm = 1.7451, lr_0 = 7.2281e-04
Validation rmse = 1.278127
Epoch 6
Loss = 3.5810e-03, PNorm = 42.5590, GNorm = 0.7210, lr_0 = 6.8920e-04
Loss = 3.6947e-03, PNorm = 42.5748, GNorm = 1.2260, lr_0 = 6.6001e-04
Validation rmse = 1.135472
Epoch 7
Loss = 4.2560e-03, PNorm = 42.5960, GNorm = 2.3227, lr_0 = 6.3205e-04
Loss = 3.3797e-03, PNorm = 42.6102, GNorm = 1.1185, lr_0 = 6.0528e-04
Validation rmse = 1.095628
Epoch 8
Loss = 3.3358e-03, PNorm = 42.6306, GNorm = 1.0159, lr_0 = 5.7714e-04
Loss = 2.6798e-03, PNorm = 42.6484, GNorm = 1.0673, lr_0 = 5.5269e-04
Validation rmse = 1.061379
Epoch 9
Loss = 2.7143e-03, PNorm = 42.6585, GNorm = 0.8689, lr_0 = 5.2928e-04
Loss = 2.3813e-03, PNorm = 42.6744, GNorm = 0.5957, lr_0 = 5.0686e-04
Validation rmse = 1.044513
Epoch 10
Loss = 2.3300e-03, PNorm = 42.6871, GNorm = 0.7604, lr_0 = 4.8539e-04
Loss = 2.7415e-03, PNorm = 42.6975, GNorm = 0.7895, lr_0 = 4.6483e-04
Validation rmse = 1.043001
Epoch 11
Loss = 2.8530e-03, PNorm = 42.7119, GNorm = 3.6796, lr_0 = 4.4322e-04
Loss = 2.4849e-03, PNorm = 42.7220, GNorm = 0.8335, lr_0 = 4.2444e-04
Validation rmse = 1.097541
Epoch 12
Loss = 2.0914e-03, PNorm = 42.7339, GNorm = 2.0825, lr_0 = 4.0646e-04
Loss = 2.0806e-03, PNorm = 42.7430, GNorm = 0.9637, lr_0 = 3.8925e-04
Validation rmse = 1.029870
Epoch 13
Loss = 2.1537e-03, PNorm = 42.7532, GNorm = 1.1231, lr_0 = 3.7276e-04
Loss = 2.2065e-03, PNorm = 42.7607, GNorm = 0.8747, lr_0 = 3.5697e-04
Validation rmse = 1.060095
Epoch 14
Loss = 2.6736e-03, PNorm = 42.7656, GNorm = 1.0088, lr_0 = 3.4037e-04
Loss = 2.4906e-03, PNorm = 42.7765, GNorm = 2.7529, lr_0 = 3.2596e-04
Validation rmse = 1.057272
Epoch 15
Loss = 1.9504e-03, PNorm = 42.7840, GNorm = 0.7003, lr_0 = 3.1215e-04
Loss = 2.0905e-03, PNorm = 42.7891, GNorm = 1.4930, lr_0 = 2.9893e-04
Validation rmse = 1.082354
Epoch 16
Loss = 2.1682e-03, PNorm = 42.7980, GNorm = 0.6958, lr_0 = 2.8503e-04
Loss = 2.3879e-03, PNorm = 42.8037, GNorm = 2.3116, lr_0 = 2.7295e-04
Validation rmse = 1.087099
Epoch 17
Loss = 2.4337e-03, PNorm = 42.8113, GNorm = 2.3700, lr_0 = 2.6139e-04
Loss = 2.0768e-03, PNorm = 42.8188, GNorm = 3.0697, lr_0 = 2.5032e-04
Validation rmse = 1.124844
Epoch 18
Loss = 2.2713e-03, PNorm = 42.8267, GNorm = 1.2090, lr_0 = 2.3972e-04
Loss = 2.1033e-03, PNorm = 42.8325, GNorm = 1.2800, lr_0 = 2.2956e-04
Validation rmse = 1.041904
Epoch 19
Loss = 2.5101e-03, PNorm = 42.8390, GNorm = 1.5434, lr_0 = 2.1889e-04
Loss = 1.8761e-03, PNorm = 42.8457, GNorm = 0.7855, lr_0 = 2.0962e-04
Validation rmse = 1.031579
Epoch 20
Loss = 1.9209e-03, PNorm = 42.8486, GNorm = 0.8542, lr_0 = 2.0074e-04
Loss = 2.0316e-03, PNorm = 42.8540, GNorm = 1.2034, lr_0 = 1.9224e-04
Validation rmse = 1.049146
Epoch 21
Loss = 2.1376e-03, PNorm = 42.8564, GNorm = 1.4288, lr_0 = 1.8409e-04
Loss = 1.7313e-03, PNorm = 42.8615, GNorm = 0.6030, lr_0 = 1.7630e-04
Validation rmse = 1.065496
Epoch 22
Loss = 1.8470e-03, PNorm = 42.8654, GNorm = 0.6705, lr_0 = 1.6810e-04
Loss = 1.8828e-03, PNorm = 42.8669, GNorm = 0.8635, lr_0 = 1.6098e-04
Validation rmse = 1.056528
Epoch 23
Loss = 1.6890e-03, PNorm = 42.8711, GNorm = 1.3896, lr_0 = 1.5416e-04
Loss = 1.8113e-03, PNorm = 42.8760, GNorm = 1.5724, lr_0 = 1.4763e-04
Loss = 3.1256e-03, PNorm = 42.8762, GNorm = 1.8805, lr_0 = 1.4699e-04
Validation rmse = 1.036364
Epoch 24
Loss = 1.7526e-03, PNorm = 42.8794, GNorm = 2.7424, lr_0 = 1.4077e-04
Loss = 1.8618e-03, PNorm = 42.8824, GNorm = 0.6631, lr_0 = 1.3480e-04
Validation rmse = 1.052625
Epoch 25
Loss = 1.9674e-03, PNorm = 42.8853, GNorm = 1.2706, lr_0 = 1.2909e-04
Loss = 1.4607e-03, PNorm = 42.8879, GNorm = 1.3324, lr_0 = 1.2362e-04
Validation rmse = 1.040122
Epoch 26
Loss = 1.9367e-03, PNorm = 42.8910, GNorm = 0.9279, lr_0 = 1.1839e-04
Validation rmse = 1.068317
Epoch 27
Loss = 2.0646e-03, PNorm = 42.8938, GNorm = 1.6206, lr_0 = 1.1288e-04
Loss = 1.7840e-03, PNorm = 42.8959, GNorm = 1.6948, lr_0 = 1.0810e-04
Validation rmse = 1.043158
Epoch 28
Loss = 1.0661e-03, PNorm = 42.8984, GNorm = 1.1051, lr_0 = 1.0352e-04
Loss = 1.6004e-03, PNorm = 42.9004, GNorm = 0.6425, lr_0 = 1.0000e-04
Validation rmse = 1.067344
Epoch 29
Loss = 1.7635e-03, PNorm = 42.9031, GNorm = 0.8522, lr_0 = 1.0000e-04
Loss = 1.7340e-03, PNorm = 42.9042, GNorm = 0.9746, lr_0 = 1.0000e-04
Validation rmse = 1.069673
Model 0 best validation rmse = 1.029870 on epoch 12
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.028035
Ensemble test rmse = 1.028035
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total scaffolds = 195 | train scaffolds = 80 | val scaffolds = 54 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=504, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 893,501
Moving model to cuda
Epoch 0
Loss = 1.5067e-02, PNorm = 42.3009, GNorm = 5.2412, lr_0 = 3.6053e-04
Validation rmse = 1.431036
Epoch 1
Loss = 8.5659e-03, PNorm = 42.3234, GNorm = 5.9320, lr_0 = 6.2105e-04
Loss = 6.3362e-03, PNorm = 42.3544, GNorm = 2.2009, lr_0 = 8.5789e-04
Validation rmse = 1.155070
Epoch 2
Loss = 4.5241e-03, PNorm = 42.3920, GNorm = 1.3629, lr_0 = 9.8284e-04
Loss = 4.2720e-03, PNorm = 42.4227, GNorm = 1.2607, lr_0 = 9.4120e-04
Validation rmse = 1.328361
Epoch 3
Loss = 5.3703e-03, PNorm = 42.4504, GNorm = 0.9810, lr_0 = 8.9744e-04
Loss = 4.0668e-03, PNorm = 42.4746, GNorm = 1.5997, lr_0 = 8.5943e-04
Validation rmse = 1.290319
Epoch 4
Loss = 5.2198e-03, PNorm = 42.4976, GNorm = 6.1773, lr_0 = 8.2303e-04
Loss = 4.5802e-03, PNorm = 42.5185, GNorm = 2.3497, lr_0 = 7.8816e-04
Validation rmse = 1.282726
Epoch 5
Loss = 4.1759e-03, PNorm = 42.5430, GNorm = 2.3327, lr_0 = 7.5478e-04
Loss = 3.1028e-03, PNorm = 42.5662, GNorm = 1.7264, lr_0 = 7.2281e-04
Validation rmse = 1.122127
Epoch 6
Loss = 2.4048e-03, PNorm = 42.5868, GNorm = 1.3468, lr_0 = 6.8920e-04
Loss = 2.9035e-03, PNorm = 42.6008, GNorm = 1.2963, lr_0 = 6.6001e-04
Validation rmse = 1.098567
Epoch 7
Loss = 2.6791e-03, PNorm = 42.6181, GNorm = 1.5128, lr_0 = 6.3205e-04
Loss = 2.5215e-03, PNorm = 42.6315, GNorm = 0.7936, lr_0 = 6.0528e-04
Validation rmse = 1.110562
Epoch 8
Loss = 2.5430e-03, PNorm = 42.6509, GNorm = 1.8810, lr_0 = 5.7714e-04
Loss = 2.2714e-03, PNorm = 42.6667, GNorm = 1.9713, lr_0 = 5.5269e-04
Validation rmse = 1.287680
Epoch 9
Loss = 3.0253e-03, PNorm = 42.6816, GNorm = 1.3046, lr_0 = 5.2928e-04
Loss = 2.3518e-03, PNorm = 42.6971, GNorm = 0.6753, lr_0 = 5.0686e-04
Validation rmse = 1.091121
Epoch 10
Loss = 2.2687e-03, PNorm = 42.7097, GNorm = 0.6612, lr_0 = 4.8539e-04
Loss = 2.4373e-03, PNorm = 42.7212, GNorm = 1.1551, lr_0 = 4.6483e-04
Validation rmse = 1.074889
Epoch 11
Loss = 2.1821e-03, PNorm = 42.7326, GNorm = 0.5295, lr_0 = 4.4322e-04
Loss = 2.3934e-03, PNorm = 42.7449, GNorm = 0.6998, lr_0 = 4.2444e-04
Validation rmse = 1.191925
Epoch 12
Loss = 2.4180e-03, PNorm = 42.7557, GNorm = 2.4144, lr_0 = 4.0646e-04
Loss = 2.0023e-03, PNorm = 42.7651, GNorm = 1.4602, lr_0 = 3.8925e-04
Validation rmse = 1.078705
Epoch 13
Loss = 2.1028e-03, PNorm = 42.7772, GNorm = 1.2976, lr_0 = 3.7276e-04
Loss = 2.2285e-03, PNorm = 42.7855, GNorm = 1.7063, lr_0 = 3.5697e-04
Validation rmse = 1.050281
Epoch 14
Loss = 2.0225e-03, PNorm = 42.7961, GNorm = 2.8620, lr_0 = 3.4037e-04
Loss = 1.9821e-03, PNorm = 42.8036, GNorm = 1.1422, lr_0 = 3.2596e-04
Validation rmse = 1.281161
Epoch 15
Loss = 1.5788e-03, PNorm = 42.8124, GNorm = 1.4416, lr_0 = 3.1215e-04
Loss = 2.2951e-03, PNorm = 42.8174, GNorm = 1.8297, lr_0 = 2.9893e-04
Validation rmse = 1.071226
Epoch 16
Loss = 1.6228e-03, PNorm = 42.8260, GNorm = 1.8082, lr_0 = 2.8503e-04
Loss = 1.9227e-03, PNorm = 42.8322, GNorm = 0.7979, lr_0 = 2.7295e-04
Validation rmse = 1.056896
Epoch 17
Loss = 1.5196e-03, PNorm = 42.8393, GNorm = 0.6378, lr_0 = 2.6139e-04
Loss = 1.6863e-03, PNorm = 42.8451, GNorm = 0.9895, lr_0 = 2.5032e-04
Validation rmse = 1.070878
Epoch 18
Loss = 1.7272e-03, PNorm = 42.8504, GNorm = 1.8380, lr_0 = 2.3972e-04
Loss = 1.7258e-03, PNorm = 42.8578, GNorm = 0.5521, lr_0 = 2.2956e-04
Validation rmse = 1.042801
Epoch 19
Loss = 2.0917e-03, PNorm = 42.8631, GNorm = 0.7820, lr_0 = 2.1889e-04
Loss = 1.4404e-03, PNorm = 42.8698, GNorm = 0.7221, lr_0 = 2.0962e-04
Validation rmse = 1.020106
Epoch 20
Loss = 1.7500e-03, PNorm = 42.8720, GNorm = 0.6971, lr_0 = 2.0074e-04
Loss = 1.8163e-03, PNorm = 42.8768, GNorm = 1.9816, lr_0 = 1.9224e-04
Validation rmse = 1.032071
Epoch 21
Loss = 1.5291e-03, PNorm = 42.8809, GNorm = 1.0610, lr_0 = 1.8409e-04
Loss = 1.6844e-03, PNorm = 42.8836, GNorm = 1.8073, lr_0 = 1.7630e-04
Validation rmse = 1.053059
Epoch 22
Loss = 1.5804e-03, PNorm = 42.8886, GNorm = 0.9899, lr_0 = 1.6810e-04
Loss = 1.5531e-03, PNorm = 42.8922, GNorm = 1.0148, lr_0 = 1.6098e-04
Validation rmse = 1.082667
Epoch 23
Loss = 1.7444e-03, PNorm = 42.8957, GNorm = 2.4575, lr_0 = 1.5416e-04
Loss = 1.5775e-03, PNorm = 42.8985, GNorm = 1.1711, lr_0 = 1.4763e-04
Loss = 2.7641e-03, PNorm = 42.8990, GNorm = 1.6910, lr_0 = 1.4699e-04
Validation rmse = 1.101017
Epoch 24
Loss = 1.4918e-03, PNorm = 42.9017, GNorm = 1.2374, lr_0 = 1.4077e-04
Loss = 1.5468e-03, PNorm = 42.9044, GNorm = 0.6235, lr_0 = 1.3480e-04
Validation rmse = 1.062825
Epoch 25
Loss = 1.4077e-03, PNorm = 42.9070, GNorm = 1.1539, lr_0 = 1.2909e-04
Loss = 1.5843e-03, PNorm = 42.9086, GNorm = 1.6829, lr_0 = 1.2362e-04
Validation rmse = 1.045128
Epoch 26
Loss = 1.5459e-03, PNorm = 42.9098, GNorm = 1.2674, lr_0 = 1.1839e-04
Validation rmse = 1.057089
Epoch 27
Loss = 1.9596e-03, PNorm = 42.9136, GNorm = 0.8207, lr_0 = 1.1288e-04
Loss = 1.3936e-03, PNorm = 42.9159, GNorm = 0.9320, lr_0 = 1.0810e-04
Validation rmse = 1.096889
Epoch 28
Loss = 1.8777e-03, PNorm = 42.9173, GNorm = 1.0702, lr_0 = 1.0352e-04
Loss = 1.3853e-03, PNorm = 42.9199, GNorm = 0.7188, lr_0 = 1.0000e-04
Validation rmse = 1.060769
Epoch 29
Loss = 1.3796e-03, PNorm = 42.9217, GNorm = 0.4467, lr_0 = 1.0000e-04
Loss = 1.2783e-03, PNorm = 42.9234, GNorm = 1.2136, lr_0 = 1.0000e-04
Validation rmse = 1.088617
Model 0 best validation rmse = 1.020106 on epoch 19
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.061967
Ensemble test rmse = 1.061967
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 49 | test scaffolds = 62
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=504, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 893,501
Moving model to cuda
Epoch 0
Loss = 1.4359e-02, PNorm = 42.3002, GNorm = 3.1190, lr_0 = 3.6053e-04
Validation rmse = 1.262087
Epoch 1
Loss = 6.7894e-03, PNorm = 42.3241, GNorm = 4.5128, lr_0 = 6.2105e-04
Loss = 6.7818e-03, PNorm = 42.3558, GNorm = 3.6861, lr_0 = 8.5789e-04
Validation rmse = 1.139960
Epoch 2
Loss = 5.2169e-03, PNorm = 42.3903, GNorm = 1.3761, lr_0 = 9.8284e-04
Loss = 4.2502e-03, PNorm = 42.4204, GNorm = 1.1446, lr_0 = 9.4120e-04
Validation rmse = 1.153493
Epoch 3
Loss = 3.6343e-03, PNorm = 42.4404, GNorm = 0.8360, lr_0 = 8.9744e-04
Loss = 3.8669e-03, PNorm = 42.4668, GNorm = 0.9166, lr_0 = 8.5943e-04
Validation rmse = 1.074415
Epoch 4
Loss = 4.5778e-03, PNorm = 42.4846, GNorm = 3.0624, lr_0 = 8.2303e-04
Loss = 3.6171e-03, PNorm = 42.5036, GNorm = 0.9447, lr_0 = 7.8816e-04
Validation rmse = 0.891189
Epoch 5
Loss = 2.9290e-03, PNorm = 42.5207, GNorm = 1.2507, lr_0 = 7.5478e-04
Loss = 2.9886e-03, PNorm = 42.5378, GNorm = 1.4794, lr_0 = 7.2281e-04
Validation rmse = 0.975726
Epoch 6
Loss = 3.1223e-03, PNorm = 42.5572, GNorm = 1.8339, lr_0 = 6.8920e-04
Loss = 3.6444e-03, PNorm = 42.5727, GNorm = 1.1608, lr_0 = 6.6001e-04
Validation rmse = 1.010362
Epoch 7
Loss = 2.4218e-03, PNorm = 42.5882, GNorm = 1.0654, lr_0 = 6.3205e-04
Loss = 3.6930e-03, PNorm = 42.6037, GNorm = 1.4681, lr_0 = 6.0528e-04
Validation rmse = 1.020392
Epoch 8
Loss = 2.9305e-03, PNorm = 42.6184, GNorm = 3.3350, lr_0 = 5.7714e-04
Loss = 2.7210e-03, PNorm = 42.6326, GNorm = 0.8692, lr_0 = 5.5269e-04
Validation rmse = 1.013031
Epoch 9
Loss = 2.3747e-03, PNorm = 42.6447, GNorm = 0.9777, lr_0 = 5.2928e-04
Loss = 2.3165e-03, PNorm = 42.6569, GNorm = 0.6898, lr_0 = 5.0686e-04
Validation rmse = 1.066120
Epoch 10
Loss = 3.3939e-03, PNorm = 42.6665, GNorm = 3.9551, lr_0 = 4.8539e-04
Loss = 3.2527e-03, PNorm = 42.6800, GNorm = 2.7250, lr_0 = 4.6483e-04
Validation rmse = 1.031015
Epoch 11
Loss = 2.2438e-03, PNorm = 42.6921, GNorm = 1.8207, lr_0 = 4.4322e-04
Loss = 2.2431e-03, PNorm = 42.7034, GNorm = 1.7447, lr_0 = 4.2444e-04
Validation rmse = 1.107056
Epoch 12
Loss = 1.9395e-03, PNorm = 42.7123, GNorm = 0.8903, lr_0 = 4.0646e-04
Loss = 2.3790e-03, PNorm = 42.7218, GNorm = 0.7223, lr_0 = 3.8925e-04
Validation rmse = 1.073575
Epoch 13
Loss = 2.0845e-03, PNorm = 42.7317, GNorm = 1.5087, lr_0 = 3.7276e-04
Loss = 2.5041e-03, PNorm = 42.7410, GNorm = 1.8893, lr_0 = 3.5697e-04
Validation rmse = 1.073149
Epoch 14
Loss = 1.8446e-03, PNorm = 42.7491, GNorm = 0.5321, lr_0 = 3.4037e-04
Loss = 2.1675e-03, PNorm = 42.7576, GNorm = 1.3525, lr_0 = 3.2596e-04
Validation rmse = 0.920279
Epoch 15
Loss = 1.9499e-03, PNorm = 42.7634, GNorm = 0.5874, lr_0 = 3.1215e-04
Loss = 2.0798e-03, PNorm = 42.7702, GNorm = 1.1346, lr_0 = 2.9893e-04
Validation rmse = 0.908939
Epoch 16
Loss = 2.0169e-03, PNorm = 42.7798, GNorm = 2.4325, lr_0 = 2.8503e-04
Loss = 2.1325e-03, PNorm = 42.7860, GNorm = 0.7421, lr_0 = 2.7295e-04
Validation rmse = 0.908191
Epoch 17
Loss = 1.6726e-03, PNorm = 42.7926, GNorm = 0.7069, lr_0 = 2.6139e-04
Loss = 2.1737e-03, PNorm = 42.7958, GNorm = 1.1333, lr_0 = 2.5032e-04
Validation rmse = 0.956788
Epoch 18
Loss = 2.1222e-03, PNorm = 42.8029, GNorm = 1.1902, lr_0 = 2.3972e-04
Loss = 1.9397e-03, PNorm = 42.8074, GNorm = 1.1929, lr_0 = 2.2956e-04
Validation rmse = 1.040613
Epoch 19
Loss = 1.9715e-03, PNorm = 42.8132, GNorm = 1.5250, lr_0 = 2.1889e-04
Loss = 2.1685e-03, PNorm = 42.8182, GNorm = 2.9261, lr_0 = 2.0962e-04
Validation rmse = 1.050299
Epoch 20
Loss = 1.8294e-03, PNorm = 42.8225, GNorm = 0.7381, lr_0 = 2.0074e-04
Loss = 1.5816e-03, PNorm = 42.8245, GNorm = 2.0303, lr_0 = 1.9224e-04
Validation rmse = 0.986928
Epoch 21
Loss = 1.7046e-03, PNorm = 42.8293, GNorm = 1.9257, lr_0 = 1.8409e-04
Loss = 1.8579e-03, PNorm = 42.8328, GNorm = 1.9076, lr_0 = 1.7630e-04
Validation rmse = 0.956974
Epoch 22
Loss = 1.7175e-03, PNorm = 42.8365, GNorm = 0.8487, lr_0 = 1.6810e-04
Loss = 1.9510e-03, PNorm = 42.8384, GNorm = 0.6207, lr_0 = 1.6098e-04
Validation rmse = 1.007285
Epoch 23
Loss = 1.5034e-03, PNorm = 42.8415, GNorm = 0.5000, lr_0 = 1.5416e-04
Loss = 1.5362e-03, PNorm = 42.8440, GNorm = 0.7182, lr_0 = 1.4763e-04
Loss = 3.0014e-03, PNorm = 42.8444, GNorm = 0.9444, lr_0 = 1.4699e-04
Validation rmse = 0.952217
Epoch 24
Loss = 1.6797e-03, PNorm = 42.8472, GNorm = 1.2794, lr_0 = 1.4077e-04
Loss = 1.8850e-03, PNorm = 42.8500, GNorm = 1.0658, lr_0 = 1.3480e-04
Validation rmse = 0.996368
Epoch 25
Loss = 1.4213e-03, PNorm = 42.8534, GNorm = 0.6599, lr_0 = 1.2909e-04
Loss = 1.8639e-03, PNorm = 42.8551, GNorm = 2.1138, lr_0 = 1.2362e-04
Validation rmse = 0.956912
Epoch 26
Loss = 1.5887e-03, PNorm = 42.8574, GNorm = 0.6370, lr_0 = 1.1839e-04
Validation rmse = 0.864803
Epoch 27
Loss = 1.5284e-03, PNorm = 42.8617, GNorm = 1.8495, lr_0 = 1.1288e-04
Loss = 1.7019e-03, PNorm = 42.8629, GNorm = 1.0497, lr_0 = 1.0810e-04
Validation rmse = 0.883235
Epoch 28
Loss = 7.4646e-04, PNorm = 42.8645, GNorm = 0.4331, lr_0 = 1.0352e-04
Loss = 1.6878e-03, PNorm = 42.8662, GNorm = 0.7459, lr_0 = 1.0000e-04
Validation rmse = 0.925062
Epoch 29
Loss = 1.4827e-03, PNorm = 42.8678, GNorm = 0.7114, lr_0 = 1.0000e-04
Loss = 1.4899e-03, PNorm = 42.8705, GNorm = 1.1307, lr_0 = 1.0000e-04
Validation rmse = 0.936905
Model 0 best validation rmse = 0.864803 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.031850
Ensemble test rmse = 1.031850
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total scaffolds = 195 | train scaffolds = 94 | val scaffolds = 55 | test scaffolds = 46
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=504, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 893,501
Moving model to cuda
Epoch 0
Loss = 1.5536e-02, PNorm = 42.2984, GNorm = 3.2559, lr_0 = 3.6053e-04
Validation rmse = 1.645610
Epoch 1
Loss = 9.6552e-03, PNorm = 42.3233, GNorm = 6.7779, lr_0 = 6.2105e-04
Loss = 6.4279e-03, PNorm = 42.3485, GNorm = 3.2782, lr_0 = 8.5789e-04
Validation rmse = 1.500767
Epoch 2
Loss = 6.1534e-03, PNorm = 42.3886, GNorm = 2.0341, lr_0 = 9.8284e-04
Loss = 4.7409e-03, PNorm = 42.4255, GNorm = 1.1474, lr_0 = 9.4120e-04
Validation rmse = 1.291812
Epoch 3
Loss = 4.3241e-03, PNorm = 42.4535, GNorm = 2.6779, lr_0 = 8.9744e-04
Loss = 4.3001e-03, PNorm = 42.4777, GNorm = 0.8983, lr_0 = 8.5943e-04
Validation rmse = 1.234515
Epoch 4
Loss = 3.4887e-03, PNorm = 42.4953, GNorm = 1.3806, lr_0 = 8.2303e-04
Loss = 3.4627e-03, PNorm = 42.5155, GNorm = 1.4225, lr_0 = 7.8816e-04
Validation rmse = 1.171586
Epoch 5
Loss = 2.6966e-03, PNorm = 42.5317, GNorm = 1.8550, lr_0 = 7.5478e-04
Loss = 3.0605e-03, PNorm = 42.5517, GNorm = 1.1142, lr_0 = 7.2281e-04
Validation rmse = 1.148971
Epoch 6
Loss = 3.6913e-03, PNorm = 42.5655, GNorm = 0.7850, lr_0 = 6.8920e-04
Loss = 3.3707e-03, PNorm = 42.5864, GNorm = 1.0838, lr_0 = 6.6001e-04
Validation rmse = 1.292812
Epoch 7
Loss = 3.5542e-03, PNorm = 42.5983, GNorm = 1.1241, lr_0 = 6.3205e-04
Loss = 2.9049e-03, PNorm = 42.6208, GNorm = 0.7560, lr_0 = 6.0528e-04
Validation rmse = 1.180115
Epoch 8
Loss = 2.1936e-03, PNorm = 42.6368, GNorm = 1.1091, lr_0 = 5.7714e-04
Loss = 2.7899e-03, PNorm = 42.6506, GNorm = 1.4411, lr_0 = 5.5269e-04
Validation rmse = 1.149539
Epoch 9
Loss = 2.5333e-03, PNorm = 42.6621, GNorm = 1.2069, lr_0 = 5.2928e-04
Loss = 2.7432e-03, PNorm = 42.6807, GNorm = 0.6805, lr_0 = 5.0686e-04
Validation rmse = 1.164034
Epoch 10
Loss = 2.7400e-03, PNorm = 42.6893, GNorm = 0.7101, lr_0 = 4.8539e-04
Loss = 2.4363e-03, PNorm = 42.7040, GNorm = 1.5749, lr_0 = 4.6483e-04
Validation rmse = 1.129317
Epoch 11
Loss = 1.8494e-03, PNorm = 42.7166, GNorm = 0.5429, lr_0 = 4.4322e-04
Loss = 2.1046e-03, PNorm = 42.7302, GNorm = 1.1428, lr_0 = 4.2444e-04
Validation rmse = 1.141852
Epoch 12
Loss = 2.1914e-03, PNorm = 42.7385, GNorm = 1.7608, lr_0 = 4.0646e-04
Loss = 2.3624e-03, PNorm = 42.7493, GNorm = 1.6077, lr_0 = 3.8925e-04
Validation rmse = 1.137133
Epoch 13
Loss = 2.1529e-03, PNorm = 42.7586, GNorm = 0.8523, lr_0 = 3.7276e-04
Loss = 2.1752e-03, PNorm = 42.7656, GNorm = 1.2412, lr_0 = 3.5697e-04
Validation rmse = 1.424610
Epoch 14
Loss = 2.8412e-03, PNorm = 42.7745, GNorm = 2.5268, lr_0 = 3.4037e-04
Loss = 2.4928e-03, PNorm = 42.7840, GNorm = 1.0706, lr_0 = 3.2596e-04
Validation rmse = 1.079524
Epoch 15
Loss = 2.3443e-03, PNorm = 42.7949, GNorm = 1.1888, lr_0 = 3.1215e-04
Loss = 2.0579e-03, PNorm = 42.8012, GNorm = 0.6958, lr_0 = 2.9893e-04
Validation rmse = 1.013705
Epoch 16
Loss = 1.9829e-03, PNorm = 42.8085, GNorm = 0.5807, lr_0 = 2.8503e-04
Loss = 2.1299e-03, PNorm = 42.8145, GNorm = 1.3655, lr_0 = 2.7295e-04
Validation rmse = 1.109270
Epoch 17
Loss = 2.0970e-03, PNorm = 42.8211, GNorm = 0.7824, lr_0 = 2.6139e-04
Loss = 2.1270e-03, PNorm = 42.8264, GNorm = 0.7733, lr_0 = 2.5032e-04
Validation rmse = 1.040774
Epoch 18
Loss = 1.9038e-03, PNorm = 42.8315, GNorm = 0.5562, lr_0 = 2.3972e-04
Loss = 2.0310e-03, PNorm = 42.8378, GNorm = 1.1749, lr_0 = 2.2956e-04
Validation rmse = 1.006033
Epoch 19
Loss = 1.8552e-03, PNorm = 42.8426, GNorm = 0.9291, lr_0 = 2.1889e-04
Loss = 2.0252e-03, PNorm = 42.8482, GNorm = 0.8254, lr_0 = 2.0962e-04
Validation rmse = 1.014180
Epoch 20
Loss = 1.9734e-03, PNorm = 42.8506, GNorm = 0.7977, lr_0 = 2.0074e-04
Loss = 1.9245e-03, PNorm = 42.8557, GNorm = 1.3513, lr_0 = 1.9224e-04
Validation rmse = 1.022197
Epoch 21
Loss = 1.7109e-03, PNorm = 42.8583, GNorm = 1.0688, lr_0 = 1.8409e-04
Loss = 1.8214e-03, PNorm = 42.8624, GNorm = 0.4389, lr_0 = 1.7630e-04
Validation rmse = 1.065853
Epoch 22
Loss = 1.5994e-03, PNorm = 42.8662, GNorm = 1.3966, lr_0 = 1.6810e-04
Loss = 1.9379e-03, PNorm = 42.8698, GNorm = 1.0127, lr_0 = 1.6098e-04
Validation rmse = 1.103472
Epoch 23
Loss = 1.9832e-03, PNorm = 42.8746, GNorm = 1.0396, lr_0 = 1.5416e-04
Loss = 1.5850e-03, PNorm = 42.8781, GNorm = 1.0037, lr_0 = 1.4763e-04
Loss = 7.4833e-04, PNorm = 42.8784, GNorm = 0.8769, lr_0 = 1.4699e-04
Validation rmse = 1.103038
Epoch 24
Loss = 1.5095e-03, PNorm = 42.8818, GNorm = 1.2186, lr_0 = 1.4077e-04
Loss = 2.0182e-03, PNorm = 42.8848, GNorm = 1.8954, lr_0 = 1.3480e-04
Validation rmse = 1.038675
Epoch 25
Loss = 1.6877e-03, PNorm = 42.8880, GNorm = 1.1170, lr_0 = 1.2909e-04
Loss = 1.8551e-03, PNorm = 42.8910, GNorm = 1.7573, lr_0 = 1.2362e-04
Validation rmse = 1.096416
Epoch 26
Loss = 1.6275e-03, PNorm = 42.8937, GNorm = 1.8944, lr_0 = 1.1839e-04
Validation rmse = 1.026063
Epoch 27
Loss = 1.8250e-03, PNorm = 42.8979, GNorm = 0.6487, lr_0 = 1.1288e-04
Loss = 1.6771e-03, PNorm = 42.8995, GNorm = 0.8025, lr_0 = 1.0810e-04
Validation rmse = 1.078271
Epoch 28
Loss = 1.0484e-03, PNorm = 42.9012, GNorm = 0.7805, lr_0 = 1.0352e-04
Loss = 1.7657e-03, PNorm = 42.9026, GNorm = 0.6126, lr_0 = 1.0000e-04
Validation rmse = 1.015773
Epoch 29
Loss = 1.5533e-03, PNorm = 42.9046, GNorm = 2.0713, lr_0 = 1.0000e-04
Loss = 1.7577e-03, PNorm = 42.9064, GNorm = 1.0447, lr_0 = 1.0000e-04
Validation rmse = 0.990149
Model 0 best validation rmse = 0.990149 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.096462
Ensemble test rmse = 1.096462
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total scaffolds = 195 | train scaffolds = 64 | val scaffolds = 68 | test scaffolds = 63
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=504, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 893,501
Moving model to cuda
Epoch 0
Loss = 1.4515e-02, PNorm = 42.3014, GNorm = 5.6943, lr_0 = 3.6053e-04
Validation rmse = 1.304731
Epoch 1
Loss = 6.1838e-03, PNorm = 42.3221, GNorm = 2.2609, lr_0 = 6.2105e-04
Loss = 6.5622e-03, PNorm = 42.3504, GNorm = 3.1506, lr_0 = 8.5789e-04
Validation rmse = 1.227256
Epoch 2
Loss = 3.2660e-03, PNorm = 42.3847, GNorm = 0.9205, lr_0 = 9.8284e-04
Loss = 4.6017e-03, PNorm = 42.4158, GNorm = 0.8359, lr_0 = 9.4120e-04
Validation rmse = 1.229398
Epoch 3
Loss = 3.3022e-03, PNorm = 42.4441, GNorm = 2.1192, lr_0 = 8.9744e-04
Loss = 3.7551e-03, PNorm = 42.4672, GNorm = 0.9348, lr_0 = 8.5943e-04
Validation rmse = 1.152144
Epoch 4
Loss = 3.6465e-03, PNorm = 42.4884, GNorm = 2.6784, lr_0 = 8.2303e-04
Loss = 3.9896e-03, PNorm = 42.5120, GNorm = 1.5018, lr_0 = 7.8816e-04
Validation rmse = 1.136327
Epoch 5
Loss = 4.1276e-03, PNorm = 42.5278, GNorm = 0.8847, lr_0 = 7.5478e-04
Loss = 2.9645e-03, PNorm = 42.5497, GNorm = 1.1914, lr_0 = 7.2281e-04
Validation rmse = 1.378857
Epoch 6
Loss = 3.4500e-03, PNorm = 42.5676, GNorm = 1.9704, lr_0 = 6.8920e-04
Loss = 2.8316e-03, PNorm = 42.5878, GNorm = 0.9245, lr_0 = 6.6001e-04
Validation rmse = 1.128306
Epoch 7
Loss = 3.2905e-03, PNorm = 42.6047, GNorm = 0.9404, lr_0 = 6.3205e-04
Loss = 2.5451e-03, PNorm = 42.6216, GNorm = 0.8381, lr_0 = 6.0528e-04
Validation rmse = 1.216342
Epoch 8
Loss = 2.6562e-03, PNorm = 42.6359, GNorm = 1.3272, lr_0 = 5.7714e-04
Loss = 3.5766e-03, PNorm = 42.6529, GNorm = 1.9701, lr_0 = 5.5269e-04
Validation rmse = 1.261939
Epoch 9
Loss = 2.5764e-03, PNorm = 42.6681, GNorm = 0.9963, lr_0 = 5.2928e-04
Loss = 2.3534e-03, PNorm = 42.6827, GNorm = 0.6105, lr_0 = 5.0686e-04
Validation rmse = 1.057287
Epoch 10
Loss = 2.4516e-03, PNorm = 42.6978, GNorm = 0.7649, lr_0 = 4.8539e-04
Loss = 2.0927e-03, PNorm = 42.7109, GNorm = 1.3969, lr_0 = 4.6483e-04
Validation rmse = 1.109059
Epoch 11
Loss = 2.0401e-03, PNorm = 42.7197, GNorm = 0.5082, lr_0 = 4.4322e-04
Loss = 2.1994e-03, PNorm = 42.7323, GNorm = 1.7356, lr_0 = 4.2444e-04
Validation rmse = 1.119461
Epoch 12
Loss = 1.8733e-03, PNorm = 42.7429, GNorm = 1.7321, lr_0 = 4.0646e-04
Loss = 2.2159e-03, PNorm = 42.7511, GNorm = 0.6773, lr_0 = 3.8925e-04
Validation rmse = 1.120894
Epoch 13
Loss = 2.2473e-03, PNorm = 42.7623, GNorm = 1.3430, lr_0 = 3.7276e-04
Loss = 2.0435e-03, PNorm = 42.7733, GNorm = 1.2517, lr_0 = 3.5697e-04
Validation rmse = 1.301638
Epoch 14
Loss = 1.8830e-03, PNorm = 42.7839, GNorm = 2.2810, lr_0 = 3.4037e-04
Loss = 1.9679e-03, PNorm = 42.7933, GNorm = 1.5787, lr_0 = 3.2596e-04
Validation rmse = 1.220476
Epoch 15
Loss = 1.7943e-03, PNorm = 42.7993, GNorm = 0.8201, lr_0 = 3.1215e-04
Loss = 1.8510e-03, PNorm = 42.8072, GNorm = 2.7113, lr_0 = 2.9893e-04
Validation rmse = 1.111073
Epoch 16
Loss = 1.8470e-03, PNorm = 42.8172, GNorm = 0.7958, lr_0 = 2.8503e-04
Loss = 1.8973e-03, PNorm = 42.8213, GNorm = 0.8875, lr_0 = 2.7295e-04
Validation rmse = 1.056252
Epoch 17
Loss = 1.8124e-03, PNorm = 42.8293, GNorm = 1.9275, lr_0 = 2.6139e-04
Loss = 1.8764e-03, PNorm = 42.8347, GNorm = 0.6049, lr_0 = 2.5032e-04
Validation rmse = 1.069280
Epoch 18
Loss = 2.0389e-03, PNorm = 42.8415, GNorm = 1.3155, lr_0 = 2.3972e-04
Loss = 1.6690e-03, PNorm = 42.8463, GNorm = 0.5858, lr_0 = 2.2956e-04
Validation rmse = 1.114981
Epoch 19
Loss = 1.6218e-03, PNorm = 42.8523, GNorm = 0.9157, lr_0 = 2.1889e-04
Loss = 1.7385e-03, PNorm = 42.8593, GNorm = 1.2696, lr_0 = 2.0962e-04
Validation rmse = 1.095043
Epoch 20
Loss = 1.6569e-03, PNorm = 42.8639, GNorm = 0.8590, lr_0 = 2.0074e-04
Loss = 1.6281e-03, PNorm = 42.8672, GNorm = 0.5210, lr_0 = 1.9224e-04
Validation rmse = 1.084923
Epoch 21
Loss = 1.6358e-03, PNorm = 42.8733, GNorm = 0.7777, lr_0 = 1.8409e-04
Loss = 1.7466e-03, PNorm = 42.8783, GNorm = 1.3453, lr_0 = 1.7630e-04
Validation rmse = 1.149105
Epoch 22
Loss = 1.8274e-03, PNorm = 42.8825, GNorm = 1.7904, lr_0 = 1.6810e-04
Loss = 1.6597e-03, PNorm = 42.8843, GNorm = 0.6124, lr_0 = 1.6098e-04
Validation rmse = 1.055006
Epoch 23
Loss = 1.7271e-03, PNorm = 42.8893, GNorm = 1.6813, lr_0 = 1.5416e-04
Loss = 1.4503e-03, PNorm = 42.8923, GNorm = 0.4483, lr_0 = 1.4763e-04
Loss = 4.1974e-03, PNorm = 42.8925, GNorm = 1.5896, lr_0 = 1.4699e-04
Validation rmse = 1.135888
Epoch 24
Loss = 1.6694e-03, PNorm = 42.8965, GNorm = 0.5627, lr_0 = 1.4077e-04
Loss = 1.7067e-03, PNorm = 42.8997, GNorm = 1.4750, lr_0 = 1.3480e-04
Validation rmse = 1.091191
Epoch 25
Loss = 1.4546e-03, PNorm = 42.9006, GNorm = 0.6355, lr_0 = 1.2909e-04
Loss = 1.6739e-03, PNorm = 42.9042, GNorm = 1.5659, lr_0 = 1.2362e-04
Validation rmse = 1.073678
Epoch 26
Loss = 1.5032e-03, PNorm = 42.9055, GNorm = 0.6362, lr_0 = 1.1839e-04
Validation rmse = 1.056593
Epoch 27
Loss = 1.6662e-03, PNorm = 42.9087, GNorm = 1.6601, lr_0 = 1.1288e-04
Loss = 1.3908e-03, PNorm = 42.9107, GNorm = 0.9550, lr_0 = 1.0810e-04
Validation rmse = 1.057789
Epoch 28
Loss = 1.4160e-03, PNorm = 42.9133, GNorm = 1.9714, lr_0 = 1.0352e-04
Loss = 1.5117e-03, PNorm = 42.9154, GNorm = 1.2648, lr_0 = 1.0000e-04
Validation rmse = 1.139194
Epoch 29
Loss = 1.7508e-03, PNorm = 42.9174, GNorm = 1.6655, lr_0 = 1.0000e-04
Loss = 1.3263e-03, PNorm = 42.9196, GNorm = 0.7541, lr_0 = 1.0000e-04
Validation rmse = 1.088698
Model 0 best validation rmse = 1.055006 on epoch 22
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.920582
Ensemble test rmse = 0.920582
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total scaffolds = 195 | train scaffolds = 69 | val scaffolds = 65 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=504, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 893,501
Moving model to cuda
Epoch 0
Loss = 1.7537e-02, PNorm = 42.2976, GNorm = 4.2234, lr_0 = 3.6053e-04
Validation rmse = 1.949137
Epoch 1
Loss = 7.2150e-03, PNorm = 42.3187, GNorm = 3.3965, lr_0 = 6.2105e-04
Loss = 6.4560e-03, PNorm = 42.3512, GNorm = 3.3850, lr_0 = 8.5789e-04
Validation rmse = 1.300246
Epoch 2
Loss = 6.5727e-03, PNorm = 42.3871, GNorm = 2.2006, lr_0 = 9.8284e-04
Loss = 5.1965e-03, PNorm = 42.4177, GNorm = 1.7116, lr_0 = 9.4120e-04
Validation rmse = 1.555555
Epoch 3
Loss = 3.8080e-03, PNorm = 42.4448, GNorm = 1.2925, lr_0 = 8.9744e-04
Loss = 4.0583e-03, PNorm = 42.4680, GNorm = 2.7751, lr_0 = 8.5943e-04
Validation rmse = 1.517730
Epoch 4
Loss = 4.4269e-03, PNorm = 42.4884, GNorm = 2.9162, lr_0 = 8.2303e-04
Loss = 4.1879e-03, PNorm = 42.5098, GNorm = 3.0117, lr_0 = 7.8816e-04
Validation rmse = 1.341179
Epoch 5
Loss = 2.6976e-03, PNorm = 42.5320, GNorm = 0.8836, lr_0 = 7.5478e-04
Loss = 3.0496e-03, PNorm = 42.5483, GNorm = 0.9173, lr_0 = 7.2281e-04
Validation rmse = 1.452242
Epoch 6
Loss = 3.5625e-03, PNorm = 42.5664, GNorm = 1.6860, lr_0 = 6.8920e-04
Loss = 3.3153e-03, PNorm = 42.5838, GNorm = 3.0532, lr_0 = 6.6001e-04
Validation rmse = 1.755320
Epoch 7
Loss = 3.4562e-03, PNorm = 42.5992, GNorm = 0.7531, lr_0 = 6.3205e-04
Loss = 3.4470e-03, PNorm = 42.6141, GNorm = 1.7559, lr_0 = 6.0528e-04
Validation rmse = 1.424048
Epoch 8
Loss = 2.5960e-03, PNorm = 42.6301, GNorm = 0.9806, lr_0 = 5.7714e-04
Loss = 2.9354e-03, PNorm = 42.6435, GNorm = 1.0943, lr_0 = 5.5269e-04
Validation rmse = 1.415414
Epoch 9
Loss = 2.7684e-03, PNorm = 42.6552, GNorm = 0.8917, lr_0 = 5.2928e-04
Loss = 2.6087e-03, PNorm = 42.6695, GNorm = 1.1901, lr_0 = 5.0686e-04
Validation rmse = 1.652654
Epoch 10
Loss = 2.7230e-03, PNorm = 42.6775, GNorm = 1.4021, lr_0 = 4.8539e-04
Loss = 2.4563e-03, PNorm = 42.6880, GNorm = 1.1541, lr_0 = 4.6483e-04
Validation rmse = 1.338568
Epoch 11
Loss = 2.6688e-03, PNorm = 42.7020, GNorm = 0.9389, lr_0 = 4.4322e-04
Loss = 2.3677e-03, PNorm = 42.7107, GNorm = 1.0549, lr_0 = 4.2444e-04
Validation rmse = 1.341370
Epoch 12
Loss = 1.8990e-03, PNorm = 42.7214, GNorm = 0.4777, lr_0 = 4.0646e-04
Loss = 2.0672e-03, PNorm = 42.7288, GNorm = 0.7885, lr_0 = 3.8925e-04
Validation rmse = 1.367152
Epoch 13
Loss = 2.0516e-03, PNorm = 42.7403, GNorm = 0.4351, lr_0 = 3.7276e-04
Loss = 2.5062e-03, PNorm = 42.7499, GNorm = 1.6931, lr_0 = 3.5697e-04
Validation rmse = 1.313184
Epoch 14
Loss = 1.9887e-03, PNorm = 42.7600, GNorm = 2.1377, lr_0 = 3.4037e-04
Loss = 2.2976e-03, PNorm = 42.7671, GNorm = 2.5172, lr_0 = 3.2596e-04
Validation rmse = 1.279906
Epoch 15
Loss = 2.2975e-03, PNorm = 42.7752, GNorm = 1.6810, lr_0 = 3.1215e-04
Loss = 2.3873e-03, PNorm = 42.7835, GNorm = 1.3330, lr_0 = 2.9893e-04
Validation rmse = 1.494069
Epoch 16
Loss = 2.3450e-03, PNorm = 42.7902, GNorm = 0.9093, lr_0 = 2.8503e-04
Loss = 2.2092e-03, PNorm = 42.7969, GNorm = 1.2626, lr_0 = 2.7295e-04
Validation rmse = 1.604943
Epoch 17
Loss = 2.1618e-03, PNorm = 42.8035, GNorm = 1.1012, lr_0 = 2.6139e-04
Loss = 1.9739e-03, PNorm = 42.8103, GNorm = 0.5700, lr_0 = 2.5032e-04
Validation rmse = 1.314842
Epoch 18
Loss = 1.7304e-03, PNorm = 42.8147, GNorm = 0.3910, lr_0 = 2.3972e-04
Loss = 2.0750e-03, PNorm = 42.8201, GNorm = 0.6147, lr_0 = 2.2956e-04
Validation rmse = 1.491618
Epoch 19
Loss = 1.8552e-03, PNorm = 42.8253, GNorm = 2.2266, lr_0 = 2.1889e-04
Loss = 2.0405e-03, PNorm = 42.8302, GNorm = 1.0365, lr_0 = 2.0962e-04
Validation rmse = 1.285224
Epoch 20
Loss = 2.0792e-03, PNorm = 42.8366, GNorm = 1.3847, lr_0 = 2.0074e-04
Loss = 1.5178e-03, PNorm = 42.8413, GNorm = 0.7184, lr_0 = 1.9224e-04
Validation rmse = 1.425799
Epoch 21
Loss = 1.8367e-03, PNorm = 42.8459, GNorm = 0.7865, lr_0 = 1.8409e-04
Loss = 1.6698e-03, PNorm = 42.8509, GNorm = 0.8015, lr_0 = 1.7630e-04
Validation rmse = 1.358893
Epoch 22
Loss = 1.7626e-03, PNorm = 42.8537, GNorm = 1.3227, lr_0 = 1.6810e-04
Loss = 1.9113e-03, PNorm = 42.8571, GNorm = 1.2165, lr_0 = 1.6098e-04
Validation rmse = 1.490174
Epoch 23
Loss = 1.6465e-03, PNorm = 42.8604, GNorm = 1.2243, lr_0 = 1.5416e-04
Loss = 1.8733e-03, PNorm = 42.8644, GNorm = 0.7756, lr_0 = 1.4763e-04
Loss = 3.3449e-03, PNorm = 42.8646, GNorm = 1.8547, lr_0 = 1.4699e-04
Validation rmse = 1.364412
Epoch 24
Loss = 1.6446e-03, PNorm = 42.8666, GNorm = 1.0416, lr_0 = 1.4077e-04
Loss = 1.7798e-03, PNorm = 42.8701, GNorm = 2.1549, lr_0 = 1.3480e-04
Validation rmse = 1.410709
Epoch 25
Loss = 1.7200e-03, PNorm = 42.8725, GNorm = 0.9865, lr_0 = 1.2909e-04
Loss = 1.6773e-03, PNorm = 42.8744, GNorm = 1.3719, lr_0 = 1.2362e-04
Validation rmse = 1.397998
Epoch 26
Loss = 1.6738e-03, PNorm = 42.8764, GNorm = 1.1786, lr_0 = 1.1839e-04
Validation rmse = 1.495613
Epoch 27
Loss = 1.2498e-03, PNorm = 42.8782, GNorm = 1.5154, lr_0 = 1.1288e-04
Loss = 1.6291e-03, PNorm = 42.8818, GNorm = 1.2030, lr_0 = 1.0810e-04
Validation rmse = 1.401872
Epoch 28
Loss = 1.1695e-03, PNorm = 42.8841, GNorm = 0.4226, lr_0 = 1.0352e-04
Loss = 1.5580e-03, PNorm = 42.8857, GNorm = 1.1098, lr_0 = 1.0000e-04
Validation rmse = 1.386351
Epoch 29
Loss = 1.4089e-03, PNorm = 42.8888, GNorm = 0.7431, lr_0 = 1.0000e-04
Loss = 1.6817e-03, PNorm = 42.8909, GNorm = 0.6445, lr_0 = 1.0000e-04
Validation rmse = 1.448699
Model 0 best validation rmse = 1.279906 on epoch 14
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.938072
Ensemble test rmse = 0.938072
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total scaffolds = 195 | train scaffolds = 75 | val scaffolds = 42 | test scaffolds = 78
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=504, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 893,501
Moving model to cuda
Epoch 0
Loss = 1.6150e-02, PNorm = 42.2982, GNorm = 6.8932, lr_0 = 3.6053e-04
Validation rmse = 1.470091
Epoch 1
Loss = 4.6822e-03, PNorm = 42.3231, GNorm = 2.7657, lr_0 = 6.2105e-04
Loss = 5.4721e-03, PNorm = 42.3502, GNorm = 3.7690, lr_0 = 8.5789e-04
Validation rmse = 1.282353
Epoch 2
Loss = 4.8252e-03, PNorm = 42.3834, GNorm = 2.9372, lr_0 = 9.8284e-04
Loss = 4.8372e-03, PNorm = 42.4096, GNorm = 3.4299, lr_0 = 9.4120e-04
Validation rmse = 1.147464
Epoch 3
Loss = 3.9678e-03, PNorm = 42.4401, GNorm = 1.7849, lr_0 = 8.9744e-04
Loss = 3.9803e-03, PNorm = 42.4656, GNorm = 1.0601, lr_0 = 8.5943e-04
Validation rmse = 1.143497
Epoch 4
Loss = 2.7740e-03, PNorm = 42.4850, GNorm = 0.8808, lr_0 = 8.2303e-04
Loss = 3.4794e-03, PNorm = 42.5003, GNorm = 1.1386, lr_0 = 7.8816e-04
Validation rmse = 1.158825
Epoch 5
Loss = 2.7895e-03, PNorm = 42.5146, GNorm = 1.0566, lr_0 = 7.5478e-04
Loss = 3.0731e-03, PNorm = 42.5284, GNorm = 1.5285, lr_0 = 7.2281e-04
Validation rmse = 1.217880
Epoch 6
Loss = 2.5669e-03, PNorm = 42.5434, GNorm = 1.5934, lr_0 = 6.8920e-04
Loss = 2.8361e-03, PNorm = 42.5592, GNorm = 0.7722, lr_0 = 6.6001e-04
Validation rmse = 1.219579
Epoch 7
Loss = 2.8033e-03, PNorm = 42.5720, GNorm = 1.4147, lr_0 = 6.3205e-04
Loss = 2.5531e-03, PNorm = 42.5868, GNorm = 0.7627, lr_0 = 6.0528e-04
Validation rmse = 1.150389
Epoch 8
Loss = 2.9609e-03, PNorm = 42.6044, GNorm = 1.2508, lr_0 = 5.7714e-04
Loss = 2.4062e-03, PNorm = 42.6173, GNorm = 2.0544, lr_0 = 5.5269e-04
Validation rmse = 1.116240
Epoch 9
Loss = 2.8217e-03, PNorm = 42.6317, GNorm = 1.1741, lr_0 = 5.2928e-04
Loss = 2.1215e-03, PNorm = 42.6416, GNorm = 0.6860, lr_0 = 5.0686e-04
Validation rmse = 1.073562
Epoch 10
Loss = 2.1463e-03, PNorm = 42.6556, GNorm = 1.5794, lr_0 = 4.8539e-04
Loss = 2.4938e-03, PNorm = 42.6677, GNorm = 1.1969, lr_0 = 4.6483e-04
Validation rmse = 1.201552
Epoch 11
Loss = 2.4804e-03, PNorm = 42.6810, GNorm = 0.9868, lr_0 = 4.4322e-04
Loss = 2.1318e-03, PNorm = 42.6901, GNorm = 1.2071, lr_0 = 4.2444e-04
Validation rmse = 1.156749
Epoch 12
Loss = 1.8673e-03, PNorm = 42.7013, GNorm = 1.8412, lr_0 = 4.0646e-04
Loss = 1.7187e-03, PNorm = 42.7094, GNorm = 1.3540, lr_0 = 3.8925e-04
Validation rmse = 1.042047
Epoch 13
Loss = 2.3967e-03, PNorm = 42.7185, GNorm = 1.0340, lr_0 = 3.7276e-04
Loss = 1.9882e-03, PNorm = 42.7291, GNorm = 0.9656, lr_0 = 3.5697e-04
Validation rmse = 1.015970
Epoch 14
Loss = 1.9404e-03, PNorm = 42.7372, GNorm = 0.9924, lr_0 = 3.4037e-04
Loss = 2.0910e-03, PNorm = 42.7452, GNorm = 0.8414, lr_0 = 3.2596e-04
Validation rmse = 1.068367
Epoch 15
Loss = 2.0799e-03, PNorm = 42.7512, GNorm = 2.3609, lr_0 = 3.1215e-04
Loss = 2.0114e-03, PNorm = 42.7577, GNorm = 1.1936, lr_0 = 2.9893e-04
Validation rmse = 1.056715
Epoch 16
Loss = 1.6728e-03, PNorm = 42.7665, GNorm = 0.8935, lr_0 = 2.8503e-04
Loss = 2.1242e-03, PNorm = 42.7724, GNorm = 1.1623, lr_0 = 2.7295e-04
Validation rmse = 1.061028
Epoch 17
Loss = 1.6267e-03, PNorm = 42.7778, GNorm = 0.7818, lr_0 = 2.6139e-04
Loss = 1.8751e-03, PNorm = 42.7842, GNorm = 0.5209, lr_0 = 2.5032e-04
Validation rmse = 1.094225
Epoch 18
Loss = 1.8430e-03, PNorm = 42.7886, GNorm = 0.5328, lr_0 = 2.3972e-04
Loss = 1.7155e-03, PNorm = 42.7945, GNorm = 0.4100, lr_0 = 2.2956e-04
Validation rmse = 1.056509
Epoch 19
Loss = 1.4861e-03, PNorm = 42.7999, GNorm = 0.6307, lr_0 = 2.1889e-04
Loss = 1.7236e-03, PNorm = 42.8040, GNorm = 0.7523, lr_0 = 2.0962e-04
Validation rmse = 1.057014
Epoch 20
Loss = 1.4935e-03, PNorm = 42.8070, GNorm = 1.0618, lr_0 = 2.0074e-04
Loss = 1.9424e-03, PNorm = 42.8106, GNorm = 1.6275, lr_0 = 1.9224e-04
Validation rmse = 1.012195
Epoch 21
Loss = 2.1206e-03, PNorm = 42.8146, GNorm = 2.5478, lr_0 = 1.8409e-04
Loss = 1.8120e-03, PNorm = 42.8202, GNorm = 1.5668, lr_0 = 1.7630e-04
Validation rmse = 1.051848
Epoch 22
Loss = 1.5612e-03, PNorm = 42.8237, GNorm = 0.9092, lr_0 = 1.6810e-04
Loss = 1.6857e-03, PNorm = 42.8280, GNorm = 1.4521, lr_0 = 1.6098e-04
Validation rmse = 1.019147
Epoch 23
Loss = 1.5660e-03, PNorm = 42.8312, GNorm = 0.8073, lr_0 = 1.5416e-04
Loss = 1.4226e-03, PNorm = 42.8341, GNorm = 0.7703, lr_0 = 1.4763e-04
Loss = 1.9898e-03, PNorm = 42.8346, GNorm = 1.1188, lr_0 = 1.4699e-04
Validation rmse = 1.041658
Epoch 24
Loss = 1.5811e-03, PNorm = 42.8371, GNorm = 0.7068, lr_0 = 1.4077e-04
Loss = 1.6732e-03, PNorm = 42.8412, GNorm = 0.5880, lr_0 = 1.3480e-04
Validation rmse = 1.039422
Epoch 25
Loss = 1.8464e-03, PNorm = 42.8439, GNorm = 1.3198, lr_0 = 1.2909e-04
Loss = 1.3377e-03, PNorm = 42.8469, GNorm = 1.0436, lr_0 = 1.2362e-04
Validation rmse = 1.008393
Epoch 26
Loss = 1.6757e-03, PNorm = 42.8494, GNorm = 2.4115, lr_0 = 1.1839e-04
Validation rmse = 1.048294
Epoch 27
Loss = 2.8578e-03, PNorm = 42.8502, GNorm = 2.1410, lr_0 = 1.1288e-04
Loss = 1.3502e-03, PNorm = 42.8527, GNorm = 0.5513, lr_0 = 1.0810e-04
Validation rmse = 1.004708
Epoch 28
Loss = 1.3388e-03, PNorm = 42.8555, GNorm = 0.6482, lr_0 = 1.0352e-04
Loss = 1.5797e-03, PNorm = 42.8565, GNorm = 1.0271, lr_0 = 1.0000e-04
Validation rmse = 1.034744
Epoch 29
Loss = 1.2987e-03, PNorm = 42.8593, GNorm = 0.4924, lr_0 = 1.0000e-04
Loss = 1.5356e-03, PNorm = 42.8615, GNorm = 1.0615, lr_0 = 1.0000e-04
Validation rmse = 1.045657
Model 0 best validation rmse = 1.004708 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.101867
Ensemble test rmse = 1.101867
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 58 | test scaffolds = 53
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=504, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 893,501
Moving model to cuda
Epoch 0
Loss = 1.5885e-02, PNorm = 42.2991, GNorm = 6.4293, lr_0 = 3.6053e-04
Validation rmse = 1.588026
Epoch 1
Loss = 1.0296e-02, PNorm = 42.3212, GNorm = 5.5053, lr_0 = 6.2105e-04
Loss = 7.8830e-03, PNorm = 42.3503, GNorm = 1.6126, lr_0 = 8.5789e-04
Validation rmse = 1.240888
Epoch 2
Loss = 4.5958e-03, PNorm = 42.3899, GNorm = 0.8403, lr_0 = 9.8284e-04
Loss = 4.3403e-03, PNorm = 42.4173, GNorm = 0.9407, lr_0 = 9.4120e-04
Validation rmse = 1.107454
Epoch 3
Loss = 3.8754e-03, PNorm = 42.4422, GNorm = 1.3862, lr_0 = 8.9744e-04
Loss = 4.1393e-03, PNorm = 42.4603, GNorm = 0.9142, lr_0 = 8.5943e-04
Validation rmse = 1.081808
Epoch 4
Loss = 4.1179e-03, PNorm = 42.4802, GNorm = 4.1658, lr_0 = 8.2303e-04
Loss = 3.4154e-03, PNorm = 42.5020, GNorm = 1.0882, lr_0 = 7.8816e-04
Validation rmse = 1.076686
Epoch 5
Loss = 2.7563e-03, PNorm = 42.5155, GNorm = 0.8080, lr_0 = 7.5478e-04
Loss = 3.2527e-03, PNorm = 42.5348, GNorm = 0.9576, lr_0 = 7.2281e-04
Validation rmse = 1.114485
Epoch 6
Loss = 3.8107e-03, PNorm = 42.5547, GNorm = 3.4335, lr_0 = 6.8920e-04
Loss = 3.1382e-03, PNorm = 42.5716, GNorm = 0.8614, lr_0 = 6.6001e-04
Validation rmse = 1.037115
Epoch 7
Loss = 3.6537e-03, PNorm = 42.5930, GNorm = 2.5382, lr_0 = 6.3205e-04
Loss = 2.7858e-03, PNorm = 42.6040, GNorm = 0.7779, lr_0 = 6.0528e-04
Validation rmse = 1.029038
Epoch 8
Loss = 2.8187e-03, PNorm = 42.6186, GNorm = 1.1363, lr_0 = 5.7714e-04
Loss = 3.1039e-03, PNorm = 42.6358, GNorm = 1.8167, lr_0 = 5.5269e-04
Validation rmse = 1.110826
Epoch 9
Loss = 2.9506e-03, PNorm = 42.6506, GNorm = 2.1377, lr_0 = 5.2928e-04
Loss = 2.3417e-03, PNorm = 42.6657, GNorm = 1.0624, lr_0 = 5.0686e-04
Validation rmse = 1.011040
Epoch 10
Loss = 2.4856e-03, PNorm = 42.6749, GNorm = 2.2346, lr_0 = 4.8539e-04
Loss = 2.5611e-03, PNorm = 42.6855, GNorm = 2.6994, lr_0 = 4.6483e-04
Validation rmse = 0.999024
Epoch 11
Loss = 2.3253e-03, PNorm = 42.6991, GNorm = 0.6549, lr_0 = 4.4322e-04
Loss = 2.4200e-03, PNorm = 42.7081, GNorm = 1.7106, lr_0 = 4.2444e-04
Validation rmse = 1.019626
Epoch 12
Loss = 2.4797e-03, PNorm = 42.7198, GNorm = 1.8698, lr_0 = 4.0646e-04
Loss = 2.3014e-03, PNorm = 42.7284, GNorm = 2.2511, lr_0 = 3.8925e-04
Validation rmse = 0.964297
Epoch 13
Loss = 1.8180e-03, PNorm = 42.7357, GNorm = 0.7313, lr_0 = 3.7276e-04
Loss = 2.3750e-03, PNorm = 42.7462, GNorm = 2.9059, lr_0 = 3.5697e-04
Validation rmse = 1.027941
Epoch 14
Loss = 2.0589e-03, PNorm = 42.7562, GNorm = 1.2430, lr_0 = 3.4037e-04
Loss = 1.8885e-03, PNorm = 42.7659, GNorm = 0.5941, lr_0 = 3.2596e-04
Validation rmse = 1.036632
Epoch 15
Loss = 1.9597e-03, PNorm = 42.7711, GNorm = 1.5804, lr_0 = 3.1215e-04
Loss = 2.3373e-03, PNorm = 42.7763, GNorm = 2.4000, lr_0 = 2.9893e-04
Validation rmse = 0.989824
Epoch 16
Loss = 2.4463e-03, PNorm = 42.7858, GNorm = 1.4580, lr_0 = 2.8503e-04
Loss = 1.8607e-03, PNorm = 42.7907, GNorm = 0.8204, lr_0 = 2.7295e-04
Validation rmse = 1.031165
Epoch 17
Loss = 1.8792e-03, PNorm = 42.7969, GNorm = 1.0893, lr_0 = 2.6139e-04
Loss = 2.0194e-03, PNorm = 42.8027, GNorm = 1.6690, lr_0 = 2.5032e-04
Validation rmse = 0.976543
Epoch 18
Loss = 1.7486e-03, PNorm = 42.8080, GNorm = 0.6919, lr_0 = 2.3972e-04
Loss = 2.3547e-03, PNorm = 42.8125, GNorm = 1.4779, lr_0 = 2.2956e-04
Validation rmse = 0.890424
Epoch 19
Loss = 2.0219e-03, PNorm = 42.8168, GNorm = 1.0382, lr_0 = 2.1889e-04
Loss = 2.1484e-03, PNorm = 42.8228, GNorm = 0.6849, lr_0 = 2.0962e-04
Validation rmse = 0.925178
Epoch 20
Loss = 2.2132e-03, PNorm = 42.8280, GNorm = 1.0609, lr_0 = 2.0074e-04
Loss = 1.6648e-03, PNorm = 42.8317, GNorm = 0.7991, lr_0 = 1.9224e-04
Validation rmse = 0.885554
Epoch 21
Loss = 1.6685e-03, PNorm = 42.8352, GNorm = 0.6031, lr_0 = 1.8409e-04
Loss = 1.7707e-03, PNorm = 42.8387, GNorm = 1.1519, lr_0 = 1.7630e-04
Validation rmse = 0.937626
Epoch 22
Loss = 1.8368e-03, PNorm = 42.8432, GNorm = 2.4170, lr_0 = 1.6810e-04
Loss = 1.8701e-03, PNorm = 42.8462, GNorm = 2.3295, lr_0 = 1.6098e-04
Validation rmse = 0.908849
Epoch 23
Loss = 1.6470e-03, PNorm = 42.8486, GNorm = 1.0378, lr_0 = 1.5416e-04
Loss = 1.9410e-03, PNorm = 42.8528, GNorm = 1.0244, lr_0 = 1.4763e-04
Loss = 2.9949e-03, PNorm = 42.8533, GNorm = 1.5302, lr_0 = 1.4699e-04
Validation rmse = 0.928804
Epoch 24
Loss = 1.8144e-03, PNorm = 42.8561, GNorm = 0.7082, lr_0 = 1.4077e-04
Loss = 1.7142e-03, PNorm = 42.8581, GNorm = 1.9938, lr_0 = 1.3480e-04
Validation rmse = 0.934153
Epoch 25
Loss = 1.6713e-03, PNorm = 42.8600, GNorm = 0.7419, lr_0 = 1.2909e-04
Loss = 1.6893e-03, PNorm = 42.8628, GNorm = 1.2008, lr_0 = 1.2362e-04
Validation rmse = 0.920778
Epoch 26
Loss = 1.6757e-03, PNorm = 42.8653, GNorm = 0.9102, lr_0 = 1.1839e-04
Validation rmse = 0.922604
Epoch 27
Loss = 2.7152e-03, PNorm = 42.8677, GNorm = 2.0236, lr_0 = 1.1288e-04
Loss = 1.7314e-03, PNorm = 42.8702, GNorm = 0.7955, lr_0 = 1.0810e-04
Validation rmse = 0.939150
Epoch 28
Loss = 1.8979e-03, PNorm = 42.8722, GNorm = 1.2227, lr_0 = 1.0352e-04
Loss = 1.6196e-03, PNorm = 42.8747, GNorm = 1.0933, lr_0 = 1.0000e-04
Validation rmse = 0.952378
Epoch 29
Loss = 2.1324e-03, PNorm = 42.8773, GNorm = 1.8274, lr_0 = 1.0000e-04
Loss = 1.6074e-03, PNorm = 42.8790, GNorm = 1.2393, lr_0 = 1.0000e-04
Validation rmse = 0.880912
Model 0 best validation rmse = 0.880912 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.316832
Ensemble test rmse = 1.316832
10-fold cross validation
	Seed 0 ==> test rmse = 1.079114
	Seed 1 ==> test rmse = 1.016801
	Seed 2 ==> test rmse = 1.028035
	Seed 3 ==> test rmse = 1.061967
	Seed 4 ==> test rmse = 1.031850
	Seed 5 ==> test rmse = 1.096462
	Seed 6 ==> test rmse = 0.920582
	Seed 7 ==> test rmse = 0.938072
	Seed 8 ==> test rmse = 1.101867
	Seed 9 ==> test rmse = 1.316832
Overall test rmse = 1.059158 +/- 0.103630
Elapsed time = 0:06:24
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total scaffolds = 195 | train scaffolds = 91 | val scaffolds = 66 | test scaffolds = 38
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2404, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,731,201
Moving model to cuda
Epoch 0
Loss = 1.1164e-02, PNorm = 99.7845, GNorm = 4.8578, lr_0 = 3.6053e-04
Validation rmse = 1.030123
Epoch 1
Loss = 1.5665e-03, PNorm = 99.9167, GNorm = 0.7728, lr_0 = 6.2105e-04
Loss = 4.1995e-03, PNorm = 100.0776, GNorm = 1.9325, lr_0 = 8.5789e-04
Validation rmse = 0.885328
Epoch 2
Loss = 3.9594e-03, PNorm = 100.2798, GNorm = 0.6321, lr_0 = 9.8284e-04
Loss = 2.9759e-03, PNorm = 100.4825, GNorm = 0.4979, lr_0 = 9.4120e-04
Validation rmse = 1.009791
Epoch 3
Loss = 1.5709e-03, PNorm = 100.6560, GNorm = 0.6705, lr_0 = 8.9744e-04
Loss = 1.7678e-03, PNorm = 100.7624, GNorm = 0.5141, lr_0 = 8.5943e-04
Validation rmse = 0.998047
Epoch 4
Loss = 2.5529e-03, PNorm = 100.8489, GNorm = 0.6197, lr_0 = 8.2303e-04
Loss = 1.1766e-03, PNorm = 100.9163, GNorm = 0.2864, lr_0 = 7.8816e-04
Validation rmse = 0.878743
Epoch 5
Loss = 1.1913e-03, PNorm = 100.9710, GNorm = 0.8482, lr_0 = 7.5478e-04
Loss = 1.2219e-03, PNorm = 101.0227, GNorm = 0.4403, lr_0 = 7.2281e-04
Validation rmse = 0.840192
Epoch 6
Loss = 1.3266e-03, PNorm = 101.0845, GNorm = 0.4424, lr_0 = 6.8920e-04
Loss = 1.2043e-03, PNorm = 101.1279, GNorm = 0.4791, lr_0 = 6.6001e-04
Validation rmse = 0.905151
Epoch 7
Loss = 1.0108e-03, PNorm = 101.1750, GNorm = 0.2721, lr_0 = 6.3205e-04
Loss = 9.9238e-04, PNorm = 101.2185, GNorm = 0.3652, lr_0 = 6.0528e-04
Validation rmse = 0.947920
Epoch 8
Loss = 9.7444e-04, PNorm = 101.2631, GNorm = 0.4324, lr_0 = 5.7714e-04
Loss = 9.6863e-04, PNorm = 101.3040, GNorm = 0.3096, lr_0 = 5.5269e-04
Validation rmse = 0.818343
Epoch 9
Loss = 1.0449e-03, PNorm = 101.3402, GNorm = 1.7450, lr_0 = 5.2928e-04
Loss = 1.2305e-03, PNorm = 101.3875, GNorm = 0.4465, lr_0 = 5.0686e-04
Validation rmse = 0.891942
Epoch 10
Loss = 9.0231e-04, PNorm = 101.4267, GNorm = 0.4486, lr_0 = 4.8539e-04
Loss = 8.6499e-04, PNorm = 101.4704, GNorm = 0.1470, lr_0 = 4.6483e-04
Validation rmse = 0.958509
Epoch 11
Loss = 7.8142e-04, PNorm = 101.5133, GNorm = 0.4523, lr_0 = 4.4322e-04
Loss = 6.5293e-04, PNorm = 101.5486, GNorm = 0.3376, lr_0 = 4.2444e-04
Validation rmse = 0.883247
Epoch 12
Loss = 6.8173e-04, PNorm = 101.5796, GNorm = 0.2750, lr_0 = 4.0646e-04
Loss = 6.5201e-04, PNorm = 101.6116, GNorm = 0.1809, lr_0 = 3.8925e-04
Validation rmse = 0.867939
Epoch 13
Loss = 4.7496e-04, PNorm = 101.6438, GNorm = 0.1729, lr_0 = 3.7276e-04
Loss = 6.0077e-04, PNorm = 101.6739, GNorm = 0.3870, lr_0 = 3.5697e-04
Validation rmse = 0.862226
Epoch 14
Loss = 5.5481e-04, PNorm = 101.7039, GNorm = 0.4267, lr_0 = 3.4037e-04
Loss = 5.3578e-04, PNorm = 101.7298, GNorm = 0.3552, lr_0 = 3.2596e-04
Validation rmse = 0.836977
Epoch 15
Loss = 5.2589e-04, PNorm = 101.7536, GNorm = 0.4040, lr_0 = 3.1215e-04
Loss = 5.5774e-04, PNorm = 101.7815, GNorm = 0.3754, lr_0 = 2.9893e-04
Validation rmse = 0.832800
Epoch 16
Loss = 4.8374e-04, PNorm = 101.8110, GNorm = 0.2036, lr_0 = 2.8503e-04
Loss = 4.5792e-04, PNorm = 101.8353, GNorm = 0.2913, lr_0 = 2.7295e-04
Validation rmse = 0.849456
Epoch 17
Loss = 4.1486e-04, PNorm = 101.8569, GNorm = 0.3382, lr_0 = 2.6139e-04
Loss = 4.5119e-04, PNorm = 101.8772, GNorm = 0.2462, lr_0 = 2.5032e-04
Validation rmse = 0.908479
Epoch 18
Loss = 3.8222e-04, PNorm = 101.8959, GNorm = 0.1757, lr_0 = 2.3972e-04
Loss = 3.9263e-04, PNorm = 101.9197, GNorm = 0.2613, lr_0 = 2.2956e-04
Validation rmse = 0.948821
Epoch 19
Loss = 4.4370e-04, PNorm = 101.9380, GNorm = 0.4810, lr_0 = 2.1889e-04
Loss = 4.3889e-04, PNorm = 101.9588, GNorm = 0.3053, lr_0 = 2.0962e-04
Validation rmse = 0.869617
Epoch 20
Loss = 3.3261e-04, PNorm = 101.9753, GNorm = 0.2159, lr_0 = 2.0074e-04
Loss = 4.1942e-04, PNorm = 101.9935, GNorm = 0.1312, lr_0 = 1.9224e-04
Validation rmse = 0.901512
Epoch 21
Loss = 3.6477e-04, PNorm = 102.0086, GNorm = 0.2159, lr_0 = 1.8409e-04
Loss = 3.9392e-04, PNorm = 102.0247, GNorm = 0.2548, lr_0 = 1.7630e-04
Validation rmse = 0.859387
Epoch 22
Loss = 2.8201e-04, PNorm = 102.0387, GNorm = 0.2530, lr_0 = 1.6810e-04
Loss = 4.1234e-04, PNorm = 102.0528, GNorm = 0.2651, lr_0 = 1.6098e-04
Validation rmse = 0.891568
Epoch 23
Loss = 3.0734e-04, PNorm = 102.0664, GNorm = 0.2131, lr_0 = 1.5416e-04
Loss = 3.2458e-04, PNorm = 102.0793, GNorm = 0.0986, lr_0 = 1.4763e-04
Loss = 5.6966e-04, PNorm = 102.0806, GNorm = 0.1981, lr_0 = 1.4699e-04
Validation rmse = 0.882909
Epoch 24
Loss = 2.9066e-04, PNorm = 102.0921, GNorm = 0.2260, lr_0 = 1.4077e-04
Loss = 3.5407e-04, PNorm = 102.1050, GNorm = 0.3107, lr_0 = 1.3480e-04
Validation rmse = 0.865336
Epoch 25
Loss = 2.8415e-04, PNorm = 102.1151, GNorm = 0.1424, lr_0 = 1.2909e-04
Loss = 3.1514e-04, PNorm = 102.1242, GNorm = 0.2304, lr_0 = 1.2362e-04
Validation rmse = 0.918010
Epoch 26
Loss = 3.0759e-04, PNorm = 102.1328, GNorm = 0.2446, lr_0 = 1.1839e-04
Validation rmse = 0.873854
Epoch 27
Loss = 2.9459e-04, PNorm = 102.1435, GNorm = 0.3112, lr_0 = 1.1288e-04
Loss = 2.7678e-04, PNorm = 102.1514, GNorm = 0.1953, lr_0 = 1.0810e-04
Validation rmse = 0.867595
Epoch 28
Loss = 3.3148e-04, PNorm = 102.1604, GNorm = 0.2302, lr_0 = 1.0352e-04
Loss = 2.2864e-04, PNorm = 102.1689, GNorm = 0.2277, lr_0 = 1.0000e-04
Validation rmse = 0.864336
Epoch 29
Loss = 2.4040e-04, PNorm = 102.1782, GNorm = 0.3383, lr_0 = 1.0000e-04
Loss = 2.8233e-04, PNorm = 102.1867, GNorm = 0.2508, lr_0 = 1.0000e-04
Validation rmse = 0.848093
Model 0 best validation rmse = 0.818343 on epoch 8
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.760280
Ensemble test rmse = 0.760280
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total scaffolds = 195 | train scaffolds = 76 | val scaffolds = 60 | test scaffolds = 59
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2404, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,731,201
Moving model to cuda
Epoch 0
Loss = 1.1559e-02, PNorm = 99.7886, GNorm = 4.5248, lr_0 = 3.6053e-04
Validation rmse = 1.176750
Epoch 1
Loss = 4.2348e-03, PNorm = 99.9117, GNorm = 0.8994, lr_0 = 6.2105e-04
Loss = 4.1036e-03, PNorm = 100.0855, GNorm = 1.8139, lr_0 = 8.5789e-04
Validation rmse = 1.144861
Epoch 2
Loss = 3.2061e-03, PNorm = 100.2923, GNorm = 2.0775, lr_0 = 9.8284e-04
Loss = 1.7593e-03, PNorm = 100.4568, GNorm = 0.4967, lr_0 = 9.4120e-04
Validation rmse = 0.899524
Epoch 3
Loss = 1.3772e-03, PNorm = 100.5884, GNorm = 0.6038, lr_0 = 8.9744e-04
Loss = 1.9862e-03, PNorm = 100.6844, GNorm = 0.5315, lr_0 = 8.5943e-04
Validation rmse = 0.831306
Epoch 4
Loss = 1.0557e-03, PNorm = 100.7590, GNorm = 0.3391, lr_0 = 8.2303e-04
Loss = 1.2397e-03, PNorm = 100.8203, GNorm = 0.4470, lr_0 = 7.8816e-04
Validation rmse = 0.886758
Epoch 5
Loss = 1.4536e-03, PNorm = 100.8733, GNorm = 0.8794, lr_0 = 7.5478e-04
Loss = 1.4560e-03, PNorm = 100.9344, GNorm = 0.9942, lr_0 = 7.2281e-04
Validation rmse = 0.805053
Epoch 6
Loss = 1.0210e-03, PNorm = 100.9875, GNorm = 0.3388, lr_0 = 6.8920e-04
Loss = 1.1167e-03, PNorm = 101.0390, GNorm = 0.7698, lr_0 = 6.6001e-04
Validation rmse = 0.814630
Epoch 7
Loss = 6.8045e-04, PNorm = 101.0855, GNorm = 0.5576, lr_0 = 6.3205e-04
Loss = 1.1139e-03, PNorm = 101.1308, GNorm = 0.5078, lr_0 = 6.0528e-04
Validation rmse = 0.795492
Epoch 8
Loss = 1.0186e-03, PNorm = 101.1816, GNorm = 0.5102, lr_0 = 5.7714e-04
Loss = 7.8268e-04, PNorm = 101.2317, GNorm = 0.5881, lr_0 = 5.5269e-04
Validation rmse = 0.790947
Epoch 9
Loss = 8.1672e-04, PNorm = 101.2667, GNorm = 0.2943, lr_0 = 5.2928e-04
Loss = 9.5328e-04, PNorm = 101.3044, GNorm = 0.5422, lr_0 = 5.0686e-04
Validation rmse = 0.847108
Epoch 10
Loss = 8.3092e-04, PNorm = 101.3401, GNorm = 0.3616, lr_0 = 4.8539e-04
Loss = 6.9238e-04, PNorm = 101.3743, GNorm = 0.5144, lr_0 = 4.6483e-04
Validation rmse = 0.770397
Epoch 11
Loss = 9.7515e-04, PNorm = 101.4140, GNorm = 0.3778, lr_0 = 4.4322e-04
Loss = 8.5564e-04, PNorm = 101.4470, GNorm = 0.3444, lr_0 = 4.2444e-04
Validation rmse = 0.797835
Epoch 12
Loss = 5.4866e-04, PNorm = 101.4719, GNorm = 0.3216, lr_0 = 4.0646e-04
Loss = 7.5066e-04, PNorm = 101.5001, GNorm = 0.4262, lr_0 = 3.8925e-04
Validation rmse = 0.793382
Epoch 13
Loss = 8.7586e-04, PNorm = 101.5285, GNorm = 0.4549, lr_0 = 3.7276e-04
Loss = 5.8537e-04, PNorm = 101.5614, GNorm = 0.3499, lr_0 = 3.5697e-04
Validation rmse = 0.800425
Epoch 14
Loss = 4.5058e-04, PNorm = 101.5918, GNorm = 0.4826, lr_0 = 3.4037e-04
Loss = 6.1104e-04, PNorm = 101.6181, GNorm = 0.2415, lr_0 = 3.2596e-04
Validation rmse = 0.813632
Epoch 15
Loss = 6.9034e-04, PNorm = 101.6427, GNorm = 0.3523, lr_0 = 3.1215e-04
Loss = 4.9621e-04, PNorm = 101.6700, GNorm = 0.3612, lr_0 = 2.9893e-04
Validation rmse = 0.807564
Epoch 16
Loss = 5.0187e-04, PNorm = 101.6953, GNorm = 0.2840, lr_0 = 2.8503e-04
Loss = 5.7247e-04, PNorm = 101.7183, GNorm = 0.5437, lr_0 = 2.7295e-04
Validation rmse = 0.791338
Epoch 17
Loss = 4.3681e-04, PNorm = 101.7443, GNorm = 0.3739, lr_0 = 2.6139e-04
Loss = 5.3385e-04, PNorm = 101.7654, GNorm = 0.3950, lr_0 = 2.5032e-04
Validation rmse = 0.808537
Epoch 18
Loss = 4.7671e-04, PNorm = 101.7850, GNorm = 0.3501, lr_0 = 2.3972e-04
Loss = 4.7676e-04, PNorm = 101.8060, GNorm = 0.3650, lr_0 = 2.2956e-04
Validation rmse = 0.813901
Epoch 19
Loss = 3.0168e-04, PNorm = 101.8249, GNorm = 0.1833, lr_0 = 2.1889e-04
Loss = 4.7095e-04, PNorm = 101.8421, GNorm = 0.2774, lr_0 = 2.0962e-04
Validation rmse = 0.804915
Epoch 20
Loss = 3.6343e-04, PNorm = 101.8609, GNorm = 0.1038, lr_0 = 2.0074e-04
Loss = 4.2783e-04, PNorm = 101.8740, GNorm = 0.1748, lr_0 = 1.9224e-04
Validation rmse = 0.773977
Epoch 21
Loss = 3.5676e-04, PNorm = 101.8918, GNorm = 0.4511, lr_0 = 1.8409e-04
Loss = 4.1771e-04, PNorm = 101.9065, GNorm = 0.3583, lr_0 = 1.7630e-04
Validation rmse = 0.772711
Epoch 22
Loss = 3.7680e-04, PNorm = 101.9236, GNorm = 0.2294, lr_0 = 1.6810e-04
Loss = 3.5555e-04, PNorm = 101.9349, GNorm = 0.3833, lr_0 = 1.6098e-04
Validation rmse = 0.778380
Epoch 23
Loss = 4.0438e-04, PNorm = 101.9479, GNorm = 0.3205, lr_0 = 1.5416e-04
Loss = 3.5060e-04, PNorm = 101.9603, GNorm = 0.4028, lr_0 = 1.4763e-04
Loss = 3.5964e-04, PNorm = 101.9617, GNorm = 0.2533, lr_0 = 1.4699e-04
Validation rmse = 0.791828
Epoch 24
Loss = 3.5630e-04, PNorm = 101.9771, GNorm = 0.2520, lr_0 = 1.4077e-04
Loss = 3.3980e-04, PNorm = 101.9884, GNorm = 0.1690, lr_0 = 1.3480e-04
Validation rmse = 0.798569
Epoch 25
Loss = 3.1723e-04, PNorm = 101.9982, GNorm = 0.1348, lr_0 = 1.2909e-04
Loss = 3.3699e-04, PNorm = 102.0082, GNorm = 0.3479, lr_0 = 1.2362e-04
Validation rmse = 0.781505
Epoch 26
Loss = 2.9720e-04, PNorm = 102.0196, GNorm = 0.3086, lr_0 = 1.1839e-04
Validation rmse = 0.778586
Epoch 27
Loss = 2.8027e-04, PNorm = 102.0297, GNorm = 0.4746, lr_0 = 1.1288e-04
Loss = 2.9799e-04, PNorm = 102.0397, GNorm = 0.3162, lr_0 = 1.0810e-04
Validation rmse = 0.773702
Epoch 28
Loss = 1.5330e-04, PNorm = 102.0482, GNorm = 0.2157, lr_0 = 1.0352e-04
Loss = 3.2072e-04, PNorm = 102.0587, GNorm = 0.2832, lr_0 = 1.0000e-04
Validation rmse = 0.769962
Epoch 29
Loss = 1.7238e-04, PNorm = 102.0679, GNorm = 0.2126, lr_0 = 1.0000e-04
Loss = 2.7878e-04, PNorm = 102.0765, GNorm = 0.1991, lr_0 = 1.0000e-04
Validation rmse = 0.767944
Model 0 best validation rmse = 0.767944 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.807432
Ensemble test rmse = 0.807432
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total scaffolds = 195 | train scaffolds = 55 | val scaffolds = 64 | test scaffolds = 76
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2404, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,731,201
Moving model to cuda
Epoch 0
Loss = 1.2934e-02, PNorm = 99.7865, GNorm = 0.9656, lr_0 = 3.6053e-04
Validation rmse = 1.332816
Epoch 1
Loss = 6.0629e-03, PNorm = 99.9187, GNorm = 1.4245, lr_0 = 6.2105e-04
Loss = 3.8418e-03, PNorm = 100.1155, GNorm = 0.9526, lr_0 = 8.5789e-04
Validation rmse = 1.158084
Epoch 2
Loss = 2.8812e-03, PNorm = 100.3173, GNorm = 1.4285, lr_0 = 9.8284e-04
Loss = 2.1362e-03, PNorm = 100.4763, GNorm = 0.7865, lr_0 = 9.4120e-04
Validation rmse = 0.940006
Epoch 3
Loss = 2.0331e-03, PNorm = 100.6062, GNorm = 0.5032, lr_0 = 8.9744e-04
Loss = 1.7642e-03, PNorm = 100.6967, GNorm = 0.5245, lr_0 = 8.5943e-04
Validation rmse = 0.926625
Epoch 4
Loss = 8.3072e-04, PNorm = 100.7691, GNorm = 0.4462, lr_0 = 8.2303e-04
Loss = 1.5051e-03, PNorm = 100.8375, GNorm = 1.0185, lr_0 = 7.8816e-04
Validation rmse = 0.980932
Epoch 5
Loss = 9.9714e-04, PNorm = 100.8916, GNorm = 0.5529, lr_0 = 7.5478e-04
Loss = 1.2831e-03, PNorm = 100.9500, GNorm = 0.5087, lr_0 = 7.2281e-04
Validation rmse = 0.818865
Epoch 6
Loss = 1.2942e-03, PNorm = 101.0192, GNorm = 1.2156, lr_0 = 6.8920e-04
Loss = 1.4106e-03, PNorm = 101.0789, GNorm = 0.7489, lr_0 = 6.6001e-04
Validation rmse = 0.878108
Epoch 7
Loss = 1.2859e-03, PNorm = 101.1299, GNorm = 0.7385, lr_0 = 6.3205e-04
Loss = 1.0745e-03, PNorm = 101.1734, GNorm = 0.4036, lr_0 = 6.0528e-04
Validation rmse = 0.824676
Epoch 8
Loss = 1.1612e-03, PNorm = 101.2339, GNorm = 0.2447, lr_0 = 5.7714e-04
Loss = 9.1116e-04, PNorm = 101.2858, GNorm = 0.2905, lr_0 = 5.5269e-04
Validation rmse = 0.792931
Epoch 9
Loss = 9.1274e-04, PNorm = 101.3240, GNorm = 0.5021, lr_0 = 5.2928e-04
Loss = 8.7763e-04, PNorm = 101.3634, GNorm = 0.2604, lr_0 = 5.0686e-04
Validation rmse = 0.784702
Epoch 10
Loss = 7.1195e-04, PNorm = 101.3987, GNorm = 0.8173, lr_0 = 4.8539e-04
Loss = 7.9449e-04, PNorm = 101.4349, GNorm = 0.5841, lr_0 = 4.6483e-04
Validation rmse = 0.848780
Epoch 11
Loss = 7.7890e-04, PNorm = 101.4822, GNorm = 0.2018, lr_0 = 4.4322e-04
Loss = 7.3584e-04, PNorm = 101.5219, GNorm = 0.3938, lr_0 = 4.2444e-04
Validation rmse = 0.808657
Epoch 12
Loss = 6.6350e-04, PNorm = 101.5583, GNorm = 0.2934, lr_0 = 4.0646e-04
Loss = 8.0554e-04, PNorm = 101.5930, GNorm = 0.5556, lr_0 = 3.8925e-04
Validation rmse = 0.777871
Epoch 13
Loss = 5.7689e-04, PNorm = 101.6262, GNorm = 0.3584, lr_0 = 3.7276e-04
Loss = 5.6605e-04, PNorm = 101.6597, GNorm = 0.3845, lr_0 = 3.5697e-04
Validation rmse = 0.793955
Epoch 14
Loss = 6.0084e-04, PNorm = 101.6903, GNorm = 0.2434, lr_0 = 3.4037e-04
Loss = 6.0021e-04, PNorm = 101.7270, GNorm = 0.3124, lr_0 = 3.2596e-04
Validation rmse = 0.818973
Epoch 15
Loss = 5.3072e-04, PNorm = 101.7487, GNorm = 0.3883, lr_0 = 3.1215e-04
Loss = 5.6829e-04, PNorm = 101.7782, GNorm = 0.2055, lr_0 = 2.9893e-04
Validation rmse = 0.815881
Epoch 16
Loss = 4.5820e-04, PNorm = 101.8094, GNorm = 0.1945, lr_0 = 2.8503e-04
Loss = 4.9847e-04, PNorm = 101.8350, GNorm = 0.3770, lr_0 = 2.7295e-04
Validation rmse = 0.785740
Epoch 17
Loss = 5.8251e-04, PNorm = 101.8556, GNorm = 0.3291, lr_0 = 2.6139e-04
Loss = 4.4677e-04, PNorm = 101.8774, GNorm = 0.3566, lr_0 = 2.5032e-04
Validation rmse = 0.814880
Epoch 18
Loss = 4.4478e-04, PNorm = 101.8963, GNorm = 0.2900, lr_0 = 2.3972e-04
Loss = 4.7054e-04, PNorm = 101.9195, GNorm = 0.2156, lr_0 = 2.2956e-04
Validation rmse = 0.809962
Epoch 19
Loss = 4.0206e-04, PNorm = 101.9400, GNorm = 0.3088, lr_0 = 2.1889e-04
Loss = 5.0961e-04, PNorm = 101.9590, GNorm = 0.3940, lr_0 = 2.0962e-04
Validation rmse = 0.783264
Epoch 20
Loss = 3.6294e-04, PNorm = 101.9736, GNorm = 0.4420, lr_0 = 2.0074e-04
Loss = 4.7299e-04, PNorm = 101.9921, GNorm = 0.2308, lr_0 = 1.9224e-04
Validation rmse = 0.797908
Epoch 21
Loss = 3.9227e-04, PNorm = 102.0083, GNorm = 0.2761, lr_0 = 1.8409e-04
Loss = 3.3451e-04, PNorm = 102.0253, GNorm = 0.1431, lr_0 = 1.7630e-04
Validation rmse = 0.787599
Epoch 22
Loss = 3.5982e-04, PNorm = 102.0413, GNorm = 0.4372, lr_0 = 1.6810e-04
Loss = 3.2800e-04, PNorm = 102.0556, GNorm = 0.2631, lr_0 = 1.6098e-04
Validation rmse = 0.827280
Epoch 23
Loss = 2.9148e-04, PNorm = 102.0676, GNorm = 0.2794, lr_0 = 1.5416e-04
Loss = 3.9243e-04, PNorm = 102.0811, GNorm = 0.2810, lr_0 = 1.4763e-04
Loss = 6.0491e-04, PNorm = 102.0823, GNorm = 0.3154, lr_0 = 1.4699e-04
Validation rmse = 0.808491
Epoch 24
Loss = 3.1607e-04, PNorm = 102.0960, GNorm = 0.2560, lr_0 = 1.4077e-04
Loss = 3.1646e-04, PNorm = 102.1076, GNorm = 0.1564, lr_0 = 1.3480e-04
Validation rmse = 0.798550
Epoch 25
Loss = 3.1802e-04, PNorm = 102.1186, GNorm = 0.2083, lr_0 = 1.2909e-04
Loss = 2.9030e-04, PNorm = 102.1283, GNorm = 0.2100, lr_0 = 1.2362e-04
Validation rmse = 0.807015
Epoch 26
Loss = 2.7862e-04, PNorm = 102.1371, GNorm = 0.1583, lr_0 = 1.1839e-04
Validation rmse = 0.810955
Epoch 27
Loss = 1.6422e-04, PNorm = 102.1479, GNorm = 0.1450, lr_0 = 1.1288e-04
Loss = 2.7300e-04, PNorm = 102.1578, GNorm = 0.2667, lr_0 = 1.0810e-04
Validation rmse = 0.800125
Epoch 28
Loss = 1.3757e-04, PNorm = 102.1676, GNorm = 0.1347, lr_0 = 1.0352e-04
Loss = 2.7963e-04, PNorm = 102.1762, GNorm = 0.2498, lr_0 = 1.0000e-04
Validation rmse = 0.799297
Epoch 29
Loss = 1.8909e-04, PNorm = 102.1842, GNorm = 0.1571, lr_0 = 1.0000e-04
Loss = 2.4389e-04, PNorm = 102.1927, GNorm = 0.2092, lr_0 = 1.0000e-04
Validation rmse = 0.806940
Model 0 best validation rmse = 0.777871 on epoch 12
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.917974
Ensemble test rmse = 0.917974
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total scaffolds = 195 | train scaffolds = 80 | val scaffolds = 54 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2404, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,731,201
Moving model to cuda
Epoch 0
Loss = 1.2723e-02, PNorm = 99.7832, GNorm = 6.4547, lr_0 = 3.6053e-04
Validation rmse = 1.066833
Epoch 1
Loss = 3.2044e-03, PNorm = 99.9113, GNorm = 1.3289, lr_0 = 6.2105e-04
Loss = 2.6860e-03, PNorm = 100.0666, GNorm = 0.7806, lr_0 = 8.5789e-04
Validation rmse = 1.075501
Epoch 2
Loss = 1.9116e-03, PNorm = 100.2326, GNorm = 1.1160, lr_0 = 9.8284e-04
Loss = 2.6505e-03, PNorm = 100.3657, GNorm = 3.4231, lr_0 = 9.4120e-04
Validation rmse = 1.088149
Epoch 3
Loss = 2.3050e-03, PNorm = 100.5000, GNorm = 0.6700, lr_0 = 8.9744e-04
Loss = 2.1116e-03, PNorm = 100.6273, GNorm = 0.9894, lr_0 = 8.5943e-04
Validation rmse = 1.262907
Epoch 4
Loss = 2.5156e-03, PNorm = 100.7320, GNorm = 1.9882, lr_0 = 8.2303e-04
Loss = 1.6669e-03, PNorm = 100.8198, GNorm = 0.4586, lr_0 = 7.8816e-04
Validation rmse = 1.068011
Epoch 5
Loss = 1.3842e-03, PNorm = 100.8998, GNorm = 0.4270, lr_0 = 7.5478e-04
Loss = 1.3651e-03, PNorm = 100.9711, GNorm = 0.3373, lr_0 = 7.2281e-04
Validation rmse = 1.040238
Epoch 6
Loss = 1.0073e-03, PNorm = 101.0431, GNorm = 0.3559, lr_0 = 6.8920e-04
Loss = 1.1714e-03, PNorm = 101.0994, GNorm = 0.5445, lr_0 = 6.6001e-04
Validation rmse = 1.005071
Epoch 7
Loss = 1.1413e-03, PNorm = 101.1509, GNorm = 0.5055, lr_0 = 6.3205e-04
Loss = 9.5918e-04, PNorm = 101.1936, GNorm = 0.4360, lr_0 = 6.0528e-04
Validation rmse = 0.925579
Epoch 8
Loss = 1.0575e-03, PNorm = 101.2495, GNorm = 0.5835, lr_0 = 5.7714e-04
Loss = 7.9967e-04, PNorm = 101.2978, GNorm = 0.2467, lr_0 = 5.5269e-04
Validation rmse = 0.964822
Epoch 9
Loss = 8.3067e-04, PNorm = 101.3295, GNorm = 0.3096, lr_0 = 5.2928e-04
Loss = 7.8721e-04, PNorm = 101.3728, GNorm = 0.1872, lr_0 = 5.0686e-04
Validation rmse = 0.933464
Epoch 10
Loss = 7.0965e-04, PNorm = 101.4081, GNorm = 0.2226, lr_0 = 4.8539e-04
Loss = 7.2314e-04, PNorm = 101.4394, GNorm = 0.2386, lr_0 = 4.6483e-04
Validation rmse = 0.929389
Epoch 11
Loss = 6.2099e-04, PNorm = 101.4756, GNorm = 0.3119, lr_0 = 4.4322e-04
Loss = 8.1174e-04, PNorm = 101.5074, GNorm = 0.3762, lr_0 = 4.2444e-04
Validation rmse = 0.902477
Epoch 12
Loss = 5.9030e-04, PNorm = 101.5393, GNorm = 0.5000, lr_0 = 4.0646e-04
Loss = 5.2624e-04, PNorm = 101.5688, GNorm = 0.3788, lr_0 = 3.8925e-04
Validation rmse = 0.913922
Epoch 13
Loss = 6.6128e-04, PNorm = 101.5979, GNorm = 0.5043, lr_0 = 3.7276e-04
Loss = 6.5777e-04, PNorm = 101.6303, GNorm = 0.4189, lr_0 = 3.5697e-04
Validation rmse = 0.895242
Epoch 14
Loss = 5.8342e-04, PNorm = 101.6606, GNorm = 0.2682, lr_0 = 3.4037e-04
Loss = 5.0346e-04, PNorm = 101.6919, GNorm = 0.1617, lr_0 = 3.2596e-04
Validation rmse = 0.953925
Epoch 15
Loss = 5.2147e-04, PNorm = 101.7200, GNorm = 0.2561, lr_0 = 3.1215e-04
Loss = 5.1500e-04, PNorm = 101.7494, GNorm = 0.3187, lr_0 = 2.9893e-04
Validation rmse = 0.914176
Epoch 16
Loss = 4.0930e-04, PNorm = 101.7740, GNorm = 0.1468, lr_0 = 2.8503e-04
Loss = 5.5786e-04, PNorm = 101.7982, GNorm = 0.2789, lr_0 = 2.7295e-04
Validation rmse = 0.919259
Epoch 17
Loss = 4.0328e-04, PNorm = 101.8226, GNorm = 0.1907, lr_0 = 2.6139e-04
Loss = 4.3182e-04, PNorm = 101.8463, GNorm = 0.1897, lr_0 = 2.5032e-04
Validation rmse = 0.911748
Epoch 18
Loss = 3.6796e-04, PNorm = 101.8699, GNorm = 0.2343, lr_0 = 2.3972e-04
Loss = 3.7579e-04, PNorm = 101.8926, GNorm = 0.1741, lr_0 = 2.2956e-04
Validation rmse = 0.927832
Epoch 19
Loss = 4.0055e-04, PNorm = 101.9157, GNorm = 0.2463, lr_0 = 2.1889e-04
Loss = 3.8355e-04, PNorm = 101.9345, GNorm = 0.2408, lr_0 = 2.0962e-04
Validation rmse = 0.913328
Epoch 20
Loss = 3.5581e-04, PNorm = 101.9529, GNorm = 0.4123, lr_0 = 2.0074e-04
Loss = 4.1817e-04, PNorm = 101.9721, GNorm = 0.2650, lr_0 = 1.9224e-04
Validation rmse = 0.929822
Epoch 21
Loss = 3.2103e-04, PNorm = 101.9877, GNorm = 0.2624, lr_0 = 1.8409e-04
Loss = 3.8328e-04, PNorm = 102.0050, GNorm = 0.4115, lr_0 = 1.7630e-04
Validation rmse = 0.907549
Epoch 22
Loss = 3.3041e-04, PNorm = 102.0214, GNorm = 0.5297, lr_0 = 1.6810e-04
Loss = 3.8214e-04, PNorm = 102.0357, GNorm = 0.2327, lr_0 = 1.6098e-04
Validation rmse = 0.901774
Epoch 23
Loss = 2.9658e-04, PNorm = 102.0496, GNorm = 0.3011, lr_0 = 1.5416e-04
Loss = 3.3154e-04, PNorm = 102.0636, GNorm = 0.1910, lr_0 = 1.4763e-04
Loss = 3.8115e-04, PNorm = 102.0652, GNorm = 0.2737, lr_0 = 1.4699e-04
Validation rmse = 0.910382
Epoch 24
Loss = 2.9952e-04, PNorm = 102.0781, GNorm = 0.2687, lr_0 = 1.4077e-04
Loss = 3.0932e-04, PNorm = 102.0901, GNorm = 0.4099, lr_0 = 1.3480e-04
Validation rmse = 0.925872
Epoch 25
Loss = 2.7831e-04, PNorm = 102.1003, GNorm = 0.2767, lr_0 = 1.2909e-04
Loss = 3.1083e-04, PNorm = 102.1106, GNorm = 0.3541, lr_0 = 1.2362e-04
Validation rmse = 0.907605
Epoch 26
Loss = 2.8097e-04, PNorm = 102.1211, GNorm = 0.1654, lr_0 = 1.1839e-04
Validation rmse = 0.901157
Epoch 27
Loss = 5.2127e-04, PNorm = 102.1303, GNorm = 0.2158, lr_0 = 1.1288e-04
Loss = 2.7515e-04, PNorm = 102.1400, GNorm = 0.3850, lr_0 = 1.0810e-04
Validation rmse = 0.908520
Epoch 28
Loss = 1.6114e-04, PNorm = 102.1488, GNorm = 0.2388, lr_0 = 1.0352e-04
Loss = 2.4370e-04, PNorm = 102.1587, GNorm = 0.1872, lr_0 = 1.0000e-04
Validation rmse = 0.913181
Epoch 29
Loss = 3.3056e-04, PNorm = 102.1680, GNorm = 0.1776, lr_0 = 1.0000e-04
Loss = 2.4945e-04, PNorm = 102.1769, GNorm = 0.1501, lr_0 = 1.0000e-04
Validation rmse = 0.920064
Model 0 best validation rmse = 0.895242 on epoch 13
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.688447
Ensemble test rmse = 0.688447
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 49 | test scaffolds = 62
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2404, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,731,201
Moving model to cuda
Epoch 0
Loss = 9.3698e-03, PNorm = 99.7894, GNorm = 6.2016, lr_0 = 3.6053e-04
Validation rmse = 1.170168
Epoch 1
Loss = 4.5469e-03, PNorm = 99.9105, GNorm = 1.7112, lr_0 = 6.2105e-04
Loss = 2.8450e-03, PNorm = 100.0754, GNorm = 1.2450, lr_0 = 8.5789e-04
Validation rmse = 1.088991
Epoch 2
Loss = 2.2737e-03, PNorm = 100.2656, GNorm = 1.2973, lr_0 = 9.8284e-04
Loss = 1.9966e-03, PNorm = 100.4279, GNorm = 0.4910, lr_0 = 9.4120e-04
Validation rmse = 0.893375
Epoch 3
Loss = 1.4848e-03, PNorm = 100.5748, GNorm = 0.4926, lr_0 = 8.9744e-04
Loss = 1.5839e-03, PNorm = 100.6803, GNorm = 0.5879, lr_0 = 8.5943e-04
Validation rmse = 0.866027
Epoch 4
Loss = 1.6516e-03, PNorm = 100.7687, GNorm = 1.6152, lr_0 = 8.2303e-04
Loss = 1.3065e-03, PNorm = 100.8452, GNorm = 0.9202, lr_0 = 7.8816e-04
Validation rmse = 0.815290
Epoch 5
Loss = 9.7082e-04, PNorm = 100.9077, GNorm = 0.4809, lr_0 = 7.5478e-04
Loss = 1.1007e-03, PNorm = 100.9595, GNorm = 0.3273, lr_0 = 7.2281e-04
Validation rmse = 0.777693
Epoch 6
Loss = 1.0663e-03, PNorm = 101.0190, GNorm = 0.4670, lr_0 = 6.8920e-04
Loss = 1.2379e-03, PNorm = 101.0728, GNorm = 0.4172, lr_0 = 6.6001e-04
Validation rmse = 0.776674
Epoch 7
Loss = 7.2753e-04, PNorm = 101.1150, GNorm = 0.4884, lr_0 = 6.3205e-04
Loss = 1.2134e-03, PNorm = 101.1597, GNorm = 0.4929, lr_0 = 6.0528e-04
Validation rmse = 0.832070
Epoch 8
Loss = 1.0836e-03, PNorm = 101.2045, GNorm = 0.5382, lr_0 = 5.7714e-04
Loss = 9.2557e-04, PNorm = 101.2441, GNorm = 0.2903, lr_0 = 5.5269e-04
Validation rmse = 0.773173
Epoch 9
Loss = 7.0057e-04, PNorm = 101.2758, GNorm = 0.7856, lr_0 = 5.2928e-04
Loss = 9.5765e-04, PNorm = 101.3148, GNorm = 0.9437, lr_0 = 5.0686e-04
Validation rmse = 0.761871
Epoch 10
Loss = 8.2033e-04, PNorm = 101.3463, GNorm = 0.7425, lr_0 = 4.8539e-04
Loss = 1.0868e-03, PNorm = 101.3847, GNorm = 0.7090, lr_0 = 4.6483e-04
Validation rmse = 0.785243
Epoch 11
Loss = 1.0194e-03, PNorm = 101.4222, GNorm = 0.3511, lr_0 = 4.4322e-04
Loss = 7.7661e-04, PNorm = 101.4559, GNorm = 0.2418, lr_0 = 4.2444e-04
Validation rmse = 0.797073
Epoch 12
Loss = 4.5007e-04, PNorm = 101.4902, GNorm = 0.2154, lr_0 = 4.0646e-04
Loss = 8.3372e-04, PNorm = 101.5149, GNorm = 0.4713, lr_0 = 3.8925e-04
Validation rmse = 0.750189
Epoch 13
Loss = 6.3569e-04, PNorm = 101.5441, GNorm = 0.2959, lr_0 = 3.7276e-04
Loss = 7.2550e-04, PNorm = 101.5716, GNorm = 0.2683, lr_0 = 3.5697e-04
Validation rmse = 0.838938
Epoch 14
Loss = 5.7849e-04, PNorm = 101.6039, GNorm = 0.2798, lr_0 = 3.4037e-04
Loss = 6.6988e-04, PNorm = 101.6314, GNorm = 0.3376, lr_0 = 3.2596e-04
Validation rmse = 0.718646
Epoch 15
Loss = 5.0039e-04, PNorm = 101.6547, GNorm = 0.2068, lr_0 = 3.1215e-04
Loss = 6.3025e-04, PNorm = 101.6808, GNorm = 0.4821, lr_0 = 2.9893e-04
Validation rmse = 0.726854
Epoch 16
Loss = 4.7866e-04, PNorm = 101.7047, GNorm = 0.4084, lr_0 = 2.8503e-04
Loss = 6.5432e-04, PNorm = 101.7271, GNorm = 0.1661, lr_0 = 2.7295e-04
Validation rmse = 0.725042
Epoch 17
Loss = 4.6779e-04, PNorm = 101.7488, GNorm = 0.1609, lr_0 = 2.6139e-04
Loss = 5.1209e-04, PNorm = 101.7702, GNorm = 0.2388, lr_0 = 2.5032e-04
Validation rmse = 0.739748
Epoch 18
Loss = 5.3488e-04, PNorm = 101.7914, GNorm = 0.2594, lr_0 = 2.3972e-04
Loss = 4.8982e-04, PNorm = 101.8098, GNorm = 0.3964, lr_0 = 2.2956e-04
Validation rmse = 0.731916
Epoch 19
Loss = 4.1543e-04, PNorm = 101.8305, GNorm = 0.1202, lr_0 = 2.1889e-04
Loss = 5.0152e-04, PNorm = 101.8495, GNorm = 0.2782, lr_0 = 2.0962e-04
Validation rmse = 0.717196
Epoch 20
Loss = 4.7899e-04, PNorm = 101.8662, GNorm = 0.3092, lr_0 = 2.0074e-04
Loss = 4.1963e-04, PNorm = 101.8828, GNorm = 0.5456, lr_0 = 1.9224e-04
Validation rmse = 0.746292
Epoch 21
Loss = 3.9609e-04, PNorm = 101.8991, GNorm = 0.1970, lr_0 = 1.8409e-04
Loss = 4.1554e-04, PNorm = 101.9163, GNorm = 0.1971, lr_0 = 1.7630e-04
Validation rmse = 0.730599
Epoch 22
Loss = 3.4901e-04, PNorm = 101.9316, GNorm = 0.2211, lr_0 = 1.6810e-04
Loss = 4.2966e-04, PNorm = 101.9462, GNorm = 0.1003, lr_0 = 1.6098e-04
Validation rmse = 0.742762
Epoch 23
Loss = 3.8354e-04, PNorm = 101.9600, GNorm = 0.2207, lr_0 = 1.5416e-04
Loss = 3.4963e-04, PNorm = 101.9748, GNorm = 0.1022, lr_0 = 1.4763e-04
Loss = 6.7388e-04, PNorm = 101.9761, GNorm = 0.2708, lr_0 = 1.4699e-04
Validation rmse = 0.730712
Epoch 24
Loss = 3.6642e-04, PNorm = 101.9879, GNorm = 0.3113, lr_0 = 1.4077e-04
Loss = 3.6435e-04, PNorm = 102.0005, GNorm = 0.2612, lr_0 = 1.3480e-04
Validation rmse = 0.746205
Epoch 25
Loss = 3.1905e-04, PNorm = 102.0124, GNorm = 0.4695, lr_0 = 1.2909e-04
Loss = 3.7206e-04, PNorm = 102.0241, GNorm = 0.3801, lr_0 = 1.2362e-04
Validation rmse = 0.736871
Epoch 26
Loss = 2.7972e-04, PNorm = 102.0353, GNorm = 0.2589, lr_0 = 1.1839e-04
Validation rmse = 0.736572
Epoch 27
Loss = 2.4238e-04, PNorm = 102.0476, GNorm = 0.2413, lr_0 = 1.1288e-04
Loss = 3.0691e-04, PNorm = 102.0559, GNorm = 0.2099, lr_0 = 1.0810e-04
Validation rmse = 0.713882
Epoch 28
Loss = 3.1198e-04, PNorm = 102.0656, GNorm = 0.2382, lr_0 = 1.0352e-04
Loss = 3.1272e-04, PNorm = 102.0742, GNorm = 0.1359, lr_0 = 1.0000e-04
Validation rmse = 0.726052
Epoch 29
Loss = 2.6695e-04, PNorm = 102.0840, GNorm = 0.1431, lr_0 = 1.0000e-04
Loss = 3.1167e-04, PNorm = 102.0922, GNorm = 0.1409, lr_0 = 1.0000e-04
Validation rmse = 0.728731
Model 0 best validation rmse = 0.713882 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.829408
Ensemble test rmse = 0.829408
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total scaffolds = 195 | train scaffolds = 94 | val scaffolds = 55 | test scaffolds = 46
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2404, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,731,201
Moving model to cuda
Epoch 0
Loss = 1.0530e-02, PNorm = 99.7829, GNorm = 3.8340, lr_0 = 3.6053e-04
Validation rmse = 1.453712
Epoch 1
Loss = 3.7787e-03, PNorm = 99.9131, GNorm = 3.1835, lr_0 = 6.2105e-04
Loss = 3.0201e-03, PNorm = 100.0842, GNorm = 1.1589, lr_0 = 8.5789e-04
Validation rmse = 1.066584
Epoch 2
Loss = 2.1145e-03, PNorm = 100.2921, GNorm = 0.7020, lr_0 = 9.8284e-04
Loss = 1.9370e-03, PNorm = 100.4683, GNorm = 1.0257, lr_0 = 9.4120e-04
Validation rmse = 0.999298
Epoch 3
Loss = 1.7640e-03, PNorm = 100.5996, GNorm = 0.5283, lr_0 = 8.9744e-04
Loss = 1.7219e-03, PNorm = 100.6910, GNorm = 0.8552, lr_0 = 8.5943e-04
Validation rmse = 0.930423
Epoch 4
Loss = 6.7737e-04, PNorm = 100.7610, GNorm = 0.2915, lr_0 = 8.2303e-04
Loss = 1.2160e-03, PNorm = 100.8260, GNorm = 0.5127, lr_0 = 7.8816e-04
Validation rmse = 0.942840
Epoch 5
Loss = 1.3608e-03, PNorm = 100.8869, GNorm = 0.7175, lr_0 = 7.5478e-04
Loss = 1.2040e-03, PNorm = 100.9400, GNorm = 0.8213, lr_0 = 7.2281e-04
Validation rmse = 0.919082
Epoch 6
Loss = 1.6390e-03, PNorm = 100.9874, GNorm = 0.5265, lr_0 = 6.8920e-04
Loss = 1.4854e-03, PNorm = 101.0361, GNorm = 0.4663, lr_0 = 6.6001e-04
Validation rmse = 0.809908
Epoch 7
Loss = 1.1395e-03, PNorm = 101.0885, GNorm = 0.3289, lr_0 = 6.3205e-04
Loss = 1.2163e-03, PNorm = 101.1345, GNorm = 0.2905, lr_0 = 6.0528e-04
Validation rmse = 0.787340
Epoch 8
Loss = 9.3187e-04, PNorm = 101.1761, GNorm = 0.3688, lr_0 = 5.7714e-04
Loss = 1.1828e-03, PNorm = 101.2124, GNorm = 0.4022, lr_0 = 5.5269e-04
Validation rmse = 0.864626
Epoch 9
Loss = 8.8123e-04, PNorm = 101.2477, GNorm = 0.3469, lr_0 = 5.2928e-04
Loss = 1.0025e-03, PNorm = 101.2848, GNorm = 0.3811, lr_0 = 5.0686e-04
Validation rmse = 0.858139
Epoch 10
Loss = 9.1372e-04, PNorm = 101.3145, GNorm = 0.2312, lr_0 = 4.8539e-04
Loss = 8.3005e-04, PNorm = 101.3434, GNorm = 0.4312, lr_0 = 4.6483e-04
Validation rmse = 0.881675
Epoch 11
Loss = 6.1880e-04, PNorm = 101.3765, GNorm = 0.3901, lr_0 = 4.4322e-04
Loss = 7.2349e-04, PNorm = 101.4082, GNorm = 0.2710, lr_0 = 4.2444e-04
Validation rmse = 0.792610
Epoch 12
Loss = 5.5558e-04, PNorm = 101.4370, GNorm = 0.3807, lr_0 = 4.0646e-04
Loss = 7.4530e-04, PNorm = 101.4634, GNorm = 0.4029, lr_0 = 3.8925e-04
Validation rmse = 0.911749
Epoch 13
Loss = 6.6747e-04, PNorm = 101.4890, GNorm = 0.5835, lr_0 = 3.7276e-04
Loss = 8.1943e-04, PNorm = 101.5126, GNorm = 0.7729, lr_0 = 3.5697e-04
Validation rmse = 0.854475
Epoch 14
Loss = 8.4622e-04, PNorm = 101.5437, GNorm = 0.2474, lr_0 = 3.4037e-04
Loss = 5.9224e-04, PNorm = 101.5661, GNorm = 0.3159, lr_0 = 3.2596e-04
Validation rmse = 0.866603
Epoch 15
Loss = 5.9775e-04, PNorm = 101.5898, GNorm = 0.5832, lr_0 = 3.1215e-04
Loss = 6.1425e-04, PNorm = 101.6158, GNorm = 0.3310, lr_0 = 2.9893e-04
Validation rmse = 0.867876
Epoch 16
Loss = 5.4487e-04, PNorm = 101.6405, GNorm = 0.1689, lr_0 = 2.8503e-04
Loss = 6.0349e-04, PNorm = 101.6613, GNorm = 0.2492, lr_0 = 2.7295e-04
Validation rmse = 0.802125
Epoch 17
Loss = 5.0067e-04, PNorm = 101.6798, GNorm = 0.3130, lr_0 = 2.6139e-04
Loss = 5.9537e-04, PNorm = 101.6994, GNorm = 0.4740, lr_0 = 2.5032e-04
Validation rmse = 0.825218
Epoch 18
Loss = 5.2149e-04, PNorm = 101.7160, GNorm = 0.1961, lr_0 = 2.3972e-04
Loss = 4.9393e-04, PNorm = 101.7369, GNorm = 0.2559, lr_0 = 2.2956e-04
Validation rmse = 0.809612
Epoch 19
Loss = 4.6869e-04, PNorm = 101.7567, GNorm = 0.4149, lr_0 = 2.1889e-04
Loss = 5.7845e-04, PNorm = 101.7752, GNorm = 0.2337, lr_0 = 2.0962e-04
Validation rmse = 0.828776
Epoch 20
Loss = 4.1348e-04, PNorm = 101.7957, GNorm = 0.1346, lr_0 = 2.0074e-04
Loss = 5.1609e-04, PNorm = 101.8116, GNorm = 0.4229, lr_0 = 1.9224e-04
Validation rmse = 0.830536
Epoch 21
Loss = 3.6896e-04, PNorm = 101.8250, GNorm = 0.3301, lr_0 = 1.8409e-04
Loss = 4.8080e-04, PNorm = 101.8407, GNorm = 0.1807, lr_0 = 1.7630e-04
Validation rmse = 0.846260
Epoch 22
Loss = 3.7439e-04, PNorm = 101.8571, GNorm = 0.1915, lr_0 = 1.6810e-04
Loss = 4.4655e-04, PNorm = 101.8716, GNorm = 0.2431, lr_0 = 1.6098e-04
Validation rmse = 0.799056
Epoch 23
Loss = 4.2258e-04, PNorm = 101.8829, GNorm = 0.2932, lr_0 = 1.5416e-04
Loss = 3.8590e-04, PNorm = 101.8965, GNorm = 0.3033, lr_0 = 1.4763e-04
Loss = 2.4810e-04, PNorm = 101.8976, GNorm = 0.2280, lr_0 = 1.4699e-04
Validation rmse = 0.829173
Epoch 24
Loss = 3.5238e-04, PNorm = 101.9086, GNorm = 0.2992, lr_0 = 1.4077e-04
Loss = 4.2400e-04, PNorm = 101.9182, GNorm = 0.3077, lr_0 = 1.3480e-04
Validation rmse = 0.821051
Epoch 25
Loss = 3.4397e-04, PNorm = 101.9306, GNorm = 0.2137, lr_0 = 1.2909e-04
Loss = 4.2103e-04, PNorm = 101.9403, GNorm = 0.3687, lr_0 = 1.2362e-04
Validation rmse = 0.837488
Epoch 26
Loss = 3.7671e-04, PNorm = 101.9504, GNorm = 0.2405, lr_0 = 1.1839e-04
Validation rmse = 0.787475
Epoch 27
Loss = 3.7664e-04, PNorm = 101.9623, GNorm = 0.2129, lr_0 = 1.1288e-04
Loss = 3.3265e-04, PNorm = 101.9711, GNorm = 0.2285, lr_0 = 1.0810e-04
Validation rmse = 0.773280
Epoch 28
Loss = 3.3263e-04, PNorm = 101.9805, GNorm = 0.3487, lr_0 = 1.0352e-04
Loss = 3.3760e-04, PNorm = 101.9893, GNorm = 0.3530, lr_0 = 1.0000e-04
Validation rmse = 0.802296
Epoch 29
Loss = 2.8074e-04, PNorm = 101.9978, GNorm = 0.2054, lr_0 = 1.0000e-04
Loss = 3.0068e-04, PNorm = 102.0050, GNorm = 0.1755, lr_0 = 1.0000e-04
Validation rmse = 0.801477
Model 0 best validation rmse = 0.773280 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.859361
Ensemble test rmse = 0.859361
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total scaffolds = 195 | train scaffolds = 64 | val scaffolds = 68 | test scaffolds = 63
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2404, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,731,201
Moving model to cuda
Epoch 0
Loss = 1.3371e-02, PNorm = 99.7838, GNorm = 2.7916, lr_0 = 3.6053e-04
Validation rmse = 1.784212
Epoch 1
Loss = 3.4000e-03, PNorm = 99.9325, GNorm = 1.2462, lr_0 = 6.2105e-04
Loss = 3.2605e-03, PNorm = 100.1271, GNorm = 1.9004, lr_0 = 8.5789e-04
Validation rmse = 1.181982
Epoch 2
Loss = 1.7380e-03, PNorm = 100.3192, GNorm = 0.3361, lr_0 = 9.8284e-04
Loss = 1.8659e-03, PNorm = 100.4685, GNorm = 1.0207, lr_0 = 9.4120e-04
Validation rmse = 1.189403
Epoch 3
Loss = 1.6253e-03, PNorm = 100.5842, GNorm = 1.3514, lr_0 = 8.9744e-04
Loss = 1.4322e-03, PNorm = 100.6605, GNorm = 0.6275, lr_0 = 8.5943e-04
Validation rmse = 0.969551
Epoch 4
Loss = 1.3707e-03, PNorm = 100.7358, GNorm = 0.5622, lr_0 = 8.2303e-04
Loss = 1.3761e-03, PNorm = 100.7949, GNorm = 0.7069, lr_0 = 7.8816e-04
Validation rmse = 0.954970
Epoch 5
Loss = 9.1357e-04, PNorm = 100.8583, GNorm = 0.2863, lr_0 = 7.5478e-04
Loss = 1.1882e-03, PNorm = 100.9079, GNorm = 0.3770, lr_0 = 7.2281e-04
Validation rmse = 1.087079
Epoch 6
Loss = 9.3066e-04, PNorm = 100.9670, GNorm = 0.2244, lr_0 = 6.8920e-04
Loss = 1.1105e-03, PNorm = 101.0220, GNorm = 0.5342, lr_0 = 6.6001e-04
Validation rmse = 1.036311
Epoch 7
Loss = 1.4333e-03, PNorm = 101.0707, GNorm = 0.6248, lr_0 = 6.3205e-04
Loss = 1.1007e-03, PNorm = 101.1267, GNorm = 0.6865, lr_0 = 6.0528e-04
Validation rmse = 0.971411
Epoch 8
Loss = 7.3421e-04, PNorm = 101.1773, GNorm = 0.4347, lr_0 = 5.7714e-04
Loss = 8.5991e-04, PNorm = 101.2185, GNorm = 0.4915, lr_0 = 5.5269e-04
Validation rmse = 0.967815
Epoch 9
Loss = 7.3901e-04, PNorm = 101.2622, GNorm = 0.4834, lr_0 = 5.2928e-04
Loss = 7.7133e-04, PNorm = 101.2999, GNorm = 0.4749, lr_0 = 5.0686e-04
Validation rmse = 1.043242
Epoch 10
Loss = 7.2442e-04, PNorm = 101.3397, GNorm = 0.3343, lr_0 = 4.8539e-04
Loss = 6.0956e-04, PNorm = 101.3780, GNorm = 0.3144, lr_0 = 4.6483e-04
Validation rmse = 1.026276
Epoch 11
Loss = 7.9033e-04, PNorm = 101.4173, GNorm = 0.2915, lr_0 = 4.4322e-04
Loss = 6.2464e-04, PNorm = 101.4527, GNorm = 0.3162, lr_0 = 4.2444e-04
Validation rmse = 1.015540
Epoch 12
Loss = 4.9081e-04, PNorm = 101.4836, GNorm = 0.4216, lr_0 = 4.0646e-04
Loss = 7.5110e-04, PNorm = 101.5157, GNorm = 0.3035, lr_0 = 3.8925e-04
Validation rmse = 0.959420
Epoch 13
Loss = 6.3399e-04, PNorm = 101.5431, GNorm = 0.3034, lr_0 = 3.7276e-04
Loss = 7.7337e-04, PNorm = 101.5772, GNorm = 0.3897, lr_0 = 3.5697e-04
Validation rmse = 1.009844
Epoch 14
Loss = 5.1026e-04, PNorm = 101.6072, GNorm = 0.3362, lr_0 = 3.4037e-04
Loss = 6.1026e-04, PNorm = 101.6346, GNorm = 0.2187, lr_0 = 3.2596e-04
Validation rmse = 0.954257
Epoch 15
Loss = 5.8256e-04, PNorm = 101.6634, GNorm = 0.3893, lr_0 = 3.1215e-04
Loss = 4.5606e-04, PNorm = 101.6909, GNorm = 0.4356, lr_0 = 2.9893e-04
Validation rmse = 1.011113
Epoch 16
Loss = 4.7242e-04, PNorm = 101.7166, GNorm = 0.2049, lr_0 = 2.8503e-04
Loss = 4.9601e-04, PNorm = 101.7413, GNorm = 0.5424, lr_0 = 2.7295e-04
Validation rmse = 0.997740
Epoch 17
Loss = 5.0938e-04, PNorm = 101.7666, GNorm = 0.4014, lr_0 = 2.6139e-04
Loss = 4.8521e-04, PNorm = 101.7883, GNorm = 0.2835, lr_0 = 2.5032e-04
Validation rmse = 0.993196
Epoch 18
Loss = 4.6453e-04, PNorm = 101.8092, GNorm = 0.2394, lr_0 = 2.3972e-04
Loss = 4.8605e-04, PNorm = 101.8307, GNorm = 0.2974, lr_0 = 2.2956e-04
Validation rmse = 1.015282
Epoch 19
Loss = 3.9538e-04, PNorm = 101.8492, GNorm = 0.1645, lr_0 = 2.1889e-04
Loss = 4.2905e-04, PNorm = 101.8673, GNorm = 0.2525, lr_0 = 2.0962e-04
Validation rmse = 0.975320
Epoch 20
Loss = 3.2067e-04, PNorm = 101.8840, GNorm = 0.2860, lr_0 = 2.0074e-04
Loss = 3.6050e-04, PNorm = 101.9015, GNorm = 0.1524, lr_0 = 1.9224e-04
Validation rmse = 1.001485
Epoch 21
Loss = 3.9345e-04, PNorm = 101.9167, GNorm = 0.2629, lr_0 = 1.8409e-04
Loss = 3.2379e-04, PNorm = 101.9316, GNorm = 0.1389, lr_0 = 1.7630e-04
Validation rmse = 1.010458
Epoch 22
Loss = 3.1373e-04, PNorm = 101.9490, GNorm = 0.2211, lr_0 = 1.6810e-04
Loss = 3.1804e-04, PNorm = 101.9596, GNorm = 0.2069, lr_0 = 1.6098e-04
Validation rmse = 1.014371
Epoch 23
Loss = 3.1318e-04, PNorm = 101.9719, GNorm = 0.2217, lr_0 = 1.5416e-04
Loss = 2.9192e-04, PNorm = 101.9834, GNorm = 0.2067, lr_0 = 1.4763e-04
Loss = 7.5653e-04, PNorm = 101.9846, GNorm = 0.3962, lr_0 = 1.4699e-04
Validation rmse = 0.998137
Epoch 24
Loss = 3.0162e-04, PNorm = 101.9983, GNorm = 0.1420, lr_0 = 1.4077e-04
Loss = 2.6579e-04, PNorm = 102.0091, GNorm = 0.1969, lr_0 = 1.3480e-04
Validation rmse = 1.006888
Epoch 25
Loss = 3.0200e-04, PNorm = 102.0188, GNorm = 0.4186, lr_0 = 1.2909e-04
Loss = 2.6144e-04, PNorm = 102.0302, GNorm = 0.3370, lr_0 = 1.2362e-04
Validation rmse = 0.980223
Epoch 26
Loss = 2.3682e-04, PNorm = 102.0401, GNorm = 0.1525, lr_0 = 1.1839e-04
Validation rmse = 0.993847
Epoch 27
Loss = 3.6626e-04, PNorm = 102.0510, GNorm = 0.2862, lr_0 = 1.1288e-04
Loss = 2.5331e-04, PNorm = 102.0607, GNorm = 0.1637, lr_0 = 1.0810e-04
Validation rmse = 0.986805
Epoch 28
Loss = 2.6197e-04, PNorm = 102.0692, GNorm = 0.2134, lr_0 = 1.0352e-04
Loss = 2.3558e-04, PNorm = 102.0767, GNorm = 0.1423, lr_0 = 1.0000e-04
Validation rmse = 0.996964
Epoch 29
Loss = 2.5854e-04, PNorm = 102.0853, GNorm = 0.2238, lr_0 = 1.0000e-04
Loss = 2.2517e-04, PNorm = 102.0937, GNorm = 0.2074, lr_0 = 1.0000e-04
Validation rmse = 1.015291
Model 0 best validation rmse = 0.954257 on epoch 14
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.741424
Ensemble test rmse = 0.741424
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total scaffolds = 195 | train scaffolds = 69 | val scaffolds = 65 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2404, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,731,201
Moving model to cuda
Epoch 0
Loss = 1.1158e-02, PNorm = 99.7868, GNorm = 1.4234, lr_0 = 3.6053e-04
Validation rmse = 2.301457
Epoch 1
Loss = 5.7846e-03, PNorm = 99.9121, GNorm = 2.4217, lr_0 = 6.2105e-04
Loss = 3.4539e-03, PNorm = 100.1040, GNorm = 0.9125, lr_0 = 8.5789e-04
Validation rmse = 1.148955
Epoch 2
Loss = 2.0864e-03, PNorm = 100.3245, GNorm = 1.3794, lr_0 = 9.8284e-04
Loss = 2.4856e-03, PNorm = 100.4986, GNorm = 0.7891, lr_0 = 9.4120e-04
Validation rmse = 1.233335
Epoch 3
Loss = 2.1294e-03, PNorm = 100.6439, GNorm = 0.8605, lr_0 = 8.9744e-04
Loss = 1.6202e-03, PNorm = 100.7351, GNorm = 0.8617, lr_0 = 8.5943e-04
Validation rmse = 1.155238
Epoch 4
Loss = 1.5051e-03, PNorm = 100.8053, GNorm = 0.4228, lr_0 = 8.2303e-04
Loss = 1.3135e-03, PNorm = 100.8604, GNorm = 1.2853, lr_0 = 7.8816e-04
Validation rmse = 1.026997
Epoch 5
Loss = 1.1186e-03, PNorm = 100.9130, GNorm = 0.3199, lr_0 = 7.5478e-04
Loss = 1.4572e-03, PNorm = 100.9722, GNorm = 0.8743, lr_0 = 7.2281e-04
Validation rmse = 1.073047
Epoch 6
Loss = 1.5589e-03, PNorm = 101.0350, GNorm = 0.4230, lr_0 = 6.8920e-04
Loss = 1.0919e-03, PNorm = 101.0957, GNorm = 0.4671, lr_0 = 6.6001e-04
Validation rmse = 1.100317
Epoch 7
Loss = 9.6893e-04, PNorm = 101.1468, GNorm = 0.1888, lr_0 = 6.3205e-04
Loss = 1.0703e-03, PNorm = 101.1961, GNorm = 0.2195, lr_0 = 6.0528e-04
Validation rmse = 1.275625
Epoch 8
Loss = 1.2882e-03, PNorm = 101.2426, GNorm = 0.8310, lr_0 = 5.7714e-04
Loss = 1.1503e-03, PNorm = 101.2867, GNorm = 0.7398, lr_0 = 5.5269e-04
Validation rmse = 1.229936
Epoch 9
Loss = 8.8925e-04, PNorm = 101.3268, GNorm = 0.1682, lr_0 = 5.2928e-04
Loss = 9.4327e-04, PNorm = 101.3622, GNorm = 0.4400, lr_0 = 5.0686e-04
Validation rmse = 1.141249
Epoch 10
Loss = 9.8050e-04, PNorm = 101.3940, GNorm = 0.5145, lr_0 = 4.8539e-04
Loss = 7.0734e-04, PNorm = 101.4327, GNorm = 0.4117, lr_0 = 4.6483e-04
Validation rmse = 1.052227
Epoch 11
Loss = 6.4481e-04, PNorm = 101.4627, GNorm = 0.4183, lr_0 = 4.4322e-04
Loss = 7.3792e-04, PNorm = 101.4941, GNorm = 0.2364, lr_0 = 4.2444e-04
Validation rmse = 1.094931
Epoch 12
Loss = 6.8661e-04, PNorm = 101.5240, GNorm = 0.2108, lr_0 = 4.0646e-04
Loss = 6.1900e-04, PNorm = 101.5531, GNorm = 0.5009, lr_0 = 3.8925e-04
Validation rmse = 1.050327
Epoch 13
Loss = 7.0178e-04, PNorm = 101.5857, GNorm = 0.3333, lr_0 = 3.7276e-04
Loss = 6.5884e-04, PNorm = 101.6185, GNorm = 0.2076, lr_0 = 3.5697e-04
Validation rmse = 1.085286
Epoch 14
Loss = 4.7497e-04, PNorm = 101.6505, GNorm = 0.3496, lr_0 = 3.4037e-04
Loss = 6.1082e-04, PNorm = 101.6744, GNorm = 0.3031, lr_0 = 3.2596e-04
Validation rmse = 1.123158
Epoch 15
Loss = 6.4400e-04, PNorm = 101.7006, GNorm = 0.3215, lr_0 = 3.1215e-04
Loss = 4.9392e-04, PNorm = 101.7224, GNorm = 0.3444, lr_0 = 2.9893e-04
Validation rmse = 1.114826
Epoch 16
Loss = 4.8042e-04, PNorm = 101.7482, GNorm = 0.1491, lr_0 = 2.8503e-04
Loss = 5.4706e-04, PNorm = 101.7717, GNorm = 0.4679, lr_0 = 2.7295e-04
Validation rmse = 1.120276
Epoch 17
Loss = 4.2114e-04, PNorm = 101.7920, GNorm = 0.2389, lr_0 = 2.6139e-04
Loss = 5.8203e-04, PNorm = 101.8118, GNorm = 0.3026, lr_0 = 2.5032e-04
Validation rmse = 1.102576
Epoch 18
Loss = 4.8878e-04, PNorm = 101.8323, GNorm = 0.5291, lr_0 = 2.3972e-04
Loss = 5.1496e-04, PNorm = 101.8529, GNorm = 0.2182, lr_0 = 2.2956e-04
Validation rmse = 1.113572
Epoch 19
Loss = 4.6623e-04, PNorm = 101.8735, GNorm = 0.2836, lr_0 = 2.1889e-04
Loss = 4.2930e-04, PNorm = 101.8916, GNorm = 0.3354, lr_0 = 2.0962e-04
Validation rmse = 1.119764
Epoch 20
Loss = 4.9135e-04, PNorm = 101.9075, GNorm = 0.4571, lr_0 = 2.0074e-04
Loss = 4.2989e-04, PNorm = 101.9231, GNorm = 0.1766, lr_0 = 1.9224e-04
Validation rmse = 1.130849
Epoch 21
Loss = 3.6692e-04, PNorm = 101.9386, GNorm = 0.3227, lr_0 = 1.8409e-04
Loss = 4.7516e-04, PNorm = 101.9524, GNorm = 0.1818, lr_0 = 1.7630e-04
Validation rmse = 1.150901
Epoch 22
Loss = 3.4382e-04, PNorm = 101.9705, GNorm = 0.3009, lr_0 = 1.6810e-04
Loss = 4.2704e-04, PNorm = 101.9823, GNorm = 0.2925, lr_0 = 1.6098e-04
Validation rmse = 1.148622
Epoch 23
Loss = 3.8968e-04, PNorm = 101.9963, GNorm = 0.1872, lr_0 = 1.5416e-04
Loss = 3.2332e-04, PNorm = 102.0083, GNorm = 0.2298, lr_0 = 1.4763e-04
Loss = 4.5370e-04, PNorm = 102.0094, GNorm = 0.4353, lr_0 = 1.4699e-04
Validation rmse = 1.128567
Epoch 24
Loss = 3.3175e-04, PNorm = 102.0197, GNorm = 0.2247, lr_0 = 1.4077e-04
Loss = 3.7247e-04, PNorm = 102.0319, GNorm = 0.5200, lr_0 = 1.3480e-04
Validation rmse = 1.141651
Epoch 25
Loss = 3.0738e-04, PNorm = 102.0412, GNorm = 0.1258, lr_0 = 1.2909e-04
Loss = 4.0441e-04, PNorm = 102.0528, GNorm = 0.3375, lr_0 = 1.2362e-04
Validation rmse = 1.111608
Epoch 26
Loss = 2.9609e-04, PNorm = 102.0632, GNorm = 0.1399, lr_0 = 1.1839e-04
Validation rmse = 1.143411
Epoch 27
Loss = 1.6532e-04, PNorm = 102.0739, GNorm = 0.1884, lr_0 = 1.1288e-04
Loss = 2.9164e-04, PNorm = 102.0830, GNorm = 0.3042, lr_0 = 1.0810e-04
Validation rmse = 1.158580
Epoch 28
Loss = 1.4246e-04, PNorm = 102.0911, GNorm = 0.1154, lr_0 = 1.0352e-04
Loss = 2.9154e-04, PNorm = 102.0989, GNorm = 0.2684, lr_0 = 1.0000e-04
Validation rmse = 1.154369
Epoch 29
Loss = 3.8587e-04, PNorm = 102.1081, GNorm = 0.2082, lr_0 = 1.0000e-04
Loss = 2.5204e-04, PNorm = 102.1150, GNorm = 0.1895, lr_0 = 1.0000e-04
Validation rmse = 1.145154
Model 0 best validation rmse = 1.026997 on epoch 4
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.819596
Ensemble test rmse = 0.819596
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total scaffolds = 195 | train scaffolds = 75 | val scaffolds = 42 | test scaffolds = 78
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2404, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,731,201
Moving model to cuda
Epoch 0
Loss = 1.3280e-02, PNorm = 99.7826, GNorm = 4.8122, lr_0 = 3.6053e-04
Validation rmse = 1.563273
Epoch 1
Loss = 2.1407e-03, PNorm = 99.9345, GNorm = 1.1375, lr_0 = 6.2105e-04
Loss = 3.4215e-03, PNorm = 100.1232, GNorm = 2.2220, lr_0 = 8.5789e-04
Validation rmse = 1.065846
Epoch 2
Loss = 3.6403e-03, PNorm = 100.3175, GNorm = 2.1758, lr_0 = 9.8284e-04
Loss = 2.1813e-03, PNorm = 100.4764, GNorm = 1.2680, lr_0 = 9.4120e-04
Validation rmse = 0.871226
Epoch 3
Loss = 1.3997e-03, PNorm = 100.6079, GNorm = 0.6080, lr_0 = 8.9744e-04
Loss = 1.6282e-03, PNorm = 100.7030, GNorm = 0.7743, lr_0 = 8.5943e-04
Validation rmse = 0.924476
Epoch 4
Loss = 2.0089e-03, PNorm = 100.7884, GNorm = 0.8174, lr_0 = 8.2303e-04
Loss = 1.4785e-03, PNorm = 100.8527, GNorm = 0.3142, lr_0 = 7.8816e-04
Validation rmse = 0.775058
Epoch 5
Loss = 8.4415e-04, PNorm = 100.9106, GNorm = 0.6331, lr_0 = 7.5478e-04
Loss = 1.3143e-03, PNorm = 100.9691, GNorm = 0.4223, lr_0 = 7.2281e-04
Validation rmse = 0.748161
Epoch 6
Loss = 8.1718e-04, PNorm = 101.0179, GNorm = 0.4122, lr_0 = 6.8920e-04
Loss = 1.2470e-03, PNorm = 101.0611, GNorm = 0.2933, lr_0 = 6.6001e-04
Validation rmse = 0.763461
Epoch 7
Loss = 1.0366e-03, PNorm = 101.0991, GNorm = 0.4028, lr_0 = 6.3205e-04
Loss = 1.0471e-03, PNorm = 101.1358, GNorm = 0.6940, lr_0 = 6.0528e-04
Validation rmse = 0.749989
Epoch 8
Loss = 1.2262e-03, PNorm = 101.1827, GNorm = 0.6526, lr_0 = 5.7714e-04
Loss = 8.3841e-04, PNorm = 101.2211, GNorm = 0.3888, lr_0 = 5.5269e-04
Validation rmse = 0.735584
Epoch 9
Loss = 6.6787e-04, PNorm = 101.2562, GNorm = 0.2951, lr_0 = 5.2928e-04
Loss = 7.2960e-04, PNorm = 101.2870, GNorm = 0.2654, lr_0 = 5.0686e-04
Validation rmse = 0.744216
Epoch 10
Loss = 8.4178e-04, PNorm = 101.3194, GNorm = 0.4691, lr_0 = 4.8539e-04
Loss = 8.2623e-04, PNorm = 101.3582, GNorm = 0.3714, lr_0 = 4.6483e-04
Validation rmse = 0.727717
Epoch 11
Loss = 7.4230e-04, PNorm = 101.3936, GNorm = 0.3311, lr_0 = 4.4322e-04
Loss = 6.4966e-04, PNorm = 101.4332, GNorm = 0.1576, lr_0 = 4.2444e-04
Validation rmse = 0.738548
Epoch 12
Loss = 6.1192e-04, PNorm = 101.4677, GNorm = 0.3737, lr_0 = 4.0646e-04
Loss = 5.7183e-04, PNorm = 101.4957, GNorm = 0.2029, lr_0 = 3.8925e-04
Validation rmse = 0.718495
Epoch 13
Loss = 6.9427e-04, PNorm = 101.5234, GNorm = 0.4404, lr_0 = 3.7276e-04
Loss = 6.1482e-04, PNorm = 101.5493, GNorm = 0.3116, lr_0 = 3.5697e-04
Validation rmse = 0.743202
Epoch 14
Loss = 6.5672e-04, PNorm = 101.5828, GNorm = 0.5215, lr_0 = 3.4037e-04
Loss = 5.7182e-04, PNorm = 101.6116, GNorm = 0.2045, lr_0 = 3.2596e-04
Validation rmse = 0.717441
Epoch 15
Loss = 4.8451e-04, PNorm = 101.6384, GNorm = 0.4339, lr_0 = 3.1215e-04
Loss = 5.6374e-04, PNorm = 101.6633, GNorm = 0.2134, lr_0 = 2.9893e-04
Validation rmse = 0.712311
Epoch 16
Loss = 5.2910e-04, PNorm = 101.6908, GNorm = 0.2579, lr_0 = 2.8503e-04
Loss = 5.0208e-04, PNorm = 101.7140, GNorm = 0.4701, lr_0 = 2.7295e-04
Validation rmse = 0.728473
Epoch 17
Loss = 5.1656e-04, PNorm = 101.7313, GNorm = 0.2421, lr_0 = 2.6139e-04
Loss = 5.4168e-04, PNorm = 101.7559, GNorm = 0.1862, lr_0 = 2.5032e-04
Validation rmse = 0.744645
Epoch 18
Loss = 5.6008e-04, PNorm = 101.7766, GNorm = 0.3859, lr_0 = 2.3972e-04
Loss = 4.5828e-04, PNorm = 101.7938, GNorm = 0.1630, lr_0 = 2.2956e-04
Validation rmse = 0.701676
Epoch 19
Loss = 4.0710e-04, PNorm = 101.8135, GNorm = 0.2463, lr_0 = 2.1889e-04
Loss = 4.3965e-04, PNorm = 101.8300, GNorm = 0.2878, lr_0 = 2.0962e-04
Validation rmse = 0.707765
Epoch 20
Loss = 3.5646e-04, PNorm = 101.8471, GNorm = 0.2177, lr_0 = 2.0074e-04
Loss = 4.4120e-04, PNorm = 101.8651, GNorm = 0.1866, lr_0 = 1.9224e-04
Validation rmse = 0.714740
Epoch 21
Loss = 3.8365e-04, PNorm = 101.8842, GNorm = 0.1887, lr_0 = 1.8409e-04
Loss = 3.8031e-04, PNorm = 101.8980, GNorm = 0.2313, lr_0 = 1.7630e-04
Validation rmse = 0.707484
Epoch 22
Loss = 3.2536e-04, PNorm = 101.9131, GNorm = 0.1486, lr_0 = 1.6810e-04
Loss = 3.7950e-04, PNorm = 101.9275, GNorm = 0.1919, lr_0 = 1.6098e-04
Validation rmse = 0.705941
Epoch 23
Loss = 3.3884e-04, PNorm = 101.9404, GNorm = 0.4623, lr_0 = 1.5416e-04
Loss = 3.4516e-04, PNorm = 101.9545, GNorm = 0.1019, lr_0 = 1.4763e-04
Loss = 3.9589e-04, PNorm = 101.9557, GNorm = 0.1538, lr_0 = 1.4699e-04
Validation rmse = 0.704879
Epoch 24
Loss = 3.4460e-04, PNorm = 101.9661, GNorm = 0.2540, lr_0 = 1.4077e-04
Loss = 3.4946e-04, PNorm = 101.9787, GNorm = 0.2473, lr_0 = 1.3480e-04
Validation rmse = 0.704269
Epoch 25
Loss = 3.1895e-04, PNorm = 101.9891, GNorm = 0.2202, lr_0 = 1.2909e-04
Loss = 3.1442e-04, PNorm = 101.9992, GNorm = 0.2243, lr_0 = 1.2362e-04
Validation rmse = 0.701080
Epoch 26
Loss = 3.3446e-04, PNorm = 102.0116, GNorm = 0.2248, lr_0 = 1.1839e-04
Validation rmse = 0.701175
Epoch 27
Loss = 4.3973e-04, PNorm = 102.0214, GNorm = 0.4458, lr_0 = 1.1288e-04
Loss = 2.7234e-04, PNorm = 102.0298, GNorm = 0.2130, lr_0 = 1.0810e-04
Validation rmse = 0.707927
Epoch 28
Loss = 2.5284e-04, PNorm = 102.0383, GNorm = 0.1807, lr_0 = 1.0352e-04
Loss = 2.8854e-04, PNorm = 102.0472, GNorm = 0.1109, lr_0 = 1.0000e-04
Validation rmse = 0.700506
Epoch 29
Loss = 2.7702e-04, PNorm = 102.0562, GNorm = 0.1637, lr_0 = 1.0000e-04
Loss = 2.5077e-04, PNorm = 102.0651, GNorm = 0.4604, lr_0 = 1.0000e-04
Validation rmse = 0.701358
Model 0 best validation rmse = 0.700506 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.873806
Ensemble test rmse = 0.873806
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 58 | test scaffolds = 53
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2404, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,731,201
Moving model to cuda
Epoch 0
Loss = 1.2851e-02, PNorm = 99.7880, GNorm = 1.5558, lr_0 = 3.6053e-04
Validation rmse = 1.153855
Epoch 1
Loss = 2.9534e-03, PNorm = 99.9236, GNorm = 1.1875, lr_0 = 6.2105e-04
Loss = 4.1687e-03, PNorm = 100.1042, GNorm = 1.4676, lr_0 = 8.5789e-04
Validation rmse = 1.140569
Epoch 2
Loss = 1.9332e-03, PNorm = 100.3289, GNorm = 0.8563, lr_0 = 9.8284e-04
Loss = 2.1666e-03, PNorm = 100.5130, GNorm = 0.9754, lr_0 = 9.4120e-04
Validation rmse = 0.996726
Epoch 3
Loss = 2.3704e-03, PNorm = 100.6492, GNorm = 1.2122, lr_0 = 8.9744e-04
Loss = 1.8353e-03, PNorm = 100.7479, GNorm = 0.6293, lr_0 = 8.5943e-04
Validation rmse = 0.698357
Epoch 4
Loss = 1.1742e-03, PNorm = 100.8276, GNorm = 0.2743, lr_0 = 8.2303e-04
Loss = 1.1851e-03, PNorm = 100.8806, GNorm = 0.4120, lr_0 = 7.8816e-04
Validation rmse = 0.720638
Epoch 5
Loss = 1.1040e-03, PNorm = 100.9275, GNorm = 0.6649, lr_0 = 7.5478e-04
Loss = 1.2236e-03, PNorm = 100.9737, GNorm = 0.4621, lr_0 = 7.2281e-04
Validation rmse = 0.714476
Epoch 6
Loss = 1.1218e-03, PNorm = 101.0222, GNorm = 1.0237, lr_0 = 6.8920e-04
Loss = 1.1819e-03, PNorm = 101.0598, GNorm = 0.7433, lr_0 = 6.6001e-04
Validation rmse = 0.685245
Epoch 7
Loss = 1.0998e-03, PNorm = 101.1079, GNorm = 0.5507, lr_0 = 6.3205e-04
Loss = 1.0065e-03, PNorm = 101.1523, GNorm = 0.7182, lr_0 = 6.0528e-04
Validation rmse = 0.729465
Epoch 8
Loss = 7.6055e-04, PNorm = 101.1934, GNorm = 0.2455, lr_0 = 5.7714e-04
Loss = 9.3399e-04, PNorm = 101.2296, GNorm = 0.6161, lr_0 = 5.5269e-04
Validation rmse = 0.713709
Epoch 9
Loss = 7.3132e-04, PNorm = 101.2641, GNorm = 0.3241, lr_0 = 5.2928e-04
Loss = 7.4138e-04, PNorm = 101.2980, GNorm = 0.4676, lr_0 = 5.0686e-04
Validation rmse = 0.709258
Epoch 10
Loss = 5.1663e-04, PNorm = 101.3329, GNorm = 0.3020, lr_0 = 4.8539e-04
Loss = 7.5922e-04, PNorm = 101.3689, GNorm = 0.3339, lr_0 = 4.6483e-04
Validation rmse = 0.670397
Epoch 11
Loss = 8.0473e-04, PNorm = 101.4059, GNorm = 0.4722, lr_0 = 4.4322e-04
Loss = 8.3662e-04, PNorm = 101.4416, GNorm = 0.2500, lr_0 = 4.2444e-04
Validation rmse = 0.676351
Epoch 12
Loss = 7.1018e-04, PNorm = 101.4761, GNorm = 0.2627, lr_0 = 4.0646e-04
Loss = 6.9315e-04, PNorm = 101.5107, GNorm = 0.2328, lr_0 = 3.8925e-04
Validation rmse = 0.693996
Epoch 13
Loss = 6.6363e-04, PNorm = 101.5395, GNorm = 0.5539, lr_0 = 3.7276e-04
Loss = 6.3612e-04, PNorm = 101.5706, GNorm = 0.3194, lr_0 = 3.5697e-04
Validation rmse = 0.721457
Epoch 14
Loss = 5.1947e-04, PNorm = 101.5992, GNorm = 0.5914, lr_0 = 3.4037e-04
Loss = 5.1376e-04, PNorm = 101.6207, GNorm = 0.3366, lr_0 = 3.2596e-04
Validation rmse = 0.670281
Epoch 15
Loss = 4.1870e-04, PNorm = 101.6466, GNorm = 0.3648, lr_0 = 3.1215e-04
Loss = 5.6670e-04, PNorm = 101.6713, GNorm = 0.5920, lr_0 = 2.9893e-04
Validation rmse = 0.693133
Epoch 16
Loss = 5.9221e-04, PNorm = 101.6976, GNorm = 0.6581, lr_0 = 2.8503e-04
Loss = 4.8706e-04, PNorm = 101.7174, GNorm = 0.2902, lr_0 = 2.7295e-04
Validation rmse = 0.708167
Epoch 17
Loss = 5.0091e-04, PNorm = 101.7367, GNorm = 0.3293, lr_0 = 2.6139e-04
Loss = 5.6132e-04, PNorm = 101.7563, GNorm = 0.3597, lr_0 = 2.5032e-04
Validation rmse = 0.697679
Epoch 18
Loss = 3.8229e-04, PNorm = 101.7760, GNorm = 0.1756, lr_0 = 2.3972e-04
Loss = 5.2882e-04, PNorm = 101.7942, GNorm = 0.6077, lr_0 = 2.2956e-04
Validation rmse = 0.670353
Epoch 19
Loss = 4.0364e-04, PNorm = 101.8142, GNorm = 0.2202, lr_0 = 2.1889e-04
Loss = 5.2280e-04, PNorm = 101.8339, GNorm = 0.3253, lr_0 = 2.0962e-04
Validation rmse = 0.669568
Epoch 20
Loss = 4.4919e-04, PNorm = 101.8490, GNorm = 0.3896, lr_0 = 2.0074e-04
Loss = 4.0542e-04, PNorm = 101.8621, GNorm = 0.2918, lr_0 = 1.9224e-04
Validation rmse = 0.687784
Epoch 21
Loss = 3.0115e-04, PNorm = 101.8744, GNorm = 0.1516, lr_0 = 1.8409e-04
Loss = 3.9049e-04, PNorm = 101.8885, GNorm = 0.3526, lr_0 = 1.7630e-04
Validation rmse = 0.668273
Epoch 22
Loss = 4.0558e-04, PNorm = 101.9044, GNorm = 0.3143, lr_0 = 1.6810e-04
Loss = 3.3588e-04, PNorm = 101.9170, GNorm = 0.3446, lr_0 = 1.6098e-04
Validation rmse = 0.673431
Epoch 23
Loss = 3.2367e-04, PNorm = 101.9286, GNorm = 0.2427, lr_0 = 1.5416e-04
Loss = 3.4843e-04, PNorm = 101.9410, GNorm = 0.2024, lr_0 = 1.4763e-04
Loss = 5.5521e-04, PNorm = 101.9422, GNorm = 0.4572, lr_0 = 1.4699e-04
Validation rmse = 0.677984
Epoch 24
Loss = 3.2428e-04, PNorm = 101.9539, GNorm = 0.1408, lr_0 = 1.4077e-04
Loss = 3.3467e-04, PNorm = 101.9643, GNorm = 0.2436, lr_0 = 1.3480e-04
Validation rmse = 0.674496
Epoch 25
Loss = 3.2875e-04, PNorm = 101.9749, GNorm = 0.1536, lr_0 = 1.2909e-04
Loss = 3.0295e-04, PNorm = 101.9836, GNorm = 0.2838, lr_0 = 1.2362e-04
Validation rmse = 0.684018
Epoch 26
Loss = 2.5204e-04, PNorm = 101.9924, GNorm = 0.0958, lr_0 = 1.1839e-04
Validation rmse = 0.680891
Epoch 27
Loss = 2.0505e-04, PNorm = 102.0024, GNorm = 0.2224, lr_0 = 1.1288e-04
Loss = 2.6303e-04, PNorm = 102.0108, GNorm = 0.1413, lr_0 = 1.0810e-04
Validation rmse = 0.675108
Epoch 28
Loss = 1.5773e-04, PNorm = 102.0193, GNorm = 0.1470, lr_0 = 1.0352e-04
Loss = 2.9463e-04, PNorm = 102.0281, GNorm = 0.2401, lr_0 = 1.0000e-04
Validation rmse = 0.683498
Epoch 29
Loss = 3.0798e-04, PNorm = 102.0363, GNorm = 0.2889, lr_0 = 1.0000e-04
Loss = 2.4590e-04, PNorm = 102.0433, GNorm = 0.2498, lr_0 = 1.0000e-04
Validation rmse = 0.695022
Model 0 best validation rmse = 0.668273 on epoch 21
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.084198
Ensemble test rmse = 1.084198
10-fold cross validation
	Seed 0 ==> test rmse = 0.760280
	Seed 1 ==> test rmse = 0.807432
	Seed 2 ==> test rmse = 0.917974
	Seed 3 ==> test rmse = 0.688447
	Seed 4 ==> test rmse = 0.829408
	Seed 5 ==> test rmse = 0.859361
	Seed 6 ==> test rmse = 0.741424
	Seed 7 ==> test rmse = 0.819596
	Seed 8 ==> test rmse = 0.873806
	Seed 9 ==> test rmse = 1.084198
Overall test rmse = 0.838193 +/- 0.103840
Elapsed time = 0:08:32
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total scaffolds = 195 | train scaffolds = 91 | val scaffolds = 66 | test scaffolds = 38
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1804, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,236,601
Moving model to cuda
Epoch 0
Loss = 1.4251e-02, PNorm = 75.8050, GNorm = 7.6143, lr_0 = 3.6053e-04
Validation rmse = 1.111676
Epoch 1
Loss = 3.0200e-03, PNorm = 75.8954, GNorm = 0.7271, lr_0 = 6.2105e-04
Loss = 4.0213e-03, PNorm = 75.9885, GNorm = 0.8355, lr_0 = 8.5789e-04
Validation rmse = 1.067722
Epoch 2
Loss = 6.2501e-03, PNorm = 76.0768, GNorm = 1.8816, lr_0 = 9.8284e-04
Loss = 3.4907e-03, PNorm = 76.1514, GNorm = 1.6271, lr_0 = 9.4120e-04
Validation rmse = 0.907046
Epoch 3
Loss = 1.3423e-03, PNorm = 76.2232, GNorm = 0.5687, lr_0 = 8.9744e-04
Loss = 2.2832e-03, PNorm = 76.2737, GNorm = 0.7679, lr_0 = 8.5943e-04
Validation rmse = 0.990234
Epoch 4
Loss = 3.5653e-03, PNorm = 76.3282, GNorm = 1.1581, lr_0 = 8.2303e-04
Loss = 2.0038e-03, PNorm = 76.3737, GNorm = 2.1692, lr_0 = 7.8816e-04
Validation rmse = 1.060311
Epoch 5
Loss = 1.4822e-03, PNorm = 76.4190, GNorm = 0.4047, lr_0 = 7.5478e-04
Loss = 1.5060e-03, PNorm = 76.4552, GNorm = 0.6758, lr_0 = 7.2281e-04
Validation rmse = 0.784593
Epoch 6
Loss = 1.2721e-03, PNorm = 76.4957, GNorm = 0.3044, lr_0 = 6.8920e-04
Loss = 1.4867e-03, PNorm = 76.5285, GNorm = 0.6587, lr_0 = 6.6001e-04
Validation rmse = 1.016370
Epoch 7
Loss = 1.6277e-03, PNorm = 76.5602, GNorm = 1.0924, lr_0 = 6.3205e-04
Loss = 1.2231e-03, PNorm = 76.5901, GNorm = 0.5449, lr_0 = 6.0528e-04
Validation rmse = 0.950316
Epoch 8
Loss = 1.5905e-03, PNorm = 76.6247, GNorm = 1.2269, lr_0 = 5.7714e-04
Loss = 1.3213e-03, PNorm = 76.6551, GNorm = 0.4605, lr_0 = 5.5269e-04
Validation rmse = 0.819398
Epoch 9
Loss = 1.1796e-03, PNorm = 76.6825, GNorm = 1.3908, lr_0 = 5.2928e-04
Loss = 1.9414e-03, PNorm = 76.7226, GNorm = 1.4121, lr_0 = 5.0686e-04
Validation rmse = 0.802038
Epoch 10
Loss = 1.6196e-03, PNorm = 76.7549, GNorm = 1.8345, lr_0 = 4.8539e-04
Loss = 1.5225e-03, PNorm = 76.7907, GNorm = 0.5356, lr_0 = 4.6483e-04
Validation rmse = 0.806217
Epoch 11
Loss = 1.3515e-03, PNorm = 76.8287, GNorm = 0.2561, lr_0 = 4.4322e-04
Loss = 1.1120e-03, PNorm = 76.8605, GNorm = 0.3431, lr_0 = 4.2444e-04
Validation rmse = 0.866811
Epoch 12
Loss = 1.0868e-03, PNorm = 76.8871, GNorm = 0.3165, lr_0 = 4.0646e-04
Loss = 9.5227e-04, PNorm = 76.9135, GNorm = 0.2235, lr_0 = 3.8925e-04
Validation rmse = 0.866634
Epoch 13
Loss = 7.3315e-04, PNorm = 76.9383, GNorm = 0.2384, lr_0 = 3.7276e-04
Loss = 1.0827e-03, PNorm = 76.9651, GNorm = 0.4130, lr_0 = 3.5697e-04
Validation rmse = 0.953318
Epoch 14
Loss = 1.0636e-03, PNorm = 76.9935, GNorm = 0.3245, lr_0 = 3.4037e-04
Loss = 1.0011e-03, PNorm = 77.0201, GNorm = 0.3817, lr_0 = 3.2596e-04
Validation rmse = 0.874451
Epoch 15
Loss = 7.4342e-04, PNorm = 77.0425, GNorm = 0.3916, lr_0 = 3.1215e-04
Loss = 8.4038e-04, PNorm = 77.0655, GNorm = 0.5783, lr_0 = 2.9893e-04
Validation rmse = 0.888507
Epoch 16
Loss = 7.1915e-04, PNorm = 77.0898, GNorm = 0.2220, lr_0 = 2.8503e-04
Loss = 8.5008e-04, PNorm = 77.1097, GNorm = 0.2459, lr_0 = 2.7295e-04
Validation rmse = 0.850991
Epoch 17
Loss = 6.1001e-04, PNorm = 77.1326, GNorm = 0.2667, lr_0 = 2.6139e-04
Loss = 7.6131e-04, PNorm = 77.1521, GNorm = 0.3832, lr_0 = 2.5032e-04
Validation rmse = 0.910898
Epoch 18
Loss = 7.6709e-04, PNorm = 77.1673, GNorm = 0.4393, lr_0 = 2.3972e-04
Loss = 7.2514e-04, PNorm = 77.1871, GNorm = 0.4755, lr_0 = 2.2956e-04
Validation rmse = 1.010220
Epoch 19
Loss = 7.9646e-04, PNorm = 77.2068, GNorm = 0.3429, lr_0 = 2.1889e-04
Loss = 6.8729e-04, PNorm = 77.2231, GNorm = 0.3922, lr_0 = 2.0962e-04
Validation rmse = 1.031356
Epoch 20
Loss = 7.5562e-04, PNorm = 77.2368, GNorm = 0.4073, lr_0 = 2.0074e-04
Loss = 7.6783e-04, PNorm = 77.2538, GNorm = 0.4234, lr_0 = 1.9224e-04
Validation rmse = 0.919194
Epoch 21
Loss = 7.1847e-04, PNorm = 77.2703, GNorm = 0.2821, lr_0 = 1.8409e-04
Loss = 6.6373e-04, PNorm = 77.2866, GNorm = 0.6381, lr_0 = 1.7630e-04
Validation rmse = 0.900012
Epoch 22
Loss = 5.6682e-04, PNorm = 77.3018, GNorm = 0.3078, lr_0 = 1.6810e-04
Loss = 7.4347e-04, PNorm = 77.3157, GNorm = 0.2802, lr_0 = 1.6098e-04
Validation rmse = 0.856196
Epoch 23
Loss = 5.0827e-04, PNorm = 77.3285, GNorm = 0.3429, lr_0 = 1.5416e-04
Loss = 6.2121e-04, PNorm = 77.3415, GNorm = 0.7041, lr_0 = 1.4763e-04
Loss = 8.7817e-04, PNorm = 77.3429, GNorm = 0.4286, lr_0 = 1.4699e-04
Validation rmse = 0.881635
Epoch 24
Loss = 6.7845e-04, PNorm = 77.3544, GNorm = 0.3069, lr_0 = 1.4077e-04
Loss = 7.0132e-04, PNorm = 77.3660, GNorm = 1.1555, lr_0 = 1.3480e-04
Validation rmse = 0.909212
Epoch 25
Loss = 7.4152e-04, PNorm = 77.3755, GNorm = 0.6670, lr_0 = 1.2909e-04
Loss = 7.2537e-04, PNorm = 77.3880, GNorm = 0.6613, lr_0 = 1.2362e-04
Validation rmse = 0.978027
Epoch 26
Loss = 6.4814e-04, PNorm = 77.3971, GNorm = 0.9606, lr_0 = 1.1839e-04
Validation rmse = 0.892144
Epoch 27
Loss = 3.7574e-04, PNorm = 77.4089, GNorm = 0.3159, lr_0 = 1.1288e-04
Loss = 5.1654e-04, PNorm = 77.4165, GNorm = 0.6161, lr_0 = 1.0810e-04
Validation rmse = 0.847660
Epoch 28
Loss = 8.3961e-04, PNorm = 77.4257, GNorm = 0.4239, lr_0 = 1.0352e-04
Loss = 4.7656e-04, PNorm = 77.4335, GNorm = 0.4042, lr_0 = 1.0000e-04
Validation rmse = 0.834125
Epoch 29
Loss = 3.5115e-04, PNorm = 77.4427, GNorm = 0.4276, lr_0 = 1.0000e-04
Loss = 5.4218e-04, PNorm = 77.4501, GNorm = 0.3874, lr_0 = 1.0000e-04
Validation rmse = 0.881528
Model 0 best validation rmse = 0.784593 on epoch 5
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.884773
Ensemble test rmse = 0.884773
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total scaffolds = 195 | train scaffolds = 76 | val scaffolds = 60 | test scaffolds = 59
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1804, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,236,601
Moving model to cuda
Epoch 0
Loss = 1.4247e-02, PNorm = 75.8070, GNorm = 8.9999, lr_0 = 3.6053e-04
Validation rmse = 1.335666
Epoch 1
Loss = 4.5932e-03, PNorm = 75.8891, GNorm = 2.4953, lr_0 = 6.2105e-04
Loss = 4.0257e-03, PNorm = 75.9773, GNorm = 3.2460, lr_0 = 8.5789e-04
Validation rmse = 1.032892
Epoch 2
Loss = 3.0201e-03, PNorm = 76.0640, GNorm = 2.1906, lr_0 = 9.8284e-04
Loss = 3.1782e-03, PNorm = 76.1346, GNorm = 1.5075, lr_0 = 9.4120e-04
Validation rmse = 1.027967
Epoch 3
Loss = 2.2672e-03, PNorm = 76.1946, GNorm = 3.1459, lr_0 = 8.9744e-04
Loss = 2.2149e-03, PNorm = 76.2481, GNorm = 0.3022, lr_0 = 8.5943e-04
Validation rmse = 1.037891
Epoch 4
Loss = 1.4016e-03, PNorm = 76.2903, GNorm = 0.8077, lr_0 = 8.2303e-04
Loss = 1.6031e-03, PNorm = 76.3324, GNorm = 1.6225, lr_0 = 7.8816e-04
Validation rmse = 0.951547
Epoch 5
Loss = 2.0411e-03, PNorm = 76.3677, GNorm = 0.9170, lr_0 = 7.5478e-04
Loss = 1.4848e-03, PNorm = 76.4048, GNorm = 0.8817, lr_0 = 7.2281e-04
Validation rmse = 0.902726
Epoch 6
Loss = 1.3947e-03, PNorm = 76.4338, GNorm = 0.9604, lr_0 = 6.8920e-04
Loss = 1.5472e-03, PNorm = 76.4677, GNorm = 0.7349, lr_0 = 6.6001e-04
Validation rmse = 0.873980
Epoch 7
Loss = 1.0653e-03, PNorm = 76.4993, GNorm = 0.3443, lr_0 = 6.3205e-04
Loss = 1.8714e-03, PNorm = 76.5277, GNorm = 0.9523, lr_0 = 6.0528e-04
Validation rmse = 0.838030
Epoch 8
Loss = 1.5480e-03, PNorm = 76.5627, GNorm = 0.5717, lr_0 = 5.7714e-04
Loss = 1.3238e-03, PNorm = 76.5982, GNorm = 0.6125, lr_0 = 5.5269e-04
Validation rmse = 0.853202
Epoch 9
Loss = 1.1723e-03, PNorm = 76.6323, GNorm = 0.3174, lr_0 = 5.2928e-04
Loss = 1.2788e-03, PNorm = 76.6596, GNorm = 1.4372, lr_0 = 5.0686e-04
Validation rmse = 0.955365
Epoch 10
Loss = 1.3160e-03, PNorm = 76.6876, GNorm = 1.3853, lr_0 = 4.8539e-04
Loss = 1.0787e-03, PNorm = 76.7157, GNorm = 0.9221, lr_0 = 4.6483e-04
Validation rmse = 0.808159
Epoch 11
Loss = 1.2809e-03, PNorm = 76.7477, GNorm = 1.7267, lr_0 = 4.4322e-04
Loss = 1.0951e-03, PNorm = 76.7703, GNorm = 0.9552, lr_0 = 4.2444e-04
Validation rmse = 0.838644
Epoch 12
Loss = 1.1261e-03, PNorm = 76.7919, GNorm = 0.5298, lr_0 = 4.0646e-04
Loss = 1.0265e-03, PNorm = 76.8132, GNorm = 0.3365, lr_0 = 3.8925e-04
Validation rmse = 0.872653
Epoch 13
Loss = 1.0781e-03, PNorm = 76.8339, GNorm = 0.7877, lr_0 = 3.7276e-04
Loss = 1.0747e-03, PNorm = 76.8570, GNorm = 0.5898, lr_0 = 3.5697e-04
Validation rmse = 0.825375
Epoch 14
Loss = 7.5210e-04, PNorm = 76.8831, GNorm = 0.7688, lr_0 = 3.4037e-04
Loss = 8.0541e-04, PNorm = 76.9060, GNorm = 0.5534, lr_0 = 3.2596e-04
Validation rmse = 0.906488
Epoch 15
Loss = 1.0313e-03, PNorm = 76.9269, GNorm = 0.5639, lr_0 = 3.1215e-04
Loss = 7.3149e-04, PNorm = 76.9478, GNorm = 0.4351, lr_0 = 2.9893e-04
Validation rmse = 0.847608
Epoch 16
Loss = 7.2162e-04, PNorm = 76.9671, GNorm = 0.3655, lr_0 = 2.8503e-04
Loss = 9.2257e-04, PNorm = 76.9864, GNorm = 0.5007, lr_0 = 2.7295e-04
Validation rmse = 0.848532
Epoch 17
Loss = 6.4231e-04, PNorm = 77.0077, GNorm = 0.8632, lr_0 = 2.6139e-04
Loss = 7.9440e-04, PNorm = 77.0239, GNorm = 0.5868, lr_0 = 2.5032e-04
Validation rmse = 0.886377
Epoch 18
Loss = 6.9073e-04, PNorm = 77.0415, GNorm = 0.2257, lr_0 = 2.3972e-04
Loss = 7.3063e-04, PNorm = 77.0557, GNorm = 0.6980, lr_0 = 2.2956e-04
Validation rmse = 0.873846
Epoch 19
Loss = 6.4304e-04, PNorm = 77.0705, GNorm = 0.9247, lr_0 = 2.1889e-04
Loss = 7.7267e-04, PNorm = 77.0843, GNorm = 0.6015, lr_0 = 2.0962e-04
Validation rmse = 0.869329
Epoch 20
Loss = 7.0810e-04, PNorm = 77.1005, GNorm = 0.3307, lr_0 = 2.0074e-04
Loss = 7.8205e-04, PNorm = 77.1121, GNorm = 0.3161, lr_0 = 1.9224e-04
Validation rmse = 0.828690
Epoch 21
Loss = 6.4077e-04, PNorm = 77.1261, GNorm = 0.9359, lr_0 = 1.8409e-04
Loss = 7.2974e-04, PNorm = 77.1376, GNorm = 0.6231, lr_0 = 1.7630e-04
Validation rmse = 0.876395
Epoch 22
Loss = 7.1402e-04, PNorm = 77.1507, GNorm = 0.9603, lr_0 = 1.6810e-04
Loss = 6.2264e-04, PNorm = 77.1614, GNorm = 1.1102, lr_0 = 1.6098e-04
Validation rmse = 0.852628
Epoch 23
Loss = 8.0640e-04, PNorm = 77.1721, GNorm = 0.4534, lr_0 = 1.5416e-04
Loss = 6.1554e-04, PNorm = 77.1827, GNorm = 0.3521, lr_0 = 1.4763e-04
Loss = 8.8063e-04, PNorm = 77.1839, GNorm = 0.7477, lr_0 = 1.4699e-04
Validation rmse = 0.919161
Epoch 24
Loss = 6.6448e-04, PNorm = 77.1953, GNorm = 0.3191, lr_0 = 1.4077e-04
Loss = 6.2992e-04, PNorm = 77.2063, GNorm = 0.4494, lr_0 = 1.3480e-04
Validation rmse = 0.905080
Epoch 25
Loss = 4.8503e-04, PNorm = 77.2138, GNorm = 0.3888, lr_0 = 1.2909e-04
Loss = 6.3848e-04, PNorm = 77.2241, GNorm = 0.6579, lr_0 = 1.2362e-04
Validation rmse = 0.884716
Epoch 26
Loss = 6.5946e-04, PNorm = 77.2336, GNorm = 0.6302, lr_0 = 1.1839e-04
Validation rmse = 0.883820
Epoch 27
Loss = 5.1006e-04, PNorm = 77.2413, GNorm = 0.6487, lr_0 = 1.1288e-04
Loss = 4.6456e-04, PNorm = 77.2490, GNorm = 0.4351, lr_0 = 1.0810e-04
Validation rmse = 0.890575
Epoch 28
Loss = 5.3786e-04, PNorm = 77.2540, GNorm = 0.8384, lr_0 = 1.0352e-04
Loss = 5.3708e-04, PNorm = 77.2615, GNorm = 0.2877, lr_0 = 1.0000e-04
Validation rmse = 0.895269
Epoch 29
Loss = 5.1802e-04, PNorm = 77.2677, GNorm = 0.2756, lr_0 = 1.0000e-04
Loss = 4.5339e-04, PNorm = 77.2743, GNorm = 0.3855, lr_0 = 1.0000e-04
Validation rmse = 0.856238
Model 0 best validation rmse = 0.808159 on epoch 10
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.886879
Ensemble test rmse = 0.886879
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total scaffolds = 195 | train scaffolds = 55 | val scaffolds = 64 | test scaffolds = 76
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1804, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,236,601
Moving model to cuda
Epoch 0
Loss = 1.2645e-02, PNorm = 75.8059, GNorm = 5.0299, lr_0 = 3.6053e-04
Validation rmse = 1.546812
Epoch 1
Loss = 6.7444e-03, PNorm = 75.8890, GNorm = 3.7488, lr_0 = 6.2105e-04
Loss = 5.7661e-03, PNorm = 75.9880, GNorm = 3.3641, lr_0 = 8.5789e-04
Validation rmse = 1.160017
Epoch 2
Loss = 4.1228e-03, PNorm = 76.0921, GNorm = 0.8759, lr_0 = 9.8284e-04
Loss = 2.4263e-03, PNorm = 76.1696, GNorm = 0.9479, lr_0 = 9.4120e-04
Validation rmse = 1.036220
Epoch 3
Loss = 2.2834e-03, PNorm = 76.2358, GNorm = 0.4158, lr_0 = 8.9744e-04
Loss = 2.6027e-03, PNorm = 76.2942, GNorm = 0.8374, lr_0 = 8.5943e-04
Validation rmse = 1.020789
Epoch 4
Loss = 1.5245e-03, PNorm = 76.3511, GNorm = 0.5711, lr_0 = 8.2303e-04
Loss = 2.2207e-03, PNorm = 76.3952, GNorm = 1.5791, lr_0 = 7.8816e-04
Validation rmse = 1.005991
Epoch 5
Loss = 1.6044e-03, PNorm = 76.4382, GNorm = 0.5531, lr_0 = 7.5478e-04
Loss = 1.7290e-03, PNorm = 76.4800, GNorm = 1.0545, lr_0 = 7.2281e-04
Validation rmse = 0.925141
Epoch 6
Loss = 1.4201e-03, PNorm = 76.5372, GNorm = 0.7807, lr_0 = 6.8920e-04
Loss = 1.8235e-03, PNorm = 76.5764, GNorm = 0.8623, lr_0 = 6.6001e-04
Validation rmse = 1.007864
Epoch 7
Loss = 2.0741e-03, PNorm = 76.6112, GNorm = 0.8795, lr_0 = 6.3205e-04
Loss = 1.3467e-03, PNorm = 76.6466, GNorm = 0.5780, lr_0 = 6.0528e-04
Validation rmse = 0.853896
Epoch 8
Loss = 1.6729e-03, PNorm = 76.6894, GNorm = 0.3792, lr_0 = 5.7714e-04
Loss = 1.3237e-03, PNorm = 76.7262, GNorm = 0.4163, lr_0 = 5.5269e-04
Validation rmse = 0.838173
Epoch 9
Loss = 1.4020e-03, PNorm = 76.7578, GNorm = 0.6477, lr_0 = 5.2928e-04
Loss = 1.1999e-03, PNorm = 76.7923, GNorm = 0.7962, lr_0 = 5.0686e-04
Validation rmse = 0.835780
Epoch 10
Loss = 1.4272e-03, PNorm = 76.8236, GNorm = 0.6938, lr_0 = 4.8539e-04
Loss = 1.2282e-03, PNorm = 76.8575, GNorm = 0.5425, lr_0 = 4.6483e-04
Validation rmse = 0.878752
Epoch 11
Loss = 1.3162e-03, PNorm = 76.8941, GNorm = 0.7780, lr_0 = 4.4322e-04
Loss = 1.1428e-03, PNorm = 76.9281, GNorm = 0.6425, lr_0 = 4.2444e-04
Validation rmse = 0.858983
Epoch 12
Loss = 8.8542e-04, PNorm = 76.9564, GNorm = 0.5465, lr_0 = 4.0646e-04
Loss = 1.2111e-03, PNorm = 76.9818, GNorm = 0.5950, lr_0 = 3.8925e-04
Validation rmse = 0.891372
Epoch 13
Loss = 1.2266e-03, PNorm = 77.0112, GNorm = 0.6496, lr_0 = 3.7276e-04
Loss = 8.8576e-04, PNorm = 77.0364, GNorm = 0.3626, lr_0 = 3.5697e-04
Validation rmse = 0.881419
Epoch 14
Loss = 1.0100e-03, PNorm = 77.0651, GNorm = 0.4621, lr_0 = 3.4037e-04
Loss = 9.4069e-04, PNorm = 77.0884, GNorm = 0.4776, lr_0 = 3.2596e-04
Validation rmse = 0.892563
Epoch 15
Loss = 1.0481e-03, PNorm = 77.1042, GNorm = 0.7785, lr_0 = 3.1215e-04
Loss = 9.5765e-04, PNorm = 77.1267, GNorm = 0.4946, lr_0 = 2.9893e-04
Validation rmse = 0.917702
Epoch 16
Loss = 8.5632e-04, PNorm = 77.1546, GNorm = 0.3304, lr_0 = 2.8503e-04
Loss = 8.8792e-04, PNorm = 77.1761, GNorm = 0.6256, lr_0 = 2.7295e-04
Validation rmse = 0.820374
Epoch 17
Loss = 1.1387e-03, PNorm = 77.1957, GNorm = 1.1063, lr_0 = 2.6139e-04
Loss = 8.6879e-04, PNorm = 77.2161, GNorm = 0.7403, lr_0 = 2.5032e-04
Validation rmse = 1.021063
Epoch 18
Loss = 6.9471e-04, PNorm = 77.2383, GNorm = 0.5441, lr_0 = 2.3972e-04
Loss = 8.8216e-04, PNorm = 77.2595, GNorm = 0.3843, lr_0 = 2.2956e-04
Validation rmse = 0.930172
Epoch 19
Loss = 8.3689e-04, PNorm = 77.2808, GNorm = 0.5654, lr_0 = 2.1889e-04
Loss = 8.9319e-04, PNorm = 77.2998, GNorm = 0.6000, lr_0 = 2.0962e-04
Validation rmse = 0.857111
Epoch 20
Loss = 7.1958e-04, PNorm = 77.3108, GNorm = 0.7394, lr_0 = 2.0074e-04
Loss = 6.8494e-04, PNorm = 77.3235, GNorm = 0.3994, lr_0 = 1.9224e-04
Validation rmse = 0.907442
Epoch 21
Loss = 6.7037e-04, PNorm = 77.3373, GNorm = 0.3597, lr_0 = 1.8409e-04
Loss = 6.9035e-04, PNorm = 77.3520, GNorm = 0.3311, lr_0 = 1.7630e-04
Validation rmse = 0.943377
Epoch 22
Loss = 7.9830e-04, PNorm = 77.3674, GNorm = 0.7899, lr_0 = 1.6810e-04
Loss = 6.1390e-04, PNorm = 77.3826, GNorm = 0.3652, lr_0 = 1.6098e-04
Validation rmse = 0.905498
Epoch 23
Loss = 5.4435e-04, PNorm = 77.3924, GNorm = 0.4825, lr_0 = 1.5416e-04
Loss = 6.9179e-04, PNorm = 77.4039, GNorm = 0.4813, lr_0 = 1.4763e-04
Loss = 1.3160e-03, PNorm = 77.4046, GNorm = 0.5826, lr_0 = 1.4699e-04
Validation rmse = 0.961390
Epoch 24
Loss = 6.5441e-04, PNorm = 77.4166, GNorm = 1.0424, lr_0 = 1.4077e-04
Loss = 6.4896e-04, PNorm = 77.4292, GNorm = 0.6261, lr_0 = 1.3480e-04
Validation rmse = 0.980658
Epoch 25
Loss = 6.7893e-04, PNorm = 77.4402, GNorm = 0.4180, lr_0 = 1.2909e-04
Loss = 5.8097e-04, PNorm = 77.4498, GNorm = 0.5166, lr_0 = 1.2362e-04
Validation rmse = 0.979366
Epoch 26
Loss = 5.6188e-04, PNorm = 77.4587, GNorm = 0.4820, lr_0 = 1.1839e-04
Validation rmse = 1.004466
Epoch 27
Loss = 7.4341e-04, PNorm = 77.4675, GNorm = 0.4912, lr_0 = 1.1288e-04
Loss = 5.5867e-04, PNorm = 77.4777, GNorm = 0.4055, lr_0 = 1.0810e-04
Validation rmse = 0.962536
Epoch 28
Loss = 6.3819e-04, PNorm = 77.4863, GNorm = 0.3612, lr_0 = 1.0352e-04
Loss = 4.4031e-04, PNorm = 77.4954, GNorm = 0.3865, lr_0 = 1.0000e-04
Validation rmse = 0.995165
Epoch 29
Loss = 4.2653e-04, PNorm = 77.5042, GNorm = 0.2317, lr_0 = 1.0000e-04
Loss = 4.4812e-04, PNorm = 77.5107, GNorm = 0.3200, lr_0 = 1.0000e-04
Validation rmse = 0.974337
Model 0 best validation rmse = 0.820374 on epoch 16
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.873391
Ensemble test rmse = 0.873391
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total scaffolds = 195 | train scaffolds = 80 | val scaffolds = 54 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1804, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,236,601
Moving model to cuda
Epoch 0
Loss = 1.1801e-02, PNorm = 75.8065, GNorm = 12.7800, lr_0 = 3.6053e-04
Validation rmse = 1.210997
Epoch 1
Loss = 4.5886e-03, PNorm = 75.8915, GNorm = 1.6619, lr_0 = 6.2105e-04
Loss = 3.4737e-03, PNorm = 75.9886, GNorm = 1.8722, lr_0 = 8.5789e-04
Validation rmse = 1.126869
Epoch 2
Loss = 3.3966e-03, PNorm = 76.0843, GNorm = 1.0153, lr_0 = 9.8284e-04
Loss = 2.5035e-03, PNorm = 76.1627, GNorm = 1.1599, lr_0 = 9.4120e-04
Validation rmse = 1.135637
Epoch 3
Loss = 1.8284e-03, PNorm = 76.2353, GNorm = 0.4348, lr_0 = 8.9744e-04
Loss = 2.0585e-03, PNorm = 76.2861, GNorm = 1.9758, lr_0 = 8.5943e-04
Validation rmse = 1.043250
Epoch 4
Loss = 2.5772e-03, PNorm = 76.3347, GNorm = 1.8581, lr_0 = 8.2303e-04
Loss = 2.0149e-03, PNorm = 76.3880, GNorm = 1.7423, lr_0 = 7.8816e-04
Validation rmse = 1.089868
Epoch 5
Loss = 1.7547e-03, PNorm = 76.4404, GNorm = 2.0080, lr_0 = 7.5478e-04
Loss = 2.1726e-03, PNorm = 76.4820, GNorm = 0.4747, lr_0 = 7.2281e-04
Validation rmse = 1.053001
Epoch 6
Loss = 1.8518e-03, PNorm = 76.5359, GNorm = 0.4539, lr_0 = 6.8920e-04
Loss = 1.7561e-03, PNorm = 76.5749, GNorm = 0.5264, lr_0 = 6.6001e-04
Validation rmse = 0.944046
Epoch 7
Loss = 1.1585e-03, PNorm = 76.6027, GNorm = 0.8644, lr_0 = 6.3205e-04
Loss = 1.1314e-03, PNorm = 76.6357, GNorm = 1.0998, lr_0 = 6.0528e-04
Validation rmse = 0.961226
Epoch 8
Loss = 1.4255e-03, PNorm = 76.6689, GNorm = 0.5887, lr_0 = 5.7714e-04
Loss = 1.2195e-03, PNorm = 76.7023, GNorm = 1.0954, lr_0 = 5.5269e-04
Validation rmse = 0.969169
Epoch 9
Loss = 1.1176e-03, PNorm = 76.7340, GNorm = 0.8322, lr_0 = 5.2928e-04
Loss = 1.2479e-03, PNorm = 76.7651, GNorm = 0.4754, lr_0 = 5.0686e-04
Validation rmse = 0.965488
Epoch 10
Loss = 1.2334e-03, PNorm = 76.7881, GNorm = 1.1356, lr_0 = 4.8539e-04
Loss = 1.1093e-03, PNorm = 76.8105, GNorm = 0.3668, lr_0 = 4.6483e-04
Validation rmse = 0.991025
Epoch 11
Loss = 8.7388e-04, PNorm = 76.8339, GNorm = 0.2441, lr_0 = 4.4322e-04
Loss = 1.0707e-03, PNorm = 76.8567, GNorm = 0.3214, lr_0 = 4.2444e-04
Validation rmse = 0.971859
Epoch 12
Loss = 1.0712e-03, PNorm = 76.8804, GNorm = 0.8610, lr_0 = 4.0646e-04
Loss = 9.7815e-04, PNorm = 76.9002, GNorm = 0.7760, lr_0 = 3.8925e-04
Validation rmse = 1.076007
Epoch 13
Loss = 1.1841e-03, PNorm = 76.9255, GNorm = 1.0571, lr_0 = 3.7276e-04
Loss = 9.3576e-04, PNorm = 76.9486, GNorm = 0.4953, lr_0 = 3.5697e-04
Validation rmse = 0.953820
Epoch 14
Loss = 6.6507e-04, PNorm = 76.9712, GNorm = 1.1848, lr_0 = 3.4037e-04
Loss = 9.7330e-04, PNorm = 76.9924, GNorm = 0.4007, lr_0 = 3.2596e-04
Validation rmse = 0.988484
Epoch 15
Loss = 7.3023e-04, PNorm = 77.0134, GNorm = 0.8693, lr_0 = 3.1215e-04
Loss = 9.2418e-04, PNorm = 77.0331, GNorm = 0.2296, lr_0 = 2.9893e-04
Validation rmse = 0.995796
Epoch 16
Loss = 8.1081e-04, PNorm = 77.0542, GNorm = 0.8746, lr_0 = 2.8503e-04
Loss = 7.9016e-04, PNorm = 77.0749, GNorm = 0.7292, lr_0 = 2.7295e-04
Validation rmse = 0.950303
Epoch 17
Loss = 7.7163e-04, PNorm = 77.0940, GNorm = 0.3876, lr_0 = 2.6139e-04
Loss = 8.2766e-04, PNorm = 77.1143, GNorm = 0.3646, lr_0 = 2.5032e-04
Validation rmse = 0.982680
Epoch 18
Loss = 7.5364e-04, PNorm = 77.1332, GNorm = 0.4944, lr_0 = 2.3972e-04
Loss = 7.3351e-04, PNorm = 77.1502, GNorm = 0.6050, lr_0 = 2.2956e-04
Validation rmse = 0.974699
Epoch 19
Loss = 7.3997e-04, PNorm = 77.1679, GNorm = 0.2491, lr_0 = 2.1889e-04
Loss = 7.1210e-04, PNorm = 77.1798, GNorm = 0.6906, lr_0 = 2.0962e-04
Validation rmse = 0.979467
Epoch 20
Loss = 6.6196e-04, PNorm = 77.1930, GNorm = 1.0353, lr_0 = 2.0074e-04
Loss = 8.0930e-04, PNorm = 77.2082, GNorm = 0.5148, lr_0 = 1.9224e-04
Validation rmse = 1.004635
Epoch 21
Loss = 6.9097e-04, PNorm = 77.2247, GNorm = 0.3636, lr_0 = 1.8409e-04
Loss = 7.3090e-04, PNorm = 77.2364, GNorm = 0.7285, lr_0 = 1.7630e-04
Validation rmse = 1.017139
Epoch 22
Loss = 7.6745e-04, PNorm = 77.2549, GNorm = 0.3880, lr_0 = 1.6810e-04
Loss = 5.3842e-04, PNorm = 77.2673, GNorm = 0.1872, lr_0 = 1.6098e-04
Validation rmse = 0.992688
Epoch 23
Loss = 5.4542e-04, PNorm = 77.2786, GNorm = 0.7480, lr_0 = 1.5416e-04
Loss = 5.1995e-04, PNorm = 77.2881, GNorm = 0.4508, lr_0 = 1.4763e-04
Loss = 6.8958e-04, PNorm = 77.2892, GNorm = 0.3727, lr_0 = 1.4699e-04
Validation rmse = 0.996277
Epoch 24
Loss = 6.0221e-04, PNorm = 77.2985, GNorm = 0.2267, lr_0 = 1.4077e-04
Loss = 6.1219e-04, PNorm = 77.3094, GNorm = 0.5241, lr_0 = 1.3480e-04
Validation rmse = 1.034677
Epoch 25
Loss = 5.5964e-04, PNorm = 77.3183, GNorm = 0.1471, lr_0 = 1.2909e-04
Loss = 6.5233e-04, PNorm = 77.3276, GNorm = 1.0433, lr_0 = 1.2362e-04
Validation rmse = 0.978328
Epoch 26
Loss = 6.4923e-04, PNorm = 77.3384, GNorm = 0.3709, lr_0 = 1.1839e-04
Validation rmse = 1.004350
Epoch 27
Loss = 9.8799e-04, PNorm = 77.3477, GNorm = 0.2451, lr_0 = 1.1288e-04
Loss = 4.5067e-04, PNorm = 77.3551, GNorm = 0.4248, lr_0 = 1.0810e-04
Validation rmse = 1.031683
Epoch 28
Loss = 5.0630e-04, PNorm = 77.3599, GNorm = 0.3506, lr_0 = 1.0352e-04
Loss = 4.8649e-04, PNorm = 77.3694, GNorm = 0.3768, lr_0 = 1.0000e-04
Validation rmse = 1.008254
Epoch 29
Loss = 4.8286e-04, PNorm = 77.3779, GNorm = 0.2351, lr_0 = 1.0000e-04
Loss = 4.8833e-04, PNorm = 77.3852, GNorm = 0.5099, lr_0 = 1.0000e-04
Validation rmse = 1.006963
Model 0 best validation rmse = 0.944046 on epoch 6
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.811292
Ensemble test rmse = 0.811292
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 49 | test scaffolds = 62
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1804, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,236,601
Moving model to cuda
Epoch 0
Loss = 1.4263e-02, PNorm = 75.8065, GNorm = 8.6593, lr_0 = 3.6053e-04
Validation rmse = 1.409404
Epoch 1
Loss = 5.2972e-03, PNorm = 75.9002, GNorm = 3.8561, lr_0 = 6.2105e-04
Loss = 4.3345e-03, PNorm = 75.9945, GNorm = 2.2156, lr_0 = 8.5789e-04
Validation rmse = 1.004562
Epoch 2
Loss = 3.0076e-03, PNorm = 76.0869, GNorm = 2.2231, lr_0 = 9.8284e-04
Loss = 2.4725e-03, PNorm = 76.1569, GNorm = 0.8278, lr_0 = 9.4120e-04
Validation rmse = 1.047873
Epoch 3
Loss = 2.4477e-03, PNorm = 76.2210, GNorm = 0.5703, lr_0 = 8.9744e-04
Loss = 2.1058e-03, PNorm = 76.2723, GNorm = 0.7811, lr_0 = 8.5943e-04
Validation rmse = 0.887563
Epoch 4
Loss = 3.2195e-03, PNorm = 76.3248, GNorm = 1.5659, lr_0 = 8.2303e-04
Loss = 1.5825e-03, PNorm = 76.3673, GNorm = 0.5331, lr_0 = 7.8816e-04
Validation rmse = 0.837514
Epoch 5
Loss = 1.4307e-03, PNorm = 76.4043, GNorm = 0.5150, lr_0 = 7.5478e-04
Loss = 1.5237e-03, PNorm = 76.4395, GNorm = 0.6591, lr_0 = 7.2281e-04
Validation rmse = 0.852047
Epoch 6
Loss = 1.3176e-03, PNorm = 76.4755, GNorm = 0.3778, lr_0 = 6.8920e-04
Loss = 1.6265e-03, PNorm = 76.5075, GNorm = 0.6778, lr_0 = 6.6001e-04
Validation rmse = 0.852304
Epoch 7
Loss = 1.2503e-03, PNorm = 76.5406, GNorm = 0.7735, lr_0 = 6.3205e-04
Loss = 1.6545e-03, PNorm = 76.5758, GNorm = 0.9065, lr_0 = 6.0528e-04
Validation rmse = 0.861731
Epoch 8
Loss = 1.6585e-03, PNorm = 76.6108, GNorm = 1.2376, lr_0 = 5.7714e-04
Loss = 1.2565e-03, PNorm = 76.6390, GNorm = 0.5988, lr_0 = 5.5269e-04
Validation rmse = 0.785483
Epoch 9
Loss = 1.0621e-03, PNorm = 76.6674, GNorm = 1.2841, lr_0 = 5.2928e-04
Loss = 1.3968e-03, PNorm = 76.6995, GNorm = 0.6771, lr_0 = 5.0686e-04
Validation rmse = 0.756536
Epoch 10
Loss = 1.1457e-03, PNorm = 76.7249, GNorm = 1.2585, lr_0 = 4.8539e-04
Loss = 1.5290e-03, PNorm = 76.7520, GNorm = 0.5437, lr_0 = 4.6483e-04
Validation rmse = 0.776575
Epoch 11
Loss = 1.3593e-03, PNorm = 76.7867, GNorm = 1.0680, lr_0 = 4.4322e-04
Loss = 1.1480e-03, PNorm = 76.8141, GNorm = 0.2280, lr_0 = 4.2444e-04
Validation rmse = 0.745884
Epoch 12
Loss = 6.1797e-04, PNorm = 76.8357, GNorm = 0.6267, lr_0 = 4.0646e-04
Loss = 1.2285e-03, PNorm = 76.8583, GNorm = 0.4929, lr_0 = 3.8925e-04
Validation rmse = 0.759316
Epoch 13
Loss = 1.0044e-03, PNorm = 76.8843, GNorm = 0.6403, lr_0 = 3.7276e-04
Loss = 1.1877e-03, PNorm = 76.9112, GNorm = 0.5133, lr_0 = 3.5697e-04
Validation rmse = 0.805691
Epoch 14
Loss = 9.3554e-04, PNorm = 76.9353, GNorm = 0.2670, lr_0 = 3.4037e-04
Loss = 8.4845e-04, PNorm = 76.9595, GNorm = 0.3303, lr_0 = 3.2596e-04
Validation rmse = 0.720046
Epoch 15
Loss = 8.6082e-04, PNorm = 76.9789, GNorm = 0.4597, lr_0 = 3.1215e-04
Loss = 9.2410e-04, PNorm = 77.0048, GNorm = 0.6407, lr_0 = 2.9893e-04
Validation rmse = 0.717224
Epoch 16
Loss = 9.9021e-04, PNorm = 77.0283, GNorm = 1.0598, lr_0 = 2.8503e-04
Loss = 1.0895e-03, PNorm = 77.0523, GNorm = 0.2702, lr_0 = 2.7295e-04
Validation rmse = 0.715281
Epoch 17
Loss = 8.0444e-04, PNorm = 77.0711, GNorm = 0.1872, lr_0 = 2.6139e-04
Loss = 8.5459e-04, PNorm = 77.0905, GNorm = 0.4081, lr_0 = 2.5032e-04
Validation rmse = 0.708198
Epoch 18
Loss = 9.0583e-04, PNorm = 77.1094, GNorm = 0.3824, lr_0 = 2.3972e-04
Loss = 8.5237e-04, PNorm = 77.1275, GNorm = 0.3033, lr_0 = 2.2956e-04
Validation rmse = 0.750851
Epoch 19
Loss = 6.1737e-04, PNorm = 77.1446, GNorm = 0.2837, lr_0 = 2.1889e-04
Loss = 8.6651e-04, PNorm = 77.1591, GNorm = 0.7166, lr_0 = 2.0962e-04
Validation rmse = 0.687546
Epoch 20
Loss = 6.7609e-04, PNorm = 77.1740, GNorm = 0.4719, lr_0 = 2.0074e-04
Loss = 7.4139e-04, PNorm = 77.1895, GNorm = 1.4482, lr_0 = 1.9224e-04
Validation rmse = 0.785423
Epoch 21
Loss = 6.5851e-04, PNorm = 77.2045, GNorm = 0.2968, lr_0 = 1.8409e-04
Loss = 7.1406e-04, PNorm = 77.2180, GNorm = 0.4568, lr_0 = 1.7630e-04
Validation rmse = 0.718719
Epoch 22
Loss = 5.8027e-04, PNorm = 77.2320, GNorm = 0.3359, lr_0 = 1.6810e-04
Loss = 6.6835e-04, PNorm = 77.2451, GNorm = 0.3170, lr_0 = 1.6098e-04
Validation rmse = 0.717566
Epoch 23
Loss = 7.2906e-04, PNorm = 77.2583, GNorm = 0.4561, lr_0 = 1.5416e-04
Loss = 7.6671e-04, PNorm = 77.2721, GNorm = 0.3291, lr_0 = 1.4763e-04
Loss = 1.0149e-03, PNorm = 77.2730, GNorm = 0.4451, lr_0 = 1.4699e-04
Validation rmse = 0.704299
Epoch 24
Loss = 5.5563e-04, PNorm = 77.2826, GNorm = 0.3567, lr_0 = 1.4077e-04
Loss = 5.8282e-04, PNorm = 77.2925, GNorm = 0.5658, lr_0 = 1.3480e-04
Validation rmse = 0.789943
Epoch 25
Loss = 5.1502e-04, PNorm = 77.3031, GNorm = 1.0920, lr_0 = 1.2909e-04
Loss = 6.6097e-04, PNorm = 77.3128, GNorm = 0.6414, lr_0 = 1.2362e-04
Validation rmse = 0.695261
Epoch 26
Loss = 4.9587e-04, PNorm = 77.3231, GNorm = 0.5179, lr_0 = 1.1839e-04
Validation rmse = 0.704418
Epoch 27
Loss = 4.4513e-04, PNorm = 77.3340, GNorm = 0.2882, lr_0 = 1.1288e-04
Loss = 5.2097e-04, PNorm = 77.3419, GNorm = 0.5681, lr_0 = 1.0810e-04
Validation rmse = 0.701521
Epoch 28
Loss = 3.6550e-04, PNorm = 77.3512, GNorm = 0.8558, lr_0 = 1.0352e-04
Loss = 5.4284e-04, PNorm = 77.3585, GNorm = 0.4678, lr_0 = 1.0000e-04
Validation rmse = 0.744178
Epoch 29
Loss = 4.2118e-04, PNorm = 77.3673, GNorm = 0.4955, lr_0 = 1.0000e-04
Loss = 5.0093e-04, PNorm = 77.3759, GNorm = 0.4835, lr_0 = 1.0000e-04
Validation rmse = 0.698405
Model 0 best validation rmse = 0.687546 on epoch 19
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.871551
Ensemble test rmse = 0.871551
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total scaffolds = 195 | train scaffolds = 94 | val scaffolds = 55 | test scaffolds = 46
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1804, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,236,601
Moving model to cuda
Epoch 0
Loss = 1.3283e-02, PNorm = 75.8063, GNorm = 10.3340, lr_0 = 3.6053e-04
Validation rmse = 1.694049
Epoch 1
Loss = 6.7988e-03, PNorm = 75.8943, GNorm = 5.9161, lr_0 = 6.2105e-04
Loss = 3.6386e-03, PNorm = 75.9888, GNorm = 1.1511, lr_0 = 8.5789e-04
Validation rmse = 1.272628
Epoch 2
Loss = 3.5717e-03, PNorm = 76.0852, GNorm = 1.9184, lr_0 = 9.8284e-04
Loss = 3.2305e-03, PNorm = 76.1649, GNorm = 1.0509, lr_0 = 9.4120e-04
Validation rmse = 1.118167
Epoch 3
Loss = 2.5027e-03, PNorm = 76.2361, GNorm = 0.8988, lr_0 = 8.9744e-04
Loss = 2.2468e-03, PNorm = 76.2902, GNorm = 0.9239, lr_0 = 8.5943e-04
Validation rmse = 1.133952
Epoch 4
Loss = 2.0868e-03, PNorm = 76.3306, GNorm = 1.1513, lr_0 = 8.2303e-04
Loss = 1.8590e-03, PNorm = 76.3738, GNorm = 1.3441, lr_0 = 7.8816e-04
Validation rmse = 0.955372
Epoch 5
Loss = 1.3078e-03, PNorm = 76.4087, GNorm = 0.6357, lr_0 = 7.5478e-04
Loss = 1.7232e-03, PNorm = 76.4458, GNorm = 1.5154, lr_0 = 7.2281e-04
Validation rmse = 0.915304
Epoch 6
Loss = 1.7885e-03, PNorm = 76.4868, GNorm = 0.4459, lr_0 = 6.8920e-04
Loss = 1.7586e-03, PNorm = 76.5265, GNorm = 0.4030, lr_0 = 6.6001e-04
Validation rmse = 0.905949
Epoch 7
Loss = 1.2994e-03, PNorm = 76.5603, GNorm = 0.2564, lr_0 = 6.3205e-04
Loss = 1.6023e-03, PNorm = 76.5940, GNorm = 0.7438, lr_0 = 6.0528e-04
Validation rmse = 0.817968
Epoch 8
Loss = 1.2968e-03, PNorm = 76.6255, GNorm = 0.4129, lr_0 = 5.7714e-04
Loss = 1.4923e-03, PNorm = 76.6516, GNorm = 0.6402, lr_0 = 5.5269e-04
Validation rmse = 0.844791
Epoch 9
Loss = 1.3234e-03, PNorm = 76.6763, GNorm = 0.4548, lr_0 = 5.2928e-04
Loss = 1.4229e-03, PNorm = 76.7069, GNorm = 0.8415, lr_0 = 5.0686e-04
Validation rmse = 0.886503
Epoch 10
Loss = 1.1787e-03, PNorm = 76.7393, GNorm = 0.4265, lr_0 = 4.8539e-04
Loss = 1.2704e-03, PNorm = 76.7656, GNorm = 0.6234, lr_0 = 4.6483e-04
Validation rmse = 0.879256
Epoch 11
Loss = 1.0638e-03, PNorm = 76.7915, GNorm = 0.5097, lr_0 = 4.4322e-04
Loss = 1.0948e-03, PNorm = 76.8214, GNorm = 0.7703, lr_0 = 4.2444e-04
Validation rmse = 0.873056
Epoch 12
Loss = 9.6508e-04, PNorm = 76.8479, GNorm = 0.4631, lr_0 = 4.0646e-04
Loss = 1.0777e-03, PNorm = 76.8724, GNorm = 0.6152, lr_0 = 3.8925e-04
Validation rmse = 0.999978
Epoch 13
Loss = 1.0162e-03, PNorm = 76.8964, GNorm = 1.3920, lr_0 = 3.7276e-04
Loss = 1.0861e-03, PNorm = 76.9185, GNorm = 0.7743, lr_0 = 3.5697e-04
Validation rmse = 0.879921
Epoch 14
Loss = 1.1931e-03, PNorm = 76.9463, GNorm = 0.6370, lr_0 = 3.4037e-04
Loss = 9.8244e-04, PNorm = 76.9679, GNorm = 0.3783, lr_0 = 3.2596e-04
Validation rmse = 0.859793
Epoch 15
Loss = 9.8869e-04, PNorm = 76.9914, GNorm = 0.5024, lr_0 = 3.1215e-04
Loss = 9.1860e-04, PNorm = 77.0146, GNorm = 0.5796, lr_0 = 2.9893e-04
Validation rmse = 0.863374
Epoch 16
Loss = 8.8427e-04, PNorm = 77.0326, GNorm = 0.4861, lr_0 = 2.8503e-04
Loss = 8.7061e-04, PNorm = 77.0498, GNorm = 0.6278, lr_0 = 2.7295e-04
Validation rmse = 0.846841
Epoch 17
Loss = 6.1222e-04, PNorm = 77.0671, GNorm = 0.4527, lr_0 = 2.6139e-04
Loss = 9.3927e-04, PNorm = 77.0831, GNorm = 0.4595, lr_0 = 2.5032e-04
Validation rmse = 0.869897
Epoch 18
Loss = 7.4156e-04, PNorm = 77.1006, GNorm = 0.6270, lr_0 = 2.3972e-04
Loss = 7.4249e-04, PNorm = 77.1173, GNorm = 0.2227, lr_0 = 2.2956e-04
Validation rmse = 0.943186
Epoch 19
Loss = 1.0121e-03, PNorm = 77.1337, GNorm = 0.7202, lr_0 = 2.1889e-04
Loss = 8.2504e-04, PNorm = 77.1485, GNorm = 0.2682, lr_0 = 2.0962e-04
Validation rmse = 0.903643
Epoch 20
Loss = 6.9760e-04, PNorm = 77.1635, GNorm = 0.4929, lr_0 = 2.0074e-04
Loss = 7.9870e-04, PNorm = 77.1773, GNorm = 0.5562, lr_0 = 1.9224e-04
Validation rmse = 0.838717
Epoch 21
Loss = 6.1551e-04, PNorm = 77.1887, GNorm = 0.5594, lr_0 = 1.8409e-04
Loss = 6.2563e-04, PNorm = 77.2021, GNorm = 0.1768, lr_0 = 1.7630e-04
Validation rmse = 0.822695
Epoch 22
Loss = 5.2632e-04, PNorm = 77.2147, GNorm = 0.3865, lr_0 = 1.6810e-04
Loss = 6.5839e-04, PNorm = 77.2267, GNorm = 0.4295, lr_0 = 1.6098e-04
Validation rmse = 0.822200
Epoch 23
Loss = 6.9525e-04, PNorm = 77.2367, GNorm = 0.3933, lr_0 = 1.5416e-04
Loss = 5.0643e-04, PNorm = 77.2480, GNorm = 0.5574, lr_0 = 1.4763e-04
Loss = 5.8713e-04, PNorm = 77.2489, GNorm = 0.3047, lr_0 = 1.4699e-04
Validation rmse = 0.872210
Epoch 24
Loss = 5.2570e-04, PNorm = 77.2585, GNorm = 0.3252, lr_0 = 1.4077e-04
Loss = 6.8978e-04, PNorm = 77.2684, GNorm = 0.3760, lr_0 = 1.3480e-04
Validation rmse = 0.931790
Epoch 25
Loss = 4.9968e-04, PNorm = 77.2780, GNorm = 0.3176, lr_0 = 1.2909e-04
Loss = 5.0680e-04, PNorm = 77.2853, GNorm = 0.5145, lr_0 = 1.2362e-04
Validation rmse = 0.862339
Epoch 26
Loss = 7.1073e-04, PNorm = 77.2945, GNorm = 0.4298, lr_0 = 1.1839e-04
Validation rmse = 0.892762
Epoch 27
Loss = 5.7424e-04, PNorm = 77.3042, GNorm = 0.3556, lr_0 = 1.1288e-04
Loss = 5.3426e-04, PNorm = 77.3133, GNorm = 0.4197, lr_0 = 1.0810e-04
Validation rmse = 0.846708
Epoch 28
Loss = 7.3323e-04, PNorm = 77.3208, GNorm = 0.3912, lr_0 = 1.0352e-04
Loss = 5.4414e-04, PNorm = 77.3294, GNorm = 0.3826, lr_0 = 1.0000e-04
Validation rmse = 0.837341
Epoch 29
Loss = 4.6662e-04, PNorm = 77.3356, GNorm = 0.3958, lr_0 = 1.0000e-04
Loss = 6.1601e-04, PNorm = 77.3432, GNorm = 0.2474, lr_0 = 1.0000e-04
Validation rmse = 0.899598
Model 0 best validation rmse = 0.817968 on epoch 7
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.951778
Ensemble test rmse = 0.951778
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total scaffolds = 195 | train scaffolds = 64 | val scaffolds = 68 | test scaffolds = 63
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1804, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,236,601
Moving model to cuda
Epoch 0
Loss = 1.5004e-02, PNorm = 75.8080, GNorm = 3.4878, lr_0 = 3.6053e-04
Validation rmse = 1.663293
Epoch 1
Loss = 5.2421e-03, PNorm = 75.9029, GNorm = 4.5548, lr_0 = 6.2105e-04
Loss = 3.5607e-03, PNorm = 76.0043, GNorm = 1.6045, lr_0 = 8.5789e-04
Validation rmse = 1.325634
Epoch 2
Loss = 2.6633e-03, PNorm = 76.0924, GNorm = 0.5192, lr_0 = 9.8284e-04
Loss = 2.9836e-03, PNorm = 76.1621, GNorm = 1.6113, lr_0 = 9.4120e-04
Validation rmse = 1.217760
Epoch 3
Loss = 2.0721e-03, PNorm = 76.2312, GNorm = 1.7732, lr_0 = 8.9744e-04
Loss = 2.0904e-03, PNorm = 76.2830, GNorm = 0.4897, lr_0 = 8.5943e-04
Validation rmse = 1.120517
Epoch 4
Loss = 1.9576e-03, PNorm = 76.3343, GNorm = 1.5324, lr_0 = 8.2303e-04
Loss = 2.2992e-03, PNorm = 76.3902, GNorm = 0.8895, lr_0 = 7.8816e-04
Validation rmse = 1.153553
Epoch 5
Loss = 1.3700e-03, PNorm = 76.4357, GNorm = 0.4204, lr_0 = 7.5478e-04
Loss = 1.6858e-03, PNorm = 76.4734, GNorm = 0.5204, lr_0 = 7.2281e-04
Validation rmse = 1.219348
Epoch 6
Loss = 1.7932e-03, PNorm = 76.5121, GNorm = 0.9483, lr_0 = 6.8920e-04
Loss = 1.6267e-03, PNorm = 76.5553, GNorm = 0.5852, lr_0 = 6.6001e-04
Validation rmse = 1.148670
Epoch 7
Loss = 2.1803e-03, PNorm = 76.5896, GNorm = 1.6131, lr_0 = 6.3205e-04
Loss = 1.8480e-03, PNorm = 76.6335, GNorm = 0.8491, lr_0 = 6.0528e-04
Validation rmse = 1.042609
Epoch 8
Loss = 1.5358e-03, PNorm = 76.6733, GNorm = 0.3976, lr_0 = 5.7714e-04
Loss = 1.2250e-03, PNorm = 76.7080, GNorm = 0.4706, lr_0 = 5.5269e-04
Validation rmse = 1.132630
Epoch 9
Loss = 1.1825e-03, PNorm = 76.7394, GNorm = 0.2575, lr_0 = 5.2928e-04
Loss = 1.0576e-03, PNorm = 76.7719, GNorm = 0.4142, lr_0 = 5.0686e-04
Validation rmse = 1.018496
Epoch 10
Loss = 1.1846e-03, PNorm = 76.8065, GNorm = 0.3613, lr_0 = 4.8539e-04
Loss = 1.0325e-03, PNorm = 76.8378, GNorm = 0.6649, lr_0 = 4.6483e-04
Validation rmse = 1.024404
Epoch 11
Loss = 1.3275e-03, PNorm = 76.8617, GNorm = 0.6125, lr_0 = 4.4322e-04
Loss = 1.0344e-03, PNorm = 76.8912, GNorm = 0.6703, lr_0 = 4.2444e-04
Validation rmse = 1.020024
Epoch 12
Loss = 8.2040e-04, PNorm = 76.9191, GNorm = 0.9556, lr_0 = 4.0646e-04
Loss = 9.8084e-04, PNorm = 76.9437, GNorm = 0.6047, lr_0 = 3.8925e-04
Validation rmse = 1.055700
Epoch 13
Loss = 9.4102e-04, PNorm = 76.9677, GNorm = 0.3641, lr_0 = 3.7276e-04
Loss = 8.9841e-04, PNorm = 76.9966, GNorm = 0.4325, lr_0 = 3.5697e-04
Validation rmse = 1.031072
Epoch 14
Loss = 8.9050e-04, PNorm = 77.0260, GNorm = 0.6860, lr_0 = 3.4037e-04
Loss = 1.0110e-03, PNorm = 77.0491, GNorm = 0.3540, lr_0 = 3.2596e-04
Validation rmse = 1.008235
Epoch 15
Loss = 6.8313e-04, PNorm = 77.0712, GNorm = 0.7012, lr_0 = 3.1215e-04
Loss = 8.8097e-04, PNorm = 77.0941, GNorm = 0.4829, lr_0 = 2.9893e-04
Validation rmse = 1.192717
Epoch 16
Loss = 9.3771e-04, PNorm = 77.1174, GNorm = 1.1979, lr_0 = 2.8503e-04
Loss = 9.7049e-04, PNorm = 77.1373, GNorm = 1.5639, lr_0 = 2.7295e-04
Validation rmse = 1.061938
Epoch 17
Loss = 1.0396e-03, PNorm = 77.1606, GNorm = 0.8430, lr_0 = 2.6139e-04
Loss = 8.0093e-04, PNorm = 77.1794, GNorm = 0.4342, lr_0 = 2.5032e-04
Validation rmse = 1.004782
Epoch 18
Loss = 9.1220e-04, PNorm = 77.2005, GNorm = 0.3429, lr_0 = 2.3972e-04
Loss = 8.4305e-04, PNorm = 77.2190, GNorm = 0.5620, lr_0 = 2.2956e-04
Validation rmse = 0.985804
Epoch 19
Loss = 7.1509e-04, PNorm = 77.2397, GNorm = 0.3169, lr_0 = 2.1889e-04
Loss = 7.2303e-04, PNorm = 77.2550, GNorm = 0.3001, lr_0 = 2.0962e-04
Validation rmse = 1.019811
Epoch 20
Loss = 6.6861e-04, PNorm = 77.2718, GNorm = 0.4272, lr_0 = 2.0074e-04
Loss = 7.7332e-04, PNorm = 77.2846, GNorm = 0.2776, lr_0 = 1.9224e-04
Validation rmse = 0.979708
Epoch 21
Loss = 6.1863e-04, PNorm = 77.3001, GNorm = 0.4051, lr_0 = 1.8409e-04
Loss = 5.8514e-04, PNorm = 77.3124, GNorm = 0.4199, lr_0 = 1.7630e-04
Validation rmse = 1.043785
Epoch 22
Loss = 6.2293e-04, PNorm = 77.3268, GNorm = 0.3625, lr_0 = 1.6810e-04
Loss = 5.9267e-04, PNorm = 77.3382, GNorm = 0.2090, lr_0 = 1.6098e-04
Validation rmse = 0.993646
Epoch 23
Loss = 5.7552e-04, PNorm = 77.3512, GNorm = 0.6372, lr_0 = 1.5416e-04
Loss = 8.1072e-04, PNorm = 77.3614, GNorm = 0.3901, lr_0 = 1.4763e-04
Loss = 1.1560e-03, PNorm = 77.3624, GNorm = 0.3766, lr_0 = 1.4699e-04
Validation rmse = 1.029232
Epoch 24
Loss = 4.9273e-04, PNorm = 77.3729, GNorm = 0.2672, lr_0 = 1.4077e-04
Loss = 6.1292e-04, PNorm = 77.3843, GNorm = 0.3543, lr_0 = 1.3480e-04
Validation rmse = 1.013622
Epoch 25
Loss = 4.1617e-04, PNorm = 77.3939, GNorm = 0.4641, lr_0 = 1.2909e-04
Loss = 5.6001e-04, PNorm = 77.4033, GNorm = 0.5340, lr_0 = 1.2362e-04
Validation rmse = 0.991282
Epoch 26
Loss = 5.6210e-04, PNorm = 77.4105, GNorm = 0.1933, lr_0 = 1.1839e-04
Validation rmse = 0.985782
Epoch 27
Loss = 7.4419e-04, PNorm = 77.4198, GNorm = 0.7397, lr_0 = 1.1288e-04
Loss = 5.0905e-04, PNorm = 77.4275, GNorm = 0.2940, lr_0 = 1.0810e-04
Validation rmse = 1.000377
Epoch 28
Loss = 4.3357e-04, PNorm = 77.4371, GNorm = 0.2670, lr_0 = 1.0352e-04
Loss = 4.8049e-04, PNorm = 77.4430, GNorm = 0.5097, lr_0 = 1.0000e-04
Validation rmse = 1.009419
Epoch 29
Loss = 5.3587e-04, PNorm = 77.4510, GNorm = 0.4955, lr_0 = 1.0000e-04
Loss = 5.1884e-04, PNorm = 77.4580, GNorm = 0.4081, lr_0 = 1.0000e-04
Validation rmse = 0.983743
Model 0 best validation rmse = 0.979708 on epoch 20
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.735710
Ensemble test rmse = 0.735710
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total scaffolds = 195 | train scaffolds = 69 | val scaffolds = 65 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1804, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,236,601
Moving model to cuda
Epoch 0
Loss = 1.3269e-02, PNorm = 75.8063, GNorm = 3.4872, lr_0 = 3.6053e-04
Validation rmse = 1.745946
Epoch 1
Loss = 3.9248e-03, PNorm = 75.8919, GNorm = 2.8869, lr_0 = 6.2105e-04
Loss = 3.7970e-03, PNorm = 75.9861, GNorm = 2.0227, lr_0 = 8.5789e-04
Validation rmse = 1.255648
Epoch 2
Loss = 2.0372e-03, PNorm = 76.0725, GNorm = 1.2139, lr_0 = 9.8284e-04
Loss = 2.8622e-03, PNorm = 76.1467, GNorm = 1.2074, lr_0 = 9.4120e-04
Validation rmse = 1.211236
Epoch 3
Loss = 2.6346e-03, PNorm = 76.2138, GNorm = 2.3013, lr_0 = 8.9744e-04
Loss = 2.3898e-03, PNorm = 76.2616, GNorm = 1.0114, lr_0 = 8.5943e-04
Validation rmse = 1.229914
Epoch 4
Loss = 2.0687e-03, PNorm = 76.3032, GNorm = 1.1382, lr_0 = 8.2303e-04
Loss = 1.8667e-03, PNorm = 76.3462, GNorm = 1.6773, lr_0 = 7.8816e-04
Validation rmse = 1.163989
Epoch 5
Loss = 1.7774e-03, PNorm = 76.3935, GNorm = 0.6565, lr_0 = 7.5478e-04
Loss = 1.7211e-03, PNorm = 76.4431, GNorm = 0.2468, lr_0 = 7.2281e-04
Validation rmse = 1.246877
Epoch 6
Loss = 1.8807e-03, PNorm = 76.4860, GNorm = 1.6139, lr_0 = 6.8920e-04
Loss = 1.4360e-03, PNorm = 76.5255, GNorm = 0.7809, lr_0 = 6.6001e-04
Validation rmse = 1.192441
Epoch 7
Loss = 1.2826e-03, PNorm = 76.5598, GNorm = 0.8648, lr_0 = 6.3205e-04
Loss = 1.5745e-03, PNorm = 76.5942, GNorm = 0.5513, lr_0 = 6.0528e-04
Validation rmse = 1.230582
Epoch 8
Loss = 1.5591e-03, PNorm = 76.6218, GNorm = 0.7802, lr_0 = 5.7714e-04
Loss = 1.6693e-03, PNorm = 76.6520, GNorm = 0.4640, lr_0 = 5.5269e-04
Validation rmse = 1.264205
Epoch 9
Loss = 1.2759e-03, PNorm = 76.6826, GNorm = 0.4563, lr_0 = 5.2928e-04
Loss = 1.1368e-03, PNorm = 76.7103, GNorm = 0.7400, lr_0 = 5.0686e-04
Validation rmse = 1.195489
Epoch 10
Loss = 1.2268e-03, PNorm = 76.7391, GNorm = 0.8118, lr_0 = 4.8539e-04
Loss = 1.0568e-03, PNorm = 76.7724, GNorm = 0.5247, lr_0 = 4.6483e-04
Validation rmse = 1.221074
Epoch 11
Loss = 8.7221e-04, PNorm = 76.8039, GNorm = 0.3562, lr_0 = 4.4322e-04
Loss = 1.0853e-03, PNorm = 76.8275, GNorm = 0.2117, lr_0 = 4.2444e-04
Validation rmse = 1.272194
Epoch 12
Loss = 1.0140e-03, PNorm = 76.8490, GNorm = 0.5660, lr_0 = 4.0646e-04
Loss = 9.0596e-04, PNorm = 76.8713, GNorm = 0.7602, lr_0 = 3.8925e-04
Validation rmse = 1.124816
Epoch 13
Loss = 1.0745e-03, PNorm = 76.8970, GNorm = 1.0021, lr_0 = 3.7276e-04
Loss = 1.0455e-03, PNorm = 76.9243, GNorm = 0.4279, lr_0 = 3.5697e-04
Validation rmse = 1.374441
Epoch 14
Loss = 1.1966e-03, PNorm = 76.9468, GNorm = 1.3973, lr_0 = 3.4037e-04
Loss = 9.9410e-04, PNorm = 76.9685, GNorm = 0.5638, lr_0 = 3.2596e-04
Validation rmse = 1.276587
Epoch 15
Loss = 9.3419e-04, PNorm = 76.9878, GNorm = 0.4085, lr_0 = 3.1215e-04
Loss = 8.5704e-04, PNorm = 77.0042, GNorm = 0.4122, lr_0 = 2.9893e-04
Validation rmse = 1.281872
Epoch 16
Loss = 8.6429e-04, PNorm = 77.0288, GNorm = 0.1999, lr_0 = 2.8503e-04
Loss = 8.6088e-04, PNorm = 77.0484, GNorm = 1.0788, lr_0 = 2.7295e-04
Validation rmse = 1.227989
Epoch 17
Loss = 1.1254e-03, PNorm = 77.0692, GNorm = 0.9658, lr_0 = 2.6139e-04
Loss = 8.6135e-04, PNorm = 77.0869, GNorm = 1.2558, lr_0 = 2.5032e-04
Validation rmse = 1.163027
Epoch 18
Loss = 8.3030e-04, PNorm = 77.1045, GNorm = 0.5024, lr_0 = 2.3972e-04
Loss = 8.6960e-04, PNorm = 77.1232, GNorm = 0.3962, lr_0 = 2.2956e-04
Validation rmse = 1.235977
Epoch 19
Loss = 7.6495e-04, PNorm = 77.1382, GNorm = 1.1239, lr_0 = 2.1889e-04
Loss = 7.2338e-04, PNorm = 77.1540, GNorm = 0.2844, lr_0 = 2.0962e-04
Validation rmse = 1.203106
Epoch 20
Loss = 6.1100e-04, PNorm = 77.1673, GNorm = 0.5933, lr_0 = 2.0074e-04
Loss = 6.3495e-04, PNorm = 77.1787, GNorm = 0.7397, lr_0 = 1.9224e-04
Validation rmse = 1.192260
Epoch 21
Loss = 5.9299e-04, PNorm = 77.1890, GNorm = 0.7347, lr_0 = 1.8409e-04
Loss = 6.6484e-04, PNorm = 77.2017, GNorm = 0.3961, lr_0 = 1.7630e-04
Validation rmse = 1.254732
Epoch 22
Loss = 5.7002e-04, PNorm = 77.2144, GNorm = 0.3593, lr_0 = 1.6810e-04
Loss = 6.3449e-04, PNorm = 77.2255, GNorm = 0.4851, lr_0 = 1.6098e-04
Validation rmse = 1.293498
Epoch 23
Loss = 5.6954e-04, PNorm = 77.2361, GNorm = 0.3412, lr_0 = 1.5416e-04
Loss = 5.0311e-04, PNorm = 77.2464, GNorm = 0.3234, lr_0 = 1.4763e-04
Loss = 1.3029e-03, PNorm = 77.2470, GNorm = 0.6279, lr_0 = 1.4699e-04
Validation rmse = 1.222190
Epoch 24
Loss = 6.5877e-04, PNorm = 77.2581, GNorm = 0.6468, lr_0 = 1.4077e-04
Loss = 6.1998e-04, PNorm = 77.2659, GNorm = 0.4761, lr_0 = 1.3480e-04
Validation rmse = 1.211801
Epoch 25
Loss = 4.7735e-04, PNorm = 77.2744, GNorm = 0.2062, lr_0 = 1.2909e-04
Loss = 6.0990e-04, PNorm = 77.2833, GNorm = 0.8346, lr_0 = 1.2362e-04
Validation rmse = 1.203892
Epoch 26
Loss = 6.2794e-04, PNorm = 77.2888, GNorm = 0.5568, lr_0 = 1.1839e-04
Validation rmse = 1.197732
Epoch 27
Loss = 4.4441e-04, PNorm = 77.2975, GNorm = 0.6125, lr_0 = 1.1288e-04
Loss = 5.4193e-04, PNorm = 77.3055, GNorm = 0.6491, lr_0 = 1.0810e-04
Validation rmse = 1.269580
Epoch 28
Loss = 3.8151e-04, PNorm = 77.3139, GNorm = 0.2025, lr_0 = 1.0352e-04
Loss = 5.1809e-04, PNorm = 77.3201, GNorm = 0.5807, lr_0 = 1.0000e-04
Validation rmse = 1.257085
Epoch 29
Loss = 5.4108e-04, PNorm = 77.3273, GNorm = 0.2595, lr_0 = 1.0000e-04
Loss = 4.1896e-04, PNorm = 77.3339, GNorm = 0.4247, lr_0 = 1.0000e-04
Validation rmse = 1.226242
Model 0 best validation rmse = 1.124816 on epoch 12
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.780314
Ensemble test rmse = 0.780314
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total scaffolds = 195 | train scaffolds = 75 | val scaffolds = 42 | test scaffolds = 78
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1804, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,236,601
Moving model to cuda
Epoch 0
Loss = 9.5986e-03, PNorm = 75.8081, GNorm = 5.5847, lr_0 = 3.6053e-04
Validation rmse = 1.269559
Epoch 1
Loss = 3.0388e-03, PNorm = 75.8776, GNorm = 1.6328, lr_0 = 6.2105e-04
Loss = 3.9976e-03, PNorm = 75.9626, GNorm = 5.3088, lr_0 = 8.5789e-04
Validation rmse = 1.079915
Epoch 2
Loss = 2.8222e-03, PNorm = 76.0479, GNorm = 2.1992, lr_0 = 9.8284e-04
Loss = 2.4116e-03, PNorm = 76.1191, GNorm = 2.1010, lr_0 = 9.4120e-04
Validation rmse = 1.023709
Epoch 3
Loss = 1.8808e-03, PNorm = 76.1812, GNorm = 0.7359, lr_0 = 8.9744e-04
Loss = 1.8242e-03, PNorm = 76.2283, GNorm = 1.1367, lr_0 = 8.5943e-04
Validation rmse = 0.949673
Epoch 4
Loss = 2.6061e-03, PNorm = 76.2782, GNorm = 1.1645, lr_0 = 8.2303e-04
Loss = 1.6882e-03, PNorm = 76.3217, GNorm = 0.5004, lr_0 = 7.8816e-04
Validation rmse = 0.864852
Epoch 5
Loss = 9.3438e-04, PNorm = 76.3558, GNorm = 1.2527, lr_0 = 7.5478e-04
Loss = 1.6421e-03, PNorm = 76.3913, GNorm = 1.4297, lr_0 = 7.2281e-04
Validation rmse = 0.941227
Epoch 6
Loss = 1.1266e-03, PNorm = 76.4289, GNorm = 1.0646, lr_0 = 6.8920e-04
Loss = 1.2416e-03, PNorm = 76.4618, GNorm = 0.4979, lr_0 = 6.6001e-04
Validation rmse = 0.935441
Epoch 7
Loss = 1.3440e-03, PNorm = 76.4904, GNorm = 1.1602, lr_0 = 6.3205e-04
Loss = 1.4265e-03, PNorm = 76.5185, GNorm = 0.9486, lr_0 = 6.0528e-04
Validation rmse = 0.866381
Epoch 8
Loss = 1.5848e-03, PNorm = 76.5469, GNorm = 1.1481, lr_0 = 5.7714e-04
Loss = 1.2280e-03, PNorm = 76.5764, GNorm = 1.5882, lr_0 = 5.5269e-04
Validation rmse = 0.963308
Epoch 9
Loss = 1.5711e-03, PNorm = 76.6077, GNorm = 2.3287, lr_0 = 5.2928e-04
Loss = 1.1851e-03, PNorm = 76.6364, GNorm = 0.3441, lr_0 = 5.0686e-04
Validation rmse = 0.862304
Epoch 10
Loss = 9.4272e-04, PNorm = 76.6643, GNorm = 0.4961, lr_0 = 4.8539e-04
Loss = 1.0178e-03, PNorm = 76.6897, GNorm = 0.8379, lr_0 = 4.6483e-04
Validation rmse = 0.878495
Epoch 11
Loss = 1.2151e-03, PNorm = 76.7139, GNorm = 0.3555, lr_0 = 4.4322e-04
Loss = 8.7087e-04, PNorm = 76.7391, GNorm = 1.0029, lr_0 = 4.2444e-04
Validation rmse = 0.859910
Epoch 12
Loss = 9.2352e-04, PNorm = 76.7648, GNorm = 0.5689, lr_0 = 4.0646e-04
Loss = 7.8407e-04, PNorm = 76.7888, GNorm = 0.2844, lr_0 = 3.8925e-04
Validation rmse = 0.783464
Epoch 13
Loss = 8.1966e-04, PNorm = 76.8102, GNorm = 0.4296, lr_0 = 3.7276e-04
Loss = 8.3552e-04, PNorm = 76.8318, GNorm = 1.0513, lr_0 = 3.5697e-04
Validation rmse = 0.774264
Epoch 14
Loss = 9.7713e-04, PNorm = 76.8531, GNorm = 0.6301, lr_0 = 3.4037e-04
Loss = 8.3190e-04, PNorm = 76.8699, GNorm = 0.6687, lr_0 = 3.2596e-04
Validation rmse = 0.806800
Epoch 15
Loss = 7.9501e-04, PNorm = 76.8865, GNorm = 0.3746, lr_0 = 3.1215e-04
Loss = 8.3742e-04, PNorm = 76.9079, GNorm = 0.3970, lr_0 = 2.9893e-04
Validation rmse = 0.818810
Epoch 16
Loss = 7.3126e-04, PNorm = 76.9273, GNorm = 0.4252, lr_0 = 2.8503e-04
Loss = 9.7151e-04, PNorm = 76.9447, GNorm = 0.5027, lr_0 = 2.7295e-04
Validation rmse = 0.850818
Epoch 17
Loss = 7.4536e-04, PNorm = 76.9574, GNorm = 0.4847, lr_0 = 2.6139e-04
Loss = 9.7943e-04, PNorm = 76.9761, GNorm = 0.4082, lr_0 = 2.5032e-04
Validation rmse = 0.901626
Epoch 18
Loss = 8.1018e-04, PNorm = 76.9935, GNorm = 0.4055, lr_0 = 2.3972e-04
Loss = 6.9900e-04, PNorm = 77.0061, GNorm = 0.3045, lr_0 = 2.2956e-04
Validation rmse = 0.829875
Epoch 19
Loss = 7.2464e-04, PNorm = 77.0224, GNorm = 0.3988, lr_0 = 2.1889e-04
Loss = 6.5040e-04, PNorm = 77.0365, GNorm = 0.4645, lr_0 = 2.0962e-04
Validation rmse = 0.846951
Epoch 20
Loss = 5.7646e-04, PNorm = 77.0500, GNorm = 0.3572, lr_0 = 2.0074e-04
Loss = 7.1029e-04, PNorm = 77.0637, GNorm = 0.7381, lr_0 = 1.9224e-04
Validation rmse = 0.867931
Epoch 21
Loss = 5.7832e-04, PNorm = 77.0765, GNorm = 0.5660, lr_0 = 1.8409e-04
Loss = 5.6326e-04, PNorm = 77.0873, GNorm = 0.2796, lr_0 = 1.7630e-04
Validation rmse = 0.830679
Epoch 22
Loss = 6.3987e-04, PNorm = 77.0992, GNorm = 0.7630, lr_0 = 1.6810e-04
Loss = 6.7808e-04, PNorm = 77.1106, GNorm = 0.4403, lr_0 = 1.6098e-04
Validation rmse = 0.879900
Epoch 23
Loss = 5.7176e-04, PNorm = 77.1207, GNorm = 0.4922, lr_0 = 1.5416e-04
Loss = 5.6189e-04, PNorm = 77.1315, GNorm = 0.5085, lr_0 = 1.4763e-04
Loss = 6.9571e-04, PNorm = 77.1323, GNorm = 0.3011, lr_0 = 1.4699e-04
Validation rmse = 0.844133
Epoch 24
Loss = 4.5536e-04, PNorm = 77.1403, GNorm = 0.4698, lr_0 = 1.4077e-04
Loss = 5.1320e-04, PNorm = 77.1491, GNorm = 0.4028, lr_0 = 1.3480e-04
Validation rmse = 0.852174
Epoch 25
Loss = 5.5646e-04, PNorm = 77.1553, GNorm = 0.7218, lr_0 = 1.2909e-04
Loss = 4.8990e-04, PNorm = 77.1639, GNorm = 0.4524, lr_0 = 1.2362e-04
Validation rmse = 0.880083
Epoch 26
Loss = 4.9839e-04, PNorm = 77.1729, GNorm = 0.2598, lr_0 = 1.1839e-04
Validation rmse = 0.842841
Epoch 27
Loss = 1.0581e-03, PNorm = 77.1789, GNorm = 1.2637, lr_0 = 1.1288e-04
Loss = 4.9291e-04, PNorm = 77.1847, GNorm = 0.2314, lr_0 = 1.0810e-04
Validation rmse = 0.855324
Epoch 28
Loss = 4.1565e-04, PNorm = 77.1917, GNorm = 0.4306, lr_0 = 1.0352e-04
Loss = 4.5372e-04, PNorm = 77.1983, GNorm = 0.3784, lr_0 = 1.0000e-04
Validation rmse = 0.882203
Epoch 29
Loss = 5.2361e-04, PNorm = 77.2073, GNorm = 0.2608, lr_0 = 1.0000e-04
Loss = 3.9901e-04, PNorm = 77.2133, GNorm = 0.3781, lr_0 = 1.0000e-04
Validation rmse = 0.864976
Model 0 best validation rmse = 0.774264 on epoch 13
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.024486
Ensemble test rmse = 1.024486
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 58 | test scaffolds = 53
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1804, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,236,601
Moving model to cuda
Epoch 0
Loss = 1.6130e-02, PNorm = 75.8065, GNorm = 1.2742, lr_0 = 3.6053e-04
Validation rmse = 1.231047
Epoch 1
Loss = 3.8534e-03, PNorm = 75.9020, GNorm = 1.0788, lr_0 = 6.2105e-04
Loss = 4.3389e-03, PNorm = 76.0038, GNorm = 2.1048, lr_0 = 8.5789e-04
Validation rmse = 1.000608
Epoch 2
Loss = 2.5222e-03, PNorm = 76.1064, GNorm = 0.6592, lr_0 = 9.8284e-04
Loss = 3.7431e-03, PNorm = 76.1876, GNorm = 0.9331, lr_0 = 9.4120e-04
Validation rmse = 0.945019
Epoch 3
Loss = 2.1021e-03, PNorm = 76.2611, GNorm = 1.1337, lr_0 = 8.9744e-04
Loss = 2.5105e-03, PNorm = 76.3157, GNorm = 0.4912, lr_0 = 8.5943e-04
Validation rmse = 0.856249
Epoch 4
Loss = 1.9617e-03, PNorm = 76.3674, GNorm = 1.2939, lr_0 = 8.2303e-04
Loss = 1.5906e-03, PNorm = 76.4076, GNorm = 0.5547, lr_0 = 7.8816e-04
Validation rmse = 0.847065
Epoch 5
Loss = 1.4976e-03, PNorm = 76.4467, GNorm = 1.6360, lr_0 = 7.5478e-04
Loss = 1.7757e-03, PNorm = 76.4888, GNorm = 0.8633, lr_0 = 7.2281e-04
Validation rmse = 0.866755
Epoch 6
Loss = 1.4716e-03, PNorm = 76.5276, GNorm = 1.7105, lr_0 = 6.8920e-04
Loss = 1.7071e-03, PNorm = 76.5567, GNorm = 0.5108, lr_0 = 6.6001e-04
Validation rmse = 0.833025
Epoch 7
Loss = 1.8178e-03, PNorm = 76.5907, GNorm = 0.7770, lr_0 = 6.3205e-04
Loss = 1.6791e-03, PNorm = 76.6252, GNorm = 1.9426, lr_0 = 6.0528e-04
Validation rmse = 0.720395
Epoch 8
Loss = 1.5429e-03, PNorm = 76.6613, GNorm = 1.5985, lr_0 = 5.7714e-04
Loss = 1.5321e-03, PNorm = 76.6952, GNorm = 0.4738, lr_0 = 5.5269e-04
Validation rmse = 0.794708
Epoch 9
Loss = 1.0602e-03, PNorm = 76.7246, GNorm = 0.3009, lr_0 = 5.2928e-04
Loss = 1.0810e-03, PNorm = 76.7539, GNorm = 0.5846, lr_0 = 5.0686e-04
Validation rmse = 0.732779
Epoch 10
Loss = 1.1364e-03, PNorm = 76.7777, GNorm = 0.3601, lr_0 = 4.8539e-04
Loss = 1.0281e-03, PNorm = 76.8033, GNorm = 0.4285, lr_0 = 4.6483e-04
Validation rmse = 0.799151
Epoch 11
Loss = 1.3965e-03, PNorm = 76.8325, GNorm = 0.3813, lr_0 = 4.4322e-04
Loss = 1.0367e-03, PNorm = 76.8563, GNorm = 0.7332, lr_0 = 4.2444e-04
Validation rmse = 0.720394
Epoch 12
Loss = 1.0579e-03, PNorm = 76.8836, GNorm = 0.2215, lr_0 = 4.0646e-04
Loss = 1.1345e-03, PNorm = 76.9079, GNorm = 0.6985, lr_0 = 3.8925e-04
Validation rmse = 0.739917
Epoch 13
Loss = 7.7882e-04, PNorm = 76.9296, GNorm = 0.2949, lr_0 = 3.7276e-04
Loss = 1.0723e-03, PNorm = 76.9537, GNorm = 0.9409, lr_0 = 3.5697e-04
Validation rmse = 0.733381
Epoch 14
Loss = 7.9230e-04, PNorm = 76.9804, GNorm = 0.3918, lr_0 = 3.4037e-04
Loss = 9.9116e-04, PNorm = 76.9977, GNorm = 0.7421, lr_0 = 3.2596e-04
Validation rmse = 0.749633
Epoch 15
Loss = 8.4073e-04, PNorm = 77.0191, GNorm = 0.4033, lr_0 = 3.1215e-04
Loss = 8.6263e-04, PNorm = 77.0428, GNorm = 0.3371, lr_0 = 2.9893e-04
Validation rmse = 0.743980
Epoch 16
Loss = 9.0552e-04, PNorm = 77.0652, GNorm = 0.9511, lr_0 = 2.8503e-04
Loss = 7.8195e-04, PNorm = 77.0831, GNorm = 0.2972, lr_0 = 2.7295e-04
Validation rmse = 0.768047
Epoch 17
Loss = 7.8771e-04, PNorm = 77.0989, GNorm = 0.4365, lr_0 = 2.6139e-04
Loss = 8.9679e-04, PNorm = 77.1125, GNorm = 0.8311, lr_0 = 2.5032e-04
Validation rmse = 0.735212
Epoch 18
Loss = 6.7696e-04, PNorm = 77.1295, GNorm = 0.4616, lr_0 = 2.3972e-04
Loss = 7.9379e-04, PNorm = 77.1450, GNorm = 0.4709, lr_0 = 2.2956e-04
Validation rmse = 0.665894
Epoch 19
Loss = 6.9949e-04, PNorm = 77.1611, GNorm = 0.6553, lr_0 = 2.1889e-04
Loss = 8.7453e-04, PNorm = 77.1795, GNorm = 0.5391, lr_0 = 2.0962e-04
Validation rmse = 0.736693
Epoch 20
Loss = 8.0920e-04, PNorm = 77.1945, GNorm = 0.5701, lr_0 = 2.0074e-04
Loss = 6.2817e-04, PNorm = 77.2075, GNorm = 0.3227, lr_0 = 1.9224e-04
Validation rmse = 0.712239
Epoch 21
Loss = 4.9852e-04, PNorm = 77.2182, GNorm = 0.4277, lr_0 = 1.8409e-04
Loss = 7.1911e-04, PNorm = 77.2323, GNorm = 0.3824, lr_0 = 1.7630e-04
Validation rmse = 0.720931
Epoch 22
Loss = 6.4754e-04, PNorm = 77.2448, GNorm = 0.4400, lr_0 = 1.6810e-04
Loss = 5.6684e-04, PNorm = 77.2571, GNorm = 0.6275, lr_0 = 1.6098e-04
Validation rmse = 0.704580
Epoch 23
Loss = 5.2530e-04, PNorm = 77.2664, GNorm = 0.4466, lr_0 = 1.5416e-04
Loss = 6.0940e-04, PNorm = 77.2783, GNorm = 0.3014, lr_0 = 1.4763e-04
Loss = 8.1852e-04, PNorm = 77.2794, GNorm = 0.2917, lr_0 = 1.4699e-04
Validation rmse = 0.693043
Epoch 24
Loss = 5.6312e-04, PNorm = 77.2882, GNorm = 0.1635, lr_0 = 1.4077e-04
Loss = 6.7946e-04, PNorm = 77.2989, GNorm = 0.3279, lr_0 = 1.3480e-04
Validation rmse = 0.724700
Epoch 25
Loss = 7.1902e-04, PNorm = 77.3109, GNorm = 0.6667, lr_0 = 1.2909e-04
Loss = 5.4857e-04, PNorm = 77.3203, GNorm = 0.5156, lr_0 = 1.2362e-04
Validation rmse = 0.738706
Epoch 26
Loss = 6.3635e-04, PNorm = 77.3284, GNorm = 0.4206, lr_0 = 1.1839e-04
Validation rmse = 0.727618
Epoch 27
Loss = 4.2881e-04, PNorm = 77.3390, GNorm = 0.3989, lr_0 = 1.1288e-04
Loss = 7.2297e-04, PNorm = 77.3464, GNorm = 1.1041, lr_0 = 1.0810e-04
Validation rmse = 0.698319
Epoch 28
Loss = 2.9587e-04, PNorm = 77.3562, GNorm = 0.2982, lr_0 = 1.0352e-04
Loss = 4.6271e-04, PNorm = 77.3647, GNorm = 0.3225, lr_0 = 1.0000e-04
Validation rmse = 0.700354
Epoch 29
Loss = 8.0845e-04, PNorm = 77.3739, GNorm = 0.4812, lr_0 = 1.0000e-04
Loss = 5.8897e-04, PNorm = 77.3806, GNorm = 0.3206, lr_0 = 1.0000e-04
Validation rmse = 0.713057
Model 0 best validation rmse = 0.665894 on epoch 18
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.141874
Ensemble test rmse = 1.141874
10-fold cross validation
	Seed 0 ==> test rmse = 0.884773
	Seed 1 ==> test rmse = 0.886879
	Seed 2 ==> test rmse = 0.873391
	Seed 3 ==> test rmse = 0.811292
	Seed 4 ==> test rmse = 0.871551
	Seed 5 ==> test rmse = 0.951778
	Seed 6 ==> test rmse = 0.735710
	Seed 7 ==> test rmse = 0.780314
	Seed 8 ==> test rmse = 1.024486
	Seed 9 ==> test rmse = 1.141874
Overall test rmse = 0.896205 +/- 0.112979
Elapsed time = 0:08:27
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total scaffolds = 195 | train scaffolds = 91 | val scaffolds = 66 | test scaffolds = 38
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=904, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,805
Moving model to cuda
Epoch 0
Loss = 1.4697e-02, PNorm = 46.0522, GNorm = 4.0473, lr_0 = 3.6053e-04
Validation rmse = 2.213728
Epoch 1
Loss = 5.8576e-03, PNorm = 46.1002, GNorm = 2.7889, lr_0 = 6.2105e-04
Loss = 8.4801e-03, PNorm = 46.1538, GNorm = 3.3507, lr_0 = 8.5789e-04
Validation rmse = 1.643441
Epoch 2
Loss = 4.2010e-03, PNorm = 46.2203, GNorm = 0.8845, lr_0 = 9.8284e-04
Loss = 4.1358e-03, PNorm = 46.2687, GNorm = 1.3802, lr_0 = 9.4120e-04
Validation rmse = 1.998418
Epoch 3
Loss = 5.3682e-03, PNorm = 46.3116, GNorm = 4.8035, lr_0 = 8.9744e-04
Loss = 3.5155e-03, PNorm = 46.3461, GNorm = 1.9284, lr_0 = 8.5943e-04
Validation rmse = 1.313451
Epoch 4
Loss = 4.1656e-03, PNorm = 46.3767, GNorm = 2.5891, lr_0 = 8.2303e-04
Loss = 3.0324e-03, PNorm = 46.4091, GNorm = 5.2619, lr_0 = 7.8816e-04
Validation rmse = 1.237901
Epoch 5
Loss = 2.2489e-03, PNorm = 46.4397, GNorm = 3.1372, lr_0 = 7.5478e-04
Loss = 2.1264e-03, PNorm = 46.4673, GNorm = 2.5734, lr_0 = 7.2281e-04
Validation rmse = 1.344823
Epoch 6
Loss = 1.6540e-03, PNorm = 46.5017, GNorm = 1.0520, lr_0 = 6.8920e-04
Loss = 1.9179e-03, PNorm = 46.5226, GNorm = 0.9682, lr_0 = 6.6001e-04
Validation rmse = 1.445096
Epoch 7
Loss = 2.3351e-03, PNorm = 46.5441, GNorm = 3.7653, lr_0 = 6.3205e-04
Loss = 1.8287e-03, PNorm = 46.5667, GNorm = 2.0612, lr_0 = 6.0528e-04
Validation rmse = 1.106739
Epoch 8
Loss = 1.9596e-03, PNorm = 46.5894, GNorm = 1.6975, lr_0 = 5.7714e-04
Loss = 1.8045e-03, PNorm = 46.6103, GNorm = 0.7115, lr_0 = 5.5269e-04
Validation rmse = 1.128406
Epoch 9
Loss = 1.6178e-03, PNorm = 46.6308, GNorm = 3.1118, lr_0 = 5.2928e-04
Loss = 1.7029e-03, PNorm = 46.6523, GNorm = 1.2628, lr_0 = 5.0686e-04
Validation rmse = 1.192182
Epoch 10
Loss = 1.5197e-03, PNorm = 46.6697, GNorm = 1.6517, lr_0 = 4.8539e-04
Loss = 1.5975e-03, PNorm = 46.6876, GNorm = 1.6430, lr_0 = 4.6483e-04
Validation rmse = 1.207036
Epoch 11
Loss = 1.2136e-03, PNorm = 46.7042, GNorm = 0.4384, lr_0 = 4.4322e-04
Loss = 1.3017e-03, PNorm = 46.7203, GNorm = 1.3165, lr_0 = 4.2444e-04
Validation rmse = 1.062591
Epoch 12
Loss = 1.3704e-03, PNorm = 46.7331, GNorm = 1.3821, lr_0 = 4.0646e-04
Loss = 1.3629e-03, PNorm = 46.7479, GNorm = 1.0381, lr_0 = 3.8925e-04
Validation rmse = 1.068416
Epoch 13
Loss = 1.1208e-03, PNorm = 46.7633, GNorm = 0.3609, lr_0 = 3.7276e-04
Loss = 1.4373e-03, PNorm = 46.7781, GNorm = 0.6013, lr_0 = 3.5697e-04
Validation rmse = 1.237789
Epoch 14
Loss = 1.0858e-03, PNorm = 46.7930, GNorm = 1.3035, lr_0 = 3.4037e-04
Loss = 1.1884e-03, PNorm = 46.8065, GNorm = 1.7546, lr_0 = 3.2596e-04
Validation rmse = 1.043153
Epoch 15
Loss = 1.1143e-03, PNorm = 46.8189, GNorm = 0.7386, lr_0 = 3.1215e-04
Loss = 1.0375e-03, PNorm = 46.8304, GNorm = 1.5180, lr_0 = 2.9893e-04
Validation rmse = 1.114216
Epoch 16
Loss = 1.0736e-03, PNorm = 46.8430, GNorm = 0.4862, lr_0 = 2.8503e-04
Loss = 9.8039e-04, PNorm = 46.8537, GNorm = 1.3887, lr_0 = 2.7295e-04
Validation rmse = 1.066232
Epoch 17
Loss = 9.4708e-04, PNorm = 46.8672, GNorm = 1.8392, lr_0 = 2.6139e-04
Loss = 1.1501e-03, PNorm = 46.8793, GNorm = 0.6611, lr_0 = 2.5032e-04
Validation rmse = 1.010420
Epoch 18
Loss = 7.1739e-04, PNorm = 46.8894, GNorm = 0.7512, lr_0 = 2.3972e-04
Loss = 1.0274e-03, PNorm = 46.8989, GNorm = 0.9454, lr_0 = 2.2956e-04
Validation rmse = 1.138075
Epoch 19
Loss = 8.8848e-04, PNorm = 46.9101, GNorm = 0.9514, lr_0 = 2.1889e-04
Loss = 1.1704e-03, PNorm = 46.9187, GNorm = 0.8067, lr_0 = 2.0962e-04
Validation rmse = 1.178835
Epoch 20
Loss = 1.0206e-03, PNorm = 46.9272, GNorm = 0.4728, lr_0 = 2.0074e-04
Loss = 1.1302e-03, PNorm = 46.9354, GNorm = 1.8244, lr_0 = 1.9224e-04
Validation rmse = 1.054494
Epoch 21
Loss = 9.9520e-04, PNorm = 46.9433, GNorm = 0.9546, lr_0 = 1.8409e-04
Loss = 9.9565e-04, PNorm = 46.9522, GNorm = 1.5089, lr_0 = 1.7630e-04
Validation rmse = 1.023211
Epoch 22
Loss = 7.2681e-04, PNorm = 46.9609, GNorm = 0.7002, lr_0 = 1.6810e-04
Loss = 1.1291e-03, PNorm = 46.9680, GNorm = 1.0965, lr_0 = 1.6098e-04
Validation rmse = 0.995110
Epoch 23
Loss = 9.2399e-04, PNorm = 46.9749, GNorm = 0.5963, lr_0 = 1.5416e-04
Loss = 8.4802e-04, PNorm = 46.9817, GNorm = 1.1617, lr_0 = 1.4763e-04
Loss = 1.2568e-03, PNorm = 46.9824, GNorm = 0.8646, lr_0 = 1.4699e-04
Validation rmse = 1.083626
Epoch 24
Loss = 9.9314e-04, PNorm = 46.9878, GNorm = 0.5798, lr_0 = 1.4077e-04
Loss = 9.0780e-04, PNorm = 46.9943, GNorm = 1.0602, lr_0 = 1.3480e-04
Validation rmse = 1.064865
Epoch 25
Loss = 9.2316e-04, PNorm = 46.9990, GNorm = 1.0510, lr_0 = 1.2909e-04
Loss = 8.9428e-04, PNorm = 47.0046, GNorm = 0.5411, lr_0 = 1.2362e-04
Validation rmse = 1.069162
Epoch 26
Loss = 8.0848e-04, PNorm = 47.0104, GNorm = 1.3737, lr_0 = 1.1839e-04
Validation rmse = 1.043031
Epoch 27
Loss = 4.7016e-04, PNorm = 47.0159, GNorm = 0.9832, lr_0 = 1.1288e-04
Loss = 9.0315e-04, PNorm = 47.0207, GNorm = 0.9800, lr_0 = 1.0810e-04
Validation rmse = 1.017483
Epoch 28
Loss = 1.2313e-03, PNorm = 47.0254, GNorm = 0.9094, lr_0 = 1.0352e-04
Loss = 7.4740e-04, PNorm = 47.0303, GNorm = 0.3006, lr_0 = 1.0000e-04
Validation rmse = 1.007860
Epoch 29
Loss = 9.7318e-04, PNorm = 47.0354, GNorm = 1.4517, lr_0 = 1.0000e-04
Loss = 9.2193e-04, PNorm = 47.0404, GNorm = 0.3636, lr_0 = 1.0000e-04
Validation rmse = 1.099277
Model 0 best validation rmse = 0.995110 on epoch 22
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.881515
Ensemble test rmse = 0.881515
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total scaffolds = 195 | train scaffolds = 76 | val scaffolds = 60 | test scaffolds = 59
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=904, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,805
Moving model to cuda
Epoch 0
Loss = 1.7239e-02, PNorm = 46.0506, GNorm = 10.3094, lr_0 = 3.6053e-04
Validation rmse = 1.822641
Epoch 1
Loss = 8.1239e-03, PNorm = 46.0928, GNorm = 4.6428, lr_0 = 6.2105e-04
Loss = 7.1262e-03, PNorm = 46.1495, GNorm = 4.8298, lr_0 = 8.5789e-04
Validation rmse = 1.453524
Epoch 2
Loss = 4.8577e-03, PNorm = 46.2146, GNorm = 1.5324, lr_0 = 9.8284e-04
Loss = 4.1906e-03, PNorm = 46.2684, GNorm = 2.1093, lr_0 = 9.4120e-04
Validation rmse = 1.379676
Epoch 3
Loss = 3.5693e-03, PNorm = 46.3192, GNorm = 2.5737, lr_0 = 8.9744e-04
Loss = 3.6731e-03, PNorm = 46.3643, GNorm = 1.3511, lr_0 = 8.5943e-04
Validation rmse = 1.373077
Epoch 4
Loss = 1.8762e-03, PNorm = 46.4018, GNorm = 0.6667, lr_0 = 8.2303e-04
Loss = 2.3561e-03, PNorm = 46.4353, GNorm = 2.5417, lr_0 = 7.8816e-04
Validation rmse = 1.249095
Epoch 5
Loss = 1.7077e-03, PNorm = 46.4640, GNorm = 1.1049, lr_0 = 7.5478e-04
Loss = 2.3113e-03, PNorm = 46.4954, GNorm = 1.5175, lr_0 = 7.2281e-04
Validation rmse = 1.188767
Epoch 6
Loss = 1.9325e-03, PNorm = 46.5235, GNorm = 0.9741, lr_0 = 6.8920e-04
Loss = 2.2468e-03, PNorm = 46.5541, GNorm = 1.3331, lr_0 = 6.6001e-04
Validation rmse = 1.296022
Epoch 7
Loss = 2.1398e-03, PNorm = 46.5800, GNorm = 1.3794, lr_0 = 6.3205e-04
Loss = 2.2513e-03, PNorm = 46.6023, GNorm = 0.8015, lr_0 = 6.0528e-04
Validation rmse = 1.163992
Epoch 8
Loss = 1.8675e-03, PNorm = 46.6293, GNorm = 0.6246, lr_0 = 5.7714e-04
Loss = 1.4732e-03, PNorm = 46.6511, GNorm = 1.6546, lr_0 = 5.5269e-04
Validation rmse = 1.169559
Epoch 9
Loss = 1.2428e-03, PNorm = 46.6707, GNorm = 0.4681, lr_0 = 5.2928e-04
Loss = 1.5143e-03, PNorm = 46.6874, GNorm = 0.5162, lr_0 = 5.0686e-04
Validation rmse = 1.107089
Epoch 10
Loss = 1.1428e-03, PNorm = 46.7064, GNorm = 0.4270, lr_0 = 4.8539e-04
Loss = 1.1330e-03, PNorm = 46.7213, GNorm = 0.7263, lr_0 = 4.6483e-04
Validation rmse = 1.102698
Epoch 11
Loss = 1.8282e-03, PNorm = 46.7383, GNorm = 3.5064, lr_0 = 4.4322e-04
Loss = 1.6028e-03, PNorm = 46.7539, GNorm = 3.2252, lr_0 = 4.2444e-04
Validation rmse = 1.074069
Epoch 12
Loss = 1.0771e-03, PNorm = 46.7711, GNorm = 0.7020, lr_0 = 4.0646e-04
Loss = 1.4288e-03, PNorm = 46.7868, GNorm = 1.7202, lr_0 = 3.8925e-04
Validation rmse = 1.132715
Epoch 13
Loss = 1.6705e-03, PNorm = 46.8017, GNorm = 2.1374, lr_0 = 3.7276e-04
Loss = 1.3247e-03, PNorm = 46.8172, GNorm = 0.5079, lr_0 = 3.5697e-04
Validation rmse = 1.017173
Epoch 14
Loss = 1.1871e-03, PNorm = 46.8339, GNorm = 2.0233, lr_0 = 3.4037e-04
Loss = 1.3109e-03, PNorm = 46.8472, GNorm = 0.9304, lr_0 = 3.2596e-04
Validation rmse = 1.083858
Epoch 15
Loss = 1.4248e-03, PNorm = 46.8580, GNorm = 1.1829, lr_0 = 3.1215e-04
Loss = 1.0463e-03, PNorm = 46.8730, GNorm = 0.7585, lr_0 = 2.9893e-04
Validation rmse = 1.006347
Epoch 16
Loss = 9.0532e-04, PNorm = 46.8842, GNorm = 0.5695, lr_0 = 2.8503e-04
Loss = 1.2250e-03, PNorm = 46.8941, GNorm = 1.1607, lr_0 = 2.7295e-04
Validation rmse = 1.066551
Epoch 17
Loss = 1.0333e-03, PNorm = 46.9058, GNorm = 1.1546, lr_0 = 2.6139e-04
Loss = 1.1393e-03, PNorm = 46.9144, GNorm = 0.8409, lr_0 = 2.5032e-04
Validation rmse = 1.052254
Epoch 18
Loss = 1.0351e-03, PNorm = 46.9252, GNorm = 0.8942, lr_0 = 2.3972e-04
Loss = 1.0678e-03, PNorm = 46.9339, GNorm = 2.0410, lr_0 = 2.2956e-04
Validation rmse = 1.039204
Epoch 19
Loss = 7.4043e-04, PNorm = 46.9441, GNorm = 0.5009, lr_0 = 2.1889e-04
Loss = 1.0454e-03, PNorm = 46.9530, GNorm = 0.9495, lr_0 = 2.0962e-04
Validation rmse = 1.005603
Epoch 20
Loss = 8.3234e-04, PNorm = 46.9625, GNorm = 0.9143, lr_0 = 2.0074e-04
Loss = 9.9217e-04, PNorm = 46.9719, GNorm = 0.4473, lr_0 = 1.9224e-04
Validation rmse = 0.999179
Epoch 21
Loss = 8.3607e-04, PNorm = 46.9793, GNorm = 1.3368, lr_0 = 1.8409e-04
Loss = 1.0655e-03, PNorm = 46.9864, GNorm = 1.3148, lr_0 = 1.7630e-04
Validation rmse = 0.989737
Epoch 22
Loss = 8.9726e-04, PNorm = 46.9949, GNorm = 1.1379, lr_0 = 1.6810e-04
Loss = 8.3078e-04, PNorm = 47.0013, GNorm = 1.1958, lr_0 = 1.6098e-04
Validation rmse = 1.037980
Epoch 23
Loss = 9.6765e-04, PNorm = 47.0088, GNorm = 0.6317, lr_0 = 1.5416e-04
Loss = 8.4382e-04, PNorm = 47.0158, GNorm = 0.5761, lr_0 = 1.4763e-04
Loss = 1.3024e-03, PNorm = 47.0166, GNorm = 1.5727, lr_0 = 1.4699e-04
Validation rmse = 0.992096
Epoch 24
Loss = 9.9681e-04, PNorm = 47.0240, GNorm = 1.0820, lr_0 = 1.4077e-04
Loss = 7.7708e-04, PNorm = 47.0308, GNorm = 0.3891, lr_0 = 1.3480e-04
Validation rmse = 0.996656
Epoch 25
Loss = 7.7001e-04, PNorm = 47.0364, GNorm = 0.5307, lr_0 = 1.2909e-04
Loss = 9.1930e-04, PNorm = 47.0416, GNorm = 1.6530, lr_0 = 1.2362e-04
Validation rmse = 0.996793
Epoch 26
Loss = 8.8557e-04, PNorm = 47.0479, GNorm = 1.2702, lr_0 = 1.1839e-04
Validation rmse = 1.022450
Epoch 27
Loss = 9.2515e-04, PNorm = 47.0533, GNorm = 1.9275, lr_0 = 1.1288e-04
Loss = 8.1833e-04, PNorm = 47.0584, GNorm = 0.9785, lr_0 = 1.0810e-04
Validation rmse = 1.001090
Epoch 28
Loss = 4.7843e-04, PNorm = 47.0629, GNorm = 0.5302, lr_0 = 1.0352e-04
Loss = 8.2834e-04, PNorm = 47.0673, GNorm = 1.4167, lr_0 = 1.0000e-04
Validation rmse = 0.999972
Epoch 29
Loss = 5.2044e-04, PNorm = 47.0722, GNorm = 0.6287, lr_0 = 1.0000e-04
Loss = 7.7447e-04, PNorm = 47.0784, GNorm = 0.9736, lr_0 = 1.0000e-04
Validation rmse = 0.977297
Model 0 best validation rmse = 0.977297 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.041063
Ensemble test rmse = 1.041063
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total scaffolds = 195 | train scaffolds = 55 | val scaffolds = 64 | test scaffolds = 76
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=904, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,805
Moving model to cuda
Epoch 0
Loss = 1.4892e-02, PNorm = 46.0523, GNorm = 2.8702, lr_0 = 3.6053e-04
Validation rmse = 1.584358
Epoch 1
Loss = 6.2577e-03, PNorm = 46.0968, GNorm = 3.7916, lr_0 = 6.2105e-04
Loss = 7.5516e-03, PNorm = 46.1580, GNorm = 2.5778, lr_0 = 8.5789e-04
Validation rmse = 1.453994
Epoch 2
Loss = 7.2081e-03, PNorm = 46.2217, GNorm = 5.5573, lr_0 = 9.8284e-04
Loss = 4.4997e-03, PNorm = 46.2759, GNorm = 2.2992, lr_0 = 9.4120e-04
Validation rmse = 1.497090
Epoch 3
Loss = 4.5833e-03, PNorm = 46.3274, GNorm = 1.7427, lr_0 = 8.9744e-04
Loss = 3.9690e-03, PNorm = 46.3676, GNorm = 1.5827, lr_0 = 8.5943e-04
Validation rmse = 1.403415
Epoch 4
Loss = 2.0626e-03, PNorm = 46.4058, GNorm = 1.0477, lr_0 = 8.2303e-04
Loss = 2.9009e-03, PNorm = 46.4422, GNorm = 5.7538, lr_0 = 7.8816e-04
Validation rmse = 1.446075
Epoch 5
Loss = 1.9716e-03, PNorm = 46.4817, GNorm = 1.8514, lr_0 = 7.5478e-04
Loss = 2.3180e-03, PNorm = 46.5179, GNorm = 1.3725, lr_0 = 7.2281e-04
Validation rmse = 1.336493
Epoch 6
Loss = 1.5467e-03, PNorm = 46.5575, GNorm = 2.3006, lr_0 = 6.8920e-04
Loss = 2.0241e-03, PNorm = 46.5870, GNorm = 0.6387, lr_0 = 6.6001e-04
Validation rmse = 1.290749
Epoch 7
Loss = 1.8947e-03, PNorm = 46.6152, GNorm = 2.5497, lr_0 = 6.3205e-04
Loss = 1.3521e-03, PNorm = 46.6423, GNorm = 0.6558, lr_0 = 6.0528e-04
Validation rmse = 1.252697
Epoch 8
Loss = 1.8870e-03, PNorm = 46.6694, GNorm = 1.5400, lr_0 = 5.7714e-04
Loss = 1.8125e-03, PNorm = 46.6958, GNorm = 1.2870, lr_0 = 5.5269e-04
Validation rmse = 1.210709
Epoch 9
Loss = 1.5111e-03, PNorm = 46.7187, GNorm = 2.3598, lr_0 = 5.2928e-04
Loss = 1.4670e-03, PNorm = 46.7411, GNorm = 0.3808, lr_0 = 5.0686e-04
Validation rmse = 1.281413
Epoch 10
Loss = 1.4066e-03, PNorm = 46.7576, GNorm = 0.7935, lr_0 = 4.8539e-04
Loss = 1.4103e-03, PNorm = 46.7749, GNorm = 1.2443, lr_0 = 4.6483e-04
Validation rmse = 1.197973
Epoch 11
Loss = 1.8720e-03, PNorm = 46.7930, GNorm = 0.6440, lr_0 = 4.4322e-04
Loss = 1.6526e-03, PNorm = 46.8149, GNorm = 1.8689, lr_0 = 4.2444e-04
Validation rmse = 1.216243
Epoch 12
Loss = 1.3246e-03, PNorm = 46.8339, GNorm = 0.7180, lr_0 = 4.0646e-04
Loss = 1.3290e-03, PNorm = 46.8487, GNorm = 0.6845, lr_0 = 3.8925e-04
Validation rmse = 1.202502
Epoch 13
Loss = 1.7519e-03, PNorm = 46.8637, GNorm = 1.2835, lr_0 = 3.7276e-04
Loss = 1.4367e-03, PNorm = 46.8753, GNorm = 0.9986, lr_0 = 3.5697e-04
Validation rmse = 1.289488
Epoch 14
Loss = 1.6320e-03, PNorm = 46.8916, GNorm = 1.0951, lr_0 = 3.4037e-04
Loss = 1.1485e-03, PNorm = 46.9066, GNorm = 1.4627, lr_0 = 3.2596e-04
Validation rmse = 1.256137
Epoch 15
Loss = 1.2512e-03, PNorm = 46.9191, GNorm = 0.9071, lr_0 = 3.1215e-04
Loss = 1.1901e-03, PNorm = 46.9302, GNorm = 1.3003, lr_0 = 2.9893e-04
Validation rmse = 1.244691
Epoch 16
Loss = 1.0419e-03, PNorm = 46.9411, GNorm = 0.7175, lr_0 = 2.8503e-04
Loss = 1.1878e-03, PNorm = 46.9517, GNorm = 1.2368, lr_0 = 2.7295e-04
Validation rmse = 1.190193
Epoch 17
Loss = 1.2173e-03, PNorm = 46.9642, GNorm = 2.3960, lr_0 = 2.6139e-04
Loss = 1.2352e-03, PNorm = 46.9740, GNorm = 1.7295, lr_0 = 2.5032e-04
Validation rmse = 1.337111
Epoch 18
Loss = 1.0837e-03, PNorm = 46.9842, GNorm = 0.3550, lr_0 = 2.3972e-04
Loss = 1.0901e-03, PNorm = 46.9940, GNorm = 0.7949, lr_0 = 2.2956e-04
Validation rmse = 1.267931
Epoch 19
Loss = 1.3201e-03, PNorm = 47.0041, GNorm = 1.6691, lr_0 = 2.1889e-04
Loss = 9.8952e-04, PNorm = 47.0147, GNorm = 0.6161, lr_0 = 2.0962e-04
Validation rmse = 1.151586
Epoch 20
Loss = 9.6188e-04, PNorm = 47.0194, GNorm = 0.7331, lr_0 = 2.0074e-04
Loss = 1.0328e-03, PNorm = 47.0288, GNorm = 1.1682, lr_0 = 1.9224e-04
Validation rmse = 1.202472
Epoch 21
Loss = 1.0482e-03, PNorm = 47.0363, GNorm = 0.9792, lr_0 = 1.8409e-04
Loss = 1.0944e-03, PNorm = 47.0446, GNorm = 0.4507, lr_0 = 1.7630e-04
Validation rmse = 1.329811
Epoch 22
Loss = 1.1688e-03, PNorm = 47.0533, GNorm = 0.6211, lr_0 = 1.6810e-04
Loss = 8.6764e-04, PNorm = 47.0604, GNorm = 1.2532, lr_0 = 1.6098e-04
Validation rmse = 1.205709
Epoch 23
Loss = 7.1981e-04, PNorm = 47.0664, GNorm = 1.3983, lr_0 = 1.5416e-04
Loss = 1.0521e-03, PNorm = 47.0726, GNorm = 0.8120, lr_0 = 1.4763e-04
Loss = 2.7953e-03, PNorm = 47.0732, GNorm = 2.0639, lr_0 = 1.4699e-04
Validation rmse = 1.175520
Epoch 24
Loss = 7.8167e-04, PNorm = 47.0799, GNorm = 1.7736, lr_0 = 1.4077e-04
Loss = 1.0926e-03, PNorm = 47.0848, GNorm = 0.6865, lr_0 = 1.3480e-04
Validation rmse = 1.208772
Epoch 25
Loss = 1.0249e-03, PNorm = 47.0913, GNorm = 0.3387, lr_0 = 1.2909e-04
Loss = 7.7550e-04, PNorm = 47.0962, GNorm = 1.0730, lr_0 = 1.2362e-04
Validation rmse = 1.201228
Epoch 26
Loss = 9.0480e-04, PNorm = 47.1014, GNorm = 0.5818, lr_0 = 1.1839e-04
Validation rmse = 1.195167
Epoch 27
Loss = 4.8177e-04, PNorm = 47.1066, GNorm = 0.4599, lr_0 = 1.1288e-04
Loss = 8.4047e-04, PNorm = 47.1114, GNorm = 0.9898, lr_0 = 1.0810e-04
Validation rmse = 1.216403
Epoch 28
Loss = 8.0896e-04, PNorm = 47.1160, GNorm = 0.6655, lr_0 = 1.0352e-04
Loss = 7.5195e-04, PNorm = 47.1208, GNorm = 0.7837, lr_0 = 1.0000e-04
Validation rmse = 1.171388
Epoch 29
Loss = 8.1156e-04, PNorm = 47.1265, GNorm = 0.9939, lr_0 = 1.0000e-04
Loss = 9.2960e-04, PNorm = 47.1301, GNorm = 0.8952, lr_0 = 1.0000e-04
Validation rmse = 1.168199
Model 0 best validation rmse = 1.151586 on epoch 19
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.084966
Ensemble test rmse = 1.084966
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total scaffolds = 195 | train scaffolds = 80 | val scaffolds = 54 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=904, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,805
Moving model to cuda
Epoch 0
Loss = 1.8375e-02, PNorm = 46.0507, GNorm = 22.8442, lr_0 = 3.6053e-04
Validation rmse = 1.627645
Epoch 1
Loss = 7.6933e-03, PNorm = 46.0910, GNorm = 4.6013, lr_0 = 6.2105e-04
Loss = 7.3345e-03, PNorm = 46.1544, GNorm = 6.2166, lr_0 = 8.5789e-04
Validation rmse = 1.538393
Epoch 2
Loss = 6.5827e-03, PNorm = 46.2127, GNorm = 4.9064, lr_0 = 9.8284e-04
Loss = 4.7566e-03, PNorm = 46.2734, GNorm = 2.1032, lr_0 = 9.4120e-04
Validation rmse = 1.304865
Epoch 3
Loss = 3.7730e-03, PNorm = 46.3247, GNorm = 2.1402, lr_0 = 8.9744e-04
Loss = 4.1018e-03, PNorm = 46.3661, GNorm = 2.2929, lr_0 = 8.5943e-04
Validation rmse = 1.498421
Epoch 4
Loss = 2.3830e-03, PNorm = 46.4031, GNorm = 1.5744, lr_0 = 8.2303e-04
Loss = 3.4409e-03, PNorm = 46.4423, GNorm = 3.1535, lr_0 = 7.8816e-04
Validation rmse = 1.246992
Epoch 5
Loss = 2.3860e-03, PNorm = 46.4825, GNorm = 1.3247, lr_0 = 7.5478e-04
Loss = 2.1179e-03, PNorm = 46.5147, GNorm = 0.9093, lr_0 = 7.2281e-04
Validation rmse = 1.244773
Epoch 6
Loss = 2.0358e-03, PNorm = 46.5467, GNorm = 0.7369, lr_0 = 6.8920e-04
Loss = 1.9620e-03, PNorm = 46.5745, GNorm = 2.2595, lr_0 = 6.6001e-04
Validation rmse = 1.176336
Epoch 7
Loss = 1.6387e-03, PNorm = 46.6005, GNorm = 1.6740, lr_0 = 6.3205e-04
Loss = 1.5571e-03, PNorm = 46.6259, GNorm = 1.8227, lr_0 = 6.0528e-04
Validation rmse = 1.128953
Epoch 8
Loss = 1.6324e-03, PNorm = 46.6574, GNorm = 0.7731, lr_0 = 5.7714e-04
Loss = 1.4701e-03, PNorm = 46.6816, GNorm = 1.5339, lr_0 = 5.5269e-04
Validation rmse = 1.407236
Epoch 9
Loss = 1.6029e-03, PNorm = 46.7032, GNorm = 1.5243, lr_0 = 5.2928e-04
Loss = 1.4476e-03, PNorm = 46.7255, GNorm = 0.9546, lr_0 = 5.0686e-04
Validation rmse = 1.109694
Epoch 10
Loss = 1.4159e-03, PNorm = 46.7460, GNorm = 1.4663, lr_0 = 4.8539e-04
Loss = 1.2701e-03, PNorm = 46.7661, GNorm = 0.9415, lr_0 = 4.6483e-04
Validation rmse = 1.200069
Epoch 11
Loss = 1.1975e-03, PNorm = 46.7873, GNorm = 1.7656, lr_0 = 4.4322e-04
Loss = 1.4805e-03, PNorm = 46.8044, GNorm = 0.6853, lr_0 = 4.2444e-04
Validation rmse = 1.142762
Epoch 12
Loss = 1.2168e-03, PNorm = 46.8229, GNorm = 2.5655, lr_0 = 4.0646e-04
Loss = 1.0660e-03, PNorm = 46.8408, GNorm = 0.9841, lr_0 = 3.8925e-04
Validation rmse = 1.126878
Epoch 13
Loss = 1.0793e-03, PNorm = 46.8542, GNorm = 1.1548, lr_0 = 3.7276e-04
Loss = 1.0816e-03, PNorm = 46.8689, GNorm = 0.7200, lr_0 = 3.5697e-04
Validation rmse = 1.164345
Epoch 14
Loss = 1.0912e-03, PNorm = 46.8839, GNorm = 3.0027, lr_0 = 3.4037e-04
Loss = 1.0602e-03, PNorm = 46.8983, GNorm = 0.4848, lr_0 = 3.2596e-04
Validation rmse = 1.241765
Epoch 15
Loss = 1.0790e-03, PNorm = 46.9122, GNorm = 1.3337, lr_0 = 3.1215e-04
Loss = 9.7999e-04, PNorm = 46.9254, GNorm = 0.4868, lr_0 = 2.9893e-04
Validation rmse = 1.114801
Epoch 16
Loss = 1.0163e-03, PNorm = 46.9412, GNorm = 1.4063, lr_0 = 2.8503e-04
Loss = 1.0631e-03, PNorm = 46.9553, GNorm = 1.4230, lr_0 = 2.7295e-04
Validation rmse = 1.128909
Epoch 17
Loss = 7.9765e-04, PNorm = 46.9682, GNorm = 0.6442, lr_0 = 2.6139e-04
Loss = 9.1639e-04, PNorm = 46.9801, GNorm = 0.5858, lr_0 = 2.5032e-04
Validation rmse = 1.231687
Epoch 18
Loss = 9.6015e-04, PNorm = 46.9910, GNorm = 2.0700, lr_0 = 2.3972e-04
Loss = 8.8934e-04, PNorm = 47.0014, GNorm = 1.8296, lr_0 = 2.2956e-04
Validation rmse = 1.176322
Epoch 19
Loss = 8.9746e-04, PNorm = 47.0127, GNorm = 0.8309, lr_0 = 2.1889e-04
Loss = 8.5422e-04, PNorm = 47.0227, GNorm = 0.6204, lr_0 = 2.0962e-04
Validation rmse = 1.126866
Epoch 20
Loss = 8.1313e-04, PNorm = 47.0291, GNorm = 0.9978, lr_0 = 2.0074e-04
Loss = 8.6190e-04, PNorm = 47.0378, GNorm = 0.8847, lr_0 = 1.9224e-04
Validation rmse = 1.176449
Epoch 21
Loss = 7.4488e-04, PNorm = 47.0461, GNorm = 0.3930, lr_0 = 1.8409e-04
Loss = 8.2102e-04, PNorm = 47.0541, GNorm = 1.5257, lr_0 = 1.7630e-04
Validation rmse = 1.145129
Epoch 22
Loss = 8.6050e-04, PNorm = 47.0633, GNorm = 0.8063, lr_0 = 1.6810e-04
Loss = 7.3255e-04, PNorm = 47.0703, GNorm = 0.2541, lr_0 = 1.6098e-04
Validation rmse = 1.166133
Epoch 23
Loss = 7.3042e-04, PNorm = 47.0764, GNorm = 0.5131, lr_0 = 1.5416e-04
Loss = 7.1811e-04, PNorm = 47.0830, GNorm = 0.5620, lr_0 = 1.4763e-04
Loss = 7.8899e-04, PNorm = 47.0837, GNorm = 0.4466, lr_0 = 1.4699e-04
Validation rmse = 1.130915
Epoch 24
Loss = 7.0651e-04, PNorm = 47.0897, GNorm = 0.6485, lr_0 = 1.4077e-04
Loss = 7.3322e-04, PNorm = 47.0969, GNorm = 0.5491, lr_0 = 1.3480e-04
Validation rmse = 1.179027
Epoch 25
Loss = 7.3015e-04, PNorm = 47.1017, GNorm = 0.4714, lr_0 = 1.2909e-04
Loss = 7.4797e-04, PNorm = 47.1073, GNorm = 1.2728, lr_0 = 1.2362e-04
Validation rmse = 1.141398
Epoch 26
Loss = 7.2610e-04, PNorm = 47.1117, GNorm = 0.7536, lr_0 = 1.1839e-04
Validation rmse = 1.196328
Epoch 27
Loss = 1.1741e-03, PNorm = 47.1179, GNorm = 0.4594, lr_0 = 1.1288e-04
Loss = 6.7359e-04, PNorm = 47.1238, GNorm = 0.4673, lr_0 = 1.0810e-04
Validation rmse = 1.154413
Epoch 28
Loss = 6.0293e-04, PNorm = 47.1271, GNorm = 0.6462, lr_0 = 1.0352e-04
Loss = 6.6575e-04, PNorm = 47.1313, GNorm = 0.4574, lr_0 = 1.0000e-04
Validation rmse = 1.147540
Epoch 29
Loss = 6.4299e-04, PNorm = 47.1355, GNorm = 0.3102, lr_0 = 1.0000e-04
Loss = 6.7586e-04, PNorm = 47.1404, GNorm = 1.1315, lr_0 = 1.0000e-04
Validation rmse = 1.152833
Model 0 best validation rmse = 1.109694 on epoch 9
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.149219
Ensemble test rmse = 1.149219
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 49 | test scaffolds = 62
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=904, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,805
Moving model to cuda
Epoch 0
Loss = 1.8445e-02, PNorm = 46.0500, GNorm = 5.4154, lr_0 = 3.6053e-04
Validation rmse = 1.389579
Epoch 1
Loss = 8.8558e-03, PNorm = 46.0973, GNorm = 2.0268, lr_0 = 6.2105e-04
Loss = 6.1440e-03, PNorm = 46.1549, GNorm = 1.2537, lr_0 = 8.5789e-04
Validation rmse = 1.595045
Epoch 2
Loss = 5.5989e-03, PNorm = 46.2195, GNorm = 6.3486, lr_0 = 9.8284e-04
Loss = 5.7870e-03, PNorm = 46.2720, GNorm = 3.4814, lr_0 = 9.4120e-04
Validation rmse = 1.390981
Epoch 3
Loss = 3.7367e-03, PNorm = 46.3295, GNorm = 2.8055, lr_0 = 8.9744e-04
Loss = 3.2784e-03, PNorm = 46.3661, GNorm = 2.2006, lr_0 = 8.5943e-04
Validation rmse = 1.284714
Epoch 4
Loss = 3.6705e-03, PNorm = 46.4037, GNorm = 3.9065, lr_0 = 8.2303e-04
Loss = 2.5112e-03, PNorm = 46.4401, GNorm = 2.1195, lr_0 = 7.8816e-04
Validation rmse = 1.446647
Epoch 5
Loss = 2.6580e-03, PNorm = 46.4703, GNorm = 2.8305, lr_0 = 7.5478e-04
Loss = 2.3916e-03, PNorm = 46.5008, GNorm = 3.5106, lr_0 = 7.2281e-04
Validation rmse = 1.083094
Epoch 6
Loss = 1.3213e-03, PNorm = 46.5359, GNorm = 1.0584, lr_0 = 6.8920e-04
Loss = 1.8780e-03, PNorm = 46.5635, GNorm = 2.1488, lr_0 = 6.6001e-04
Validation rmse = 1.018744
Epoch 7
Loss = 1.2266e-03, PNorm = 46.5884, GNorm = 2.1431, lr_0 = 6.3205e-04
Loss = 2.2713e-03, PNorm = 46.6151, GNorm = 0.6915, lr_0 = 6.0528e-04
Validation rmse = 1.191311
Epoch 8
Loss = 1.5645e-03, PNorm = 46.6394, GNorm = 0.8222, lr_0 = 5.7714e-04
Loss = 1.6847e-03, PNorm = 46.6585, GNorm = 1.4263, lr_0 = 5.5269e-04
Validation rmse = 1.072176
Epoch 9
Loss = 1.1279e-03, PNorm = 46.6808, GNorm = 0.6212, lr_0 = 5.2928e-04
Loss = 1.6708e-03, PNorm = 46.6974, GNorm = 0.8761, lr_0 = 5.0686e-04
Validation rmse = 1.007474
Epoch 10
Loss = 1.6018e-03, PNorm = 46.7149, GNorm = 1.7766, lr_0 = 4.8539e-04
Loss = 1.6079e-03, PNorm = 46.7320, GNorm = 1.2350, lr_0 = 4.6483e-04
Validation rmse = 1.378394
Epoch 11
Loss = 1.5101e-03, PNorm = 46.7485, GNorm = 0.9216, lr_0 = 4.4322e-04
Loss = 1.2273e-03, PNorm = 46.7620, GNorm = 0.6102, lr_0 = 4.2444e-04
Validation rmse = 1.080651
Epoch 12
Loss = 9.3946e-04, PNorm = 46.7737, GNorm = 0.3618, lr_0 = 4.0646e-04
Loss = 1.2272e-03, PNorm = 46.7873, GNorm = 0.5732, lr_0 = 3.8925e-04
Validation rmse = 1.061995
Epoch 13
Loss = 1.0402e-03, PNorm = 46.8006, GNorm = 0.9578, lr_0 = 3.7276e-04
Loss = 1.4037e-03, PNorm = 46.8149, GNorm = 0.9942, lr_0 = 3.5697e-04
Validation rmse = 0.991165
Epoch 14
Loss = 1.0476e-03, PNorm = 46.8267, GNorm = 1.4179, lr_0 = 3.4037e-04
Loss = 1.3334e-03, PNorm = 46.8374, GNorm = 2.3443, lr_0 = 3.2596e-04
Validation rmse = 0.980406
Epoch 15
Loss = 8.9868e-04, PNorm = 46.8486, GNorm = 0.4542, lr_0 = 3.1215e-04
Loss = 1.3172e-03, PNorm = 46.8593, GNorm = 1.2083, lr_0 = 2.9893e-04
Validation rmse = 0.971556
Epoch 16
Loss = 1.0437e-03, PNorm = 46.8715, GNorm = 1.8018, lr_0 = 2.8503e-04
Loss = 1.3409e-03, PNorm = 46.8811, GNorm = 0.5216, lr_0 = 2.7295e-04
Validation rmse = 0.942907
Epoch 17
Loss = 9.3603e-04, PNorm = 46.8918, GNorm = 1.0074, lr_0 = 2.6139e-04
Loss = 1.1146e-03, PNorm = 46.9015, GNorm = 0.8424, lr_0 = 2.5032e-04
Validation rmse = 1.051117
Epoch 18
Loss = 1.2050e-03, PNorm = 46.9117, GNorm = 1.5815, lr_0 = 2.3972e-04
Loss = 9.7075e-04, PNorm = 46.9224, GNorm = 0.6457, lr_0 = 2.2956e-04
Validation rmse = 0.998992
Epoch 19
Loss = 9.5342e-04, PNorm = 46.9309, GNorm = 0.5630, lr_0 = 2.1889e-04
Loss = 1.0445e-03, PNorm = 46.9403, GNorm = 0.5326, lr_0 = 2.0962e-04
Validation rmse = 0.993711
Epoch 20
Loss = 1.0082e-03, PNorm = 46.9484, GNorm = 0.4652, lr_0 = 2.0074e-04
Loss = 1.0159e-03, PNorm = 46.9566, GNorm = 0.7973, lr_0 = 1.9224e-04
Validation rmse = 1.148780
Epoch 21
Loss = 8.6314e-04, PNorm = 46.9633, GNorm = 1.1862, lr_0 = 1.8409e-04
Loss = 1.1067e-03, PNorm = 46.9710, GNorm = 1.5310, lr_0 = 1.7630e-04
Validation rmse = 0.995973
Epoch 22
Loss = 8.1162e-04, PNorm = 46.9790, GNorm = 1.1387, lr_0 = 1.6810e-04
Loss = 1.1232e-03, PNorm = 46.9866, GNorm = 1.2446, lr_0 = 1.6098e-04
Validation rmse = 1.013012
Epoch 23
Loss = 9.9476e-04, PNorm = 46.9921, GNorm = 1.5219, lr_0 = 1.5416e-04
Loss = 8.5947e-04, PNorm = 46.9989, GNorm = 0.8359, lr_0 = 1.4763e-04
Loss = 1.3458e-03, PNorm = 46.9995, GNorm = 0.8891, lr_0 = 1.4699e-04
Validation rmse = 0.931516
Epoch 24
Loss = 8.3483e-04, PNorm = 47.0043, GNorm = 0.4293, lr_0 = 1.4077e-04
Loss = 9.9422e-04, PNorm = 47.0101, GNorm = 0.8549, lr_0 = 1.3480e-04
Validation rmse = 0.997486
Epoch 25
Loss = 7.7060e-04, PNorm = 47.0149, GNorm = 1.5553, lr_0 = 1.2909e-04
Loss = 1.0491e-03, PNorm = 47.0197, GNorm = 1.3762, lr_0 = 1.2362e-04
Validation rmse = 0.941954
Epoch 26
Loss = 8.0122e-04, PNorm = 47.0255, GNorm = 0.4528, lr_0 = 1.1839e-04
Validation rmse = 0.949664
Epoch 27
Loss = 6.2306e-04, PNorm = 47.0310, GNorm = 0.6465, lr_0 = 1.1288e-04
Loss = 7.4641e-04, PNorm = 47.0344, GNorm = 1.1690, lr_0 = 1.0810e-04
Validation rmse = 0.926837
Epoch 28
Loss = 5.7059e-04, PNorm = 47.0399, GNorm = 1.4708, lr_0 = 1.0352e-04
Loss = 8.3986e-04, PNorm = 47.0440, GNorm = 0.8356, lr_0 = 1.0000e-04
Validation rmse = 0.996426
Epoch 29
Loss = 6.1674e-04, PNorm = 47.0481, GNorm = 0.9990, lr_0 = 1.0000e-04
Loss = 7.9437e-04, PNorm = 47.0526, GNorm = 0.6032, lr_0 = 1.0000e-04
Validation rmse = 0.922839
Model 0 best validation rmse = 0.922839 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.163225
Ensemble test rmse = 1.163225
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total scaffolds = 195 | train scaffolds = 94 | val scaffolds = 55 | test scaffolds = 46
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=904, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,805
Moving model to cuda
Epoch 0
Loss = 1.7863e-02, PNorm = 46.0504, GNorm = 3.9817, lr_0 = 3.6053e-04
Validation rmse = 1.752179
Epoch 1
Loss = 4.5511e-03, PNorm = 46.0993, GNorm = 0.9723, lr_0 = 6.2105e-04
Loss = 5.4139e-03, PNorm = 46.1470, GNorm = 1.9726, lr_0 = 8.5789e-04
Validation rmse = 1.579685
Epoch 2
Loss = 4.1567e-03, PNorm = 46.2095, GNorm = 2.3462, lr_0 = 9.8284e-04
Loss = 4.4699e-03, PNorm = 46.2651, GNorm = 5.1435, lr_0 = 9.4120e-04
Validation rmse = 1.830780
Epoch 3
Loss = 6.2654e-03, PNorm = 46.3163, GNorm = 6.0959, lr_0 = 8.9744e-04
Loss = 3.7901e-03, PNorm = 46.3617, GNorm = 3.4076, lr_0 = 8.5943e-04
Validation rmse = 1.492667
Epoch 4
Loss = 2.5098e-03, PNorm = 46.3990, GNorm = 1.1887, lr_0 = 8.2303e-04
Loss = 2.7818e-03, PNorm = 46.4416, GNorm = 3.0180, lr_0 = 7.8816e-04
Validation rmse = 1.384536
Epoch 5
Loss = 2.7689e-03, PNorm = 46.4779, GNorm = 3.7654, lr_0 = 7.5478e-04
Loss = 2.0806e-03, PNorm = 46.5128, GNorm = 0.7655, lr_0 = 7.2281e-04
Validation rmse = 1.294424
Epoch 6
Loss = 2.4239e-03, PNorm = 46.5465, GNorm = 1.6950, lr_0 = 6.8920e-04
Loss = 2.1235e-03, PNorm = 46.5821, GNorm = 3.6739, lr_0 = 6.6001e-04
Validation rmse = 1.308338
Epoch 7
Loss = 1.8976e-03, PNorm = 46.6088, GNorm = 1.4639, lr_0 = 6.3205e-04
Loss = 1.5274e-03, PNorm = 46.6372, GNorm = 0.9095, lr_0 = 6.0528e-04
Validation rmse = 1.228942
Epoch 8
Loss = 1.8705e-03, PNorm = 46.6599, GNorm = 1.8495, lr_0 = 5.7714e-04
Loss = 2.0150e-03, PNorm = 46.6872, GNorm = 1.9482, lr_0 = 5.5269e-04
Validation rmse = 1.255814
Epoch 9
Loss = 1.8899e-03, PNorm = 46.7095, GNorm = 1.3089, lr_0 = 5.2928e-04
Loss = 1.8209e-03, PNorm = 46.7328, GNorm = 1.0931, lr_0 = 5.0686e-04
Validation rmse = 1.170375
Epoch 10
Loss = 1.4025e-03, PNorm = 46.7548, GNorm = 1.0267, lr_0 = 4.8539e-04
Loss = 1.5079e-03, PNorm = 46.7749, GNorm = 1.4089, lr_0 = 4.6483e-04
Validation rmse = 1.239593
Epoch 11
Loss = 1.1768e-03, PNorm = 46.7941, GNorm = 0.6447, lr_0 = 4.4322e-04
Loss = 1.2255e-03, PNorm = 46.8124, GNorm = 1.4164, lr_0 = 4.2444e-04
Validation rmse = 1.149015
Epoch 12
Loss = 9.4278e-04, PNorm = 46.8272, GNorm = 1.0166, lr_0 = 4.0646e-04
Loss = 1.4785e-03, PNorm = 46.8425, GNorm = 0.6690, lr_0 = 3.8925e-04
Validation rmse = 1.148182
Epoch 13
Loss = 1.0513e-03, PNorm = 46.8554, GNorm = 1.6882, lr_0 = 3.7276e-04
Loss = 1.1068e-03, PNorm = 46.8659, GNorm = 0.6719, lr_0 = 3.5697e-04
Validation rmse = 1.141732
Epoch 14
Loss = 1.2780e-03, PNorm = 46.8821, GNorm = 1.2136, lr_0 = 3.4037e-04
Loss = 1.0602e-03, PNorm = 46.8945, GNorm = 1.3636, lr_0 = 3.2596e-04
Validation rmse = 1.126100
Epoch 15
Loss = 1.2066e-03, PNorm = 46.9078, GNorm = 1.7308, lr_0 = 3.1215e-04
Loss = 1.1829e-03, PNorm = 46.9228, GNorm = 0.7890, lr_0 = 2.9893e-04
Validation rmse = 1.116517
Epoch 16
Loss = 9.9799e-04, PNorm = 46.9354, GNorm = 0.3853, lr_0 = 2.8503e-04
Loss = 1.1278e-03, PNorm = 46.9473, GNorm = 1.4598, lr_0 = 2.7295e-04
Validation rmse = 1.218341
Epoch 17
Loss = 1.0346e-03, PNorm = 46.9579, GNorm = 0.7085, lr_0 = 2.6139e-04
Loss = 9.5735e-04, PNorm = 46.9671, GNorm = 0.3923, lr_0 = 2.5032e-04
Validation rmse = 1.110927
Epoch 18
Loss = 8.9885e-04, PNorm = 46.9774, GNorm = 0.7911, lr_0 = 2.3972e-04
Loss = 9.8690e-04, PNorm = 46.9890, GNorm = 1.1438, lr_0 = 2.2956e-04
Validation rmse = 1.138753
Epoch 19
Loss = 8.7999e-04, PNorm = 46.9992, GNorm = 0.9578, lr_0 = 2.1889e-04
Loss = 1.1119e-03, PNorm = 47.0083, GNorm = 0.4654, lr_0 = 2.0962e-04
Validation rmse = 1.197395
Epoch 20
Loss = 9.5166e-04, PNorm = 47.0182, GNorm = 0.4439, lr_0 = 2.0074e-04
Loss = 1.0379e-03, PNorm = 47.0276, GNorm = 0.9293, lr_0 = 1.9224e-04
Validation rmse = 1.088520
Epoch 21
Loss = 7.7140e-04, PNorm = 47.0364, GNorm = 1.5388, lr_0 = 1.8409e-04
Loss = 1.0040e-03, PNorm = 47.0449, GNorm = 1.2157, lr_0 = 1.7630e-04
Validation rmse = 1.076436
Epoch 22
Loss = 8.1139e-04, PNorm = 47.0533, GNorm = 0.5707, lr_0 = 1.6810e-04
Loss = 9.9616e-04, PNorm = 47.0617, GNorm = 1.2813, lr_0 = 1.6098e-04
Validation rmse = 1.118582
Epoch 23
Loss = 9.1533e-04, PNorm = 47.0691, GNorm = 0.5600, lr_0 = 1.5416e-04
Loss = 7.9157e-04, PNorm = 47.0750, GNorm = 0.7539, lr_0 = 1.4763e-04
Loss = 8.0754e-04, PNorm = 47.0756, GNorm = 0.6431, lr_0 = 1.4699e-04
Validation rmse = 1.127130
Epoch 24
Loss = 9.0219e-04, PNorm = 47.0823, GNorm = 0.8953, lr_0 = 1.4077e-04
Loss = 1.0070e-03, PNorm = 47.0888, GNorm = 0.5833, lr_0 = 1.3480e-04
Validation rmse = 1.195486
Epoch 25
Loss = 8.1272e-04, PNorm = 47.0954, GNorm = 1.3717, lr_0 = 1.2909e-04
Loss = 9.5192e-04, PNorm = 47.1011, GNorm = 1.2823, lr_0 = 1.2362e-04
Validation rmse = 1.113382
Epoch 26
Loss = 7.6155e-04, PNorm = 47.1076, GNorm = 0.6642, lr_0 = 1.1839e-04
Validation rmse = 1.108714
Epoch 27
Loss = 1.1438e-03, PNorm = 47.1143, GNorm = 1.1586, lr_0 = 1.1288e-04
Loss = 7.1901e-04, PNorm = 47.1206, GNorm = 0.7026, lr_0 = 1.0810e-04
Validation rmse = 1.045951
Epoch 28
Loss = 6.8080e-04, PNorm = 47.1248, GNorm = 0.6169, lr_0 = 1.0352e-04
Loss = 8.3857e-04, PNorm = 47.1291, GNorm = 1.1967, lr_0 = 1.0000e-04
Validation rmse = 1.065033
Epoch 29
Loss = 7.6609e-04, PNorm = 47.1338, GNorm = 0.4945, lr_0 = 1.0000e-04
Loss = 8.1627e-04, PNorm = 47.1386, GNorm = 0.3186, lr_0 = 1.0000e-04
Validation rmse = 1.065544
Model 0 best validation rmse = 1.045951 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.145023
Ensemble test rmse = 1.145023
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total scaffolds = 195 | train scaffolds = 64 | val scaffolds = 68 | test scaffolds = 63
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=904, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,805
Moving model to cuda
Epoch 0
Loss = 1.8458e-02, PNorm = 46.0509, GNorm = 9.6514, lr_0 = 3.6053e-04
Validation rmse = 1.767470
Epoch 1
Loss = 5.6725e-03, PNorm = 46.0943, GNorm = 1.7231, lr_0 = 6.2105e-04
Loss = 5.8999e-03, PNorm = 46.1487, GNorm = 2.7146, lr_0 = 8.5789e-04
Validation rmse = 1.647113
Epoch 2
Loss = 4.9496e-03, PNorm = 46.2083, GNorm = 2.2920, lr_0 = 9.8284e-04
Loss = 4.9191e-03, PNorm = 46.2624, GNorm = 6.2421, lr_0 = 9.4120e-04
Validation rmse = 1.477019
Epoch 3
Loss = 3.7044e-03, PNorm = 46.3122, GNorm = 1.8999, lr_0 = 8.9744e-04
Loss = 3.0599e-03, PNorm = 46.3556, GNorm = 2.5773, lr_0 = 8.5943e-04
Validation rmse = 1.419802
Epoch 4
Loss = 2.2736e-03, PNorm = 46.3985, GNorm = 0.7572, lr_0 = 8.2303e-04
Loss = 3.1927e-03, PNorm = 46.4467, GNorm = 0.8089, lr_0 = 7.8816e-04
Validation rmse = 1.432721
Epoch 5
Loss = 2.2648e-03, PNorm = 46.4798, GNorm = 1.3072, lr_0 = 7.5478e-04
Loss = 2.5995e-03, PNorm = 46.5114, GNorm = 1.3963, lr_0 = 7.2281e-04
Validation rmse = 1.275787
Epoch 6
Loss = 1.6718e-03, PNorm = 46.5462, GNorm = 2.3072, lr_0 = 6.8920e-04
Loss = 1.9834e-03, PNorm = 46.5784, GNorm = 1.2709, lr_0 = 6.6001e-04
Validation rmse = 1.271414
Epoch 7
Loss = 2.1415e-03, PNorm = 46.6042, GNorm = 2.5091, lr_0 = 6.3205e-04
Loss = 1.5894e-03, PNorm = 46.6281, GNorm = 0.6843, lr_0 = 6.0528e-04
Validation rmse = 1.348424
Epoch 8
Loss = 1.7706e-03, PNorm = 46.6535, GNorm = 2.0838, lr_0 = 5.7714e-04
Loss = 1.8638e-03, PNorm = 46.6790, GNorm = 0.5664, lr_0 = 5.5269e-04
Validation rmse = 1.319714
Epoch 9
Loss = 1.5527e-03, PNorm = 46.7012, GNorm = 3.1174, lr_0 = 5.2928e-04
Loss = 1.3785e-03, PNorm = 46.7227, GNorm = 1.3949, lr_0 = 5.0686e-04
Validation rmse = 1.172877
Epoch 10
Loss = 1.5665e-03, PNorm = 46.7473, GNorm = 1.1123, lr_0 = 4.8539e-04
Loss = 1.2265e-03, PNorm = 46.7666, GNorm = 0.5653, lr_0 = 4.6483e-04
Validation rmse = 1.092522
Epoch 11
Loss = 1.5738e-03, PNorm = 46.7860, GNorm = 0.4709, lr_0 = 4.4322e-04
Loss = 1.1729e-03, PNorm = 46.8016, GNorm = 1.9665, lr_0 = 4.2444e-04
Validation rmse = 1.111697
Epoch 12
Loss = 1.0487e-03, PNorm = 46.8167, GNorm = 0.5337, lr_0 = 4.0646e-04
Loss = 1.2972e-03, PNorm = 46.8310, GNorm = 1.5467, lr_0 = 3.8925e-04
Validation rmse = 1.134301
Epoch 13
Loss = 1.0251e-03, PNorm = 46.8466, GNorm = 0.4304, lr_0 = 3.7276e-04
Loss = 1.1827e-03, PNorm = 46.8641, GNorm = 0.9521, lr_0 = 3.5697e-04
Validation rmse = 1.151368
Epoch 14
Loss = 8.4013e-04, PNorm = 46.8794, GNorm = 1.2168, lr_0 = 3.4037e-04
Loss = 1.1470e-03, PNorm = 46.8939, GNorm = 0.8242, lr_0 = 3.2596e-04
Validation rmse = 1.091327
Epoch 15
Loss = 1.0285e-03, PNorm = 46.9058, GNorm = 0.9352, lr_0 = 3.1215e-04
Loss = 9.7387e-04, PNorm = 46.9181, GNorm = 1.0119, lr_0 = 2.9893e-04
Validation rmse = 1.248300
Epoch 16
Loss = 1.2029e-03, PNorm = 46.9323, GNorm = 1.2823, lr_0 = 2.8503e-04
Loss = 9.4782e-04, PNorm = 46.9430, GNorm = 1.2972, lr_0 = 2.7295e-04
Validation rmse = 1.186950
Epoch 17
Loss = 9.0863e-04, PNorm = 46.9542, GNorm = 0.3317, lr_0 = 2.6139e-04
Loss = 9.5504e-04, PNorm = 46.9626, GNorm = 1.5832, lr_0 = 2.5032e-04
Validation rmse = 1.213120
Epoch 18
Loss = 1.2349e-03, PNorm = 46.9727, GNorm = 1.4183, lr_0 = 2.3972e-04
Loss = 8.3549e-04, PNorm = 46.9815, GNorm = 0.8132, lr_0 = 2.2956e-04
Validation rmse = 1.146216
Epoch 19
Loss = 8.9060e-04, PNorm = 46.9927, GNorm = 0.8922, lr_0 = 2.1889e-04
Loss = 9.2315e-04, PNorm = 47.0026, GNorm = 0.8788, lr_0 = 2.0962e-04
Validation rmse = 1.081778
Epoch 20
Loss = 8.8188e-04, PNorm = 47.0109, GNorm = 0.5504, lr_0 = 2.0074e-04
Loss = 8.0724e-04, PNorm = 47.0191, GNorm = 0.4293, lr_0 = 1.9224e-04
Validation rmse = 1.126891
Epoch 21
Loss = 8.2856e-04, PNorm = 47.0284, GNorm = 1.3238, lr_0 = 1.8409e-04
Loss = 9.1708e-04, PNorm = 47.0373, GNorm = 0.7146, lr_0 = 1.7630e-04
Validation rmse = 1.166495
Epoch 22
Loss = 9.4088e-04, PNorm = 47.0455, GNorm = 0.4828, lr_0 = 1.6810e-04
Loss = 7.6463e-04, PNorm = 47.0525, GNorm = 0.9531, lr_0 = 1.6098e-04
Validation rmse = 1.127919
Epoch 23
Loss = 7.8298e-04, PNorm = 47.0595, GNorm = 0.5159, lr_0 = 1.5416e-04
Loss = 7.6158e-04, PNorm = 47.0657, GNorm = 0.6279, lr_0 = 1.4763e-04
Loss = 1.3872e-03, PNorm = 47.0664, GNorm = 0.8280, lr_0 = 1.4699e-04
Validation rmse = 1.063526
Epoch 24
Loss = 8.1745e-04, PNorm = 47.0723, GNorm = 0.3742, lr_0 = 1.4077e-04
Loss = 8.2956e-04, PNorm = 47.0775, GNorm = 0.4261, lr_0 = 1.3480e-04
Validation rmse = 1.075825
Epoch 25
Loss = 7.1329e-04, PNorm = 47.0826, GNorm = 1.0446, lr_0 = 1.2909e-04
Loss = 8.0381e-04, PNorm = 47.0878, GNorm = 0.9764, lr_0 = 1.2362e-04
Validation rmse = 1.056677
Epoch 26
Loss = 7.1582e-04, PNorm = 47.0924, GNorm = 0.5531, lr_0 = 1.1839e-04
Validation rmse = 1.050920
Epoch 27
Loss = 1.1811e-03, PNorm = 47.0986, GNorm = 1.8484, lr_0 = 1.1288e-04
Loss = 6.7065e-04, PNorm = 47.1033, GNorm = 1.0966, lr_0 = 1.0810e-04
Validation rmse = 1.051509
Epoch 28
Loss = 6.4007e-04, PNorm = 47.1084, GNorm = 1.3582, lr_0 = 1.0352e-04
Loss = 7.1636e-04, PNorm = 47.1123, GNorm = 0.4199, lr_0 = 1.0000e-04
Validation rmse = 1.116809
Epoch 29
Loss = 6.4849e-04, PNorm = 47.1174, GNorm = 1.3845, lr_0 = 1.0000e-04
Loss = 7.5161e-04, PNorm = 47.1219, GNorm = 1.4367, lr_0 = 1.0000e-04
Validation rmse = 1.081535
Model 0 best validation rmse = 1.050920 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.940347
Ensemble test rmse = 0.940347
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total scaffolds = 195 | train scaffolds = 69 | val scaffolds = 65 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=904, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,805
Moving model to cuda
Epoch 0
Loss = 1.6419e-02, PNorm = 46.0522, GNorm = 10.3696, lr_0 = 3.6053e-04
Validation rmse = 1.693506
Epoch 1
Loss = 9.1960e-03, PNorm = 46.0976, GNorm = 6.9555, lr_0 = 6.2105e-04
Loss = 6.3463e-03, PNorm = 46.1494, GNorm = 5.6242, lr_0 = 8.5789e-04
Validation rmse = 1.834487
Epoch 2
Loss = 4.4283e-03, PNorm = 46.2103, GNorm = 3.7113, lr_0 = 9.8284e-04
Loss = 3.9436e-03, PNorm = 46.2645, GNorm = 2.6118, lr_0 = 9.4120e-04
Validation rmse = 1.693786
Epoch 3
Loss = 3.7468e-03, PNorm = 46.3177, GNorm = 5.8984, lr_0 = 8.9744e-04
Loss = 4.5371e-03, PNorm = 46.3717, GNorm = 2.5041, lr_0 = 8.5943e-04
Validation rmse = 1.654777
Epoch 4
Loss = 2.5754e-03, PNorm = 46.4101, GNorm = 1.3448, lr_0 = 8.2303e-04
Loss = 2.7525e-03, PNorm = 46.4491, GNorm = 1.4631, lr_0 = 7.8816e-04
Validation rmse = 1.624450
Epoch 5
Loss = 2.5013e-03, PNorm = 46.4864, GNorm = 2.0673, lr_0 = 7.5478e-04
Loss = 1.9345e-03, PNorm = 46.5178, GNorm = 0.6635, lr_0 = 7.2281e-04
Validation rmse = 1.515199
Epoch 6
Loss = 3.2263e-03, PNorm = 46.5529, GNorm = 5.3414, lr_0 = 6.8920e-04
Loss = 2.4717e-03, PNorm = 46.5840, GNorm = 0.8110, lr_0 = 6.6001e-04
Validation rmse = 1.467659
Epoch 7
Loss = 1.8628e-03, PNorm = 46.6105, GNorm = 4.5604, lr_0 = 6.3205e-04
Loss = 2.4087e-03, PNorm = 46.6353, GNorm = 1.1562, lr_0 = 6.0528e-04
Validation rmse = 1.446239
Epoch 8
Loss = 1.5332e-03, PNorm = 46.6601, GNorm = 1.2854, lr_0 = 5.7714e-04
Loss = 1.6000e-03, PNorm = 46.6799, GNorm = 0.5836, lr_0 = 5.5269e-04
Validation rmse = 1.463188
Epoch 9
Loss = 1.6130e-03, PNorm = 46.6974, GNorm = 1.4412, lr_0 = 5.2928e-04
Loss = 1.5420e-03, PNorm = 46.7146, GNorm = 2.2123, lr_0 = 5.0686e-04
Validation rmse = 1.429468
Epoch 10
Loss = 1.5225e-03, PNorm = 46.7295, GNorm = 1.0755, lr_0 = 4.8539e-04
Loss = 1.4235e-03, PNorm = 46.7464, GNorm = 0.6567, lr_0 = 4.6483e-04
Validation rmse = 1.425357
Epoch 11
Loss = 1.3120e-03, PNorm = 46.7648, GNorm = 0.9280, lr_0 = 4.4322e-04
Loss = 1.2055e-03, PNorm = 46.7781, GNorm = 0.5245, lr_0 = 4.2444e-04
Validation rmse = 1.293197
Epoch 12
Loss = 1.1517e-03, PNorm = 46.7923, GNorm = 0.5988, lr_0 = 4.0646e-04
Loss = 1.1465e-03, PNorm = 46.8060, GNorm = 1.4588, lr_0 = 3.8925e-04
Validation rmse = 1.292088
Epoch 13
Loss = 1.2904e-03, PNorm = 46.8187, GNorm = 1.3011, lr_0 = 3.7276e-04
Loss = 1.5150e-03, PNorm = 46.8332, GNorm = 0.8380, lr_0 = 3.5697e-04
Validation rmse = 1.524245
Epoch 14
Loss = 1.3111e-03, PNorm = 46.8489, GNorm = 2.7410, lr_0 = 3.4037e-04
Loss = 1.1846e-03, PNorm = 46.8622, GNorm = 0.6918, lr_0 = 3.2596e-04
Validation rmse = 1.372430
Epoch 15
Loss = 1.1749e-03, PNorm = 46.8747, GNorm = 1.4141, lr_0 = 3.1215e-04
Loss = 1.1487e-03, PNorm = 46.8883, GNorm = 0.5217, lr_0 = 2.9893e-04
Validation rmse = 1.552635
Epoch 16
Loss = 1.1580e-03, PNorm = 46.9033, GNorm = 0.8216, lr_0 = 2.8503e-04
Loss = 9.7926e-04, PNorm = 46.9114, GNorm = 0.4382, lr_0 = 2.7295e-04
Validation rmse = 1.419412
Epoch 17
Loss = 9.2597e-04, PNorm = 46.9224, GNorm = 0.4252, lr_0 = 2.6139e-04
Loss = 1.1500e-03, PNorm = 46.9315, GNorm = 1.8134, lr_0 = 2.5032e-04
Validation rmse = 1.329309
Epoch 18
Loss = 8.9466e-04, PNorm = 46.9425, GNorm = 0.7006, lr_0 = 2.3972e-04
Loss = 1.0493e-03, PNorm = 46.9533, GNorm = 0.7543, lr_0 = 2.2956e-04
Validation rmse = 1.347275
Epoch 19
Loss = 9.8987e-04, PNorm = 46.9635, GNorm = 0.5651, lr_0 = 2.1889e-04
Loss = 9.0954e-04, PNorm = 46.9731, GNorm = 0.6276, lr_0 = 2.0962e-04
Validation rmse = 1.303145
Epoch 20
Loss = 1.1239e-03, PNorm = 46.9819, GNorm = 1.3485, lr_0 = 2.0074e-04
Loss = 7.8500e-04, PNorm = 46.9892, GNorm = 1.1911, lr_0 = 1.9224e-04
Validation rmse = 1.345785
Epoch 21
Loss = 9.8239e-04, PNorm = 46.9963, GNorm = 2.0155, lr_0 = 1.8409e-04
Loss = 9.4873e-04, PNorm = 47.0046, GNorm = 1.1876, lr_0 = 1.7630e-04
Validation rmse = 1.386416
Epoch 22
Loss = 8.1597e-04, PNorm = 47.0122, GNorm = 0.9256, lr_0 = 1.6810e-04
Loss = 9.2839e-04, PNorm = 47.0201, GNorm = 0.6138, lr_0 = 1.6098e-04
Validation rmse = 1.357942
Epoch 23
Loss = 8.6201e-04, PNorm = 47.0267, GNorm = 0.3781, lr_0 = 1.5416e-04
Loss = 7.8233e-04, PNorm = 47.0331, GNorm = 0.4071, lr_0 = 1.4763e-04
Loss = 1.5424e-03, PNorm = 47.0337, GNorm = 1.9591, lr_0 = 1.4699e-04
Validation rmse = 1.267030
Epoch 24
Loss = 8.1457e-04, PNorm = 47.0390, GNorm = 1.8175, lr_0 = 1.4077e-04
Loss = 9.7093e-04, PNorm = 47.0456, GNorm = 0.6197, lr_0 = 1.3480e-04
Validation rmse = 1.282734
Epoch 25
Loss = 8.7447e-04, PNorm = 47.0513, GNorm = 0.4065, lr_0 = 1.2909e-04
Loss = 1.0218e-03, PNorm = 47.0582, GNorm = 0.9072, lr_0 = 1.2362e-04
Validation rmse = 1.322582
Epoch 26
Loss = 8.0207e-04, PNorm = 47.0621, GNorm = 0.4617, lr_0 = 1.1839e-04
Validation rmse = 1.346694
Epoch 27
Loss = 6.1008e-04, PNorm = 47.0681, GNorm = 1.1621, lr_0 = 1.1288e-04
Loss = 7.0969e-04, PNorm = 47.0730, GNorm = 1.6338, lr_0 = 1.0810e-04
Validation rmse = 1.346187
Epoch 28
Loss = 8.6262e-04, PNorm = 47.0777, GNorm = 0.6650, lr_0 = 1.0352e-04
Loss = 7.1534e-04, PNorm = 47.0826, GNorm = 0.6647, lr_0 = 1.0000e-04
Validation rmse = 1.333709
Epoch 29
Loss = 1.0768e-03, PNorm = 47.0876, GNorm = 1.1361, lr_0 = 1.0000e-04
Loss = 6.3529e-04, PNorm = 47.0916, GNorm = 0.3337, lr_0 = 1.0000e-04
Validation rmse = 1.313617
Model 0 best validation rmse = 1.267030 on epoch 23
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.069090
Ensemble test rmse = 1.069090
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total scaffolds = 195 | train scaffolds = 75 | val scaffolds = 42 | test scaffolds = 78
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=904, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,805
Moving model to cuda
Epoch 0
Loss = 1.4848e-02, PNorm = 46.0517, GNorm = 6.7853, lr_0 = 3.6053e-04
Validation rmse = 1.806008
Epoch 1
Loss = 6.0621e-03, PNorm = 46.0975, GNorm = 7.5005, lr_0 = 6.2105e-04
Loss = 6.8028e-03, PNorm = 46.1461, GNorm = 1.6198, lr_0 = 8.5789e-04
Validation rmse = 1.538896
Epoch 2
Loss = 4.0136e-03, PNorm = 46.2075, GNorm = 2.8780, lr_0 = 9.8284e-04
Loss = 4.1634e-03, PNorm = 46.2617, GNorm = 4.2916, lr_0 = 9.4120e-04
Validation rmse = 1.483805
Epoch 3
Loss = 3.5107e-03, PNorm = 46.3131, GNorm = 1.4426, lr_0 = 8.9744e-04
Loss = 3.0286e-03, PNorm = 46.3548, GNorm = 7.3139, lr_0 = 8.5943e-04
Validation rmse = 1.575595
Epoch 4
Loss = 3.0775e-03, PNorm = 46.3913, GNorm = 2.3635, lr_0 = 8.2303e-04
Loss = 2.5109e-03, PNorm = 46.4282, GNorm = 1.7790, lr_0 = 7.8816e-04
Validation rmse = 1.260635
Epoch 5
Loss = 1.4646e-03, PNorm = 46.4607, GNorm = 0.9270, lr_0 = 7.5478e-04
Loss = 1.7591e-03, PNorm = 46.4902, GNorm = 0.8980, lr_0 = 7.2281e-04
Validation rmse = 1.227541
Epoch 6
Loss = 1.4138e-03, PNorm = 46.5160, GNorm = 2.3095, lr_0 = 6.8920e-04
Loss = 2.0340e-03, PNorm = 46.5389, GNorm = 3.0554, lr_0 = 6.6001e-04
Validation rmse = 1.287539
Epoch 7
Loss = 1.9363e-03, PNorm = 46.5658, GNorm = 3.4136, lr_0 = 6.3205e-04
Loss = 1.9018e-03, PNorm = 46.5902, GNorm = 1.8476, lr_0 = 6.0528e-04
Validation rmse = 1.256732
Epoch 8
Loss = 2.0651e-03, PNorm = 46.6138, GNorm = 2.6284, lr_0 = 5.7714e-04
Loss = 1.3211e-03, PNorm = 46.6332, GNorm = 2.2663, lr_0 = 5.5269e-04
Validation rmse = 1.219688
Epoch 9
Loss = 1.2047e-03, PNorm = 46.6508, GNorm = 2.0062, lr_0 = 5.2928e-04
Loss = 1.2679e-03, PNorm = 46.6695, GNorm = 0.7121, lr_0 = 5.0686e-04
Validation rmse = 1.149063
Epoch 10
Loss = 1.0302e-03, PNorm = 46.6873, GNorm = 0.7614, lr_0 = 4.8539e-04
Loss = 1.4123e-03, PNorm = 46.7037, GNorm = 0.6993, lr_0 = 4.6483e-04
Validation rmse = 1.125371
Epoch 11
Loss = 1.5102e-03, PNorm = 46.7191, GNorm = 2.7828, lr_0 = 4.4322e-04
Loss = 1.2993e-03, PNorm = 46.7341, GNorm = 0.8464, lr_0 = 4.2444e-04
Validation rmse = 1.151480
Epoch 12
Loss = 1.1242e-03, PNorm = 46.7495, GNorm = 2.4401, lr_0 = 4.0646e-04
Loss = 1.0643e-03, PNorm = 46.7651, GNorm = 0.7686, lr_0 = 3.8925e-04
Validation rmse = 1.145382
Epoch 13
Loss = 1.1016e-03, PNorm = 46.7781, GNorm = 1.2998, lr_0 = 3.7276e-04
Loss = 1.0092e-03, PNorm = 46.7912, GNorm = 0.5346, lr_0 = 3.5697e-04
Validation rmse = 1.074480
Epoch 14
Loss = 9.8179e-04, PNorm = 46.8053, GNorm = 0.8406, lr_0 = 3.4037e-04
Loss = 1.1512e-03, PNorm = 46.8164, GNorm = 2.2746, lr_0 = 3.2596e-04
Validation rmse = 1.076718
Epoch 15
Loss = 1.0619e-03, PNorm = 46.8280, GNorm = 1.9635, lr_0 = 3.1215e-04
Loss = 1.1915e-03, PNorm = 46.8407, GNorm = 0.7059, lr_0 = 2.9893e-04
Validation rmse = 1.117316
Epoch 16
Loss = 9.0559e-04, PNorm = 46.8566, GNorm = 0.7477, lr_0 = 2.8503e-04
Loss = 1.0504e-03, PNorm = 46.8691, GNorm = 0.5740, lr_0 = 2.7295e-04
Validation rmse = 1.080477
Epoch 17
Loss = 9.3039e-04, PNorm = 46.8767, GNorm = 0.3344, lr_0 = 2.6139e-04
Loss = 1.0440e-03, PNorm = 46.8876, GNorm = 0.7511, lr_0 = 2.5032e-04
Validation rmse = 1.091378
Epoch 18
Loss = 9.9978e-04, PNorm = 46.8959, GNorm = 1.0531, lr_0 = 2.3972e-04
Loss = 9.0826e-04, PNorm = 46.9047, GNorm = 0.9347, lr_0 = 2.2956e-04
Validation rmse = 1.168198
Epoch 19
Loss = 9.2604e-04, PNorm = 46.9141, GNorm = 0.6713, lr_0 = 2.1889e-04
Loss = 9.4443e-04, PNorm = 46.9221, GNorm = 0.7454, lr_0 = 2.0962e-04
Validation rmse = 1.100380
Epoch 20
Loss = 8.0382e-04, PNorm = 46.9325, GNorm = 0.9565, lr_0 = 2.0074e-04
Loss = 1.0058e-03, PNorm = 46.9396, GNorm = 0.8538, lr_0 = 1.9224e-04
Validation rmse = 1.058617
Epoch 21
Loss = 7.2545e-04, PNorm = 46.9485, GNorm = 0.9097, lr_0 = 1.8409e-04
Loss = 9.6978e-04, PNorm = 46.9568, GNorm = 0.7855, lr_0 = 1.7630e-04
Validation rmse = 1.126820
Epoch 22
Loss = 9.6028e-04, PNorm = 46.9662, GNorm = 1.4474, lr_0 = 1.6810e-04
Loss = 8.3493e-04, PNorm = 46.9733, GNorm = 0.5890, lr_0 = 1.6098e-04
Validation rmse = 1.082694
Epoch 23
Loss = 8.7386e-04, PNorm = 46.9798, GNorm = 0.6286, lr_0 = 1.5416e-04
Loss = 7.8243e-04, PNorm = 46.9865, GNorm = 1.0530, lr_0 = 1.4763e-04
Loss = 8.3843e-04, PNorm = 46.9871, GNorm = 0.8965, lr_0 = 1.4699e-04
Validation rmse = 1.072322
Epoch 24
Loss = 7.3637e-04, PNorm = 46.9930, GNorm = 0.4326, lr_0 = 1.4077e-04
Loss = 7.6933e-04, PNorm = 46.9996, GNorm = 0.4778, lr_0 = 1.3480e-04
Validation rmse = 1.066682
Epoch 25
Loss = 7.7288e-04, PNorm = 47.0046, GNorm = 0.9407, lr_0 = 1.2909e-04
Loss = 6.8448e-04, PNorm = 47.0098, GNorm = 1.2997, lr_0 = 1.2362e-04
Validation rmse = 1.071030
Epoch 26
Loss = 8.8446e-04, PNorm = 47.0153, GNorm = 1.1354, lr_0 = 1.1839e-04
Validation rmse = 1.041427
Epoch 27
Loss = 1.2742e-03, PNorm = 47.0198, GNorm = 1.3791, lr_0 = 1.1288e-04
Loss = 6.1652e-04, PNorm = 47.0242, GNorm = 1.1946, lr_0 = 1.0810e-04
Validation rmse = 1.080097
Epoch 28
Loss = 6.8429e-04, PNorm = 47.0282, GNorm = 1.2767, lr_0 = 1.0352e-04
Loss = 7.6153e-04, PNorm = 47.0316, GNorm = 0.5289, lr_0 = 1.0000e-04
Validation rmse = 1.076026
Epoch 29
Loss = 5.6525e-04, PNorm = 47.0370, GNorm = 0.7544, lr_0 = 1.0000e-04
Loss = 6.7665e-04, PNorm = 47.0412, GNorm = 0.8341, lr_0 = 1.0000e-04
Validation rmse = 1.082845
Model 0 best validation rmse = 1.041427 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.120592
Ensemble test rmse = 1.120592
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 58 | test scaffolds = 53
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=904, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,805
Moving model to cuda
Epoch 0
Loss = 1.7726e-02, PNorm = 46.0499, GNorm = 9.9532, lr_0 = 3.6053e-04
Validation rmse = 1.651478
Epoch 1
Loss = 5.1351e-03, PNorm = 46.0975, GNorm = 2.9021, lr_0 = 6.2105e-04
Loss = 6.4275e-03, PNorm = 46.1552, GNorm = 5.3399, lr_0 = 8.5789e-04
Validation rmse = 1.805185
Epoch 2
Loss = 8.4776e-03, PNorm = 46.2173, GNorm = 5.9790, lr_0 = 9.8284e-04
Loss = 7.0427e-03, PNorm = 46.2810, GNorm = 0.8481, lr_0 = 9.4120e-04
Validation rmse = 1.368593
Epoch 3
Loss = 3.9669e-03, PNorm = 46.3400, GNorm = 2.7511, lr_0 = 8.9744e-04
Loss = 3.6736e-03, PNorm = 46.3812, GNorm = 1.3791, lr_0 = 8.5943e-04
Validation rmse = 1.437526
Epoch 4
Loss = 4.2632e-03, PNorm = 46.4161, GNorm = 6.6223, lr_0 = 8.2303e-04
Loss = 2.7895e-03, PNorm = 46.4520, GNorm = 1.5051, lr_0 = 7.8816e-04
Validation rmse = 1.212375
Epoch 5
Loss = 1.7765e-03, PNorm = 46.4863, GNorm = 0.8707, lr_0 = 7.5478e-04
Loss = 2.5446e-03, PNorm = 46.5165, GNorm = 2.0427, lr_0 = 7.2281e-04
Validation rmse = 1.116493
Epoch 6
Loss = 2.6101e-03, PNorm = 46.5506, GNorm = 1.3806, lr_0 = 6.8920e-04
Loss = 2.1780e-03, PNorm = 46.5788, GNorm = 2.3497, lr_0 = 6.6001e-04
Validation rmse = 1.503630
Epoch 7
Loss = 2.6234e-03, PNorm = 46.6020, GNorm = 1.7538, lr_0 = 6.3205e-04
Loss = 2.0778e-03, PNorm = 46.6281, GNorm = 1.4178, lr_0 = 6.0528e-04
Validation rmse = 1.094263
Epoch 8
Loss = 1.6084e-03, PNorm = 46.6526, GNorm = 1.0628, lr_0 = 5.7714e-04
Loss = 1.6503e-03, PNorm = 46.6735, GNorm = 1.3044, lr_0 = 5.5269e-04
Validation rmse = 1.029825
Epoch 9
Loss = 1.7950e-03, PNorm = 46.6959, GNorm = 1.9454, lr_0 = 5.2928e-04
Loss = 1.6397e-03, PNorm = 46.7196, GNorm = 0.8600, lr_0 = 5.0686e-04
Validation rmse = 1.131878
Epoch 10
Loss = 1.4075e-03, PNorm = 46.7353, GNorm = 0.9289, lr_0 = 4.8539e-04
Loss = 1.5184e-03, PNorm = 46.7516, GNorm = 1.1317, lr_0 = 4.6483e-04
Validation rmse = 1.067256
Epoch 11
Loss = 1.5581e-03, PNorm = 46.7736, GNorm = 1.4188, lr_0 = 4.4322e-04
Loss = 1.6439e-03, PNorm = 46.7915, GNorm = 2.0766, lr_0 = 4.2444e-04
Validation rmse = 1.116347
Epoch 12
Loss = 1.3180e-03, PNorm = 46.8076, GNorm = 1.3397, lr_0 = 4.0646e-04
Loss = 1.5398e-03, PNorm = 46.8254, GNorm = 1.2020, lr_0 = 3.8925e-04
Validation rmse = 1.009275
Epoch 13
Loss = 1.1106e-03, PNorm = 46.8383, GNorm = 0.7730, lr_0 = 3.7276e-04
Loss = 1.2773e-03, PNorm = 46.8530, GNorm = 1.0109, lr_0 = 3.5697e-04
Validation rmse = 1.108481
Epoch 14
Loss = 1.3383e-03, PNorm = 46.8728, GNorm = 1.0550, lr_0 = 3.4037e-04
Loss = 1.3804e-03, PNorm = 46.8882, GNorm = 0.8070, lr_0 = 3.2596e-04
Validation rmse = 0.983426
Epoch 15
Loss = 1.0618e-03, PNorm = 46.9006, GNorm = 1.0306, lr_0 = 3.1215e-04
Loss = 1.3145e-03, PNorm = 46.9156, GNorm = 2.5129, lr_0 = 2.9893e-04
Validation rmse = 0.984438
Epoch 16
Loss = 1.2444e-03, PNorm = 46.9319, GNorm = 1.9395, lr_0 = 2.8503e-04
Loss = 1.3361e-03, PNorm = 46.9434, GNorm = 1.0235, lr_0 = 2.7295e-04
Validation rmse = 1.004436
Epoch 17
Loss = 1.2211e-03, PNorm = 46.9547, GNorm = 1.7134, lr_0 = 2.6139e-04
Loss = 1.2739e-03, PNorm = 46.9642, GNorm = 1.1541, lr_0 = 2.5032e-04
Validation rmse = 0.963342
Epoch 18
Loss = 9.6787e-04, PNorm = 46.9753, GNorm = 0.6105, lr_0 = 2.3972e-04
Loss = 1.3046e-03, PNorm = 46.9854, GNorm = 0.6468, lr_0 = 2.2956e-04
Validation rmse = 0.928601
Epoch 19
Loss = 1.1094e-03, PNorm = 46.9943, GNorm = 1.5337, lr_0 = 2.1889e-04
Loss = 1.1731e-03, PNorm = 47.0051, GNorm = 0.4877, lr_0 = 2.0962e-04
Validation rmse = 0.982094
Epoch 20
Loss = 1.2207e-03, PNorm = 47.0149, GNorm = 0.8535, lr_0 = 2.0074e-04
Loss = 1.0170e-03, PNorm = 47.0225, GNorm = 0.9031, lr_0 = 1.9224e-04
Validation rmse = 0.936480
Epoch 21
Loss = 8.4655e-04, PNorm = 47.0292, GNorm = 1.5033, lr_0 = 1.8409e-04
Loss = 1.0269e-03, PNorm = 47.0371, GNorm = 0.5426, lr_0 = 1.7630e-04
Validation rmse = 0.936587
Epoch 22
Loss = 1.0638e-03, PNorm = 47.0445, GNorm = 1.6670, lr_0 = 1.6810e-04
Loss = 9.8276e-04, PNorm = 47.0522, GNorm = 1.5014, lr_0 = 1.6098e-04
Validation rmse = 0.938214
Epoch 23
Loss = 8.2677e-04, PNorm = 47.0588, GNorm = 1.1502, lr_0 = 1.5416e-04
Loss = 9.7809e-04, PNorm = 47.0655, GNorm = 0.6749, lr_0 = 1.4763e-04
Loss = 1.6805e-03, PNorm = 47.0662, GNorm = 0.5182, lr_0 = 1.4699e-04
Validation rmse = 0.924119
Epoch 24
Loss = 8.4956e-04, PNorm = 47.0719, GNorm = 0.5903, lr_0 = 1.4077e-04
Loss = 8.9216e-04, PNorm = 47.0776, GNorm = 0.4762, lr_0 = 1.3480e-04
Validation rmse = 0.931365
Epoch 25
Loss = 9.2442e-04, PNorm = 47.0838, GNorm = 0.5167, lr_0 = 1.2909e-04
Loss = 8.1228e-04, PNorm = 47.0890, GNorm = 0.5150, lr_0 = 1.2362e-04
Validation rmse = 0.960182
Epoch 26
Loss = 8.5787e-04, PNorm = 47.0951, GNorm = 0.4733, lr_0 = 1.1839e-04
Validation rmse = 0.900102
Epoch 27
Loss = 6.7112e-04, PNorm = 47.1012, GNorm = 0.5683, lr_0 = 1.1288e-04
Loss = 9.2907e-04, PNorm = 47.1057, GNorm = 1.9248, lr_0 = 1.0810e-04
Validation rmse = 0.911412
Epoch 28
Loss = 7.4609e-04, PNorm = 47.1106, GNorm = 0.4007, lr_0 = 1.0352e-04
Loss = 8.1746e-04, PNorm = 47.1159, GNorm = 0.5159, lr_0 = 1.0000e-04
Validation rmse = 0.934962
Epoch 29
Loss = 9.5823e-04, PNorm = 47.1211, GNorm = 0.8935, lr_0 = 1.0000e-04
Loss = 7.1655e-04, PNorm = 47.1251, GNorm = 0.6335, lr_0 = 1.0000e-04
Validation rmse = 0.943867
Model 0 best validation rmse = 0.900102 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.246063
Ensemble test rmse = 1.246063
10-fold cross validation
	Seed 0 ==> test rmse = 0.881515
	Seed 1 ==> test rmse = 1.041063
	Seed 2 ==> test rmse = 1.084966
	Seed 3 ==> test rmse = 1.149219
	Seed 4 ==> test rmse = 1.163225
	Seed 5 ==> test rmse = 1.145023
	Seed 6 ==> test rmse = 0.940347
	Seed 7 ==> test rmse = 1.069090
	Seed 8 ==> test rmse = 1.120592
	Seed 9 ==> test rmse = 1.246063
Overall test rmse = 1.084110 +/- 0.102743
Elapsed time = 0:06:46
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total scaffolds = 195 | train scaffolds = 91 | val scaffolds = 66 | test scaffolds = 38
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1304, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,443,101
Moving model to cuda
Epoch 0
Loss = 1.4046e-02, PNorm = 65.0506, GNorm = 10.4619, lr_0 = 3.6053e-04
Validation rmse = 1.236774
Epoch 1
Loss = 4.5048e-03, PNorm = 65.1122, GNorm = 2.1521, lr_0 = 6.2105e-04
Loss = 4.9230e-03, PNorm = 65.1948, GNorm = 0.8839, lr_0 = 8.5789e-04
Validation rmse = 0.972923
Epoch 2
Loss = 5.5338e-03, PNorm = 65.2796, GNorm = 1.4107, lr_0 = 9.8284e-04
Loss = 4.0596e-03, PNorm = 65.3566, GNorm = 1.1835, lr_0 = 9.4120e-04
Validation rmse = 0.973139
Epoch 3
Loss = 2.2864e-03, PNorm = 65.4297, GNorm = 0.5171, lr_0 = 8.9744e-04
Loss = 2.5689e-03, PNorm = 65.4806, GNorm = 0.9176, lr_0 = 8.5943e-04
Validation rmse = 1.095040
Epoch 4
Loss = 3.8158e-03, PNorm = 65.5308, GNorm = 1.3607, lr_0 = 8.2303e-04
Loss = 2.1949e-03, PNorm = 65.5755, GNorm = 1.1978, lr_0 = 7.8816e-04
Validation rmse = 1.023948
Epoch 5
Loss = 1.5357e-03, PNorm = 65.6164, GNorm = 0.6308, lr_0 = 7.5478e-04
Loss = 2.2517e-03, PNorm = 65.6527, GNorm = 0.9978, lr_0 = 7.2281e-04
Validation rmse = 0.854865
Epoch 6
Loss = 1.4996e-03, PNorm = 65.6974, GNorm = 0.3380, lr_0 = 6.8920e-04
Loss = 2.1239e-03, PNorm = 65.7325, GNorm = 0.7350, lr_0 = 6.6001e-04
Validation rmse = 1.187153
Epoch 7
Loss = 2.3930e-03, PNorm = 65.7658, GNorm = 2.3232, lr_0 = 6.3205e-04
Loss = 1.8597e-03, PNorm = 65.8029, GNorm = 0.4204, lr_0 = 6.0528e-04
Validation rmse = 1.039405
Epoch 8
Loss = 1.8822e-03, PNorm = 65.8437, GNorm = 0.7927, lr_0 = 5.7714e-04
Loss = 1.8031e-03, PNorm = 65.8742, GNorm = 0.8137, lr_0 = 5.5269e-04
Validation rmse = 0.917912
Epoch 9
Loss = 2.2977e-03, PNorm = 65.9065, GNorm = 3.3503, lr_0 = 5.2928e-04
Loss = 2.6960e-03, PNorm = 65.9461, GNorm = 0.8831, lr_0 = 5.0686e-04
Validation rmse = 0.976314
Epoch 10
Loss = 1.8132e-03, PNorm = 65.9751, GNorm = 1.3627, lr_0 = 4.8539e-04
Loss = 1.6644e-03, PNorm = 66.0051, GNorm = 0.4486, lr_0 = 4.6483e-04
Validation rmse = 1.138326
Epoch 11
Loss = 1.4664e-03, PNorm = 66.0335, GNorm = 0.8726, lr_0 = 4.4322e-04
Loss = 1.3661e-03, PNorm = 66.0526, GNorm = 0.8145, lr_0 = 4.2444e-04
Validation rmse = 1.087327
Epoch 12
Loss = 1.4515e-03, PNorm = 66.0752, GNorm = 0.5922, lr_0 = 4.0646e-04
Loss = 1.6485e-03, PNorm = 66.0937, GNorm = 0.4727, lr_0 = 3.8925e-04
Validation rmse = 0.952974
Epoch 13
Loss = 1.1947e-03, PNorm = 66.1163, GNorm = 0.4119, lr_0 = 3.7276e-04
Loss = 1.3521e-03, PNorm = 66.1389, GNorm = 0.5811, lr_0 = 3.5697e-04
Validation rmse = 0.963031
Epoch 14
Loss = 1.3451e-03, PNorm = 66.1570, GNorm = 0.3200, lr_0 = 3.4037e-04
Loss = 1.3905e-03, PNorm = 66.1771, GNorm = 1.1451, lr_0 = 3.2596e-04
Validation rmse = 0.894910
Epoch 15
Loss = 1.2205e-03, PNorm = 66.1943, GNorm = 0.3566, lr_0 = 3.1215e-04
Loss = 1.3157e-03, PNorm = 66.2129, GNorm = 0.4189, lr_0 = 2.9893e-04
Validation rmse = 0.899728
Epoch 16
Loss = 1.4068e-03, PNorm = 66.2300, GNorm = 0.3439, lr_0 = 2.8503e-04
Loss = 1.1865e-03, PNorm = 66.2450, GNorm = 0.4476, lr_0 = 2.7295e-04
Validation rmse = 0.900439
Epoch 17
Loss = 1.3409e-03, PNorm = 66.2617, GNorm = 0.9539, lr_0 = 2.6139e-04
Loss = 1.3907e-03, PNorm = 66.2764, GNorm = 1.4285, lr_0 = 2.5032e-04
Validation rmse = 0.917647
Epoch 18
Loss = 1.1095e-03, PNorm = 66.2891, GNorm = 0.7615, lr_0 = 2.3972e-04
Loss = 1.0636e-03, PNorm = 66.3038, GNorm = 0.4082, lr_0 = 2.2956e-04
Validation rmse = 0.990948
Epoch 19
Loss = 1.1394e-03, PNorm = 66.3221, GNorm = 0.6661, lr_0 = 2.1889e-04
Loss = 1.1883e-03, PNorm = 66.3368, GNorm = 0.5780, lr_0 = 2.0962e-04
Validation rmse = 1.012919
Epoch 20
Loss = 1.0100e-03, PNorm = 66.3478, GNorm = 0.3538, lr_0 = 2.0074e-04
Loss = 1.1106e-03, PNorm = 66.3589, GNorm = 0.4313, lr_0 = 1.9224e-04
Validation rmse = 1.066350
Epoch 21
Loss = 1.0074e-03, PNorm = 66.3708, GNorm = 0.6475, lr_0 = 1.8409e-04
Loss = 1.0670e-03, PNorm = 66.3811, GNorm = 0.4969, lr_0 = 1.7630e-04
Validation rmse = 0.882460
Epoch 22
Loss = 9.4201e-04, PNorm = 66.3942, GNorm = 0.9897, lr_0 = 1.6810e-04
Loss = 1.2219e-03, PNorm = 66.4023, GNorm = 0.7546, lr_0 = 1.6098e-04
Validation rmse = 0.906798
Epoch 23
Loss = 9.0900e-04, PNorm = 66.4115, GNorm = 0.5932, lr_0 = 1.5416e-04
Loss = 9.0186e-04, PNorm = 66.4205, GNorm = 0.3061, lr_0 = 1.4763e-04
Loss = 9.8680e-04, PNorm = 66.4216, GNorm = 0.3491, lr_0 = 1.4699e-04
Validation rmse = 0.945472
Epoch 24
Loss = 1.0435e-03, PNorm = 66.4294, GNorm = 0.5739, lr_0 = 1.4077e-04
Loss = 1.0771e-03, PNorm = 66.4382, GNorm = 0.9083, lr_0 = 1.3480e-04
Validation rmse = 0.953776
Epoch 25
Loss = 9.5117e-04, PNorm = 66.4466, GNorm = 0.5432, lr_0 = 1.2909e-04
Loss = 1.0973e-03, PNorm = 66.4534, GNorm = 0.8839, lr_0 = 1.2362e-04
Validation rmse = 0.999251
Epoch 26
Loss = 9.3513e-04, PNorm = 66.4603, GNorm = 0.7132, lr_0 = 1.1839e-04
Validation rmse = 0.923207
Epoch 27
Loss = 7.9098e-04, PNorm = 66.4693, GNorm = 1.0888, lr_0 = 1.1288e-04
Loss = 9.1423e-04, PNorm = 66.4756, GNorm = 0.6596, lr_0 = 1.0810e-04
Validation rmse = 0.960452
Epoch 28
Loss = 1.2848e-03, PNorm = 66.4820, GNorm = 0.8484, lr_0 = 1.0352e-04
Loss = 7.4610e-04, PNorm = 66.4879, GNorm = 0.2633, lr_0 = 1.0000e-04
Validation rmse = 0.908698
Epoch 29
Loss = 9.8903e-04, PNorm = 66.4936, GNorm = 1.2807, lr_0 = 1.0000e-04
Loss = 7.9588e-04, PNorm = 66.5003, GNorm = 0.4175, lr_0 = 1.0000e-04
Validation rmse = 0.938802
Model 0 best validation rmse = 0.854865 on epoch 5
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.938806
Ensemble test rmse = 0.938806
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total scaffolds = 195 | train scaffolds = 76 | val scaffolds = 60 | test scaffolds = 59
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1304, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,443,101
Moving model to cuda
Epoch 0
Loss = 1.4086e-02, PNorm = 65.0520, GNorm = 7.4548, lr_0 = 3.6053e-04
Validation rmse = 1.673531
Epoch 1
Loss = 7.6826e-03, PNorm = 65.1091, GNorm = 6.2058, lr_0 = 6.2105e-04
Loss = 5.1416e-03, PNorm = 65.1802, GNorm = 3.2926, lr_0 = 8.5789e-04
Validation rmse = 1.127420
Epoch 2
Loss = 4.8832e-03, PNorm = 65.2525, GNorm = 2.3399, lr_0 = 9.8284e-04
Loss = 3.2655e-03, PNorm = 65.3171, GNorm = 1.8787, lr_0 = 9.4120e-04
Validation rmse = 1.012037
Epoch 3
Loss = 3.0541e-03, PNorm = 65.3719, GNorm = 1.9776, lr_0 = 8.9744e-04
Loss = 2.6882e-03, PNorm = 65.4208, GNorm = 0.6855, lr_0 = 8.5943e-04
Validation rmse = 0.975969
Epoch 4
Loss = 1.7372e-03, PNorm = 65.4619, GNorm = 0.4247, lr_0 = 8.2303e-04
Loss = 2.5632e-03, PNorm = 65.5035, GNorm = 1.1677, lr_0 = 7.8816e-04
Validation rmse = 1.024334
Epoch 5
Loss = 2.1009e-03, PNorm = 65.5473, GNorm = 0.5163, lr_0 = 7.5478e-04
Loss = 2.5961e-03, PNorm = 65.5947, GNorm = 1.4961, lr_0 = 7.2281e-04
Validation rmse = 1.044765
Epoch 6
Loss = 2.4588e-03, PNorm = 65.6411, GNorm = 1.1210, lr_0 = 6.8920e-04
Loss = 2.1457e-03, PNorm = 65.6838, GNorm = 1.1588, lr_0 = 6.6001e-04
Validation rmse = 0.963846
Epoch 7
Loss = 1.7701e-03, PNorm = 65.7156, GNorm = 0.5659, lr_0 = 6.3205e-04
Loss = 1.9743e-03, PNorm = 65.7517, GNorm = 2.1343, lr_0 = 6.0528e-04
Validation rmse = 0.898700
Epoch 8
Loss = 2.1378e-03, PNorm = 65.7853, GNorm = 1.1753, lr_0 = 5.7714e-04
Loss = 1.5041e-03, PNorm = 65.8135, GNorm = 1.2017, lr_0 = 5.5269e-04
Validation rmse = 0.824358
Epoch 9
Loss = 1.5658e-03, PNorm = 65.8426, GNorm = 0.8173, lr_0 = 5.2928e-04
Loss = 1.6220e-03, PNorm = 65.8667, GNorm = 1.0375, lr_0 = 5.0686e-04
Validation rmse = 1.072817
Epoch 10
Loss = 1.7858e-03, PNorm = 65.8936, GNorm = 0.7461, lr_0 = 4.8539e-04
Loss = 1.3352e-03, PNorm = 65.9203, GNorm = 1.2418, lr_0 = 4.6483e-04
Validation rmse = 0.859428
Epoch 11
Loss = 1.6448e-03, PNorm = 65.9471, GNorm = 1.1916, lr_0 = 4.4322e-04
Loss = 1.4723e-03, PNorm = 65.9712, GNorm = 1.0430, lr_0 = 4.2444e-04
Validation rmse = 0.841673
Epoch 12
Loss = 1.3316e-03, PNorm = 65.9970, GNorm = 0.8530, lr_0 = 4.0646e-04
Loss = 1.4464e-03, PNorm = 66.0191, GNorm = 0.4445, lr_0 = 3.8925e-04
Validation rmse = 0.882284
Epoch 13
Loss = 1.7092e-03, PNorm = 66.0404, GNorm = 1.3642, lr_0 = 3.7276e-04
Loss = 1.4065e-03, PNorm = 66.0632, GNorm = 1.3635, lr_0 = 3.5697e-04
Validation rmse = 0.859652
Epoch 14
Loss = 1.2433e-03, PNorm = 66.0896, GNorm = 1.1375, lr_0 = 3.4037e-04
Loss = 1.2910e-03, PNorm = 66.1091, GNorm = 0.7478, lr_0 = 3.2596e-04
Validation rmse = 0.908764
Epoch 15
Loss = 1.1909e-03, PNorm = 66.1253, GNorm = 0.6091, lr_0 = 3.1215e-04
Loss = 1.0166e-03, PNorm = 66.1459, GNorm = 0.3915, lr_0 = 2.9893e-04
Validation rmse = 0.864359
Epoch 16
Loss = 1.0243e-03, PNorm = 66.1617, GNorm = 0.4655, lr_0 = 2.8503e-04
Loss = 1.1200e-03, PNorm = 66.1762, GNorm = 0.7082, lr_0 = 2.7295e-04
Validation rmse = 0.845403
Epoch 17
Loss = 1.0147e-03, PNorm = 66.1929, GNorm = 0.5450, lr_0 = 2.6139e-04
Loss = 1.0927e-03, PNorm = 66.2071, GNorm = 0.8487, lr_0 = 2.5032e-04
Validation rmse = 0.844973
Epoch 18
Loss = 1.0586e-03, PNorm = 66.2211, GNorm = 0.7007, lr_0 = 2.3972e-04
Loss = 1.0763e-03, PNorm = 66.2371, GNorm = 0.9087, lr_0 = 2.2956e-04
Validation rmse = 0.889542
Epoch 19
Loss = 8.7197e-04, PNorm = 66.2512, GNorm = 0.5961, lr_0 = 2.1889e-04
Loss = 1.3636e-03, PNorm = 66.2620, GNorm = 0.6994, lr_0 = 2.0962e-04
Validation rmse = 0.912542
Epoch 20
Loss = 9.6741e-04, PNorm = 66.2762, GNorm = 0.7025, lr_0 = 2.0074e-04
Loss = 9.8516e-04, PNorm = 66.2907, GNorm = 0.4041, lr_0 = 1.9224e-04
Validation rmse = 0.870183
Epoch 21
Loss = 9.7038e-04, PNorm = 66.3045, GNorm = 1.2626, lr_0 = 1.8409e-04
Loss = 1.2218e-03, PNorm = 66.3158, GNorm = 1.4297, lr_0 = 1.7630e-04
Validation rmse = 0.888618
Epoch 22
Loss = 9.6211e-04, PNorm = 66.3282, GNorm = 0.6069, lr_0 = 1.6810e-04
Loss = 9.0344e-04, PNorm = 66.3378, GNorm = 0.6832, lr_0 = 1.6098e-04
Validation rmse = 0.917041
Epoch 23
Loss = 9.4013e-04, PNorm = 66.3475, GNorm = 0.4433, lr_0 = 1.5416e-04
Loss = 9.4020e-04, PNorm = 66.3550, GNorm = 0.5029, lr_0 = 1.4763e-04
Loss = 1.3441e-03, PNorm = 66.3558, GNorm = 0.6098, lr_0 = 1.4699e-04
Validation rmse = 0.887175
Epoch 24
Loss = 9.2356e-04, PNorm = 66.3662, GNorm = 0.4520, lr_0 = 1.4077e-04
Loss = 8.3599e-04, PNorm = 66.3730, GNorm = 0.5557, lr_0 = 1.3480e-04
Validation rmse = 0.888185
Epoch 25
Loss = 7.4615e-04, PNorm = 66.3811, GNorm = 0.3029, lr_0 = 1.2909e-04
Loss = 9.5195e-04, PNorm = 66.3885, GNorm = 1.2127, lr_0 = 1.2362e-04
Validation rmse = 0.902026
Epoch 26
Loss = 9.0651e-04, PNorm = 66.3962, GNorm = 1.0300, lr_0 = 1.1839e-04
Validation rmse = 0.915962
Epoch 27
Loss = 1.1561e-03, PNorm = 66.4024, GNorm = 1.4915, lr_0 = 1.1288e-04
Loss = 9.5632e-04, PNorm = 66.4095, GNorm = 1.0950, lr_0 = 1.0810e-04
Validation rmse = 0.936538
Epoch 28
Loss = 7.0688e-04, PNorm = 66.4152, GNorm = 0.7758, lr_0 = 1.0352e-04
Loss = 8.6289e-04, PNorm = 66.4231, GNorm = 0.8554, lr_0 = 1.0000e-04
Validation rmse = 0.944349
Epoch 29
Loss = 6.9031e-04, PNorm = 66.4303, GNorm = 0.3704, lr_0 = 1.0000e-04
Loss = 8.9187e-04, PNorm = 66.4386, GNorm = 1.0216, lr_0 = 1.0000e-04
Validation rmse = 0.907449
Model 0 best validation rmse = 0.824358 on epoch 8
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.935002
Ensemble test rmse = 0.935002
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total scaffolds = 195 | train scaffolds = 55 | val scaffolds = 64 | test scaffolds = 76
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1304, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,443,101
Moving model to cuda
Epoch 0
Loss = 1.3978e-02, PNorm = 65.0516, GNorm = 3.0481, lr_0 = 3.6053e-04
Validation rmse = 1.305302
Epoch 1
Loss = 6.0158e-03, PNorm = 65.1110, GNorm = 1.5839, lr_0 = 6.2105e-04
Loss = 5.9294e-03, PNorm = 65.1855, GNorm = 4.2438, lr_0 = 8.5789e-04
Validation rmse = 1.279193
Epoch 2
Loss = 5.7676e-03, PNorm = 65.2677, GNorm = 2.4407, lr_0 = 9.8284e-04
Loss = 3.1804e-03, PNorm = 65.3324, GNorm = 0.7840, lr_0 = 9.4120e-04
Validation rmse = 1.121898
Epoch 3
Loss = 2.2433e-03, PNorm = 65.3901, GNorm = 0.4321, lr_0 = 8.9744e-04
Loss = 2.5671e-03, PNorm = 65.4371, GNorm = 1.0295, lr_0 = 8.5943e-04
Validation rmse = 1.072079
Epoch 4
Loss = 1.3139e-03, PNorm = 65.4802, GNorm = 0.4065, lr_0 = 8.2303e-04
Loss = 2.4428e-03, PNorm = 65.5258, GNorm = 0.9566, lr_0 = 7.8816e-04
Validation rmse = 1.080155
Epoch 5
Loss = 1.3652e-03, PNorm = 65.5672, GNorm = 0.6949, lr_0 = 7.5478e-04
Loss = 2.4341e-03, PNorm = 65.6064, GNorm = 0.6130, lr_0 = 7.2281e-04
Validation rmse = 0.950317
Epoch 6
Loss = 1.8722e-03, PNorm = 65.6532, GNorm = 0.6100, lr_0 = 6.8920e-04
Loss = 2.1492e-03, PNorm = 65.6883, GNorm = 0.4591, lr_0 = 6.6001e-04
Validation rmse = 1.024531
Epoch 7
Loss = 2.3211e-03, PNorm = 65.7240, GNorm = 0.4122, lr_0 = 6.3205e-04
Loss = 2.0203e-03, PNorm = 65.7591, GNorm = 0.6619, lr_0 = 6.0528e-04
Validation rmse = 0.920821
Epoch 8
Loss = 2.1329e-03, PNorm = 65.7954, GNorm = 0.3922, lr_0 = 5.7714e-04
Loss = 1.7031e-03, PNorm = 65.8254, GNorm = 0.6339, lr_0 = 5.5269e-04
Validation rmse = 0.933979
Epoch 9
Loss = 1.6303e-03, PNorm = 65.8521, GNorm = 1.0723, lr_0 = 5.2928e-04
Loss = 1.8211e-03, PNorm = 65.8787, GNorm = 1.2246, lr_0 = 5.0686e-04
Validation rmse = 0.916546
Epoch 10
Loss = 1.8847e-03, PNorm = 65.9028, GNorm = 0.7633, lr_0 = 4.8539e-04
Loss = 1.6812e-03, PNorm = 65.9272, GNorm = 0.4510, lr_0 = 4.6483e-04
Validation rmse = 0.905531
Epoch 11
Loss = 2.1861e-03, PNorm = 65.9589, GNorm = 1.9011, lr_0 = 4.4322e-04
Loss = 1.6631e-03, PNorm = 65.9889, GNorm = 0.2869, lr_0 = 4.2444e-04
Validation rmse = 0.921471
Epoch 12
Loss = 1.2518e-03, PNorm = 66.0148, GNorm = 0.3779, lr_0 = 4.0646e-04
Loss = 1.3034e-03, PNorm = 66.0352, GNorm = 0.4568, lr_0 = 3.8925e-04
Validation rmse = 0.907522
Epoch 13
Loss = 1.5446e-03, PNorm = 66.0553, GNorm = 0.8689, lr_0 = 3.7276e-04
Loss = 1.6193e-03, PNorm = 66.0749, GNorm = 0.3197, lr_0 = 3.5697e-04
Validation rmse = 0.945652
Epoch 14
Loss = 1.5289e-03, PNorm = 66.0981, GNorm = 1.4289, lr_0 = 3.4037e-04
Loss = 1.4781e-03, PNorm = 66.1225, GNorm = 0.8752, lr_0 = 3.2596e-04
Validation rmse = 0.965222
Epoch 15
Loss = 1.4887e-03, PNorm = 66.1396, GNorm = 0.9485, lr_0 = 3.1215e-04
Loss = 1.3455e-03, PNorm = 66.1580, GNorm = 0.4613, lr_0 = 2.9893e-04
Validation rmse = 0.991385
Epoch 16
Loss = 1.3148e-03, PNorm = 66.1793, GNorm = 0.3286, lr_0 = 2.8503e-04
Loss = 1.2460e-03, PNorm = 66.1968, GNorm = 0.8144, lr_0 = 2.7295e-04
Validation rmse = 0.891333
Epoch 17
Loss = 1.4340e-03, PNorm = 66.2134, GNorm = 1.3896, lr_0 = 2.6139e-04
Loss = 1.2543e-03, PNorm = 66.2301, GNorm = 1.0535, lr_0 = 2.5032e-04
Validation rmse = 1.054002
Epoch 18
Loss = 1.1899e-03, PNorm = 66.2449, GNorm = 0.2858, lr_0 = 2.3972e-04
Loss = 1.3757e-03, PNorm = 66.2613, GNorm = 0.5941, lr_0 = 2.2956e-04
Validation rmse = 0.971507
Epoch 19
Loss = 1.1427e-03, PNorm = 66.2775, GNorm = 0.9845, lr_0 = 2.1889e-04
Loss = 1.2217e-03, PNorm = 66.2905, GNorm = 1.0577, lr_0 = 2.0962e-04
Validation rmse = 0.933935
Epoch 20
Loss = 9.4806e-04, PNorm = 66.3014, GNorm = 0.7356, lr_0 = 2.0074e-04
Loss = 1.1879e-03, PNorm = 66.3148, GNorm = 0.6000, lr_0 = 1.9224e-04
Validation rmse = 0.971529
Epoch 21
Loss = 1.0979e-03, PNorm = 66.3260, GNorm = 0.7903, lr_0 = 1.8409e-04
Loss = 9.7446e-04, PNorm = 66.3382, GNorm = 0.3835, lr_0 = 1.7630e-04
Validation rmse = 1.021053
Epoch 22
Loss = 1.0810e-03, PNorm = 66.3503, GNorm = 0.4464, lr_0 = 1.6810e-04
Loss = 1.0826e-03, PNorm = 66.3626, GNorm = 0.8626, lr_0 = 1.6098e-04
Validation rmse = 0.934593
Epoch 23
Loss = 8.6464e-04, PNorm = 66.3718, GNorm = 1.2316, lr_0 = 1.5416e-04
Loss = 1.0651e-03, PNorm = 66.3806, GNorm = 0.7296, lr_0 = 1.4763e-04
Loss = 2.4368e-03, PNorm = 66.3810, GNorm = 1.1427, lr_0 = 1.4699e-04
Validation rmse = 0.968261
Epoch 24
Loss = 1.0653e-03, PNorm = 66.3910, GNorm = 1.0030, lr_0 = 1.4077e-04
Loss = 1.1116e-03, PNorm = 66.4013, GNorm = 0.3195, lr_0 = 1.3480e-04
Validation rmse = 0.987952
Epoch 25
Loss = 1.2403e-03, PNorm = 66.4131, GNorm = 0.2896, lr_0 = 1.2909e-04
Loss = 7.7122e-04, PNorm = 66.4219, GNorm = 0.4849, lr_0 = 1.2362e-04
Validation rmse = 0.959727
Epoch 26
Loss = 9.5301e-04, PNorm = 66.4321, GNorm = 0.5783, lr_0 = 1.1839e-04
Validation rmse = 0.976430
Epoch 27
Loss = 6.5147e-04, PNorm = 66.4400, GNorm = 0.3896, lr_0 = 1.1288e-04
Loss = 9.0601e-04, PNorm = 66.4476, GNorm = 0.7182, lr_0 = 1.0810e-04
Validation rmse = 0.947610
Epoch 28
Loss = 1.0613e-03, PNorm = 66.4553, GNorm = 0.5959, lr_0 = 1.0352e-04
Loss = 8.0839e-04, PNorm = 66.4627, GNorm = 0.6796, lr_0 = 1.0000e-04
Validation rmse = 0.956191
Epoch 29
Loss = 8.5284e-04, PNorm = 66.4694, GNorm = 0.4161, lr_0 = 1.0000e-04
Loss = 7.6836e-04, PNorm = 66.4762, GNorm = 0.6868, lr_0 = 1.0000e-04
Validation rmse = 0.974714
Model 0 best validation rmse = 0.891333 on epoch 16
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.000727
Ensemble test rmse = 1.000727
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total scaffolds = 195 | train scaffolds = 80 | val scaffolds = 54 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1304, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,443,101
Moving model to cuda
Epoch 0
Loss = 1.3696e-02, PNorm = 65.0546, GNorm = 18.7609, lr_0 = 3.6053e-04
Validation rmse = 1.289204
Epoch 1
Loss = 4.9046e-03, PNorm = 65.1143, GNorm = 0.8347, lr_0 = 6.2105e-04
Loss = 4.2108e-03, PNorm = 65.1900, GNorm = 1.8764, lr_0 = 8.5789e-04
Validation rmse = 1.131003
Epoch 2
Loss = 3.5140e-03, PNorm = 65.2672, GNorm = 1.3854, lr_0 = 9.8284e-04
Loss = 2.8809e-03, PNorm = 65.3380, GNorm = 2.6000, lr_0 = 9.4120e-04
Validation rmse = 1.025945
Epoch 3
Loss = 2.1425e-03, PNorm = 65.4074, GNorm = 0.4930, lr_0 = 8.9744e-04
Loss = 2.2224e-03, PNorm = 65.4608, GNorm = 0.9406, lr_0 = 8.5943e-04
Validation rmse = 1.058007
Epoch 4
Loss = 2.4356e-03, PNorm = 65.5093, GNorm = 1.5540, lr_0 = 8.2303e-04
Loss = 2.1180e-03, PNorm = 65.5581, GNorm = 0.6828, lr_0 = 7.8816e-04
Validation rmse = 1.335031
Epoch 5
Loss = 1.6650e-03, PNorm = 65.6010, GNorm = 0.6076, lr_0 = 7.5478e-04
Loss = 1.9667e-03, PNorm = 65.6438, GNorm = 1.3473, lr_0 = 7.2281e-04
Validation rmse = 1.038728
Epoch 6
Loss = 1.9552e-03, PNorm = 65.6873, GNorm = 0.9179, lr_0 = 6.8920e-04
Loss = 1.8985e-03, PNorm = 65.7260, GNorm = 0.6563, lr_0 = 6.6001e-04
Validation rmse = 1.023916
Epoch 7
Loss = 1.7030e-03, PNorm = 65.7620, GNorm = 1.1131, lr_0 = 6.3205e-04
Loss = 1.6231e-03, PNorm = 65.7943, GNorm = 0.6226, lr_0 = 6.0528e-04
Validation rmse = 1.212863
Epoch 8
Loss = 2.6040e-03, PNorm = 65.8313, GNorm = 1.8265, lr_0 = 5.7714e-04
Loss = 1.8280e-03, PNorm = 65.8698, GNorm = 0.5609, lr_0 = 5.5269e-04
Validation rmse = 1.075890
Epoch 9
Loss = 1.6851e-03, PNorm = 65.9034, GNorm = 1.6380, lr_0 = 5.2928e-04
Loss = 1.6227e-03, PNorm = 65.9360, GNorm = 1.1673, lr_0 = 5.0686e-04
Validation rmse = 0.974167
Epoch 10
Loss = 1.2732e-03, PNorm = 65.9633, GNorm = 0.6938, lr_0 = 4.8539e-04
Loss = 1.3986e-03, PNorm = 65.9892, GNorm = 0.7495, lr_0 = 4.6483e-04
Validation rmse = 1.022354
Epoch 11
Loss = 1.2853e-03, PNorm = 66.0201, GNorm = 0.5872, lr_0 = 4.4322e-04
Loss = 1.4387e-03, PNorm = 66.0473, GNorm = 0.6048, lr_0 = 4.2444e-04
Validation rmse = 1.006744
Epoch 12
Loss = 1.1391e-03, PNorm = 66.0718, GNorm = 0.2754, lr_0 = 4.0646e-04
Loss = 1.1080e-03, PNorm = 66.0930, GNorm = 0.7817, lr_0 = 3.8925e-04
Validation rmse = 0.972638
Epoch 13
Loss = 1.1591e-03, PNorm = 66.1124, GNorm = 1.2943, lr_0 = 3.7276e-04
Loss = 1.2752e-03, PNorm = 66.1356, GNorm = 0.8081, lr_0 = 3.5697e-04
Validation rmse = 1.009303
Epoch 14
Loss = 1.1484e-03, PNorm = 66.1573, GNorm = 0.7552, lr_0 = 3.4037e-04
Loss = 1.0488e-03, PNorm = 66.1733, GNorm = 0.7739, lr_0 = 3.2596e-04
Validation rmse = 1.043199
Epoch 15
Loss = 1.3515e-03, PNorm = 66.1904, GNorm = 0.9087, lr_0 = 3.1215e-04
Loss = 1.3241e-03, PNorm = 66.2085, GNorm = 0.6049, lr_0 = 2.9893e-04
Validation rmse = 1.019295
Epoch 16
Loss = 9.2150e-04, PNorm = 66.2279, GNorm = 0.7410, lr_0 = 2.8503e-04
Loss = 1.1571e-03, PNorm = 66.2438, GNorm = 0.9371, lr_0 = 2.7295e-04
Validation rmse = 1.089564
Epoch 17
Loss = 1.0509e-03, PNorm = 66.2583, GNorm = 0.5127, lr_0 = 2.6139e-04
Loss = 9.7225e-04, PNorm = 66.2725, GNorm = 0.3938, lr_0 = 2.5032e-04
Validation rmse = 1.010610
Epoch 18
Loss = 8.2497e-04, PNorm = 66.2849, GNorm = 0.3723, lr_0 = 2.3972e-04
Loss = 1.0086e-03, PNorm = 66.2994, GNorm = 0.4528, lr_0 = 2.2956e-04
Validation rmse = 1.030039
Epoch 19
Loss = 9.4069e-04, PNorm = 66.3146, GNorm = 0.2393, lr_0 = 2.1889e-04
Loss = 8.7378e-04, PNorm = 66.3254, GNorm = 0.5847, lr_0 = 2.0962e-04
Validation rmse = 0.994054
Epoch 20
Loss = 8.3127e-04, PNorm = 66.3347, GNorm = 0.4853, lr_0 = 2.0074e-04
Loss = 9.7819e-04, PNorm = 66.3471, GNorm = 0.4029, lr_0 = 1.9224e-04
Validation rmse = 1.042402
Epoch 21
Loss = 7.6334e-04, PNorm = 66.3589, GNorm = 0.4220, lr_0 = 1.8409e-04
Loss = 8.2975e-04, PNorm = 66.3670, GNorm = 1.0168, lr_0 = 1.7630e-04
Validation rmse = 1.098010
Epoch 22
Loss = 1.0988e-03, PNorm = 66.3791, GNorm = 0.6654, lr_0 = 1.6810e-04
Loss = 9.2771e-04, PNorm = 66.3887, GNorm = 0.5035, lr_0 = 1.6098e-04
Validation rmse = 1.038703
Epoch 23
Loss = 8.8874e-04, PNorm = 66.3988, GNorm = 0.6427, lr_0 = 1.5416e-04
Loss = 8.4491e-04, PNorm = 66.4066, GNorm = 1.0667, lr_0 = 1.4763e-04
Loss = 1.4222e-03, PNorm = 66.4076, GNorm = 0.5525, lr_0 = 1.4699e-04
Validation rmse = 1.033018
Epoch 24
Loss = 7.3853e-04, PNorm = 66.4157, GNorm = 0.5162, lr_0 = 1.4077e-04
Loss = 9.2624e-04, PNorm = 66.4245, GNorm = 0.6480, lr_0 = 1.3480e-04
Validation rmse = 1.077691
Epoch 25
Loss = 7.4129e-04, PNorm = 66.4308, GNorm = 0.4419, lr_0 = 1.2909e-04
Loss = 8.1850e-04, PNorm = 66.4364, GNorm = 0.8770, lr_0 = 1.2362e-04
Validation rmse = 1.007033
Epoch 26
Loss = 8.8123e-04, PNorm = 66.4438, GNorm = 0.8018, lr_0 = 1.1839e-04
Validation rmse = 1.052807
Epoch 27
Loss = 7.5479e-04, PNorm = 66.4503, GNorm = 0.2830, lr_0 = 1.1288e-04
Loss = 7.4872e-04, PNorm = 66.4576, GNorm = 0.7114, lr_0 = 1.0810e-04
Validation rmse = 1.026298
Epoch 28
Loss = 4.7692e-04, PNorm = 66.4618, GNorm = 0.2970, lr_0 = 1.0352e-04
Loss = 7.2533e-04, PNorm = 66.4671, GNorm = 0.6798, lr_0 = 1.0000e-04
Validation rmse = 1.026901
Epoch 29
Loss = 6.0470e-04, PNorm = 66.4739, GNorm = 0.2476, lr_0 = 1.0000e-04
Loss = 6.8206e-04, PNorm = 66.4790, GNorm = 0.6142, lr_0 = 1.0000e-04
Validation rmse = 1.021551
Model 0 best validation rmse = 0.972638 on epoch 12
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.844331
Ensemble test rmse = 0.844331
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 49 | test scaffolds = 62
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1304, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,443,101
Moving model to cuda
Epoch 0
Loss = 1.4946e-02, PNorm = 65.0499, GNorm = 2.5699, lr_0 = 3.6053e-04
Validation rmse = 1.093168
Epoch 1
Loss = 6.3487e-03, PNorm = 65.1210, GNorm = 3.1432, lr_0 = 6.2105e-04
Loss = 4.3542e-03, PNorm = 65.1983, GNorm = 2.5541, lr_0 = 8.5789e-04
Validation rmse = 1.099967
Epoch 2
Loss = 3.5007e-03, PNorm = 65.2797, GNorm = 2.4476, lr_0 = 9.8284e-04
Loss = 4.2075e-03, PNorm = 65.3570, GNorm = 1.6238, lr_0 = 9.4120e-04
Validation rmse = 1.103953
Epoch 3
Loss = 2.5187e-03, PNorm = 65.4249, GNorm = 0.5753, lr_0 = 8.9744e-04
Loss = 2.7144e-03, PNorm = 65.4793, GNorm = 0.8276, lr_0 = 8.5943e-04
Validation rmse = 0.909662
Epoch 4
Loss = 1.7420e-03, PNorm = 65.5261, GNorm = 0.5954, lr_0 = 8.2303e-04
Loss = 2.1279e-03, PNorm = 65.5694, GNorm = 0.6833, lr_0 = 7.8816e-04
Validation rmse = 0.882753
Epoch 5
Loss = 1.8050e-03, PNorm = 65.6081, GNorm = 0.9203, lr_0 = 7.5478e-04
Loss = 2.0470e-03, PNorm = 65.6483, GNorm = 0.7743, lr_0 = 7.2281e-04
Validation rmse = 0.893989
Epoch 6
Loss = 1.9696e-03, PNorm = 65.6929, GNorm = 0.8501, lr_0 = 6.8920e-04
Loss = 2.3432e-03, PNorm = 65.7311, GNorm = 0.7784, lr_0 = 6.6001e-04
Validation rmse = 0.823308
Epoch 7
Loss = 1.6028e-03, PNorm = 65.7682, GNorm = 0.6806, lr_0 = 6.3205e-04
Loss = 2.3643e-03, PNorm = 65.8048, GNorm = 0.9875, lr_0 = 6.0528e-04
Validation rmse = 0.916438
Epoch 8
Loss = 2.0118e-03, PNorm = 65.8418, GNorm = 1.1019, lr_0 = 5.7714e-04
Loss = 1.7004e-03, PNorm = 65.8698, GNorm = 1.0175, lr_0 = 5.5269e-04
Validation rmse = 0.895599
Epoch 9
Loss = 1.3705e-03, PNorm = 65.9012, GNorm = 0.6852, lr_0 = 5.2928e-04
Loss = 1.8113e-03, PNorm = 65.9333, GNorm = 0.2963, lr_0 = 5.0686e-04
Validation rmse = 0.777248
Epoch 10
Loss = 1.6224e-03, PNorm = 65.9618, GNorm = 0.9981, lr_0 = 4.8539e-04
Loss = 2.1041e-03, PNorm = 65.9910, GNorm = 1.1787, lr_0 = 4.6483e-04
Validation rmse = 0.843924
Epoch 11
Loss = 1.2889e-03, PNorm = 66.0210, GNorm = 0.5560, lr_0 = 4.4322e-04
Loss = 1.5161e-03, PNorm = 66.0426, GNorm = 0.3960, lr_0 = 4.2444e-04
Validation rmse = 0.814209
Epoch 12
Loss = 1.1283e-03, PNorm = 66.0630, GNorm = 0.7243, lr_0 = 4.0646e-04
Loss = 1.4465e-03, PNorm = 66.0873, GNorm = 0.3409, lr_0 = 3.8925e-04
Validation rmse = 0.833461
Epoch 13
Loss = 1.1545e-03, PNorm = 66.1083, GNorm = 1.0406, lr_0 = 3.7276e-04
Loss = 1.5261e-03, PNorm = 66.1317, GNorm = 0.7522, lr_0 = 3.5697e-04
Validation rmse = 0.819226
Epoch 14
Loss = 1.0841e-03, PNorm = 66.1544, GNorm = 0.5805, lr_0 = 3.4037e-04
Loss = 1.5246e-03, PNorm = 66.1762, GNorm = 0.4551, lr_0 = 3.2596e-04
Validation rmse = 0.764098
Epoch 15
Loss = 1.1921e-03, PNorm = 66.1949, GNorm = 0.8537, lr_0 = 3.1215e-04
Loss = 1.3360e-03, PNorm = 66.2152, GNorm = 0.5833, lr_0 = 2.9893e-04
Validation rmse = 0.776747
Epoch 16
Loss = 9.4341e-04, PNorm = 66.2343, GNorm = 0.5855, lr_0 = 2.8503e-04
Loss = 1.4619e-03, PNorm = 66.2503, GNorm = 0.6092, lr_0 = 2.7295e-04
Validation rmse = 0.786809
Epoch 17
Loss = 1.2122e-03, PNorm = 66.2653, GNorm = 0.6916, lr_0 = 2.6139e-04
Loss = 1.2954e-03, PNorm = 66.2795, GNorm = 0.9914, lr_0 = 2.5032e-04
Validation rmse = 0.788100
Epoch 18
Loss = 1.6921e-03, PNorm = 66.2968, GNorm = 1.0084, lr_0 = 2.3972e-04
Loss = 1.1503e-03, PNorm = 66.3154, GNorm = 0.4559, lr_0 = 2.2956e-04
Validation rmse = 0.773073
Epoch 19
Loss = 9.6551e-04, PNorm = 66.3300, GNorm = 0.2788, lr_0 = 2.1889e-04
Loss = 1.1052e-03, PNorm = 66.3456, GNorm = 0.4676, lr_0 = 2.0962e-04
Validation rmse = 0.754093
Epoch 20
Loss = 1.0359e-03, PNorm = 66.3582, GNorm = 0.5133, lr_0 = 2.0074e-04
Loss = 9.8395e-04, PNorm = 66.3704, GNorm = 0.9070, lr_0 = 1.9224e-04
Validation rmse = 0.798934
Epoch 21
Loss = 1.0078e-03, PNorm = 66.3832, GNorm = 0.7986, lr_0 = 1.8409e-04
Loss = 1.0368e-03, PNorm = 66.3951, GNorm = 0.8258, lr_0 = 1.7630e-04
Validation rmse = 0.848473
Epoch 22
Loss = 8.9775e-04, PNorm = 66.4068, GNorm = 0.5999, lr_0 = 1.6810e-04
Loss = 1.0218e-03, PNorm = 66.4185, GNorm = 0.4141, lr_0 = 1.6098e-04
Validation rmse = 0.774228
Epoch 23
Loss = 9.0474e-04, PNorm = 66.4271, GNorm = 0.5905, lr_0 = 1.5416e-04
Loss = 7.6979e-04, PNorm = 66.4366, GNorm = 0.4251, lr_0 = 1.4763e-04
Loss = 1.7505e-03, PNorm = 66.4374, GNorm = 0.6480, lr_0 = 1.4699e-04
Validation rmse = 0.747375
Epoch 24
Loss = 9.4717e-04, PNorm = 66.4449, GNorm = 0.5703, lr_0 = 1.4077e-04
Loss = 9.6310e-04, PNorm = 66.4531, GNorm = 0.6719, lr_0 = 1.3480e-04
Validation rmse = 0.797632
Epoch 25
Loss = 8.3947e-04, PNorm = 66.4614, GNorm = 0.6469, lr_0 = 1.2909e-04
Loss = 1.0497e-03, PNorm = 66.4695, GNorm = 0.9522, lr_0 = 1.2362e-04
Validation rmse = 0.775391
Epoch 26
Loss = 7.1467e-04, PNorm = 66.4783, GNorm = 0.2764, lr_0 = 1.1839e-04
Validation rmse = 0.771150
Epoch 27
Loss = 7.2864e-04, PNorm = 66.4866, GNorm = 0.4553, lr_0 = 1.1288e-04
Loss = 7.6518e-04, PNorm = 66.4925, GNorm = 1.0983, lr_0 = 1.0810e-04
Validation rmse = 0.764903
Epoch 28
Loss = 4.6257e-04, PNorm = 66.4999, GNorm = 0.6599, lr_0 = 1.0352e-04
Loss = 8.3808e-04, PNorm = 66.5052, GNorm = 0.6255, lr_0 = 1.0000e-04
Validation rmse = 0.786403
Epoch 29
Loss = 7.5902e-04, PNorm = 66.5123, GNorm = 0.4381, lr_0 = 1.0000e-04
Loss = 9.3355e-04, PNorm = 66.5193, GNorm = 0.4565, lr_0 = 1.0000e-04
Validation rmse = 0.761434
Model 0 best validation rmse = 0.747375 on epoch 23
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.907345
Ensemble test rmse = 0.907345
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total scaffolds = 195 | train scaffolds = 94 | val scaffolds = 55 | test scaffolds = 46
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1304, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,443,101
Moving model to cuda
Epoch 0
Loss = 1.4536e-02, PNorm = 65.0517, GNorm = 11.7434, lr_0 = 3.6053e-04
Validation rmse = 1.608901
Epoch 1
Loss = 5.0094e-03, PNorm = 65.1165, GNorm = 1.8501, lr_0 = 6.2105e-04
Loss = 4.7825e-03, PNorm = 65.1930, GNorm = 2.8684, lr_0 = 8.5789e-04
Validation rmse = 1.537414
Epoch 2
Loss = 4.0580e-03, PNorm = 65.2809, GNorm = 1.1443, lr_0 = 9.8284e-04
Loss = 3.5530e-03, PNorm = 65.3616, GNorm = 0.8808, lr_0 = 9.4120e-04
Validation rmse = 1.112581
Epoch 3
Loss = 3.0657e-03, PNorm = 65.4287, GNorm = 1.1548, lr_0 = 8.9744e-04
Loss = 2.9906e-03, PNorm = 65.4828, GNorm = 0.6811, lr_0 = 8.5943e-04
Validation rmse = 1.054031
Epoch 4
Loss = 2.0438e-03, PNorm = 65.5273, GNorm = 0.9490, lr_0 = 8.2303e-04
Loss = 2.1101e-03, PNorm = 65.5742, GNorm = 0.8717, lr_0 = 7.8816e-04
Validation rmse = 1.115361
Epoch 5
Loss = 1.8591e-03, PNorm = 65.6086, GNorm = 0.4403, lr_0 = 7.5478e-04
Loss = 2.5332e-03, PNorm = 65.6446, GNorm = 1.3929, lr_0 = 7.2281e-04
Validation rmse = 1.017965
Epoch 6
Loss = 2.9160e-03, PNorm = 65.6919, GNorm = 1.0013, lr_0 = 6.8920e-04
Loss = 2.5414e-03, PNorm = 65.7391, GNorm = 0.9739, lr_0 = 6.6001e-04
Validation rmse = 1.129991
Epoch 7
Loss = 1.6234e-03, PNorm = 65.7764, GNorm = 0.5134, lr_0 = 6.3205e-04
Loss = 1.9112e-03, PNorm = 65.8155, GNorm = 1.2305, lr_0 = 6.0528e-04
Validation rmse = 1.024980
Epoch 8
Loss = 1.6161e-03, PNorm = 65.8486, GNorm = 0.7306, lr_0 = 5.7714e-04
Loss = 1.8081e-03, PNorm = 65.8799, GNorm = 0.7365, lr_0 = 5.5269e-04
Validation rmse = 0.963413
Epoch 9
Loss = 1.9511e-03, PNorm = 65.9093, GNorm = 0.7134, lr_0 = 5.2928e-04
Loss = 1.7820e-03, PNorm = 65.9418, GNorm = 0.5627, lr_0 = 5.0686e-04
Validation rmse = 1.058893
Epoch 10
Loss = 1.7594e-03, PNorm = 65.9716, GNorm = 0.8530, lr_0 = 4.8539e-04
Loss = 2.1306e-03, PNorm = 65.9956, GNorm = 1.0336, lr_0 = 4.6483e-04
Validation rmse = 0.926397
Epoch 11
Loss = 1.6322e-03, PNorm = 66.0277, GNorm = 0.3939, lr_0 = 4.4322e-04
Loss = 1.4739e-03, PNorm = 66.0543, GNorm = 0.6381, lr_0 = 4.2444e-04
Validation rmse = 0.971405
Epoch 12
Loss = 1.3211e-03, PNorm = 66.0791, GNorm = 0.7700, lr_0 = 4.0646e-04
Loss = 1.5348e-03, PNorm = 66.1014, GNorm = 0.9358, lr_0 = 3.8925e-04
Validation rmse = 0.967485
Epoch 13
Loss = 1.3845e-03, PNorm = 66.1229, GNorm = 0.4550, lr_0 = 3.7276e-04
Loss = 1.6803e-03, PNorm = 66.1438, GNorm = 0.5290, lr_0 = 3.5697e-04
Validation rmse = 1.119697
Epoch 14
Loss = 1.4177e-03, PNorm = 66.1718, GNorm = 0.7936, lr_0 = 3.4037e-04
Loss = 1.3229e-03, PNorm = 66.1888, GNorm = 0.8237, lr_0 = 3.2596e-04
Validation rmse = 1.050643
Epoch 15
Loss = 1.3336e-03, PNorm = 66.2104, GNorm = 0.5221, lr_0 = 3.1215e-04
Loss = 1.4789e-03, PNorm = 66.2324, GNorm = 0.7227, lr_0 = 2.9893e-04
Validation rmse = 1.050835
Epoch 16
Loss = 1.1464e-03, PNorm = 66.2525, GNorm = 0.4080, lr_0 = 2.8503e-04
Loss = 1.5419e-03, PNorm = 66.2706, GNorm = 0.6196, lr_0 = 2.7295e-04
Validation rmse = 1.031127
Epoch 17
Loss = 1.1944e-03, PNorm = 66.2920, GNorm = 0.5908, lr_0 = 2.6139e-04
Loss = 1.1891e-03, PNorm = 66.3061, GNorm = 0.4193, lr_0 = 2.5032e-04
Validation rmse = 1.004007
Epoch 18
Loss = 1.2473e-03, PNorm = 66.3219, GNorm = 0.3796, lr_0 = 2.3972e-04
Loss = 1.1047e-03, PNorm = 66.3372, GNorm = 0.3855, lr_0 = 2.2956e-04
Validation rmse = 0.998194
Epoch 19
Loss = 1.0138e-03, PNorm = 66.3541, GNorm = 0.4124, lr_0 = 2.1889e-04
Loss = 1.1799e-03, PNorm = 66.3663, GNorm = 0.5460, lr_0 = 2.0962e-04
Validation rmse = 1.009359
Epoch 20
Loss = 1.1532e-03, PNorm = 66.3806, GNorm = 0.3493, lr_0 = 2.0074e-04
Loss = 1.0710e-03, PNorm = 66.3934, GNorm = 0.6082, lr_0 = 1.9224e-04
Validation rmse = 0.989223
Epoch 21
Loss = 1.0025e-03, PNorm = 66.4033, GNorm = 0.7041, lr_0 = 1.8409e-04
Loss = 1.0956e-03, PNorm = 66.4159, GNorm = 0.7895, lr_0 = 1.7630e-04
Validation rmse = 0.990153
Epoch 22
Loss = 8.8072e-04, PNorm = 66.4268, GNorm = 0.3763, lr_0 = 1.6810e-04
Loss = 9.6313e-04, PNorm = 66.4366, GNorm = 0.3489, lr_0 = 1.6098e-04
Validation rmse = 0.971415
Epoch 23
Loss = 1.1744e-03, PNorm = 66.4475, GNorm = 0.5089, lr_0 = 1.5416e-04
Loss = 1.0496e-03, PNorm = 66.4573, GNorm = 0.4907, lr_0 = 1.4763e-04
Loss = 9.0159e-04, PNorm = 66.4585, GNorm = 0.3263, lr_0 = 1.4699e-04
Validation rmse = 1.041443
Epoch 24
Loss = 8.6216e-04, PNorm = 66.4669, GNorm = 0.4181, lr_0 = 1.4077e-04
Loss = 1.1196e-03, PNorm = 66.4748, GNorm = 0.4312, lr_0 = 1.3480e-04
Validation rmse = 1.031420
Epoch 25
Loss = 8.8352e-04, PNorm = 66.4842, GNorm = 0.5617, lr_0 = 1.2909e-04
Loss = 9.6205e-04, PNorm = 66.4925, GNorm = 1.0406, lr_0 = 1.2362e-04
Validation rmse = 1.021840
Epoch 26
Loss = 8.7822e-04, PNorm = 66.4998, GNorm = 0.7533, lr_0 = 1.1839e-04
Validation rmse = 0.998750
Epoch 27
Loss = 8.3692e-04, PNorm = 66.5094, GNorm = 0.5364, lr_0 = 1.1288e-04
Loss = 9.9970e-04, PNorm = 66.5176, GNorm = 0.8740, lr_0 = 1.0810e-04
Validation rmse = 0.952378
Epoch 28
Loss = 8.8202e-04, PNorm = 66.5245, GNorm = 0.3443, lr_0 = 1.0352e-04
Loss = 8.9526e-04, PNorm = 66.5308, GNorm = 0.9886, lr_0 = 1.0000e-04
Validation rmse = 0.980603
Epoch 29
Loss = 9.1374e-04, PNorm = 66.5364, GNorm = 0.5989, lr_0 = 1.0000e-04
Loss = 8.8540e-04, PNorm = 66.5438, GNorm = 0.4424, lr_0 = 1.0000e-04
Validation rmse = 1.005611
Model 0 best validation rmse = 0.926397 on epoch 10
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.985085
Ensemble test rmse = 0.985085
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total scaffolds = 195 | train scaffolds = 64 | val scaffolds = 68 | test scaffolds = 63
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -6.399748


Scaffold 7
Task 0: count = 14 | target average = -5.140965


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1304, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,443,101
Moving model to cuda
Epoch 0
Loss = 1.4480e-02, PNorm = 65.0521, GNorm = 1.7550, lr_0 = 3.6053e-04
Validation rmse = 1.659282
Epoch 1
Loss = 5.6340e-03, PNorm = 65.1162, GNorm = 4.2251, lr_0 = 6.2105e-04
Loss = 4.3068e-03, PNorm = 65.1921, GNorm = 2.9961, lr_0 = 8.5789e-04
Validation rmse = 1.363748
Epoch 2
Loss = 3.2682e-03, PNorm = 65.2659, GNorm = 1.2140, lr_0 = 9.8284e-04
Loss = 3.1818e-03, PNorm = 65.3348, GNorm = 0.6825, lr_0 = 9.4120e-04
Validation rmse = 1.166554
Epoch 3
Loss = 1.7285e-03, PNorm = 65.3979, GNorm = 1.5113, lr_0 = 8.9744e-04
Loss = 2.3133e-03, PNorm = 65.4444, GNorm = 0.7762, lr_0 = 8.5943e-04
Validation rmse = 1.210140
Epoch 4
Loss = 2.6397e-03, PNorm = 65.4938, GNorm = 1.3329, lr_0 = 8.2303e-04
Loss = 2.8200e-03, PNorm = 65.5395, GNorm = 1.0283, lr_0 = 7.8816e-04
Validation rmse = 1.264857
Epoch 5
Loss = 2.1242e-03, PNorm = 65.5848, GNorm = 1.3436, lr_0 = 7.5478e-04
Loss = 2.3558e-03, PNorm = 65.6240, GNorm = 0.4142, lr_0 = 7.2281e-04
Validation rmse = 1.213478
Epoch 6
Loss = 2.1149e-03, PNorm = 65.6681, GNorm = 0.3806, lr_0 = 6.8920e-04
Loss = 2.0972e-03, PNorm = 65.7117, GNorm = 0.7140, lr_0 = 6.6001e-04
Validation rmse = 1.008539
Epoch 7
Loss = 1.8999e-03, PNorm = 65.7452, GNorm = 0.7853, lr_0 = 6.3205e-04
Loss = 1.6083e-03, PNorm = 65.7796, GNorm = 1.1680, lr_0 = 6.0528e-04
Validation rmse = 0.975356
Epoch 8
Loss = 1.6741e-03, PNorm = 65.8159, GNorm = 0.4927, lr_0 = 5.7714e-04
Loss = 1.9444e-03, PNorm = 65.8491, GNorm = 0.6082, lr_0 = 5.5269e-04
Validation rmse = 1.173957
Epoch 9
Loss = 1.9321e-03, PNorm = 65.8862, GNorm = 0.9358, lr_0 = 5.2928e-04
Loss = 1.4108e-03, PNorm = 65.9170, GNorm = 0.4002, lr_0 = 5.0686e-04
Validation rmse = 0.977470
Epoch 10
Loss = 1.6691e-03, PNorm = 65.9468, GNorm = 0.9559, lr_0 = 4.8539e-04
Loss = 1.3778e-03, PNorm = 65.9812, GNorm = 0.5001, lr_0 = 4.6483e-04
Validation rmse = 1.056888
Epoch 11
Loss = 1.5473e-03, PNorm = 66.0061, GNorm = 0.5226, lr_0 = 4.4322e-04
Loss = 1.6664e-03, PNorm = 66.0330, GNorm = 1.2580, lr_0 = 4.2444e-04
Validation rmse = 0.982309
Epoch 12
Loss = 1.3180e-03, PNorm = 66.0523, GNorm = 0.4590, lr_0 = 4.0646e-04
Loss = 1.6809e-03, PNorm = 66.0763, GNorm = 1.0820, lr_0 = 3.8925e-04
Validation rmse = 0.967779
Epoch 13
Loss = 1.3354e-03, PNorm = 66.1022, GNorm = 0.7188, lr_0 = 3.7276e-04
Loss = 1.3117e-03, PNorm = 66.1289, GNorm = 0.5686, lr_0 = 3.5697e-04
Validation rmse = 1.008208
Epoch 14
Loss = 1.1848e-03, PNorm = 66.1511, GNorm = 0.3437, lr_0 = 3.4037e-04
Loss = 1.5008e-03, PNorm = 66.1737, GNorm = 1.1035, lr_0 = 3.2596e-04
Validation rmse = 1.013294
Epoch 15
Loss = 1.1050e-03, PNorm = 66.1952, GNorm = 0.3727, lr_0 = 3.1215e-04
Loss = 1.0614e-03, PNorm = 66.2168, GNorm = 0.9403, lr_0 = 2.9893e-04
Validation rmse = 0.983608
Epoch 16
Loss = 1.0181e-03, PNorm = 66.2395, GNorm = 0.3178, lr_0 = 2.8503e-04
Loss = 1.1604e-03, PNorm = 66.2596, GNorm = 0.7031, lr_0 = 2.7295e-04
Validation rmse = 1.107701
Epoch 17
Loss = 1.4287e-03, PNorm = 66.2776, GNorm = 0.5445, lr_0 = 2.6139e-04
Loss = 1.1563e-03, PNorm = 66.2920, GNorm = 0.9727, lr_0 = 2.5032e-04
Validation rmse = 1.045150
Epoch 18
Loss = 1.3273e-03, PNorm = 66.3089, GNorm = 1.1142, lr_0 = 2.3972e-04
Loss = 1.0460e-03, PNorm = 66.3254, GNorm = 0.3847, lr_0 = 2.2956e-04
Validation rmse = 1.023975
Epoch 19
Loss = 9.3823e-04, PNorm = 66.3437, GNorm = 0.1985, lr_0 = 2.1889e-04
Loss = 9.3253e-04, PNorm = 66.3566, GNorm = 0.5653, lr_0 = 2.0962e-04
Validation rmse = 1.050670
Epoch 20
Loss = 8.9419e-04, PNorm = 66.3707, GNorm = 0.4071, lr_0 = 2.0074e-04
Loss = 9.9886e-04, PNorm = 66.3823, GNorm = 0.3385, lr_0 = 1.9224e-04
Validation rmse = 1.018976
Epoch 21
Loss = 9.9034e-04, PNorm = 66.3984, GNorm = 0.4075, lr_0 = 1.8409e-04
Loss = 9.8249e-04, PNorm = 66.4097, GNorm = 0.3670, lr_0 = 1.7630e-04
Validation rmse = 1.078537
Epoch 22
Loss = 9.5330e-04, PNorm = 66.4184, GNorm = 0.8427, lr_0 = 1.6810e-04
Loss = 1.0054e-03, PNorm = 66.4275, GNorm = 0.6147, lr_0 = 1.6098e-04
Validation rmse = 1.016857
Epoch 23
Loss = 8.9751e-04, PNorm = 66.4378, GNorm = 0.4604, lr_0 = 1.5416e-04
Loss = 8.4274e-04, PNorm = 66.4480, GNorm = 0.6712, lr_0 = 1.4763e-04
Loss = 1.3462e-03, PNorm = 66.4487, GNorm = 0.6029, lr_0 = 1.4699e-04
Validation rmse = 1.004368
Epoch 24
Loss = 9.1027e-04, PNorm = 66.4581, GNorm = 0.3658, lr_0 = 1.4077e-04
Loss = 9.4000e-04, PNorm = 66.4678, GNorm = 0.5219, lr_0 = 1.3480e-04
Validation rmse = 1.021900
Epoch 25
Loss = 9.0910e-04, PNorm = 66.4730, GNorm = 1.0185, lr_0 = 1.2909e-04
Loss = 9.8120e-04, PNorm = 66.4807, GNorm = 0.7321, lr_0 = 1.2362e-04
Validation rmse = 0.998147
Epoch 26
Loss = 7.9773e-04, PNorm = 66.4862, GNorm = 0.4409, lr_0 = 1.1839e-04
Validation rmse = 1.001951
Epoch 27
Loss = 1.0428e-03, PNorm = 66.4942, GNorm = 1.0564, lr_0 = 1.1288e-04
Loss = 6.8847e-04, PNorm = 66.5009, GNorm = 0.4739, lr_0 = 1.0810e-04
Validation rmse = 1.000324
Epoch 28
Loss = 7.8835e-04, PNorm = 66.5087, GNorm = 0.8135, lr_0 = 1.0352e-04
Loss = 7.3848e-04, PNorm = 66.5138, GNorm = 0.7334, lr_0 = 1.0000e-04
Validation rmse = 1.020266
Epoch 29
Loss = 7.3995e-04, PNorm = 66.5205, GNorm = 0.8344, lr_0 = 1.0000e-04
Loss = 7.9047e-04, PNorm = 66.5275, GNorm = 0.5657, lr_0 = 1.0000e-04
Validation rmse = 1.042279
Model 0 best validation rmse = 0.967779 on epoch 12
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.789242
Ensemble test rmse = 0.789242
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total scaffolds = 195 | train scaffolds = 69 | val scaffolds = 65 | test scaffolds = 61
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1304, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,443,101
Moving model to cuda
Epoch 0
Loss = 1.3950e-02, PNorm = 65.0521, GNorm = 5.5435, lr_0 = 3.6053e-04
Validation rmse = 1.460903
Epoch 1
Loss = 3.5113e-03, PNorm = 65.1141, GNorm = 1.4740, lr_0 = 6.2105e-04
Loss = 4.6310e-03, PNorm = 65.1878, GNorm = 2.4699, lr_0 = 8.5789e-04
Validation rmse = 1.299727
Epoch 2
Loss = 2.6679e-03, PNorm = 65.2662, GNorm = 0.9599, lr_0 = 9.8284e-04
Loss = 3.6035e-03, PNorm = 65.3421, GNorm = 2.1788, lr_0 = 9.4120e-04
Validation rmse = 1.536631
Epoch 3
Loss = 2.8229e-03, PNorm = 65.4110, GNorm = 0.5774, lr_0 = 8.9744e-04
Loss = 2.6615e-03, PNorm = 65.4654, GNorm = 1.7632, lr_0 = 8.5943e-04
Validation rmse = 1.307311
Epoch 4
Loss = 2.5856e-03, PNorm = 65.5113, GNorm = 1.2313, lr_0 = 8.2303e-04
Loss = 2.7512e-03, PNorm = 65.5620, GNorm = 1.8019, lr_0 = 7.8816e-04
Validation rmse = 1.303573
Epoch 5
Loss = 1.3890e-03, PNorm = 65.6080, GNorm = 0.6499, lr_0 = 7.5478e-04
Loss = 1.8273e-03, PNorm = 65.6526, GNorm = 0.3789, lr_0 = 7.2281e-04
Validation rmse = 1.180990
Epoch 6
Loss = 2.1940e-03, PNorm = 65.6974, GNorm = 0.4910, lr_0 = 6.8920e-04
Loss = 1.9266e-03, PNorm = 65.7404, GNorm = 1.3034, lr_0 = 6.6001e-04
Validation rmse = 1.357182
Epoch 7
Loss = 1.9299e-03, PNorm = 65.7759, GNorm = 1.0244, lr_0 = 6.3205e-04
Loss = 2.3878e-03, PNorm = 65.8147, GNorm = 0.7117, lr_0 = 6.0528e-04
Validation rmse = 1.280542
Epoch 8
Loss = 1.6779e-03, PNorm = 65.8547, GNorm = 0.7332, lr_0 = 5.7714e-04
Loss = 1.6054e-03, PNorm = 65.8829, GNorm = 0.3474, lr_0 = 5.5269e-04
Validation rmse = 1.590065
Epoch 9
Loss = 2.0539e-03, PNorm = 65.9097, GNorm = 0.6039, lr_0 = 5.2928e-04
Loss = 1.7585e-03, PNorm = 65.9408, GNorm = 0.7567, lr_0 = 5.0686e-04
Validation rmse = 1.436801
Epoch 10
Loss = 1.4717e-03, PNorm = 65.9701, GNorm = 0.7508, lr_0 = 4.8539e-04
Loss = 1.4634e-03, PNorm = 66.0024, GNorm = 0.3535, lr_0 = 4.6483e-04
Validation rmse = 1.345671
Epoch 11
Loss = 1.1320e-03, PNorm = 66.0348, GNorm = 0.3489, lr_0 = 4.4322e-04
Loss = 1.2692e-03, PNorm = 66.0610, GNorm = 0.4416, lr_0 = 4.2444e-04
Validation rmse = 1.294705
Epoch 12
Loss = 1.1916e-03, PNorm = 66.0837, GNorm = 0.3740, lr_0 = 4.0646e-04
Loss = 1.1329e-03, PNorm = 66.1032, GNorm = 0.3936, lr_0 = 3.8925e-04
Validation rmse = 1.169346
Epoch 13
Loss = 1.5597e-03, PNorm = 66.1245, GNorm = 0.8810, lr_0 = 3.7276e-04
Loss = 1.6238e-03, PNorm = 66.1510, GNorm = 0.8137, lr_0 = 3.5697e-04
Validation rmse = 1.246050
Epoch 14
Loss = 1.1741e-03, PNorm = 66.1743, GNorm = 0.5777, lr_0 = 3.4037e-04
Loss = 1.3465e-03, PNorm = 66.1928, GNorm = 1.6715, lr_0 = 3.2596e-04
Validation rmse = 1.266858
Epoch 15
Loss = 1.4888e-03, PNorm = 66.2119, GNorm = 1.1471, lr_0 = 3.1215e-04
Loss = 1.4517e-03, PNorm = 66.2329, GNorm = 0.3970, lr_0 = 2.9893e-04
Validation rmse = 1.394731
Epoch 16
Loss = 1.1195e-03, PNorm = 66.2545, GNorm = 0.5791, lr_0 = 2.8503e-04
Loss = 1.1841e-03, PNorm = 66.2682, GNorm = 0.4084, lr_0 = 2.7295e-04
Validation rmse = 1.437188
Epoch 17
Loss = 1.1365e-03, PNorm = 66.2869, GNorm = 0.4286, lr_0 = 2.6139e-04
Loss = 1.0988e-03, PNorm = 66.3005, GNorm = 0.4185, lr_0 = 2.5032e-04
Validation rmse = 1.255548
Epoch 18
Loss = 1.0843e-03, PNorm = 66.3166, GNorm = 0.6710, lr_0 = 2.3972e-04
Loss = 1.2896e-03, PNorm = 66.3306, GNorm = 0.3175, lr_0 = 2.2956e-04
Validation rmse = 1.297436
Epoch 19
Loss = 1.3783e-03, PNorm = 66.3437, GNorm = 0.6949, lr_0 = 2.1889e-04
Loss = 1.0593e-03, PNorm = 66.3601, GNorm = 0.4761, lr_0 = 2.0962e-04
Validation rmse = 1.255613
Epoch 20
Loss = 1.1693e-03, PNorm = 66.3747, GNorm = 0.7295, lr_0 = 2.0074e-04
Loss = 8.1570e-04, PNorm = 66.3877, GNorm = 0.3870, lr_0 = 1.9224e-04
Validation rmse = 1.300210
Epoch 21
Loss = 1.1166e-03, PNorm = 66.3988, GNorm = 0.7828, lr_0 = 1.8409e-04
Loss = 1.0529e-03, PNorm = 66.4121, GNorm = 0.6336, lr_0 = 1.7630e-04
Validation rmse = 1.451481
Epoch 22
Loss = 8.9349e-04, PNorm = 66.4226, GNorm = 0.8385, lr_0 = 1.6810e-04
Loss = 1.0892e-03, PNorm = 66.4311, GNorm = 0.8143, lr_0 = 1.6098e-04
Validation rmse = 1.248413
Epoch 23
Loss = 1.0440e-03, PNorm = 66.4410, GNorm = 0.3452, lr_0 = 1.5416e-04
Loss = 8.8582e-04, PNorm = 66.4499, GNorm = 0.4270, lr_0 = 1.4763e-04
Loss = 1.3583e-03, PNorm = 66.4507, GNorm = 1.5446, lr_0 = 1.4699e-04
Validation rmse = 1.262246
Epoch 24
Loss = 1.1093e-03, PNorm = 66.4583, GNorm = 0.6984, lr_0 = 1.4077e-04
Loss = 8.7230e-04, PNorm = 66.4687, GNorm = 0.4375, lr_0 = 1.3480e-04
Validation rmse = 1.311695
Epoch 25
Loss = 7.6973e-04, PNorm = 66.4761, GNorm = 0.3381, lr_0 = 1.2909e-04
Loss = 9.5680e-04, PNorm = 66.4858, GNorm = 0.9667, lr_0 = 1.2362e-04
Validation rmse = 1.312199
Epoch 26
Loss = 7.8408e-04, PNorm = 66.4912, GNorm = 0.4765, lr_0 = 1.1839e-04
Validation rmse = 1.299081
Epoch 27
Loss = 5.8892e-04, PNorm = 66.4991, GNorm = 0.7945, lr_0 = 1.1288e-04
Loss = 8.5813e-04, PNorm = 66.5051, GNorm = 0.5044, lr_0 = 1.0810e-04
Validation rmse = 1.394123
Epoch 28
Loss = 4.4908e-04, PNorm = 66.5121, GNorm = 0.3217, lr_0 = 1.0352e-04
Loss = 7.9917e-04, PNorm = 66.5190, GNorm = 0.4701, lr_0 = 1.0000e-04
Validation rmse = 1.355035
Epoch 29
Loss = 9.1297e-04, PNorm = 66.5278, GNorm = 0.4097, lr_0 = 1.0000e-04
Loss = 6.7600e-04, PNorm = 66.5338, GNorm = 0.6561, lr_0 = 1.0000e-04
Validation rmse = 1.388872
Model 0 best validation rmse = 1.169346 on epoch 12
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.841676
Ensemble test rmse = 0.841676
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total scaffolds = 195 | train scaffolds = 75 | val scaffolds = 42 | test scaffolds = 78
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1304, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,443,101
Moving model to cuda
Epoch 0
Loss = 1.3302e-02, PNorm = 65.0515, GNorm = 6.7026, lr_0 = 3.6053e-04
Validation rmse = 1.278119
Epoch 1
Loss = 2.7343e-03, PNorm = 65.1159, GNorm = 1.0675, lr_0 = 6.2105e-04
Loss = 4.1314e-03, PNorm = 65.1889, GNorm = 2.8785, lr_0 = 8.5789e-04
Validation rmse = 1.267437
Epoch 2
Loss = 6.1695e-03, PNorm = 65.2667, GNorm = 2.8933, lr_0 = 9.8284e-04
Loss = 3.6545e-03, PNorm = 65.3380, GNorm = 2.0287, lr_0 = 9.4120e-04
Validation rmse = 1.179396
Epoch 3
Loss = 2.1218e-03, PNorm = 65.4038, GNorm = 0.7910, lr_0 = 8.9744e-04
Loss = 2.8762e-03, PNorm = 65.4587, GNorm = 0.7091, lr_0 = 8.5943e-04
Validation rmse = 1.055793
Epoch 4
Loss = 2.4578e-03, PNorm = 65.5104, GNorm = 2.0379, lr_0 = 8.2303e-04
Loss = 2.2232e-03, PNorm = 65.5539, GNorm = 0.7355, lr_0 = 7.8816e-04
Validation rmse = 0.998673
Epoch 5
Loss = 1.7652e-03, PNorm = 65.5859, GNorm = 0.7386, lr_0 = 7.5478e-04
Loss = 2.0023e-03, PNorm = 65.6183, GNorm = 0.9080, lr_0 = 7.2281e-04
Validation rmse = 0.956496
Epoch 6
Loss = 1.3621e-03, PNorm = 65.6547, GNorm = 0.5399, lr_0 = 6.8920e-04
Loss = 2.0201e-03, PNorm = 65.6902, GNorm = 1.5436, lr_0 = 6.6001e-04
Validation rmse = 1.026433
Epoch 7
Loss = 1.8057e-03, PNorm = 65.7241, GNorm = 1.4529, lr_0 = 6.3205e-04
Loss = 1.9221e-03, PNorm = 65.7588, GNorm = 0.6934, lr_0 = 6.0528e-04
Validation rmse = 0.951294
Epoch 8
Loss = 2.7251e-03, PNorm = 65.7942, GNorm = 1.5708, lr_0 = 5.7714e-04
Loss = 1.5517e-03, PNorm = 65.8288, GNorm = 0.7249, lr_0 = 5.5269e-04
Validation rmse = 0.906467
Epoch 9
Loss = 1.2932e-03, PNorm = 65.8592, GNorm = 0.3180, lr_0 = 5.2928e-04
Loss = 1.5886e-03, PNorm = 65.8855, GNorm = 1.0892, lr_0 = 5.0686e-04
Validation rmse = 0.888927
Epoch 10
Loss = 1.3165e-03, PNorm = 65.9120, GNorm = 0.6008, lr_0 = 4.8539e-04
Loss = 1.3270e-03, PNorm = 65.9412, GNorm = 0.4357, lr_0 = 4.6483e-04
Validation rmse = 0.887159
Epoch 11
Loss = 1.4464e-03, PNorm = 65.9647, GNorm = 0.4811, lr_0 = 4.4322e-04
Loss = 1.2505e-03, PNorm = 65.9885, GNorm = 0.5959, lr_0 = 4.2444e-04
Validation rmse = 0.929187
Epoch 12
Loss = 1.0427e-03, PNorm = 66.0139, GNorm = 0.3681, lr_0 = 4.0646e-04
Loss = 1.2160e-03, PNorm = 66.0366, GNorm = 0.5658, lr_0 = 3.8925e-04
Validation rmse = 0.882550
Epoch 13
Loss = 1.1680e-03, PNorm = 66.0621, GNorm = 0.4485, lr_0 = 3.7276e-04
Loss = 1.1466e-03, PNorm = 66.0857, GNorm = 0.5504, lr_0 = 3.5697e-04
Validation rmse = 0.869964
Epoch 14
Loss = 1.2350e-03, PNorm = 66.1123, GNorm = 0.4644, lr_0 = 3.4037e-04
Loss = 1.1100e-03, PNorm = 66.1326, GNorm = 0.9044, lr_0 = 3.2596e-04
Validation rmse = 0.870464
Epoch 15
Loss = 1.3540e-03, PNorm = 66.1503, GNorm = 2.1108, lr_0 = 3.1215e-04
Loss = 1.5992e-03, PNorm = 66.1701, GNorm = 0.6356, lr_0 = 2.9893e-04
Validation rmse = 0.979191
Epoch 16
Loss = 1.1328e-03, PNorm = 66.1904, GNorm = 0.9738, lr_0 = 2.8503e-04
Loss = 1.3704e-03, PNorm = 66.2083, GNorm = 0.5588, lr_0 = 2.7295e-04
Validation rmse = 0.929258
Epoch 17
Loss = 1.0350e-03, PNorm = 66.2209, GNorm = 0.4817, lr_0 = 2.6139e-04
Loss = 1.2893e-03, PNorm = 66.2409, GNorm = 0.3557, lr_0 = 2.5032e-04
Validation rmse = 0.960986
Epoch 18
Loss = 1.2158e-03, PNorm = 66.2565, GNorm = 0.6867, lr_0 = 2.3972e-04
Loss = 9.2386e-04, PNorm = 66.2692, GNorm = 0.2994, lr_0 = 2.2956e-04
Validation rmse = 0.923136
Epoch 19
Loss = 8.9894e-04, PNorm = 66.2834, GNorm = 0.4630, lr_0 = 2.1889e-04
Loss = 9.6926e-04, PNorm = 66.2934, GNorm = 0.3857, lr_0 = 2.0962e-04
Validation rmse = 0.910674
Epoch 20
Loss = 1.0167e-03, PNorm = 66.3067, GNorm = 0.4009, lr_0 = 2.0074e-04
Loss = 1.1101e-03, PNorm = 66.3174, GNorm = 0.3107, lr_0 = 1.9224e-04
Validation rmse = 0.975841
Epoch 21
Loss = 8.4918e-04, PNorm = 66.3318, GNorm = 0.9560, lr_0 = 1.8409e-04
Loss = 9.9193e-04, PNorm = 66.3426, GNorm = 0.7977, lr_0 = 1.7630e-04
Validation rmse = 1.053268
Epoch 22
Loss = 9.8907e-04, PNorm = 66.3538, GNorm = 0.4779, lr_0 = 1.6810e-04
Loss = 9.2892e-04, PNorm = 66.3649, GNorm = 0.4569, lr_0 = 1.6098e-04
Validation rmse = 0.883914
Epoch 23
Loss = 8.6989e-04, PNorm = 66.3733, GNorm = 1.1113, lr_0 = 1.5416e-04
Loss = 8.5013e-04, PNorm = 66.3815, GNorm = 0.4277, lr_0 = 1.4763e-04
Loss = 7.0705e-04, PNorm = 66.3823, GNorm = 0.5448, lr_0 = 1.4699e-04
Validation rmse = 0.872299
Epoch 24
Loss = 7.8742e-04, PNorm = 66.3889, GNorm = 0.5247, lr_0 = 1.4077e-04
Loss = 8.5739e-04, PNorm = 66.3993, GNorm = 0.6237, lr_0 = 1.3480e-04
Validation rmse = 0.898449
Epoch 25
Loss = 8.7112e-04, PNorm = 66.4057, GNorm = 0.6446, lr_0 = 1.2909e-04
Loss = 7.9015e-04, PNorm = 66.4123, GNorm = 0.4818, lr_0 = 1.2362e-04
Validation rmse = 0.920861
Epoch 26
Loss = 9.3814e-04, PNorm = 66.4197, GNorm = 1.0072, lr_0 = 1.1839e-04
Validation rmse = 0.901917
Epoch 27
Loss = 1.9249e-03, PNorm = 66.4273, GNorm = 1.0526, lr_0 = 1.1288e-04
Loss = 7.0504e-04, PNorm = 66.4319, GNorm = 0.8276, lr_0 = 1.0810e-04
Validation rmse = 0.921014
Epoch 28
Loss = 5.8671e-04, PNorm = 66.4372, GNorm = 0.5201, lr_0 = 1.0352e-04
Loss = 7.7262e-04, PNorm = 66.4430, GNorm = 0.4635, lr_0 = 1.0000e-04
Validation rmse = 0.925661
Epoch 29
Loss = 1.0796e-03, PNorm = 66.4496, GNorm = 0.5343, lr_0 = 1.0000e-04
Loss = 6.3712e-04, PNorm = 66.4540, GNorm = 0.9019, lr_0 = 1.0000e-04
Validation rmse = 0.948242
Model 0 best validation rmse = 0.869964 on epoch 13
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.101637
Ensemble test rmse = 1.101637
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Hansen_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982 --split_type scaffold_balanced --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path /config.json --features_path data/DowData/solubility/Hansen_G3_G5/features.csv
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': '/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Hansen_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': ['data/DowData/solubility/Hansen_G3_G5/features.csv'],
 'features_scaling': True,
 'features_size': 4,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5/sol_hyperopt-1597340982/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 981,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total scaffolds = 195 | train scaffolds = 84 | val scaffolds = 58 | test scaffolds = 53
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 440 | target average = -1.583489


Scaffold 1
Task 0: count = 336 | target average = -2.369214


Scaffold 2
Task 0: count = 67 | target average = -7.011628


Scaffold 3
Task 0: count = 23 | target average = -4.171274


Scaffold 4
Task 0: count = 17 | target average = -3.224341


Scaffold 5
Task 0: count = 16 | target average = -4.464013


Scaffold 6
Task 0: count = 14 | target average = -5.140965


Scaffold 7
Task 0: count = 14 | target average = -6.399748


Scaffold 8
Task 0: count = 13 | target average = -2.054289


Scaffold 9
Task 0: count = 11 | target average = -2.998033


Total size = 1,227 | train size = 981 | val size = 122 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1304, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,443,101
Moving model to cuda
Epoch 0
Loss = 1.5370e-02, PNorm = 65.0514, GNorm = 2.4746, lr_0 = 3.6053e-04
Validation rmse = 1.345697
Epoch 1
Loss = 5.1519e-03, PNorm = 65.1126, GNorm = 1.3245, lr_0 = 6.2105e-04
Loss = 5.8084e-03, PNorm = 65.1954, GNorm = 1.9351, lr_0 = 8.5789e-04
Validation rmse = 1.022469
Epoch 2
Loss = 3.5742e-03, PNorm = 65.2878, GNorm = 0.7517, lr_0 = 9.8284e-04
Loss = 4.3180e-03, PNorm = 65.3632, GNorm = 1.5799, lr_0 = 9.4120e-04
Validation rmse = 1.087962
Epoch 3
Loss = 3.2952e-03, PNorm = 65.4289, GNorm = 1.4273, lr_0 = 8.9744e-04
Loss = 2.8504e-03, PNorm = 65.4800, GNorm = 0.4642, lr_0 = 8.5943e-04
Validation rmse = 0.995022
Epoch 4
Loss = 3.9860e-03, PNorm = 65.5255, GNorm = 2.7003, lr_0 = 8.2303e-04
Loss = 2.2191e-03, PNorm = 65.5707, GNorm = 1.1025, lr_0 = 7.8816e-04
Validation rmse = 0.948545
Epoch 5
Loss = 2.8052e-03, PNorm = 65.6068, GNorm = 0.7865, lr_0 = 7.5478e-04
Loss = 2.3856e-03, PNorm = 65.6455, GNorm = 0.8575, lr_0 = 7.2281e-04
Validation rmse = 0.913232
Epoch 6
Loss = 2.0250e-03, PNorm = 65.6849, GNorm = 1.7412, lr_0 = 6.8920e-04
Loss = 2.4035e-03, PNorm = 65.7202, GNorm = 0.7068, lr_0 = 6.6001e-04
Validation rmse = 0.958712
Epoch 7
Loss = 2.2346e-03, PNorm = 65.7578, GNorm = 1.0546, lr_0 = 6.3205e-04
Loss = 2.1720e-03, PNorm = 65.7885, GNorm = 1.6927, lr_0 = 6.0528e-04
Validation rmse = 0.877092
Epoch 8
Loss = 1.8841e-03, PNorm = 65.8233, GNorm = 1.2587, lr_0 = 5.7714e-04
Loss = 1.9951e-03, PNorm = 65.8542, GNorm = 0.9362, lr_0 = 5.5269e-04
Validation rmse = 0.818508
Epoch 9
Loss = 1.5963e-03, PNorm = 65.8796, GNorm = 0.5429, lr_0 = 5.2928e-04
Loss = 1.4962e-03, PNorm = 65.9037, GNorm = 0.7806, lr_0 = 5.0686e-04
Validation rmse = 0.816080
Epoch 10
Loss = 1.1808e-03, PNorm = 65.9258, GNorm = 0.3893, lr_0 = 4.8539e-04
Loss = 1.3545e-03, PNorm = 65.9493, GNorm = 0.4817, lr_0 = 4.6483e-04
Validation rmse = 0.811860
Epoch 11
Loss = 1.4312e-03, PNorm = 65.9765, GNorm = 0.6266, lr_0 = 4.4322e-04
Loss = 1.4564e-03, PNorm = 66.0015, GNorm = 0.6384, lr_0 = 4.2444e-04
Validation rmse = 0.801631
Epoch 12
Loss = 1.2229e-03, PNorm = 66.0254, GNorm = 0.7313, lr_0 = 4.0646e-04
Loss = 1.6763e-03, PNorm = 66.0491, GNorm = 0.4706, lr_0 = 3.8925e-04
Validation rmse = 0.838133
Epoch 13
Loss = 1.1142e-03, PNorm = 66.0660, GNorm = 0.5859, lr_0 = 3.7276e-04
Loss = 1.3571e-03, PNorm = 66.0843, GNorm = 1.0031, lr_0 = 3.5697e-04
Validation rmse = 0.848549
Epoch 14
Loss = 1.2784e-03, PNorm = 66.1090, GNorm = 0.4210, lr_0 = 3.4037e-04
Loss = 1.4027e-03, PNorm = 66.1283, GNorm = 0.6950, lr_0 = 3.2596e-04
Validation rmse = 0.806061
Epoch 15
Loss = 1.2672e-03, PNorm = 66.1447, GNorm = 1.0873, lr_0 = 3.1215e-04
Loss = 1.4108e-03, PNorm = 66.1639, GNorm = 1.0773, lr_0 = 2.9893e-04
Validation rmse = 0.880696
Epoch 16
Loss = 1.3170e-03, PNorm = 66.1817, GNorm = 1.2845, lr_0 = 2.8503e-04
Loss = 1.0254e-03, PNorm = 66.1964, GNorm = 0.4525, lr_0 = 2.7295e-04
Validation rmse = 0.817814
Epoch 17
Loss = 1.0854e-03, PNorm = 66.2129, GNorm = 0.4148, lr_0 = 2.6139e-04
Loss = 1.2537e-03, PNorm = 66.2315, GNorm = 0.6360, lr_0 = 2.5032e-04
Validation rmse = 0.786777
Epoch 18
Loss = 9.4998e-04, PNorm = 66.2475, GNorm = 0.2367, lr_0 = 2.3972e-04
Loss = 1.3769e-03, PNorm = 66.2601, GNorm = 0.6261, lr_0 = 2.2956e-04
Validation rmse = 0.759720
Epoch 19
Loss = 1.0652e-03, PNorm = 66.2696, GNorm = 0.7042, lr_0 = 2.1889e-04
Loss = 1.2901e-03, PNorm = 66.2835, GNorm = 0.5606, lr_0 = 2.0962e-04
Validation rmse = 0.796857
Epoch 20
Loss = 1.0982e-03, PNorm = 66.2958, GNorm = 0.3903, lr_0 = 2.0074e-04
Loss = 8.5237e-04, PNorm = 66.3062, GNorm = 0.5404, lr_0 = 1.9224e-04
Validation rmse = 0.763477
Epoch 21
Loss = 7.9970e-04, PNorm = 66.3144, GNorm = 0.7727, lr_0 = 1.8409e-04
Loss = 1.2874e-03, PNorm = 66.3258, GNorm = 1.7620, lr_0 = 1.7630e-04
Validation rmse = 0.844184
Epoch 22
Loss = 1.1398e-03, PNorm = 66.3384, GNorm = 1.1707, lr_0 = 1.6810e-04
Loss = 9.3412e-04, PNorm = 66.3500, GNorm = 1.2870, lr_0 = 1.6098e-04
Validation rmse = 0.784876
Epoch 23
Loss = 8.8277e-04, PNorm = 66.3597, GNorm = 0.6001, lr_0 = 1.5416e-04
Loss = 1.0696e-03, PNorm = 66.3684, GNorm = 0.6337, lr_0 = 1.4763e-04
Loss = 2.5838e-03, PNorm = 66.3693, GNorm = 0.8788, lr_0 = 1.4699e-04
Validation rmse = 0.764808
Epoch 24
Loss = 9.2973e-04, PNorm = 66.3773, GNorm = 0.3932, lr_0 = 1.4077e-04
Loss = 1.1138e-03, PNorm = 66.3854, GNorm = 0.5596, lr_0 = 1.3480e-04
Validation rmse = 0.782289
Epoch 25
Loss = 9.2357e-04, PNorm = 66.3946, GNorm = 0.3481, lr_0 = 1.2909e-04
Loss = 9.0869e-04, PNorm = 66.4025, GNorm = 0.4557, lr_0 = 1.2362e-04
Validation rmse = 0.810181
Epoch 26
Loss = 1.0539e-03, PNorm = 66.4100, GNorm = 0.6800, lr_0 = 1.1839e-04
Validation rmse = 0.789679
Epoch 27
Loss = 1.0447e-03, PNorm = 66.4180, GNorm = 1.1301, lr_0 = 1.1288e-04
Loss = 9.0749e-04, PNorm = 66.4244, GNorm = 0.6993, lr_0 = 1.0810e-04
Validation rmse = 0.821487
Epoch 28
Loss = 1.0319e-03, PNorm = 66.4300, GNorm = 0.3973, lr_0 = 1.0352e-04
Loss = 8.6206e-04, PNorm = 66.4378, GNorm = 0.3780, lr_0 = 1.0000e-04
Validation rmse = 0.803880
Epoch 29
Loss = 9.0545e-04, PNorm = 66.4446, GNorm = 0.5689, lr_0 = 1.0000e-04
Loss = 7.8817e-04, PNorm = 66.4499, GNorm = 0.4581, lr_0 = 1.0000e-04
Validation rmse = 0.779407
Model 0 best validation rmse = 0.759720 on epoch 18
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.235727
Ensemble test rmse = 1.235727
10-fold cross validation
	Seed 0 ==> test rmse = 0.938806
	Seed 1 ==> test rmse = 0.935002
	Seed 2 ==> test rmse = 1.000727
	Seed 3 ==> test rmse = 0.844331
	Seed 4 ==> test rmse = 0.907345
	Seed 5 ==> test rmse = 0.985085
	Seed 6 ==> test rmse = 0.789242
	Seed 7 ==> test rmse = 0.841676
	Seed 8 ==> test rmse = 1.101637
	Seed 9 ==> test rmse = 1.235727
Overall test rmse = 0.957958 +/- 0.125983
Elapsed time = 0:07:03
