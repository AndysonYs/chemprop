Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1700, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,401
Moving model to cuda
Epoch 0
Loss = 1.4707e-02, PNorm = 61.1263, GNorm = 2.6797, lr_0 = 2.9800e-04
Loss = 1.1028e-02, PNorm = 61.1749, GNorm = 27.2226, lr_0 = 4.7800e-04
Validation rmse = 1.561682
Epoch 1
Loss = 8.1370e-03, PNorm = 61.2460, GNorm = 2.0510, lr_0 = 6.7600e-04
Loss = 8.0665e-03, PNorm = 61.3276, GNorm = 5.3350, lr_0 = 8.5600e-04
Loss = 7.5026e-03, PNorm = 61.4042, GNorm = 4.5627, lr_0 = 9.9344e-04
Validation rmse = 1.302840
Epoch 2
Loss = 6.0098e-03, PNorm = 61.4882, GNorm = 2.9863, lr_0 = 9.6130e-04
Loss = 4.6083e-03, PNorm = 61.5541, GNorm = 4.2581, lr_0 = 9.3019e-04
Validation rmse = 1.085628
Epoch 3
Loss = 3.5675e-03, PNorm = 61.6134, GNorm = 1.0257, lr_0 = 9.0009e-04
Loss = 3.9273e-03, PNorm = 61.6668, GNorm = 2.1230, lr_0 = 8.7096e-04
Loss = 5.3345e-03, PNorm = 61.7221, GNorm = 5.8837, lr_0 = 8.4278e-04
Validation rmse = 1.270788
Epoch 4
Loss = 4.0751e-03, PNorm = 61.7802, GNorm = 1.5013, lr_0 = 8.1551e-04
Loss = 3.7465e-03, PNorm = 61.8245, GNorm = 1.4367, lr_0 = 7.8912e-04
Validation rmse = 1.180530
Epoch 5
Loss = 4.1971e-03, PNorm = 61.8615, GNorm = 5.0717, lr_0 = 7.6358e-04
Loss = 3.5026e-03, PNorm = 61.9081, GNorm = 2.6870, lr_0 = 7.3888e-04
Loss = 3.1944e-03, PNorm = 61.9419, GNorm = 3.4622, lr_0 = 7.1497e-04
Validation rmse = 1.044463
Epoch 6
Loss = 2.7379e-03, PNorm = 61.9857, GNorm = 3.2083, lr_0 = 6.8956e-04
Loss = 2.9335e-03, PNorm = 62.0223, GNorm = 1.1372, lr_0 = 6.6725e-04
Loss = 2.9078e-03, PNorm = 62.0446, GNorm = 2.2793, lr_0 = 6.4565e-04
Validation rmse = 0.952632
Epoch 7
Loss = 2.4023e-03, PNorm = 62.0767, GNorm = 1.8742, lr_0 = 6.2476e-04
Loss = 2.9709e-03, PNorm = 62.1066, GNorm = 3.2106, lr_0 = 6.0454e-04
Validation rmse = 0.906526
Epoch 8
Loss = 2.0346e-03, PNorm = 62.1346, GNorm = 1.0938, lr_0 = 5.8498e-04
Loss = 2.8284e-03, PNorm = 62.1587, GNorm = 4.0124, lr_0 = 5.6605e-04
Loss = 2.4648e-03, PNorm = 62.1907, GNorm = 3.4543, lr_0 = 5.4774e-04
Validation rmse = 0.962373
Epoch 9
Loss = 2.2343e-03, PNorm = 62.2194, GNorm = 1.5273, lr_0 = 5.3001e-04
Loss = 2.0407e-03, PNorm = 62.2421, GNorm = 1.2511, lr_0 = 5.1286e-04
Validation rmse = 0.905048
Epoch 10
Loss = 2.0096e-03, PNorm = 62.2685, GNorm = 1.2202, lr_0 = 4.9627e-04
Loss = 1.9561e-03, PNorm = 62.2988, GNorm = 2.6197, lr_0 = 4.8021e-04
Loss = 2.1540e-03, PNorm = 62.3200, GNorm = 2.1989, lr_0 = 4.6467e-04
Validation rmse = 0.883917
Epoch 11
Loss = 1.7656e-03, PNorm = 62.3374, GNorm = 1.0582, lr_0 = 4.4963e-04
Loss = 1.6499e-03, PNorm = 62.3563, GNorm = 0.7965, lr_0 = 4.3508e-04
Validation rmse = 0.929055
Epoch 12
Loss = 1.8608e-03, PNorm = 62.3780, GNorm = 1.2002, lr_0 = 4.1962e-04
Loss = 2.3247e-03, PNorm = 62.3966, GNorm = 1.4576, lr_0 = 4.0604e-04
Loss = 1.8056e-03, PNorm = 62.4163, GNorm = 2.0387, lr_0 = 3.9290e-04
Validation rmse = 0.861937
Epoch 13
Loss = 1.8057e-03, PNorm = 62.4359, GNorm = 1.7680, lr_0 = 3.8019e-04
Loss = 2.2143e-03, PNorm = 62.4555, GNorm = 2.3810, lr_0 = 3.6789e-04
Loss = 2.2461e-03, PNorm = 62.4760, GNorm = 3.3677, lr_0 = 3.5598e-04
Validation rmse = 0.920588
Epoch 14
Loss = 1.9121e-03, PNorm = 62.4917, GNorm = 1.2693, lr_0 = 3.4446e-04
Loss = 1.5530e-03, PNorm = 62.5120, GNorm = 1.3522, lr_0 = 3.3332e-04
Validation rmse = 0.864111
Epoch 15
Loss = 1.5654e-03, PNorm = 62.5264, GNorm = 2.1580, lr_0 = 3.2253e-04
Loss = 1.9752e-03, PNorm = 62.5399, GNorm = 2.2307, lr_0 = 3.1209e-04
Loss = 1.5166e-03, PNorm = 62.5592, GNorm = 1.2083, lr_0 = 3.0200e-04
Validation rmse = 0.890111
Epoch 16
Loss = 1.5638e-03, PNorm = 62.5736, GNorm = 0.4012, lr_0 = 2.9222e-04
Loss = 1.6728e-03, PNorm = 62.5867, GNorm = 2.0394, lr_0 = 2.8277e-04
Validation rmse = 0.840358
Epoch 17
Loss = 1.4933e-03, PNorm = 62.5973, GNorm = 1.0910, lr_0 = 2.7272e-04
Loss = 1.3272e-03, PNorm = 62.6099, GNorm = 2.3145, lr_0 = 2.6389e-04
Loss = 1.5157e-03, PNorm = 62.6229, GNorm = 0.7052, lr_0 = 2.5535e-04
Validation rmse = 0.847382
Epoch 18
Loss = 1.4277e-03, PNorm = 62.6317, GNorm = 0.5910, lr_0 = 2.4709e-04
Loss = 1.3375e-03, PNorm = 62.6401, GNorm = 0.8681, lr_0 = 2.3910e-04
Loss = 1.3995e-03, PNorm = 62.6508, GNorm = 1.3800, lr_0 = 2.3136e-04
Validation rmse = 0.813436
Epoch 19
Loss = 1.3053e-03, PNorm = 62.6626, GNorm = 0.6807, lr_0 = 2.2387e-04
Loss = 1.5062e-03, PNorm = 62.6729, GNorm = 1.5133, lr_0 = 2.1663e-04
Validation rmse = 0.839857
Epoch 20
Loss = 9.5377e-04, PNorm = 62.6817, GNorm = 1.0424, lr_0 = 2.0962e-04
Loss = 1.2831e-03, PNorm = 62.6894, GNorm = 0.6568, lr_0 = 2.0283e-04
Loss = 1.1756e-03, PNorm = 62.6979, GNorm = 0.4711, lr_0 = 1.9627e-04
Validation rmse = 0.839013
Epoch 21
Loss = 1.1520e-03, PNorm = 62.7075, GNorm = 1.2289, lr_0 = 1.8992e-04
Loss = 1.1680e-03, PNorm = 62.7137, GNorm = 1.3184, lr_0 = 1.8377e-04
Validation rmse = 0.827798
Epoch 22
Loss = 1.1351e-03, PNorm = 62.7237, GNorm = 0.9164, lr_0 = 1.7783e-04
Loss = 1.1955e-03, PNorm = 62.7336, GNorm = 1.1495, lr_0 = 1.7207e-04
Loss = 1.2173e-03, PNorm = 62.7405, GNorm = 0.5714, lr_0 = 1.6651e-04
Validation rmse = 0.837499
Epoch 23
Loss = 1.0397e-03, PNorm = 62.7485, GNorm = 0.9888, lr_0 = 1.6059e-04
Loss = 1.1637e-03, PNorm = 62.7553, GNorm = 1.5218, lr_0 = 1.5539e-04
Validation rmse = 0.824813
Epoch 24
Loss = 9.3223e-04, PNorm = 62.7610, GNorm = 1.0935, lr_0 = 1.5036e-04
Loss = 1.1265e-03, PNorm = 62.7662, GNorm = 0.4542, lr_0 = 1.4550e-04
Loss = 1.1193e-03, PNorm = 62.7721, GNorm = 1.3651, lr_0 = 1.4079e-04
Validation rmse = 0.880089
Epoch 25
Loss = 1.0770e-03, PNorm = 62.7782, GNorm = 0.9950, lr_0 = 1.3623e-04
Loss = 1.1048e-03, PNorm = 62.7842, GNorm = 0.7727, lr_0 = 1.3183e-04
Loss = 1.1457e-03, PNorm = 62.7906, GNorm = 0.9715, lr_0 = 1.2756e-04
Validation rmse = 0.820108
Epoch 26
Loss = 8.9827e-04, PNorm = 62.7963, GNorm = 1.3833, lr_0 = 1.2343e-04
Loss = 1.1173e-03, PNorm = 62.8015, GNorm = 0.7009, lr_0 = 1.1944e-04
Validation rmse = 0.827949
Epoch 27
Loss = 1.1999e-03, PNorm = 62.8070, GNorm = 0.9672, lr_0 = 1.1557e-04
Loss = 1.1429e-03, PNorm = 62.8120, GNorm = 1.3432, lr_0 = 1.1183e-04
Loss = 1.0990e-03, PNorm = 62.8162, GNorm = 0.5056, lr_0 = 1.0821e-04
Validation rmse = 0.856520
Epoch 28
Loss = 1.1843e-03, PNorm = 62.8206, GNorm = 1.4010, lr_0 = 1.0437e-04
Loss = 9.6844e-04, PNorm = 62.8247, GNorm = 1.5477, lr_0 = 1.0099e-04
Validation rmse = 0.827654
Epoch 29
Loss = 1.2078e-03, PNorm = 62.8289, GNorm = 0.7415, lr_0 = 1.0000e-04
Loss = 9.7267e-04, PNorm = 62.8326, GNorm = 0.9116, lr_0 = 1.0000e-04
Loss = 1.2420e-03, PNorm = 62.8378, GNorm = 2.4560, lr_0 = 1.0000e-04
Validation rmse = 0.829077
Model 0 best validation rmse = 0.813436 on epoch 18
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.802926
Ensemble test rmse = 0.802926
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1700, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,401
Moving model to cuda
Epoch 0
Loss = 2.2550e-02, PNorm = 61.1225, GNorm = 3.1030, lr_0 = 2.9800e-04
Loss = 1.0787e-02, PNorm = 61.1673, GNorm = 1.2650, lr_0 = 4.7800e-04
Validation rmse = 1.827992
Epoch 1
Loss = 7.9253e-03, PNorm = 61.2302, GNorm = 4.5373, lr_0 = 6.7600e-04
Loss = 9.2343e-03, PNorm = 61.3022, GNorm = 1.5445, lr_0 = 8.5600e-04
Loss = 7.8844e-03, PNorm = 61.3809, GNorm = 2.1422, lr_0 = 9.9344e-04
Validation rmse = 1.485170
Epoch 2
Loss = 6.7095e-03, PNorm = 61.4561, GNorm = 6.6416, lr_0 = 9.6130e-04
Loss = 5.9709e-03, PNorm = 61.5159, GNorm = 1.3429, lr_0 = 9.3019e-04
Validation rmse = 1.335322
Epoch 3
Loss = 5.5458e-03, PNorm = 61.5693, GNorm = 2.5877, lr_0 = 9.0009e-04
Loss = 4.8633e-03, PNorm = 61.6239, GNorm = 0.9914, lr_0 = 8.7096e-04
Loss = 4.0812e-03, PNorm = 61.6749, GNorm = 1.0699, lr_0 = 8.4278e-04
Validation rmse = 0.992464
Epoch 4
Loss = 4.0181e-03, PNorm = 61.7137, GNorm = 1.8897, lr_0 = 8.1551e-04
Loss = 3.2484e-03, PNorm = 61.7576, GNorm = 3.4541, lr_0 = 7.8912e-04
Validation rmse = 0.897626
Epoch 5
Loss = 3.4488e-03, PNorm = 61.8028, GNorm = 3.0764, lr_0 = 7.6358e-04
Loss = 4.2722e-03, PNorm = 61.8445, GNorm = 5.3843, lr_0 = 7.3888e-04
Loss = 3.1883e-03, PNorm = 61.8871, GNorm = 3.3229, lr_0 = 7.1497e-04
Validation rmse = 0.903596
Epoch 6
Loss = 3.4375e-03, PNorm = 61.9294, GNorm = 1.1125, lr_0 = 6.8956e-04
Loss = 2.8906e-03, PNorm = 61.9651, GNorm = 3.4573, lr_0 = 6.6725e-04
Loss = 2.7135e-03, PNorm = 61.9956, GNorm = 2.4801, lr_0 = 6.4565e-04
Validation rmse = 0.781317
Epoch 7
Loss = 2.6852e-03, PNorm = 62.0291, GNorm = 2.2196, lr_0 = 6.2476e-04
Loss = 2.5913e-03, PNorm = 62.0561, GNorm = 3.6236, lr_0 = 6.0454e-04
Validation rmse = 0.825173
Epoch 8
Loss = 3.5948e-03, PNorm = 62.0916, GNorm = 3.7816, lr_0 = 5.8498e-04
Loss = 2.6340e-03, PNorm = 62.1224, GNorm = 1.8394, lr_0 = 5.6605e-04
Loss = 2.3077e-03, PNorm = 62.1484, GNorm = 1.0745, lr_0 = 5.4774e-04
Validation rmse = 0.795485
Epoch 9
Loss = 2.2937e-03, PNorm = 62.1745, GNorm = 2.7148, lr_0 = 5.3001e-04
Loss = 2.3477e-03, PNorm = 62.2033, GNorm = 0.7952, lr_0 = 5.1286e-04
Validation rmse = 0.896401
Epoch 10
Loss = 2.6279e-03, PNorm = 62.2244, GNorm = 3.3743, lr_0 = 4.9627e-04
Loss = 3.0487e-03, PNorm = 62.2536, GNorm = 3.2721, lr_0 = 4.8021e-04
Loss = 2.3131e-03, PNorm = 62.2809, GNorm = 2.8818, lr_0 = 4.6467e-04
Validation rmse = 0.848623
Epoch 11
Loss = 2.3924e-03, PNorm = 62.3073, GNorm = 1.3944, lr_0 = 4.4963e-04
Loss = 2.1647e-03, PNorm = 62.3282, GNorm = 0.9496, lr_0 = 4.3508e-04
Validation rmse = 0.730857
Epoch 12
Loss = 2.1447e-03, PNorm = 62.3526, GNorm = 1.0055, lr_0 = 4.1962e-04
Loss = 2.0319e-03, PNorm = 62.3723, GNorm = 2.2782, lr_0 = 4.0604e-04
Loss = 2.4391e-03, PNorm = 62.3944, GNorm = 1.8413, lr_0 = 3.9290e-04
Validation rmse = 0.984195
Epoch 13
Loss = 2.1128e-03, PNorm = 62.4180, GNorm = 0.9728, lr_0 = 3.8019e-04
Loss = 2.6172e-03, PNorm = 62.4385, GNorm = 2.5083, lr_0 = 3.6789e-04
Loss = 2.1683e-03, PNorm = 62.4579, GNorm = 0.6852, lr_0 = 3.5598e-04
Validation rmse = 0.727482
Epoch 14
Loss = 1.7583e-03, PNorm = 62.4772, GNorm = 0.8822, lr_0 = 3.4446e-04
Loss = 1.6544e-03, PNorm = 62.4923, GNorm = 1.2677, lr_0 = 3.3332e-04
Validation rmse = 0.784486
Epoch 15
Loss = 1.4703e-03, PNorm = 62.5078, GNorm = 0.9432, lr_0 = 3.2253e-04
Loss = 1.9323e-03, PNorm = 62.5245, GNorm = 2.9933, lr_0 = 3.1209e-04
Loss = 1.9441e-03, PNorm = 62.5436, GNorm = 1.0553, lr_0 = 3.0200e-04
Validation rmse = 0.825727
Epoch 16
Loss = 2.2470e-03, PNorm = 62.5591, GNorm = 3.1592, lr_0 = 2.9222e-04
Loss = 1.2837e-03, PNorm = 62.5709, GNorm = 1.0977, lr_0 = 2.8277e-04
Validation rmse = 0.709522
Epoch 17
Loss = 1.4967e-03, PNorm = 62.5815, GNorm = 0.4535, lr_0 = 2.7272e-04
Loss = 1.6516e-03, PNorm = 62.5909, GNorm = 0.7224, lr_0 = 2.6389e-04
Loss = 1.4907e-03, PNorm = 62.6042, GNorm = 1.7544, lr_0 = 2.5535e-04
Validation rmse = 0.721299
Epoch 18
Loss = 1.4017e-03, PNorm = 62.6154, GNorm = 1.3223, lr_0 = 2.4709e-04
Loss = 1.5841e-03, PNorm = 62.6262, GNorm = 0.7197, lr_0 = 2.3910e-04
Loss = 1.4492e-03, PNorm = 62.6379, GNorm = 1.1195, lr_0 = 2.3136e-04
Validation rmse = 0.724665
Epoch 19
Loss = 1.4433e-03, PNorm = 62.6467, GNorm = 1.3847, lr_0 = 2.2387e-04
Loss = 1.4753e-03, PNorm = 62.6567, GNorm = 1.1715, lr_0 = 2.1663e-04
Validation rmse = 0.693674
Epoch 20
Loss = 1.0720e-03, PNorm = 62.6664, GNorm = 0.6768, lr_0 = 2.0962e-04
Loss = 1.5690e-03, PNorm = 62.6750, GNorm = 0.7063, lr_0 = 2.0283e-04
Loss = 1.3500e-03, PNorm = 62.6818, GNorm = 0.8375, lr_0 = 1.9627e-04
Validation rmse = 0.703422
Epoch 21
Loss = 1.3939e-03, PNorm = 62.6889, GNorm = 0.5197, lr_0 = 1.8992e-04
Loss = 1.3801e-03, PNorm = 62.6969, GNorm = 1.5065, lr_0 = 1.8377e-04
Validation rmse = 0.690507
Epoch 22
Loss = 1.1980e-03, PNorm = 62.7059, GNorm = 0.9190, lr_0 = 1.7783e-04
Loss = 1.4057e-03, PNorm = 62.7137, GNorm = 0.9728, lr_0 = 1.7207e-04
Loss = 1.2884e-03, PNorm = 62.7215, GNorm = 0.4842, lr_0 = 1.6651e-04
Validation rmse = 0.688828
Epoch 23
Loss = 1.2953e-03, PNorm = 62.7305, GNorm = 1.7783, lr_0 = 1.6059e-04
Loss = 1.3716e-03, PNorm = 62.7399, GNorm = 1.7304, lr_0 = 1.5539e-04
Validation rmse = 0.805429
Epoch 24
Loss = 1.5244e-03, PNorm = 62.7474, GNorm = 2.1490, lr_0 = 1.5036e-04
Loss = 1.5760e-03, PNorm = 62.7535, GNorm = 1.5887, lr_0 = 1.4550e-04
Loss = 1.3699e-03, PNorm = 62.7613, GNorm = 1.0432, lr_0 = 1.4079e-04
Validation rmse = 0.671218
Epoch 25
Loss = 9.7432e-04, PNorm = 62.7680, GNorm = 0.4024, lr_0 = 1.3623e-04
Loss = 1.3439e-03, PNorm = 62.7739, GNorm = 1.1260, lr_0 = 1.3183e-04
Loss = 1.3826e-03, PNorm = 62.7805, GNorm = 1.3513, lr_0 = 1.2756e-04
Validation rmse = 0.683073
Epoch 26
Loss = 1.3840e-03, PNorm = 62.7866, GNorm = 0.9473, lr_0 = 1.2343e-04
Loss = 1.3111e-03, PNorm = 62.7917, GNorm = 1.3943, lr_0 = 1.1944e-04
Validation rmse = 0.696621
Epoch 27
Loss = 1.4899e-03, PNorm = 62.7957, GNorm = 0.5551, lr_0 = 1.1557e-04
Loss = 1.2360e-03, PNorm = 62.8017, GNorm = 2.1740, lr_0 = 1.1183e-04
Loss = 1.3827e-03, PNorm = 62.8083, GNorm = 0.3727, lr_0 = 1.0821e-04
Validation rmse = 0.706646
Epoch 28
Loss = 1.4181e-03, PNorm = 62.8143, GNorm = 0.6398, lr_0 = 1.0437e-04
Loss = 1.0683e-03, PNorm = 62.8181, GNorm = 1.0391, lr_0 = 1.0099e-04
Validation rmse = 0.742958
Epoch 29
Loss = 1.4039e-03, PNorm = 62.8226, GNorm = 2.1162, lr_0 = 1.0000e-04
Loss = 1.2811e-03, PNorm = 62.8280, GNorm = 1.4741, lr_0 = 1.0000e-04
Loss = 1.2164e-03, PNorm = 62.8320, GNorm = 0.6836, lr_0 = 1.0000e-04
Validation rmse = 0.682474
Model 0 best validation rmse = 0.671218 on epoch 24
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.748333
Ensemble test rmse = 0.748333
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1700, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,401
Moving model to cuda
Epoch 0
Loss = 2.0900e-02, PNorm = 61.1236, GNorm = 12.6717, lr_0 = 2.9800e-04
Loss = 1.3828e-02, PNorm = 61.1679, GNorm = 4.1525, lr_0 = 4.7800e-04
Validation rmse = 1.276237
Epoch 1
Loss = 9.9270e-03, PNorm = 61.2496, GNorm = 13.3358, lr_0 = 6.7600e-04
Loss = 7.8885e-03, PNorm = 61.3215, GNorm = 5.3650, lr_0 = 8.5600e-04
Loss = 8.4826e-03, PNorm = 61.4118, GNorm = 6.9468, lr_0 = 9.9344e-04
Validation rmse = 1.261371
Epoch 2
Loss = 7.3262e-03, PNorm = 61.5029, GNorm = 1.8974, lr_0 = 9.6130e-04
Loss = 6.4671e-03, PNorm = 61.5692, GNorm = 2.4159, lr_0 = 9.3019e-04
Validation rmse = 0.972897
Epoch 3
Loss = 4.8217e-03, PNorm = 61.6362, GNorm = 2.1587, lr_0 = 9.0009e-04
Loss = 4.4253e-03, PNorm = 61.6940, GNorm = 1.1683, lr_0 = 8.7096e-04
Loss = 4.3160e-03, PNorm = 61.7490, GNorm = 1.4451, lr_0 = 8.4278e-04
Validation rmse = 0.878723
Epoch 4
Loss = 4.8433e-03, PNorm = 61.8067, GNorm = 1.6707, lr_0 = 8.1551e-04
Loss = 5.1067e-03, PNorm = 61.8678, GNorm = 1.8514, lr_0 = 7.8912e-04
Validation rmse = 0.800457
Epoch 5
Loss = 3.6973e-03, PNorm = 61.9180, GNorm = 1.0723, lr_0 = 7.6358e-04
Loss = 3.3359e-03, PNorm = 61.9670, GNorm = 2.9426, lr_0 = 7.3888e-04
Loss = 3.5945e-03, PNorm = 62.0134, GNorm = 3.2029, lr_0 = 7.1497e-04
Validation rmse = 0.910155
Epoch 6
Loss = 3.6249e-03, PNorm = 62.0546, GNorm = 1.2725, lr_0 = 6.8956e-04
Loss = 2.7603e-03, PNorm = 62.0912, GNorm = 1.7902, lr_0 = 6.6725e-04
Loss = 3.2217e-03, PNorm = 62.1241, GNorm = 1.6951, lr_0 = 6.4565e-04
Validation rmse = 0.781029
Epoch 7
Loss = 3.0431e-03, PNorm = 62.1581, GNorm = 3.5468, lr_0 = 6.2476e-04
Loss = 2.8697e-03, PNorm = 62.2014, GNorm = 2.1420, lr_0 = 6.0454e-04
Validation rmse = 0.839818
Epoch 8
Loss = 3.1401e-03, PNorm = 62.2393, GNorm = 0.5890, lr_0 = 5.8498e-04
Loss = 2.3385e-03, PNorm = 62.2695, GNorm = 1.2920, lr_0 = 5.6605e-04
Loss = 2.4988e-03, PNorm = 62.2984, GNorm = 1.6702, lr_0 = 5.4774e-04
Validation rmse = 0.760962
Epoch 9
Loss = 2.5562e-03, PNorm = 62.3301, GNorm = 1.1373, lr_0 = 5.3001e-04
Loss = 2.4740e-03, PNorm = 62.3622, GNorm = 2.7157, lr_0 = 5.1286e-04
Validation rmse = 0.691802
Epoch 10
Loss = 2.1542e-03, PNorm = 62.3887, GNorm = 1.8002, lr_0 = 4.9627e-04
Loss = 2.2643e-03, PNorm = 62.4105, GNorm = 0.9539, lr_0 = 4.8021e-04
Loss = 2.6244e-03, PNorm = 62.4436, GNorm = 2.7390, lr_0 = 4.6467e-04
Validation rmse = 0.713033
Epoch 11
Loss = 2.3733e-03, PNorm = 62.4686, GNorm = 1.6779, lr_0 = 4.4963e-04
Loss = 2.3416e-03, PNorm = 62.4929, GNorm = 0.7398, lr_0 = 4.3508e-04
Validation rmse = 0.737275
Epoch 12
Loss = 1.2845e-03, PNorm = 62.5196, GNorm = 0.9469, lr_0 = 4.1962e-04
Loss = 2.2664e-03, PNorm = 62.5411, GNorm = 1.8272, lr_0 = 4.0604e-04
Loss = 1.8221e-03, PNorm = 62.5617, GNorm = 0.7349, lr_0 = 3.9290e-04
Validation rmse = 0.722319
Epoch 13
Loss = 1.8056e-03, PNorm = 62.5840, GNorm = 1.3442, lr_0 = 3.8019e-04
Loss = 1.9105e-03, PNorm = 62.6054, GNorm = 1.9955, lr_0 = 3.6789e-04
Loss = 2.2407e-03, PNorm = 62.6282, GNorm = 0.7915, lr_0 = 3.5598e-04
Validation rmse = 0.692822
Epoch 14
Loss = 1.6283e-03, PNorm = 62.6458, GNorm = 1.0286, lr_0 = 3.4446e-04
Loss = 1.8776e-03, PNorm = 62.6651, GNorm = 1.3013, lr_0 = 3.3332e-04
Validation rmse = 0.834210
Epoch 15
Loss = 2.2866e-03, PNorm = 62.6837, GNorm = 1.3418, lr_0 = 3.2253e-04
Loss = 1.7524e-03, PNorm = 62.7024, GNorm = 1.4453, lr_0 = 3.1209e-04
Loss = 2.0732e-03, PNorm = 62.7206, GNorm = 1.0765, lr_0 = 3.0200e-04
Validation rmse = 0.663559
Epoch 16
Loss = 1.6763e-03, PNorm = 62.7376, GNorm = 0.9740, lr_0 = 2.9222e-04
Loss = 1.5243e-03, PNorm = 62.7522, GNorm = 1.0209, lr_0 = 2.8277e-04
Validation rmse = 0.673240
Epoch 17
Loss = 1.3690e-03, PNorm = 62.7675, GNorm = 2.0368, lr_0 = 2.7272e-04
Loss = 1.4140e-03, PNorm = 62.7787, GNorm = 0.6792, lr_0 = 2.6389e-04
Loss = 1.7107e-03, PNorm = 62.7906, GNorm = 2.6770, lr_0 = 2.5535e-04
Validation rmse = 0.679884
Epoch 18
Loss = 1.6262e-03, PNorm = 62.8078, GNorm = 0.5895, lr_0 = 2.4709e-04
Loss = 1.6850e-03, PNorm = 62.8229, GNorm = 0.9579, lr_0 = 2.3910e-04
Loss = 1.3274e-03, PNorm = 62.8349, GNorm = 0.4478, lr_0 = 2.3136e-04
Validation rmse = 0.708060
Epoch 19
Loss = 1.7210e-03, PNorm = 62.8471, GNorm = 0.9743, lr_0 = 2.2387e-04
Loss = 1.4310e-03, PNorm = 62.8586, GNorm = 1.3052, lr_0 = 2.1663e-04
Validation rmse = 0.669446
Epoch 20
Loss = 1.5706e-03, PNorm = 62.8695, GNorm = 3.1932, lr_0 = 2.0962e-04
Loss = 1.3347e-03, PNorm = 62.8811, GNorm = 1.6292, lr_0 = 2.0283e-04
Loss = 1.3066e-03, PNorm = 62.8902, GNorm = 1.4071, lr_0 = 1.9627e-04
Validation rmse = 0.699966
Epoch 21
Loss = 1.4220e-03, PNorm = 62.8991, GNorm = 1.0902, lr_0 = 1.8992e-04
Loss = 1.5040e-03, PNorm = 62.9108, GNorm = 1.3856, lr_0 = 1.8377e-04
Validation rmse = 0.695424
Epoch 22
Loss = 1.4787e-03, PNorm = 62.9197, GNorm = 1.1507, lr_0 = 1.7783e-04
Loss = 1.4681e-03, PNorm = 62.9288, GNorm = 0.3962, lr_0 = 1.7207e-04
Loss = 1.2627e-03, PNorm = 62.9370, GNorm = 0.8400, lr_0 = 1.6651e-04
Validation rmse = 0.653329
Epoch 23
Loss = 1.3279e-03, PNorm = 62.9463, GNorm = 0.8818, lr_0 = 1.6059e-04
Loss = 1.3079e-03, PNorm = 62.9525, GNorm = 0.6167, lr_0 = 1.5539e-04
Validation rmse = 0.649668
Epoch 24
Loss = 1.2840e-03, PNorm = 62.9600, GNorm = 1.0068, lr_0 = 1.5036e-04
Loss = 1.1242e-03, PNorm = 62.9666, GNorm = 0.4882, lr_0 = 1.4550e-04
Loss = 1.1098e-03, PNorm = 62.9731, GNorm = 1.4782, lr_0 = 1.4079e-04
Validation rmse = 0.663175
Epoch 25
Loss = 1.3597e-03, PNorm = 62.9794, GNorm = 2.1196, lr_0 = 1.3623e-04
Loss = 1.2226e-03, PNorm = 62.9876, GNorm = 0.6398, lr_0 = 1.3183e-04
Loss = 1.1295e-03, PNorm = 62.9927, GNorm = 1.1312, lr_0 = 1.2756e-04
Validation rmse = 0.656356
Epoch 26
Loss = 1.1271e-03, PNorm = 62.9980, GNorm = 2.1286, lr_0 = 1.2343e-04
Loss = 1.2110e-03, PNorm = 63.0046, GNorm = 0.4934, lr_0 = 1.1944e-04
Validation rmse = 0.657980
Epoch 27
Loss = 1.3621e-03, PNorm = 63.0099, GNorm = 1.0159, lr_0 = 1.1557e-04
Loss = 1.2969e-03, PNorm = 63.0166, GNorm = 0.6643, lr_0 = 1.1183e-04
Loss = 1.0514e-03, PNorm = 63.0226, GNorm = 0.7425, lr_0 = 1.0821e-04
Validation rmse = 0.675017
Epoch 28
Loss = 1.1605e-03, PNorm = 63.0281, GNorm = 0.5297, lr_0 = 1.0437e-04
Loss = 1.2946e-03, PNorm = 63.0333, GNorm = 1.5823, lr_0 = 1.0099e-04
Validation rmse = 0.660367
Epoch 29
Loss = 1.3552e-03, PNorm = 63.0386, GNorm = 1.3130, lr_0 = 1.0000e-04
Loss = 1.1980e-03, PNorm = 63.0447, GNorm = 0.8831, lr_0 = 1.0000e-04
Loss = 1.0261e-03, PNorm = 63.0492, GNorm = 0.4651, lr_0 = 1.0000e-04
Validation rmse = 0.657089
Model 0 best validation rmse = 0.649668 on epoch 23
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.674730
Ensemble test rmse = 0.674730
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1700, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,401
Moving model to cuda
Epoch 0
Loss = 2.1649e-02, PNorm = 61.1220, GNorm = 3.4584, lr_0 = 2.9800e-04
Loss = 1.2982e-02, PNorm = 61.1654, GNorm = 2.3069, lr_0 = 4.7800e-04
Validation rmse = 1.443420
Epoch 1
Loss = 8.1593e-03, PNorm = 61.2398, GNorm = 3.3745, lr_0 = 6.7600e-04
Loss = 8.8446e-03, PNorm = 61.3196, GNorm = 2.6881, lr_0 = 8.5600e-04
Loss = 7.3303e-03, PNorm = 61.4069, GNorm = 2.9927, lr_0 = 9.9344e-04
Validation rmse = 1.364484
Epoch 2
Loss = 7.9249e-03, PNorm = 61.4930, GNorm = 1.5299, lr_0 = 9.6130e-04
Loss = 5.9829e-03, PNorm = 61.5664, GNorm = 3.3805, lr_0 = 9.3019e-04
Validation rmse = 1.199077
Epoch 3
Loss = 5.9660e-03, PNorm = 61.6262, GNorm = 2.2861, lr_0 = 9.0009e-04
Loss = 4.8484e-03, PNorm = 61.6908, GNorm = 1.2283, lr_0 = 8.7096e-04
Loss = 4.8086e-03, PNorm = 61.7519, GNorm = 1.2670, lr_0 = 8.4278e-04
Validation rmse = 1.092492
Epoch 4
Loss = 5.3190e-03, PNorm = 61.8078, GNorm = 5.6132, lr_0 = 8.1551e-04
Loss = 3.6644e-03, PNorm = 61.8720, GNorm = 0.9449, lr_0 = 7.8912e-04
Validation rmse = 0.855242
Epoch 5
Loss = 2.5937e-03, PNorm = 61.9169, GNorm = 1.1937, lr_0 = 7.6358e-04
Loss = 2.7622e-03, PNorm = 61.9547, GNorm = 1.4884, lr_0 = 7.3888e-04
Loss = 3.3638e-03, PNorm = 61.9909, GNorm = 3.6275, lr_0 = 7.1497e-04
Validation rmse = 0.865048
Epoch 6
Loss = 2.9635e-03, PNorm = 62.0359, GNorm = 2.1781, lr_0 = 6.8956e-04
Loss = 3.3666e-03, PNorm = 62.0735, GNorm = 1.9556, lr_0 = 6.6725e-04
Loss = 2.9822e-03, PNorm = 62.1130, GNorm = 1.1831, lr_0 = 6.4565e-04
Validation rmse = 0.821140
Epoch 7
Loss = 2.7990e-03, PNorm = 62.1505, GNorm = 1.7024, lr_0 = 6.2476e-04
Loss = 2.8031e-03, PNorm = 62.1886, GNorm = 1.3349, lr_0 = 6.0454e-04
Validation rmse = 0.763613
Epoch 8
Loss = 2.1319e-03, PNorm = 62.2192, GNorm = 1.2384, lr_0 = 5.8498e-04
Loss = 2.3566e-03, PNorm = 62.2482, GNorm = 1.6405, lr_0 = 5.6605e-04
Loss = 2.3212e-03, PNorm = 62.2765, GNorm = 0.8423, lr_0 = 5.4774e-04
Validation rmse = 0.717231
Epoch 9
Loss = 2.3841e-03, PNorm = 62.3046, GNorm = 1.6929, lr_0 = 5.3001e-04
Loss = 2.4666e-03, PNorm = 62.3331, GNorm = 1.2627, lr_0 = 5.1286e-04
Validation rmse = 0.727701
Epoch 10
Loss = 1.1513e-03, PNorm = 62.3608, GNorm = 0.5732, lr_0 = 4.9627e-04
Loss = 2.0634e-03, PNorm = 62.3837, GNorm = 2.5838, lr_0 = 4.8021e-04
Loss = 2.3815e-03, PNorm = 62.4087, GNorm = 3.6588, lr_0 = 4.6467e-04
Validation rmse = 0.755832
Epoch 11
Loss = 1.9809e-03, PNorm = 62.4340, GNorm = 0.6296, lr_0 = 4.4963e-04
Loss = 2.2375e-03, PNorm = 62.4602, GNorm = 2.2235, lr_0 = 4.3508e-04
Validation rmse = 0.732202
Epoch 12
Loss = 2.1524e-03, PNorm = 62.4840, GNorm = 1.7114, lr_0 = 4.1962e-04
Loss = 2.1793e-03, PNorm = 62.5055, GNorm = 0.9316, lr_0 = 4.0604e-04
Loss = 2.1041e-03, PNorm = 62.5276, GNorm = 2.0960, lr_0 = 3.9290e-04
Validation rmse = 0.706387
Epoch 13
Loss = 2.3190e-03, PNorm = 62.5509, GNorm = 1.4083, lr_0 = 3.8019e-04
Loss = 2.0881e-03, PNorm = 62.5698, GNorm = 2.4130, lr_0 = 3.6789e-04
Loss = 1.6446e-03, PNorm = 62.5906, GNorm = 0.7154, lr_0 = 3.5598e-04
Validation rmse = 0.674213
Epoch 14
Loss = 1.5036e-03, PNorm = 62.6076, GNorm = 0.5422, lr_0 = 3.4446e-04
Loss = 1.5115e-03, PNorm = 62.6244, GNorm = 0.9900, lr_0 = 3.3332e-04
Validation rmse = 0.664768
Epoch 15
Loss = 1.7471e-03, PNorm = 62.6384, GNorm = 2.4551, lr_0 = 3.2253e-04
Loss = 1.8363e-03, PNorm = 62.6550, GNorm = 0.8508, lr_0 = 3.1209e-04
Loss = 1.6710e-03, PNorm = 62.6703, GNorm = 1.1668, lr_0 = 3.0200e-04
Validation rmse = 0.642086
Epoch 16
Loss = 1.5058e-03, PNorm = 62.6861, GNorm = 0.4591, lr_0 = 2.9222e-04
Loss = 1.6282e-03, PNorm = 62.7017, GNorm = 0.7811, lr_0 = 2.8277e-04
Validation rmse = 0.637769
Epoch 17
Loss = 1.4553e-03, PNorm = 62.7169, GNorm = 1.3125, lr_0 = 2.7272e-04
Loss = 1.3971e-03, PNorm = 62.7294, GNorm = 1.8983, lr_0 = 2.6389e-04
Loss = 1.4747e-03, PNorm = 62.7412, GNorm = 0.4482, lr_0 = 2.5535e-04
Validation rmse = 0.654094
Epoch 18
Loss = 1.3638e-03, PNorm = 62.7548, GNorm = 2.5097, lr_0 = 2.4709e-04
Loss = 1.6851e-03, PNorm = 62.7663, GNorm = 1.3498, lr_0 = 2.3910e-04
Loss = 1.3483e-03, PNorm = 62.7806, GNorm = 1.1501, lr_0 = 2.3136e-04
Validation rmse = 0.655576
Epoch 19
Loss = 1.6968e-03, PNorm = 62.7927, GNorm = 1.6331, lr_0 = 2.2387e-04
Loss = 1.2952e-03, PNorm = 62.8039, GNorm = 0.6171, lr_0 = 2.1663e-04
Validation rmse = 0.629471
Epoch 20
Loss = 1.3739e-03, PNorm = 62.8143, GNorm = 0.6390, lr_0 = 2.0962e-04
Loss = 1.5658e-03, PNorm = 62.8253, GNorm = 0.8487, lr_0 = 2.0283e-04
Loss = 1.5189e-03, PNorm = 62.8367, GNorm = 0.6006, lr_0 = 1.9627e-04
Validation rmse = 0.656624
Epoch 21
Loss = 1.3151e-03, PNorm = 62.8479, GNorm = 0.5276, lr_0 = 1.8992e-04
Loss = 1.4901e-03, PNorm = 62.8580, GNorm = 1.0036, lr_0 = 1.8377e-04
Validation rmse = 0.658725
Epoch 22
Loss = 2.1374e-03, PNorm = 62.8670, GNorm = 2.8349, lr_0 = 1.7783e-04
Loss = 1.3870e-03, PNorm = 62.8780, GNorm = 1.3652, lr_0 = 1.7207e-04
Loss = 1.1370e-03, PNorm = 62.8861, GNorm = 1.2779, lr_0 = 1.6651e-04
Validation rmse = 0.634389
Epoch 23
Loss = 1.4509e-03, PNorm = 62.8959, GNorm = 1.3115, lr_0 = 1.6059e-04
Loss = 1.2061e-03, PNorm = 62.9022, GNorm = 0.6855, lr_0 = 1.5539e-04
Validation rmse = 0.628176
Epoch 24
Loss = 1.0875e-03, PNorm = 62.9099, GNorm = 1.1435, lr_0 = 1.5036e-04
Loss = 1.2186e-03, PNorm = 62.9179, GNorm = 0.5658, lr_0 = 1.4550e-04
Loss = 1.2232e-03, PNorm = 62.9251, GNorm = 0.6826, lr_0 = 1.4079e-04
Validation rmse = 0.673389
Epoch 25
Loss = 1.4592e-03, PNorm = 62.9321, GNorm = 0.9573, lr_0 = 1.3623e-04
Loss = 1.3027e-03, PNorm = 62.9384, GNorm = 0.6605, lr_0 = 1.3183e-04
Loss = 1.3410e-03, PNorm = 62.9462, GNorm = 0.6259, lr_0 = 1.2756e-04
Validation rmse = 0.617129
Epoch 26
Loss = 1.1806e-03, PNorm = 62.9532, GNorm = 0.7309, lr_0 = 1.2343e-04
Loss = 1.1485e-03, PNorm = 62.9594, GNorm = 0.6429, lr_0 = 1.1944e-04
Validation rmse = 0.617492
Epoch 27
Loss = 9.7332e-04, PNorm = 62.9646, GNorm = 0.7323, lr_0 = 1.1557e-04
Loss = 1.2468e-03, PNorm = 62.9703, GNorm = 1.0133, lr_0 = 1.1183e-04
Loss = 1.0965e-03, PNorm = 62.9748, GNorm = 1.0631, lr_0 = 1.0821e-04
Validation rmse = 0.615783
Epoch 28
Loss = 1.0863e-03, PNorm = 62.9804, GNorm = 0.4160, lr_0 = 1.0437e-04
Loss = 1.2327e-03, PNorm = 62.9856, GNorm = 2.0619, lr_0 = 1.0099e-04
Validation rmse = 0.614365
Epoch 29
Loss = 7.6179e-04, PNorm = 62.9909, GNorm = 0.7145, lr_0 = 1.0000e-04
Loss = 1.0514e-03, PNorm = 62.9949, GNorm = 1.1207, lr_0 = 1.0000e-04
Loss = 1.2418e-03, PNorm = 62.9988, GNorm = 0.7613, lr_0 = 1.0000e-04
Validation rmse = 0.629082
Model 0 best validation rmse = 0.614365 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.898263
Ensemble test rmse = 0.898263
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1700, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,401
Moving model to cuda
Epoch 0
Loss = 2.1421e-02, PNorm = 61.1225, GNorm = 7.6157, lr_0 = 2.9800e-04
Loss = 1.4259e-02, PNorm = 61.1644, GNorm = 6.9424, lr_0 = 4.7800e-04
Validation rmse = 1.473035
Epoch 1
Loss = 7.5549e-03, PNorm = 61.2401, GNorm = 2.1055, lr_0 = 6.7600e-04
Loss = 6.9667e-03, PNorm = 61.3106, GNorm = 3.2788, lr_0 = 8.5600e-04
Loss = 7.2688e-03, PNorm = 61.3901, GNorm = 2.3741, lr_0 = 9.9344e-04
Validation rmse = 1.376998
Epoch 2
Loss = 6.7679e-03, PNorm = 61.4774, GNorm = 1.5878, lr_0 = 9.6130e-04
Loss = 4.6540e-03, PNorm = 61.5385, GNorm = 3.2064, lr_0 = 9.3019e-04
Validation rmse = 1.422068
Epoch 3
Loss = 5.6051e-03, PNorm = 61.5975, GNorm = 6.8828, lr_0 = 9.0009e-04
Loss = 5.1546e-03, PNorm = 61.6556, GNorm = 3.6347, lr_0 = 8.7096e-04
Loss = 4.1961e-03, PNorm = 61.7169, GNorm = 0.8345, lr_0 = 8.4278e-04
Validation rmse = 1.096615
Epoch 4
Loss = 3.7609e-03, PNorm = 61.7718, GNorm = 4.1420, lr_0 = 8.1551e-04
Loss = 3.7761e-03, PNorm = 61.8196, GNorm = 1.8218, lr_0 = 7.8912e-04
Validation rmse = 0.916783
Epoch 5
Loss = 3.4930e-03, PNorm = 61.8636, GNorm = 1.3622, lr_0 = 7.6358e-04
Loss = 2.9872e-03, PNorm = 61.9037, GNorm = 1.1921, lr_0 = 7.3888e-04
Loss = 4.4810e-03, PNorm = 61.9494, GNorm = 1.3536, lr_0 = 7.1497e-04
Validation rmse = 1.062443
Epoch 6
Loss = 3.9619e-03, PNorm = 61.9979, GNorm = 4.3070, lr_0 = 6.8956e-04
Loss = 3.3291e-03, PNorm = 62.0443, GNorm = 1.2603, lr_0 = 6.6725e-04
Loss = 2.7806e-03, PNorm = 62.0810, GNorm = 4.7229, lr_0 = 6.4565e-04
Validation rmse = 1.047611
Epoch 7
Loss = 2.6840e-03, PNorm = 62.1178, GNorm = 0.6667, lr_0 = 6.2476e-04
Loss = 2.6937e-03, PNorm = 62.1460, GNorm = 2.8510, lr_0 = 6.0454e-04
Validation rmse = 0.932559
Epoch 8
Loss = 2.9661e-03, PNorm = 62.1753, GNorm = 4.1389, lr_0 = 5.8498e-04
Loss = 2.6261e-03, PNorm = 62.2112, GNorm = 1.6355, lr_0 = 5.6605e-04
Loss = 2.1625e-03, PNorm = 62.2386, GNorm = 0.8428, lr_0 = 5.4774e-04
Validation rmse = 0.827937
Epoch 9
Loss = 2.3689e-03, PNorm = 62.2692, GNorm = 0.9406, lr_0 = 5.3001e-04
Loss = 2.4221e-03, PNorm = 62.2972, GNorm = 2.1092, lr_0 = 5.1286e-04
Validation rmse = 0.834431
Epoch 10
Loss = 2.1993e-03, PNorm = 62.3223, GNorm = 1.8898, lr_0 = 4.9627e-04
Loss = 2.1063e-03, PNorm = 62.3446, GNorm = 1.0720, lr_0 = 4.8021e-04
Loss = 1.8704e-03, PNorm = 62.3670, GNorm = 1.6138, lr_0 = 4.6467e-04
Validation rmse = 0.818700
Epoch 11
Loss = 2.1112e-03, PNorm = 62.3887, GNorm = 2.8418, lr_0 = 4.4963e-04
Loss = 2.8877e-03, PNorm = 62.4132, GNorm = 1.1605, lr_0 = 4.3508e-04
Validation rmse = 0.848926
Epoch 12
Loss = 1.7631e-03, PNorm = 62.4419, GNorm = 0.6732, lr_0 = 4.1962e-04
Loss = 1.7234e-03, PNorm = 62.4645, GNorm = 1.3088, lr_0 = 4.0604e-04
Loss = 1.8759e-03, PNorm = 62.4826, GNorm = 0.7356, lr_0 = 3.9290e-04
Validation rmse = 0.808911
Epoch 13
Loss = 1.7589e-03, PNorm = 62.5033, GNorm = 2.5516, lr_0 = 3.8019e-04
Loss = 1.8036e-03, PNorm = 62.5220, GNorm = 0.9960, lr_0 = 3.6789e-04
Loss = 1.5552e-03, PNorm = 62.5371, GNorm = 0.7135, lr_0 = 3.5598e-04
Validation rmse = 0.931754
Epoch 14
Loss = 2.0482e-03, PNorm = 62.5569, GNorm = 1.9390, lr_0 = 3.4446e-04
Loss = 1.7277e-03, PNorm = 62.5746, GNorm = 1.3750, lr_0 = 3.3332e-04
Validation rmse = 0.801697
Epoch 15
Loss = 1.2284e-03, PNorm = 62.5930, GNorm = 1.5208, lr_0 = 3.2253e-04
Loss = 1.6573e-03, PNorm = 62.6084, GNorm = 1.2342, lr_0 = 3.1209e-04
Loss = 1.5127e-03, PNorm = 62.6239, GNorm = 1.2804, lr_0 = 3.0200e-04
Validation rmse = 0.796932
Epoch 16
Loss = 1.6512e-03, PNorm = 62.6423, GNorm = 1.3224, lr_0 = 2.9222e-04
Loss = 1.8093e-03, PNorm = 62.6593, GNorm = 1.9270, lr_0 = 2.8277e-04
Validation rmse = 0.727606
Epoch 17
Loss = 1.5762e-03, PNorm = 62.6764, GNorm = 1.0150, lr_0 = 2.7272e-04
Loss = 1.4973e-03, PNorm = 62.6915, GNorm = 1.1575, lr_0 = 2.6389e-04
Loss = 1.3111e-03, PNorm = 62.7067, GNorm = 0.5737, lr_0 = 2.5535e-04
Validation rmse = 0.778533
Epoch 18
Loss = 1.2437e-03, PNorm = 62.7206, GNorm = 0.7465, lr_0 = 2.4709e-04
Loss = 1.4535e-03, PNorm = 62.7320, GNorm = 1.1682, lr_0 = 2.3910e-04
Loss = 1.2934e-03, PNorm = 62.7438, GNorm = 1.0054, lr_0 = 2.3136e-04
Validation rmse = 0.756192
Epoch 19
Loss = 1.3357e-03, PNorm = 62.7538, GNorm = 0.7116, lr_0 = 2.2387e-04
Loss = 1.4848e-03, PNorm = 62.7653, GNorm = 1.2973, lr_0 = 2.1663e-04
Validation rmse = 0.758489
Epoch 20
Loss = 8.9594e-04, PNorm = 62.7771, GNorm = 0.4136, lr_0 = 2.0962e-04
Loss = 1.3453e-03, PNorm = 62.7876, GNorm = 0.6477, lr_0 = 2.0283e-04
Loss = 1.2798e-03, PNorm = 62.7961, GNorm = 1.7873, lr_0 = 1.9627e-04
Validation rmse = 0.789163
Epoch 21
Loss = 1.1655e-03, PNorm = 62.8064, GNorm = 0.5151, lr_0 = 1.8992e-04
Loss = 1.4315e-03, PNorm = 62.8165, GNorm = 0.9409, lr_0 = 1.8377e-04
Validation rmse = 0.756364
Epoch 22
Loss = 1.0839e-03, PNorm = 62.8269, GNorm = 0.4892, lr_0 = 1.7783e-04
Loss = 1.2696e-03, PNorm = 62.8351, GNorm = 1.8948, lr_0 = 1.7207e-04
Loss = 1.3619e-03, PNorm = 62.8449, GNorm = 1.0345, lr_0 = 1.6651e-04
Validation rmse = 0.753998
Epoch 23
Loss = 1.1938e-03, PNorm = 62.8545, GNorm = 1.4339, lr_0 = 1.6059e-04
Loss = 1.0488e-03, PNorm = 62.8625, GNorm = 0.5523, lr_0 = 1.5539e-04
Validation rmse = 0.738612
Epoch 24
Loss = 8.8468e-04, PNorm = 62.8705, GNorm = 0.8133, lr_0 = 1.5036e-04
Loss = 1.3055e-03, PNorm = 62.8763, GNorm = 1.8680, lr_0 = 1.4550e-04
Loss = 1.2639e-03, PNorm = 62.8849, GNorm = 1.0031, lr_0 = 1.4079e-04
Validation rmse = 0.749958
Epoch 25
Loss = 1.1586e-03, PNorm = 62.8937, GNorm = 0.9790, lr_0 = 1.3623e-04
Loss = 1.1185e-03, PNorm = 62.9019, GNorm = 1.6405, lr_0 = 1.3183e-04
Loss = 1.1233e-03, PNorm = 62.9068, GNorm = 1.5253, lr_0 = 1.2756e-04
Validation rmse = 0.760442
Epoch 26
Loss = 1.1106e-03, PNorm = 62.9121, GNorm = 0.6611, lr_0 = 1.2343e-04
Loss = 1.2203e-03, PNorm = 62.9184, GNorm = 1.0475, lr_0 = 1.1944e-04
Validation rmse = 0.739590
Epoch 27
Loss = 1.0272e-03, PNorm = 62.9250, GNorm = 0.9104, lr_0 = 1.1557e-04
Loss = 1.0593e-03, PNorm = 62.9302, GNorm = 0.5483, lr_0 = 1.1183e-04
Loss = 1.1167e-03, PNorm = 62.9358, GNorm = 0.5481, lr_0 = 1.0821e-04
Validation rmse = 0.742857
Epoch 28
Loss = 8.5835e-04, PNorm = 62.9420, GNorm = 1.2272, lr_0 = 1.0437e-04
Loss = 1.1345e-03, PNorm = 62.9463, GNorm = 0.4522, lr_0 = 1.0099e-04
Validation rmse = 0.776976
Epoch 29
Loss = 1.5531e-03, PNorm = 62.9515, GNorm = 0.4350, lr_0 = 1.0000e-04
Loss = 9.6753e-04, PNorm = 62.9572, GNorm = 1.2562, lr_0 = 1.0000e-04
Loss = 9.1311e-04, PNorm = 62.9623, GNorm = 0.9069, lr_0 = 1.0000e-04
Validation rmse = 0.738619
Model 0 best validation rmse = 0.727606 on epoch 16
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.072794
Ensemble test rmse = 1.072794
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1700, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,401
Moving model to cuda
Epoch 0
Loss = 2.2173e-02, PNorm = 61.1217, GNorm = 7.4834, lr_0 = 2.9800e-04
Loss = 1.3736e-02, PNorm = 61.1658, GNorm = 1.9812, lr_0 = 4.7800e-04
Validation rmse = 1.545689
Epoch 1
Loss = 8.2003e-03, PNorm = 61.2408, GNorm = 3.5222, lr_0 = 6.7600e-04
Loss = 7.6689e-03, PNorm = 61.3193, GNorm = 1.4713, lr_0 = 8.5600e-04
Loss = 7.1268e-03, PNorm = 61.4010, GNorm = 1.1563, lr_0 = 9.9344e-04
Validation rmse = 1.599782
Epoch 2
Loss = 6.6551e-03, PNorm = 61.4801, GNorm = 2.0425, lr_0 = 9.6130e-04
Loss = 6.1823e-03, PNorm = 61.5607, GNorm = 5.9302, lr_0 = 9.3019e-04
Validation rmse = 1.229323
Epoch 3
Loss = 5.0892e-03, PNorm = 61.6343, GNorm = 3.4747, lr_0 = 9.0009e-04
Loss = 5.5220e-03, PNorm = 61.7017, GNorm = 1.9596, lr_0 = 8.7096e-04
Loss = 4.5680e-03, PNorm = 61.7599, GNorm = 2.2672, lr_0 = 8.4278e-04
Validation rmse = 1.039746
Epoch 4
Loss = 3.6298e-03, PNorm = 61.8154, GNorm = 5.2246, lr_0 = 8.1551e-04
Loss = 3.7777e-03, PNorm = 61.8638, GNorm = 2.6939, lr_0 = 7.8912e-04
Validation rmse = 1.151900
Epoch 5
Loss = 4.1710e-03, PNorm = 61.9078, GNorm = 2.2931, lr_0 = 7.6358e-04
Loss = 3.6410e-03, PNorm = 61.9537, GNorm = 4.7954, lr_0 = 7.3888e-04
Loss = 4.3847e-03, PNorm = 62.0000, GNorm = 4.6769, lr_0 = 7.1497e-04
Validation rmse = 0.985301
Epoch 6
Loss = 2.8459e-03, PNorm = 62.0524, GNorm = 2.8205, lr_0 = 6.8956e-04
Loss = 3.0139e-03, PNorm = 62.0902, GNorm = 1.5513, lr_0 = 6.6725e-04
Loss = 2.6511e-03, PNorm = 62.1223, GNorm = 3.4461, lr_0 = 6.4565e-04
Validation rmse = 0.964784
Epoch 7
Loss = 2.4945e-03, PNorm = 62.1555, GNorm = 1.6477, lr_0 = 6.2476e-04
Loss = 2.7851e-03, PNorm = 62.1887, GNorm = 2.3871, lr_0 = 6.0454e-04
Validation rmse = 1.183299
Epoch 8
Loss = 2.5119e-03, PNorm = 62.2224, GNorm = 0.5391, lr_0 = 5.8498e-04
Loss = 2.4434e-03, PNorm = 62.2567, GNorm = 2.3853, lr_0 = 5.6605e-04
Loss = 2.0995e-03, PNorm = 62.2859, GNorm = 0.6252, lr_0 = 5.4774e-04
Validation rmse = 0.947850
Epoch 9
Loss = 2.1027e-03, PNorm = 62.3106, GNorm = 2.5766, lr_0 = 5.3001e-04
Loss = 2.4027e-03, PNorm = 62.3421, GNorm = 0.7948, lr_0 = 5.1286e-04
Validation rmse = 0.927084
Epoch 10
Loss = 1.6798e-03, PNorm = 62.3692, GNorm = 0.5367, lr_0 = 4.9627e-04
Loss = 1.7212e-03, PNorm = 62.3931, GNorm = 0.7826, lr_0 = 4.8021e-04
Loss = 2.4185e-03, PNorm = 62.4192, GNorm = 2.2103, lr_0 = 4.6467e-04
Validation rmse = 0.991815
Epoch 11
Loss = 1.9392e-03, PNorm = 62.4442, GNorm = 0.9207, lr_0 = 4.4963e-04
Loss = 2.1374e-03, PNorm = 62.4728, GNorm = 0.8561, lr_0 = 4.3508e-04
Validation rmse = 0.952582
Epoch 12
Loss = 2.2085e-03, PNorm = 62.4971, GNorm = 0.8328, lr_0 = 4.1962e-04
Loss = 2.2922e-03, PNorm = 62.5185, GNorm = 0.4980, lr_0 = 4.0604e-04
Loss = 1.9420e-03, PNorm = 62.5417, GNorm = 1.3975, lr_0 = 3.9290e-04
Validation rmse = 1.135476
Epoch 13
Loss = 2.2797e-03, PNorm = 62.5708, GNorm = 5.8599, lr_0 = 3.8019e-04
Loss = 1.7780e-03, PNorm = 62.5928, GNorm = 1.5250, lr_0 = 3.6789e-04
Loss = 2.2033e-03, PNorm = 62.6173, GNorm = 2.7112, lr_0 = 3.5598e-04
Validation rmse = 0.899081
Epoch 14
Loss = 2.2675e-03, PNorm = 62.6406, GNorm = 0.8671, lr_0 = 3.4446e-04
Loss = 1.7021e-03, PNorm = 62.6617, GNorm = 0.6873, lr_0 = 3.3332e-04
Validation rmse = 0.935228
Epoch 15
Loss = 1.7760e-03, PNorm = 62.6790, GNorm = 0.9661, lr_0 = 3.2253e-04
Loss = 1.3662e-03, PNorm = 62.6928, GNorm = 0.7431, lr_0 = 3.1209e-04
Loss = 1.4184e-03, PNorm = 62.7087, GNorm = 0.6972, lr_0 = 3.0200e-04
Validation rmse = 0.870921
Epoch 16
Loss = 1.7091e-03, PNorm = 62.7246, GNorm = 0.5642, lr_0 = 2.9222e-04
Loss = 1.3714e-03, PNorm = 62.7409, GNorm = 0.7593, lr_0 = 2.8277e-04
Validation rmse = 0.918614
Epoch 17
Loss = 1.8279e-03, PNorm = 62.7584, GNorm = 1.5606, lr_0 = 2.7272e-04
Loss = 1.5136e-03, PNorm = 62.7727, GNorm = 0.9833, lr_0 = 2.6389e-04
Loss = 1.4085e-03, PNorm = 62.7874, GNorm = 1.1244, lr_0 = 2.5535e-04
Validation rmse = 0.857165
Epoch 18
Loss = 1.5258e-03, PNorm = 62.7992, GNorm = 1.8805, lr_0 = 2.4709e-04
Loss = 1.4858e-03, PNorm = 62.8132, GNorm = 0.5440, lr_0 = 2.3910e-04
Loss = 1.4622e-03, PNorm = 62.8264, GNorm = 0.6701, lr_0 = 2.3136e-04
Validation rmse = 0.938189
Epoch 19
Loss = 1.4948e-03, PNorm = 62.8398, GNorm = 1.1685, lr_0 = 2.2387e-04
Loss = 1.3908e-03, PNorm = 62.8523, GNorm = 0.5323, lr_0 = 2.1663e-04
Validation rmse = 0.952075
Epoch 20
Loss = 1.1715e-03, PNorm = 62.8617, GNorm = 0.7105, lr_0 = 2.0962e-04
Loss = 1.4446e-03, PNorm = 62.8727, GNorm = 2.0803, lr_0 = 2.0283e-04
Loss = 1.3093e-03, PNorm = 62.8818, GNorm = 1.1170, lr_0 = 1.9627e-04
Validation rmse = 0.923111
Epoch 21
Loss = 1.2336e-03, PNorm = 62.8905, GNorm = 0.9443, lr_0 = 1.8992e-04
Loss = 1.1705e-03, PNorm = 62.8991, GNorm = 0.8351, lr_0 = 1.8377e-04
Validation rmse = 0.886367
Epoch 22
Loss = 1.2124e-03, PNorm = 62.9083, GNorm = 0.5945, lr_0 = 1.7783e-04
Loss = 9.3656e-04, PNorm = 62.9170, GNorm = 0.9892, lr_0 = 1.7207e-04
Loss = 1.3769e-03, PNorm = 62.9255, GNorm = 1.4286, lr_0 = 1.6651e-04
Validation rmse = 0.910436
Epoch 23
Loss = 1.0852e-03, PNorm = 62.9357, GNorm = 0.8053, lr_0 = 1.6059e-04
Loss = 1.0535e-03, PNorm = 62.9445, GNorm = 0.5655, lr_0 = 1.5539e-04
Validation rmse = 0.852992
Epoch 24
Loss = 1.1463e-03, PNorm = 62.9520, GNorm = 1.5838, lr_0 = 1.5036e-04
Loss = 1.2986e-03, PNorm = 62.9621, GNorm = 0.9592, lr_0 = 1.4550e-04
Loss = 1.0967e-03, PNorm = 62.9689, GNorm = 0.6067, lr_0 = 1.4079e-04
Validation rmse = 0.866877
Epoch 25
Loss = 1.1194e-03, PNorm = 62.9741, GNorm = 0.6910, lr_0 = 1.3623e-04
Loss = 1.1196e-03, PNorm = 62.9795, GNorm = 0.5263, lr_0 = 1.3183e-04
Loss = 1.0637e-03, PNorm = 62.9856, GNorm = 0.7530, lr_0 = 1.2756e-04
Validation rmse = 0.880341
Epoch 26
Loss = 1.1564e-03, PNorm = 62.9925, GNorm = 2.6435, lr_0 = 1.2343e-04
Loss = 1.0863e-03, PNorm = 62.9982, GNorm = 1.1463, lr_0 = 1.1944e-04
Validation rmse = 0.933446
Epoch 27
Loss = 1.0114e-03, PNorm = 63.0003, GNorm = 0.8840, lr_0 = 1.1557e-04
Loss = 1.1631e-03, PNorm = 63.0066, GNorm = 0.8019, lr_0 = 1.1183e-04
Loss = 1.1535e-03, PNorm = 63.0108, GNorm = 2.2505, lr_0 = 1.0821e-04
Validation rmse = 0.838462
Epoch 28
Loss = 1.1755e-03, PNorm = 63.0170, GNorm = 2.0918, lr_0 = 1.0437e-04
Loss = 1.0062e-03, PNorm = 63.0220, GNorm = 1.2430, lr_0 = 1.0099e-04
Validation rmse = 0.843994
Epoch 29
Loss = 6.5876e-04, PNorm = 63.0271, GNorm = 1.2161, lr_0 = 1.0000e-04
Loss = 1.1214e-03, PNorm = 63.0326, GNorm = 0.8979, lr_0 = 1.0000e-04
Loss = 1.0950e-03, PNorm = 63.0383, GNorm = 0.6809, lr_0 = 1.0000e-04
Validation rmse = 0.840925
Model 0 best validation rmse = 0.838462 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.671765
Ensemble test rmse = 0.671765
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1700, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,401
Moving model to cuda
Epoch 0
Loss = 2.2208e-02, PNorm = 61.1214, GNorm = 3.3657, lr_0 = 2.9800e-04
Loss = 1.1709e-02, PNorm = 61.1660, GNorm = 8.0645, lr_0 = 4.7800e-04
Validation rmse = 1.621136
Epoch 1
Loss = 9.0752e-03, PNorm = 61.2316, GNorm = 5.9107, lr_0 = 6.7600e-04
Loss = 9.6479e-03, PNorm = 61.3047, GNorm = 1.2144, lr_0 = 8.5600e-04
Loss = 8.5044e-03, PNorm = 61.3862, GNorm = 4.1926, lr_0 = 9.9344e-04
Validation rmse = 1.902529
Epoch 2
Loss = 7.1424e-03, PNorm = 61.4724, GNorm = 2.1408, lr_0 = 9.6130e-04
Loss = 6.5287e-03, PNorm = 61.5274, GNorm = 3.1444, lr_0 = 9.3019e-04
Validation rmse = 1.335872
Epoch 3
Loss = 5.9595e-03, PNorm = 61.5866, GNorm = 3.7877, lr_0 = 9.0009e-04
Loss = 4.6949e-03, PNorm = 61.6378, GNorm = 1.8398, lr_0 = 8.7096e-04
Loss = 3.8482e-03, PNorm = 61.6902, GNorm = 1.3813, lr_0 = 8.4278e-04
Validation rmse = 1.234435
Epoch 4
Loss = 3.6526e-03, PNorm = 61.7383, GNorm = 1.3664, lr_0 = 8.1551e-04
Loss = 4.6853e-03, PNorm = 61.7850, GNorm = 2.9842, lr_0 = 7.8912e-04
Validation rmse = 1.095539
Epoch 5
Loss = 2.2729e-03, PNorm = 61.8352, GNorm = 2.6773, lr_0 = 7.6358e-04
Loss = 3.5290e-03, PNorm = 61.8769, GNorm = 1.0655, lr_0 = 7.3888e-04
Loss = 4.1711e-03, PNorm = 61.9202, GNorm = 1.5380, lr_0 = 7.1497e-04
Validation rmse = 1.214711
Epoch 6
Loss = 3.7019e-03, PNorm = 61.9723, GNorm = 1.7118, lr_0 = 6.8956e-04
Loss = 3.5355e-03, PNorm = 62.0109, GNorm = 5.3670, lr_0 = 6.6725e-04
Loss = 3.6997e-03, PNorm = 62.0503, GNorm = 1.2904, lr_0 = 6.4565e-04
Validation rmse = 1.249525
Epoch 7
Loss = 3.5743e-03, PNorm = 62.0887, GNorm = 3.4154, lr_0 = 6.2476e-04
Loss = 2.6067e-03, PNorm = 62.1222, GNorm = 2.8970, lr_0 = 6.0454e-04
Validation rmse = 1.058447
Epoch 8
Loss = 2.8106e-03, PNorm = 62.1499, GNorm = 2.6765, lr_0 = 5.8498e-04
Loss = 2.3132e-03, PNorm = 62.1832, GNorm = 0.9776, lr_0 = 5.6605e-04
Loss = 2.9764e-03, PNorm = 62.2094, GNorm = 0.8924, lr_0 = 5.4774e-04
Validation rmse = 1.117786
Epoch 9
Loss = 3.5246e-03, PNorm = 62.2416, GNorm = 6.1714, lr_0 = 5.3001e-04
Loss = 2.9099e-03, PNorm = 62.2831, GNorm = 1.1601, lr_0 = 5.1286e-04
Validation rmse = 1.033186
Epoch 10
Loss = 2.5104e-03, PNorm = 62.3202, GNorm = 1.7422, lr_0 = 4.9627e-04
Loss = 2.6179e-03, PNorm = 62.3519, GNorm = 2.3080, lr_0 = 4.8021e-04
Loss = 1.8569e-03, PNorm = 62.3800, GNorm = 1.7032, lr_0 = 4.6467e-04
Validation rmse = 1.021537
Epoch 11
Loss = 2.2936e-03, PNorm = 62.4034, GNorm = 2.2714, lr_0 = 4.4963e-04
Loss = 1.8133e-03, PNorm = 62.4195, GNorm = 0.8217, lr_0 = 4.3508e-04
Validation rmse = 1.007815
Epoch 12
Loss = 1.3618e-03, PNorm = 62.4440, GNorm = 0.5015, lr_0 = 4.1962e-04
Loss = 1.6893e-03, PNorm = 62.4640, GNorm = 1.9651, lr_0 = 4.0604e-04
Loss = 1.8713e-03, PNorm = 62.4799, GNorm = 0.7923, lr_0 = 3.9290e-04
Validation rmse = 1.016699
Epoch 13
Loss = 1.9112e-03, PNorm = 62.5010, GNorm = 2.4233, lr_0 = 3.8019e-04
Loss = 1.8662e-03, PNorm = 62.5135, GNorm = 1.7544, lr_0 = 3.6789e-04
Loss = 1.8294e-03, PNorm = 62.5328, GNorm = 0.4805, lr_0 = 3.5598e-04
Validation rmse = 1.012330
Epoch 14
Loss = 1.7177e-03, PNorm = 62.5521, GNorm = 0.9569, lr_0 = 3.4446e-04
Loss = 1.3749e-03, PNorm = 62.5665, GNorm = 0.5455, lr_0 = 3.3332e-04
Validation rmse = 0.989157
Epoch 15
Loss = 1.0060e-03, PNorm = 62.5830, GNorm = 0.6961, lr_0 = 3.2253e-04
Loss = 1.6959e-03, PNorm = 62.5968, GNorm = 0.7121, lr_0 = 3.1209e-04
Loss = 1.5697e-03, PNorm = 62.6110, GNorm = 1.8965, lr_0 = 3.0200e-04
Validation rmse = 1.020197
Epoch 16
Loss = 1.3267e-03, PNorm = 62.6236, GNorm = 2.1259, lr_0 = 2.9222e-04
Loss = 1.5325e-03, PNorm = 62.6363, GNorm = 1.1702, lr_0 = 2.8277e-04
Validation rmse = 0.988491
Epoch 17
Loss = 1.5166e-03, PNorm = 62.6509, GNorm = 2.0788, lr_0 = 2.7272e-04
Loss = 1.3372e-03, PNorm = 62.6631, GNorm = 1.2374, lr_0 = 2.6389e-04
Loss = 1.4133e-03, PNorm = 62.6763, GNorm = 0.6361, lr_0 = 2.5535e-04
Validation rmse = 1.021532
Epoch 18
Loss = 1.7669e-03, PNorm = 62.6864, GNorm = 2.1199, lr_0 = 2.4709e-04
Loss = 1.2951e-03, PNorm = 62.6993, GNorm = 1.7595, lr_0 = 2.3910e-04
Loss = 1.3633e-03, PNorm = 62.7104, GNorm = 0.9939, lr_0 = 2.3136e-04
Validation rmse = 0.990758
Epoch 19
Loss = 1.3934e-03, PNorm = 62.7211, GNorm = 0.5695, lr_0 = 2.2387e-04
Loss = 1.2383e-03, PNorm = 62.7322, GNorm = 0.8404, lr_0 = 2.1663e-04
Validation rmse = 0.979323
Epoch 20
Loss = 1.2296e-03, PNorm = 62.7426, GNorm = 0.3400, lr_0 = 2.0962e-04
Loss = 1.3233e-03, PNorm = 62.7529, GNorm = 0.5886, lr_0 = 2.0283e-04
Loss = 1.3382e-03, PNorm = 62.7638, GNorm = 0.9129, lr_0 = 1.9627e-04
Validation rmse = 0.975994
Epoch 21
Loss = 1.1966e-03, PNorm = 62.7725, GNorm = 1.2283, lr_0 = 1.8992e-04
Loss = 1.2374e-03, PNorm = 62.7804, GNorm = 1.1560, lr_0 = 1.8377e-04
Validation rmse = 0.961822
Epoch 22
Loss = 1.0089e-03, PNorm = 62.7878, GNorm = 0.8424, lr_0 = 1.7783e-04
Loss = 1.2872e-03, PNorm = 62.7960, GNorm = 1.4099, lr_0 = 1.7207e-04
Loss = 1.2644e-03, PNorm = 62.8034, GNorm = 1.6102, lr_0 = 1.6651e-04
Validation rmse = 0.990320
Epoch 23
Loss = 1.2119e-03, PNorm = 62.8126, GNorm = 2.6144, lr_0 = 1.6059e-04
Loss = 1.4049e-03, PNorm = 62.8198, GNorm = 0.7948, lr_0 = 1.5539e-04
Validation rmse = 0.975676
Epoch 24
Loss = 9.3198e-04, PNorm = 62.8282, GNorm = 1.0295, lr_0 = 1.5036e-04
Loss = 1.1620e-03, PNorm = 62.8350, GNorm = 1.1630, lr_0 = 1.4550e-04
Loss = 1.2343e-03, PNorm = 62.8425, GNorm = 0.7662, lr_0 = 1.4079e-04
Validation rmse = 0.973459
Epoch 25
Loss = 1.1954e-03, PNorm = 62.8492, GNorm = 0.9189, lr_0 = 1.3623e-04
Loss = 9.3816e-04, PNorm = 62.8562, GNorm = 0.7282, lr_0 = 1.3183e-04
Loss = 1.2152e-03, PNorm = 62.8620, GNorm = 0.4489, lr_0 = 1.2756e-04
Validation rmse = 0.966307
Epoch 26
Loss = 1.0314e-03, PNorm = 62.8681, GNorm = 0.7636, lr_0 = 1.2343e-04
Loss = 1.0273e-03, PNorm = 62.8743, GNorm = 0.4523, lr_0 = 1.1944e-04
Validation rmse = 0.967701
Epoch 27
Loss = 1.0594e-03, PNorm = 62.8804, GNorm = 0.8339, lr_0 = 1.1557e-04
Loss = 9.9303e-04, PNorm = 62.8863, GNorm = 0.4808, lr_0 = 1.1183e-04
Loss = 1.0797e-03, PNorm = 62.8923, GNorm = 0.6109, lr_0 = 1.0821e-04
Validation rmse = 0.983652
Epoch 28
Loss = 1.0575e-03, PNorm = 62.8973, GNorm = 0.5228, lr_0 = 1.0437e-04
Loss = 1.0073e-03, PNorm = 62.9023, GNorm = 1.7640, lr_0 = 1.0099e-04
Validation rmse = 0.971058
Epoch 29
Loss = 8.5440e-04, PNorm = 62.9067, GNorm = 0.7026, lr_0 = 1.0000e-04
Loss = 9.3344e-04, PNorm = 62.9120, GNorm = 0.8283, lr_0 = 1.0000e-04
Loss = 1.1768e-03, PNorm = 62.9170, GNorm = 0.4499, lr_0 = 1.0000e-04
Validation rmse = 0.973887
Model 0 best validation rmse = 0.961822 on epoch 21
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.767829
Ensemble test rmse = 0.767829
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1700, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,401
Moving model to cuda
Epoch 0
Loss = 1.6003e-02, PNorm = 61.1243, GNorm = 3.5409, lr_0 = 2.9800e-04
Loss = 1.3542e-02, PNorm = 61.1678, GNorm = 13.8457, lr_0 = 4.7800e-04
Validation rmse = 1.560904
Epoch 1
Loss = 9.1279e-03, PNorm = 61.2468, GNorm = 9.4762, lr_0 = 6.7600e-04
Loss = 9.0184e-03, PNorm = 61.3377, GNorm = 4.1446, lr_0 = 8.5600e-04
Loss = 7.1344e-03, PNorm = 61.4303, GNorm = 6.0530, lr_0 = 9.9344e-04
Validation rmse = 1.307266
Epoch 2
Loss = 6.2998e-03, PNorm = 61.5134, GNorm = 2.5349, lr_0 = 9.6130e-04
Loss = 5.9360e-03, PNorm = 61.5945, GNorm = 5.8972, lr_0 = 9.3019e-04
Validation rmse = 1.321297
Epoch 3
Loss = 5.8438e-03, PNorm = 61.6780, GNorm = 0.7590, lr_0 = 9.0009e-04
Loss = 4.6324e-03, PNorm = 61.7473, GNorm = 2.0028, lr_0 = 8.7096e-04
Loss = 5.0976e-03, PNorm = 61.8129, GNorm = 2.3964, lr_0 = 8.4278e-04
Validation rmse = 0.907836
Epoch 4
Loss = 3.6589e-03, PNorm = 61.8776, GNorm = 2.0327, lr_0 = 8.1551e-04
Loss = 4.0077e-03, PNorm = 61.9332, GNorm = 2.9144, lr_0 = 7.8912e-04
Validation rmse = 1.004856
Epoch 5
Loss = 4.3268e-03, PNorm = 61.9882, GNorm = 2.9567, lr_0 = 7.6358e-04
Loss = 3.6924e-03, PNorm = 62.0476, GNorm = 1.5417, lr_0 = 7.3888e-04
Loss = 3.9205e-03, PNorm = 62.0965, GNorm = 1.1839, lr_0 = 7.1497e-04
Validation rmse = 0.911695
Epoch 6
Loss = 3.7990e-03, PNorm = 62.1479, GNorm = 5.3434, lr_0 = 6.8956e-04
Loss = 3.2467e-03, PNorm = 62.1879, GNorm = 0.6370, lr_0 = 6.6725e-04
Loss = 2.9561e-03, PNorm = 62.2269, GNorm = 2.6843, lr_0 = 6.4565e-04
Validation rmse = 0.843256
Epoch 7
Loss = 2.7897e-03, PNorm = 62.2700, GNorm = 1.0742, lr_0 = 6.2476e-04
Loss = 2.7910e-03, PNorm = 62.3031, GNorm = 1.5897, lr_0 = 6.0454e-04
Validation rmse = 0.854996
Epoch 8
Loss = 1.8717e-03, PNorm = 62.3319, GNorm = 1.1923, lr_0 = 5.8498e-04
Loss = 2.5258e-03, PNorm = 62.3656, GNorm = 2.1819, lr_0 = 5.6605e-04
Loss = 2.3447e-03, PNorm = 62.4004, GNorm = 1.3815, lr_0 = 5.4774e-04
Validation rmse = 0.844299
Epoch 9
Loss = 2.2296e-03, PNorm = 62.4321, GNorm = 2.9406, lr_0 = 5.3001e-04
Loss = 3.0551e-03, PNorm = 62.4684, GNorm = 2.7351, lr_0 = 5.1286e-04
Validation rmse = 0.858680
Epoch 10
Loss = 2.2157e-03, PNorm = 62.5018, GNorm = 0.9514, lr_0 = 4.9627e-04
Loss = 1.8617e-03, PNorm = 62.5354, GNorm = 0.7665, lr_0 = 4.8021e-04
Loss = 2.1905e-03, PNorm = 62.5619, GNorm = 2.3959, lr_0 = 4.6467e-04
Validation rmse = 0.911572
Epoch 11
Loss = 2.4446e-03, PNorm = 62.5891, GNorm = 2.4853, lr_0 = 4.4963e-04
Loss = 1.8740e-03, PNorm = 62.6135, GNorm = 1.0192, lr_0 = 4.3508e-04
Validation rmse = 0.772196
Epoch 12
Loss = 1.9681e-03, PNorm = 62.6361, GNorm = 0.8132, lr_0 = 4.1962e-04
Loss = 1.8209e-03, PNorm = 62.6586, GNorm = 1.4642, lr_0 = 4.0604e-04
Loss = 1.8350e-03, PNorm = 62.6750, GNorm = 1.6715, lr_0 = 3.9290e-04
Validation rmse = 0.875990
Epoch 13
Loss = 1.6956e-03, PNorm = 62.6911, GNorm = 0.9664, lr_0 = 3.8019e-04
Loss = 1.6566e-03, PNorm = 62.7112, GNorm = 1.3864, lr_0 = 3.6789e-04
Loss = 1.8612e-03, PNorm = 62.7307, GNorm = 1.5026, lr_0 = 3.5598e-04
Validation rmse = 0.770801
Epoch 14
Loss = 1.4618e-03, PNorm = 62.7523, GNorm = 0.7456, lr_0 = 3.4446e-04
Loss = 1.6541e-03, PNorm = 62.7724, GNorm = 1.3702, lr_0 = 3.3332e-04
Validation rmse = 0.815567
Epoch 15
Loss = 8.7589e-04, PNorm = 62.7898, GNorm = 0.6812, lr_0 = 3.2253e-04
Loss = 1.8268e-03, PNorm = 62.8088, GNorm = 0.4361, lr_0 = 3.1209e-04
Loss = 1.5034e-03, PNorm = 62.8250, GNorm = 0.6132, lr_0 = 3.0200e-04
Validation rmse = 0.783030
Epoch 16
Loss = 1.3537e-03, PNorm = 62.8435, GNorm = 0.9455, lr_0 = 2.9222e-04
Loss = 1.5095e-03, PNorm = 62.8573, GNorm = 2.1436, lr_0 = 2.8277e-04
Validation rmse = 0.771526
Epoch 17
Loss = 9.0331e-04, PNorm = 62.8710, GNorm = 0.6112, lr_0 = 2.7272e-04
Loss = 1.3244e-03, PNorm = 62.8832, GNorm = 0.5135, lr_0 = 2.6389e-04
Loss = 1.7427e-03, PNorm = 62.8990, GNorm = 2.4428, lr_0 = 2.5535e-04
Validation rmse = 0.762984
Epoch 18
Loss = 1.2383e-03, PNorm = 62.9128, GNorm = 1.3103, lr_0 = 2.4709e-04
Loss = 1.2586e-03, PNorm = 62.9243, GNorm = 1.0776, lr_0 = 2.3910e-04
Loss = 1.5196e-03, PNorm = 62.9348, GNorm = 2.0934, lr_0 = 2.3136e-04
Validation rmse = 0.764341
Epoch 19
Loss = 1.3045e-03, PNorm = 62.9468, GNorm = 0.8610, lr_0 = 2.2387e-04
Loss = 1.2747e-03, PNorm = 62.9584, GNorm = 0.5353, lr_0 = 2.1663e-04
Validation rmse = 0.753682
Epoch 20
Loss = 1.4802e-03, PNorm = 62.9688, GNorm = 0.6503, lr_0 = 2.0962e-04
Loss = 1.1890e-03, PNorm = 62.9778, GNorm = 1.6789, lr_0 = 2.0283e-04
Loss = 1.2171e-03, PNorm = 62.9874, GNorm = 0.6335, lr_0 = 1.9627e-04
Validation rmse = 0.765981
Epoch 21
Loss = 1.2309e-03, PNorm = 62.9981, GNorm = 1.3302, lr_0 = 1.8992e-04
Loss = 1.1987e-03, PNorm = 63.0066, GNorm = 1.1882, lr_0 = 1.8377e-04
Validation rmse = 0.762919
Epoch 22
Loss = 1.1137e-03, PNorm = 63.0141, GNorm = 0.7109, lr_0 = 1.7783e-04
Loss = 1.1498e-03, PNorm = 63.0213, GNorm = 0.8923, lr_0 = 1.7207e-04
Loss = 1.1926e-03, PNorm = 63.0284, GNorm = 0.7724, lr_0 = 1.6651e-04
Validation rmse = 0.776345
Epoch 23
Loss = 1.0662e-03, PNorm = 63.0374, GNorm = 0.8801, lr_0 = 1.6059e-04
Loss = 1.1707e-03, PNorm = 63.0456, GNorm = 0.8864, lr_0 = 1.5539e-04
Validation rmse = 0.828086
Epoch 24
Loss = 6.3760e-04, PNorm = 63.0531, GNorm = 0.4240, lr_0 = 1.5036e-04
Loss = 1.1754e-03, PNorm = 63.0615, GNorm = 0.6382, lr_0 = 1.4550e-04
Loss = 1.1682e-03, PNorm = 63.0689, GNorm = 0.5318, lr_0 = 1.4079e-04
Validation rmse = 0.772971
Epoch 25
Loss = 8.8239e-04, PNorm = 63.0743, GNorm = 0.5435, lr_0 = 1.3623e-04
Loss = 1.0306e-03, PNorm = 63.0807, GNorm = 0.5508, lr_0 = 1.3183e-04
Loss = 1.1780e-03, PNorm = 63.0873, GNorm = 0.5779, lr_0 = 1.2756e-04
Validation rmse = 0.783505
Epoch 26
Loss = 9.1535e-04, PNorm = 63.0924, GNorm = 0.6482, lr_0 = 1.2343e-04
Loss = 9.4807e-04, PNorm = 63.0989, GNorm = 0.5214, lr_0 = 1.1944e-04
Validation rmse = 0.757376
Epoch 27
Loss = 9.3532e-04, PNorm = 63.1032, GNorm = 0.5510, lr_0 = 1.1557e-04
Loss = 1.0660e-03, PNorm = 63.1084, GNorm = 0.6864, lr_0 = 1.1183e-04
Loss = 1.0635e-03, PNorm = 63.1131, GNorm = 0.6444, lr_0 = 1.0821e-04
Validation rmse = 0.764419
Epoch 28
Loss = 1.0020e-03, PNorm = 63.1178, GNorm = 1.2029, lr_0 = 1.0437e-04
Loss = 8.6589e-04, PNorm = 63.1225, GNorm = 0.4729, lr_0 = 1.0099e-04
Validation rmse = 0.761189
Epoch 29
Loss = 6.5692e-04, PNorm = 63.1266, GNorm = 0.4487, lr_0 = 1.0000e-04
Loss = 9.8979e-04, PNorm = 63.1317, GNorm = 1.5249, lr_0 = 1.0000e-04
Loss = 1.0052e-03, PNorm = 63.1371, GNorm = 0.8035, lr_0 = 1.0000e-04
Validation rmse = 0.775094
Model 0 best validation rmse = 0.753682 on epoch 19
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.677775
Ensemble test rmse = 0.677775
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1700, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,401
Moving model to cuda
Epoch 0
Loss = 2.5615e-02, PNorm = 61.1231, GNorm = 10.9648, lr_0 = 2.9800e-04
Loss = 1.5826e-02, PNorm = 61.1684, GNorm = 5.7250, lr_0 = 4.7800e-04
Validation rmse = 1.669444
Epoch 1
Loss = 1.0625e-02, PNorm = 61.2477, GNorm = 3.2939, lr_0 = 6.7600e-04
Loss = 6.6573e-03, PNorm = 61.3242, GNorm = 2.5040, lr_0 = 8.5600e-04
Loss = 6.3533e-03, PNorm = 61.3913, GNorm = 2.0459, lr_0 = 9.9344e-04
Validation rmse = 1.404154
Epoch 2
Loss = 6.4650e-03, PNorm = 61.4653, GNorm = 4.3836, lr_0 = 9.6130e-04
Loss = 7.0894e-03, PNorm = 61.5349, GNorm = 7.4313, lr_0 = 9.3019e-04
Validation rmse = 1.392604
Epoch 3
Loss = 8.5343e-03, PNorm = 61.6076, GNorm = 5.4103, lr_0 = 9.0009e-04
Loss = 6.7224e-03, PNorm = 61.6757, GNorm = 2.5696, lr_0 = 8.7096e-04
Loss = 5.5681e-03, PNorm = 61.7273, GNorm = 0.6686, lr_0 = 8.4278e-04
Validation rmse = 1.209418
Epoch 4
Loss = 4.2847e-03, PNorm = 61.7733, GNorm = 2.8340, lr_0 = 8.1551e-04
Loss = 4.4212e-03, PNorm = 61.8183, GNorm = 2.2803, lr_0 = 7.8912e-04
Validation rmse = 1.221626
Epoch 5
Loss = 2.4340e-03, PNorm = 61.8580, GNorm = 1.7993, lr_0 = 7.6358e-04
Loss = 3.1881e-03, PNorm = 61.8957, GNorm = 2.7773, lr_0 = 7.3888e-04
Loss = 3.6871e-03, PNorm = 61.9296, GNorm = 0.8775, lr_0 = 7.1497e-04
Validation rmse = 1.132087
Epoch 6
Loss = 3.4192e-03, PNorm = 61.9718, GNorm = 2.9620, lr_0 = 6.8956e-04
Loss = 3.4684e-03, PNorm = 62.0136, GNorm = 1.6152, lr_0 = 6.6725e-04
Loss = 2.8805e-03, PNorm = 62.0439, GNorm = 0.9909, lr_0 = 6.4565e-04
Validation rmse = 0.962099
Epoch 7
Loss = 2.6858e-03, PNorm = 62.0759, GNorm = 0.8684, lr_0 = 6.2476e-04
Loss = 2.5126e-03, PNorm = 62.1075, GNorm = 2.0295, lr_0 = 6.0454e-04
Validation rmse = 0.987453
Epoch 8
Loss = 2.7416e-03, PNorm = 62.1334, GNorm = 1.8075, lr_0 = 5.8498e-04
Loss = 2.9369e-03, PNorm = 62.1669, GNorm = 1.3368, lr_0 = 5.6605e-04
Loss = 2.3130e-03, PNorm = 62.1998, GNorm = 1.4926, lr_0 = 5.4774e-04
Validation rmse = 1.073779
Epoch 9
Loss = 2.2746e-03, PNorm = 62.2256, GNorm = 0.7772, lr_0 = 5.3001e-04
Loss = 2.4016e-03, PNorm = 62.2534, GNorm = 1.6628, lr_0 = 5.1286e-04
Validation rmse = 1.060247
Epoch 10
Loss = 3.2188e-03, PNorm = 62.2778, GNorm = 1.8377, lr_0 = 4.9627e-04
Loss = 3.0423e-03, PNorm = 62.3045, GNorm = 1.0214, lr_0 = 4.8021e-04
Loss = 2.2588e-03, PNorm = 62.3271, GNorm = 1.0678, lr_0 = 4.6467e-04
Validation rmse = 0.947021
Epoch 11
Loss = 1.8942e-03, PNorm = 62.3522, GNorm = 1.3367, lr_0 = 4.4963e-04
Loss = 1.8452e-03, PNorm = 62.3741, GNorm = 1.4372, lr_0 = 4.3508e-04
Validation rmse = 0.922249
Epoch 12
Loss = 1.4240e-03, PNorm = 62.3913, GNorm = 1.3297, lr_0 = 4.1962e-04
Loss = 2.2783e-03, PNorm = 62.4056, GNorm = 3.0000, lr_0 = 4.0604e-04
Loss = 2.3448e-03, PNorm = 62.4285, GNorm = 2.7066, lr_0 = 3.9290e-04
Validation rmse = 1.009903
Epoch 13
Loss = 2.0954e-03, PNorm = 62.4485, GNorm = 1.1604, lr_0 = 3.8019e-04
Loss = 2.1127e-03, PNorm = 62.4677, GNorm = 1.7855, lr_0 = 3.6789e-04
Loss = 2.0992e-03, PNorm = 62.4876, GNorm = 1.6002, lr_0 = 3.5598e-04
Validation rmse = 0.916643
Epoch 14
Loss = 1.4408e-03, PNorm = 62.5034, GNorm = 0.7094, lr_0 = 3.4446e-04
Loss = 1.8802e-03, PNorm = 62.5201, GNorm = 1.8037, lr_0 = 3.3332e-04
Validation rmse = 0.935980
Epoch 15
Loss = 2.0828e-03, PNorm = 62.5348, GNorm = 1.5060, lr_0 = 3.2253e-04
Loss = 1.7389e-03, PNorm = 62.5509, GNorm = 0.7505, lr_0 = 3.1209e-04
Loss = 1.7662e-03, PNorm = 62.5657, GNorm = 0.6899, lr_0 = 3.0200e-04
Validation rmse = 0.953905
Epoch 16
Loss = 1.5821e-03, PNorm = 62.5767, GNorm = 0.7313, lr_0 = 2.9222e-04
Loss = 1.7419e-03, PNorm = 62.5888, GNorm = 0.6441, lr_0 = 2.8277e-04
Validation rmse = 0.946909
Epoch 17
Loss = 1.3900e-03, PNorm = 62.6007, GNorm = 1.8848, lr_0 = 2.7272e-04
Loss = 1.8128e-03, PNorm = 62.6172, GNorm = 0.7950, lr_0 = 2.6389e-04
Loss = 1.5792e-03, PNorm = 62.6289, GNorm = 1.6071, lr_0 = 2.5535e-04
Validation rmse = 0.928736
Epoch 18
Loss = 1.6024e-03, PNorm = 62.6395, GNorm = 0.6565, lr_0 = 2.4709e-04
Loss = 1.5815e-03, PNorm = 62.6478, GNorm = 1.4179, lr_0 = 2.3910e-04
Loss = 1.6677e-03, PNorm = 62.6597, GNorm = 0.5507, lr_0 = 2.3136e-04
Validation rmse = 0.936010
Epoch 19
Loss = 1.3829e-03, PNorm = 62.6706, GNorm = 1.4342, lr_0 = 2.2387e-04
Loss = 1.4763e-03, PNorm = 62.6786, GNorm = 0.9308, lr_0 = 2.1663e-04
Validation rmse = 0.935971
Epoch 20
Loss = 1.4519e-03, PNorm = 62.6858, GNorm = 0.7146, lr_0 = 2.0962e-04
Loss = 1.3966e-03, PNorm = 62.6947, GNorm = 0.5374, lr_0 = 2.0283e-04
Loss = 1.6039e-03, PNorm = 62.7054, GNorm = 1.0689, lr_0 = 1.9627e-04
Validation rmse = 0.949728
Epoch 21
Loss = 1.2289e-03, PNorm = 62.7130, GNorm = 0.5004, lr_0 = 1.8992e-04
Loss = 1.5204e-03, PNorm = 62.7203, GNorm = 0.5748, lr_0 = 1.8377e-04
Validation rmse = 0.921748
Epoch 22
Loss = 1.3301e-03, PNorm = 62.7290, GNorm = 0.9312, lr_0 = 1.7783e-04
Loss = 1.1887e-03, PNorm = 62.7384, GNorm = 0.6257, lr_0 = 1.7207e-04
Loss = 1.4343e-03, PNorm = 62.7454, GNorm = 0.6110, lr_0 = 1.6651e-04
Validation rmse = 0.911528
Epoch 23
Loss = 1.3540e-03, PNorm = 62.7516, GNorm = 0.8675, lr_0 = 1.6059e-04
Loss = 1.3262e-03, PNorm = 62.7585, GNorm = 0.9672, lr_0 = 1.5539e-04
Validation rmse = 0.949813
Epoch 24
Loss = 1.4789e-03, PNorm = 62.7668, GNorm = 1.5786, lr_0 = 1.5036e-04
Loss = 1.4683e-03, PNorm = 62.7745, GNorm = 0.8278, lr_0 = 1.4550e-04
Loss = 1.3317e-03, PNorm = 62.7789, GNorm = 1.2265, lr_0 = 1.4079e-04
Validation rmse = 0.931239
Epoch 25
Loss = 1.1396e-03, PNorm = 62.7856, GNorm = 0.5775, lr_0 = 1.3623e-04
Loss = 1.2945e-03, PNorm = 62.7922, GNorm = 1.1976, lr_0 = 1.3183e-04
Loss = 1.3334e-03, PNorm = 62.7986, GNorm = 0.4827, lr_0 = 1.2756e-04
Validation rmse = 0.968546
Epoch 26
Loss = 1.3580e-03, PNorm = 62.8034, GNorm = 0.4907, lr_0 = 1.2343e-04
Loss = 1.2283e-03, PNorm = 62.8086, GNorm = 0.7142, lr_0 = 1.1944e-04
Validation rmse = 0.913603
Epoch 27
Loss = 1.4648e-03, PNorm = 62.8142, GNorm = 0.4650, lr_0 = 1.1557e-04
Loss = 1.2283e-03, PNorm = 62.8192, GNorm = 0.8697, lr_0 = 1.1183e-04
Loss = 1.1825e-03, PNorm = 62.8231, GNorm = 0.8396, lr_0 = 1.0821e-04
Validation rmse = 0.919287
Epoch 28
Loss = 1.3716e-03, PNorm = 62.8299, GNorm = 1.4030, lr_0 = 1.0437e-04
Loss = 1.0049e-03, PNorm = 62.8350, GNorm = 0.4178, lr_0 = 1.0099e-04
Validation rmse = 0.916285
Epoch 29
Loss = 7.0197e-04, PNorm = 62.8387, GNorm = 0.9691, lr_0 = 1.0000e-04
Loss = 1.2778e-03, PNorm = 62.8422, GNorm = 0.7401, lr_0 = 1.0000e-04
Loss = 1.1089e-03, PNorm = 62.8465, GNorm = 0.8218, lr_0 = 1.0000e-04
Validation rmse = 0.963733
Model 0 best validation rmse = 0.911528 on epoch 22
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.723170
Ensemble test rmse = 0.723170
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1700, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,401
Moving model to cuda
Epoch 0
Loss = 2.2043e-02, PNorm = 61.1232, GNorm = 5.6398, lr_0 = 2.9800e-04
Loss = 1.4721e-02, PNorm = 61.1688, GNorm = 10.1246, lr_0 = 4.7800e-04
Validation rmse = 1.660067
Epoch 1
Loss = 8.6270e-03, PNorm = 61.2425, GNorm = 3.6465, lr_0 = 6.7600e-04
Loss = 8.6548e-03, PNorm = 61.3184, GNorm = 0.9031, lr_0 = 8.5600e-04
Loss = 6.5633e-03, PNorm = 61.3993, GNorm = 1.5194, lr_0 = 9.9344e-04
Validation rmse = 1.216183
Epoch 2
Loss = 6.2841e-03, PNorm = 61.4666, GNorm = 5.2906, lr_0 = 9.6130e-04
Loss = 6.5421e-03, PNorm = 61.5422, GNorm = 7.6166, lr_0 = 9.3019e-04
Validation rmse = 1.409386
Epoch 3
Loss = 6.0598e-03, PNorm = 61.6103, GNorm = 5.0207, lr_0 = 9.0009e-04
Loss = 6.2612e-03, PNorm = 61.6792, GNorm = 2.7218, lr_0 = 8.7096e-04
Loss = 4.2964e-03, PNorm = 61.7428, GNorm = 1.3429, lr_0 = 8.4278e-04
Validation rmse = 1.091927
Epoch 4
Loss = 4.4403e-03, PNorm = 61.7988, GNorm = 2.1759, lr_0 = 8.1551e-04
Loss = 4.3614e-03, PNorm = 61.8482, GNorm = 2.0199, lr_0 = 7.8912e-04
Validation rmse = 1.220273
Epoch 5
Loss = 3.3546e-03, PNorm = 61.8985, GNorm = 2.0676, lr_0 = 7.6358e-04
Loss = 3.9304e-03, PNorm = 61.9401, GNorm = 1.3955, lr_0 = 7.3888e-04
Loss = 3.1042e-03, PNorm = 61.9767, GNorm = 3.5507, lr_0 = 7.1497e-04
Validation rmse = 1.093621
Epoch 6
Loss = 2.8978e-03, PNorm = 62.0245, GNorm = 0.7718, lr_0 = 6.8956e-04
Loss = 3.1343e-03, PNorm = 62.0598, GNorm = 0.8627, lr_0 = 6.6725e-04
Loss = 2.7022e-03, PNorm = 62.0924, GNorm = 4.3571, lr_0 = 6.4565e-04
Validation rmse = 0.922741
Epoch 7
Loss = 2.1781e-03, PNorm = 62.1291, GNorm = 1.2298, lr_0 = 6.2476e-04
Loss = 2.5403e-03, PNorm = 62.1639, GNorm = 0.4740, lr_0 = 6.0454e-04
Validation rmse = 0.957519
Epoch 8
Loss = 2.7730e-03, PNorm = 62.2005, GNorm = 1.9476, lr_0 = 5.8498e-04
Loss = 2.4933e-03, PNorm = 62.2369, GNorm = 0.8252, lr_0 = 5.6605e-04
Loss = 2.2170e-03, PNorm = 62.2660, GNorm = 1.4743, lr_0 = 5.4774e-04
Validation rmse = 0.872756
Epoch 9
Loss = 1.8350e-03, PNorm = 62.2954, GNorm = 0.6720, lr_0 = 5.3001e-04
Loss = 2.2528e-03, PNorm = 62.3242, GNorm = 1.5208, lr_0 = 5.1286e-04
Validation rmse = 0.867542
Epoch 10
Loss = 1.8464e-03, PNorm = 62.3573, GNorm = 2.3627, lr_0 = 4.9627e-04
Loss = 2.2613e-03, PNorm = 62.3871, GNorm = 1.4835, lr_0 = 4.8021e-04
Loss = 1.8265e-03, PNorm = 62.4153, GNorm = 1.8548, lr_0 = 4.6467e-04
Validation rmse = 0.833537
Epoch 11
Loss = 1.6667e-03, PNorm = 62.4422, GNorm = 1.0658, lr_0 = 4.4963e-04
Loss = 1.9486e-03, PNorm = 62.4682, GNorm = 1.7242, lr_0 = 4.3508e-04
Validation rmse = 0.863308
Epoch 12
Loss = 1.6330e-03, PNorm = 62.4948, GNorm = 1.9397, lr_0 = 4.1962e-04
Loss = 1.8579e-03, PNorm = 62.5214, GNorm = 1.2526, lr_0 = 4.0604e-04
Loss = 1.5772e-03, PNorm = 62.5450, GNorm = 1.0504, lr_0 = 3.9290e-04
Validation rmse = 0.850673
Epoch 13
Loss = 1.6858e-03, PNorm = 62.5616, GNorm = 1.2531, lr_0 = 3.8019e-04
Loss = 1.4789e-03, PNorm = 62.5873, GNorm = 0.7425, lr_0 = 3.6789e-04
Loss = 1.7529e-03, PNorm = 62.6073, GNorm = 0.7289, lr_0 = 3.5598e-04
Validation rmse = 0.815208
Epoch 14
Loss = 1.4989e-03, PNorm = 62.6299, GNorm = 1.4086, lr_0 = 3.4446e-04
Loss = 1.4748e-03, PNorm = 62.6494, GNorm = 1.1217, lr_0 = 3.3332e-04
Validation rmse = 0.976525
Epoch 15
Loss = 2.3513e-03, PNorm = 62.6666, GNorm = 1.4686, lr_0 = 3.2253e-04
Loss = 1.7520e-03, PNorm = 62.6861, GNorm = 0.7241, lr_0 = 3.1209e-04
Loss = 1.4107e-03, PNorm = 62.7052, GNorm = 0.7749, lr_0 = 3.0200e-04
Validation rmse = 0.883590
Epoch 16
Loss = 1.5162e-03, PNorm = 62.7220, GNorm = 0.8184, lr_0 = 2.9222e-04
Loss = 1.3405e-03, PNorm = 62.7380, GNorm = 1.2293, lr_0 = 2.8277e-04
Validation rmse = 0.792371
Epoch 17
Loss = 1.2649e-03, PNorm = 62.7569, GNorm = 1.2017, lr_0 = 2.7272e-04
Loss = 1.3316e-03, PNorm = 62.7718, GNorm = 1.0990, lr_0 = 2.6389e-04
Loss = 1.3598e-03, PNorm = 62.7841, GNorm = 0.6353, lr_0 = 2.5535e-04
Validation rmse = 0.775239
Epoch 18
Loss = 1.5877e-03, PNorm = 62.7965, GNorm = 0.4960, lr_0 = 2.4709e-04
Loss = 1.4808e-03, PNorm = 62.8105, GNorm = 2.7370, lr_0 = 2.3910e-04
Loss = 1.1618e-03, PNorm = 62.8226, GNorm = 1.0427, lr_0 = 2.3136e-04
Validation rmse = 0.755236
Epoch 19
Loss = 1.3811e-03, PNorm = 62.8338, GNorm = 0.6272, lr_0 = 2.2387e-04
Loss = 1.4097e-03, PNorm = 62.8448, GNorm = 1.2391, lr_0 = 2.1663e-04
Validation rmse = 0.726081
Epoch 20
Loss = 1.0376e-03, PNorm = 62.8559, GNorm = 1.2700, lr_0 = 2.0962e-04
Loss = 1.3823e-03, PNorm = 62.8656, GNorm = 0.6698, lr_0 = 2.0283e-04
Loss = 1.2865e-03, PNorm = 62.8775, GNorm = 0.6318, lr_0 = 1.9627e-04
Validation rmse = 0.804921
Epoch 21
Loss = 1.3509e-03, PNorm = 62.8887, GNorm = 0.8166, lr_0 = 1.8992e-04
Loss = 1.2839e-03, PNorm = 62.9004, GNorm = 1.1263, lr_0 = 1.8377e-04
Validation rmse = 0.753850
Epoch 22
Loss = 1.0192e-03, PNorm = 62.9114, GNorm = 0.5641, lr_0 = 1.7783e-04
Loss = 1.1939e-03, PNorm = 62.9202, GNorm = 0.5828, lr_0 = 1.7207e-04
Loss = 1.0784e-03, PNorm = 62.9275, GNorm = 0.7285, lr_0 = 1.6651e-04
Validation rmse = 0.772863
Epoch 23
Loss = 1.3389e-03, PNorm = 62.9341, GNorm = 1.0855, lr_0 = 1.6059e-04
Loss = 1.0914e-03, PNorm = 62.9423, GNorm = 1.4975, lr_0 = 1.5539e-04
Validation rmse = 0.754734
Epoch 24
Loss = 1.2513e-03, PNorm = 62.9507, GNorm = 0.7411, lr_0 = 1.5036e-04
Loss = 1.1952e-03, PNorm = 62.9577, GNorm = 1.1392, lr_0 = 1.4550e-04
Loss = 1.1304e-03, PNorm = 62.9644, GNorm = 1.6955, lr_0 = 1.4079e-04
Validation rmse = 0.726383
Epoch 25
Loss = 9.9236e-04, PNorm = 62.9707, GNorm = 0.4147, lr_0 = 1.3623e-04
Loss = 1.0454e-03, PNorm = 62.9768, GNorm = 1.1667, lr_0 = 1.3183e-04
Loss = 1.2696e-03, PNorm = 62.9828, GNorm = 0.6776, lr_0 = 1.2756e-04
Validation rmse = 0.745571
Epoch 26
Loss = 1.1264e-03, PNorm = 62.9895, GNorm = 0.9590, lr_0 = 1.2343e-04
Loss = 9.5344e-04, PNorm = 62.9955, GNorm = 0.4873, lr_0 = 1.1944e-04
Validation rmse = 0.735766
Epoch 27
Loss = 1.0784e-03, PNorm = 63.0010, GNorm = 0.8137, lr_0 = 1.1557e-04
Loss = 1.1093e-03, PNorm = 63.0083, GNorm = 0.7268, lr_0 = 1.1183e-04
Loss = 9.9531e-04, PNorm = 63.0138, GNorm = 0.5199, lr_0 = 1.0821e-04
Validation rmse = 0.730156
Epoch 28
Loss = 1.0862e-03, PNorm = 63.0188, GNorm = 1.6760, lr_0 = 1.0437e-04
Loss = 1.0780e-03, PNorm = 63.0243, GNorm = 0.7180, lr_0 = 1.0099e-04
Validation rmse = 0.769852
Epoch 29
Loss = 1.3531e-03, PNorm = 63.0299, GNorm = 3.0276, lr_0 = 1.0000e-04
Loss = 1.1593e-03, PNorm = 63.0355, GNorm = 0.7273, lr_0 = 1.0000e-04
Loss = 9.9808e-04, PNorm = 63.0405, GNorm = 1.4319, lr_0 = 1.0000e-04
Validation rmse = 0.737204
Model 0 best validation rmse = 0.726081 on epoch 19
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.727063
Ensemble test rmse = 0.727063
10-fold cross validation
	Seed 0 ==> test rmse = 0.802926
	Seed 1 ==> test rmse = 0.748333
	Seed 2 ==> test rmse = 0.674730
	Seed 3 ==> test rmse = 0.898263
	Seed 4 ==> test rmse = 1.072794
	Seed 5 ==> test rmse = 0.671765
	Seed 6 ==> test rmse = 0.767829
	Seed 7 ==> test rmse = 0.677775
	Seed 8 ==> test rmse = 0.723170
	Seed 9 ==> test rmse = 0.727063
Overall test rmse = 0.776465 +/- 0.118552
Elapsed time = 0:09:16
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 891,501
Moving model to cuda
Epoch 0
Loss = 1.6864e-02, PNorm = 42.2775, GNorm = 4.8147, lr_0 = 2.9800e-04
Loss = 1.6678e-02, PNorm = 42.2907, GNorm = 2.9418, lr_0 = 4.7800e-04
Validation rmse = 1.461073
Epoch 1
Loss = 1.1780e-02, PNorm = 42.3217, GNorm = 5.2118, lr_0 = 6.7600e-04
Loss = 1.1311e-02, PNorm = 42.3581, GNorm = 6.2262, lr_0 = 8.5600e-04
Loss = 9.3270e-03, PNorm = 42.4014, GNorm = 6.4822, lr_0 = 9.9344e-04
Validation rmse = 1.459333
Epoch 2
Loss = 8.4216e-03, PNorm = 42.4420, GNorm = 3.3743, lr_0 = 9.6130e-04
Loss = 7.0101e-03, PNorm = 42.4778, GNorm = 2.9430, lr_0 = 9.3019e-04
Validation rmse = 1.222109
Epoch 3
Loss = 6.5019e-03, PNorm = 42.5052, GNorm = 3.5736, lr_0 = 9.0009e-04
Loss = 6.5455e-03, PNorm = 42.5409, GNorm = 1.8019, lr_0 = 8.7096e-04
Loss = 5.2196e-03, PNorm = 42.5657, GNorm = 2.2739, lr_0 = 8.4278e-04
Validation rmse = 1.135032
Epoch 4
Loss = 4.6834e-03, PNorm = 42.5961, GNorm = 2.3696, lr_0 = 8.1551e-04
Loss = 4.8957e-03, PNorm = 42.6182, GNorm = 0.9934, lr_0 = 7.8912e-04
Validation rmse = 1.286950
Epoch 5
Loss = 5.2427e-03, PNorm = 42.6439, GNorm = 6.0134, lr_0 = 7.6358e-04
Loss = 4.9338e-03, PNorm = 42.6712, GNorm = 2.3566, lr_0 = 7.3888e-04
Loss = 4.2422e-03, PNorm = 42.6946, GNorm = 2.3810, lr_0 = 7.1497e-04
Validation rmse = 1.106570
Epoch 6
Loss = 3.7091e-03, PNorm = 42.7181, GNorm = 1.0582, lr_0 = 6.8956e-04
Loss = 3.6603e-03, PNorm = 42.7374, GNorm = 2.0972, lr_0 = 6.6725e-04
Loss = 3.4745e-03, PNorm = 42.7536, GNorm = 2.1020, lr_0 = 6.4565e-04
Validation rmse = 1.020099
Epoch 7
Loss = 3.0130e-03, PNorm = 42.7701, GNorm = 1.2926, lr_0 = 6.2476e-04
Loss = 3.4640e-03, PNorm = 42.7865, GNorm = 1.7074, lr_0 = 6.0454e-04
Validation rmse = 0.989772
Epoch 8
Loss = 2.1759e-03, PNorm = 42.7996, GNorm = 1.2858, lr_0 = 5.8498e-04
Loss = 3.6215e-03, PNorm = 42.8105, GNorm = 4.0155, lr_0 = 5.6605e-04
Loss = 2.9726e-03, PNorm = 42.8264, GNorm = 1.9676, lr_0 = 5.4774e-04
Validation rmse = 0.993919
Epoch 9
Loss = 2.7308e-03, PNorm = 42.8423, GNorm = 0.9829, lr_0 = 5.3001e-04
Loss = 2.9653e-03, PNorm = 42.8537, GNorm = 1.5545, lr_0 = 5.1286e-04
Validation rmse = 0.949467
Epoch 10
Loss = 3.3360e-03, PNorm = 42.8630, GNorm = 0.7436, lr_0 = 4.9627e-04
Loss = 3.2305e-03, PNorm = 42.8778, GNorm = 4.1755, lr_0 = 4.8021e-04
Loss = 3.5882e-03, PNorm = 42.8903, GNorm = 1.2068, lr_0 = 4.6467e-04
Validation rmse = 0.924033
Epoch 11
Loss = 3.1634e-03, PNorm = 42.9012, GNorm = 1.4072, lr_0 = 4.4963e-04
Loss = 2.6729e-03, PNorm = 42.9126, GNorm = 1.0900, lr_0 = 4.3508e-04
Validation rmse = 0.956220
Epoch 12
Loss = 2.4359e-03, PNorm = 42.9249, GNorm = 1.1753, lr_0 = 4.1962e-04
Loss = 2.4491e-03, PNorm = 42.9315, GNorm = 1.7166, lr_0 = 4.0604e-04
Loss = 2.7739e-03, PNorm = 42.9419, GNorm = 4.6063, lr_0 = 3.9290e-04
Validation rmse = 0.897196
Epoch 13
Loss = 2.5319e-03, PNorm = 42.9505, GNorm = 0.6975, lr_0 = 3.8019e-04
Loss = 2.8613e-03, PNorm = 42.9587, GNorm = 0.9724, lr_0 = 3.6789e-04
Loss = 2.1790e-03, PNorm = 42.9663, GNorm = 1.2533, lr_0 = 3.5598e-04
Validation rmse = 0.925942
Epoch 14
Loss = 2.3246e-03, PNorm = 42.9732, GNorm = 0.6886, lr_0 = 3.4446e-04
Loss = 2.4686e-03, PNorm = 42.9803, GNorm = 1.9352, lr_0 = 3.3332e-04
Validation rmse = 0.897374
Epoch 15
Loss = 2.3615e-03, PNorm = 42.9900, GNorm = 0.9731, lr_0 = 3.2253e-04
Loss = 2.3507e-03, PNorm = 42.9961, GNorm = 1.1209, lr_0 = 3.1209e-04
Loss = 2.2128e-03, PNorm = 43.0036, GNorm = 1.3012, lr_0 = 3.0200e-04
Validation rmse = 0.934543
Epoch 16
Loss = 2.5078e-03, PNorm = 43.0083, GNorm = 0.8165, lr_0 = 2.9222e-04
Loss = 2.6319e-03, PNorm = 43.0174, GNorm = 1.4778, lr_0 = 2.8277e-04
Validation rmse = 0.877116
Epoch 17
Loss = 2.4555e-03, PNorm = 43.0235, GNorm = 2.5665, lr_0 = 2.7272e-04
Loss = 2.0987e-03, PNorm = 43.0295, GNorm = 1.2352, lr_0 = 2.6389e-04
Loss = 2.1290e-03, PNorm = 43.0349, GNorm = 1.9483, lr_0 = 2.5535e-04
Validation rmse = 0.874017
Epoch 18
Loss = 2.2227e-03, PNorm = 43.0407, GNorm = 1.5061, lr_0 = 2.4709e-04
Loss = 2.2482e-03, PNorm = 43.0474, GNorm = 0.8193, lr_0 = 2.3910e-04
Loss = 1.8525e-03, PNorm = 43.0530, GNorm = 1.9026, lr_0 = 2.3136e-04
Validation rmse = 0.848092
Epoch 19
Loss = 2.1933e-03, PNorm = 43.0580, GNorm = 1.2456, lr_0 = 2.2387e-04
Loss = 1.9144e-03, PNorm = 43.0624, GNorm = 1.3737, lr_0 = 2.1663e-04
Validation rmse = 0.889607
Epoch 20
Loss = 1.7157e-03, PNorm = 43.0664, GNorm = 1.6750, lr_0 = 2.0962e-04
Loss = 2.2464e-03, PNorm = 43.0701, GNorm = 1.1532, lr_0 = 2.0283e-04
Loss = 1.8286e-03, PNorm = 43.0732, GNorm = 1.2072, lr_0 = 1.9627e-04
Validation rmse = 0.870458
Epoch 21
Loss = 1.8310e-03, PNorm = 43.0779, GNorm = 1.5630, lr_0 = 1.8992e-04
Loss = 1.8989e-03, PNorm = 43.0812, GNorm = 3.0906, lr_0 = 1.8377e-04
Validation rmse = 0.857383
Epoch 22
Loss = 1.9804e-03, PNorm = 43.0858, GNorm = 1.8470, lr_0 = 1.7783e-04
Loss = 1.8683e-03, PNorm = 43.0904, GNorm = 0.8861, lr_0 = 1.7207e-04
Loss = 2.2784e-03, PNorm = 43.0929, GNorm = 0.8034, lr_0 = 1.6651e-04
Validation rmse = 0.891342
Epoch 23
Loss = 1.9135e-03, PNorm = 43.0972, GNorm = 2.2137, lr_0 = 1.6059e-04
Loss = 1.9424e-03, PNorm = 43.1014, GNorm = 1.0084, lr_0 = 1.5539e-04
Validation rmse = 0.850892
Epoch 24
Loss = 1.7287e-03, PNorm = 43.1043, GNorm = 1.7786, lr_0 = 1.5036e-04
Loss = 1.9478e-03, PNorm = 43.1073, GNorm = 1.8268, lr_0 = 1.4550e-04
Loss = 1.8622e-03, PNorm = 43.1105, GNorm = 1.5417, lr_0 = 1.4079e-04
Validation rmse = 0.862471
Epoch 25
Loss = 1.7775e-03, PNorm = 43.1131, GNorm = 3.0036, lr_0 = 1.3623e-04
Loss = 1.8588e-03, PNorm = 43.1146, GNorm = 1.3825, lr_0 = 1.3183e-04
Loss = 2.0491e-03, PNorm = 43.1174, GNorm = 2.1706, lr_0 = 1.2756e-04
Validation rmse = 0.878273
Epoch 26
Loss = 1.6008e-03, PNorm = 43.1209, GNorm = 0.7903, lr_0 = 1.2343e-04
Loss = 1.7691e-03, PNorm = 43.1228, GNorm = 1.0748, lr_0 = 1.1944e-04
Validation rmse = 0.845259
Epoch 27
Loss = 1.8550e-03, PNorm = 43.1251, GNorm = 1.3956, lr_0 = 1.1557e-04
Loss = 1.8888e-03, PNorm = 43.1283, GNorm = 1.1503, lr_0 = 1.1183e-04
Loss = 1.7995e-03, PNorm = 43.1302, GNorm = 0.5747, lr_0 = 1.0821e-04
Validation rmse = 0.843170
Epoch 28
Loss = 1.9977e-03, PNorm = 43.1328, GNorm = 0.9442, lr_0 = 1.0437e-04
Loss = 1.5240e-03, PNorm = 43.1356, GNorm = 1.0883, lr_0 = 1.0099e-04
Validation rmse = 0.835428
Epoch 29
Loss = 2.1921e-03, PNorm = 43.1379, GNorm = 0.7860, lr_0 = 1.0000e-04
Loss = 1.7577e-03, PNorm = 43.1394, GNorm = 0.9388, lr_0 = 1.0000e-04
Loss = 1.8816e-03, PNorm = 43.1409, GNorm = 3.3234, lr_0 = 1.0000e-04
Validation rmse = 0.843537
Model 0 best validation rmse = 0.835428 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.822238
Ensemble test rmse = 0.822238
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 891,501
Moving model to cuda
Epoch 0
Loss = 1.9863e-02, PNorm = 42.2758, GNorm = 4.0020, lr_0 = 2.9800e-04
Loss = 1.4829e-02, PNorm = 42.2905, GNorm = 6.2732, lr_0 = 4.7800e-04
Validation rmse = 2.140322
Epoch 1
Loss = 1.3786e-02, PNorm = 42.3168, GNorm = 10.2639, lr_0 = 6.7600e-04
Loss = 1.1479e-02, PNorm = 42.3525, GNorm = 2.4349, lr_0 = 8.5600e-04
Loss = 8.6088e-03, PNorm = 42.3923, GNorm = 3.0989, lr_0 = 9.9344e-04
Validation rmse = 1.597232
Epoch 2
Loss = 7.4929e-03, PNorm = 42.4373, GNorm = 5.8646, lr_0 = 9.6130e-04
Loss = 7.3965e-03, PNorm = 42.4723, GNorm = 1.8030, lr_0 = 9.3019e-04
Validation rmse = 1.372057
Epoch 3
Loss = 6.3038e-03, PNorm = 42.5049, GNorm = 3.8289, lr_0 = 9.0009e-04
Loss = 6.6233e-03, PNorm = 42.5354, GNorm = 4.4150, lr_0 = 8.7096e-04
Loss = 6.2471e-03, PNorm = 42.5670, GNorm = 5.3069, lr_0 = 8.4278e-04
Validation rmse = 1.225687
Epoch 4
Loss = 5.5606e-03, PNorm = 42.5892, GNorm = 5.1204, lr_0 = 8.1551e-04
Loss = 4.3782e-03, PNorm = 42.6119, GNorm = 1.2343, lr_0 = 7.8912e-04
Validation rmse = 0.993836
Epoch 5
Loss = 3.3301e-03, PNorm = 42.6338, GNorm = 2.8754, lr_0 = 7.6358e-04
Loss = 4.3511e-03, PNorm = 42.6547, GNorm = 1.8541, lr_0 = 7.3888e-04
Loss = 4.1016e-03, PNorm = 42.6748, GNorm = 3.5224, lr_0 = 7.1497e-04
Validation rmse = 1.014896
Epoch 6
Loss = 4.5706e-03, PNorm = 42.6934, GNorm = 1.0779, lr_0 = 6.8956e-04
Loss = 3.8838e-03, PNorm = 42.7155, GNorm = 0.9844, lr_0 = 6.6725e-04
Loss = 3.8129e-03, PNorm = 42.7318, GNorm = 1.1286, lr_0 = 6.4565e-04
Validation rmse = 0.925892
Epoch 7
Loss = 3.4769e-03, PNorm = 42.7474, GNorm = 0.8480, lr_0 = 6.2476e-04
Loss = 3.4072e-03, PNorm = 42.7605, GNorm = 0.9417, lr_0 = 6.0454e-04
Validation rmse = 0.881093
Epoch 8
Loss = 3.7019e-03, PNorm = 42.7772, GNorm = 1.6834, lr_0 = 5.8498e-04
Loss = 3.6390e-03, PNorm = 42.7930, GNorm = 1.9829, lr_0 = 5.6605e-04
Loss = 3.5114e-03, PNorm = 42.8053, GNorm = 5.7505, lr_0 = 5.4774e-04
Validation rmse = 0.893459
Epoch 9
Loss = 3.2630e-03, PNorm = 42.8180, GNorm = 2.5388, lr_0 = 5.3001e-04
Loss = 3.3684e-03, PNorm = 42.8344, GNorm = 1.2017, lr_0 = 5.1286e-04
Validation rmse = 0.873738
Epoch 10
Loss = 2.9066e-03, PNorm = 42.8455, GNorm = 1.2167, lr_0 = 4.9627e-04
Loss = 3.2510e-03, PNorm = 42.8559, GNorm = 1.7879, lr_0 = 4.8021e-04
Loss = 2.7141e-03, PNorm = 42.8640, GNorm = 2.0810, lr_0 = 4.6467e-04
Validation rmse = 0.871474
Epoch 11
Loss = 2.9517e-03, PNorm = 42.8758, GNorm = 1.2403, lr_0 = 4.4963e-04
Loss = 3.0337e-03, PNorm = 42.8832, GNorm = 1.0384, lr_0 = 4.3508e-04
Validation rmse = 0.827982
Epoch 12
Loss = 3.4509e-03, PNorm = 42.8951, GNorm = 2.0023, lr_0 = 4.1962e-04
Loss = 3.0757e-03, PNorm = 42.9072, GNorm = 3.4232, lr_0 = 4.0604e-04
Loss = 3.1797e-03, PNorm = 42.9177, GNorm = 1.3553, lr_0 = 3.9290e-04
Validation rmse = 1.017961
Epoch 13
Loss = 3.1166e-03, PNorm = 42.9271, GNorm = 1.1391, lr_0 = 3.8019e-04
Loss = 3.4337e-03, PNorm = 42.9387, GNorm = 2.6971, lr_0 = 3.6789e-04
Loss = 2.8815e-03, PNorm = 42.9450, GNorm = 0.8619, lr_0 = 3.5598e-04
Validation rmse = 0.807458
Epoch 14
Loss = 2.6714e-03, PNorm = 42.9538, GNorm = 1.2965, lr_0 = 3.4446e-04
Loss = 2.2133e-03, PNorm = 42.9615, GNorm = 2.5175, lr_0 = 3.3332e-04
Validation rmse = 0.783385
Epoch 15
Loss = 2.4889e-03, PNorm = 42.9687, GNorm = 2.1522, lr_0 = 3.2253e-04
Loss = 2.4462e-03, PNorm = 42.9743, GNorm = 2.0601, lr_0 = 3.1209e-04
Loss = 2.6316e-03, PNorm = 42.9812, GNorm = 1.5157, lr_0 = 3.0200e-04
Validation rmse = 0.806011
Epoch 16
Loss = 3.2438e-03, PNorm = 42.9881, GNorm = 4.5419, lr_0 = 2.9222e-04
Loss = 2.1020e-03, PNorm = 42.9936, GNorm = 2.9530, lr_0 = 2.8277e-04
Validation rmse = 0.803997
Epoch 17
Loss = 2.2003e-03, PNorm = 43.0007, GNorm = 1.1737, lr_0 = 2.7272e-04
Loss = 2.5147e-03, PNorm = 43.0072, GNorm = 1.5765, lr_0 = 2.6389e-04
Loss = 2.2649e-03, PNorm = 43.0148, GNorm = 1.1663, lr_0 = 2.5535e-04
Validation rmse = 0.765734
Epoch 18
Loss = 2.4516e-03, PNorm = 43.0196, GNorm = 1.5573, lr_0 = 2.4709e-04
Loss = 2.6108e-03, PNorm = 43.0245, GNorm = 1.2467, lr_0 = 2.3910e-04
Loss = 2.2680e-03, PNorm = 43.0293, GNorm = 1.4449, lr_0 = 2.3136e-04
Validation rmse = 0.755607
Epoch 19
Loss = 2.2625e-03, PNorm = 43.0324, GNorm = 1.8143, lr_0 = 2.2387e-04
Loss = 2.1975e-03, PNorm = 43.0379, GNorm = 1.8233, lr_0 = 2.1663e-04
Validation rmse = 0.734012
Epoch 20
Loss = 2.2734e-03, PNorm = 43.0425, GNorm = 2.3920, lr_0 = 2.0962e-04
Loss = 2.3651e-03, PNorm = 43.0478, GNorm = 0.8537, lr_0 = 2.0283e-04
Loss = 1.9620e-03, PNorm = 43.0524, GNorm = 2.2248, lr_0 = 1.9627e-04
Validation rmse = 0.762525
Epoch 21
Loss = 2.3585e-03, PNorm = 43.0553, GNorm = 1.7314, lr_0 = 1.8992e-04
Loss = 2.1166e-03, PNorm = 43.0590, GNorm = 1.4214, lr_0 = 1.8377e-04
Validation rmse = 0.743365
Epoch 22
Loss = 1.7934e-03, PNorm = 43.0632, GNorm = 1.5217, lr_0 = 1.7783e-04
Loss = 2.1329e-03, PNorm = 43.0655, GNorm = 1.1620, lr_0 = 1.7207e-04
Loss = 2.0538e-03, PNorm = 43.0691, GNorm = 0.9408, lr_0 = 1.6651e-04
Validation rmse = 0.736480
Epoch 23
Loss = 1.8325e-03, PNorm = 43.0747, GNorm = 1.5145, lr_0 = 1.6059e-04
Loss = 1.8828e-03, PNorm = 43.0782, GNorm = 1.0175, lr_0 = 1.5539e-04
Validation rmse = 0.788315
Epoch 24
Loss = 1.7261e-03, PNorm = 43.0807, GNorm = 1.4645, lr_0 = 1.5036e-04
Loss = 2.1788e-03, PNorm = 43.0834, GNorm = 2.0221, lr_0 = 1.4550e-04
Loss = 1.9870e-03, PNorm = 43.0872, GNorm = 1.2766, lr_0 = 1.4079e-04
Validation rmse = 0.727875
Epoch 25
Loss = 1.4550e-03, PNorm = 43.0898, GNorm = 0.8875, lr_0 = 1.3623e-04
Loss = 1.9283e-03, PNorm = 43.0916, GNorm = 1.5578, lr_0 = 1.3183e-04
Loss = 2.0926e-03, PNorm = 43.0941, GNorm = 0.9551, lr_0 = 1.2756e-04
Validation rmse = 0.731688
Epoch 26
Loss = 1.9323e-03, PNorm = 43.0967, GNorm = 1.2502, lr_0 = 1.2343e-04
Loss = 2.0383e-03, PNorm = 43.1003, GNorm = 0.9332, lr_0 = 1.1944e-04
Validation rmse = 0.723245
Epoch 27
Loss = 2.2590e-03, PNorm = 43.1018, GNorm = 1.6621, lr_0 = 1.1557e-04
Loss = 1.8332e-03, PNorm = 43.1037, GNorm = 3.4834, lr_0 = 1.1183e-04
Loss = 2.0819e-03, PNorm = 43.1061, GNorm = 1.4519, lr_0 = 1.0821e-04
Validation rmse = 0.743460
Epoch 28
Loss = 2.0053e-03, PNorm = 43.1088, GNorm = 1.1539, lr_0 = 1.0437e-04
Loss = 1.7631e-03, PNorm = 43.1103, GNorm = 0.9425, lr_0 = 1.0099e-04
Validation rmse = 0.762190
Epoch 29
Loss = 2.1570e-03, PNorm = 43.1119, GNorm = 3.4374, lr_0 = 1.0000e-04
Loss = 2.0452e-03, PNorm = 43.1146, GNorm = 0.9904, lr_0 = 1.0000e-04
Loss = 1.8065e-03, PNorm = 43.1170, GNorm = 2.4209, lr_0 = 1.0000e-04
Validation rmse = 0.740883
Model 0 best validation rmse = 0.723245 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.711647
Ensemble test rmse = 0.711647
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 891,501
Moving model to cuda
Epoch 0
Loss = 1.9823e-02, PNorm = 42.2759, GNorm = 8.5922, lr_0 = 2.9800e-04
Loss = 1.4855e-02, PNorm = 42.2903, GNorm = 3.1417, lr_0 = 4.7800e-04
Validation rmse = 1.687632
Epoch 1
Loss = 1.3303e-02, PNorm = 42.3206, GNorm = 8.5685, lr_0 = 6.7600e-04
Loss = 1.1486e-02, PNorm = 42.3555, GNorm = 2.2863, lr_0 = 8.5600e-04
Loss = 9.2264e-03, PNorm = 42.4050, GNorm = 8.6021, lr_0 = 9.9344e-04
Validation rmse = 1.503375
Epoch 2
Loss = 8.4905e-03, PNorm = 42.4497, GNorm = 6.5364, lr_0 = 9.6130e-04
Loss = 8.1369e-03, PNorm = 42.4850, GNorm = 1.9539, lr_0 = 9.3019e-04
Validation rmse = 1.156177
Epoch 3
Loss = 6.8739e-03, PNorm = 42.5187, GNorm = 6.9707, lr_0 = 9.0009e-04
Loss = 6.5397e-03, PNorm = 42.5502, GNorm = 2.3514, lr_0 = 8.7096e-04
Loss = 6.7731e-03, PNorm = 42.5816, GNorm = 6.7780, lr_0 = 8.4278e-04
Validation rmse = 1.230881
Epoch 4
Loss = 6.9707e-03, PNorm = 42.6099, GNorm = 3.6108, lr_0 = 8.1551e-04
Loss = 5.7612e-03, PNorm = 42.6367, GNorm = 4.0260, lr_0 = 7.8912e-04
Validation rmse = 1.142784
Epoch 5
Loss = 5.2583e-03, PNorm = 42.6648, GNorm = 2.8640, lr_0 = 7.6358e-04
Loss = 5.2747e-03, PNorm = 42.6947, GNorm = 1.9180, lr_0 = 7.3888e-04
Loss = 4.5499e-03, PNorm = 42.7196, GNorm = 2.5856, lr_0 = 7.1497e-04
Validation rmse = 1.161161
Epoch 6
Loss = 6.3794e-03, PNorm = 42.7400, GNorm = 7.3602, lr_0 = 6.8956e-04
Loss = 3.8714e-03, PNorm = 42.7607, GNorm = 3.0392, lr_0 = 6.6725e-04
Loss = 4.6824e-03, PNorm = 42.7828, GNorm = 2.9234, lr_0 = 6.4565e-04
Validation rmse = 0.911525
Epoch 7
Loss = 3.9237e-03, PNorm = 42.8008, GNorm = 3.1588, lr_0 = 6.2476e-04
Loss = 3.7917e-03, PNorm = 42.8183, GNorm = 1.6441, lr_0 = 6.0454e-04
Validation rmse = 0.867790
Epoch 8
Loss = 3.8325e-03, PNorm = 42.8365, GNorm = 1.4399, lr_0 = 5.8498e-04
Loss = 3.2022e-03, PNorm = 42.8543, GNorm = 0.8623, lr_0 = 5.6605e-04
Loss = 3.7144e-03, PNorm = 42.8708, GNorm = 3.1169, lr_0 = 5.4774e-04
Validation rmse = 0.787976
Epoch 9
Loss = 3.0752e-03, PNorm = 42.8848, GNorm = 1.5728, lr_0 = 5.3001e-04
Loss = 3.2496e-03, PNorm = 42.9011, GNorm = 0.9906, lr_0 = 5.1286e-04
Validation rmse = 0.772746
Epoch 10
Loss = 2.7883e-03, PNorm = 42.9121, GNorm = 2.1793, lr_0 = 4.9627e-04
Loss = 3.0969e-03, PNorm = 42.9235, GNorm = 3.7186, lr_0 = 4.8021e-04
Loss = 3.2933e-03, PNorm = 42.9366, GNorm = 2.5927, lr_0 = 4.6467e-04
Validation rmse = 0.757830
Epoch 11
Loss = 2.7312e-03, PNorm = 42.9496, GNorm = 1.2326, lr_0 = 4.4963e-04
Loss = 2.9227e-03, PNorm = 42.9588, GNorm = 0.6765, lr_0 = 4.3508e-04
Validation rmse = 0.755018
Epoch 12
Loss = 2.1865e-03, PNorm = 42.9716, GNorm = 1.9848, lr_0 = 4.1962e-04
Loss = 3.1717e-03, PNorm = 42.9823, GNorm = 1.7215, lr_0 = 4.0604e-04
Loss = 2.3324e-03, PNorm = 42.9922, GNorm = 1.2133, lr_0 = 3.9290e-04
Validation rmse = 0.758970
Epoch 13
Loss = 2.1223e-03, PNorm = 43.0021, GNorm = 0.7144, lr_0 = 3.8019e-04
Loss = 2.8070e-03, PNorm = 43.0110, GNorm = 2.4458, lr_0 = 3.6789e-04
Loss = 2.6123e-03, PNorm = 43.0200, GNorm = 0.8894, lr_0 = 3.5598e-04
Validation rmse = 0.738005
Epoch 14
Loss = 2.5371e-03, PNorm = 43.0257, GNorm = 1.8789, lr_0 = 3.4446e-04
Loss = 3.0959e-03, PNorm = 43.0343, GNorm = 1.2637, lr_0 = 3.3332e-04
Validation rmse = 0.758779
Epoch 15
Loss = 2.4447e-03, PNorm = 43.0430, GNorm = 3.7877, lr_0 = 3.2253e-04
Loss = 2.6894e-03, PNorm = 43.0514, GNorm = 2.5193, lr_0 = 3.1209e-04
Loss = 3.0059e-03, PNorm = 43.0603, GNorm = 1.3001, lr_0 = 3.0200e-04
Validation rmse = 0.733058
Epoch 16
Loss = 2.3037e-03, PNorm = 43.0681, GNorm = 1.1283, lr_0 = 2.9222e-04
Loss = 2.2644e-03, PNorm = 43.0739, GNorm = 2.5556, lr_0 = 2.8277e-04
Validation rmse = 0.697651
Epoch 17
Loss = 2.1697e-03, PNorm = 43.0801, GNorm = 3.5166, lr_0 = 2.7272e-04
Loss = 2.2011e-03, PNorm = 43.0850, GNorm = 1.1569, lr_0 = 2.6389e-04
Loss = 2.5645e-03, PNorm = 43.0913, GNorm = 1.7158, lr_0 = 2.5535e-04
Validation rmse = 0.701140
Epoch 18
Loss = 2.5702e-03, PNorm = 43.0981, GNorm = 0.9139, lr_0 = 2.4709e-04
Loss = 2.3610e-03, PNorm = 43.1035, GNorm = 3.2192, lr_0 = 2.3910e-04
Loss = 2.3656e-03, PNorm = 43.1090, GNorm = 1.9483, lr_0 = 2.3136e-04
Validation rmse = 0.731968
Epoch 19
Loss = 2.7157e-03, PNorm = 43.1135, GNorm = 1.0288, lr_0 = 2.2387e-04
Loss = 2.1003e-03, PNorm = 43.1184, GNorm = 1.0124, lr_0 = 2.1663e-04
Validation rmse = 0.703606
Epoch 20
Loss = 2.4134e-03, PNorm = 43.1233, GNorm = 3.9119, lr_0 = 2.0962e-04
Loss = 2.3475e-03, PNorm = 43.1279, GNorm = 1.3253, lr_0 = 2.0283e-04
Loss = 1.9314e-03, PNorm = 43.1327, GNorm = 1.1552, lr_0 = 1.9627e-04
Validation rmse = 0.682503
Epoch 21
Loss = 1.9571e-03, PNorm = 43.1352, GNorm = 2.1829, lr_0 = 1.8992e-04
Loss = 2.4640e-03, PNorm = 43.1382, GNorm = 2.9075, lr_0 = 1.8377e-04
Validation rmse = 0.743829
Epoch 22
Loss = 2.3366e-03, PNorm = 43.1412, GNorm = 1.2665, lr_0 = 1.7783e-04
Loss = 2.4308e-03, PNorm = 43.1454, GNorm = 2.1243, lr_0 = 1.7207e-04
Loss = 2.1503e-03, PNorm = 43.1504, GNorm = 1.0460, lr_0 = 1.6651e-04
Validation rmse = 0.680529
Epoch 23
Loss = 2.1134e-03, PNorm = 43.1539, GNorm = 1.2724, lr_0 = 1.6059e-04
Loss = 2.1820e-03, PNorm = 43.1572, GNorm = 1.5249, lr_0 = 1.5539e-04
Validation rmse = 0.705118
Epoch 24
Loss = 2.2539e-03, PNorm = 43.1600, GNorm = 2.3053, lr_0 = 1.5036e-04
Loss = 1.8872e-03, PNorm = 43.1620, GNorm = 1.8566, lr_0 = 1.4550e-04
Loss = 1.9776e-03, PNorm = 43.1650, GNorm = 3.1014, lr_0 = 1.4079e-04
Validation rmse = 0.666101
Epoch 25
Loss = 2.1565e-03, PNorm = 43.1683, GNorm = 2.9734, lr_0 = 1.3623e-04
Loss = 1.9605e-03, PNorm = 43.1720, GNorm = 1.1178, lr_0 = 1.3183e-04
Loss = 1.8112e-03, PNorm = 43.1739, GNorm = 1.4034, lr_0 = 1.2756e-04
Validation rmse = 0.677015
Epoch 26
Loss = 2.0468e-03, PNorm = 43.1762, GNorm = 4.6234, lr_0 = 1.2343e-04
Loss = 1.8249e-03, PNorm = 43.1782, GNorm = 0.8536, lr_0 = 1.1944e-04
Validation rmse = 0.676030
Epoch 27
Loss = 2.3118e-03, PNorm = 43.1809, GNorm = 2.3635, lr_0 = 1.1557e-04
Loss = 2.1220e-03, PNorm = 43.1837, GNorm = 1.1487, lr_0 = 1.1183e-04
Loss = 1.8130e-03, PNorm = 43.1862, GNorm = 1.1296, lr_0 = 1.0821e-04
Validation rmse = 0.666206
Epoch 28
Loss = 1.8022e-03, PNorm = 43.1887, GNorm = 1.3268, lr_0 = 1.0437e-04
Loss = 2.0937e-03, PNorm = 43.1904, GNorm = 1.1607, lr_0 = 1.0099e-04
Validation rmse = 0.659855
Epoch 29
Loss = 1.8947e-03, PNorm = 43.1925, GNorm = 1.5573, lr_0 = 1.0000e-04
Loss = 1.9752e-03, PNorm = 43.1954, GNorm = 1.5771, lr_0 = 1.0000e-04
Loss = 1.7577e-03, PNorm = 43.1977, GNorm = 0.7917, lr_0 = 1.0000e-04
Validation rmse = 0.665930
Model 0 best validation rmse = 0.659855 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.711353
Ensemble test rmse = 0.711353
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 891,501
Moving model to cuda
Epoch 0
Loss = 1.8600e-02, PNorm = 42.2751, GNorm = 8.1555, lr_0 = 2.9800e-04
Loss = 1.4785e-02, PNorm = 42.2901, GNorm = 8.2681, lr_0 = 4.7800e-04
Validation rmse = 1.484357
Epoch 1
Loss = 8.8700e-03, PNorm = 42.3195, GNorm = 5.8548, lr_0 = 6.7600e-04
Loss = 9.5388e-03, PNorm = 42.3561, GNorm = 11.8220, lr_0 = 8.5600e-04
Loss = 9.3481e-03, PNorm = 42.3973, GNorm = 1.8684, lr_0 = 9.9344e-04
Validation rmse = 1.643738
Epoch 2
Loss = 1.0039e-02, PNorm = 42.4421, GNorm = 7.1269, lr_0 = 9.6130e-04
Loss = 7.8765e-03, PNorm = 42.4780, GNorm = 3.9724, lr_0 = 9.3019e-04
Validation rmse = 1.168571
Epoch 3
Loss = 5.8648e-03, PNorm = 42.5117, GNorm = 2.6837, lr_0 = 9.0009e-04
Loss = 5.9213e-03, PNorm = 42.5410, GNorm = 1.7599, lr_0 = 8.7096e-04
Loss = 5.1777e-03, PNorm = 42.5703, GNorm = 2.9851, lr_0 = 8.4278e-04
Validation rmse = 1.171114
Epoch 4
Loss = 6.0638e-03, PNorm = 42.5928, GNorm = 6.7808, lr_0 = 8.1551e-04
Loss = 4.7031e-03, PNorm = 42.6212, GNorm = 2.6264, lr_0 = 7.8912e-04
Validation rmse = 0.965435
Epoch 5
Loss = 5.1034e-03, PNorm = 42.6439, GNorm = 2.3863, lr_0 = 7.6358e-04
Loss = 3.5945e-03, PNorm = 42.6650, GNorm = 1.2587, lr_0 = 7.3888e-04
Loss = 4.5714e-03, PNorm = 42.6843, GNorm = 5.5599, lr_0 = 7.1497e-04
Validation rmse = 0.976889
Epoch 6
Loss = 4.8005e-03, PNorm = 42.7056, GNorm = 3.2736, lr_0 = 6.8956e-04
Loss = 4.2868e-03, PNorm = 42.7308, GNorm = 2.6788, lr_0 = 6.6725e-04
Loss = 3.5422e-03, PNorm = 42.7507, GNorm = 1.7329, lr_0 = 6.4565e-04
Validation rmse = 0.871841
Epoch 7
Loss = 3.2776e-03, PNorm = 42.7674, GNorm = 3.0498, lr_0 = 6.2476e-04
Loss = 4.0258e-03, PNorm = 42.7846, GNorm = 2.3542, lr_0 = 6.0454e-04
Validation rmse = 0.832525
Epoch 8
Loss = 3.0479e-03, PNorm = 42.8013, GNorm = 1.1757, lr_0 = 5.8498e-04
Loss = 3.0095e-03, PNorm = 42.8145, GNorm = 1.3510, lr_0 = 5.6605e-04
Loss = 3.0627e-03, PNorm = 42.8300, GNorm = 1.0624, lr_0 = 5.4774e-04
Validation rmse = 0.797721
Epoch 9
Loss = 3.3519e-03, PNorm = 42.8421, GNorm = 3.8017, lr_0 = 5.3001e-04
Loss = 3.3269e-03, PNorm = 42.8558, GNorm = 2.6464, lr_0 = 5.1286e-04
Validation rmse = 0.787371
Epoch 10
Loss = 1.7626e-03, PNorm = 42.8707, GNorm = 0.9999, lr_0 = 4.9627e-04
Loss = 2.7663e-03, PNorm = 42.8826, GNorm = 2.9911, lr_0 = 4.8021e-04
Loss = 3.2476e-03, PNorm = 42.8939, GNorm = 1.6342, lr_0 = 4.6467e-04
Validation rmse = 0.774336
Epoch 11
Loss = 2.3702e-03, PNorm = 42.9048, GNorm = 1.5997, lr_0 = 4.4963e-04
Loss = 2.9873e-03, PNorm = 42.9138, GNorm = 1.5761, lr_0 = 4.3508e-04
Validation rmse = 0.757896
Epoch 12
Loss = 2.5367e-03, PNorm = 42.9241, GNorm = 1.5765, lr_0 = 4.1962e-04
Loss = 2.5979e-03, PNorm = 42.9334, GNorm = 2.7093, lr_0 = 4.0604e-04
Loss = 2.8428e-03, PNorm = 42.9438, GNorm = 4.9112, lr_0 = 3.9290e-04
Validation rmse = 0.742671
Epoch 13
Loss = 3.0948e-03, PNorm = 42.9550, GNorm = 3.1859, lr_0 = 3.8019e-04
Loss = 2.7129e-03, PNorm = 42.9632, GNorm = 2.0536, lr_0 = 3.6789e-04
Loss = 2.3342e-03, PNorm = 42.9706, GNorm = 1.1209, lr_0 = 3.5598e-04
Validation rmse = 0.719204
Epoch 14
Loss = 2.2232e-03, PNorm = 42.9781, GNorm = 0.9135, lr_0 = 3.4446e-04
Loss = 2.1484e-03, PNorm = 42.9858, GNorm = 1.1886, lr_0 = 3.3332e-04
Validation rmse = 0.722917
Epoch 15
Loss = 2.5118e-03, PNorm = 42.9932, GNorm = 2.3663, lr_0 = 3.2253e-04
Loss = 2.7964e-03, PNorm = 43.0007, GNorm = 2.2618, lr_0 = 3.1209e-04
Loss = 2.5571e-03, PNorm = 43.0082, GNorm = 6.3436, lr_0 = 3.0200e-04
Validation rmse = 0.810177
Epoch 16
Loss = 2.7855e-03, PNorm = 43.0145, GNorm = 3.3364, lr_0 = 2.9222e-04
Loss = 2.6341e-03, PNorm = 43.0219, GNorm = 3.2248, lr_0 = 2.8277e-04
Validation rmse = 0.754287
Epoch 17
Loss = 2.3342e-03, PNorm = 43.0311, GNorm = 1.9811, lr_0 = 2.7272e-04
Loss = 2.0493e-03, PNorm = 43.0368, GNorm = 3.1378, lr_0 = 2.6389e-04
Loss = 2.2777e-03, PNorm = 43.0427, GNorm = 0.6728, lr_0 = 2.5535e-04
Validation rmse = 0.701069
Epoch 18
Loss = 1.9148e-03, PNorm = 43.0481, GNorm = 2.6808, lr_0 = 2.4709e-04
Loss = 2.5741e-03, PNorm = 43.0533, GNorm = 2.1631, lr_0 = 2.3910e-04
Loss = 1.9924e-03, PNorm = 43.0593, GNorm = 0.7804, lr_0 = 2.3136e-04
Validation rmse = 0.691848
Epoch 19
Loss = 2.4438e-03, PNorm = 43.0637, GNorm = 1.4057, lr_0 = 2.2387e-04
Loss = 1.8920e-03, PNorm = 43.0683, GNorm = 1.7740, lr_0 = 2.1663e-04
Validation rmse = 0.683579
Epoch 20
Loss = 2.3431e-03, PNorm = 43.0720, GNorm = 1.4655, lr_0 = 2.0962e-04
Loss = 2.2947e-03, PNorm = 43.0756, GNorm = 1.3223, lr_0 = 2.0283e-04
Loss = 2.3550e-03, PNorm = 43.0791, GNorm = 1.1954, lr_0 = 1.9627e-04
Validation rmse = 0.677756
Epoch 21
Loss = 2.2187e-03, PNorm = 43.0828, GNorm = 0.7068, lr_0 = 1.8992e-04
Loss = 2.4829e-03, PNorm = 43.0872, GNorm = 1.4221, lr_0 = 1.8377e-04
Validation rmse = 0.666418
Epoch 22
Loss = 3.0080e-03, PNorm = 43.0907, GNorm = 3.1717, lr_0 = 1.7783e-04
Loss = 2.1649e-03, PNorm = 43.0955, GNorm = 2.6747, lr_0 = 1.7207e-04
Loss = 1.7573e-03, PNorm = 43.0984, GNorm = 2.2647, lr_0 = 1.6651e-04
Validation rmse = 0.695021
Epoch 23
Loss = 2.2497e-03, PNorm = 43.1023, GNorm = 0.9090, lr_0 = 1.6059e-04
Loss = 2.0150e-03, PNorm = 43.1052, GNorm = 1.0240, lr_0 = 1.5539e-04
Validation rmse = 0.687657
Epoch 24
Loss = 2.0448e-03, PNorm = 43.1081, GNorm = 1.6835, lr_0 = 1.5036e-04
Loss = 2.0923e-03, PNorm = 43.1126, GNorm = 1.0798, lr_0 = 1.4550e-04
Loss = 1.8110e-03, PNorm = 43.1143, GNorm = 0.9489, lr_0 = 1.4079e-04
Validation rmse = 0.684683
Epoch 25
Loss = 2.1089e-03, PNorm = 43.1174, GNorm = 0.7806, lr_0 = 1.3623e-04
Loss = 2.0769e-03, PNorm = 43.1204, GNorm = 1.3548, lr_0 = 1.3183e-04
Loss = 2.0409e-03, PNorm = 43.1226, GNorm = 1.2150, lr_0 = 1.2756e-04
Validation rmse = 0.670734
Epoch 26
Loss = 2.1648e-03, PNorm = 43.1255, GNorm = 1.0025, lr_0 = 1.2343e-04
Loss = 1.9042e-03, PNorm = 43.1273, GNorm = 1.0322, lr_0 = 1.1944e-04
Validation rmse = 0.669061
Epoch 27
Loss = 1.4903e-03, PNorm = 43.1296, GNorm = 0.8932, lr_0 = 1.1557e-04
Loss = 2.0241e-03, PNorm = 43.1326, GNorm = 0.8432, lr_0 = 1.1183e-04
Loss = 1.8242e-03, PNorm = 43.1343, GNorm = 2.6993, lr_0 = 1.0821e-04
Validation rmse = 0.661421
Epoch 28
Loss = 2.0987e-03, PNorm = 43.1365, GNorm = 2.1664, lr_0 = 1.0437e-04
Loss = 2.1677e-03, PNorm = 43.1376, GNorm = 2.5436, lr_0 = 1.0099e-04
Validation rmse = 0.689598
Epoch 29
Loss = 1.2613e-03, PNorm = 43.1395, GNorm = 1.2087, lr_0 = 1.0000e-04
Loss = 1.6449e-03, PNorm = 43.1412, GNorm = 0.6487, lr_0 = 1.0000e-04
Loss = 2.1379e-03, PNorm = 43.1420, GNorm = 1.0404, lr_0 = 1.0000e-04
Validation rmse = 0.655907
Model 0 best validation rmse = 0.655907 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.873153
Ensemble test rmse = 0.873153
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 891,501
Moving model to cuda
Epoch 0
Loss = 1.8452e-02, PNorm = 42.2766, GNorm = 4.4680, lr_0 = 2.9800e-04
Loss = 1.6240e-02, PNorm = 42.2916, GNorm = 4.0182, lr_0 = 4.7800e-04
Validation rmse = 2.075140
Epoch 1
Loss = 1.0753e-02, PNorm = 42.3250, GNorm = 4.7471, lr_0 = 6.7600e-04
Loss = 1.0149e-02, PNorm = 42.3609, GNorm = 2.2614, lr_0 = 8.5600e-04
Loss = 9.1340e-03, PNorm = 42.4049, GNorm = 5.1791, lr_0 = 9.9344e-04
Validation rmse = 1.502890
Epoch 2
Loss = 7.8155e-03, PNorm = 42.4484, GNorm = 1.7580, lr_0 = 9.6130e-04
Loss = 6.6928e-03, PNorm = 42.4820, GNorm = 4.8420, lr_0 = 9.3019e-04
Validation rmse = 1.194388
Epoch 3
Loss = 5.0332e-03, PNorm = 42.5144, GNorm = 2.7757, lr_0 = 9.0009e-04
Loss = 6.0911e-03, PNorm = 42.5404, GNorm = 9.4058, lr_0 = 8.7096e-04
Loss = 4.5396e-03, PNorm = 42.5689, GNorm = 2.3973, lr_0 = 8.4278e-04
Validation rmse = 1.109206
Epoch 4
Loss = 4.3659e-03, PNorm = 42.5958, GNorm = 5.1312, lr_0 = 8.1551e-04
Loss = 5.0482e-03, PNorm = 42.6190, GNorm = 3.1869, lr_0 = 7.8912e-04
Validation rmse = 1.003680
Epoch 5
Loss = 5.0998e-03, PNorm = 42.6445, GNorm = 2.1581, lr_0 = 7.6358e-04
Loss = 4.4510e-03, PNorm = 42.6671, GNorm = 1.8314, lr_0 = 7.3888e-04
Loss = 3.8775e-03, PNorm = 42.6886, GNorm = 2.1798, lr_0 = 7.1497e-04
Validation rmse = 0.925700
Epoch 6
Loss = 3.5348e-03, PNorm = 42.7044, GNorm = 2.1491, lr_0 = 6.8956e-04
Loss = 3.7272e-03, PNorm = 42.7236, GNorm = 4.4472, lr_0 = 6.6725e-04
Loss = 3.8407e-03, PNorm = 42.7416, GNorm = 7.6711, lr_0 = 6.4565e-04
Validation rmse = 1.122908
Epoch 7
Loss = 3.7313e-03, PNorm = 42.7578, GNorm = 0.9131, lr_0 = 6.2476e-04
Loss = 3.6804e-03, PNorm = 42.7772, GNorm = 6.3019, lr_0 = 6.0454e-04
Validation rmse = 1.104284
Epoch 8
Loss = 3.9675e-03, PNorm = 42.7887, GNorm = 5.9423, lr_0 = 5.8498e-04
Loss = 3.6032e-03, PNorm = 42.8082, GNorm = 4.9542, lr_0 = 5.6605e-04
Loss = 3.2553e-03, PNorm = 42.8230, GNorm = 1.2171, lr_0 = 5.4774e-04
Validation rmse = 0.882097
Epoch 9
Loss = 3.1438e-03, PNorm = 42.8367, GNorm = 1.6641, lr_0 = 5.3001e-04
Loss = 3.0097e-03, PNorm = 42.8500, GNorm = 2.4319, lr_0 = 5.1286e-04
Validation rmse = 0.919207
Epoch 10
Loss = 2.7699e-03, PNorm = 42.8615, GNorm = 1.8088, lr_0 = 4.9627e-04
Loss = 2.9911e-03, PNorm = 42.8720, GNorm = 2.0584, lr_0 = 4.8021e-04
Loss = 2.7164e-03, PNorm = 42.8853, GNorm = 2.1778, lr_0 = 4.6467e-04
Validation rmse = 0.863280
Epoch 11
Loss = 2.4734e-03, PNorm = 42.8930, GNorm = 2.0215, lr_0 = 4.4963e-04
Loss = 3.2143e-03, PNorm = 42.9031, GNorm = 1.6892, lr_0 = 4.3508e-04
Validation rmse = 0.862738
Epoch 12
Loss = 3.0312e-03, PNorm = 42.9130, GNorm = 0.9718, lr_0 = 4.1962e-04
Loss = 2.3519e-03, PNorm = 42.9234, GNorm = 2.0519, lr_0 = 4.0604e-04
Loss = 2.4088e-03, PNorm = 42.9311, GNorm = 0.7309, lr_0 = 3.9290e-04
Validation rmse = 0.852700
Epoch 13
Loss = 2.4123e-03, PNorm = 42.9407, GNorm = 3.6852, lr_0 = 3.8019e-04
Loss = 2.7076e-03, PNorm = 42.9495, GNorm = 1.2511, lr_0 = 3.6789e-04
Loss = 2.3402e-03, PNorm = 42.9576, GNorm = 0.8174, lr_0 = 3.5598e-04
Validation rmse = 0.877930
Epoch 14
Loss = 2.3047e-03, PNorm = 42.9659, GNorm = 2.6916, lr_0 = 3.4446e-04
Loss = 2.4052e-03, PNorm = 42.9716, GNorm = 3.5803, lr_0 = 3.3332e-04
Validation rmse = 0.845171
Epoch 15
Loss = 1.8167e-03, PNorm = 42.9787, GNorm = 1.3412, lr_0 = 3.2253e-04
Loss = 2.4686e-03, PNorm = 42.9859, GNorm = 1.1989, lr_0 = 3.1209e-04
Loss = 2.1522e-03, PNorm = 42.9930, GNorm = 0.9122, lr_0 = 3.0200e-04
Validation rmse = 0.826690
Epoch 16
Loss = 2.3841e-03, PNorm = 42.9991, GNorm = 1.0888, lr_0 = 2.9222e-04
Loss = 2.4974e-03, PNorm = 43.0074, GNorm = 4.1846, lr_0 = 2.8277e-04
Validation rmse = 0.798593
Epoch 17
Loss = 2.4830e-03, PNorm = 43.0138, GNorm = 3.7922, lr_0 = 2.7272e-04
Loss = 2.4356e-03, PNorm = 43.0205, GNorm = 3.3197, lr_0 = 2.6389e-04
Loss = 2.2780e-03, PNorm = 43.0241, GNorm = 1.0659, lr_0 = 2.5535e-04
Validation rmse = 0.851533
Epoch 18
Loss = 2.1502e-03, PNorm = 43.0302, GNorm = 2.2215, lr_0 = 2.4709e-04
Loss = 2.2975e-03, PNorm = 43.0357, GNorm = 4.3400, lr_0 = 2.3910e-04
Loss = 2.2308e-03, PNorm = 43.0410, GNorm = 2.9253, lr_0 = 2.3136e-04
Validation rmse = 0.816381
Epoch 19
Loss = 2.2941e-03, PNorm = 43.0456, GNorm = 3.6352, lr_0 = 2.2387e-04
Loss = 2.1513e-03, PNorm = 43.0494, GNorm = 2.5248, lr_0 = 2.1663e-04
Validation rmse = 0.879892
Epoch 20
Loss = 1.6492e-03, PNorm = 43.0545, GNorm = 1.3832, lr_0 = 2.0962e-04
Loss = 2.3446e-03, PNorm = 43.0604, GNorm = 1.2298, lr_0 = 2.0283e-04
Loss = 2.1093e-03, PNorm = 43.0631, GNorm = 2.4303, lr_0 = 1.9627e-04
Validation rmse = 0.859469
Epoch 21
Loss = 2.1569e-03, PNorm = 43.0661, GNorm = 0.9891, lr_0 = 1.8992e-04
Loss = 2.0845e-03, PNorm = 43.0706, GNorm = 1.3579, lr_0 = 1.8377e-04
Validation rmse = 0.814806
Epoch 22
Loss = 2.0221e-03, PNorm = 43.0750, GNorm = 0.6368, lr_0 = 1.7783e-04
Loss = 1.5808e-03, PNorm = 43.0780, GNorm = 0.4886, lr_0 = 1.7207e-04
Loss = 2.2066e-03, PNorm = 43.0815, GNorm = 0.8603, lr_0 = 1.6651e-04
Validation rmse = 0.780459
Epoch 23
Loss = 2.0093e-03, PNorm = 43.0847, GNorm = 0.9514, lr_0 = 1.6059e-04
Loss = 1.4857e-03, PNorm = 43.0867, GNorm = 0.9366, lr_0 = 1.5539e-04
Validation rmse = 0.782306
Epoch 24
Loss = 2.0025e-03, PNorm = 43.0900, GNorm = 1.4977, lr_0 = 1.5036e-04
Loss = 2.0621e-03, PNorm = 43.0912, GNorm = 3.1950, lr_0 = 1.4550e-04
Loss = 2.1450e-03, PNorm = 43.0935, GNorm = 1.0995, lr_0 = 1.4079e-04
Validation rmse = 0.806781
Epoch 25
Loss = 2.0954e-03, PNorm = 43.0969, GNorm = 3.1257, lr_0 = 1.3623e-04
Loss = 2.0217e-03, PNorm = 43.1010, GNorm = 3.0162, lr_0 = 1.3183e-04
Loss = 1.7931e-03, PNorm = 43.1031, GNorm = 1.1724, lr_0 = 1.2756e-04
Validation rmse = 0.781075
Epoch 26
Loss = 1.6888e-03, PNorm = 43.1043, GNorm = 0.8098, lr_0 = 1.2343e-04
Loss = 1.9423e-03, PNorm = 43.1063, GNorm = 1.4400, lr_0 = 1.1944e-04
Validation rmse = 0.803413
Epoch 27
Loss = 1.6468e-03, PNorm = 43.1084, GNorm = 0.6448, lr_0 = 1.1557e-04
Loss = 1.6125e-03, PNorm = 43.1104, GNorm = 1.3122, lr_0 = 1.1183e-04
Loss = 1.8271e-03, PNorm = 43.1126, GNorm = 2.4269, lr_0 = 1.0821e-04
Validation rmse = 0.782430
Epoch 28
Loss = 1.7238e-03, PNorm = 43.1152, GNorm = 1.8358, lr_0 = 1.0437e-04
Loss = 1.9815e-03, PNorm = 43.1164, GNorm = 1.7875, lr_0 = 1.0099e-04
Validation rmse = 0.790724
Epoch 29
Loss = 2.5484e-03, PNorm = 43.1175, GNorm = 0.8426, lr_0 = 1.0000e-04
Loss = 1.9326e-03, PNorm = 43.1193, GNorm = 2.1012, lr_0 = 1.0000e-04
Loss = 1.6507e-03, PNorm = 43.1220, GNorm = 1.6918, lr_0 = 1.0000e-04
Validation rmse = 0.787177
Model 0 best validation rmse = 0.780459 on epoch 22
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.084035
Ensemble test rmse = 1.084035
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 891,501
Moving model to cuda
Epoch 0
Loss = 1.9850e-02, PNorm = 42.2763, GNorm = 3.5025, lr_0 = 2.9800e-04
Loss = 1.5134e-02, PNorm = 42.2909, GNorm = 4.4066, lr_0 = 4.7800e-04
Validation rmse = 1.684506
Epoch 1
Loss = 9.5199e-03, PNorm = 42.3190, GNorm = 4.0943, lr_0 = 6.7600e-04
Loss = 8.9464e-03, PNorm = 42.3588, GNorm = 1.9183, lr_0 = 8.5600e-04
Loss = 1.0996e-02, PNorm = 42.3975, GNorm = 9.1301, lr_0 = 9.9344e-04
Validation rmse = 1.713530
Epoch 2
Loss = 8.3327e-03, PNorm = 42.4406, GNorm = 4.1803, lr_0 = 9.6130e-04
Loss = 7.7917e-03, PNorm = 42.4780, GNorm = 2.1297, lr_0 = 9.3019e-04
Validation rmse = 1.354163
Epoch 3
Loss = 6.1307e-03, PNorm = 42.5087, GNorm = 2.4841, lr_0 = 9.0009e-04
Loss = 5.7269e-03, PNorm = 42.5397, GNorm = 2.9944, lr_0 = 8.7096e-04
Loss = 5.6392e-03, PNorm = 42.5632, GNorm = 5.3556, lr_0 = 8.4278e-04
Validation rmse = 1.102988
Epoch 4
Loss = 4.5018e-03, PNorm = 42.5951, GNorm = 3.2787, lr_0 = 8.1551e-04
Loss = 5.1010e-03, PNorm = 42.6136, GNorm = 7.2444, lr_0 = 7.8912e-04
Validation rmse = 1.064404
Epoch 5
Loss = 3.8227e-03, PNorm = 42.6381, GNorm = 1.8251, lr_0 = 7.6358e-04
Loss = 4.1488e-03, PNorm = 42.6543, GNorm = 3.8108, lr_0 = 7.3888e-04
Loss = 4.3498e-03, PNorm = 42.6738, GNorm = 1.6335, lr_0 = 7.1497e-04
Validation rmse = 1.067307
Epoch 6
Loss = 4.1663e-03, PNorm = 42.6972, GNorm = 2.2117, lr_0 = 6.8956e-04
Loss = 5.0559e-03, PNorm = 42.7166, GNorm = 2.3210, lr_0 = 6.6725e-04
Loss = 3.4569e-03, PNorm = 42.7338, GNorm = 1.2012, lr_0 = 6.4565e-04
Validation rmse = 1.046958
Epoch 7
Loss = 3.0811e-03, PNorm = 42.7485, GNorm = 2.3142, lr_0 = 6.2476e-04
Loss = 3.7855e-03, PNorm = 42.7621, GNorm = 2.8215, lr_0 = 6.0454e-04
Validation rmse = 1.141485
Epoch 8
Loss = 3.7436e-03, PNorm = 42.7759, GNorm = 2.7881, lr_0 = 5.8498e-04
Loss = 3.6341e-03, PNorm = 42.7934, GNorm = 2.7113, lr_0 = 5.6605e-04
Loss = 3.2735e-03, PNorm = 42.8072, GNorm = 1.1136, lr_0 = 5.4774e-04
Validation rmse = 1.060775
Epoch 9
Loss = 3.1146e-03, PNorm = 42.8189, GNorm = 2.0127, lr_0 = 5.3001e-04
Loss = 3.2855e-03, PNorm = 42.8304, GNorm = 3.5319, lr_0 = 5.1286e-04
Validation rmse = 0.974478
Epoch 10
Loss = 2.2949e-03, PNorm = 42.8439, GNorm = 1.6447, lr_0 = 4.9627e-04
Loss = 2.7252e-03, PNorm = 42.8543, GNorm = 1.7790, lr_0 = 4.8021e-04
Loss = 3.4650e-03, PNorm = 42.8687, GNorm = 4.4316, lr_0 = 4.6467e-04
Validation rmse = 1.049846
Epoch 11
Loss = 3.1260e-03, PNorm = 42.8803, GNorm = 2.3358, lr_0 = 4.4963e-04
Loss = 3.0580e-03, PNorm = 42.8916, GNorm = 1.0203, lr_0 = 4.3508e-04
Validation rmse = 0.991851
Epoch 12
Loss = 2.8085e-03, PNorm = 42.9010, GNorm = 1.7103, lr_0 = 4.1962e-04
Loss = 2.5042e-03, PNorm = 42.9085, GNorm = 0.7944, lr_0 = 4.0604e-04
Loss = 2.5113e-03, PNorm = 42.9175, GNorm = 0.7947, lr_0 = 3.9290e-04
Validation rmse = 1.159995
Epoch 13
Loss = 3.1880e-03, PNorm = 42.9267, GNorm = 9.0418, lr_0 = 3.8019e-04
Loss = 2.6406e-03, PNorm = 42.9343, GNorm = 1.3315, lr_0 = 3.6789e-04
Loss = 3.4373e-03, PNorm = 42.9435, GNorm = 3.0948, lr_0 = 3.5598e-04
Validation rmse = 1.142476
Epoch 14
Loss = 2.7936e-03, PNorm = 42.9514, GNorm = 1.1936, lr_0 = 3.4446e-04
Loss = 2.6858e-03, PNorm = 42.9597, GNorm = 2.6598, lr_0 = 3.3332e-04
Validation rmse = 1.033848
Epoch 15
Loss = 3.1266e-03, PNorm = 42.9683, GNorm = 1.8937, lr_0 = 3.2253e-04
Loss = 2.4025e-03, PNorm = 42.9741, GNorm = 0.9680, lr_0 = 3.1209e-04
Loss = 2.2693e-03, PNorm = 42.9820, GNorm = 1.4124, lr_0 = 3.0200e-04
Validation rmse = 0.959270
Epoch 16
Loss = 2.5706e-03, PNorm = 42.9892, GNorm = 1.1983, lr_0 = 2.9222e-04
Loss = 2.1402e-03, PNorm = 42.9952, GNorm = 4.1796, lr_0 = 2.8277e-04
Validation rmse = 1.011715
Epoch 17
Loss = 2.5080e-03, PNorm = 43.0010, GNorm = 0.7411, lr_0 = 2.7272e-04
Loss = 2.5152e-03, PNorm = 43.0082, GNorm = 1.2881, lr_0 = 2.6389e-04
Loss = 2.1134e-03, PNorm = 43.0136, GNorm = 1.6950, lr_0 = 2.5535e-04
Validation rmse = 0.941762
Epoch 18
Loss = 2.2211e-03, PNorm = 43.0185, GNorm = 0.9160, lr_0 = 2.4709e-04
Loss = 2.2156e-03, PNorm = 43.0239, GNorm = 1.5811, lr_0 = 2.3910e-04
Loss = 2.2267e-03, PNorm = 43.0285, GNorm = 1.6089, lr_0 = 2.3136e-04
Validation rmse = 0.924777
Epoch 19
Loss = 2.1833e-03, PNorm = 43.0341, GNorm = 1.5028, lr_0 = 2.2387e-04
Loss = 2.4838e-03, PNorm = 43.0383, GNorm = 1.8049, lr_0 = 2.1663e-04
Validation rmse = 0.974285
Epoch 20
Loss = 2.2727e-03, PNorm = 43.0431, GNorm = 4.5380, lr_0 = 2.0962e-04
Loss = 2.2586e-03, PNorm = 43.0486, GNorm = 2.0753, lr_0 = 2.0283e-04
Loss = 2.3147e-03, PNorm = 43.0535, GNorm = 1.9428, lr_0 = 1.9627e-04
Validation rmse = 0.934836
Epoch 21
Loss = 2.3151e-03, PNorm = 43.0565, GNorm = 1.0121, lr_0 = 1.8992e-04
Loss = 1.9865e-03, PNorm = 43.0593, GNorm = 1.5900, lr_0 = 1.8377e-04
Validation rmse = 0.946629
Epoch 22
Loss = 2.9589e-03, PNorm = 43.0633, GNorm = 1.0078, lr_0 = 1.7783e-04
Loss = 1.7438e-03, PNorm = 43.0665, GNorm = 1.7195, lr_0 = 1.7207e-04
Loss = 2.3794e-03, PNorm = 43.0695, GNorm = 2.1976, lr_0 = 1.6651e-04
Validation rmse = 0.960880
Epoch 23
Loss = 2.0905e-03, PNorm = 43.0743, GNorm = 1.4545, lr_0 = 1.6059e-04
Loss = 2.1513e-03, PNorm = 43.0774, GNorm = 0.8663, lr_0 = 1.5539e-04
Validation rmse = 0.947252
Epoch 24
Loss = 2.0654e-03, PNorm = 43.0803, GNorm = 1.2381, lr_0 = 1.5036e-04
Loss = 2.0816e-03, PNorm = 43.0841, GNorm = 0.6490, lr_0 = 1.4550e-04
Loss = 2.0922e-03, PNorm = 43.0878, GNorm = 1.7650, lr_0 = 1.4079e-04
Validation rmse = 0.956285
Epoch 25
Loss = 1.9382e-03, PNorm = 43.0901, GNorm = 1.8214, lr_0 = 1.3623e-04
Loss = 2.2483e-03, PNorm = 43.0939, GNorm = 0.7762, lr_0 = 1.3183e-04
Loss = 1.8943e-03, PNorm = 43.0959, GNorm = 1.0625, lr_0 = 1.2756e-04
Validation rmse = 0.934722
Epoch 26
Loss = 1.9647e-03, PNorm = 43.0987, GNorm = 1.8642, lr_0 = 1.2343e-04
Loss = 2.0004e-03, PNorm = 43.1022, GNorm = 2.3330, lr_0 = 1.1944e-04
Validation rmse = 0.942410
Epoch 27
Loss = 2.2869e-03, PNorm = 43.1046, GNorm = 3.6317, lr_0 = 1.1557e-04
Loss = 1.7372e-03, PNorm = 43.1071, GNorm = 1.1532, lr_0 = 1.1183e-04
Loss = 2.1050e-03, PNorm = 43.1091, GNorm = 2.8748, lr_0 = 1.0821e-04
Validation rmse = 0.940682
Epoch 28
Loss = 2.0664e-03, PNorm = 43.1114, GNorm = 1.2415, lr_0 = 1.0437e-04
Loss = 1.8253e-03, PNorm = 43.1140, GNorm = 0.7007, lr_0 = 1.0099e-04
Validation rmse = 0.922163
Epoch 29
Loss = 1.3803e-03, PNorm = 43.1156, GNorm = 1.2116, lr_0 = 1.0000e-04
Loss = 2.0257e-03, PNorm = 43.1174, GNorm = 1.2089, lr_0 = 1.0000e-04
Loss = 1.9467e-03, PNorm = 43.1199, GNorm = 2.8948, lr_0 = 1.0000e-04
Validation rmse = 0.907513
Model 0 best validation rmse = 0.907513 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.672589
Ensemble test rmse = 0.672589
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 891,501
Moving model to cuda
Epoch 0
Loss = 1.8671e-02, PNorm = 42.2755, GNorm = 3.5532, lr_0 = 2.9800e-04
Loss = 1.5629e-02, PNorm = 42.2892, GNorm = 12.2114, lr_0 = 4.7800e-04
Validation rmse = 2.022318
Epoch 1
Loss = 1.4111e-02, PNorm = 42.3179, GNorm = 7.3017, lr_0 = 6.7600e-04
Loss = 1.2337e-02, PNorm = 42.3552, GNorm = 6.4587, lr_0 = 8.5600e-04
Loss = 8.4801e-03, PNorm = 42.3986, GNorm = 1.5142, lr_0 = 9.9344e-04
Validation rmse = 1.755530
Epoch 2
Loss = 7.0466e-03, PNorm = 42.4458, GNorm = 1.8904, lr_0 = 9.6130e-04
Loss = 7.5333e-03, PNorm = 42.4721, GNorm = 4.3989, lr_0 = 9.3019e-04
Validation rmse = 1.399337
Epoch 3
Loss = 6.1455e-03, PNorm = 42.5129, GNorm = 3.1450, lr_0 = 9.0009e-04
Loss = 5.8112e-03, PNorm = 42.5406, GNorm = 4.2604, lr_0 = 8.7096e-04
Loss = 4.9601e-03, PNorm = 42.5682, GNorm = 4.3635, lr_0 = 8.4278e-04
Validation rmse = 1.265416
Epoch 4
Loss = 5.2337e-03, PNorm = 42.5955, GNorm = 4.7687, lr_0 = 8.1551e-04
Loss = 6.7091e-03, PNorm = 42.6220, GNorm = 4.2830, lr_0 = 7.8912e-04
Validation rmse = 1.315648
Epoch 5
Loss = 4.0861e-03, PNorm = 42.6521, GNorm = 2.3165, lr_0 = 7.6358e-04
Loss = 5.4186e-03, PNorm = 42.6746, GNorm = 2.6376, lr_0 = 7.3888e-04
Loss = 4.7641e-03, PNorm = 42.7001, GNorm = 1.3171, lr_0 = 7.1497e-04
Validation rmse = 1.128769
Epoch 6
Loss = 3.4196e-03, PNorm = 42.7223, GNorm = 1.2896, lr_0 = 6.8956e-04
Loss = 3.7084e-03, PNorm = 42.7410, GNorm = 3.0700, lr_0 = 6.6725e-04
Loss = 4.8696e-03, PNorm = 42.7550, GNorm = 0.8999, lr_0 = 6.4565e-04
Validation rmse = 1.272667
Epoch 7
Loss = 4.5613e-03, PNorm = 42.7748, GNorm = 4.1753, lr_0 = 6.2476e-04
Loss = 3.6807e-03, PNorm = 42.7926, GNorm = 4.1107, lr_0 = 6.0454e-04
Validation rmse = 1.140962
Epoch 8
Loss = 3.2901e-03, PNorm = 42.8098, GNorm = 1.5042, lr_0 = 5.8498e-04
Loss = 3.1111e-03, PNorm = 42.8251, GNorm = 1.5245, lr_0 = 5.6605e-04
Loss = 3.2767e-03, PNorm = 42.8374, GNorm = 0.8749, lr_0 = 5.4774e-04
Validation rmse = 1.051605
Epoch 9
Loss = 3.4433e-03, PNorm = 42.8503, GNorm = 4.1688, lr_0 = 5.3001e-04
Loss = 3.1473e-03, PNorm = 42.8645, GNorm = 1.6468, lr_0 = 5.1286e-04
Validation rmse = 1.051154
Epoch 10
Loss = 3.4547e-03, PNorm = 42.8774, GNorm = 2.4823, lr_0 = 4.9627e-04
Loss = 3.5710e-03, PNorm = 42.8907, GNorm = 1.5059, lr_0 = 4.8021e-04
Loss = 2.6319e-03, PNorm = 42.9044, GNorm = 2.7989, lr_0 = 4.6467e-04
Validation rmse = 1.016431
Epoch 11
Loss = 3.4199e-03, PNorm = 42.9156, GNorm = 1.5717, lr_0 = 4.4963e-04
Loss = 3.0333e-03, PNorm = 42.9239, GNorm = 3.3107, lr_0 = 4.3508e-04
Validation rmse = 1.018183
Epoch 12
Loss = 2.4472e-03, PNorm = 42.9372, GNorm = 1.0294, lr_0 = 4.1962e-04
Loss = 2.6657e-03, PNorm = 42.9491, GNorm = 3.3015, lr_0 = 4.0604e-04
Loss = 2.9645e-03, PNorm = 42.9594, GNorm = 2.6244, lr_0 = 3.9290e-04
Validation rmse = 1.004639
Epoch 13
Loss = 2.5380e-03, PNorm = 42.9725, GNorm = 2.4276, lr_0 = 3.8019e-04
Loss = 2.6738e-03, PNorm = 42.9819, GNorm = 2.9587, lr_0 = 3.6789e-04
Loss = 2.6306e-03, PNorm = 42.9888, GNorm = 2.5628, lr_0 = 3.5598e-04
Validation rmse = 0.989952
Epoch 14
Loss = 2.7530e-03, PNorm = 42.9965, GNorm = 1.1380, lr_0 = 3.4446e-04
Loss = 2.2028e-03, PNorm = 43.0035, GNorm = 2.8929, lr_0 = 3.3332e-04
Validation rmse = 1.011303
Epoch 15
Loss = 1.7959e-03, PNorm = 43.0114, GNorm = 0.9368, lr_0 = 3.2253e-04
Loss = 2.6058e-03, PNorm = 43.0198, GNorm = 1.1053, lr_0 = 3.1209e-04
Loss = 2.6999e-03, PNorm = 43.0268, GNorm = 3.6690, lr_0 = 3.0200e-04
Validation rmse = 1.045737
Epoch 16
Loss = 2.2469e-03, PNorm = 43.0332, GNorm = 2.0674, lr_0 = 2.9222e-04
Loss = 2.2679e-03, PNorm = 43.0393, GNorm = 1.1112, lr_0 = 2.8277e-04
Validation rmse = 0.969829
Epoch 17
Loss = 2.2094e-03, PNorm = 43.0468, GNorm = 0.8087, lr_0 = 2.7272e-04
Loss = 2.1328e-03, PNorm = 43.0538, GNorm = 1.6256, lr_0 = 2.6389e-04
Loss = 2.2130e-03, PNorm = 43.0585, GNorm = 3.8419, lr_0 = 2.5535e-04
Validation rmse = 0.975342
Epoch 18
Loss = 2.4911e-03, PNorm = 43.0643, GNorm = 0.8079, lr_0 = 2.4709e-04
Loss = 1.8387e-03, PNorm = 43.0699, GNorm = 1.5190, lr_0 = 2.3910e-04
Loss = 2.1903e-03, PNorm = 43.0757, GNorm = 0.9995, lr_0 = 2.3136e-04
Validation rmse = 1.029519
Epoch 19
Loss = 2.3137e-03, PNorm = 43.0792, GNorm = 0.8647, lr_0 = 2.2387e-04
Loss = 2.1462e-03, PNorm = 43.0837, GNorm = 1.4554, lr_0 = 2.1663e-04
Validation rmse = 0.968326
Epoch 20
Loss = 1.8214e-03, PNorm = 43.0895, GNorm = 0.7017, lr_0 = 2.0962e-04
Loss = 2.2195e-03, PNorm = 43.0949, GNorm = 1.4104, lr_0 = 2.0283e-04
Loss = 1.9847e-03, PNorm = 43.0987, GNorm = 1.1623, lr_0 = 1.9627e-04
Validation rmse = 0.969743
Epoch 21
Loss = 1.7847e-03, PNorm = 43.1025, GNorm = 2.2263, lr_0 = 1.8992e-04
Loss = 1.9793e-03, PNorm = 43.1050, GNorm = 1.5077, lr_0 = 1.8377e-04
Validation rmse = 0.959669
Epoch 22
Loss = 1.9321e-03, PNorm = 43.1074, GNorm = 1.6456, lr_0 = 1.7783e-04
Loss = 1.9647e-03, PNorm = 43.1121, GNorm = 2.3544, lr_0 = 1.7207e-04
Loss = 2.1345e-03, PNorm = 43.1162, GNorm = 1.4066, lr_0 = 1.6651e-04
Validation rmse = 0.976045
Epoch 23
Loss = 1.8276e-03, PNorm = 43.1203, GNorm = 1.7126, lr_0 = 1.6059e-04
Loss = 2.0611e-03, PNorm = 43.1226, GNorm = 1.5206, lr_0 = 1.5539e-04
Validation rmse = 0.963824
Epoch 24
Loss = 1.2069e-03, PNorm = 43.1273, GNorm = 0.8331, lr_0 = 1.5036e-04
Loss = 1.9337e-03, PNorm = 43.1303, GNorm = 1.2616, lr_0 = 1.4550e-04
Loss = 2.1143e-03, PNorm = 43.1335, GNorm = 1.0780, lr_0 = 1.4079e-04
Validation rmse = 0.970553
Epoch 25
Loss = 2.2031e-03, PNorm = 43.1354, GNorm = 0.9375, lr_0 = 1.3623e-04
Loss = 1.4881e-03, PNorm = 43.1376, GNorm = 0.5979, lr_0 = 1.3183e-04
Loss = 1.9704e-03, PNorm = 43.1401, GNorm = 1.4277, lr_0 = 1.2756e-04
Validation rmse = 0.971203
Epoch 26
Loss = 1.7393e-03, PNorm = 43.1428, GNorm = 0.7865, lr_0 = 1.2343e-04
Loss = 1.7732e-03, PNorm = 43.1450, GNorm = 1.7455, lr_0 = 1.1944e-04
Validation rmse = 0.968937
Epoch 27
Loss = 1.4791e-03, PNorm = 43.1473, GNorm = 2.5840, lr_0 = 1.1557e-04
Loss = 1.7972e-03, PNorm = 43.1495, GNorm = 1.4225, lr_0 = 1.1183e-04
Loss = 1.8168e-03, PNorm = 43.1511, GNorm = 0.9472, lr_0 = 1.0821e-04
Validation rmse = 0.959959
Epoch 28
Loss = 1.9162e-03, PNorm = 43.1531, GNorm = 0.9675, lr_0 = 1.0437e-04
Loss = 1.9244e-03, PNorm = 43.1547, GNorm = 3.2566, lr_0 = 1.0099e-04
Validation rmse = 0.954880
Epoch 29
Loss = 1.8156e-03, PNorm = 43.1572, GNorm = 1.5259, lr_0 = 1.0000e-04
Loss = 1.6158e-03, PNorm = 43.1590, GNorm = 1.0101, lr_0 = 1.0000e-04
Loss = 1.9795e-03, PNorm = 43.1603, GNorm = 0.8820, lr_0 = 1.0000e-04
Validation rmse = 0.947070
Model 0 best validation rmse = 0.947070 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.779354
Ensemble test rmse = 0.779354
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 891,501
Moving model to cuda
Epoch 0
Loss = 1.7901e-02, PNorm = 42.2762, GNorm = 4.8523, lr_0 = 2.9800e-04
Loss = 1.4738e-02, PNorm = 42.2909, GNorm = 11.0726, lr_0 = 4.7800e-04
Validation rmse = 1.481858
Epoch 1
Loss = 1.0596e-02, PNorm = 42.3184, GNorm = 5.5453, lr_0 = 6.7600e-04
Loss = 1.0178e-02, PNorm = 42.3557, GNorm = 8.8142, lr_0 = 8.5600e-04
Loss = 8.8127e-03, PNorm = 42.4019, GNorm = 10.3072, lr_0 = 9.9344e-04
Validation rmse = 1.358061
Epoch 2
Loss = 8.0835e-03, PNorm = 42.4447, GNorm = 1.8819, lr_0 = 9.6130e-04
Loss = 7.2845e-03, PNorm = 42.4835, GNorm = 8.7155, lr_0 = 9.3019e-04
Validation rmse = 1.417096
Epoch 3
Loss = 6.1403e-03, PNorm = 42.5155, GNorm = 4.6300, lr_0 = 9.0009e-04
Loss = 5.8997e-03, PNorm = 42.5459, GNorm = 4.6193, lr_0 = 8.7096e-04
Loss = 6.3194e-03, PNorm = 42.5741, GNorm = 8.1188, lr_0 = 8.4278e-04
Validation rmse = 1.060290
Epoch 4
Loss = 5.7895e-03, PNorm = 42.6024, GNorm = 1.9402, lr_0 = 8.1551e-04
Loss = 5.6070e-03, PNorm = 42.6320, GNorm = 1.9448, lr_0 = 7.8912e-04
Validation rmse = 1.176916
Epoch 5
Loss = 5.1663e-03, PNorm = 42.6549, GNorm = 3.6883, lr_0 = 7.6358e-04
Loss = 4.5841e-03, PNorm = 42.6818, GNorm = 0.8390, lr_0 = 7.3888e-04
Loss = 4.1241e-03, PNorm = 42.7026, GNorm = 2.5011, lr_0 = 7.1497e-04
Validation rmse = 0.902191
Epoch 6
Loss = 5.4768e-03, PNorm = 42.7210, GNorm = 7.0398, lr_0 = 6.8956e-04
Loss = 4.1246e-03, PNorm = 42.7387, GNorm = 2.1665, lr_0 = 6.6725e-04
Loss = 4.1461e-03, PNorm = 42.7572, GNorm = 3.2425, lr_0 = 6.4565e-04
Validation rmse = 0.827877
Epoch 7
Loss = 3.6513e-03, PNorm = 42.7733, GNorm = 3.2233, lr_0 = 6.2476e-04
Loss = 3.6487e-03, PNorm = 42.7886, GNorm = 1.4838, lr_0 = 6.0454e-04
Validation rmse = 0.839824
Epoch 8
Loss = 2.6318e-03, PNorm = 42.8059, GNorm = 4.7934, lr_0 = 5.8498e-04
Loss = 3.9335e-03, PNorm = 42.8233, GNorm = 2.8926, lr_0 = 5.6605e-04
Loss = 3.2853e-03, PNorm = 42.8389, GNorm = 1.3565, lr_0 = 5.4774e-04
Validation rmse = 0.869838
Epoch 9
Loss = 2.9837e-03, PNorm = 42.8499, GNorm = 1.5188, lr_0 = 5.3001e-04
Loss = 3.5896e-03, PNorm = 42.8650, GNorm = 1.9340, lr_0 = 5.1286e-04
Validation rmse = 0.909642
Epoch 10
Loss = 2.7424e-03, PNorm = 42.8782, GNorm = 1.3709, lr_0 = 4.9627e-04
Loss = 2.7586e-03, PNorm = 42.8913, GNorm = 1.9869, lr_0 = 4.8021e-04
Loss = 2.9904e-03, PNorm = 42.9004, GNorm = 2.9736, lr_0 = 4.6467e-04
Validation rmse = 0.904738
Epoch 11
Loss = 3.3805e-03, PNorm = 42.9123, GNorm = 3.8411, lr_0 = 4.4963e-04
Loss = 2.4450e-03, PNorm = 42.9252, GNorm = 0.9893, lr_0 = 4.3508e-04
Validation rmse = 0.803591
Epoch 12
Loss = 2.2708e-03, PNorm = 42.9357, GNorm = 1.3828, lr_0 = 4.1962e-04
Loss = 2.6488e-03, PNorm = 42.9461, GNorm = 1.1225, lr_0 = 4.0604e-04
Loss = 2.8626e-03, PNorm = 42.9539, GNorm = 1.2760, lr_0 = 3.9290e-04
Validation rmse = 0.881593
Epoch 13
Loss = 2.5973e-03, PNorm = 42.9625, GNorm = 1.5535, lr_0 = 3.8019e-04
Loss = 2.8284e-03, PNorm = 42.9689, GNorm = 4.0827, lr_0 = 3.6789e-04
Loss = 2.8670e-03, PNorm = 42.9783, GNorm = 3.2819, lr_0 = 3.5598e-04
Validation rmse = 0.833249
Epoch 14
Loss = 2.3893e-03, PNorm = 42.9876, GNorm = 1.3829, lr_0 = 3.4446e-04
Loss = 2.5537e-03, PNorm = 42.9969, GNorm = 2.8507, lr_0 = 3.3332e-04
Validation rmse = 0.810425
Epoch 15
Loss = 1.7878e-03, PNorm = 43.0050, GNorm = 2.4050, lr_0 = 3.2253e-04
Loss = 2.7833e-03, PNorm = 43.0149, GNorm = 3.2225, lr_0 = 3.1209e-04
Loss = 2.2921e-03, PNorm = 43.0224, GNorm = 1.1251, lr_0 = 3.0200e-04
Validation rmse = 0.791891
Epoch 16
Loss = 2.2952e-03, PNorm = 43.0302, GNorm = 2.2522, lr_0 = 2.9222e-04
Loss = 2.6047e-03, PNorm = 43.0369, GNorm = 3.9511, lr_0 = 2.8277e-04
Validation rmse = 0.780619
Epoch 17
Loss = 1.7218e-03, PNorm = 43.0425, GNorm = 1.5505, lr_0 = 2.7272e-04
Loss = 2.1371e-03, PNorm = 43.0477, GNorm = 1.8596, lr_0 = 2.6389e-04
Loss = 2.5249e-03, PNorm = 43.0558, GNorm = 2.0105, lr_0 = 2.5535e-04
Validation rmse = 0.825569
Epoch 18
Loss = 1.9199e-03, PNorm = 43.0616, GNorm = 0.8994, lr_0 = 2.4709e-04
Loss = 2.2789e-03, PNorm = 43.0685, GNorm = 2.0626, lr_0 = 2.3910e-04
Loss = 2.2492e-03, PNorm = 43.0717, GNorm = 2.4512, lr_0 = 2.3136e-04
Validation rmse = 0.774272
Epoch 19
Loss = 2.1281e-03, PNorm = 43.0764, GNorm = 2.0191, lr_0 = 2.2387e-04
Loss = 2.2650e-03, PNorm = 43.0816, GNorm = 1.8678, lr_0 = 2.1663e-04
Validation rmse = 0.750117
Epoch 20
Loss = 2.8305e-03, PNorm = 43.0862, GNorm = 2.3838, lr_0 = 2.0962e-04
Loss = 2.1901e-03, PNorm = 43.0907, GNorm = 1.0714, lr_0 = 2.0283e-04
Loss = 1.9795e-03, PNorm = 43.0950, GNorm = 2.0131, lr_0 = 1.9627e-04
Validation rmse = 0.748224
Epoch 21
Loss = 2.0902e-03, PNorm = 43.0997, GNorm = 1.1675, lr_0 = 1.8992e-04
Loss = 2.0039e-03, PNorm = 43.1040, GNorm = 2.3015, lr_0 = 1.8377e-04
Validation rmse = 0.771364
Epoch 22
Loss = 2.2236e-03, PNorm = 43.1084, GNorm = 1.5284, lr_0 = 1.7783e-04
Loss = 1.8916e-03, PNorm = 43.1125, GNorm = 1.3283, lr_0 = 1.7207e-04
Loss = 2.0544e-03, PNorm = 43.1166, GNorm = 1.9294, lr_0 = 1.6651e-04
Validation rmse = 0.767213
Epoch 23
Loss = 1.6903e-03, PNorm = 43.1206, GNorm = 1.3059, lr_0 = 1.6059e-04
Loss = 1.8258e-03, PNorm = 43.1237, GNorm = 1.3997, lr_0 = 1.5539e-04
Validation rmse = 0.864843
Epoch 24
Loss = 1.4797e-03, PNorm = 43.1265, GNorm = 1.4820, lr_0 = 1.5036e-04
Loss = 1.8404e-03, PNorm = 43.1290, GNorm = 1.5024, lr_0 = 1.4550e-04
Loss = 2.0224e-03, PNorm = 43.1318, GNorm = 0.7068, lr_0 = 1.4079e-04
Validation rmse = 0.759435
Epoch 25
Loss = 1.4961e-03, PNorm = 43.1354, GNorm = 1.0135, lr_0 = 1.3623e-04
Loss = 1.9769e-03, PNorm = 43.1382, GNorm = 1.1770, lr_0 = 1.3183e-04
Loss = 2.0025e-03, PNorm = 43.1412, GNorm = 2.1366, lr_0 = 1.2756e-04
Validation rmse = 0.773388
Epoch 26
Loss = 1.7647e-03, PNorm = 43.1433, GNorm = 0.6751, lr_0 = 1.2343e-04
Loss = 1.8950e-03, PNorm = 43.1457, GNorm = 1.6187, lr_0 = 1.1944e-04
Validation rmse = 0.793127
Epoch 27
Loss = 1.7825e-03, PNorm = 43.1468, GNorm = 1.0515, lr_0 = 1.1557e-04
Loss = 1.9028e-03, PNorm = 43.1495, GNorm = 0.6687, lr_0 = 1.1183e-04
Loss = 1.9918e-03, PNorm = 43.1519, GNorm = 1.3091, lr_0 = 1.0821e-04
Validation rmse = 0.766369
Epoch 28
Loss = 1.8097e-03, PNorm = 43.1536, GNorm = 1.1781, lr_0 = 1.0437e-04
Loss = 1.7325e-03, PNorm = 43.1559, GNorm = 1.6762, lr_0 = 1.0099e-04
Validation rmse = 0.766677
Epoch 29
Loss = 1.4583e-03, PNorm = 43.1585, GNorm = 1.1839, lr_0 = 1.0000e-04
Loss = 1.8996e-03, PNorm = 43.1593, GNorm = 1.3330, lr_0 = 1.0000e-04
Loss = 1.8352e-03, PNorm = 43.1605, GNorm = 1.1957, lr_0 = 1.0000e-04
Validation rmse = 0.808890
Model 0 best validation rmse = 0.748224 on epoch 20
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.685467
Ensemble test rmse = 0.685467
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 891,501
Moving model to cuda
Epoch 0
Loss = 2.0066e-02, PNorm = 42.2749, GNorm = 4.9331, lr_0 = 2.9800e-04
Loss = 1.5555e-02, PNorm = 42.2876, GNorm = 3.4950, lr_0 = 4.7800e-04
Validation rmse = 1.977067
Epoch 1
Loss = 1.2694e-02, PNorm = 42.3159, GNorm = 2.4834, lr_0 = 6.7600e-04
Loss = 1.0623e-02, PNorm = 42.3535, GNorm = 3.1493, lr_0 = 8.5600e-04
Loss = 8.1160e-03, PNorm = 42.3962, GNorm = 1.7651, lr_0 = 9.9344e-04
Validation rmse = 1.534213
Epoch 2
Loss = 7.2736e-03, PNorm = 42.4376, GNorm = 3.3825, lr_0 = 9.6130e-04
Loss = 6.4001e-03, PNorm = 42.4734, GNorm = 3.0473, lr_0 = 9.3019e-04
Validation rmse = 1.700947
Epoch 3
Loss = 7.5633e-03, PNorm = 42.5075, GNorm = 1.1991, lr_0 = 9.0009e-04
Loss = 6.7885e-03, PNorm = 42.5386, GNorm = 3.6479, lr_0 = 8.7096e-04
Loss = 5.5293e-03, PNorm = 42.5684, GNorm = 2.0775, lr_0 = 8.4278e-04
Validation rmse = 1.228393
Epoch 4
Loss = 5.6153e-03, PNorm = 42.5958, GNorm = 1.1701, lr_0 = 8.1551e-04
Loss = 5.0538e-03, PNorm = 42.6252, GNorm = 4.0643, lr_0 = 7.8912e-04
Validation rmse = 1.174127
Epoch 5
Loss = 2.6935e-03, PNorm = 42.6479, GNorm = 0.8693, lr_0 = 7.6358e-04
Loss = 4.0830e-03, PNorm = 42.6721, GNorm = 4.8458, lr_0 = 7.3888e-04
Loss = 4.6755e-03, PNorm = 42.6910, GNorm = 1.4399, lr_0 = 7.1497e-04
Validation rmse = 1.118641
Epoch 6
Loss = 3.8693e-03, PNorm = 42.7124, GNorm = 3.3736, lr_0 = 6.8956e-04
Loss = 3.7162e-03, PNorm = 42.7345, GNorm = 1.3981, lr_0 = 6.6725e-04
Loss = 3.5130e-03, PNorm = 42.7509, GNorm = 2.4714, lr_0 = 6.4565e-04
Validation rmse = 1.045298
Epoch 7
Loss = 3.3842e-03, PNorm = 42.7678, GNorm = 1.1893, lr_0 = 6.2476e-04
Loss = 3.2712e-03, PNorm = 42.7833, GNorm = 2.4882, lr_0 = 6.0454e-04
Validation rmse = 1.022064
Epoch 8
Loss = 3.6763e-03, PNorm = 42.8000, GNorm = 1.7227, lr_0 = 5.8498e-04
Loss = 3.1813e-03, PNorm = 42.8160, GNorm = 1.5149, lr_0 = 5.6605e-04
Loss = 2.9216e-03, PNorm = 42.8301, GNorm = 2.6296, lr_0 = 5.4774e-04
Validation rmse = 1.014806
Epoch 9
Loss = 2.9204e-03, PNorm = 42.8430, GNorm = 4.0787, lr_0 = 5.3001e-04
Loss = 3.0101e-03, PNorm = 42.8571, GNorm = 3.5700, lr_0 = 5.1286e-04
Validation rmse = 1.087192
Epoch 10
Loss = 3.1981e-03, PNorm = 42.8672, GNorm = 1.7722, lr_0 = 4.9627e-04
Loss = 3.4142e-03, PNorm = 42.8793, GNorm = 3.4427, lr_0 = 4.8021e-04
Loss = 3.0212e-03, PNorm = 42.8907, GNorm = 1.0547, lr_0 = 4.6467e-04
Validation rmse = 0.986172
Epoch 11
Loss = 2.7403e-03, PNorm = 42.9029, GNorm = 1.5322, lr_0 = 4.4963e-04
Loss = 2.5215e-03, PNorm = 42.9116, GNorm = 2.2485, lr_0 = 4.3508e-04
Validation rmse = 0.963927
Epoch 12
Loss = 3.4536e-03, PNorm = 42.9228, GNorm = 2.9569, lr_0 = 4.1962e-04
Loss = 2.9812e-03, PNorm = 42.9272, GNorm = 6.7817, lr_0 = 4.0604e-04
Loss = 3.1895e-03, PNorm = 42.9384, GNorm = 1.7526, lr_0 = 3.9290e-04
Validation rmse = 1.043941
Epoch 13
Loss = 2.7954e-03, PNorm = 42.9509, GNorm = 3.1783, lr_0 = 3.8019e-04
Loss = 2.4820e-03, PNorm = 42.9579, GNorm = 0.9571, lr_0 = 3.6789e-04
Loss = 2.5209e-03, PNorm = 42.9657, GNorm = 0.7334, lr_0 = 3.5598e-04
Validation rmse = 0.975971
Epoch 14
Loss = 2.3860e-03, PNorm = 42.9729, GNorm = 1.5775, lr_0 = 3.4446e-04
Loss = 2.5265e-03, PNorm = 42.9825, GNorm = 0.7679, lr_0 = 3.3332e-04
Validation rmse = 0.975226
Epoch 15
Loss = 2.2682e-03, PNorm = 42.9900, GNorm = 1.3969, lr_0 = 3.2253e-04
Loss = 2.2597e-03, PNorm = 42.9964, GNorm = 0.7954, lr_0 = 3.1209e-04
Loss = 2.3455e-03, PNorm = 43.0018, GNorm = 1.2153, lr_0 = 3.0200e-04
Validation rmse = 0.991335
Epoch 16
Loss = 2.0925e-03, PNorm = 43.0086, GNorm = 1.3661, lr_0 = 2.9222e-04
Loss = 2.2659e-03, PNorm = 43.0148, GNorm = 1.2723, lr_0 = 2.8277e-04
Validation rmse = 1.002324
Epoch 17
Loss = 2.0994e-03, PNorm = 43.0205, GNorm = 3.7993, lr_0 = 2.7272e-04
Loss = 2.7412e-03, PNorm = 43.0275, GNorm = 0.9759, lr_0 = 2.6389e-04
Loss = 2.3010e-03, PNorm = 43.0326, GNorm = 4.3916, lr_0 = 2.5535e-04
Validation rmse = 0.979213
Epoch 18
Loss = 2.4716e-03, PNorm = 43.0373, GNorm = 1.4669, lr_0 = 2.4709e-04
Loss = 2.3466e-03, PNorm = 43.0434, GNorm = 0.8729, lr_0 = 2.3910e-04
Loss = 2.3390e-03, PNorm = 43.0492, GNorm = 0.8697, lr_0 = 2.3136e-04
Validation rmse = 0.979494
Epoch 19
Loss = 2.1349e-03, PNorm = 43.0539, GNorm = 1.6771, lr_0 = 2.2387e-04
Loss = 2.0160e-03, PNorm = 43.0570, GNorm = 1.5320, lr_0 = 2.1663e-04
Validation rmse = 0.959736
Epoch 20
Loss = 2.0137e-03, PNorm = 43.0601, GNorm = 1.3716, lr_0 = 2.0962e-04
Loss = 2.0272e-03, PNorm = 43.0628, GNorm = 1.0037, lr_0 = 2.0283e-04
Loss = 2.2357e-03, PNorm = 43.0667, GNorm = 1.6859, lr_0 = 1.9627e-04
Validation rmse = 0.967346
Epoch 21
Loss = 2.0146e-03, PNorm = 43.0698, GNorm = 0.6943, lr_0 = 1.8992e-04
Loss = 2.4101e-03, PNorm = 43.0733, GNorm = 1.1549, lr_0 = 1.8377e-04
Validation rmse = 0.963145
Epoch 22
Loss = 2.1022e-03, PNorm = 43.0763, GNorm = 2.4789, lr_0 = 1.7783e-04
Loss = 1.9304e-03, PNorm = 43.0802, GNorm = 1.1931, lr_0 = 1.7207e-04
Loss = 2.2346e-03, PNorm = 43.0826, GNorm = 2.1584, lr_0 = 1.6651e-04
Validation rmse = 0.980215
Epoch 23
Loss = 2.2224e-03, PNorm = 43.0853, GNorm = 0.9864, lr_0 = 1.6059e-04
Loss = 1.8794e-03, PNorm = 43.0886, GNorm = 2.3000, lr_0 = 1.5539e-04
Validation rmse = 0.948180
Epoch 24
Loss = 1.9237e-03, PNorm = 43.0917, GNorm = 2.2511, lr_0 = 1.5036e-04
Loss = 2.2920e-03, PNorm = 43.0946, GNorm = 1.1228, lr_0 = 1.4550e-04
Loss = 1.8268e-03, PNorm = 43.0979, GNorm = 1.0925, lr_0 = 1.4079e-04
Validation rmse = 0.937120
Epoch 25
Loss = 1.7779e-03, PNorm = 43.1004, GNorm = 0.9528, lr_0 = 1.3623e-04
Loss = 2.0289e-03, PNorm = 43.1027, GNorm = 2.5875, lr_0 = 1.3183e-04
Loss = 2.1713e-03, PNorm = 43.1055, GNorm = 0.8766, lr_0 = 1.2756e-04
Validation rmse = 0.980194
Epoch 26
Loss = 2.2640e-03, PNorm = 43.1084, GNorm = 2.2982, lr_0 = 1.2343e-04
Loss = 1.9995e-03, PNorm = 43.1108, GNorm = 3.0158, lr_0 = 1.1944e-04
Validation rmse = 0.945784
Epoch 27
Loss = 1.9226e-03, PNorm = 43.1131, GNorm = 0.8577, lr_0 = 1.1557e-04
Loss = 1.9834e-03, PNorm = 43.1150, GNorm = 0.6614, lr_0 = 1.1183e-04
Loss = 2.0633e-03, PNorm = 43.1168, GNorm = 1.6259, lr_0 = 1.0821e-04
Validation rmse = 0.947774
Epoch 28
Loss = 2.1973e-03, PNorm = 43.1193, GNorm = 0.7431, lr_0 = 1.0437e-04
Loss = 1.7600e-03, PNorm = 43.1210, GNorm = 0.4853, lr_0 = 1.0099e-04
Validation rmse = 0.934510
Epoch 29
Loss = 1.2300e-03, PNorm = 43.1230, GNorm = 1.1224, lr_0 = 1.0000e-04
Loss = 2.0329e-03, PNorm = 43.1251, GNorm = 2.3474, lr_0 = 1.0000e-04
Loss = 1.8706e-03, PNorm = 43.1263, GNorm = 1.7952, lr_0 = 1.0000e-04
Validation rmse = 0.965834
Model 0 best validation rmse = 0.934510 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.737815
Ensemble test rmse = 0.737815
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 891,501
Moving model to cuda
Epoch 0
Loss = 1.9296e-02, PNorm = 42.2763, GNorm = 5.9396, lr_0 = 2.9800e-04
Loss = 1.7426e-02, PNorm = 42.2884, GNorm = 3.5779, lr_0 = 4.7800e-04
Validation rmse = 1.628955
Epoch 1
Loss = 9.5746e-03, PNorm = 42.3178, GNorm = 2.2941, lr_0 = 6.7600e-04
Loss = 1.0931e-02, PNorm = 42.3544, GNorm = 11.8978, lr_0 = 8.5600e-04
Loss = 1.0113e-02, PNorm = 42.3985, GNorm = 1.8895, lr_0 = 9.9344e-04
Validation rmse = 1.496056
Epoch 2
Loss = 7.8746e-03, PNorm = 42.4520, GNorm = 2.4252, lr_0 = 9.6130e-04
Loss = 5.7443e-03, PNorm = 42.4864, GNorm = 5.3723, lr_0 = 9.3019e-04
Validation rmse = 1.192125
Epoch 3
Loss = 5.2411e-03, PNorm = 42.5153, GNorm = 2.9626, lr_0 = 9.0009e-04
Loss = 5.0840e-03, PNorm = 42.5432, GNorm = 3.1474, lr_0 = 8.7096e-04
Loss = 5.0591e-03, PNorm = 42.5684, GNorm = 3.0542, lr_0 = 8.4278e-04
Validation rmse = 1.128185
Epoch 4
Loss = 5.0667e-03, PNorm = 42.5953, GNorm = 3.0441, lr_0 = 8.1551e-04
Loss = 5.4357e-03, PNorm = 42.6217, GNorm = 1.4037, lr_0 = 7.8912e-04
Validation rmse = 1.174550
Epoch 5
Loss = 3.9710e-03, PNorm = 42.6463, GNorm = 1.9298, lr_0 = 7.6358e-04
Loss = 4.5473e-03, PNorm = 42.6678, GNorm = 1.4169, lr_0 = 7.3888e-04
Loss = 4.1932e-03, PNorm = 42.6864, GNorm = 3.8035, lr_0 = 7.1497e-04
Validation rmse = 1.069818
Epoch 6
Loss = 4.0404e-03, PNorm = 42.7048, GNorm = 2.1251, lr_0 = 6.8956e-04
Loss = 4.4257e-03, PNorm = 42.7259, GNorm = 3.8799, lr_0 = 6.6725e-04
Loss = 3.9796e-03, PNorm = 42.7418, GNorm = 2.7123, lr_0 = 6.4565e-04
Validation rmse = 0.991057
Epoch 7
Loss = 3.5821e-03, PNorm = 42.7614, GNorm = 1.2652, lr_0 = 6.2476e-04
Loss = 3.4133e-03, PNorm = 42.7766, GNorm = 1.6909, lr_0 = 6.0454e-04
Validation rmse = 0.965429
Epoch 8
Loss = 3.3237e-03, PNorm = 42.7923, GNorm = 1.0321, lr_0 = 5.8498e-04
Loss = 3.4252e-03, PNorm = 42.8047, GNorm = 0.8967, lr_0 = 5.6605e-04
Loss = 3.1079e-03, PNorm = 42.8170, GNorm = 1.3325, lr_0 = 5.4774e-04
Validation rmse = 0.924182
Epoch 9
Loss = 2.5487e-03, PNorm = 42.8275, GNorm = 1.5349, lr_0 = 5.3001e-04
Loss = 2.7937e-03, PNorm = 42.8391, GNorm = 1.1005, lr_0 = 5.1286e-04
Validation rmse = 0.884934
Epoch 10
Loss = 3.3528e-03, PNorm = 42.8532, GNorm = 2.6645, lr_0 = 4.9627e-04
Loss = 2.8512e-03, PNorm = 42.8644, GNorm = 1.6250, lr_0 = 4.8021e-04
Loss = 2.8190e-03, PNorm = 42.8757, GNorm = 3.8252, lr_0 = 4.6467e-04
Validation rmse = 0.902004
Epoch 11
Loss = 2.6467e-03, PNorm = 42.8880, GNorm = 1.5757, lr_0 = 4.4963e-04
Loss = 2.6559e-03, PNorm = 42.8994, GNorm = 0.7091, lr_0 = 4.3508e-04
Validation rmse = 0.917059
Epoch 12
Loss = 2.6981e-03, PNorm = 42.9084, GNorm = 2.5632, lr_0 = 4.1962e-04
Loss = 2.7173e-03, PNorm = 42.9196, GNorm = 1.0672, lr_0 = 4.0604e-04
Loss = 2.5101e-03, PNorm = 42.9326, GNorm = 2.9392, lr_0 = 3.9290e-04
Validation rmse = 0.880084
Epoch 13
Loss = 2.5126e-03, PNorm = 42.9376, GNorm = 0.9351, lr_0 = 3.8019e-04
Loss = 2.3566e-03, PNorm = 42.9480, GNorm = 1.7084, lr_0 = 3.6789e-04
Loss = 2.8074e-03, PNorm = 42.9554, GNorm = 1.6117, lr_0 = 3.5598e-04
Validation rmse = 0.882839
Epoch 14
Loss = 2.5656e-03, PNorm = 42.9634, GNorm = 0.8560, lr_0 = 3.4446e-04
Loss = 2.2605e-03, PNorm = 42.9713, GNorm = 1.5958, lr_0 = 3.3332e-04
Validation rmse = 0.853369
Epoch 15
Loss = 2.6299e-03, PNorm = 42.9791, GNorm = 2.9825, lr_0 = 3.2253e-04
Loss = 2.5440e-03, PNorm = 42.9849, GNorm = 1.3069, lr_0 = 3.1209e-04
Loss = 2.4759e-03, PNorm = 42.9917, GNorm = 1.8002, lr_0 = 3.0200e-04
Validation rmse = 0.861494
Epoch 16
Loss = 2.1903e-03, PNorm = 42.9986, GNorm = 0.9406, lr_0 = 2.9222e-04
Loss = 2.0348e-03, PNorm = 43.0033, GNorm = 1.2747, lr_0 = 2.8277e-04
Validation rmse = 0.867089
Epoch 17
Loss = 2.2366e-03, PNorm = 43.0105, GNorm = 1.1370, lr_0 = 2.7272e-04
Loss = 2.2026e-03, PNorm = 43.0169, GNorm = 0.9561, lr_0 = 2.6389e-04
Loss = 2.1682e-03, PNorm = 43.0203, GNorm = 1.0900, lr_0 = 2.5535e-04
Validation rmse = 0.839969
Epoch 18
Loss = 2.3068e-03, PNorm = 43.0249, GNorm = 0.9033, lr_0 = 2.4709e-04
Loss = 2.5515e-03, PNorm = 43.0291, GNorm = 2.2293, lr_0 = 2.3910e-04
Loss = 1.9272e-03, PNorm = 43.0361, GNorm = 1.6182, lr_0 = 2.3136e-04
Validation rmse = 0.823776
Epoch 19
Loss = 2.1288e-03, PNorm = 43.0401, GNorm = 0.5539, lr_0 = 2.2387e-04
Loss = 2.1492e-03, PNorm = 43.0440, GNorm = 2.2426, lr_0 = 2.1663e-04
Validation rmse = 0.864825
Epoch 20
Loss = 1.8237e-03, PNorm = 43.0501, GNorm = 0.8150, lr_0 = 2.0962e-04
Loss = 2.1146e-03, PNorm = 43.0554, GNorm = 1.8397, lr_0 = 2.0283e-04
Loss = 2.1639e-03, PNorm = 43.0592, GNorm = 0.8241, lr_0 = 1.9627e-04
Validation rmse = 0.877354
Epoch 21
Loss = 2.0430e-03, PNorm = 43.0614, GNorm = 2.3450, lr_0 = 1.8992e-04
Loss = 2.3089e-03, PNorm = 43.0664, GNorm = 3.1241, lr_0 = 1.8377e-04
Validation rmse = 0.840903
Epoch 22
Loss = 1.9224e-03, PNorm = 43.0709, GNorm = 1.5311, lr_0 = 1.7783e-04
Loss = 1.9331e-03, PNorm = 43.0757, GNorm = 1.2389, lr_0 = 1.7207e-04
Loss = 1.9066e-03, PNorm = 43.0787, GNorm = 1.2813, lr_0 = 1.6651e-04
Validation rmse = 0.827287
Epoch 23
Loss = 1.9462e-03, PNorm = 43.0824, GNorm = 0.6894, lr_0 = 1.6059e-04
Loss = 2.0916e-03, PNorm = 43.0857, GNorm = 1.9671, lr_0 = 1.5539e-04
Validation rmse = 0.807472
Epoch 24
Loss = 1.6164e-03, PNorm = 43.0899, GNorm = 1.4664, lr_0 = 1.5036e-04
Loss = 1.9844e-03, PNorm = 43.0934, GNorm = 1.3911, lr_0 = 1.4550e-04
Loss = 1.8638e-03, PNorm = 43.0964, GNorm = 1.2925, lr_0 = 1.4079e-04
Validation rmse = 0.808834
Epoch 25
Loss = 2.1001e-03, PNorm = 43.0992, GNorm = 1.6042, lr_0 = 1.3623e-04
Loss = 1.8955e-03, PNorm = 43.1016, GNorm = 1.6657, lr_0 = 1.3183e-04
Loss = 2.0199e-03, PNorm = 43.1039, GNorm = 1.4230, lr_0 = 1.2756e-04
Validation rmse = 0.805372
Epoch 26
Loss = 1.7658e-03, PNorm = 43.1067, GNorm = 1.3893, lr_0 = 1.2343e-04
Loss = 1.7799e-03, PNorm = 43.1092, GNorm = 1.3700, lr_0 = 1.1944e-04
Validation rmse = 0.835985
Epoch 27
Loss = 1.9537e-03, PNorm = 43.1111, GNorm = 1.9426, lr_0 = 1.1557e-04
Loss = 1.8854e-03, PNorm = 43.1144, GNorm = 1.5857, lr_0 = 1.1183e-04
Loss = 1.8937e-03, PNorm = 43.1170, GNorm = 0.7509, lr_0 = 1.0821e-04
Validation rmse = 0.804079
Epoch 28
Loss = 2.1207e-03, PNorm = 43.1191, GNorm = 1.9064, lr_0 = 1.0437e-04
Loss = 1.9806e-03, PNorm = 43.1217, GNorm = 1.8104, lr_0 = 1.0099e-04
Validation rmse = 0.805738
Epoch 29
Loss = 1.6188e-03, PNorm = 43.1239, GNorm = 2.1090, lr_0 = 1.0000e-04
Loss = 2.0254e-03, PNorm = 43.1254, GNorm = 2.0341, lr_0 = 1.0000e-04
Loss = 1.9922e-03, PNorm = 43.1275, GNorm = 2.0211, lr_0 = 1.0000e-04
Validation rmse = 0.801048
Model 0 best validation rmse = 0.801048 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.762522
Ensemble test rmse = 0.762522
10-fold cross validation
	Seed 0 ==> test rmse = 0.822238
	Seed 1 ==> test rmse = 0.711647
	Seed 2 ==> test rmse = 0.711353
	Seed 3 ==> test rmse = 0.873153
	Seed 4 ==> test rmse = 1.084035
	Seed 5 ==> test rmse = 0.672589
	Seed 6 ==> test rmse = 0.779354
	Seed 7 ==> test rmse = 0.685467
	Seed 8 ==> test rmse = 0.737815
	Seed 9 ==> test rmse = 0.762522
Overall test rmse = 0.784017 +/- 0.116052
Elapsed time = 0:07:51
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2400, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,721,601
Moving model to cuda
Epoch 0
Loss = 1.6832e-02, PNorm = 99.7630, GNorm = 6.2472, lr_0 = 2.9800e-04
Loss = 1.3537e-02, PNorm = 99.8589, GNorm = 3.9231, lr_0 = 4.7800e-04
Validation rmse = 1.306054
Epoch 1
Loss = 7.6593e-03, PNorm = 100.0398, GNorm = 3.4404, lr_0 = 6.7600e-04
Loss = 9.6692e-03, PNorm = 100.2520, GNorm = 4.2460, lr_0 = 8.5600e-04
Loss = 7.4549e-03, PNorm = 100.5026, GNorm = 1.8101, lr_0 = 9.9344e-04
Validation rmse = 1.259096
Epoch 2
Loss = 7.5233e-03, PNorm = 100.7317, GNorm = 2.6017, lr_0 = 9.6130e-04
Loss = 5.6785e-03, PNorm = 100.9385, GNorm = 1.4530, lr_0 = 9.3019e-04
Validation rmse = 1.092182
Epoch 3
Loss = 4.0324e-03, PNorm = 101.0809, GNorm = 4.0168, lr_0 = 9.0009e-04
Loss = 4.1784e-03, PNorm = 101.1986, GNorm = 1.2022, lr_0 = 8.7096e-04
Loss = 4.2444e-03, PNorm = 101.2806, GNorm = 2.3646, lr_0 = 8.4278e-04
Validation rmse = 1.159323
Epoch 4
Loss = 4.6542e-03, PNorm = 101.3462, GNorm = 3.7662, lr_0 = 8.1551e-04
Loss = 4.0508e-03, PNorm = 101.4194, GNorm = 2.0245, lr_0 = 7.8912e-04
Validation rmse = 0.960002
Epoch 5
Loss = 2.7451e-03, PNorm = 101.4881, GNorm = 1.3906, lr_0 = 7.6358e-04
Loss = 2.7984e-03, PNorm = 101.5535, GNorm = 1.2673, lr_0 = 7.3888e-04
Loss = 3.2940e-03, PNorm = 101.6009, GNorm = 6.2191, lr_0 = 7.1497e-04
Validation rmse = 0.960677
Epoch 6
Loss = 2.9167e-03, PNorm = 101.6588, GNorm = 0.8678, lr_0 = 6.8956e-04
Loss = 2.7998e-03, PNorm = 101.7197, GNorm = 1.1833, lr_0 = 6.6725e-04
Loss = 2.4512e-03, PNorm = 101.7616, GNorm = 1.4675, lr_0 = 6.4565e-04
Validation rmse = 0.959373
Epoch 7
Loss = 2.5193e-03, PNorm = 101.8085, GNorm = 2.1819, lr_0 = 6.2476e-04
Loss = 3.1811e-03, PNorm = 101.8507, GNorm = 1.9886, lr_0 = 6.0454e-04
Validation rmse = 1.084199
Epoch 8
Loss = 2.4819e-03, PNorm = 101.8948, GNorm = 3.9120, lr_0 = 5.8498e-04
Loss = 3.4360e-03, PNorm = 101.9403, GNorm = 3.1145, lr_0 = 5.6605e-04
Loss = 2.9111e-03, PNorm = 101.9978, GNorm = 4.4476, lr_0 = 5.4774e-04
Validation rmse = 1.168104
Epoch 9
Loss = 2.9996e-03, PNorm = 102.0508, GNorm = 3.7545, lr_0 = 5.3001e-04
Loss = 2.4806e-03, PNorm = 102.0968, GNorm = 0.8585, lr_0 = 5.1286e-04
Validation rmse = 0.864576
Epoch 10
Loss = 2.1735e-03, PNorm = 102.1333, GNorm = 3.2097, lr_0 = 4.9627e-04
Loss = 2.5016e-03, PNorm = 102.1833, GNorm = 0.6825, lr_0 = 4.8021e-04
Loss = 2.1204e-03, PNorm = 102.2191, GNorm = 1.0555, lr_0 = 4.6467e-04
Validation rmse = 0.898407
Epoch 11
Loss = 1.8392e-03, PNorm = 102.2478, GNorm = 0.6369, lr_0 = 4.4963e-04
Loss = 1.5502e-03, PNorm = 102.2765, GNorm = 0.3825, lr_0 = 4.3508e-04
Validation rmse = 0.892048
Epoch 12
Loss = 1.5929e-03, PNorm = 102.3114, GNorm = 0.9640, lr_0 = 4.1962e-04
Loss = 1.6725e-03, PNorm = 102.3374, GNorm = 2.4443, lr_0 = 4.0604e-04
Loss = 1.7617e-03, PNorm = 102.3666, GNorm = 2.6476, lr_0 = 3.9290e-04
Validation rmse = 0.880435
Epoch 13
Loss = 1.6075e-03, PNorm = 102.3947, GNorm = 3.5788, lr_0 = 3.8019e-04
Loss = 1.6554e-03, PNorm = 102.4170, GNorm = 0.5325, lr_0 = 3.6789e-04
Loss = 1.4016e-03, PNorm = 102.4420, GNorm = 0.7719, lr_0 = 3.5598e-04
Validation rmse = 0.832177
Epoch 14
Loss = 1.4644e-03, PNorm = 102.4672, GNorm = 1.6938, lr_0 = 3.4446e-04
Loss = 1.0939e-03, PNorm = 102.4886, GNorm = 2.0315, lr_0 = 3.3332e-04
Validation rmse = 0.902590
Epoch 15
Loss = 1.3556e-03, PNorm = 102.5086, GNorm = 1.1746, lr_0 = 3.2253e-04
Loss = 1.4718e-03, PNorm = 102.5260, GNorm = 2.6288, lr_0 = 3.1209e-04
Loss = 1.4170e-03, PNorm = 102.5445, GNorm = 0.4797, lr_0 = 3.0200e-04
Validation rmse = 0.867865
Epoch 16
Loss = 1.3945e-03, PNorm = 102.5699, GNorm = 0.5619, lr_0 = 2.9222e-04
Loss = 1.3400e-03, PNorm = 102.5927, GNorm = 2.9586, lr_0 = 2.8277e-04
Validation rmse = 0.853767
Epoch 17
Loss = 1.1274e-03, PNorm = 102.6129, GNorm = 0.4566, lr_0 = 2.7272e-04
Loss = 1.1318e-03, PNorm = 102.6327, GNorm = 0.8243, lr_0 = 2.6389e-04
Loss = 1.2074e-03, PNorm = 102.6506, GNorm = 1.3463, lr_0 = 2.5535e-04
Validation rmse = 0.824734
Epoch 18
Loss = 1.1782e-03, PNorm = 102.6674, GNorm = 0.6657, lr_0 = 2.4709e-04
Loss = 9.9716e-04, PNorm = 102.6862, GNorm = 2.7618, lr_0 = 2.3910e-04
Loss = 9.6467e-04, PNorm = 102.7036, GNorm = 0.4130, lr_0 = 2.3136e-04
Validation rmse = 0.809740
Epoch 19
Loss = 9.9820e-04, PNorm = 102.7178, GNorm = 0.4239, lr_0 = 2.2387e-04
Loss = 9.6582e-04, PNorm = 102.7320, GNorm = 1.1845, lr_0 = 2.1663e-04
Validation rmse = 0.842403
Epoch 20
Loss = 8.1456e-04, PNorm = 102.7460, GNorm = 0.5820, lr_0 = 2.0962e-04
Loss = 9.7322e-04, PNorm = 102.7608, GNorm = 1.5304, lr_0 = 2.0283e-04
Loss = 9.2199e-04, PNorm = 102.7776, GNorm = 0.3540, lr_0 = 1.9627e-04
Validation rmse = 0.812194
Epoch 21
Loss = 8.5586e-04, PNorm = 102.7913, GNorm = 1.5917, lr_0 = 1.8992e-04
Loss = 8.3168e-04, PNorm = 102.8025, GNorm = 1.5369, lr_0 = 1.8377e-04
Validation rmse = 0.786488
Epoch 22
Loss = 7.9683e-04, PNorm = 102.8184, GNorm = 0.3612, lr_0 = 1.7783e-04
Loss = 7.7309e-04, PNorm = 102.8344, GNorm = 0.5772, lr_0 = 1.7207e-04
Loss = 8.5935e-04, PNorm = 102.8456, GNorm = 1.0327, lr_0 = 1.6651e-04
Validation rmse = 0.830247
Epoch 23
Loss = 7.6901e-04, PNorm = 102.8559, GNorm = 0.7334, lr_0 = 1.6059e-04
Loss = 8.6016e-04, PNorm = 102.8696, GNorm = 0.9287, lr_0 = 1.5539e-04
Validation rmse = 0.792804
Epoch 24
Loss = 7.3802e-04, PNorm = 102.8804, GNorm = 0.5334, lr_0 = 1.5036e-04
Loss = 6.8970e-04, PNorm = 102.8919, GNorm = 1.5293, lr_0 = 1.4550e-04
Loss = 7.6027e-04, PNorm = 102.9010, GNorm = 0.6134, lr_0 = 1.4079e-04
Validation rmse = 0.811618
Epoch 25
Loss = 6.0597e-04, PNorm = 102.9112, GNorm = 0.3664, lr_0 = 1.3623e-04
Loss = 7.7785e-04, PNorm = 102.9205, GNorm = 1.0452, lr_0 = 1.3183e-04
Loss = 7.6978e-04, PNorm = 102.9287, GNorm = 0.9471, lr_0 = 1.2756e-04
Validation rmse = 0.794841
Epoch 26
Loss = 5.8600e-04, PNorm = 102.9381, GNorm = 0.3176, lr_0 = 1.2343e-04
Loss = 7.0122e-04, PNorm = 102.9467, GNorm = 0.5117, lr_0 = 1.1944e-04
Validation rmse = 0.815575
Epoch 27
Loss = 7.8566e-04, PNorm = 102.9559, GNorm = 0.5568, lr_0 = 1.1557e-04
Loss = 7.4422e-04, PNorm = 102.9652, GNorm = 0.5548, lr_0 = 1.1183e-04
Loss = 6.5335e-04, PNorm = 102.9740, GNorm = 0.3685, lr_0 = 1.0821e-04
Validation rmse = 0.823961
Epoch 28
Loss = 6.5801e-04, PNorm = 102.9826, GNorm = 0.5399, lr_0 = 1.0437e-04
Loss = 5.5632e-04, PNorm = 102.9910, GNorm = 0.7101, lr_0 = 1.0099e-04
Validation rmse = 0.808840
Epoch 29
Loss = 7.9907e-04, PNorm = 102.9985, GNorm = 1.0507, lr_0 = 1.0000e-04
Loss = 6.4557e-04, PNorm = 103.0061, GNorm = 0.8783, lr_0 = 1.0000e-04
Loss = 7.6321e-04, PNorm = 103.0137, GNorm = 2.4776, lr_0 = 1.0000e-04
Validation rmse = 0.821800
Model 0 best validation rmse = 0.786488 on epoch 21
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.742750
Ensemble test rmse = 0.742750
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2400, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,721,601
Moving model to cuda
Epoch 0
Loss = 2.2203e-02, PNorm = 99.7618, GNorm = 1.1465, lr_0 = 2.9800e-04
Loss = 1.4315e-02, PNorm = 99.8579, GNorm = 4.0717, lr_0 = 4.7800e-04
Validation rmse = 1.717704
Epoch 1
Loss = 9.5569e-03, PNorm = 100.0328, GNorm = 2.0381, lr_0 = 6.7600e-04
Loss = 1.0198e-02, PNorm = 100.2428, GNorm = 2.6763, lr_0 = 8.5600e-04
Loss = 7.2130e-03, PNorm = 100.4558, GNorm = 2.9794, lr_0 = 9.9344e-04
Validation rmse = 1.306327
Epoch 2
Loss = 6.2358e-03, PNorm = 100.6546, GNorm = 3.8338, lr_0 = 9.6130e-04
Loss = 5.8179e-03, PNorm = 100.8278, GNorm = 2.0554, lr_0 = 9.3019e-04
Validation rmse = 1.152415
Epoch 3
Loss = 3.8695e-03, PNorm = 100.9559, GNorm = 1.4031, lr_0 = 9.0009e-04
Loss = 4.5291e-03, PNorm = 101.0693, GNorm = 0.6075, lr_0 = 8.7096e-04
Loss = 4.7806e-03, PNorm = 101.1647, GNorm = 4.1416, lr_0 = 8.4278e-04
Validation rmse = 0.946189
Epoch 4
Loss = 4.3687e-03, PNorm = 101.2458, GNorm = 2.2594, lr_0 = 8.1551e-04
Loss = 3.2753e-03, PNorm = 101.3262, GNorm = 2.4637, lr_0 = 7.8912e-04
Validation rmse = 0.994591
Epoch 5
Loss = 2.3499e-03, PNorm = 101.3949, GNorm = 1.6303, lr_0 = 7.6358e-04
Loss = 4.6684e-03, PNorm = 101.4631, GNorm = 3.6361, lr_0 = 7.3888e-04
Loss = 3.7089e-03, PNorm = 101.5355, GNorm = 1.0214, lr_0 = 7.1497e-04
Validation rmse = 1.202435
Epoch 6
Loss = 4.9204e-03, PNorm = 101.6128, GNorm = 1.3973, lr_0 = 6.8956e-04
Loss = 3.4392e-03, PNorm = 101.6898, GNorm = 2.6911, lr_0 = 6.6725e-04
Loss = 2.6671e-03, PNorm = 101.7556, GNorm = 1.8599, lr_0 = 6.4565e-04
Validation rmse = 0.900220
Epoch 7
Loss = 2.6261e-03, PNorm = 101.8064, GNorm = 1.6628, lr_0 = 6.2476e-04
Loss = 2.3610e-03, PNorm = 101.8558, GNorm = 1.6663, lr_0 = 6.0454e-04
Validation rmse = 0.873972
Epoch 8
Loss = 3.2594e-03, PNorm = 101.9084, GNorm = 1.2707, lr_0 = 5.8498e-04
Loss = 2.3718e-03, PNorm = 101.9710, GNorm = 1.6027, lr_0 = 5.6605e-04
Loss = 2.3442e-03, PNorm = 102.0177, GNorm = 0.5262, lr_0 = 5.4774e-04
Validation rmse = 0.839820
Epoch 9
Loss = 2.1860e-03, PNorm = 102.0573, GNorm = 0.9907, lr_0 = 5.3001e-04
Loss = 2.3537e-03, PNorm = 102.1008, GNorm = 1.3002, lr_0 = 5.1286e-04
Validation rmse = 0.870287
Epoch 10
Loss = 1.8630e-03, PNorm = 102.1399, GNorm = 0.8687, lr_0 = 4.9627e-04
Loss = 2.6550e-03, PNorm = 102.1682, GNorm = 0.9932, lr_0 = 4.8021e-04
Loss = 1.8275e-03, PNorm = 102.1951, GNorm = 1.2977, lr_0 = 4.6467e-04
Validation rmse = 0.837993
Epoch 11
Loss = 2.3716e-03, PNorm = 102.2318, GNorm = 4.0064, lr_0 = 4.4963e-04
Loss = 1.8901e-03, PNorm = 102.2658, GNorm = 0.5074, lr_0 = 4.3508e-04
Validation rmse = 0.758728
Epoch 12
Loss = 1.5795e-03, PNorm = 102.3051, GNorm = 0.6070, lr_0 = 4.1962e-04
Loss = 2.0331e-03, PNorm = 102.3417, GNorm = 3.8551, lr_0 = 4.0604e-04
Loss = 2.3391e-03, PNorm = 102.3793, GNorm = 2.5795, lr_0 = 3.9290e-04
Validation rmse = 0.831640
Epoch 13
Loss = 1.4734e-03, PNorm = 102.4120, GNorm = 0.9278, lr_0 = 3.8019e-04
Loss = 1.6816e-03, PNorm = 102.4386, GNorm = 0.7527, lr_0 = 3.6789e-04
Loss = 2.4723e-03, PNorm = 102.4607, GNorm = 0.8720, lr_0 = 3.5598e-04
Validation rmse = 0.927861
Epoch 14
Loss = 2.1711e-03, PNorm = 102.4942, GNorm = 2.7145, lr_0 = 3.4446e-04
Loss = 1.6300e-03, PNorm = 102.5179, GNorm = 1.0338, lr_0 = 3.3332e-04
Validation rmse = 0.751826
Epoch 15
Loss = 1.4867e-03, PNorm = 102.5427, GNorm = 1.9442, lr_0 = 3.2253e-04
Loss = 1.5160e-03, PNorm = 102.5615, GNorm = 1.4222, lr_0 = 3.1209e-04
Loss = 1.6536e-03, PNorm = 102.5843, GNorm = 1.3448, lr_0 = 3.0200e-04
Validation rmse = 0.751842
Epoch 16
Loss = 1.8995e-03, PNorm = 102.6037, GNorm = 0.6953, lr_0 = 2.9222e-04
Loss = 1.1272e-03, PNorm = 102.6230, GNorm = 0.8884, lr_0 = 2.8277e-04
Validation rmse = 0.742724
Epoch 17
Loss = 1.1944e-03, PNorm = 102.6433, GNorm = 0.2692, lr_0 = 2.7272e-04
Loss = 1.3682e-03, PNorm = 102.6612, GNorm = 0.7513, lr_0 = 2.6389e-04
Loss = 1.1720e-03, PNorm = 102.6806, GNorm = 0.5548, lr_0 = 2.5535e-04
Validation rmse = 0.710591
Epoch 18
Loss = 1.0628e-03, PNorm = 102.6958, GNorm = 0.9043, lr_0 = 2.4709e-04
Loss = 1.4246e-03, PNorm = 102.7131, GNorm = 1.3534, lr_0 = 2.3910e-04
Loss = 1.1589e-03, PNorm = 102.7327, GNorm = 0.9929, lr_0 = 2.3136e-04
Validation rmse = 0.717830
Epoch 19
Loss = 1.2013e-03, PNorm = 102.7465, GNorm = 1.8854, lr_0 = 2.2387e-04
Loss = 1.1158e-03, PNorm = 102.7638, GNorm = 1.1917, lr_0 = 2.1663e-04
Validation rmse = 0.718732
Epoch 20
Loss = 8.8122e-04, PNorm = 102.7833, GNorm = 1.1399, lr_0 = 2.0962e-04
Loss = 1.2464e-03, PNorm = 102.7989, GNorm = 0.7874, lr_0 = 2.0283e-04
Loss = 1.1573e-03, PNorm = 102.8147, GNorm = 0.5052, lr_0 = 1.9627e-04
Validation rmse = 0.715874
Epoch 21
Loss = 1.0009e-03, PNorm = 102.8310, GNorm = 0.8619, lr_0 = 1.8992e-04
Loss = 1.1279e-03, PNorm = 102.8451, GNorm = 1.9815, lr_0 = 1.8377e-04
Validation rmse = 0.710963
Epoch 22
Loss = 9.0700e-04, PNorm = 102.8585, GNorm = 1.1568, lr_0 = 1.7783e-04
Loss = 1.0160e-03, PNorm = 102.8714, GNorm = 1.2987, lr_0 = 1.7207e-04
Loss = 1.0534e-03, PNorm = 102.8845, GNorm = 0.9697, lr_0 = 1.6651e-04
Validation rmse = 0.690900
Epoch 23
Loss = 7.9452e-04, PNorm = 102.9007, GNorm = 0.9256, lr_0 = 1.6059e-04
Loss = 9.0944e-04, PNorm = 102.9148, GNorm = 0.6951, lr_0 = 1.5539e-04
Validation rmse = 0.743655
Epoch 24
Loss = 7.2916e-04, PNorm = 102.9244, GNorm = 1.1417, lr_0 = 1.5036e-04
Loss = 1.0797e-03, PNorm = 102.9356, GNorm = 0.3019, lr_0 = 1.4550e-04
Loss = 1.0356e-03, PNorm = 102.9489, GNorm = 0.5301, lr_0 = 1.4079e-04
Validation rmse = 0.697915
Epoch 25
Loss = 6.4433e-04, PNorm = 102.9602, GNorm = 0.4764, lr_0 = 1.3623e-04
Loss = 8.8845e-04, PNorm = 102.9708, GNorm = 0.6087, lr_0 = 1.3183e-04
Loss = 1.0005e-03, PNorm = 102.9833, GNorm = 1.0422, lr_0 = 1.2756e-04
Validation rmse = 0.695175
Epoch 26
Loss = 9.0240e-04, PNorm = 102.9931, GNorm = 0.9580, lr_0 = 1.2343e-04
Loss = 9.3170e-04, PNorm = 103.0025, GNorm = 0.8053, lr_0 = 1.1944e-04
Validation rmse = 0.687643
Epoch 27
Loss = 8.4262e-04, PNorm = 103.0117, GNorm = 0.3353, lr_0 = 1.1557e-04
Loss = 8.1117e-04, PNorm = 103.0224, GNorm = 1.6331, lr_0 = 1.1183e-04
Loss = 9.1251e-04, PNorm = 103.0327, GNorm = 0.4634, lr_0 = 1.0821e-04
Validation rmse = 0.716752
Epoch 28
Loss = 8.7346e-04, PNorm = 103.0429, GNorm = 0.4870, lr_0 = 1.0437e-04
Loss = 6.5445e-04, PNorm = 103.0513, GNorm = 0.4141, lr_0 = 1.0099e-04
Validation rmse = 0.684873
Epoch 29
Loss = 6.5984e-04, PNorm = 103.0591, GNorm = 0.5452, lr_0 = 1.0000e-04
Loss = 7.8996e-04, PNorm = 103.0683, GNorm = 0.8031, lr_0 = 1.0000e-04
Loss = 7.6882e-04, PNorm = 103.0775, GNorm = 0.6829, lr_0 = 1.0000e-04
Validation rmse = 0.681569
Model 0 best validation rmse = 0.681569 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.619086
Ensemble test rmse = 0.619086
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2400, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,721,601
Moving model to cuda
Epoch 0
Loss = 2.1236e-02, PNorm = 99.7597, GNorm = 7.0158, lr_0 = 2.9800e-04
Loss = 1.4773e-02, PNorm = 99.8581, GNorm = 4.1340, lr_0 = 4.7800e-04
Validation rmse = 1.469143
Epoch 1
Loss = 1.1953e-02, PNorm = 100.0250, GNorm = 3.1379, lr_0 = 6.7600e-04
Loss = 1.0670e-02, PNorm = 100.2399, GNorm = 2.3723, lr_0 = 8.5600e-04
Loss = 7.6172e-03, PNorm = 100.4768, GNorm = 1.8266, lr_0 = 9.9344e-04
Validation rmse = 1.372760
Epoch 2
Loss = 9.9892e-03, PNorm = 100.7167, GNorm = 2.3077, lr_0 = 9.6130e-04
Loss = 8.5137e-03, PNorm = 100.9299, GNorm = 1.5234, lr_0 = 9.3019e-04
Validation rmse = 1.034063
Epoch 3
Loss = 5.2756e-03, PNorm = 101.0905, GNorm = 3.8510, lr_0 = 9.0009e-04
Loss = 4.8895e-03, PNorm = 101.1964, GNorm = 2.4798, lr_0 = 8.7096e-04
Loss = 4.8199e-03, PNorm = 101.2937, GNorm = 0.9162, lr_0 = 8.4278e-04
Validation rmse = 0.955194
Epoch 4
Loss = 5.4022e-03, PNorm = 101.3876, GNorm = 2.4106, lr_0 = 8.1551e-04
Loss = 5.6414e-03, PNorm = 101.4734, GNorm = 2.0851, lr_0 = 7.8912e-04
Validation rmse = 0.941155
Epoch 5
Loss = 4.2805e-03, PNorm = 101.5539, GNorm = 2.5996, lr_0 = 7.6358e-04
Loss = 3.8065e-03, PNorm = 101.6325, GNorm = 2.8035, lr_0 = 7.3888e-04
Loss = 3.6828e-03, PNorm = 101.7005, GNorm = 3.9418, lr_0 = 7.1497e-04
Validation rmse = 1.028473
Epoch 6
Loss = 3.6416e-03, PNorm = 101.7561, GNorm = 1.2705, lr_0 = 6.8956e-04
Loss = 2.8149e-03, PNorm = 101.7983, GNorm = 1.8434, lr_0 = 6.6725e-04
Loss = 3.9316e-03, PNorm = 101.8466, GNorm = 0.9154, lr_0 = 6.4565e-04
Validation rmse = 0.943893
Epoch 7
Loss = 3.2141e-03, PNorm = 101.8965, GNorm = 2.4548, lr_0 = 6.2476e-04
Loss = 2.6581e-03, PNorm = 101.9537, GNorm = 1.5250, lr_0 = 6.0454e-04
Validation rmse = 0.875970
Epoch 8
Loss = 3.1413e-03, PNorm = 101.9913, GNorm = 1.9500, lr_0 = 5.8498e-04
Loss = 2.4341e-03, PNorm = 102.0379, GNorm = 0.4271, lr_0 = 5.6605e-04
Loss = 2.5292e-03, PNorm = 102.0805, GNorm = 0.7504, lr_0 = 5.4774e-04
Validation rmse = 0.774289
Epoch 9
Loss = 2.8930e-03, PNorm = 102.1208, GNorm = 2.0734, lr_0 = 5.3001e-04
Loss = 3.3419e-03, PNorm = 102.1622, GNorm = 3.1532, lr_0 = 5.1286e-04
Validation rmse = 0.777389
Epoch 10
Loss = 2.6820e-03, PNorm = 102.2004, GNorm = 1.5318, lr_0 = 4.9627e-04
Loss = 2.5476e-03, PNorm = 102.2386, GNorm = 1.7638, lr_0 = 4.8021e-04
Loss = 2.6337e-03, PNorm = 102.2809, GNorm = 2.6610, lr_0 = 4.6467e-04
Validation rmse = 0.780459
Epoch 11
Loss = 1.8854e-03, PNorm = 102.3015, GNorm = 1.3282, lr_0 = 4.4963e-04
Loss = 2.1389e-03, PNorm = 102.3329, GNorm = 1.1839, lr_0 = 4.3508e-04
Validation rmse = 0.715384
Epoch 12
Loss = 1.1675e-03, PNorm = 102.3688, GNorm = 0.6778, lr_0 = 4.1962e-04
Loss = 2.0477e-03, PNorm = 102.3946, GNorm = 3.4785, lr_0 = 4.0604e-04
Loss = 1.5829e-03, PNorm = 102.4277, GNorm = 0.9486, lr_0 = 3.9290e-04
Validation rmse = 0.711997
Epoch 13
Loss = 1.5546e-03, PNorm = 102.4505, GNorm = 0.5769, lr_0 = 3.8019e-04
Loss = 1.6947e-03, PNorm = 102.4697, GNorm = 2.8438, lr_0 = 3.6789e-04
Loss = 2.0949e-03, PNorm = 102.4949, GNorm = 3.2885, lr_0 = 3.5598e-04
Validation rmse = 0.714245
Epoch 14
Loss = 1.8010e-03, PNorm = 102.5160, GNorm = 2.2398, lr_0 = 3.4446e-04
Loss = 2.0652e-03, PNorm = 102.5506, GNorm = 1.4579, lr_0 = 3.3332e-04
Validation rmse = 0.934883
Epoch 15
Loss = 2.3907e-03, PNorm = 102.5765, GNorm = 1.0130, lr_0 = 3.2253e-04
Loss = 1.7341e-03, PNorm = 102.5992, GNorm = 0.6916, lr_0 = 3.1209e-04
Loss = 2.1594e-03, PNorm = 102.6267, GNorm = 2.7618, lr_0 = 3.0200e-04
Validation rmse = 0.735794
Epoch 16
Loss = 1.4253e-03, PNorm = 102.6473, GNorm = 0.6712, lr_0 = 2.9222e-04
Loss = 1.4463e-03, PNorm = 102.6648, GNorm = 0.4605, lr_0 = 2.8277e-04
Validation rmse = 0.698903
Epoch 17
Loss = 1.2063e-03, PNorm = 102.6817, GNorm = 2.5196, lr_0 = 2.7272e-04
Loss = 1.2153e-03, PNorm = 102.7004, GNorm = 1.4015, lr_0 = 2.6389e-04
Loss = 1.6321e-03, PNorm = 102.7221, GNorm = 3.4415, lr_0 = 2.5535e-04
Validation rmse = 0.711364
Epoch 18
Loss = 1.3694e-03, PNorm = 102.7398, GNorm = 0.5233, lr_0 = 2.4709e-04
Loss = 1.3741e-03, PNorm = 102.7605, GNorm = 0.4412, lr_0 = 2.3910e-04
Loss = 1.1567e-03, PNorm = 102.7724, GNorm = 0.5337, lr_0 = 2.3136e-04
Validation rmse = 0.696211
Epoch 19
Loss = 1.4229e-03, PNorm = 102.7897, GNorm = 1.3114, lr_0 = 2.2387e-04
Loss = 1.1310e-03, PNorm = 102.8056, GNorm = 0.5491, lr_0 = 2.1663e-04
Validation rmse = 0.694470
Epoch 20
Loss = 1.1583e-03, PNorm = 102.8224, GNorm = 2.9157, lr_0 = 2.0962e-04
Loss = 1.0232e-03, PNorm = 102.8395, GNorm = 0.6541, lr_0 = 2.0283e-04
Loss = 1.1021e-03, PNorm = 102.8500, GNorm = 0.6612, lr_0 = 1.9627e-04
Validation rmse = 0.668249
Epoch 21
Loss = 1.0182e-03, PNorm = 102.8625, GNorm = 0.7751, lr_0 = 1.8992e-04
Loss = 1.0845e-03, PNorm = 102.8766, GNorm = 1.2024, lr_0 = 1.8377e-04
Validation rmse = 0.689679
Epoch 22
Loss = 1.0209e-03, PNorm = 102.8914, GNorm = 0.5646, lr_0 = 1.7783e-04
Loss = 1.1431e-03, PNorm = 102.9069, GNorm = 0.7241, lr_0 = 1.7207e-04
Loss = 9.8735e-04, PNorm = 102.9214, GNorm = 0.5704, lr_0 = 1.6651e-04
Validation rmse = 0.682935
Epoch 23
Loss = 1.0378e-03, PNorm = 102.9371, GNorm = 0.6863, lr_0 = 1.6059e-04
Loss = 1.0097e-03, PNorm = 102.9484, GNorm = 0.7096, lr_0 = 1.5539e-04
Validation rmse = 0.686088
Epoch 24
Loss = 9.9870e-04, PNorm = 102.9587, GNorm = 0.2631, lr_0 = 1.5036e-04
Loss = 8.1605e-04, PNorm = 102.9704, GNorm = 1.1820, lr_0 = 1.4550e-04
Loss = 9.9115e-04, PNorm = 102.9819, GNorm = 2.2542, lr_0 = 1.4079e-04
Validation rmse = 0.689002
Epoch 25
Loss = 1.0494e-03, PNorm = 102.9941, GNorm = 2.1138, lr_0 = 1.3623e-04
Loss = 1.0056e-03, PNorm = 103.0069, GNorm = 0.8591, lr_0 = 1.3183e-04
Loss = 1.0261e-03, PNorm = 103.0159, GNorm = 1.7528, lr_0 = 1.2756e-04
Validation rmse = 0.677621
Epoch 26
Loss = 9.0066e-04, PNorm = 103.0268, GNorm = 1.8518, lr_0 = 1.2343e-04
Loss = 8.2746e-04, PNorm = 103.0353, GNorm = 0.4791, lr_0 = 1.1944e-04
Validation rmse = 0.700307
Epoch 27
Loss = 9.7244e-04, PNorm = 103.0447, GNorm = 0.4977, lr_0 = 1.1557e-04
Loss = 9.1623e-04, PNorm = 103.0548, GNorm = 0.5517, lr_0 = 1.1183e-04
Loss = 7.2517e-04, PNorm = 103.0633, GNorm = 0.9571, lr_0 = 1.0821e-04
Validation rmse = 0.697186
Epoch 28
Loss = 7.7817e-04, PNorm = 103.0713, GNorm = 0.8214, lr_0 = 1.0437e-04
Loss = 8.4370e-04, PNorm = 103.0801, GNorm = 0.2964, lr_0 = 1.0099e-04
Validation rmse = 0.694325
Epoch 29
Loss = 8.8430e-04, PNorm = 103.0874, GNorm = 0.2438, lr_0 = 1.0000e-04
Loss = 8.3024e-04, PNorm = 103.0957, GNorm = 1.7787, lr_0 = 1.0000e-04
Loss = 6.6188e-04, PNorm = 103.1026, GNorm = 0.9398, lr_0 = 1.0000e-04
Validation rmse = 0.693980
Model 0 best validation rmse = 0.668249 on epoch 20
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.717577
Ensemble test rmse = 0.717577
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2400, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,721,601
Moving model to cuda
Epoch 0
Loss = 1.8219e-02, PNorm = 99.7623, GNorm = 3.7967, lr_0 = 2.9800e-04
Loss = 1.4553e-02, PNorm = 99.8639, GNorm = 5.1766, lr_0 = 4.7800e-04
Validation rmse = 1.556913
Epoch 1
Loss = 9.8663e-03, PNorm = 100.0511, GNorm = 4.6699, lr_0 = 6.7600e-04
Loss = 9.0733e-03, PNorm = 100.2716, GNorm = 1.5385, lr_0 = 8.5600e-04
Loss = 7.1470e-03, PNorm = 100.4925, GNorm = 3.1158, lr_0 = 9.9344e-04
Validation rmse = 1.421346
Epoch 2
Loss = 9.3170e-03, PNorm = 100.7181, GNorm = 1.2043, lr_0 = 9.6130e-04
Loss = 7.1495e-03, PNorm = 100.9306, GNorm = 2.3987, lr_0 = 9.3019e-04
Validation rmse = 1.100608
Epoch 3
Loss = 4.4921e-03, PNorm = 101.0845, GNorm = 1.0469, lr_0 = 9.0009e-04
Loss = 4.9581e-03, PNorm = 101.2122, GNorm = 1.3698, lr_0 = 8.7096e-04
Loss = 5.0183e-03, PNorm = 101.3084, GNorm = 1.1010, lr_0 = 8.4278e-04
Validation rmse = 1.024846
Epoch 4
Loss = 4.0598e-03, PNorm = 101.3892, GNorm = 2.0408, lr_0 = 8.1551e-04
Loss = 3.5218e-03, PNorm = 101.4710, GNorm = 1.9857, lr_0 = 7.8912e-04
Validation rmse = 0.960901
Epoch 5
Loss = 2.9356e-03, PNorm = 101.5358, GNorm = 1.6383, lr_0 = 7.6358e-04
Loss = 3.5404e-03, PNorm = 101.5954, GNorm = 2.9945, lr_0 = 7.3888e-04
Loss = 3.7791e-03, PNorm = 101.6550, GNorm = 1.1047, lr_0 = 7.1497e-04
Validation rmse = 1.015023
Epoch 6
Loss = 3.1350e-03, PNorm = 101.7204, GNorm = 1.2736, lr_0 = 6.8956e-04
Loss = 3.3609e-03, PNorm = 101.7628, GNorm = 2.1235, lr_0 = 6.6725e-04
Loss = 3.4584e-03, PNorm = 101.8075, GNorm = 5.7101, lr_0 = 6.4565e-04
Validation rmse = 0.879062
Epoch 7
Loss = 2.7785e-03, PNorm = 101.8634, GNorm = 2.5654, lr_0 = 6.2476e-04
Loss = 3.0960e-03, PNorm = 101.9087, GNorm = 2.1148, lr_0 = 6.0454e-04
Validation rmse = 0.888906
Epoch 8
Loss = 2.5548e-03, PNorm = 101.9512, GNorm = 0.5190, lr_0 = 5.8498e-04
Loss = 2.2232e-03, PNorm = 101.9910, GNorm = 0.7820, lr_0 = 5.6605e-04
Loss = 2.1269e-03, PNorm = 102.0305, GNorm = 0.6362, lr_0 = 5.4774e-04
Validation rmse = 0.834373
Epoch 9
Loss = 2.1073e-03, PNorm = 102.0695, GNorm = 0.3851, lr_0 = 5.3001e-04
Loss = 1.9664e-03, PNorm = 102.1086, GNorm = 1.5029, lr_0 = 5.1286e-04
Validation rmse = 0.797119
Epoch 10
Loss = 1.2528e-03, PNorm = 102.1415, GNorm = 1.3494, lr_0 = 4.9627e-04
Loss = 1.8382e-03, PNorm = 102.1757, GNorm = 1.2237, lr_0 = 4.8021e-04
Loss = 1.9949e-03, PNorm = 102.2066, GNorm = 1.7510, lr_0 = 4.6467e-04
Validation rmse = 0.760974
Epoch 11
Loss = 1.3943e-03, PNorm = 102.2338, GNorm = 1.4510, lr_0 = 4.4963e-04
Loss = 1.9759e-03, PNorm = 102.2675, GNorm = 2.2172, lr_0 = 4.3508e-04
Validation rmse = 0.830239
Epoch 12
Loss = 2.8043e-03, PNorm = 102.3052, GNorm = 2.8223, lr_0 = 4.1962e-04
Loss = 1.8486e-03, PNorm = 102.3374, GNorm = 1.0081, lr_0 = 4.0604e-04
Loss = 1.7689e-03, PNorm = 102.3663, GNorm = 1.7163, lr_0 = 3.9290e-04
Validation rmse = 0.761740
Epoch 13
Loss = 1.9050e-03, PNorm = 102.3940, GNorm = 0.7903, lr_0 = 3.8019e-04
Loss = 1.7130e-03, PNorm = 102.4191, GNorm = 1.4676, lr_0 = 3.6789e-04
Loss = 1.6957e-03, PNorm = 102.4533, GNorm = 1.0235, lr_0 = 3.5598e-04
Validation rmse = 0.746744
Epoch 14
Loss = 1.4184e-03, PNorm = 102.4851, GNorm = 1.3480, lr_0 = 3.4446e-04
Loss = 1.4134e-03, PNorm = 102.5057, GNorm = 1.3382, lr_0 = 3.3332e-04
Validation rmse = 0.753019
Epoch 15
Loss = 1.2403e-03, PNorm = 102.5257, GNorm = 0.7634, lr_0 = 3.2253e-04
Loss = 1.3985e-03, PNorm = 102.5505, GNorm = 2.9820, lr_0 = 3.1209e-04
Loss = 1.2938e-03, PNorm = 102.5736, GNorm = 1.8551, lr_0 = 3.0200e-04
Validation rmse = 0.717515
Epoch 16
Loss = 1.5236e-03, PNorm = 102.6024, GNorm = 1.1695, lr_0 = 2.9222e-04
Loss = 1.5315e-03, PNorm = 102.6266, GNorm = 0.9288, lr_0 = 2.8277e-04
Validation rmse = 0.696797
Epoch 17
Loss = 1.2107e-03, PNorm = 102.6445, GNorm = 0.9269, lr_0 = 2.7272e-04
Loss = 1.0682e-03, PNorm = 102.6628, GNorm = 1.0928, lr_0 = 2.6389e-04
Loss = 1.1449e-03, PNorm = 102.6853, GNorm = 0.6409, lr_0 = 2.5535e-04
Validation rmse = 0.751848
Epoch 18
Loss = 1.1765e-03, PNorm = 102.7008, GNorm = 2.6451, lr_0 = 2.4709e-04
Loss = 1.5184e-03, PNorm = 102.7188, GNorm = 0.8820, lr_0 = 2.3910e-04
Loss = 1.0082e-03, PNorm = 102.7419, GNorm = 1.0239, lr_0 = 2.3136e-04
Validation rmse = 0.694750
Epoch 19
Loss = 1.1641e-03, PNorm = 102.7614, GNorm = 0.9397, lr_0 = 2.2387e-04
Loss = 9.6951e-04, PNorm = 102.7785, GNorm = 0.7464, lr_0 = 2.1663e-04
Validation rmse = 0.701228
Epoch 20
Loss = 1.0928e-03, PNorm = 102.7949, GNorm = 0.9303, lr_0 = 2.0962e-04
Loss = 1.1698e-03, PNorm = 102.8140, GNorm = 2.4861, lr_0 = 2.0283e-04
Loss = 1.3796e-03, PNorm = 102.8294, GNorm = 1.3899, lr_0 = 1.9627e-04
Validation rmse = 0.763687
Epoch 21
Loss = 1.0192e-03, PNorm = 102.8438, GNorm = 0.2592, lr_0 = 1.8992e-04
Loss = 1.1466e-03, PNorm = 102.8593, GNorm = 0.6373, lr_0 = 1.8377e-04
Validation rmse = 0.706881
Epoch 22
Loss = 1.2059e-03, PNorm = 102.8742, GNorm = 1.2653, lr_0 = 1.7783e-04
Loss = 1.0040e-03, PNorm = 102.8892, GNorm = 1.1784, lr_0 = 1.7207e-04
Loss = 7.8544e-04, PNorm = 102.9008, GNorm = 0.7831, lr_0 = 1.6651e-04
Validation rmse = 0.695567
Epoch 23
Loss = 9.7718e-04, PNorm = 102.9124, GNorm = 0.6683, lr_0 = 1.6059e-04
Loss = 7.5138e-04, PNorm = 102.9238, GNorm = 0.6724, lr_0 = 1.5539e-04
Validation rmse = 0.720823
Epoch 24
Loss = 6.2383e-04, PNorm = 102.9360, GNorm = 0.8608, lr_0 = 1.5036e-04
Loss = 8.3562e-04, PNorm = 102.9502, GNorm = 0.8887, lr_0 = 1.4550e-04
Loss = 8.4329e-04, PNorm = 102.9598, GNorm = 0.5082, lr_0 = 1.4079e-04
Validation rmse = 0.740034
Epoch 25
Loss = 8.1735e-04, PNorm = 102.9691, GNorm = 1.7133, lr_0 = 1.3623e-04
Loss = 8.3472e-04, PNorm = 102.9791, GNorm = 1.6580, lr_0 = 1.3183e-04
Loss = 9.3129e-04, PNorm = 102.9915, GNorm = 1.0262, lr_0 = 1.2756e-04
Validation rmse = 0.694895
Epoch 26
Loss = 7.8264e-04, PNorm = 103.0027, GNorm = 0.5142, lr_0 = 1.2343e-04
Loss = 7.9479e-04, PNorm = 103.0122, GNorm = 0.4659, lr_0 = 1.1944e-04
Validation rmse = 0.713064
Epoch 27
Loss = 6.8069e-04, PNorm = 103.0208, GNorm = 0.5923, lr_0 = 1.1557e-04
Loss = 7.9044e-04, PNorm = 103.0304, GNorm = 0.6700, lr_0 = 1.1183e-04
Loss = 7.1267e-04, PNorm = 103.0380, GNorm = 0.6191, lr_0 = 1.0821e-04
Validation rmse = 0.716316
Epoch 28
Loss = 6.4523e-04, PNorm = 103.0473, GNorm = 0.5321, lr_0 = 1.0437e-04
Loss = 8.3005e-04, PNorm = 103.0560, GNorm = 0.5937, lr_0 = 1.0099e-04
Validation rmse = 0.718076
Epoch 29
Loss = 4.9537e-04, PNorm = 103.0647, GNorm = 0.3460, lr_0 = 1.0000e-04
Loss = 6.3521e-04, PNorm = 103.0712, GNorm = 0.3740, lr_0 = 1.0000e-04
Loss = 7.8727e-04, PNorm = 103.0786, GNorm = 0.6124, lr_0 = 1.0000e-04
Validation rmse = 0.690732
Model 0 best validation rmse = 0.690732 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.815443
Ensemble test rmse = 0.815443
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2400, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,721,601
Moving model to cuda
Epoch 0
Loss = 2.0194e-02, PNorm = 99.7632, GNorm = 1.4490, lr_0 = 2.9800e-04
Loss = 1.6583e-02, PNorm = 99.8604, GNorm = 1.9829, lr_0 = 4.7800e-04
Validation rmse = 1.952227
Epoch 1
Loss = 1.0370e-02, PNorm = 100.0189, GNorm = 4.2000, lr_0 = 6.7600e-04
Loss = 8.7761e-03, PNorm = 100.1988, GNorm = 2.4566, lr_0 = 8.5600e-04
Loss = 8.2441e-03, PNorm = 100.4008, GNorm = 2.6520, lr_0 = 9.9344e-04
Validation rmse = 1.540745
Epoch 2
Loss = 7.4816e-03, PNorm = 100.6090, GNorm = 3.7819, lr_0 = 9.6130e-04
Loss = 5.3785e-03, PNorm = 100.7869, GNorm = 4.7269, lr_0 = 9.3019e-04
Validation rmse = 1.175368
Epoch 3
Loss = 4.3281e-03, PNorm = 100.9243, GNorm = 2.1678, lr_0 = 9.0009e-04
Loss = 4.3160e-03, PNorm = 101.0366, GNorm = 3.3919, lr_0 = 8.7096e-04
Loss = 4.4696e-03, PNorm = 101.1383, GNorm = 2.0362, lr_0 = 8.4278e-04
Validation rmse = 1.090455
Epoch 4
Loss = 3.6420e-03, PNorm = 101.2089, GNorm = 3.0036, lr_0 = 8.1551e-04
Loss = 3.1756e-03, PNorm = 101.2843, GNorm = 5.1940, lr_0 = 7.8912e-04
Validation rmse = 1.109006
Epoch 5
Loss = 3.8915e-03, PNorm = 101.3529, GNorm = 2.3721, lr_0 = 7.6358e-04
Loss = 2.8815e-03, PNorm = 101.4150, GNorm = 1.2233, lr_0 = 7.3888e-04
Loss = 4.1045e-03, PNorm = 101.4662, GNorm = 4.2239, lr_0 = 7.1497e-04
Validation rmse = 1.201846
Epoch 6
Loss = 4.2395e-03, PNorm = 101.5282, GNorm = 2.0960, lr_0 = 6.8956e-04
Loss = 4.5992e-03, PNorm = 101.6009, GNorm = 0.7681, lr_0 = 6.6725e-04
Loss = 3.5288e-03, PNorm = 101.6477, GNorm = 3.1301, lr_0 = 6.4565e-04
Validation rmse = 0.954391
Epoch 7
Loss = 2.4842e-03, PNorm = 101.6916, GNorm = 2.0933, lr_0 = 6.2476e-04
Loss = 2.5206e-03, PNorm = 101.7292, GNorm = 0.9157, lr_0 = 6.0454e-04
Validation rmse = 0.922000
Epoch 8
Loss = 2.0337e-03, PNorm = 101.7665, GNorm = 1.9444, lr_0 = 5.8498e-04
Loss = 2.4563e-03, PNorm = 101.8095, GNorm = 3.8454, lr_0 = 5.6605e-04
Loss = 2.8604e-03, PNorm = 101.8424, GNorm = 0.5794, lr_0 = 5.4774e-04
Validation rmse = 0.876307
Epoch 9
Loss = 2.3510e-03, PNorm = 101.8823, GNorm = 3.4109, lr_0 = 5.3001e-04
Loss = 2.4117e-03, PNorm = 101.9207, GNorm = 1.0169, lr_0 = 5.1286e-04
Validation rmse = 0.830060
Epoch 10
Loss = 1.6218e-03, PNorm = 101.9528, GNorm = 0.7037, lr_0 = 4.9627e-04
Loss = 2.0395e-03, PNorm = 101.9849, GNorm = 0.9519, lr_0 = 4.8021e-04
Loss = 1.6594e-03, PNorm = 102.0163, GNorm = 1.3281, lr_0 = 4.6467e-04
Validation rmse = 0.876866
Epoch 11
Loss = 1.7349e-03, PNorm = 102.0426, GNorm = 3.1620, lr_0 = 4.4963e-04
Loss = 2.9419e-03, PNorm = 102.0779, GNorm = 2.6108, lr_0 = 4.3508e-04
Validation rmse = 0.865967
Epoch 12
Loss = 1.7005e-03, PNorm = 102.1181, GNorm = 0.7769, lr_0 = 4.1962e-04
Loss = 1.6380e-03, PNorm = 102.1491, GNorm = 3.3231, lr_0 = 4.0604e-04
Loss = 1.6365e-03, PNorm = 102.1776, GNorm = 0.4146, lr_0 = 3.9290e-04
Validation rmse = 0.910638
Epoch 13
Loss = 2.0739e-03, PNorm = 102.2004, GNorm = 4.5960, lr_0 = 3.8019e-04
Loss = 1.8501e-03, PNorm = 102.2290, GNorm = 3.2998, lr_0 = 3.6789e-04
Loss = 1.5304e-03, PNorm = 102.2583, GNorm = 1.7412, lr_0 = 3.5598e-04
Validation rmse = 0.787635
Epoch 14
Loss = 1.3296e-03, PNorm = 102.2832, GNorm = 1.3711, lr_0 = 3.4446e-04
Loss = 1.3819e-03, PNorm = 102.3069, GNorm = 2.5903, lr_0 = 3.3332e-04
Validation rmse = 0.775006
Epoch 15
Loss = 1.2866e-03, PNorm = 102.3320, GNorm = 1.9319, lr_0 = 3.2253e-04
Loss = 1.6339e-03, PNorm = 102.3523, GNorm = 2.1983, lr_0 = 3.1209e-04
Loss = 1.3822e-03, PNorm = 102.3781, GNorm = 1.8682, lr_0 = 3.0200e-04
Validation rmse = 0.881411
Epoch 16
Loss = 1.4173e-03, PNorm = 102.4055, GNorm = 1.2648, lr_0 = 2.9222e-04
Loss = 1.3610e-03, PNorm = 102.4306, GNorm = 0.6675, lr_0 = 2.8277e-04
Validation rmse = 0.780371
Epoch 17
Loss = 1.5286e-03, PNorm = 102.4474, GNorm = 1.9521, lr_0 = 2.7272e-04
Loss = 1.4225e-03, PNorm = 102.4671, GNorm = 3.2503, lr_0 = 2.6389e-04
Loss = 1.4136e-03, PNorm = 102.4904, GNorm = 1.7742, lr_0 = 2.5535e-04
Validation rmse = 0.816335
Epoch 18
Loss = 1.0747e-03, PNorm = 102.5095, GNorm = 0.8109, lr_0 = 2.4709e-04
Loss = 1.2850e-03, PNorm = 102.5259, GNorm = 2.0855, lr_0 = 2.3910e-04
Loss = 1.1602e-03, PNorm = 102.5443, GNorm = 1.5958, lr_0 = 2.3136e-04
Validation rmse = 0.879118
Epoch 19
Loss = 1.1368e-03, PNorm = 102.5601, GNorm = 0.5787, lr_0 = 2.2387e-04
Loss = 1.1281e-03, PNorm = 102.5782, GNorm = 0.6696, lr_0 = 2.1663e-04
Validation rmse = 0.777223
Epoch 20
Loss = 6.9456e-04, PNorm = 102.5960, GNorm = 1.3670, lr_0 = 2.0962e-04
Loss = 1.0219e-03, PNorm = 102.6120, GNorm = 0.4752, lr_0 = 2.0283e-04
Loss = 1.1392e-03, PNorm = 102.6265, GNorm = 2.4659, lr_0 = 1.9627e-04
Validation rmse = 0.830073
Epoch 21
Loss = 9.3583e-04, PNorm = 102.6432, GNorm = 0.3457, lr_0 = 1.8992e-04
Loss = 1.0426e-03, PNorm = 102.6595, GNorm = 1.4985, lr_0 = 1.8377e-04
Validation rmse = 0.785868
Epoch 22
Loss = 7.3322e-04, PNorm = 102.6725, GNorm = 0.3659, lr_0 = 1.7783e-04
Loss = 8.4837e-04, PNorm = 102.6836, GNorm = 0.5907, lr_0 = 1.7207e-04
Loss = 1.0677e-03, PNorm = 102.6969, GNorm = 0.6663, lr_0 = 1.6651e-04
Validation rmse = 0.776364
Epoch 23
Loss = 9.3613e-04, PNorm = 102.7165, GNorm = 1.6918, lr_0 = 1.6059e-04
Loss = 8.6200e-04, PNorm = 102.7312, GNorm = 1.9322, lr_0 = 1.5539e-04
Validation rmse = 0.765548
Epoch 24
Loss = 5.3967e-04, PNorm = 102.7412, GNorm = 0.5054, lr_0 = 1.5036e-04
Loss = 8.9454e-04, PNorm = 102.7507, GNorm = 1.1052, lr_0 = 1.4550e-04
Loss = 1.0462e-03, PNorm = 102.7637, GNorm = 1.7450, lr_0 = 1.4079e-04
Validation rmse = 0.792135
Epoch 25
Loss = 9.4957e-04, PNorm = 102.7757, GNorm = 1.2232, lr_0 = 1.3623e-04
Loss = 8.6375e-04, PNorm = 102.7871, GNorm = 1.4242, lr_0 = 1.3183e-04
Loss = 7.6391e-04, PNorm = 102.7963, GNorm = 1.5455, lr_0 = 1.2756e-04
Validation rmse = 0.795308
Epoch 26
Loss = 7.4487e-04, PNorm = 102.8053, GNorm = 0.8389, lr_0 = 1.2343e-04
Loss = 8.4125e-04, PNorm = 102.8153, GNorm = 0.8362, lr_0 = 1.1944e-04
Validation rmse = 0.773500
Epoch 27
Loss = 7.0217e-04, PNorm = 102.8257, GNorm = 0.6865, lr_0 = 1.1557e-04
Loss = 7.0046e-04, PNorm = 102.8342, GNorm = 0.2610, lr_0 = 1.1183e-04
Loss = 8.3303e-04, PNorm = 102.8424, GNorm = 0.7188, lr_0 = 1.0821e-04
Validation rmse = 0.781073
Epoch 28
Loss = 6.1840e-04, PNorm = 102.8527, GNorm = 0.7583, lr_0 = 1.0437e-04
Loss = 7.4665e-04, PNorm = 102.8607, GNorm = 0.3669, lr_0 = 1.0099e-04
Validation rmse = 0.808223
Epoch 29
Loss = 1.0557e-03, PNorm = 102.8701, GNorm = 0.3800, lr_0 = 1.0000e-04
Loss = 6.9404e-04, PNorm = 102.8793, GNorm = 0.3807, lr_0 = 1.0000e-04
Loss = 6.2633e-04, PNorm = 102.8855, GNorm = 0.5429, lr_0 = 1.0000e-04
Validation rmse = 0.773746
Model 0 best validation rmse = 0.765548 on epoch 23
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.948297
Ensemble test rmse = 0.948297
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2400, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,721,601
Moving model to cuda
Epoch 0
Loss = 1.7960e-02, PNorm = 99.7659, GNorm = 5.5194, lr_0 = 2.9800e-04
Loss = 1.4055e-02, PNorm = 99.8566, GNorm = 9.5239, lr_0 = 4.7800e-04
Validation rmse = 1.653183
Epoch 1
Loss = 8.1339e-03, PNorm = 100.0181, GNorm = 1.8967, lr_0 = 6.7600e-04
Loss = 7.7191e-03, PNorm = 100.2028, GNorm = 6.1978, lr_0 = 8.5600e-04
Loss = 9.0789e-03, PNorm = 100.4179, GNorm = 1.7333, lr_0 = 9.9344e-04
Validation rmse = 1.870223
Epoch 2
Loss = 8.2604e-03, PNorm = 100.6552, GNorm = 0.8647, lr_0 = 9.6130e-04
Loss = 6.6654e-03, PNorm = 100.8643, GNorm = 4.9947, lr_0 = 9.3019e-04
Validation rmse = 1.300923
Epoch 3
Loss = 5.1582e-03, PNorm = 101.0270, GNorm = 3.3662, lr_0 = 9.0009e-04
Loss = 4.5576e-03, PNorm = 101.1352, GNorm = 3.0627, lr_0 = 8.7096e-04
Loss = 4.6286e-03, PNorm = 101.2282, GNorm = 0.7777, lr_0 = 8.4278e-04
Validation rmse = 1.170836
Epoch 4
Loss = 4.3715e-03, PNorm = 101.3184, GNorm = 1.7147, lr_0 = 8.1551e-04
Loss = 3.9335e-03, PNorm = 101.3947, GNorm = 6.6648, lr_0 = 7.8912e-04
Validation rmse = 1.069462
Epoch 5
Loss = 3.3071e-03, PNorm = 101.4643, GNorm = 1.6722, lr_0 = 7.6358e-04
Loss = 2.9359e-03, PNorm = 101.5335, GNorm = 0.9728, lr_0 = 7.3888e-04
Loss = 3.5677e-03, PNorm = 101.6064, GNorm = 5.6236, lr_0 = 7.1497e-04
Validation rmse = 1.261461
Epoch 6
Loss = 3.9516e-03, PNorm = 101.6879, GNorm = 5.3982, lr_0 = 6.8956e-04
Loss = 3.3495e-03, PNorm = 101.7455, GNorm = 0.9313, lr_0 = 6.6725e-04
Loss = 2.7239e-03, PNorm = 101.7978, GNorm = 2.7713, lr_0 = 6.4565e-04
Validation rmse = 1.069814
Epoch 7
Loss = 2.2582e-03, PNorm = 101.8523, GNorm = 0.9218, lr_0 = 6.2476e-04
Loss = 2.8900e-03, PNorm = 101.9000, GNorm = 2.5394, lr_0 = 6.0454e-04
Validation rmse = 0.989408
Epoch 8
Loss = 2.4449e-03, PNorm = 101.9493, GNorm = 2.9756, lr_0 = 5.8498e-04
Loss = 2.4303e-03, PNorm = 101.9975, GNorm = 6.7118, lr_0 = 5.6605e-04
Loss = 3.0665e-03, PNorm = 102.0374, GNorm = 2.3838, lr_0 = 5.4774e-04
Validation rmse = 1.185304
Epoch 9
Loss = 2.9112e-03, PNorm = 102.0846, GNorm = 1.5577, lr_0 = 5.3001e-04
Loss = 2.5076e-03, PNorm = 102.1420, GNorm = 1.8696, lr_0 = 5.1286e-04
Validation rmse = 0.965663
Epoch 10
Loss = 1.9062e-03, PNorm = 102.1814, GNorm = 2.3028, lr_0 = 4.9627e-04
Loss = 1.7744e-03, PNorm = 102.2180, GNorm = 0.3242, lr_0 = 4.8021e-04
Loss = 2.3623e-03, PNorm = 102.2583, GNorm = 2.1600, lr_0 = 4.6467e-04
Validation rmse = 0.916231
Epoch 11
Loss = 1.5021e-03, PNorm = 102.2929, GNorm = 0.7338, lr_0 = 4.4963e-04
Loss = 2.0403e-03, PNorm = 102.3211, GNorm = 1.1533, lr_0 = 4.3508e-04
Validation rmse = 0.820937
Epoch 12
Loss = 1.6920e-03, PNorm = 102.3475, GNorm = 0.6223, lr_0 = 4.1962e-04
Loss = 1.9505e-03, PNorm = 102.3727, GNorm = 1.8253, lr_0 = 4.0604e-04
Loss = 1.8658e-03, PNorm = 102.4005, GNorm = 2.0322, lr_0 = 3.9290e-04
Validation rmse = 0.999666
Epoch 13
Loss = 1.8552e-03, PNorm = 102.4310, GNorm = 2.2618, lr_0 = 3.8019e-04
Loss = 1.5951e-03, PNorm = 102.4522, GNorm = 0.6171, lr_0 = 3.6789e-04
Loss = 1.5145e-03, PNorm = 102.4789, GNorm = 0.3779, lr_0 = 3.5598e-04
Validation rmse = 0.843252
Epoch 14
Loss = 1.8083e-03, PNorm = 102.5094, GNorm = 1.5739, lr_0 = 3.4446e-04
Loss = 2.1000e-03, PNorm = 102.5375, GNorm = 1.4061, lr_0 = 3.3332e-04
Validation rmse = 0.951185
Epoch 15
Loss = 2.1565e-03, PNorm = 102.5663, GNorm = 2.0169, lr_0 = 3.2253e-04
Loss = 1.7449e-03, PNorm = 102.5908, GNorm = 0.7359, lr_0 = 3.1209e-04
Loss = 1.3136e-03, PNorm = 102.6085, GNorm = 1.1492, lr_0 = 3.0200e-04
Validation rmse = 0.811331
Epoch 16
Loss = 1.5486e-03, PNorm = 102.6322, GNorm = 1.0112, lr_0 = 2.9222e-04
Loss = 1.1425e-03, PNorm = 102.6507, GNorm = 0.3420, lr_0 = 2.8277e-04
Validation rmse = 0.794584
Epoch 17
Loss = 1.2952e-03, PNorm = 102.6731, GNorm = 0.6772, lr_0 = 2.7272e-04
Loss = 1.4080e-03, PNorm = 102.6925, GNorm = 2.2581, lr_0 = 2.6389e-04
Loss = 1.3484e-03, PNorm = 102.7160, GNorm = 0.6045, lr_0 = 2.5535e-04
Validation rmse = 0.853004
Epoch 18
Loss = 1.2467e-03, PNorm = 102.7347, GNorm = 2.8713, lr_0 = 2.4709e-04
Loss = 1.1831e-03, PNorm = 102.7542, GNorm = 1.2173, lr_0 = 2.3910e-04
Loss = 1.3291e-03, PNorm = 102.7664, GNorm = 0.9204, lr_0 = 2.3136e-04
Validation rmse = 0.866473
Epoch 19
Loss = 1.1585e-03, PNorm = 102.7820, GNorm = 0.5201, lr_0 = 2.2387e-04
Loss = 1.4347e-03, PNorm = 102.8008, GNorm = 2.6504, lr_0 = 2.1663e-04
Validation rmse = 0.839130
Epoch 20
Loss = 1.3023e-03, PNorm = 102.8174, GNorm = 1.9452, lr_0 = 2.0962e-04
Loss = 1.5683e-03, PNorm = 102.8355, GNorm = 2.2096, lr_0 = 2.0283e-04
Loss = 1.1728e-03, PNorm = 102.8496, GNorm = 0.8589, lr_0 = 1.9627e-04
Validation rmse = 0.807372
Epoch 21
Loss = 9.8954e-04, PNorm = 102.8639, GNorm = 0.3646, lr_0 = 1.8992e-04
Loss = 1.0635e-03, PNorm = 102.8764, GNorm = 0.8613, lr_0 = 1.8377e-04
Validation rmse = 0.785828
Epoch 22
Loss = 1.0690e-03, PNorm = 102.8888, GNorm = 0.3984, lr_0 = 1.7783e-04
Loss = 7.2201e-04, PNorm = 102.9017, GNorm = 1.9242, lr_0 = 1.7207e-04
Loss = 1.1992e-03, PNorm = 102.9142, GNorm = 1.2466, lr_0 = 1.6651e-04
Validation rmse = 0.883561
Epoch 23
Loss = 9.7082e-04, PNorm = 102.9277, GNorm = 0.7737, lr_0 = 1.6059e-04
Loss = 8.9697e-04, PNorm = 102.9412, GNorm = 1.0843, lr_0 = 1.5539e-04
Validation rmse = 0.764960
Epoch 24
Loss = 7.5114e-04, PNorm = 102.9508, GNorm = 0.8205, lr_0 = 1.5036e-04
Loss = 9.9877e-04, PNorm = 102.9645, GNorm = 0.3323, lr_0 = 1.4550e-04
Loss = 8.9588e-04, PNorm = 102.9754, GNorm = 0.6558, lr_0 = 1.4079e-04
Validation rmse = 0.771832
Epoch 25
Loss = 8.3743e-04, PNorm = 102.9847, GNorm = 0.7208, lr_0 = 1.3623e-04
Loss = 8.5710e-04, PNorm = 102.9952, GNorm = 0.3163, lr_0 = 1.3183e-04
Loss = 9.0389e-04, PNorm = 103.0059, GNorm = 1.4367, lr_0 = 1.2756e-04
Validation rmse = 0.781471
Epoch 26
Loss = 9.4668e-04, PNorm = 103.0160, GNorm = 1.7661, lr_0 = 1.2343e-04
Loss = 7.5628e-04, PNorm = 103.0242, GNorm = 0.8254, lr_0 = 1.1944e-04
Validation rmse = 0.777956
Epoch 27
Loss = 6.5702e-04, PNorm = 103.0312, GNorm = 0.4710, lr_0 = 1.1557e-04
Loss = 8.2981e-04, PNorm = 103.0408, GNorm = 1.8625, lr_0 = 1.1183e-04
Loss = 8.0268e-04, PNorm = 103.0478, GNorm = 0.6663, lr_0 = 1.0821e-04
Validation rmse = 0.761338
Epoch 28
Loss = 9.5610e-04, PNorm = 103.0580, GNorm = 2.1988, lr_0 = 1.0437e-04
Loss = 6.7936e-04, PNorm = 103.0661, GNorm = 0.4328, lr_0 = 1.0099e-04
Validation rmse = 0.761764
Epoch 29
Loss = 4.3070e-04, PNorm = 103.0738, GNorm = 0.7636, lr_0 = 1.0000e-04
Loss = 7.6306e-04, PNorm = 103.0828, GNorm = 0.7904, lr_0 = 1.0000e-04
Loss = 7.2843e-04, PNorm = 103.0914, GNorm = 0.3456, lr_0 = 1.0000e-04
Validation rmse = 0.770412
Model 0 best validation rmse = 0.761338 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.668297
Ensemble test rmse = 0.668297
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2400, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,721,601
Moving model to cuda
Epoch 0
Loss = 1.9433e-02, PNorm = 99.7620, GNorm = 1.4044, lr_0 = 2.9800e-04
Loss = 1.7304e-02, PNorm = 99.8505, GNorm = 9.3143, lr_0 = 4.7800e-04
Validation rmse = 2.114775
Epoch 1
Loss = 1.1979e-02, PNorm = 100.0331, GNorm = 4.4724, lr_0 = 6.7600e-04
Loss = 9.9885e-03, PNorm = 100.2487, GNorm = 7.3068, lr_0 = 8.5600e-04
Loss = 9.3615e-03, PNorm = 100.4894, GNorm = 4.1513, lr_0 = 9.9344e-04
Validation rmse = 1.848473
Epoch 2
Loss = 7.5444e-03, PNorm = 100.7249, GNorm = 2.5700, lr_0 = 9.6130e-04
Loss = 6.3565e-03, PNorm = 100.8773, GNorm = 0.9982, lr_0 = 9.3019e-04
Validation rmse = 1.409461
Epoch 3
Loss = 6.0284e-03, PNorm = 101.0061, GNorm = 1.3352, lr_0 = 9.0009e-04
Loss = 4.5016e-03, PNorm = 101.1308, GNorm = 7.6805, lr_0 = 8.7096e-04
Loss = 3.7020e-03, PNorm = 101.2177, GNorm = 1.3371, lr_0 = 8.4278e-04
Validation rmse = 1.097232
Epoch 4
Loss = 3.2677e-03, PNorm = 101.2927, GNorm = 2.5843, lr_0 = 8.1551e-04
Loss = 4.3455e-03, PNorm = 101.3377, GNorm = 3.7537, lr_0 = 7.8912e-04
Validation rmse = 1.118250
Epoch 5
Loss = 2.6162e-03, PNorm = 101.4015, GNorm = 2.8362, lr_0 = 7.6358e-04
Loss = 3.2156e-03, PNorm = 101.4602, GNorm = 3.4418, lr_0 = 7.3888e-04
Loss = 3.0783e-03, PNorm = 101.5142, GNorm = 2.1682, lr_0 = 7.1497e-04
Validation rmse = 1.048678
Epoch 6
Loss = 2.7797e-03, PNorm = 101.5735, GNorm = 1.5552, lr_0 = 6.8956e-04
Loss = 3.2877e-03, PNorm = 101.6263, GNorm = 6.6992, lr_0 = 6.6725e-04
Loss = 3.9500e-03, PNorm = 101.6774, GNorm = 2.4224, lr_0 = 6.4565e-04
Validation rmse = 1.071660
Epoch 7
Loss = 3.1641e-03, PNorm = 101.7330, GNorm = 2.6316, lr_0 = 6.2476e-04
Loss = 2.4050e-03, PNorm = 101.7789, GNorm = 0.9852, lr_0 = 6.0454e-04
Validation rmse = 1.019502
Epoch 8
Loss = 2.3656e-03, PNorm = 101.8113, GNorm = 2.6303, lr_0 = 5.8498e-04
Loss = 2.3600e-03, PNorm = 101.8495, GNorm = 1.2968, lr_0 = 5.6605e-04
Loss = 3.8235e-03, PNorm = 101.8894, GNorm = 3.8073, lr_0 = 5.4774e-04
Validation rmse = 1.127827
Epoch 9
Loss = 4.5647e-03, PNorm = 101.9462, GNorm = 9.0923, lr_0 = 5.3001e-04
Loss = 3.1312e-03, PNorm = 102.0055, GNorm = 1.2761, lr_0 = 5.1286e-04
Validation rmse = 1.051700
Epoch 10
Loss = 3.1671e-03, PNorm = 102.0544, GNorm = 3.4567, lr_0 = 4.9627e-04
Loss = 2.4948e-03, PNorm = 102.0938, GNorm = 0.7312, lr_0 = 4.8021e-04
Loss = 1.7598e-03, PNorm = 102.1213, GNorm = 0.7233, lr_0 = 4.6467e-04
Validation rmse = 1.061712
Epoch 11
Loss = 2.0918e-03, PNorm = 102.1510, GNorm = 0.8194, lr_0 = 4.4963e-04
Loss = 1.7527e-03, PNorm = 102.1763, GNorm = 0.6833, lr_0 = 4.3508e-04
Validation rmse = 0.981827
Epoch 12
Loss = 1.6594e-03, PNorm = 102.2086, GNorm = 1.1246, lr_0 = 4.1962e-04
Loss = 1.4292e-03, PNorm = 102.2318, GNorm = 0.7979, lr_0 = 4.0604e-04
Loss = 1.8177e-03, PNorm = 102.2505, GNorm = 1.9665, lr_0 = 3.9290e-04
Validation rmse = 1.035435
Epoch 13
Loss = 2.1110e-03, PNorm = 102.2821, GNorm = 2.3795, lr_0 = 3.8019e-04
Loss = 1.8652e-03, PNorm = 102.3066, GNorm = 0.7088, lr_0 = 3.6789e-04
Loss = 1.8229e-03, PNorm = 102.3326, GNorm = 0.5611, lr_0 = 3.5598e-04
Validation rmse = 0.994796
Epoch 14
Loss = 1.7051e-03, PNorm = 102.3593, GNorm = 0.3153, lr_0 = 3.4446e-04
Loss = 1.3325e-03, PNorm = 102.3784, GNorm = 0.6637, lr_0 = 3.3332e-04
Validation rmse = 0.999336
Epoch 15
Loss = 1.0485e-03, PNorm = 102.4003, GNorm = 1.0119, lr_0 = 3.2253e-04
Loss = 2.0175e-03, PNorm = 102.4248, GNorm = 0.3966, lr_0 = 3.1209e-04
Loss = 1.5709e-03, PNorm = 102.4507, GNorm = 2.6205, lr_0 = 3.0200e-04
Validation rmse = 1.017295
Epoch 16
Loss = 1.2815e-03, PNorm = 102.4710, GNorm = 1.0972, lr_0 = 2.9222e-04
Loss = 1.4857e-03, PNorm = 102.4908, GNorm = 0.9477, lr_0 = 2.8277e-04
Validation rmse = 0.959461
Epoch 17
Loss = 1.2118e-03, PNorm = 102.5146, GNorm = 1.1786, lr_0 = 2.7272e-04
Loss = 1.3727e-03, PNorm = 102.5311, GNorm = 0.4257, lr_0 = 2.6389e-04
Loss = 1.1654e-03, PNorm = 102.5468, GNorm = 0.3351, lr_0 = 2.5535e-04
Validation rmse = 1.013173
Epoch 18
Loss = 1.5109e-03, PNorm = 102.5657, GNorm = 1.6237, lr_0 = 2.4709e-04
Loss = 1.0682e-03, PNorm = 102.5837, GNorm = 0.9257, lr_0 = 2.3910e-04
Loss = 1.1430e-03, PNorm = 102.5976, GNorm = 0.4326, lr_0 = 2.3136e-04
Validation rmse = 0.948529
Epoch 19
Loss = 1.0658e-03, PNorm = 102.6105, GNorm = 0.6355, lr_0 = 2.2387e-04
Loss = 1.0615e-03, PNorm = 102.6272, GNorm = 1.9811, lr_0 = 2.1663e-04
Validation rmse = 0.973158
Epoch 20
Loss = 1.0458e-03, PNorm = 102.6416, GNorm = 0.9477, lr_0 = 2.0962e-04
Loss = 1.0447e-03, PNorm = 102.6560, GNorm = 1.1551, lr_0 = 2.0283e-04
Loss = 1.1961e-03, PNorm = 102.6728, GNorm = 1.3232, lr_0 = 1.9627e-04
Validation rmse = 0.959264
Epoch 21
Loss = 1.0075e-03, PNorm = 102.6877, GNorm = 0.4611, lr_0 = 1.8992e-04
Loss = 9.5125e-04, PNorm = 102.7012, GNorm = 1.0390, lr_0 = 1.8377e-04
Validation rmse = 0.953682
Epoch 22
Loss = 8.6367e-04, PNorm = 102.7107, GNorm = 1.0346, lr_0 = 1.7783e-04
Loss = 8.8180e-04, PNorm = 102.7247, GNorm = 1.1809, lr_0 = 1.7207e-04
Loss = 1.1292e-03, PNorm = 102.7392, GNorm = 1.2954, lr_0 = 1.6651e-04
Validation rmse = 0.950463
Epoch 23
Loss = 8.7983e-04, PNorm = 102.7504, GNorm = 0.7215, lr_0 = 1.6059e-04
Loss = 1.0598e-03, PNorm = 102.7609, GNorm = 1.5828, lr_0 = 1.5539e-04
Validation rmse = 0.963613
Epoch 24
Loss = 6.9353e-04, PNorm = 102.7725, GNorm = 0.5834, lr_0 = 1.5036e-04
Loss = 8.5357e-04, PNorm = 102.7845, GNorm = 0.7973, lr_0 = 1.4550e-04
Loss = 9.9764e-04, PNorm = 102.7958, GNorm = 1.2928, lr_0 = 1.4079e-04
Validation rmse = 0.946667
Epoch 25
Loss = 9.9237e-04, PNorm = 102.8050, GNorm = 0.7254, lr_0 = 1.3623e-04
Loss = 6.2568e-04, PNorm = 102.8143, GNorm = 0.3996, lr_0 = 1.3183e-04
Loss = 9.7919e-04, PNorm = 102.8238, GNorm = 0.5807, lr_0 = 1.2756e-04
Validation rmse = 0.948851
Epoch 26
Loss = 7.9702e-04, PNorm = 102.8332, GNorm = 1.6182, lr_0 = 1.2343e-04
Loss = 8.7035e-04, PNorm = 102.8438, GNorm = 0.7104, lr_0 = 1.1944e-04
Validation rmse = 0.934267
Epoch 27
Loss = 8.1095e-04, PNorm = 102.8535, GNorm = 0.4755, lr_0 = 1.1557e-04
Loss = 7.3165e-04, PNorm = 102.8628, GNorm = 1.1888, lr_0 = 1.1183e-04
Loss = 8.2199e-04, PNorm = 102.8719, GNorm = 1.1051, lr_0 = 1.0821e-04
Validation rmse = 0.970696
Epoch 28
Loss = 8.4780e-04, PNorm = 102.8800, GNorm = 0.3751, lr_0 = 1.0437e-04
Loss = 7.5173e-04, PNorm = 102.8882, GNorm = 1.2288, lr_0 = 1.0099e-04
Validation rmse = 0.940873
Epoch 29
Loss = 6.1416e-04, PNorm = 102.8959, GNorm = 0.3094, lr_0 = 1.0000e-04
Loss = 7.2339e-04, PNorm = 102.9024, GNorm = 1.0263, lr_0 = 1.0000e-04
Loss = 9.1362e-04, PNorm = 102.9115, GNorm = 0.6561, lr_0 = 1.0000e-04
Validation rmse = 0.946030
Model 0 best validation rmse = 0.934267 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.743440
Ensemble test rmse = 0.743440
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2400, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,721,601
Moving model to cuda
Epoch 0
Loss = 1.7986e-02, PNorm = 99.7601, GNorm = 2.8145, lr_0 = 2.9800e-04
Loss = 1.2178e-02, PNorm = 99.8530, GNorm = 6.7343, lr_0 = 4.7800e-04
Validation rmse = 1.556492
Epoch 1
Loss = 1.0431e-02, PNorm = 100.0186, GNorm = 4.0998, lr_0 = 6.7600e-04
Loss = 8.3430e-03, PNorm = 100.2207, GNorm = 0.8040, lr_0 = 8.5600e-04
Loss = 7.2869e-03, PNorm = 100.4637, GNorm = 3.7598, lr_0 = 9.9344e-04
Validation rmse = 1.399686
Epoch 2
Loss = 7.6133e-03, PNorm = 100.6867, GNorm = 9.4999, lr_0 = 9.6130e-04
Loss = 6.6417e-03, PNorm = 100.8537, GNorm = 1.7548, lr_0 = 9.3019e-04
Validation rmse = 1.052511
Epoch 3
Loss = 4.9146e-03, PNorm = 100.9964, GNorm = 5.2621, lr_0 = 9.0009e-04
Loss = 4.2290e-03, PNorm = 101.1135, GNorm = 1.6323, lr_0 = 8.7096e-04
Loss = 5.9007e-03, PNorm = 101.2206, GNorm = 1.1323, lr_0 = 8.4278e-04
Validation rmse = 1.078889
Epoch 4
Loss = 3.7845e-03, PNorm = 101.3081, GNorm = 1.3162, lr_0 = 8.1551e-04
Loss = 4.1844e-03, PNorm = 101.3750, GNorm = 1.9421, lr_0 = 7.8912e-04
Validation rmse = 0.870935
Epoch 5
Loss = 3.7337e-03, PNorm = 101.4555, GNorm = 0.9357, lr_0 = 7.6358e-04
Loss = 3.5358e-03, PNorm = 101.5403, GNorm = 2.1995, lr_0 = 7.3888e-04
Loss = 3.5738e-03, PNorm = 101.5984, GNorm = 2.6308, lr_0 = 7.1497e-04
Validation rmse = 0.898491
Epoch 6
Loss = 3.1661e-03, PNorm = 101.6658, GNorm = 0.8216, lr_0 = 6.8956e-04
Loss = 2.5785e-03, PNorm = 101.7253, GNorm = 1.5637, lr_0 = 6.6725e-04
Loss = 2.7980e-03, PNorm = 101.7817, GNorm = 0.7035, lr_0 = 6.4565e-04
Validation rmse = 0.791624
Epoch 7
Loss = 2.7179e-03, PNorm = 101.8449, GNorm = 4.8570, lr_0 = 6.2476e-04
Loss = 2.6906e-03, PNorm = 101.8766, GNorm = 0.5266, lr_0 = 6.0454e-04
Validation rmse = 0.826205
Epoch 8
Loss = 2.4287e-03, PNorm = 101.9193, GNorm = 4.8156, lr_0 = 5.8498e-04
Loss = 2.4694e-03, PNorm = 101.9654, GNorm = 3.0284, lr_0 = 5.6605e-04
Loss = 2.4768e-03, PNorm = 102.0126, GNorm = 2.6053, lr_0 = 5.4774e-04
Validation rmse = 1.034964
Epoch 9
Loss = 2.4668e-03, PNorm = 102.0580, GNorm = 0.4666, lr_0 = 5.3001e-04
Loss = 2.2726e-03, PNorm = 102.0996, GNorm = 2.9071, lr_0 = 5.1286e-04
Validation rmse = 0.813521
Epoch 10
Loss = 2.0960e-03, PNorm = 102.1321, GNorm = 3.4806, lr_0 = 4.9627e-04
Loss = 1.4121e-03, PNorm = 102.1709, GNorm = 1.1856, lr_0 = 4.8021e-04
Loss = 1.9116e-03, PNorm = 102.2005, GNorm = 1.8333, lr_0 = 4.6467e-04
Validation rmse = 0.799463
Epoch 11
Loss = 2.3089e-03, PNorm = 102.2329, GNorm = 3.4585, lr_0 = 4.4963e-04
Loss = 1.6765e-03, PNorm = 102.2697, GNorm = 0.4938, lr_0 = 4.3508e-04
Validation rmse = 0.748854
Epoch 12
Loss = 2.1009e-03, PNorm = 102.3007, GNorm = 2.3467, lr_0 = 4.1962e-04
Loss = 1.5303e-03, PNorm = 102.3345, GNorm = 1.7540, lr_0 = 4.0604e-04
Loss = 1.8606e-03, PNorm = 102.3591, GNorm = 0.8031, lr_0 = 3.9290e-04
Validation rmse = 0.799850
Epoch 13
Loss = 1.6979e-03, PNorm = 102.3855, GNorm = 1.6982, lr_0 = 3.8019e-04
Loss = 1.4990e-03, PNorm = 102.4106, GNorm = 2.5546, lr_0 = 3.6789e-04
Loss = 2.0516e-03, PNorm = 102.4337, GNorm = 4.8352, lr_0 = 3.5598e-04
Validation rmse = 0.784594
Epoch 14
Loss = 1.4256e-03, PNorm = 102.4593, GNorm = 0.8520, lr_0 = 3.4446e-04
Loss = 1.4152e-03, PNorm = 102.4877, GNorm = 0.4275, lr_0 = 3.3332e-04
Validation rmse = 0.726978
Epoch 15
Loss = 6.7861e-04, PNorm = 102.5091, GNorm = 0.6634, lr_0 = 3.2253e-04
Loss = 1.4059e-03, PNorm = 102.5290, GNorm = 1.3333, lr_0 = 3.1209e-04
Loss = 1.4214e-03, PNorm = 102.5481, GNorm = 1.5173, lr_0 = 3.0200e-04
Validation rmse = 0.939940
Epoch 16
Loss = 1.3277e-03, PNorm = 102.5661, GNorm = 3.3669, lr_0 = 2.9222e-04
Loss = 1.6621e-03, PNorm = 102.5942, GNorm = 3.5365, lr_0 = 2.8277e-04
Validation rmse = 0.899311
Epoch 17
Loss = 1.5836e-03, PNorm = 102.6201, GNorm = 3.6547, lr_0 = 2.7272e-04
Loss = 1.2709e-03, PNorm = 102.6376, GNorm = 2.4415, lr_0 = 2.6389e-04
Loss = 1.5112e-03, PNorm = 102.6557, GNorm = 2.9275, lr_0 = 2.5535e-04
Validation rmse = 0.758421
Epoch 18
Loss = 9.9787e-04, PNorm = 102.6738, GNorm = 0.7173, lr_0 = 2.4709e-04
Loss = 1.1339e-03, PNorm = 102.6886, GNorm = 1.1859, lr_0 = 2.3910e-04
Loss = 1.2362e-03, PNorm = 102.7001, GNorm = 2.3904, lr_0 = 2.3136e-04
Validation rmse = 0.774990
Epoch 19
Loss = 1.1664e-03, PNorm = 102.7156, GNorm = 3.5138, lr_0 = 2.2387e-04
Loss = 1.1211e-03, PNorm = 102.7313, GNorm = 0.9657, lr_0 = 2.1663e-04
Validation rmse = 0.724331
Epoch 20
Loss = 1.1246e-03, PNorm = 102.7446, GNorm = 0.4694, lr_0 = 2.0962e-04
Loss = 9.9924e-04, PNorm = 102.7584, GNorm = 2.6405, lr_0 = 2.0283e-04
Loss = 9.7708e-04, PNorm = 102.7715, GNorm = 0.4198, lr_0 = 1.9627e-04
Validation rmse = 0.708442
Epoch 21
Loss = 1.0522e-03, PNorm = 102.7827, GNorm = 2.2151, lr_0 = 1.8992e-04
Loss = 9.5413e-04, PNorm = 102.7937, GNorm = 0.9600, lr_0 = 1.8377e-04
Validation rmse = 0.735592
Epoch 22
Loss = 1.0076e-03, PNorm = 102.8063, GNorm = 0.8466, lr_0 = 1.7783e-04
Loss = 8.4898e-04, PNorm = 102.8183, GNorm = 0.8467, lr_0 = 1.7207e-04
Loss = 8.9483e-04, PNorm = 102.8294, GNorm = 0.9122, lr_0 = 1.6651e-04
Validation rmse = 0.746711
Epoch 23
Loss = 7.1761e-04, PNorm = 102.8401, GNorm = 0.7975, lr_0 = 1.6059e-04
Loss = 8.4091e-04, PNorm = 102.8504, GNorm = 0.5134, lr_0 = 1.5539e-04
Validation rmse = 0.743820
Epoch 24
Loss = 5.1698e-04, PNorm = 102.8592, GNorm = 0.7851, lr_0 = 1.5036e-04
Loss = 8.2952e-04, PNorm = 102.8684, GNorm = 0.7579, lr_0 = 1.4550e-04
Loss = 8.9770e-04, PNorm = 102.8777, GNorm = 1.0675, lr_0 = 1.4079e-04
Validation rmse = 0.712500
Epoch 25
Loss = 5.6305e-04, PNorm = 102.8881, GNorm = 0.5048, lr_0 = 1.3623e-04
Loss = 7.3921e-04, PNorm = 102.8967, GNorm = 0.5333, lr_0 = 1.3183e-04
Loss = 9.0500e-04, PNorm = 102.9054, GNorm = 0.7440, lr_0 = 1.2756e-04
Validation rmse = 0.717319
Epoch 26
Loss = 6.9780e-04, PNorm = 102.9123, GNorm = 0.5544, lr_0 = 1.2343e-04
Loss = 7.8340e-04, PNorm = 102.9205, GNorm = 0.9412, lr_0 = 1.1944e-04
Validation rmse = 0.694543
Epoch 27
Loss = 6.6925e-04, PNorm = 102.9285, GNorm = 1.0173, lr_0 = 1.1557e-04
Loss = 8.4201e-04, PNorm = 102.9389, GNorm = 0.3960, lr_0 = 1.1183e-04
Loss = 7.6537e-04, PNorm = 102.9481, GNorm = 0.4119, lr_0 = 1.0821e-04
Validation rmse = 0.718353
Epoch 28
Loss = 6.6734e-04, PNorm = 102.9545, GNorm = 0.3417, lr_0 = 1.0437e-04
Loss = 7.3649e-04, PNorm = 102.9617, GNorm = 0.6307, lr_0 = 1.0099e-04
Validation rmse = 0.705761
Epoch 29
Loss = 6.0152e-04, PNorm = 102.9692, GNorm = 0.5603, lr_0 = 1.0000e-04
Loss = 6.7944e-04, PNorm = 102.9759, GNorm = 1.3014, lr_0 = 1.0000e-04
Loss = 8.2718e-04, PNorm = 102.9838, GNorm = 1.6433, lr_0 = 1.0000e-04
Validation rmse = 0.682693
Model 0 best validation rmse = 0.682693 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.696389
Ensemble test rmse = 0.696389
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2400, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,721,601
Moving model to cuda
Epoch 0
Loss = 2.0396e-02, PNorm = 99.7669, GNorm = 1.0725, lr_0 = 2.9800e-04
Loss = 1.2207e-02, PNorm = 99.8708, GNorm = 1.4959, lr_0 = 4.7800e-04
Validation rmse = 2.279708
Epoch 1
Loss = 1.4497e-02, PNorm = 100.0341, GNorm = 4.0579, lr_0 = 6.7600e-04
Loss = 1.0671e-02, PNorm = 100.2429, GNorm = 4.4169, lr_0 = 8.5600e-04
Loss = 1.0464e-02, PNorm = 100.4735, GNorm = 1.0547, lr_0 = 9.9344e-04
Validation rmse = 1.828813
Epoch 2
Loss = 7.2772e-03, PNorm = 100.7081, GNorm = 2.9003, lr_0 = 9.6130e-04
Loss = 5.8382e-03, PNorm = 100.8800, GNorm = 2.1576, lr_0 = 9.3019e-04
Validation rmse = 1.259079
Epoch 3
Loss = 4.1722e-03, PNorm = 101.0203, GNorm = 1.2561, lr_0 = 9.0009e-04
Loss = 4.7407e-03, PNorm = 101.1315, GNorm = 2.7454, lr_0 = 8.7096e-04
Loss = 4.8863e-03, PNorm = 101.2235, GNorm = 3.5569, lr_0 = 8.4278e-04
Validation rmse = 1.101464
Epoch 4
Loss = 5.3428e-03, PNorm = 101.2982, GNorm = 5.1065, lr_0 = 8.1551e-04
Loss = 4.6476e-03, PNorm = 101.3849, GNorm = 0.4523, lr_0 = 7.8912e-04
Validation rmse = 1.076915
Epoch 5
Loss = 1.5092e-03, PNorm = 101.4485, GNorm = 0.6488, lr_0 = 7.6358e-04
Loss = 3.0854e-03, PNorm = 101.4937, GNorm = 4.4728, lr_0 = 7.3888e-04
Loss = 4.2538e-03, PNorm = 101.5412, GNorm = 1.1549, lr_0 = 7.1497e-04
Validation rmse = 1.079869
Epoch 6
Loss = 2.8788e-03, PNorm = 101.6080, GNorm = 1.3417, lr_0 = 6.8956e-04
Loss = 2.9683e-03, PNorm = 101.6652, GNorm = 0.9171, lr_0 = 6.6725e-04
Loss = 3.1562e-03, PNorm = 101.7005, GNorm = 1.6200, lr_0 = 6.4565e-04
Validation rmse = 0.978355
Epoch 7
Loss = 2.9344e-03, PNorm = 101.7458, GNorm = 1.5915, lr_0 = 6.2476e-04
Loss = 2.5635e-03, PNorm = 101.7887, GNorm = 0.4202, lr_0 = 6.0454e-04
Validation rmse = 0.933487
Epoch 8
Loss = 2.1135e-03, PNorm = 101.8266, GNorm = 0.7261, lr_0 = 5.8498e-04
Loss = 2.7092e-03, PNorm = 101.8676, GNorm = 1.1184, lr_0 = 5.6605e-04
Loss = 2.1636e-03, PNorm = 101.9020, GNorm = 1.5669, lr_0 = 5.4774e-04
Validation rmse = 0.974395
Epoch 9
Loss = 2.3608e-03, PNorm = 101.9326, GNorm = 0.9732, lr_0 = 5.3001e-04
Loss = 2.6660e-03, PNorm = 101.9786, GNorm = 1.5050, lr_0 = 5.1286e-04
Validation rmse = 0.918145
Epoch 10
Loss = 2.0095e-03, PNorm = 102.0132, GNorm = 2.2872, lr_0 = 4.9627e-04
Loss = 2.5691e-03, PNorm = 102.0520, GNorm = 1.9745, lr_0 = 4.8021e-04
Loss = 2.6926e-03, PNorm = 102.0844, GNorm = 0.6539, lr_0 = 4.6467e-04
Validation rmse = 0.939042
Epoch 11
Loss = 2.0370e-03, PNorm = 102.1175, GNorm = 1.3604, lr_0 = 4.4963e-04
Loss = 1.7680e-03, PNorm = 102.1548, GNorm = 1.4506, lr_0 = 4.3508e-04
Validation rmse = 0.852752
Epoch 12
Loss = 1.5340e-03, PNorm = 102.1860, GNorm = 1.0364, lr_0 = 4.1962e-04
Loss = 1.7528e-03, PNorm = 102.2088, GNorm = 3.6362, lr_0 = 4.0604e-04
Loss = 1.8810e-03, PNorm = 102.2422, GNorm = 2.7752, lr_0 = 3.9290e-04
Validation rmse = 0.866665
Epoch 13
Loss = 1.4188e-03, PNorm = 102.2662, GNorm = 0.8231, lr_0 = 3.8019e-04
Loss = 1.5869e-03, PNorm = 102.2941, GNorm = 0.5167, lr_0 = 3.6789e-04
Loss = 1.7915e-03, PNorm = 102.3197, GNorm = 0.9887, lr_0 = 3.5598e-04
Validation rmse = 0.855546
Epoch 14
Loss = 1.5341e-03, PNorm = 102.3467, GNorm = 1.2535, lr_0 = 3.4446e-04
Loss = 1.4980e-03, PNorm = 102.3746, GNorm = 1.2989, lr_0 = 3.3332e-04
Validation rmse = 0.857665
Epoch 15
Loss = 1.7006e-03, PNorm = 102.3941, GNorm = 1.1821, lr_0 = 3.2253e-04
Loss = 1.6761e-03, PNorm = 102.4155, GNorm = 1.9699, lr_0 = 3.1209e-04
Loss = 1.3600e-03, PNorm = 102.4380, GNorm = 1.8827, lr_0 = 3.0200e-04
Validation rmse = 0.886874
Epoch 16
Loss = 1.5444e-03, PNorm = 102.4623, GNorm = 1.1945, lr_0 = 2.9222e-04
Loss = 1.4087e-03, PNorm = 102.4867, GNorm = 0.6196, lr_0 = 2.8277e-04
Validation rmse = 0.875462
Epoch 17
Loss = 1.0673e-03, PNorm = 102.5095, GNorm = 0.9507, lr_0 = 2.7272e-04
Loss = 1.3216e-03, PNorm = 102.5313, GNorm = 1.0708, lr_0 = 2.6389e-04
Loss = 1.2741e-03, PNorm = 102.5502, GNorm = 0.5477, lr_0 = 2.5535e-04
Validation rmse = 0.868831
Epoch 18
Loss = 1.1726e-03, PNorm = 102.5666, GNorm = 1.6219, lr_0 = 2.4709e-04
Loss = 1.4756e-03, PNorm = 102.5816, GNorm = 2.5636, lr_0 = 2.3910e-04
Loss = 1.9373e-03, PNorm = 102.6031, GNorm = 0.9369, lr_0 = 2.3136e-04
Validation rmse = 0.902407
Epoch 19
Loss = 1.3942e-03, PNorm = 102.6227, GNorm = 0.6365, lr_0 = 2.2387e-04
Loss = 1.1875e-03, PNorm = 102.6378, GNorm = 3.6562, lr_0 = 2.1663e-04
Validation rmse = 0.892097
Epoch 20
Loss = 1.3172e-03, PNorm = 102.6551, GNorm = 0.5125, lr_0 = 2.0962e-04
Loss = 1.1750e-03, PNorm = 102.6725, GNorm = 1.7280, lr_0 = 2.0283e-04
Loss = 1.2545e-03, PNorm = 102.6885, GNorm = 1.6981, lr_0 = 1.9627e-04
Validation rmse = 0.871260
Epoch 21
Loss = 8.9841e-04, PNorm = 102.7024, GNorm = 0.4851, lr_0 = 1.8992e-04
Loss = 1.0558e-03, PNorm = 102.7159, GNorm = 0.5546, lr_0 = 1.8377e-04
Validation rmse = 0.876173
Epoch 22
Loss = 1.1155e-03, PNorm = 102.7303, GNorm = 1.9386, lr_0 = 1.7783e-04
Loss = 9.2755e-04, PNorm = 102.7448, GNorm = 0.6377, lr_0 = 1.7207e-04
Loss = 1.1224e-03, PNorm = 102.7579, GNorm = 1.9513, lr_0 = 1.6651e-04
Validation rmse = 0.867459
Epoch 23
Loss = 1.1177e-03, PNorm = 102.7708, GNorm = 1.4660, lr_0 = 1.6059e-04
Loss = 1.0197e-03, PNorm = 102.7838, GNorm = 1.1438, lr_0 = 1.5539e-04
Validation rmse = 0.869528
Epoch 24
Loss = 7.9940e-04, PNorm = 102.7976, GNorm = 1.3433, lr_0 = 1.5036e-04
Loss = 1.0847e-03, PNorm = 102.8090, GNorm = 0.9840, lr_0 = 1.4550e-04
Loss = 8.5472e-04, PNorm = 102.8193, GNorm = 0.5502, lr_0 = 1.4079e-04
Validation rmse = 0.861058
Epoch 25
Loss = 8.1970e-04, PNorm = 102.8285, GNorm = 0.3718, lr_0 = 1.3623e-04
Loss = 9.3559e-04, PNorm = 102.8366, GNorm = 2.3870, lr_0 = 1.3183e-04
Loss = 9.7066e-04, PNorm = 102.8476, GNorm = 1.0590, lr_0 = 1.2756e-04
Validation rmse = 0.906686
Epoch 26
Loss = 1.0514e-03, PNorm = 102.8596, GNorm = 1.1554, lr_0 = 1.2343e-04
Loss = 8.7777e-04, PNorm = 102.8695, GNorm = 0.6605, lr_0 = 1.1944e-04
Validation rmse = 0.911459
Epoch 27
Loss = 1.0275e-03, PNorm = 102.8785, GNorm = 1.4838, lr_0 = 1.1557e-04
Loss = 8.2047e-04, PNorm = 102.8858, GNorm = 0.5258, lr_0 = 1.1183e-04
Loss = 8.7233e-04, PNorm = 102.8929, GNorm = 0.9601, lr_0 = 1.0821e-04
Validation rmse = 0.855606
Epoch 28
Loss = 9.5569e-04, PNorm = 102.9030, GNorm = 1.5722, lr_0 = 1.0437e-04
Loss = 8.3634e-04, PNorm = 102.9108, GNorm = 0.9228, lr_0 = 1.0099e-04
Validation rmse = 0.874495
Epoch 29
Loss = 6.0536e-04, PNorm = 102.9188, GNorm = 1.0815, lr_0 = 1.0000e-04
Loss = 9.0643e-04, PNorm = 102.9262, GNorm = 0.7225, lr_0 = 1.0000e-04
Loss = 7.6714e-04, PNorm = 102.9328, GNorm = 0.6535, lr_0 = 1.0000e-04
Validation rmse = 0.894814
Model 0 best validation rmse = 0.852752 on epoch 11
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.790276
Ensemble test rmse = 0.790276
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2400, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,721,601
Moving model to cuda
Epoch 0
Loss = 1.8706e-02, PNorm = 99.7673, GNorm = 1.9934, lr_0 = 2.9800e-04
Loss = 1.4585e-02, PNorm = 99.8590, GNorm = 4.1217, lr_0 = 4.7800e-04
Validation rmse = 1.517024
Epoch 1
Loss = 8.2509e-03, PNorm = 100.0096, GNorm = 4.2853, lr_0 = 6.7600e-04
Loss = 8.2040e-03, PNorm = 100.1888, GNorm = 3.9800, lr_0 = 8.5600e-04
Loss = 7.8886e-03, PNorm = 100.4116, GNorm = 1.2314, lr_0 = 9.9344e-04
Validation rmse = 1.270320
Epoch 2
Loss = 6.1628e-03, PNorm = 100.6136, GNorm = 6.3697, lr_0 = 9.6130e-04
Loss = 6.3141e-03, PNorm = 100.8012, GNorm = 2.5500, lr_0 = 9.3019e-04
Validation rmse = 1.189688
Epoch 3
Loss = 4.2795e-03, PNorm = 100.9506, GNorm = 1.1762, lr_0 = 9.0009e-04
Loss = 5.0101e-03, PNorm = 101.0482, GNorm = 1.1629, lr_0 = 8.7096e-04
Loss = 4.8518e-03, PNorm = 101.1403, GNorm = 4.3312, lr_0 = 8.4278e-04
Validation rmse = 1.251417
Epoch 4
Loss = 4.3412e-03, PNorm = 101.2286, GNorm = 2.1685, lr_0 = 8.1551e-04
Loss = 4.5447e-03, PNorm = 101.3160, GNorm = 1.2964, lr_0 = 7.8912e-04
Validation rmse = 1.057358
Epoch 5
Loss = 2.8323e-03, PNorm = 101.3893, GNorm = 1.1243, lr_0 = 7.6358e-04
Loss = 3.8081e-03, PNorm = 101.4471, GNorm = 1.0120, lr_0 = 7.3888e-04
Loss = 2.6079e-03, PNorm = 101.4998, GNorm = 0.6620, lr_0 = 7.1497e-04
Validation rmse = 0.938822
Epoch 6
Loss = 2.8536e-03, PNorm = 101.5588, GNorm = 4.1741, lr_0 = 6.8956e-04
Loss = 3.9752e-03, PNorm = 101.6153, GNorm = 4.8059, lr_0 = 6.6725e-04
Loss = 2.8221e-03, PNorm = 101.6799, GNorm = 2.4936, lr_0 = 6.4565e-04
Validation rmse = 0.997840
Epoch 7
Loss = 2.3036e-03, PNorm = 101.7367, GNorm = 0.5042, lr_0 = 6.2476e-04
Loss = 2.4724e-03, PNorm = 101.7756, GNorm = 1.6180, lr_0 = 6.0454e-04
Validation rmse = 0.927157
Epoch 8
Loss = 2.4355e-03, PNorm = 101.8223, GNorm = 0.3785, lr_0 = 5.8498e-04
Loss = 2.3531e-03, PNorm = 101.8746, GNorm = 2.4661, lr_0 = 5.6605e-04
Loss = 2.1594e-03, PNorm = 101.9138, GNorm = 1.7767, lr_0 = 5.4774e-04
Validation rmse = 0.919372
Epoch 9
Loss = 1.6877e-03, PNorm = 101.9405, GNorm = 0.3226, lr_0 = 5.3001e-04
Loss = 1.7929e-03, PNorm = 101.9806, GNorm = 0.8052, lr_0 = 5.1286e-04
Validation rmse = 0.938424
Epoch 10
Loss = 1.9910e-03, PNorm = 102.0203, GNorm = 0.7561, lr_0 = 4.9627e-04
Loss = 1.9109e-03, PNorm = 102.0485, GNorm = 2.1831, lr_0 = 4.8021e-04
Loss = 2.0456e-03, PNorm = 102.0858, GNorm = 2.1716, lr_0 = 4.6467e-04
Validation rmse = 1.045646
Epoch 11
Loss = 2.0014e-03, PNorm = 102.1283, GNorm = 1.7025, lr_0 = 4.4963e-04
Loss = 1.7464e-03, PNorm = 102.1627, GNorm = 2.2413, lr_0 = 4.3508e-04
Validation rmse = 0.888979
Epoch 12
Loss = 1.3409e-03, PNorm = 102.1912, GNorm = 2.2331, lr_0 = 4.1962e-04
Loss = 1.7736e-03, PNorm = 102.2247, GNorm = 3.2688, lr_0 = 4.0604e-04
Loss = 1.6273e-03, PNorm = 102.2537, GNorm = 1.8149, lr_0 = 3.9290e-04
Validation rmse = 0.926592
Epoch 13
Loss = 1.9051e-03, PNorm = 102.2792, GNorm = 2.9196, lr_0 = 3.8019e-04
Loss = 1.4811e-03, PNorm = 102.3087, GNorm = 3.2365, lr_0 = 3.6789e-04
Loss = 1.7652e-03, PNorm = 102.3337, GNorm = 0.8888, lr_0 = 3.5598e-04
Validation rmse = 0.830643
Epoch 14
Loss = 1.5417e-03, PNorm = 102.3572, GNorm = 1.8350, lr_0 = 3.4446e-04
Loss = 1.2855e-03, PNorm = 102.3866, GNorm = 0.4885, lr_0 = 3.3332e-04
Validation rmse = 0.947550
Epoch 15
Loss = 1.5166e-03, PNorm = 102.4103, GNorm = 0.7287, lr_0 = 3.2253e-04
Loss = 1.4535e-03, PNorm = 102.4356, GNorm = 0.9424, lr_0 = 3.1209e-04
Loss = 1.2655e-03, PNorm = 102.4522, GNorm = 1.1402, lr_0 = 3.0200e-04
Validation rmse = 0.899305
Epoch 16
Loss = 1.2500e-03, PNorm = 102.4693, GNorm = 1.3973, lr_0 = 2.9222e-04
Loss = 1.2242e-03, PNorm = 102.4869, GNorm = 0.4728, lr_0 = 2.8277e-04
Validation rmse = 0.843813
Epoch 17
Loss = 1.1505e-03, PNorm = 102.5117, GNorm = 1.4753, lr_0 = 2.7272e-04
Loss = 1.1635e-03, PNorm = 102.5283, GNorm = 0.3820, lr_0 = 2.6389e-04
Loss = 1.0826e-03, PNorm = 102.5446, GNorm = 0.7858, lr_0 = 2.5535e-04
Validation rmse = 0.798998
Epoch 18
Loss = 1.1859e-03, PNorm = 102.5638, GNorm = 0.3468, lr_0 = 2.4709e-04
Loss = 1.2706e-03, PNorm = 102.5820, GNorm = 1.5640, lr_0 = 2.3910e-04
Loss = 1.0546e-03, PNorm = 102.5971, GNorm = 0.9335, lr_0 = 2.3136e-04
Validation rmse = 0.795805
Epoch 19
Loss = 1.2937e-03, PNorm = 102.6154, GNorm = 0.7799, lr_0 = 2.2387e-04
Loss = 1.1987e-03, PNorm = 102.6299, GNorm = 0.5814, lr_0 = 2.1663e-04
Validation rmse = 0.798520
Epoch 20
Loss = 7.7702e-04, PNorm = 102.6468, GNorm = 0.3523, lr_0 = 2.0962e-04
Loss = 1.1998e-03, PNorm = 102.6629, GNorm = 1.7220, lr_0 = 2.0283e-04
Loss = 9.8547e-04, PNorm = 102.6758, GNorm = 0.9673, lr_0 = 1.9627e-04
Validation rmse = 0.827636
Epoch 21
Loss = 1.1529e-03, PNorm = 102.6902, GNorm = 0.5453, lr_0 = 1.8992e-04
Loss = 1.2315e-03, PNorm = 102.7078, GNorm = 1.8116, lr_0 = 1.8377e-04
Validation rmse = 0.788665
Epoch 22
Loss = 7.2511e-04, PNorm = 102.7201, GNorm = 0.3947, lr_0 = 1.7783e-04
Loss = 9.1074e-04, PNorm = 102.7342, GNorm = 1.4934, lr_0 = 1.7207e-04
Loss = 9.9481e-04, PNorm = 102.7437, GNorm = 0.5574, lr_0 = 1.6651e-04
Validation rmse = 0.781165
Epoch 23
Loss = 1.1014e-03, PNorm = 102.7536, GNorm = 0.9739, lr_0 = 1.6059e-04
Loss = 9.3556e-04, PNorm = 102.7665, GNorm = 0.5426, lr_0 = 1.5539e-04
Validation rmse = 0.837247
Epoch 24
Loss = 1.0958e-03, PNorm = 102.7806, GNorm = 1.9320, lr_0 = 1.5036e-04
Loss = 1.0004e-03, PNorm = 102.7919, GNorm = 2.4167, lr_0 = 1.4550e-04
Loss = 1.0803e-03, PNorm = 102.8011, GNorm = 2.2850, lr_0 = 1.4079e-04
Validation rmse = 0.796732
Epoch 25
Loss = 8.8261e-04, PNorm = 102.8092, GNorm = 0.7618, lr_0 = 1.3623e-04
Loss = 8.0349e-04, PNorm = 102.8177, GNorm = 1.4799, lr_0 = 1.3183e-04
Loss = 9.1302e-04, PNorm = 102.8271, GNorm = 1.7165, lr_0 = 1.2756e-04
Validation rmse = 0.777641
Epoch 26
Loss = 8.6184e-04, PNorm = 102.8373, GNorm = 0.5644, lr_0 = 1.2343e-04
Loss = 7.9284e-04, PNorm = 102.8464, GNorm = 0.3307, lr_0 = 1.1944e-04
Validation rmse = 0.808347
Epoch 27
Loss = 7.8994e-04, PNorm = 102.8551, GNorm = 1.7577, lr_0 = 1.1557e-04
Loss = 8.7438e-04, PNorm = 102.8636, GNorm = 0.7081, lr_0 = 1.1183e-04
Loss = 7.9076e-04, PNorm = 102.8704, GNorm = 0.4339, lr_0 = 1.0821e-04
Validation rmse = 0.770419
Epoch 28
Loss = 7.3935e-04, PNorm = 102.8793, GNorm = 0.4141, lr_0 = 1.0437e-04
Loss = 7.8535e-04, PNorm = 102.8861, GNorm = 0.7893, lr_0 = 1.0099e-04
Validation rmse = 0.774874
Epoch 29
Loss = 6.8413e-04, PNorm = 102.8943, GNorm = 1.1563, lr_0 = 1.0000e-04
Loss = 7.7494e-04, PNorm = 102.9008, GNorm = 0.5699, lr_0 = 1.0000e-04
Loss = 6.8249e-04, PNorm = 102.9075, GNorm = 1.5987, lr_0 = 1.0000e-04
Validation rmse = 0.778768
Model 0 best validation rmse = 0.770419 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.692150
Ensemble test rmse = 0.692150
10-fold cross validation
	Seed 0 ==> test rmse = 0.742750
	Seed 1 ==> test rmse = 0.619086
	Seed 2 ==> test rmse = 0.717577
	Seed 3 ==> test rmse = 0.815443
	Seed 4 ==> test rmse = 0.948297
	Seed 5 ==> test rmse = 0.668297
	Seed 6 ==> test rmse = 0.743440
	Seed 7 ==> test rmse = 0.696389
	Seed 8 ==> test rmse = 0.790276
	Seed 9 ==> test rmse = 0.692150
Overall test rmse = 0.743371 +/- 0.087160
Elapsed time = 0:10:49
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 1.6106e-02, PNorm = 75.7834, GNorm = 7.2294, lr_0 = 2.9800e-04
Loss = 1.1742e-02, PNorm = 75.8394, GNorm = 7.2244, lr_0 = 4.7800e-04
Validation rmse = 1.314188
Epoch 1
Loss = 8.2911e-03, PNorm = 75.9249, GNorm = 4.9557, lr_0 = 6.7600e-04
Loss = 6.0000e-03, PNorm = 76.0146, GNorm = 6.1743, lr_0 = 8.5600e-04
Loss = 7.4457e-03, PNorm = 76.1254, GNorm = 0.6025, lr_0 = 9.9344e-04
Validation rmse = 1.259831
Epoch 2
Loss = 4.9060e-03, PNorm = 76.2348, GNorm = 2.5507, lr_0 = 9.6130e-04
Loss = 5.8014e-03, PNorm = 76.3361, GNorm = 9.4117, lr_0 = 9.3019e-04
Validation rmse = 1.089552
Epoch 3
Loss = 4.5982e-03, PNorm = 76.4269, GNorm = 5.6252, lr_0 = 9.0009e-04
Loss = 6.1034e-03, PNorm = 76.5164, GNorm = 1.5026, lr_0 = 8.7096e-04
Loss = 7.2259e-03, PNorm = 76.6153, GNorm = 4.8315, lr_0 = 8.4278e-04
Validation rmse = 1.342935
Epoch 4
Loss = 4.5018e-03, PNorm = 76.6963, GNorm = 0.9764, lr_0 = 8.1551e-04
Loss = 3.7193e-03, PNorm = 76.7587, GNorm = 1.7284, lr_0 = 7.8912e-04
Validation rmse = 1.153597
Epoch 5
Loss = 4.1452e-03, PNorm = 76.8085, GNorm = 3.4639, lr_0 = 7.6358e-04
Loss = 3.1665e-03, PNorm = 76.8635, GNorm = 0.9283, lr_0 = 7.3888e-04
Loss = 2.8942e-03, PNorm = 76.9060, GNorm = 3.5513, lr_0 = 7.1497e-04
Validation rmse = 0.984495
Epoch 6
Loss = 2.5076e-03, PNorm = 76.9576, GNorm = 1.1992, lr_0 = 6.8956e-04
Loss = 2.5134e-03, PNorm = 76.9960, GNorm = 0.9314, lr_0 = 6.6725e-04
Loss = 2.6364e-03, PNorm = 77.0322, GNorm = 1.4891, lr_0 = 6.4565e-04
Validation rmse = 0.972181
Epoch 7
Loss = 2.0601e-03, PNorm = 77.0678, GNorm = 1.5712, lr_0 = 6.2476e-04
Loss = 2.2013e-03, PNorm = 77.0983, GNorm = 2.6626, lr_0 = 6.0454e-04
Validation rmse = 0.871139
Epoch 8
Loss = 1.8661e-03, PNorm = 77.1306, GNorm = 1.7132, lr_0 = 5.8498e-04
Loss = 2.2419e-03, PNorm = 77.1588, GNorm = 2.5004, lr_0 = 5.6605e-04
Loss = 1.7038e-03, PNorm = 77.1933, GNorm = 1.6434, lr_0 = 5.4774e-04
Validation rmse = 0.960224
Epoch 9
Loss = 1.8702e-03, PNorm = 77.2257, GNorm = 1.6426, lr_0 = 5.3001e-04
Loss = 1.5592e-03, PNorm = 77.2552, GNorm = 0.6004, lr_0 = 5.1286e-04
Validation rmse = 0.881618
Epoch 10
Loss = 1.7503e-03, PNorm = 77.2828, GNorm = 1.5479, lr_0 = 4.9627e-04
Loss = 1.6177e-03, PNorm = 77.3153, GNorm = 2.0977, lr_0 = 4.8021e-04
Loss = 1.6864e-03, PNorm = 77.3376, GNorm = 1.6850, lr_0 = 4.6467e-04
Validation rmse = 0.910866
Epoch 11
Loss = 1.3676e-03, PNorm = 77.3576, GNorm = 0.8313, lr_0 = 4.4963e-04
Loss = 1.2983e-03, PNorm = 77.3834, GNorm = 0.4894, lr_0 = 4.3508e-04
Validation rmse = 0.883623
Epoch 12
Loss = 1.2268e-03, PNorm = 77.4082, GNorm = 0.4278, lr_0 = 4.1962e-04
Loss = 1.4424e-03, PNorm = 77.4290, GNorm = 0.9341, lr_0 = 4.0604e-04
Loss = 1.3407e-03, PNorm = 77.4511, GNorm = 1.4237, lr_0 = 3.9290e-04
Validation rmse = 0.836436
Epoch 13
Loss = 1.0857e-03, PNorm = 77.4725, GNorm = 1.0936, lr_0 = 3.8019e-04
Loss = 1.1952e-03, PNorm = 77.4888, GNorm = 1.6628, lr_0 = 3.6789e-04
Loss = 1.1825e-03, PNorm = 77.5050, GNorm = 0.7729, lr_0 = 3.5598e-04
Validation rmse = 0.866042
Epoch 14
Loss = 1.1313e-03, PNorm = 77.5272, GNorm = 1.9066, lr_0 = 3.4446e-04
Loss = 8.9061e-04, PNorm = 77.5468, GNorm = 1.5468, lr_0 = 3.3332e-04
Validation rmse = 0.832247
Epoch 15
Loss = 1.0006e-03, PNorm = 77.5625, GNorm = 0.9447, lr_0 = 3.2253e-04
Loss = 1.1849e-03, PNorm = 77.5822, GNorm = 0.7807, lr_0 = 3.1209e-04
Loss = 1.0281e-03, PNorm = 77.6049, GNorm = 1.3341, lr_0 = 3.0200e-04
Validation rmse = 0.808706
Epoch 16
Loss = 8.9901e-04, PNorm = 77.6208, GNorm = 0.3982, lr_0 = 2.9222e-04
Loss = 9.5313e-04, PNorm = 77.6312, GNorm = 1.4434, lr_0 = 2.8277e-04
Validation rmse = 0.807453
Epoch 17
Loss = 8.6815e-04, PNorm = 77.6457, GNorm = 0.8553, lr_0 = 2.7272e-04
Loss = 8.7260e-04, PNorm = 77.6613, GNorm = 1.1511, lr_0 = 2.6389e-04
Loss = 8.9559e-04, PNorm = 77.6776, GNorm = 1.0891, lr_0 = 2.5535e-04
Validation rmse = 0.815597
Epoch 18
Loss = 8.0033e-04, PNorm = 77.6906, GNorm = 0.3894, lr_0 = 2.4709e-04
Loss = 7.1393e-04, PNorm = 77.7029, GNorm = 1.0802, lr_0 = 2.3910e-04
Loss = 7.0807e-04, PNorm = 77.7169, GNorm = 0.6415, lr_0 = 2.3136e-04
Validation rmse = 0.784100
Epoch 19
Loss = 7.3684e-04, PNorm = 77.7313, GNorm = 0.6810, lr_0 = 2.2387e-04
Loss = 7.9788e-04, PNorm = 77.7449, GNorm = 1.5028, lr_0 = 2.1663e-04
Validation rmse = 0.803090
Epoch 20
Loss = 7.3475e-04, PNorm = 77.7567, GNorm = 0.4728, lr_0 = 2.0962e-04
Loss = 7.9882e-04, PNorm = 77.7697, GNorm = 1.1649, lr_0 = 2.0283e-04
Loss = 7.6462e-04, PNorm = 77.7839, GNorm = 0.5040, lr_0 = 1.9627e-04
Validation rmse = 0.788941
Epoch 21
Loss = 5.8872e-04, PNorm = 77.7965, GNorm = 1.1452, lr_0 = 1.8992e-04
Loss = 5.6499e-04, PNorm = 77.8067, GNorm = 0.4095, lr_0 = 1.8377e-04
Validation rmse = 0.775865
Epoch 22
Loss = 6.2874e-04, PNorm = 77.8189, GNorm = 0.4398, lr_0 = 1.7783e-04
Loss = 6.2784e-04, PNorm = 77.8303, GNorm = 1.1449, lr_0 = 1.7207e-04
Loss = 6.1484e-04, PNorm = 77.8396, GNorm = 0.5553, lr_0 = 1.6651e-04
Validation rmse = 0.791220
Epoch 23
Loss = 5.4813e-04, PNorm = 77.8500, GNorm = 0.4337, lr_0 = 1.6059e-04
Loss = 6.3084e-04, PNorm = 77.8605, GNorm = 0.8105, lr_0 = 1.5539e-04
Validation rmse = 0.793240
Epoch 24
Loss = 6.4525e-04, PNorm = 77.8677, GNorm = 0.7312, lr_0 = 1.5036e-04
Loss = 5.2657e-04, PNorm = 77.8782, GNorm = 0.3907, lr_0 = 1.4550e-04
Loss = 5.5034e-04, PNorm = 77.8864, GNorm = 0.2841, lr_0 = 1.4079e-04
Validation rmse = 0.793761
Epoch 25
Loss = 4.2761e-04, PNorm = 77.8947, GNorm = 0.4674, lr_0 = 1.3623e-04
Loss = 5.1827e-04, PNorm = 77.9029, GNorm = 0.5043, lr_0 = 1.3183e-04
Loss = 4.9902e-04, PNorm = 77.9117, GNorm = 0.4873, lr_0 = 1.2756e-04
Validation rmse = 0.771298
Epoch 26
Loss = 4.2197e-04, PNorm = 77.9179, GNorm = 0.4589, lr_0 = 1.2343e-04
Loss = 5.1548e-04, PNorm = 77.9241, GNorm = 0.4607, lr_0 = 1.1944e-04
Validation rmse = 0.784671
Epoch 27
Loss = 4.6078e-04, PNorm = 77.9315, GNorm = 0.4452, lr_0 = 1.1557e-04
Loss = 4.7088e-04, PNorm = 77.9396, GNorm = 0.6567, lr_0 = 1.1183e-04
Loss = 4.8899e-04, PNorm = 77.9463, GNorm = 0.5516, lr_0 = 1.0821e-04
Validation rmse = 0.805184
Epoch 28
Loss = 4.5688e-04, PNorm = 77.9519, GNorm = 0.4752, lr_0 = 1.0437e-04
Loss = 4.1013e-04, PNorm = 77.9573, GNorm = 0.3715, lr_0 = 1.0099e-04
Validation rmse = 0.801218
Epoch 29
Loss = 4.9488e-04, PNorm = 77.9632, GNorm = 0.4140, lr_0 = 1.0000e-04
Loss = 4.8630e-04, PNorm = 77.9692, GNorm = 0.5620, lr_0 = 1.0000e-04
Loss = 4.9418e-04, PNorm = 77.9756, GNorm = 1.6637, lr_0 = 1.0000e-04
Validation rmse = 0.799414
Model 0 best validation rmse = 0.771298 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.757741
Ensemble test rmse = 0.757741
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 2.0927e-02, PNorm = 75.7839, GNorm = 3.0505, lr_0 = 2.9800e-04
Loss = 1.2491e-02, PNorm = 75.8377, GNorm = 3.5975, lr_0 = 4.7800e-04
Validation rmse = 1.548972
Epoch 1
Loss = 8.9260e-03, PNorm = 75.9242, GNorm = 3.1464, lr_0 = 6.7600e-04
Loss = 9.3664e-03, PNorm = 76.0183, GNorm = 6.2113, lr_0 = 8.5600e-04
Loss = 5.0514e-03, PNorm = 76.1087, GNorm = 1.2834, lr_0 = 9.9344e-04
Validation rmse = 1.324175
Epoch 2
Loss = 5.1366e-03, PNorm = 76.1983, GNorm = 0.8110, lr_0 = 9.6130e-04
Loss = 5.0451e-03, PNorm = 76.2824, GNorm = 2.3770, lr_0 = 9.3019e-04
Validation rmse = 1.137850
Epoch 3
Loss = 3.7864e-03, PNorm = 76.3517, GNorm = 2.8934, lr_0 = 9.0009e-04
Loss = 3.9454e-03, PNorm = 76.4163, GNorm = 0.5038, lr_0 = 8.7096e-04
Loss = 3.7202e-03, PNorm = 76.4745, GNorm = 3.5897, lr_0 = 8.4278e-04
Validation rmse = 0.876522
Epoch 4
Loss = 3.7567e-03, PNorm = 76.5209, GNorm = 2.0715, lr_0 = 8.1551e-04
Loss = 2.9370e-03, PNorm = 76.5696, GNorm = 4.5233, lr_0 = 7.8912e-04
Validation rmse = 0.952752
Epoch 5
Loss = 2.8459e-03, PNorm = 76.6194, GNorm = 3.2715, lr_0 = 7.6358e-04
Loss = 3.7928e-03, PNorm = 76.6647, GNorm = 2.5945, lr_0 = 7.3888e-04
Loss = 3.8875e-03, PNorm = 76.7180, GNorm = 3.3513, lr_0 = 7.1497e-04
Validation rmse = 0.981531
Epoch 6
Loss = 3.5534e-03, PNorm = 76.7746, GNorm = 0.5797, lr_0 = 6.8956e-04
Loss = 2.6764e-03, PNorm = 76.8310, GNorm = 1.1104, lr_0 = 6.6725e-04
Loss = 2.2462e-03, PNorm = 76.8704, GNorm = 2.8299, lr_0 = 6.4565e-04
Validation rmse = 0.777729
Epoch 7
Loss = 2.3151e-03, PNorm = 76.9048, GNorm = 2.2436, lr_0 = 6.2476e-04
Loss = 2.2841e-03, PNorm = 76.9352, GNorm = 2.5152, lr_0 = 6.0454e-04
Validation rmse = 0.738855
Epoch 8
Loss = 3.1992e-03, PNorm = 76.9737, GNorm = 3.0228, lr_0 = 5.8498e-04
Loss = 2.3575e-03, PNorm = 77.0167, GNorm = 1.8332, lr_0 = 5.6605e-04
Loss = 1.7990e-03, PNorm = 77.0496, GNorm = 1.4884, lr_0 = 5.4774e-04
Validation rmse = 0.813754
Epoch 9
Loss = 1.6270e-03, PNorm = 77.0827, GNorm = 1.8564, lr_0 = 5.3001e-04
Loss = 1.8144e-03, PNorm = 77.1149, GNorm = 0.9922, lr_0 = 5.1286e-04
Validation rmse = 0.744582
Epoch 10
Loss = 1.3360e-03, PNorm = 77.1352, GNorm = 0.7808, lr_0 = 4.9627e-04
Loss = 1.8519e-03, PNorm = 77.1628, GNorm = 1.0426, lr_0 = 4.8021e-04
Loss = 1.5627e-03, PNorm = 77.1852, GNorm = 1.4080, lr_0 = 4.6467e-04
Validation rmse = 0.759031
Epoch 11
Loss = 2.0617e-03, PNorm = 77.2126, GNorm = 4.5606, lr_0 = 4.4963e-04
Loss = 1.7884e-03, PNorm = 77.2395, GNorm = 1.1135, lr_0 = 4.3508e-04
Validation rmse = 0.762466
Epoch 12
Loss = 1.8275e-03, PNorm = 77.2699, GNorm = 2.6867, lr_0 = 4.1962e-04
Loss = 1.8381e-03, PNorm = 77.2964, GNorm = 0.7247, lr_0 = 4.0604e-04
Loss = 1.4849e-03, PNorm = 77.3197, GNorm = 1.0439, lr_0 = 3.9290e-04
Validation rmse = 0.731393
Epoch 13
Loss = 1.0773e-03, PNorm = 77.3397, GNorm = 0.5454, lr_0 = 3.8019e-04
Loss = 1.1583e-03, PNorm = 77.3590, GNorm = 0.6000, lr_0 = 3.6789e-04
Loss = 1.6591e-03, PNorm = 77.3733, GNorm = 0.8944, lr_0 = 3.5598e-04
Validation rmse = 0.767081
Epoch 14
Loss = 1.4716e-03, PNorm = 77.3923, GNorm = 2.0036, lr_0 = 3.4446e-04
Loss = 1.0296e-03, PNorm = 77.4095, GNorm = 0.3543, lr_0 = 3.3332e-04
Validation rmse = 0.676247
Epoch 15
Loss = 1.2634e-03, PNorm = 77.4268, GNorm = 1.1373, lr_0 = 3.2253e-04
Loss = 1.0933e-03, PNorm = 77.4440, GNorm = 1.0001, lr_0 = 3.1209e-04
Loss = 1.3227e-03, PNorm = 77.4665, GNorm = 1.3443, lr_0 = 3.0200e-04
Validation rmse = 0.679718
Epoch 16
Loss = 1.2804e-03, PNorm = 77.4845, GNorm = 0.7010, lr_0 = 2.9222e-04
Loss = 7.0790e-04, PNorm = 77.4992, GNorm = 0.6841, lr_0 = 2.8277e-04
Validation rmse = 0.657288
Epoch 17
Loss = 8.8435e-04, PNorm = 77.5148, GNorm = 0.6285, lr_0 = 2.7272e-04
Loss = 1.0802e-03, PNorm = 77.5319, GNorm = 0.6889, lr_0 = 2.6389e-04
Loss = 9.8718e-04, PNorm = 77.5473, GNorm = 0.7370, lr_0 = 2.5535e-04
Validation rmse = 0.673400
Epoch 18
Loss = 9.2502e-04, PNorm = 77.5627, GNorm = 1.1399, lr_0 = 2.4709e-04
Loss = 1.0510e-03, PNorm = 77.5772, GNorm = 0.6956, lr_0 = 2.3910e-04
Loss = 9.2425e-04, PNorm = 77.5929, GNorm = 1.1219, lr_0 = 2.3136e-04
Validation rmse = 0.680217
Epoch 19
Loss = 8.6634e-04, PNorm = 77.6050, GNorm = 1.4780, lr_0 = 2.2387e-04
Loss = 9.5879e-04, PNorm = 77.6194, GNorm = 1.3588, lr_0 = 2.1663e-04
Validation rmse = 0.656262
Epoch 20
Loss = 6.3452e-04, PNorm = 77.6358, GNorm = 0.9585, lr_0 = 2.0962e-04
Loss = 8.9709e-04, PNorm = 77.6477, GNorm = 0.6739, lr_0 = 2.0283e-04
Loss = 8.0100e-04, PNorm = 77.6595, GNorm = 0.7973, lr_0 = 1.9627e-04
Validation rmse = 0.660024
Epoch 21
Loss = 7.3195e-04, PNorm = 77.6712, GNorm = 0.7288, lr_0 = 1.8992e-04
Loss = 8.4002e-04, PNorm = 77.6813, GNorm = 1.0111, lr_0 = 1.8377e-04
Validation rmse = 0.660835
Epoch 22
Loss = 6.6347e-04, PNorm = 77.6940, GNorm = 0.4125, lr_0 = 1.7783e-04
Loss = 7.8521e-04, PNorm = 77.7038, GNorm = 1.1279, lr_0 = 1.7207e-04
Loss = 7.9254e-04, PNorm = 77.7155, GNorm = 0.5276, lr_0 = 1.6651e-04
Validation rmse = 0.653254
Epoch 23
Loss = 6.4395e-04, PNorm = 77.7294, GNorm = 0.5124, lr_0 = 1.6059e-04
Loss = 6.7482e-04, PNorm = 77.7395, GNorm = 0.4415, lr_0 = 1.5539e-04
Validation rmse = 0.672456
Epoch 24
Loss = 4.5909e-04, PNorm = 77.7497, GNorm = 0.5479, lr_0 = 1.5036e-04
Loss = 7.2472e-04, PNorm = 77.7598, GNorm = 0.4491, lr_0 = 1.4550e-04
Loss = 6.5164e-04, PNorm = 77.7707, GNorm = 0.4125, lr_0 = 1.4079e-04
Validation rmse = 0.632985
Epoch 25
Loss = 4.6102e-04, PNorm = 77.7798, GNorm = 0.3447, lr_0 = 1.3623e-04
Loss = 6.0649e-04, PNorm = 77.7883, GNorm = 0.5376, lr_0 = 1.3183e-04
Loss = 6.8713e-04, PNorm = 77.7986, GNorm = 0.7341, lr_0 = 1.2756e-04
Validation rmse = 0.694295
Epoch 26
Loss = 7.1018e-04, PNorm = 77.8064, GNorm = 1.4038, lr_0 = 1.2343e-04
Loss = 6.3909e-04, PNorm = 77.8152, GNorm = 0.4509, lr_0 = 1.1944e-04
Validation rmse = 0.647046
Epoch 27
Loss = 6.7641e-04, PNorm = 77.8221, GNorm = 0.3843, lr_0 = 1.1557e-04
Loss = 5.6945e-04, PNorm = 77.8303, GNorm = 0.8782, lr_0 = 1.1183e-04
Loss = 6.6126e-04, PNorm = 77.8395, GNorm = 0.6224, lr_0 = 1.0821e-04
Validation rmse = 0.669199
Epoch 28
Loss = 6.1674e-04, PNorm = 77.8463, GNorm = 0.3843, lr_0 = 1.0437e-04
Loss = 4.6716e-04, PNorm = 77.8529, GNorm = 0.6177, lr_0 = 1.0099e-04
Validation rmse = 0.659265
Epoch 29
Loss = 5.5510e-04, PNorm = 77.8592, GNorm = 1.1090, lr_0 = 1.0000e-04
Loss = 5.5039e-04, PNorm = 77.8676, GNorm = 0.8000, lr_0 = 1.0000e-04
Loss = 5.2428e-04, PNorm = 77.8747, GNorm = 1.1157, lr_0 = 1.0000e-04
Validation rmse = 0.642803
Model 0 best validation rmse = 0.632985 on epoch 24
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.606592
Ensemble test rmse = 0.606592
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 2.1318e-02, PNorm = 75.7827, GNorm = 11.5258, lr_0 = 2.9800e-04
Loss = 1.2628e-02, PNorm = 75.8448, GNorm = 2.6401, lr_0 = 4.7800e-04
Validation rmse = 1.355551
Epoch 1
Loss = 8.8233e-03, PNorm = 75.9402, GNorm = 5.9553, lr_0 = 6.7600e-04
Loss = 7.4861e-03, PNorm = 76.0350, GNorm = 2.2264, lr_0 = 8.5600e-04
Loss = 8.7938e-03, PNorm = 76.1484, GNorm = 4.8403, lr_0 = 9.9344e-04
Validation rmse = 1.427053
Epoch 2
Loss = 6.7418e-03, PNorm = 76.2578, GNorm = 3.8788, lr_0 = 9.6130e-04
Loss = 6.0044e-03, PNorm = 76.3557, GNorm = 3.2971, lr_0 = 9.3019e-04
Validation rmse = 1.006832
Epoch 3
Loss = 4.5072e-03, PNorm = 76.4316, GNorm = 0.7591, lr_0 = 9.0009e-04
Loss = 3.5533e-03, PNorm = 76.5001, GNorm = 1.8788, lr_0 = 8.7096e-04
Loss = 4.0565e-03, PNorm = 76.5573, GNorm = 1.3059, lr_0 = 8.4278e-04
Validation rmse = 0.945976
Epoch 4
Loss = 4.7145e-03, PNorm = 76.6215, GNorm = 1.4185, lr_0 = 8.1551e-04
Loss = 4.8366e-03, PNorm = 76.6891, GNorm = 0.6763, lr_0 = 7.8912e-04
Validation rmse = 0.841521
Epoch 5
Loss = 3.4473e-03, PNorm = 76.7461, GNorm = 1.2924, lr_0 = 7.6358e-04
Loss = 2.7531e-03, PNorm = 76.8042, GNorm = 1.4315, lr_0 = 7.3888e-04
Loss = 3.1486e-03, PNorm = 76.8525, GNorm = 2.0932, lr_0 = 7.1497e-04
Validation rmse = 0.730249
Epoch 6
Loss = 2.6840e-03, PNorm = 76.8950, GNorm = 1.8273, lr_0 = 6.8956e-04
Loss = 2.4555e-03, PNorm = 76.9324, GNorm = 1.8471, lr_0 = 6.6725e-04
Loss = 2.5655e-03, PNorm = 76.9705, GNorm = 1.2888, lr_0 = 6.4565e-04
Validation rmse = 0.919972
Epoch 7
Loss = 2.3742e-03, PNorm = 77.0108, GNorm = 1.1204, lr_0 = 6.2476e-04
Loss = 1.9112e-03, PNorm = 77.0522, GNorm = 0.7228, lr_0 = 6.0454e-04
Validation rmse = 0.705231
Epoch 8
Loss = 1.9719e-03, PNorm = 77.0885, GNorm = 0.7242, lr_0 = 5.8498e-04
Loss = 1.5835e-03, PNorm = 77.1156, GNorm = 0.9930, lr_0 = 5.6605e-04
Loss = 1.9085e-03, PNorm = 77.1405, GNorm = 1.5475, lr_0 = 5.4774e-04
Validation rmse = 0.658996
Epoch 9
Loss = 1.8315e-03, PNorm = 77.1734, GNorm = 2.8920, lr_0 = 5.3001e-04
Loss = 2.0022e-03, PNorm = 77.2084, GNorm = 0.9260, lr_0 = 5.1286e-04
Validation rmse = 0.650790
Epoch 10
Loss = 1.3942e-03, PNorm = 77.2365, GNorm = 0.3819, lr_0 = 4.9627e-04
Loss = 1.4431e-03, PNorm = 77.2622, GNorm = 0.8469, lr_0 = 4.8021e-04
Loss = 2.0313e-03, PNorm = 77.2978, GNorm = 1.0909, lr_0 = 4.6467e-04
Validation rmse = 0.672920
Epoch 11
Loss = 1.6665e-03, PNorm = 77.3188, GNorm = 1.1236, lr_0 = 4.4963e-04
Loss = 1.6209e-03, PNorm = 77.3477, GNorm = 0.9272, lr_0 = 4.3508e-04
Validation rmse = 0.652174
Epoch 12
Loss = 8.9981e-04, PNorm = 77.3695, GNorm = 0.9237, lr_0 = 4.1962e-04
Loss = 1.6163e-03, PNorm = 77.3907, GNorm = 3.2042, lr_0 = 4.0604e-04
Loss = 1.3420e-03, PNorm = 77.4143, GNorm = 1.6621, lr_0 = 3.9290e-04
Validation rmse = 0.625095
Epoch 13
Loss = 1.3319e-03, PNorm = 77.4372, GNorm = 0.7375, lr_0 = 3.8019e-04
Loss = 1.2857e-03, PNorm = 77.4574, GNorm = 2.5768, lr_0 = 3.6789e-04
Loss = 1.5802e-03, PNorm = 77.4775, GNorm = 2.7723, lr_0 = 3.5598e-04
Validation rmse = 0.628256
Epoch 14
Loss = 1.2608e-03, PNorm = 77.4940, GNorm = 2.2074, lr_0 = 3.4446e-04
Loss = 1.4806e-03, PNorm = 77.5192, GNorm = 1.4847, lr_0 = 3.3332e-04
Validation rmse = 0.826980
Epoch 15
Loss = 1.6880e-03, PNorm = 77.5399, GNorm = 0.9894, lr_0 = 3.2253e-04
Loss = 1.3272e-03, PNorm = 77.5575, GNorm = 0.9798, lr_0 = 3.1209e-04
Loss = 1.4096e-03, PNorm = 77.5787, GNorm = 2.5059, lr_0 = 3.0200e-04
Validation rmse = 0.638217
Epoch 16
Loss = 1.0160e-03, PNorm = 77.5928, GNorm = 0.4444, lr_0 = 2.9222e-04
Loss = 9.9352e-04, PNorm = 77.6095, GNorm = 1.0754, lr_0 = 2.8277e-04
Validation rmse = 0.611372
Epoch 17
Loss = 7.1604e-04, PNorm = 77.6271, GNorm = 1.1132, lr_0 = 2.7272e-04
Loss = 8.2306e-04, PNorm = 77.6426, GNorm = 0.5211, lr_0 = 2.6389e-04
Loss = 1.1344e-03, PNorm = 77.6585, GNorm = 2.8000, lr_0 = 2.5535e-04
Validation rmse = 0.606260
Epoch 18
Loss = 9.5953e-04, PNorm = 77.6732, GNorm = 1.1712, lr_0 = 2.4709e-04
Loss = 1.0556e-03, PNorm = 77.6912, GNorm = 1.1774, lr_0 = 2.3910e-04
Loss = 8.4293e-04, PNorm = 77.7008, GNorm = 0.7553, lr_0 = 2.3136e-04
Validation rmse = 0.615602
Epoch 19
Loss = 1.0407e-03, PNorm = 77.7158, GNorm = 1.7260, lr_0 = 2.2387e-04
Loss = 7.9020e-04, PNorm = 77.7282, GNorm = 0.8242, lr_0 = 2.1663e-04
Validation rmse = 0.605981
Epoch 20
Loss = 7.6189e-04, PNorm = 77.7384, GNorm = 1.7316, lr_0 = 2.0962e-04
Loss = 7.2417e-04, PNorm = 77.7510, GNorm = 0.7905, lr_0 = 2.0283e-04
Loss = 7.4640e-04, PNorm = 77.7602, GNorm = 0.5687, lr_0 = 1.9627e-04
Validation rmse = 0.599582
Epoch 21
Loss = 6.8903e-04, PNorm = 77.7706, GNorm = 0.5336, lr_0 = 1.8992e-04
Loss = 7.0783e-04, PNorm = 77.7824, GNorm = 1.0804, lr_0 = 1.8377e-04
Validation rmse = 0.620409
Epoch 22
Loss = 7.0413e-04, PNorm = 77.7930, GNorm = 0.4665, lr_0 = 1.7783e-04
Loss = 8.5040e-04, PNorm = 77.8045, GNorm = 0.9347, lr_0 = 1.7207e-04
Loss = 6.8916e-04, PNorm = 77.8155, GNorm = 1.4715, lr_0 = 1.6651e-04
Validation rmse = 0.608373
Epoch 23
Loss = 6.8461e-04, PNorm = 77.8244, GNorm = 0.7497, lr_0 = 1.6059e-04
Loss = 7.3328e-04, PNorm = 77.8344, GNorm = 0.7244, lr_0 = 1.5539e-04
Validation rmse = 0.586218
Epoch 24
Loss = 6.0488e-04, PNorm = 77.8440, GNorm = 0.2825, lr_0 = 1.5036e-04
Loss = 5.7814e-04, PNorm = 77.8538, GNorm = 1.0846, lr_0 = 1.4550e-04
Loss = 5.4262e-04, PNorm = 77.8622, GNorm = 0.8375, lr_0 = 1.4079e-04
Validation rmse = 0.598886
Epoch 25
Loss = 6.2748e-04, PNorm = 77.8716, GNorm = 1.4602, lr_0 = 1.3623e-04
Loss = 6.3332e-04, PNorm = 77.8817, GNorm = 0.9006, lr_0 = 1.3183e-04
Loss = 5.9645e-04, PNorm = 77.8886, GNorm = 0.7978, lr_0 = 1.2756e-04
Validation rmse = 0.592180
Epoch 26
Loss = 5.0767e-04, PNorm = 77.8956, GNorm = 1.1487, lr_0 = 1.2343e-04
Loss = 5.7384e-04, PNorm = 77.9047, GNorm = 0.3051, lr_0 = 1.1944e-04
Validation rmse = 0.611474
Epoch 27
Loss = 7.1037e-04, PNorm = 77.9116, GNorm = 0.9467, lr_0 = 1.1557e-04
Loss = 6.3599e-04, PNorm = 77.9190, GNorm = 0.5806, lr_0 = 1.1183e-04
Loss = 4.8784e-04, PNorm = 77.9246, GNorm = 0.9918, lr_0 = 1.0821e-04
Validation rmse = 0.619888
Epoch 28
Loss = 6.0492e-04, PNorm = 77.9313, GNorm = 0.3959, lr_0 = 1.0437e-04
Loss = 5.5544e-04, PNorm = 77.9383, GNorm = 0.3982, lr_0 = 1.0099e-04
Validation rmse = 0.605548
Epoch 29
Loss = 6.2957e-04, PNorm = 77.9449, GNorm = 0.3264, lr_0 = 1.0000e-04
Loss = 4.7735e-04, PNorm = 77.9522, GNorm = 1.4977, lr_0 = 1.0000e-04
Loss = 4.4770e-04, PNorm = 77.9580, GNorm = 0.7577, lr_0 = 1.0000e-04
Validation rmse = 0.605484
Model 0 best validation rmse = 0.586218 on epoch 23
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.637968
Ensemble test rmse = 0.637968
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 2.0461e-02, PNorm = 75.7817, GNorm = 9.5453, lr_0 = 2.9800e-04
Loss = 1.1190e-02, PNorm = 75.8414, GNorm = 1.7019, lr_0 = 4.7800e-04
Validation rmse = 1.248214
Epoch 1
Loss = 5.3406e-03, PNorm = 75.9320, GNorm = 2.0125, lr_0 = 6.7600e-04
Loss = 7.1934e-03, PNorm = 76.0187, GNorm = 14.3222, lr_0 = 8.5600e-04
Loss = 9.3319e-03, PNorm = 76.1300, GNorm = 3.6782, lr_0 = 9.9344e-04
Validation rmse = 1.090971
Epoch 2
Loss = 6.3016e-03, PNorm = 76.2400, GNorm = 3.7327, lr_0 = 9.6130e-04
Loss = 5.0837e-03, PNorm = 76.3277, GNorm = 2.6311, lr_0 = 9.3019e-04
Validation rmse = 0.948045
Epoch 3
Loss = 3.3237e-03, PNorm = 76.4110, GNorm = 1.4663, lr_0 = 9.0009e-04
Loss = 4.3061e-03, PNorm = 76.4800, GNorm = 5.8133, lr_0 = 8.7096e-04
Loss = 4.4534e-03, PNorm = 76.5420, GNorm = 2.8178, lr_0 = 8.4278e-04
Validation rmse = 0.841540
Epoch 4
Loss = 3.1373e-03, PNorm = 76.5880, GNorm = 3.3460, lr_0 = 8.1551e-04
Loss = 3.9124e-03, PNorm = 76.6332, GNorm = 4.3181, lr_0 = 7.8912e-04
Validation rmse = 0.844346
Epoch 5
Loss = 2.8504e-03, PNorm = 76.6812, GNorm = 2.8903, lr_0 = 7.6358e-04
Loss = 2.3380e-03, PNorm = 76.7198, GNorm = 0.7274, lr_0 = 7.3888e-04
Loss = 3.0507e-03, PNorm = 76.7589, GNorm = 2.9427, lr_0 = 7.1497e-04
Validation rmse = 0.799322
Epoch 6
Loss = 2.4457e-03, PNorm = 76.8076, GNorm = 1.2634, lr_0 = 6.8956e-04
Loss = 2.4816e-03, PNorm = 76.8379, GNorm = 2.0030, lr_0 = 6.6725e-04
Loss = 2.6072e-03, PNorm = 76.8739, GNorm = 4.0595, lr_0 = 6.4565e-04
Validation rmse = 0.703852
Epoch 7
Loss = 2.0566e-03, PNorm = 76.9107, GNorm = 1.8667, lr_0 = 6.2476e-04
Loss = 2.3515e-03, PNorm = 76.9447, GNorm = 1.4408, lr_0 = 6.0454e-04
Validation rmse = 0.755795
Epoch 8
Loss = 1.6961e-03, PNorm = 76.9760, GNorm = 0.8209, lr_0 = 5.8498e-04
Loss = 1.8209e-03, PNorm = 77.0079, GNorm = 1.1142, lr_0 = 5.6605e-04
Loss = 1.7425e-03, PNorm = 77.0387, GNorm = 1.2412, lr_0 = 5.4774e-04
Validation rmse = 0.706025
Epoch 9
Loss = 1.7699e-03, PNorm = 77.0705, GNorm = 0.5770, lr_0 = 5.3001e-04
Loss = 1.7154e-03, PNorm = 77.1038, GNorm = 1.0367, lr_0 = 5.1286e-04
Validation rmse = 0.645046
Epoch 10
Loss = 1.0268e-03, PNorm = 77.1336, GNorm = 0.9258, lr_0 = 4.9627e-04
Loss = 1.4274e-03, PNorm = 77.1620, GNorm = 0.9387, lr_0 = 4.8021e-04
Loss = 1.4646e-03, PNorm = 77.1848, GNorm = 1.4332, lr_0 = 4.6467e-04
Validation rmse = 0.645093
Epoch 11
Loss = 1.2394e-03, PNorm = 77.2110, GNorm = 1.2158, lr_0 = 4.4963e-04
Loss = 1.6406e-03, PNorm = 77.2399, GNorm = 1.3972, lr_0 = 4.3508e-04
Validation rmse = 0.710585
Epoch 12
Loss = 1.7810e-03, PNorm = 77.2700, GNorm = 1.6272, lr_0 = 4.1962e-04
Loss = 1.5094e-03, PNorm = 77.2969, GNorm = 0.9191, lr_0 = 4.0604e-04
Loss = 1.2961e-03, PNorm = 77.3257, GNorm = 0.6568, lr_0 = 3.9290e-04
Validation rmse = 0.642301
Epoch 13
Loss = 1.4075e-03, PNorm = 77.3465, GNorm = 1.1980, lr_0 = 3.8019e-04
Loss = 1.2483e-03, PNorm = 77.3665, GNorm = 0.6286, lr_0 = 3.6789e-04
Loss = 1.2671e-03, PNorm = 77.3936, GNorm = 1.2736, lr_0 = 3.5598e-04
Validation rmse = 0.633127
Epoch 14
Loss = 1.1566e-03, PNorm = 77.4191, GNorm = 1.9508, lr_0 = 3.4446e-04
Loss = 1.1977e-03, PNorm = 77.4402, GNorm = 2.1694, lr_0 = 3.3332e-04
Validation rmse = 0.644442
Epoch 15
Loss = 1.0273e-03, PNorm = 77.4590, GNorm = 1.0676, lr_0 = 3.2253e-04
Loss = 1.0719e-03, PNorm = 77.4823, GNorm = 1.6523, lr_0 = 3.1209e-04
Loss = 1.0258e-03, PNorm = 77.5032, GNorm = 0.9703, lr_0 = 3.0200e-04
Validation rmse = 0.645665
Epoch 16
Loss = 1.1198e-03, PNorm = 77.5220, GNorm = 0.7815, lr_0 = 2.9222e-04
Loss = 1.1131e-03, PNorm = 77.5453, GNorm = 0.3847, lr_0 = 2.8277e-04
Validation rmse = 0.618899
Epoch 17
Loss = 9.4353e-04, PNorm = 77.5648, GNorm = 1.7144, lr_0 = 2.7272e-04
Loss = 8.6286e-04, PNorm = 77.5804, GNorm = 1.1187, lr_0 = 2.6389e-04
Loss = 9.0148e-04, PNorm = 77.5974, GNorm = 1.3893, lr_0 = 2.5535e-04
Validation rmse = 0.613262
Epoch 18
Loss = 7.6508e-04, PNorm = 77.6142, GNorm = 1.2958, lr_0 = 2.4709e-04
Loss = 1.0038e-03, PNorm = 77.6300, GNorm = 0.5074, lr_0 = 2.3910e-04
Loss = 8.2241e-04, PNorm = 77.6479, GNorm = 0.8798, lr_0 = 2.3136e-04
Validation rmse = 0.613350
Epoch 19
Loss = 8.3582e-04, PNorm = 77.6659, GNorm = 0.6945, lr_0 = 2.2387e-04
Loss = 6.8644e-04, PNorm = 77.6815, GNorm = 1.3470, lr_0 = 2.1663e-04
Validation rmse = 0.584126
Epoch 20
Loss = 6.7024e-04, PNorm = 77.6946, GNorm = 0.4360, lr_0 = 2.0962e-04
Loss = 7.4280e-04, PNorm = 77.7086, GNorm = 0.6575, lr_0 = 2.0283e-04
Loss = 1.1326e-03, PNorm = 77.7220, GNorm = 1.8640, lr_0 = 1.9627e-04
Validation rmse = 0.649582
Epoch 21
Loss = 7.1215e-04, PNorm = 77.7353, GNorm = 0.3843, lr_0 = 1.8992e-04
Loss = 7.9255e-04, PNorm = 77.7500, GNorm = 0.4684, lr_0 = 1.8377e-04
Validation rmse = 0.612741
Epoch 22
Loss = 8.7527e-04, PNorm = 77.7609, GNorm = 0.6918, lr_0 = 1.7783e-04
Loss = 7.5601e-04, PNorm = 77.7718, GNorm = 1.1291, lr_0 = 1.7207e-04
Loss = 5.9008e-04, PNorm = 77.7815, GNorm = 0.5567, lr_0 = 1.6651e-04
Validation rmse = 0.606105
Epoch 23
Loss = 6.8475e-04, PNorm = 77.7942, GNorm = 0.8448, lr_0 = 1.6059e-04
Loss = 5.6315e-04, PNorm = 77.8033, GNorm = 0.3059, lr_0 = 1.5539e-04
Validation rmse = 0.617439
Epoch 24
Loss = 5.7575e-04, PNorm = 77.8137, GNorm = 1.1029, lr_0 = 1.5036e-04
Loss = 5.4121e-04, PNorm = 77.8240, GNorm = 0.3149, lr_0 = 1.4550e-04
Loss = 5.1839e-04, PNorm = 77.8327, GNorm = 0.9981, lr_0 = 1.4079e-04
Validation rmse = 0.663610
Epoch 25
Loss = 6.4106e-04, PNorm = 77.8411, GNorm = 2.0679, lr_0 = 1.3623e-04
Loss = 6.4311e-04, PNorm = 77.8488, GNorm = 2.1723, lr_0 = 1.3183e-04
Loss = 7.0840e-04, PNorm = 77.8569, GNorm = 0.8047, lr_0 = 1.2756e-04
Validation rmse = 0.622212
Epoch 26
Loss = 6.2602e-04, PNorm = 77.8657, GNorm = 0.5684, lr_0 = 1.2343e-04
Loss = 5.2269e-04, PNorm = 77.8753, GNorm = 0.4051, lr_0 = 1.1944e-04
Validation rmse = 0.596516
Epoch 27
Loss = 4.6115e-04, PNorm = 77.8831, GNorm = 0.4482, lr_0 = 1.1557e-04
Loss = 4.8316e-04, PNorm = 77.8910, GNorm = 0.4296, lr_0 = 1.1183e-04
Loss = 4.9649e-04, PNorm = 77.8973, GNorm = 0.5052, lr_0 = 1.0821e-04
Validation rmse = 0.602753
Epoch 28
Loss = 4.3180e-04, PNorm = 77.9037, GNorm = 0.2703, lr_0 = 1.0437e-04
Loss = 5.2035e-04, PNorm = 77.9104, GNorm = 0.3138, lr_0 = 1.0099e-04
Validation rmse = 0.587192
Epoch 29
Loss = 3.5781e-04, PNorm = 77.9170, GNorm = 0.6353, lr_0 = 1.0000e-04
Loss = 3.8682e-04, PNorm = 77.9230, GNorm = 0.5896, lr_0 = 1.0000e-04
Loss = 5.5749e-04, PNorm = 77.9285, GNorm = 0.4005, lr_0 = 1.0000e-04
Validation rmse = 0.597845
Model 0 best validation rmse = 0.584126 on epoch 19
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.866818
Ensemble test rmse = 0.866818
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 2.1273e-02, PNorm = 75.7827, GNorm = 5.7596, lr_0 = 2.9800e-04
Loss = 1.3319e-02, PNorm = 75.8422, GNorm = 13.4306, lr_0 = 4.7800e-04
Validation rmse = 1.931354
Epoch 1
Loss = 9.8342e-03, PNorm = 75.9349, GNorm = 2.4603, lr_0 = 6.7600e-04
Loss = 7.7812e-03, PNorm = 76.0308, GNorm = 2.3092, lr_0 = 8.5600e-04
Loss = 6.5326e-03, PNorm = 76.1324, GNorm = 1.2248, lr_0 = 9.9344e-04
Validation rmse = 1.249191
Epoch 2
Loss = 5.6022e-03, PNorm = 76.2338, GNorm = 1.4607, lr_0 = 9.6130e-04
Loss = 5.1348e-03, PNorm = 76.3269, GNorm = 2.7437, lr_0 = 9.3019e-04
Validation rmse = 0.955304
Epoch 3
Loss = 3.5176e-03, PNorm = 76.4077, GNorm = 1.4371, lr_0 = 9.0009e-04
Loss = 4.7149e-03, PNorm = 76.4721, GNorm = 2.4768, lr_0 = 8.7096e-04
Loss = 4.0771e-03, PNorm = 76.5366, GNorm = 2.6946, lr_0 = 8.4278e-04
Validation rmse = 0.947118
Epoch 4
Loss = 2.9216e-03, PNorm = 76.5915, GNorm = 3.8357, lr_0 = 8.1551e-04
Loss = 2.9683e-03, PNorm = 76.6422, GNorm = 3.8027, lr_0 = 7.8912e-04
Validation rmse = 0.970993
Epoch 5
Loss = 2.7944e-03, PNorm = 76.6898, GNorm = 2.6320, lr_0 = 7.6358e-04
Loss = 2.3369e-03, PNorm = 76.7313, GNorm = 3.7506, lr_0 = 7.3888e-04
Loss = 3.1803e-03, PNorm = 76.7744, GNorm = 1.8772, lr_0 = 7.1497e-04
Validation rmse = 0.986723
Epoch 6
Loss = 2.1794e-03, PNorm = 76.8172, GNorm = 0.6506, lr_0 = 6.8956e-04
Loss = 3.4844e-03, PNorm = 76.8616, GNorm = 2.9574, lr_0 = 6.6725e-04
Loss = 2.7798e-03, PNorm = 76.9060, GNorm = 3.7940, lr_0 = 6.4565e-04
Validation rmse = 0.917271
Epoch 7
Loss = 2.0243e-03, PNorm = 76.9412, GNorm = 0.5662, lr_0 = 6.2476e-04
Loss = 2.3082e-03, PNorm = 76.9672, GNorm = 3.1373, lr_0 = 6.0454e-04
Validation rmse = 0.813269
Epoch 8
Loss = 2.3263e-03, PNorm = 77.0036, GNorm = 4.2674, lr_0 = 5.8498e-04
Loss = 2.7038e-03, PNorm = 77.0411, GNorm = 0.7181, lr_0 = 5.6605e-04
Loss = 1.8044e-03, PNorm = 77.0702, GNorm = 0.6157, lr_0 = 5.4774e-04
Validation rmse = 0.799577
Epoch 9
Loss = 1.6939e-03, PNorm = 77.0968, GNorm = 3.5280, lr_0 = 5.3001e-04
Loss = 1.8448e-03, PNorm = 77.1235, GNorm = 1.1531, lr_0 = 5.1286e-04
Validation rmse = 0.801955
Epoch 10
Loss = 1.5339e-03, PNorm = 77.1475, GNorm = 0.6542, lr_0 = 4.9627e-04
Loss = 1.7616e-03, PNorm = 77.1725, GNorm = 0.9622, lr_0 = 4.8021e-04
Loss = 1.4248e-03, PNorm = 77.1966, GNorm = 1.9163, lr_0 = 4.6467e-04
Validation rmse = 0.820732
Epoch 11
Loss = 1.6758e-03, PNorm = 77.2176, GNorm = 4.4884, lr_0 = 4.4963e-04
Loss = 2.7722e-03, PNorm = 77.2462, GNorm = 3.1431, lr_0 = 4.3508e-04
Validation rmse = 0.912601
Epoch 12
Loss = 1.5452e-03, PNorm = 77.2783, GNorm = 1.3449, lr_0 = 4.1962e-04
Loss = 1.6249e-03, PNorm = 77.3115, GNorm = 0.8921, lr_0 = 4.0604e-04
Loss = 1.4157e-03, PNorm = 77.3355, GNorm = 0.7858, lr_0 = 3.9290e-04
Validation rmse = 0.777391
Epoch 13
Loss = 1.4268e-03, PNorm = 77.3540, GNorm = 1.8641, lr_0 = 3.8019e-04
Loss = 1.3865e-03, PNorm = 77.3730, GNorm = 1.2599, lr_0 = 3.6789e-04
Loss = 1.3247e-03, PNorm = 77.3906, GNorm = 1.6089, lr_0 = 3.5598e-04
Validation rmse = 0.880673
Epoch 14
Loss = 1.6439e-03, PNorm = 77.4127, GNorm = 1.8960, lr_0 = 3.4446e-04
Loss = 1.3349e-03, PNorm = 77.4335, GNorm = 1.7871, lr_0 = 3.3332e-04
Validation rmse = 0.752397
Epoch 15
Loss = 1.0021e-03, PNorm = 77.4540, GNorm = 2.6864, lr_0 = 3.2253e-04
Loss = 1.1443e-03, PNorm = 77.4697, GNorm = 0.6738, lr_0 = 3.1209e-04
Loss = 9.7935e-04, PNorm = 77.4857, GNorm = 1.1312, lr_0 = 3.0200e-04
Validation rmse = 0.784162
Epoch 16
Loss = 1.0613e-03, PNorm = 77.5037, GNorm = 0.6181, lr_0 = 2.9222e-04
Loss = 1.1369e-03, PNorm = 77.5192, GNorm = 0.9448, lr_0 = 2.8277e-04
Validation rmse = 0.748574
Epoch 17
Loss = 1.4098e-03, PNorm = 77.5370, GNorm = 1.3808, lr_0 = 2.7272e-04
Loss = 1.0567e-03, PNorm = 77.5545, GNorm = 0.5738, lr_0 = 2.6389e-04
Loss = 8.9360e-04, PNorm = 77.5692, GNorm = 0.3932, lr_0 = 2.5535e-04
Validation rmse = 0.743804
Epoch 18
Loss = 7.3016e-04, PNorm = 77.5839, GNorm = 0.7909, lr_0 = 2.4709e-04
Loss = 1.0106e-03, PNorm = 77.5991, GNorm = 1.1431, lr_0 = 2.3910e-04
Loss = 9.4339e-04, PNorm = 77.6152, GNorm = 0.3810, lr_0 = 2.3136e-04
Validation rmse = 0.763576
Epoch 19
Loss = 8.5802e-04, PNorm = 77.6286, GNorm = 0.8501, lr_0 = 2.2387e-04
Loss = 8.8931e-04, PNorm = 77.6438, GNorm = 0.5787, lr_0 = 2.1663e-04
Validation rmse = 0.753948
Epoch 20
Loss = 5.7648e-04, PNorm = 77.6574, GNorm = 0.3936, lr_0 = 2.0962e-04
Loss = 8.2680e-04, PNorm = 77.6688, GNorm = 0.6076, lr_0 = 2.0283e-04
Loss = 8.0539e-04, PNorm = 77.6802, GNorm = 1.6599, lr_0 = 1.9627e-04
Validation rmse = 0.757264
Epoch 21
Loss = 7.0108e-04, PNorm = 77.6925, GNorm = 0.4205, lr_0 = 1.8992e-04
Loss = 7.4757e-04, PNorm = 77.7052, GNorm = 1.0247, lr_0 = 1.8377e-04
Validation rmse = 0.740734
Epoch 22
Loss = 7.1704e-04, PNorm = 77.7167, GNorm = 0.5875, lr_0 = 1.7783e-04
Loss = 7.3620e-04, PNorm = 77.7244, GNorm = 1.3962, lr_0 = 1.7207e-04
Loss = 8.7140e-04, PNorm = 77.7360, GNorm = 1.0340, lr_0 = 1.6651e-04
Validation rmse = 0.747031
Epoch 23
Loss = 7.0883e-04, PNorm = 77.7501, GNorm = 0.8959, lr_0 = 1.6059e-04
Loss = 6.3646e-04, PNorm = 77.7601, GNorm = 0.8620, lr_0 = 1.5539e-04
Validation rmse = 0.754880
Epoch 24
Loss = 4.9390e-04, PNorm = 77.7696, GNorm = 0.4350, lr_0 = 1.5036e-04
Loss = 7.7371e-04, PNorm = 77.7782, GNorm = 2.0960, lr_0 = 1.4550e-04
Loss = 7.6338e-04, PNorm = 77.7888, GNorm = 0.6780, lr_0 = 1.4079e-04
Validation rmse = 0.734766
Epoch 25
Loss = 5.8996e-04, PNorm = 77.7985, GNorm = 0.6804, lr_0 = 1.3623e-04
Loss = 6.2424e-04, PNorm = 77.8071, GNorm = 0.8127, lr_0 = 1.3183e-04
Loss = 6.2379e-04, PNorm = 77.8150, GNorm = 0.6218, lr_0 = 1.2756e-04
Validation rmse = 0.753294
Epoch 26
Loss = 5.6991e-04, PNorm = 77.8233, GNorm = 0.8384, lr_0 = 1.2343e-04
Loss = 6.0060e-04, PNorm = 77.8306, GNorm = 0.9436, lr_0 = 1.1944e-04
Validation rmse = 0.729727
Epoch 27
Loss = 6.2612e-04, PNorm = 77.8393, GNorm = 0.7380, lr_0 = 1.1557e-04
Loss = 5.0357e-04, PNorm = 77.8464, GNorm = 0.4545, lr_0 = 1.1183e-04
Loss = 5.5795e-04, PNorm = 77.8528, GNorm = 0.3566, lr_0 = 1.0821e-04
Validation rmse = 0.725057
Epoch 28
Loss = 4.2940e-04, PNorm = 77.8616, GNorm = 0.3692, lr_0 = 1.0437e-04
Loss = 6.3387e-04, PNorm = 77.8685, GNorm = 0.2435, lr_0 = 1.0099e-04
Validation rmse = 0.790422
Epoch 29
Loss = 9.6672e-04, PNorm = 77.8762, GNorm = 0.4857, lr_0 = 1.0000e-04
Loss = 5.0445e-04, PNorm = 77.8834, GNorm = 0.7680, lr_0 = 1.0000e-04
Loss = 4.0512e-04, PNorm = 77.8900, GNorm = 0.4669, lr_0 = 1.0000e-04
Validation rmse = 0.725693
Model 0 best validation rmse = 0.725057 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.030011
Ensemble test rmse = 1.030011
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 1.9851e-02, PNorm = 75.7838, GNorm = 2.1212, lr_0 = 2.9800e-04
Loss = 1.3735e-02, PNorm = 75.8412, GNorm = 10.6059, lr_0 = 4.7800e-04
Validation rmse = 1.755342
Epoch 1
Loss = 9.1657e-03, PNorm = 75.9366, GNorm = 2.7332, lr_0 = 6.7600e-04
Loss = 8.0930e-03, PNorm = 76.0390, GNorm = 2.3145, lr_0 = 8.5600e-04
Loss = 1.0814e-02, PNorm = 76.1582, GNorm = 6.1058, lr_0 = 9.9344e-04
Validation rmse = 2.195776
Epoch 2
Loss = 8.0416e-03, PNorm = 76.3058, GNorm = 4.7247, lr_0 = 9.6130e-04
Loss = 7.1854e-03, PNorm = 76.4224, GNorm = 2.3022, lr_0 = 9.3019e-04
Validation rmse = 1.243735
Epoch 3
Loss = 4.9242e-03, PNorm = 76.5081, GNorm = 3.1966, lr_0 = 9.0009e-04
Loss = 4.7999e-03, PNorm = 76.5834, GNorm = 1.5152, lr_0 = 8.7096e-04
Loss = 4.5989e-03, PNorm = 76.6478, GNorm = 3.6787, lr_0 = 8.4278e-04
Validation rmse = 1.006472
Epoch 4
Loss = 3.3301e-03, PNorm = 76.7111, GNorm = 3.7734, lr_0 = 8.1551e-04
Loss = 3.4105e-03, PNorm = 76.7559, GNorm = 1.3774, lr_0 = 7.8912e-04
Validation rmse = 1.224555
Epoch 5
Loss = 3.9804e-03, PNorm = 76.8030, GNorm = 4.2213, lr_0 = 7.6358e-04
Loss = 3.2911e-03, PNorm = 76.8529, GNorm = 2.0025, lr_0 = 7.3888e-04
Loss = 3.6266e-03, PNorm = 76.9046, GNorm = 1.4444, lr_0 = 7.1497e-04
Validation rmse = 0.968597
Epoch 6
Loss = 2.4563e-03, PNorm = 76.9619, GNorm = 1.5794, lr_0 = 6.8956e-04
Loss = 2.9575e-03, PNorm = 77.0064, GNorm = 0.9320, lr_0 = 6.6725e-04
Loss = 2.1785e-03, PNorm = 77.0442, GNorm = 2.0196, lr_0 = 6.4565e-04
Validation rmse = 0.922622
Epoch 7
Loss = 2.0022e-03, PNorm = 77.0809, GNorm = 0.8005, lr_0 = 6.2476e-04
Loss = 2.1823e-03, PNorm = 77.1171, GNorm = 2.7463, lr_0 = 6.0454e-04
Validation rmse = 1.093092
Epoch 8
Loss = 1.9885e-03, PNorm = 77.1498, GNorm = 0.6998, lr_0 = 5.8498e-04
Loss = 2.0635e-03, PNorm = 77.1860, GNorm = 2.4073, lr_0 = 5.6605e-04
Loss = 2.1007e-03, PNorm = 77.2171, GNorm = 0.6201, lr_0 = 5.4774e-04
Validation rmse = 0.985526
Epoch 9
Loss = 1.8103e-03, PNorm = 77.2419, GNorm = 1.7425, lr_0 = 5.3001e-04
Loss = 2.0253e-03, PNorm = 77.2741, GNorm = 1.6272, lr_0 = 5.1286e-04
Validation rmse = 0.927040
Epoch 10
Loss = 1.4051e-03, PNorm = 77.3091, GNorm = 1.9155, lr_0 = 4.9627e-04
Loss = 1.5571e-03, PNorm = 77.3383, GNorm = 0.5196, lr_0 = 4.8021e-04
Loss = 2.0030e-03, PNorm = 77.3661, GNorm = 1.1698, lr_0 = 4.6467e-04
Validation rmse = 0.877272
Epoch 11
Loss = 1.3946e-03, PNorm = 77.4000, GNorm = 1.9386, lr_0 = 4.4963e-04
Loss = 2.0056e-03, PNorm = 77.4310, GNorm = 2.9587, lr_0 = 4.3508e-04
Validation rmse = 0.992915
Epoch 12
Loss = 1.8774e-03, PNorm = 77.4603, GNorm = 1.6500, lr_0 = 4.1962e-04
Loss = 1.4587e-03, PNorm = 77.4848, GNorm = 1.1136, lr_0 = 4.0604e-04
Loss = 1.2959e-03, PNorm = 77.5060, GNorm = 1.5591, lr_0 = 3.9290e-04
Validation rmse = 0.983118
Epoch 13
Loss = 1.5703e-03, PNorm = 77.5340, GNorm = 3.8687, lr_0 = 3.8019e-04
Loss = 1.2598e-03, PNorm = 77.5544, GNorm = 1.1658, lr_0 = 3.6789e-04
Loss = 1.3156e-03, PNorm = 77.5725, GNorm = 2.1192, lr_0 = 3.5598e-04
Validation rmse = 0.824434
Epoch 14
Loss = 1.7321e-03, PNorm = 77.6017, GNorm = 3.9705, lr_0 = 3.4446e-04
Loss = 1.3361e-03, PNorm = 77.6249, GNorm = 0.5561, lr_0 = 3.3332e-04
Validation rmse = 0.928173
Epoch 15
Loss = 1.5663e-03, PNorm = 77.6429, GNorm = 1.6258, lr_0 = 3.2253e-04
Loss = 1.0977e-03, PNorm = 77.6628, GNorm = 0.8156, lr_0 = 3.1209e-04
Loss = 1.0388e-03, PNorm = 77.6825, GNorm = 0.7704, lr_0 = 3.0200e-04
Validation rmse = 0.867516
Epoch 16
Loss = 1.1788e-03, PNorm = 77.7003, GNorm = 1.1243, lr_0 = 2.9222e-04
Loss = 1.0338e-03, PNorm = 77.7185, GNorm = 2.2661, lr_0 = 2.8277e-04
Validation rmse = 0.870008
Epoch 17
Loss = 1.2381e-03, PNorm = 77.7385, GNorm = 1.0821, lr_0 = 2.7272e-04
Loss = 1.0663e-03, PNorm = 77.7585, GNorm = 0.6446, lr_0 = 2.6389e-04
Loss = 8.8775e-04, PNorm = 77.7804, GNorm = 0.9549, lr_0 = 2.5535e-04
Validation rmse = 0.821158
Epoch 18
Loss = 9.7463e-04, PNorm = 77.7892, GNorm = 1.0496, lr_0 = 2.4709e-04
Loss = 8.7323e-04, PNorm = 77.8021, GNorm = 0.4748, lr_0 = 2.3910e-04
Loss = 9.0089e-04, PNorm = 77.8173, GNorm = 0.8248, lr_0 = 2.3136e-04
Validation rmse = 0.873072
Epoch 19
Loss = 9.2424e-04, PNorm = 77.8313, GNorm = 1.2863, lr_0 = 2.2387e-04
Loss = 9.9004e-04, PNorm = 77.8443, GNorm = 1.0147, lr_0 = 2.1663e-04
Validation rmse = 0.830142
Epoch 20
Loss = 7.8762e-04, PNorm = 77.8571, GNorm = 0.4868, lr_0 = 2.0962e-04
Loss = 8.5652e-04, PNorm = 77.8734, GNorm = 1.1527, lr_0 = 2.0283e-04
Loss = 7.9542e-04, PNorm = 77.8854, GNorm = 0.6170, lr_0 = 1.9627e-04
Validation rmse = 0.842479
Epoch 21
Loss = 7.7819e-04, PNorm = 77.8975, GNorm = 1.0818, lr_0 = 1.8992e-04
Loss = 7.3886e-04, PNorm = 77.9089, GNorm = 0.7112, lr_0 = 1.8377e-04
Validation rmse = 0.814791
Epoch 22
Loss = 6.1038e-04, PNorm = 77.9202, GNorm = 0.3957, lr_0 = 1.7783e-04
Loss = 5.2999e-04, PNorm = 77.9312, GNorm = 0.9049, lr_0 = 1.7207e-04
Loss = 7.7382e-04, PNorm = 77.9408, GNorm = 0.8319, lr_0 = 1.6651e-04
Validation rmse = 0.884976
Epoch 23
Loss = 6.6726e-04, PNorm = 77.9521, GNorm = 0.3579, lr_0 = 1.6059e-04
Loss = 6.0738e-04, PNorm = 77.9628, GNorm = 0.9619, lr_0 = 1.5539e-04
Validation rmse = 0.811968
Epoch 24
Loss = 6.2746e-04, PNorm = 77.9724, GNorm = 0.9939, lr_0 = 1.5036e-04
Loss = 7.5053e-04, PNorm = 77.9851, GNorm = 0.5330, lr_0 = 1.4550e-04
Loss = 6.4404e-04, PNorm = 77.9953, GNorm = 0.5664, lr_0 = 1.4079e-04
Validation rmse = 0.782449
Epoch 25
Loss = 6.1000e-04, PNorm = 78.0042, GNorm = 0.5031, lr_0 = 1.3623e-04
Loss = 5.6381e-04, PNorm = 78.0137, GNorm = 0.5963, lr_0 = 1.3183e-04
Loss = 6.0369e-04, PNorm = 78.0218, GNorm = 0.4516, lr_0 = 1.2756e-04
Validation rmse = 0.791711
Epoch 26
Loss = 5.9165e-04, PNorm = 78.0294, GNorm = 1.0532, lr_0 = 1.2343e-04
Loss = 5.4294e-04, PNorm = 78.0374, GNorm = 1.6447, lr_0 = 1.1944e-04
Validation rmse = 0.820926
Epoch 27
Loss = 4.8250e-04, PNorm = 78.0438, GNorm = 0.6212, lr_0 = 1.1557e-04
Loss = 5.9629e-04, PNorm = 78.0525, GNorm = 1.7214, lr_0 = 1.1183e-04
Loss = 6.2598e-04, PNorm = 78.0595, GNorm = 0.6273, lr_0 = 1.0821e-04
Validation rmse = 0.789097
Epoch 28
Loss = 6.0996e-04, PNorm = 78.0686, GNorm = 0.3587, lr_0 = 1.0437e-04
Loss = 5.0208e-04, PNorm = 78.0740, GNorm = 1.0414, lr_0 = 1.0099e-04
Validation rmse = 0.780912
Epoch 29
Loss = 3.6266e-04, PNorm = 78.0801, GNorm = 1.0533, lr_0 = 1.0000e-04
Loss = 5.5526e-04, PNorm = 78.0864, GNorm = 1.0163, lr_0 = 1.0000e-04
Loss = 5.1681e-04, PNorm = 78.0931, GNorm = 0.8159, lr_0 = 1.0000e-04
Validation rmse = 0.793743
Model 0 best validation rmse = 0.780912 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.672819
Ensemble test rmse = 0.672819
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 2.1084e-02, PNorm = 75.7813, GNorm = 5.3755, lr_0 = 2.9800e-04
Loss = 1.3358e-02, PNorm = 75.8440, GNorm = 7.5289, lr_0 = 4.7800e-04
Validation rmse = 1.672724
Epoch 1
Loss = 7.9857e-03, PNorm = 75.9464, GNorm = 4.7157, lr_0 = 6.7600e-04
Loss = 8.1691e-03, PNorm = 76.0408, GNorm = 5.3821, lr_0 = 8.5600e-04
Loss = 6.5282e-03, PNorm = 76.1513, GNorm = 0.9386, lr_0 = 9.9344e-04
Validation rmse = 1.461707
Epoch 2
Loss = 7.5279e-03, PNorm = 76.2572, GNorm = 2.4318, lr_0 = 9.6130e-04
Loss = 5.6514e-03, PNorm = 76.3438, GNorm = 2.6224, lr_0 = 9.3019e-04
Validation rmse = 1.346432
Epoch 3
Loss = 5.9752e-03, PNorm = 76.4345, GNorm = 2.2031, lr_0 = 9.0009e-04
Loss = 5.1268e-03, PNorm = 76.5203, GNorm = 1.2827, lr_0 = 8.7096e-04
Loss = 3.5355e-03, PNorm = 76.5834, GNorm = 1.4317, lr_0 = 8.4278e-04
Validation rmse = 1.188904
Epoch 4
Loss = 2.9726e-03, PNorm = 76.6427, GNorm = 0.9467, lr_0 = 8.1551e-04
Loss = 3.4852e-03, PNorm = 76.6890, GNorm = 1.2995, lr_0 = 7.8912e-04
Validation rmse = 1.248562
Epoch 5
Loss = 3.9653e-03, PNorm = 76.7359, GNorm = 4.9797, lr_0 = 7.6358e-04
Loss = 2.9271e-03, PNorm = 76.7816, GNorm = 1.0452, lr_0 = 7.3888e-04
Loss = 2.7825e-03, PNorm = 76.8258, GNorm = 0.8524, lr_0 = 7.1497e-04
Validation rmse = 1.192090
Epoch 6
Loss = 2.3088e-03, PNorm = 76.8804, GNorm = 2.3177, lr_0 = 6.8956e-04
Loss = 2.2870e-03, PNorm = 76.9251, GNorm = 4.4715, lr_0 = 6.6725e-04
Loss = 2.8262e-03, PNorm = 76.9622, GNorm = 1.8146, lr_0 = 6.4565e-04
Validation rmse = 1.054853
Epoch 7
Loss = 2.3319e-03, PNorm = 77.0023, GNorm = 1.3574, lr_0 = 6.2476e-04
Loss = 1.7862e-03, PNorm = 77.0426, GNorm = 1.0106, lr_0 = 6.0454e-04
Validation rmse = 0.963235
Epoch 8
Loss = 2.0453e-03, PNorm = 77.0731, GNorm = 3.2096, lr_0 = 5.8498e-04
Loss = 1.6736e-03, PNorm = 77.1074, GNorm = 1.5325, lr_0 = 5.6605e-04
Loss = 1.8243e-03, PNorm = 77.1368, GNorm = 1.4398, lr_0 = 5.4774e-04
Validation rmse = 1.033555
Epoch 9
Loss = 1.8557e-03, PNorm = 77.1739, GNorm = 1.4359, lr_0 = 5.3001e-04
Loss = 1.3070e-03, PNorm = 77.2060, GNorm = 0.7261, lr_0 = 5.1286e-04
Validation rmse = 0.965369
Epoch 10
Loss = 1.6303e-03, PNorm = 77.2386, GNorm = 1.8392, lr_0 = 4.9627e-04
Loss = 1.9235e-03, PNorm = 77.2715, GNorm = 0.8994, lr_0 = 4.8021e-04
Loss = 1.8152e-03, PNorm = 77.2988, GNorm = 1.3139, lr_0 = 4.6467e-04
Validation rmse = 1.121954
Epoch 11
Loss = 1.9786e-03, PNorm = 77.3308, GNorm = 1.4227, lr_0 = 4.4963e-04
Loss = 1.3357e-03, PNorm = 77.3581, GNorm = 0.7893, lr_0 = 4.3508e-04
Validation rmse = 0.999607
Epoch 12
Loss = 1.1806e-03, PNorm = 77.3887, GNorm = 0.6773, lr_0 = 4.1962e-04
Loss = 1.1835e-03, PNorm = 77.4129, GNorm = 0.7833, lr_0 = 4.0604e-04
Loss = 1.3799e-03, PNorm = 77.4309, GNorm = 1.4706, lr_0 = 3.9290e-04
Validation rmse = 1.030719
Epoch 13
Loss = 1.3331e-03, PNorm = 77.4592, GNorm = 2.0728, lr_0 = 3.8019e-04
Loss = 1.2267e-03, PNorm = 77.4812, GNorm = 1.2444, lr_0 = 3.6789e-04
Loss = 1.1629e-03, PNorm = 77.5033, GNorm = 0.4067, lr_0 = 3.5598e-04
Validation rmse = 0.960963
Epoch 14
Loss = 1.0705e-03, PNorm = 77.5236, GNorm = 1.0791, lr_0 = 3.4446e-04
Loss = 9.6436e-04, PNorm = 77.5421, GNorm = 0.6992, lr_0 = 3.3332e-04
Validation rmse = 0.949664
Epoch 15
Loss = 6.2379e-04, PNorm = 77.5640, GNorm = 0.3375, lr_0 = 3.2253e-04
Loss = 1.1868e-03, PNorm = 77.5827, GNorm = 2.3168, lr_0 = 3.1209e-04
Loss = 9.5850e-04, PNorm = 77.6014, GNorm = 1.3395, lr_0 = 3.0200e-04
Validation rmse = 0.966402
Epoch 16
Loss = 1.0682e-03, PNorm = 77.6179, GNorm = 0.8816, lr_0 = 2.9222e-04
Loss = 1.0326e-03, PNorm = 77.6373, GNorm = 0.7394, lr_0 = 2.8277e-04
Validation rmse = 0.949398
Epoch 17
Loss = 8.3610e-04, PNorm = 77.6613, GNorm = 0.6770, lr_0 = 2.7272e-04
Loss = 9.3340e-04, PNorm = 77.6780, GNorm = 0.6563, lr_0 = 2.6389e-04
Loss = 9.5056e-04, PNorm = 77.6957, GNorm = 1.5004, lr_0 = 2.5535e-04
Validation rmse = 1.015093
Epoch 18
Loss = 1.2545e-03, PNorm = 77.7109, GNorm = 0.5426, lr_0 = 2.4709e-04
Loss = 9.8067e-04, PNorm = 77.7277, GNorm = 0.8039, lr_0 = 2.3910e-04
Loss = 9.3638e-04, PNorm = 77.7416, GNorm = 0.9667, lr_0 = 2.3136e-04
Validation rmse = 0.958469
Epoch 19
Loss = 8.0750e-04, PNorm = 77.7546, GNorm = 0.5984, lr_0 = 2.2387e-04
Loss = 7.6416e-04, PNorm = 77.7696, GNorm = 0.9872, lr_0 = 2.1663e-04
Validation rmse = 0.936879
Epoch 20
Loss = 8.1426e-04, PNorm = 77.7818, GNorm = 1.1265, lr_0 = 2.0962e-04
Loss = 6.4898e-04, PNorm = 77.7963, GNorm = 0.4756, lr_0 = 2.0283e-04
Loss = 7.8752e-04, PNorm = 77.8097, GNorm = 0.4123, lr_0 = 1.9627e-04
Validation rmse = 0.939398
Epoch 21
Loss = 6.2711e-04, PNorm = 77.8209, GNorm = 0.4273, lr_0 = 1.8992e-04
Loss = 6.6536e-04, PNorm = 77.8325, GNorm = 1.4076, lr_0 = 1.8377e-04
Validation rmse = 0.935479
Epoch 22
Loss = 6.2053e-04, PNorm = 77.8418, GNorm = 0.6166, lr_0 = 1.7783e-04
Loss = 6.1995e-04, PNorm = 77.8522, GNorm = 0.4251, lr_0 = 1.7207e-04
Loss = 7.0291e-04, PNorm = 77.8631, GNorm = 1.1323, lr_0 = 1.6651e-04
Validation rmse = 0.930000
Epoch 23
Loss = 5.7182e-04, PNorm = 77.8744, GNorm = 1.3157, lr_0 = 1.6059e-04
Loss = 7.5759e-04, PNorm = 77.8838, GNorm = 1.1197, lr_0 = 1.5539e-04
Validation rmse = 0.948140
Epoch 24
Loss = 6.6851e-04, PNorm = 77.8941, GNorm = 1.0704, lr_0 = 1.5036e-04
Loss = 5.9732e-04, PNorm = 77.9038, GNorm = 0.5111, lr_0 = 1.4550e-04
Loss = 6.5345e-04, PNorm = 77.9139, GNorm = 0.4597, lr_0 = 1.4079e-04
Validation rmse = 0.923550
Epoch 25
Loss = 5.9674e-04, PNorm = 77.9225, GNorm = 0.5208, lr_0 = 1.3623e-04
Loss = 4.8185e-04, PNorm = 77.9297, GNorm = 0.5788, lr_0 = 1.3183e-04
Loss = 6.2896e-04, PNorm = 77.9381, GNorm = 0.4293, lr_0 = 1.2756e-04
Validation rmse = 0.929427
Epoch 26
Loss = 5.3135e-04, PNorm = 77.9452, GNorm = 1.3029, lr_0 = 1.2343e-04
Loss = 5.8340e-04, PNorm = 77.9534, GNorm = 0.7252, lr_0 = 1.1944e-04
Validation rmse = 0.928112
Epoch 27
Loss = 5.4348e-04, PNorm = 77.9616, GNorm = 0.7352, lr_0 = 1.1557e-04
Loss = 4.7726e-04, PNorm = 77.9686, GNorm = 1.2346, lr_0 = 1.1183e-04
Loss = 5.8659e-04, PNorm = 77.9765, GNorm = 0.9089, lr_0 = 1.0821e-04
Validation rmse = 0.954492
Epoch 28
Loss = 4.9094e-04, PNorm = 77.9835, GNorm = 0.3224, lr_0 = 1.0437e-04
Loss = 4.9730e-04, PNorm = 77.9905, GNorm = 1.4850, lr_0 = 1.0099e-04
Validation rmse = 0.922104
Epoch 29
Loss = 4.3098e-04, PNorm = 77.9966, GNorm = 0.6974, lr_0 = 1.0000e-04
Loss = 3.9609e-04, PNorm = 78.0018, GNorm = 0.3412, lr_0 = 1.0000e-04
Loss = 5.6524e-04, PNorm = 78.0078, GNorm = 0.3102, lr_0 = 1.0000e-04
Validation rmse = 0.923840
Model 0 best validation rmse = 0.922104 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.752020
Ensemble test rmse = 0.752020
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 1.5681e-02, PNorm = 75.7839, GNorm = 2.7702, lr_0 = 2.9800e-04
Loss = 1.0953e-02, PNorm = 75.8381, GNorm = 3.8422, lr_0 = 4.7800e-04
Validation rmse = 1.300758
Epoch 1
Loss = 9.0399e-03, PNorm = 75.9305, GNorm = 3.5541, lr_0 = 6.7600e-04
Loss = 8.5297e-03, PNorm = 76.0368, GNorm = 4.8235, lr_0 = 8.5600e-04
Loss = 6.2227e-03, PNorm = 76.1626, GNorm = 1.0130, lr_0 = 9.9344e-04
Validation rmse = 1.654987
Epoch 2
Loss = 6.3802e-03, PNorm = 76.2886, GNorm = 3.3133, lr_0 = 9.6130e-04
Loss = 5.9280e-03, PNorm = 76.3937, GNorm = 6.0222, lr_0 = 9.3019e-04
Validation rmse = 1.162245
Epoch 3
Loss = 4.4018e-03, PNorm = 76.4953, GNorm = 3.6005, lr_0 = 9.0009e-04
Loss = 3.8771e-03, PNorm = 76.5765, GNorm = 1.5884, lr_0 = 8.7096e-04
Loss = 4.3147e-03, PNorm = 76.6511, GNorm = 6.9617, lr_0 = 8.4278e-04
Validation rmse = 1.056633
Epoch 4
Loss = 4.0000e-03, PNorm = 76.7131, GNorm = 2.9410, lr_0 = 8.1551e-04
Loss = 3.4204e-03, PNorm = 76.7700, GNorm = 2.8409, lr_0 = 7.8912e-04
Validation rmse = 0.919412
Epoch 5
Loss = 2.7994e-03, PNorm = 76.8238, GNorm = 2.3208, lr_0 = 7.6358e-04
Loss = 3.0390e-03, PNorm = 76.8831, GNorm = 5.6798, lr_0 = 7.3888e-04
Loss = 2.9683e-03, PNorm = 76.9313, GNorm = 0.7654, lr_0 = 7.1497e-04
Validation rmse = 0.847467
Epoch 6
Loss = 2.4546e-03, PNorm = 76.9746, GNorm = 1.8490, lr_0 = 6.8956e-04
Loss = 2.7656e-03, PNorm = 77.0151, GNorm = 5.0108, lr_0 = 6.6725e-04
Loss = 2.9573e-03, PNorm = 77.0587, GNorm = 4.9065, lr_0 = 6.4565e-04
Validation rmse = 0.911755
Epoch 7
Loss = 3.0711e-03, PNorm = 77.1112, GNorm = 2.1031, lr_0 = 6.2476e-04
Loss = 2.1980e-03, PNorm = 77.1504, GNorm = 0.6517, lr_0 = 6.0454e-04
Validation rmse = 0.812524
Epoch 8
Loss = 1.2582e-03, PNorm = 77.1833, GNorm = 1.2804, lr_0 = 5.8498e-04
Loss = 1.7972e-03, PNorm = 77.2129, GNorm = 3.0843, lr_0 = 5.6605e-04
Loss = 1.6846e-03, PNorm = 77.2459, GNorm = 1.4032, lr_0 = 5.4774e-04
Validation rmse = 0.836338
Epoch 9
Loss = 1.5470e-03, PNorm = 77.2790, GNorm = 0.7251, lr_0 = 5.3001e-04
Loss = 1.9844e-03, PNorm = 77.3066, GNorm = 1.0281, lr_0 = 5.1286e-04
Validation rmse = 0.877995
Epoch 10
Loss = 2.0730e-03, PNorm = 77.3351, GNorm = 3.1003, lr_0 = 4.9627e-04
Loss = 1.4017e-03, PNorm = 77.3665, GNorm = 1.0062, lr_0 = 4.8021e-04
Loss = 1.5712e-03, PNorm = 77.3895, GNorm = 1.4156, lr_0 = 4.6467e-04
Validation rmse = 0.827503
Epoch 11
Loss = 1.4264e-03, PNorm = 77.4093, GNorm = 0.6921, lr_0 = 4.4963e-04
Loss = 1.1663e-03, PNorm = 77.4291, GNorm = 0.4236, lr_0 = 4.3508e-04
Validation rmse = 0.750808
Epoch 12
Loss = 1.2916e-03, PNorm = 77.4502, GNorm = 1.4928, lr_0 = 4.1962e-04
Loss = 1.0777e-03, PNorm = 77.4706, GNorm = 0.7499, lr_0 = 4.0604e-04
Loss = 1.3430e-03, PNorm = 77.4886, GNorm = 0.8939, lr_0 = 3.9290e-04
Validation rmse = 0.776085
Epoch 13
Loss = 1.3321e-03, PNorm = 77.5073, GNorm = 1.1279, lr_0 = 3.8019e-04
Loss = 1.0443e-03, PNorm = 77.5272, GNorm = 0.5937, lr_0 = 3.6789e-04
Loss = 1.2740e-03, PNorm = 77.5466, GNorm = 1.4956, lr_0 = 3.5598e-04
Validation rmse = 0.743735
Epoch 14
Loss = 9.3407e-04, PNorm = 77.5650, GNorm = 0.6877, lr_0 = 3.4446e-04
Loss = 1.1869e-03, PNorm = 77.5880, GNorm = 1.1746, lr_0 = 3.3332e-04
Validation rmse = 0.765236
Epoch 15
Loss = 5.2481e-04, PNorm = 77.6066, GNorm = 0.6279, lr_0 = 3.2253e-04
Loss = 1.0765e-03, PNorm = 77.6242, GNorm = 1.5363, lr_0 = 3.1209e-04
Loss = 1.0103e-03, PNorm = 77.6444, GNorm = 0.5828, lr_0 = 3.0200e-04
Validation rmse = 0.765146
Epoch 16
Loss = 7.7173e-04, PNorm = 77.6600, GNorm = 1.1428, lr_0 = 2.9222e-04
Loss = 9.5182e-04, PNorm = 77.6733, GNorm = 1.1933, lr_0 = 2.8277e-04
Validation rmse = 0.813291
Epoch 17
Loss = 7.9236e-04, PNorm = 77.6909, GNorm = 0.8552, lr_0 = 2.7272e-04
Loss = 7.4487e-04, PNorm = 77.7051, GNorm = 0.5618, lr_0 = 2.6389e-04
Loss = 9.4749e-04, PNorm = 77.7194, GNorm = 1.8354, lr_0 = 2.5535e-04
Validation rmse = 0.765154
Epoch 18
Loss = 8.2271e-04, PNorm = 77.7354, GNorm = 0.7297, lr_0 = 2.4709e-04
Loss = 7.7844e-04, PNorm = 77.7463, GNorm = 0.4184, lr_0 = 2.3910e-04
Loss = 8.1990e-04, PNorm = 77.7604, GNorm = 1.2688, lr_0 = 2.3136e-04
Validation rmse = 0.778858
Epoch 19
Loss = 8.0094e-04, PNorm = 77.7733, GNorm = 2.4525, lr_0 = 2.2387e-04
Loss = 7.8270e-04, PNorm = 77.7854, GNorm = 0.7241, lr_0 = 2.1663e-04
Validation rmse = 0.753629
Epoch 20
Loss = 9.4081e-04, PNorm = 77.7977, GNorm = 0.7235, lr_0 = 2.0962e-04
Loss = 7.2190e-04, PNorm = 77.8099, GNorm = 1.8426, lr_0 = 2.0283e-04
Loss = 7.0036e-04, PNorm = 77.8217, GNorm = 0.4954, lr_0 = 1.9627e-04
Validation rmse = 0.731104
Epoch 21
Loss = 6.8737e-04, PNorm = 77.8325, GNorm = 1.7705, lr_0 = 1.8992e-04
Loss = 6.5737e-04, PNorm = 77.8432, GNorm = 0.5254, lr_0 = 1.8377e-04
Validation rmse = 0.744026
Epoch 22
Loss = 5.8223e-04, PNorm = 77.8515, GNorm = 0.3309, lr_0 = 1.7783e-04
Loss = 5.7769e-04, PNorm = 77.8615, GNorm = 0.8495, lr_0 = 1.7207e-04
Loss = 6.3713e-04, PNorm = 77.8720, GNorm = 0.5316, lr_0 = 1.6651e-04
Validation rmse = 0.753631
Epoch 23
Loss = 4.6745e-04, PNorm = 77.8822, GNorm = 0.4636, lr_0 = 1.6059e-04
Loss = 5.9673e-04, PNorm = 77.8902, GNorm = 0.3221, lr_0 = 1.5539e-04
Validation rmse = 0.749823
Epoch 24
Loss = 3.0316e-04, PNorm = 77.8981, GNorm = 0.2723, lr_0 = 1.5036e-04
Loss = 5.5427e-04, PNorm = 77.9061, GNorm = 0.6088, lr_0 = 1.4550e-04
Loss = 5.6722e-04, PNorm = 77.9158, GNorm = 0.7490, lr_0 = 1.4079e-04
Validation rmse = 0.733855
Epoch 25
Loss = 4.5440e-04, PNorm = 77.9249, GNorm = 0.3674, lr_0 = 1.3623e-04
Loss = 5.5155e-04, PNorm = 77.9326, GNorm = 0.4297, lr_0 = 1.3183e-04
Loss = 5.8101e-04, PNorm = 77.9415, GNorm = 0.4506, lr_0 = 1.2756e-04
Validation rmse = 0.729347
Epoch 26
Loss = 4.0119e-04, PNorm = 77.9493, GNorm = 0.3100, lr_0 = 1.2343e-04
Loss = 4.9581e-04, PNorm = 77.9567, GNorm = 0.5109, lr_0 = 1.1944e-04
Validation rmse = 0.730748
Epoch 27
Loss = 4.4483e-04, PNorm = 77.9637, GNorm = 1.3980, lr_0 = 1.1557e-04
Loss = 5.8980e-04, PNorm = 77.9703, GNorm = 0.3053, lr_0 = 1.1183e-04
Loss = 5.6789e-04, PNorm = 77.9771, GNorm = 0.6821, lr_0 = 1.0821e-04
Validation rmse = 0.716827
Epoch 28
Loss = 5.0494e-04, PNorm = 77.9828, GNorm = 0.3723, lr_0 = 1.0437e-04
Loss = 4.6850e-04, PNorm = 77.9892, GNorm = 0.4171, lr_0 = 1.0099e-04
Validation rmse = 0.720497
Epoch 29
Loss = 3.1986e-04, PNorm = 77.9958, GNorm = 0.5035, lr_0 = 1.0000e-04
Loss = 4.9012e-04, PNorm = 78.0025, GNorm = 1.0804, lr_0 = 1.0000e-04
Loss = 5.6965e-04, PNorm = 78.0092, GNorm = 1.4871, lr_0 = 1.0000e-04
Validation rmse = 0.715603
Model 0 best validation rmse = 0.715603 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.707304
Ensemble test rmse = 0.707304
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 2.3349e-02, PNorm = 75.7834, GNorm = 7.5468, lr_0 = 2.9800e-04
Loss = 1.3759e-02, PNorm = 75.8491, GNorm = 2.2462, lr_0 = 4.7800e-04
Validation rmse = 1.847796
Epoch 1
Loss = 1.0606e-02, PNorm = 75.9527, GNorm = 5.2483, lr_0 = 6.7600e-04
Loss = 8.8139e-03, PNorm = 76.0571, GNorm = 2.4218, lr_0 = 8.5600e-04
Loss = 6.7912e-03, PNorm = 76.1540, GNorm = 2.0051, lr_0 = 9.9344e-04
Validation rmse = 1.394384
Epoch 2
Loss = 6.2784e-03, PNorm = 76.2541, GNorm = 3.6372, lr_0 = 9.6130e-04
Loss = 4.9815e-03, PNorm = 76.3407, GNorm = 5.6320, lr_0 = 9.3019e-04
Validation rmse = 1.321677
Epoch 3
Loss = 5.3053e-03, PNorm = 76.4263, GNorm = 3.9702, lr_0 = 9.0009e-04
Loss = 4.8070e-03, PNorm = 76.4976, GNorm = 2.6231, lr_0 = 8.7096e-04
Loss = 4.3285e-03, PNorm = 76.5630, GNorm = 5.4156, lr_0 = 8.4278e-04
Validation rmse = 1.125107
Epoch 4
Loss = 4.5026e-03, PNorm = 76.6181, GNorm = 1.0674, lr_0 = 8.1551e-04
Loss = 4.1224e-03, PNorm = 76.6722, GNorm = 3.6388, lr_0 = 7.8912e-04
Validation rmse = 1.124417
Epoch 5
Loss = 2.0640e-03, PNorm = 76.7174, GNorm = 1.7986, lr_0 = 7.6358e-04
Loss = 2.7548e-03, PNorm = 76.7604, GNorm = 1.0109, lr_0 = 7.3888e-04
Loss = 3.6488e-03, PNorm = 76.8012, GNorm = 0.7001, lr_0 = 7.1497e-04
Validation rmse = 1.104025
Epoch 6
Loss = 2.7984e-03, PNorm = 76.8524, GNorm = 0.8712, lr_0 = 6.8956e-04
Loss = 2.4808e-03, PNorm = 76.8963, GNorm = 1.2233, lr_0 = 6.6725e-04
Loss = 2.4885e-03, PNorm = 76.9241, GNorm = 1.9834, lr_0 = 6.4565e-04
Validation rmse = 0.943339
Epoch 7
Loss = 2.1224e-03, PNorm = 76.9605, GNorm = 0.7042, lr_0 = 6.2476e-04
Loss = 2.0601e-03, PNorm = 76.9908, GNorm = 1.5521, lr_0 = 6.0454e-04
Validation rmse = 0.944691
Epoch 8
Loss = 1.8483e-03, PNorm = 77.0217, GNorm = 2.1713, lr_0 = 5.8498e-04
Loss = 1.9585e-03, PNorm = 77.0533, GNorm = 0.9191, lr_0 = 5.6605e-04
Loss = 1.6151e-03, PNorm = 77.0783, GNorm = 1.0245, lr_0 = 5.4774e-04
Validation rmse = 0.961750
Epoch 9
Loss = 1.6113e-03, PNorm = 77.1011, GNorm = 0.8038, lr_0 = 5.3001e-04
Loss = 1.6191e-03, PNorm = 77.1324, GNorm = 1.4596, lr_0 = 5.1286e-04
Validation rmse = 0.914776
Epoch 10
Loss = 1.7349e-03, PNorm = 77.1566, GNorm = 3.1748, lr_0 = 4.9627e-04
Loss = 2.7285e-03, PNorm = 77.1840, GNorm = 4.2980, lr_0 = 4.8021e-04
Loss = 2.3829e-03, PNorm = 77.2156, GNorm = 2.6401, lr_0 = 4.6467e-04
Validation rmse = 0.944141
Epoch 11
Loss = 2.0761e-03, PNorm = 77.2463, GNorm = 1.2324, lr_0 = 4.4963e-04
Loss = 1.7497e-03, PNorm = 77.2763, GNorm = 2.2934, lr_0 = 4.3508e-04
Validation rmse = 0.902512
Epoch 12
Loss = 1.6308e-03, PNorm = 77.3047, GNorm = 1.0080, lr_0 = 4.1962e-04
Loss = 1.4392e-03, PNorm = 77.3249, GNorm = 2.5039, lr_0 = 4.0604e-04
Loss = 1.4828e-03, PNorm = 77.3482, GNorm = 2.1580, lr_0 = 3.9290e-04
Validation rmse = 0.897043
Epoch 13
Loss = 1.5115e-03, PNorm = 77.3701, GNorm = 1.4446, lr_0 = 3.8019e-04
Loss = 1.3800e-03, PNorm = 77.3898, GNorm = 1.8591, lr_0 = 3.6789e-04
Loss = 1.3098e-03, PNorm = 77.4100, GNorm = 0.4916, lr_0 = 3.5598e-04
Validation rmse = 0.866445
Epoch 14
Loss = 9.7732e-04, PNorm = 77.4286, GNorm = 0.4569, lr_0 = 3.4446e-04
Loss = 1.2333e-03, PNorm = 77.4478, GNorm = 0.5672, lr_0 = 3.3332e-04
Validation rmse = 0.876357
Epoch 15
Loss = 1.3367e-03, PNorm = 77.4640, GNorm = 1.4467, lr_0 = 3.2253e-04
Loss = 1.2305e-03, PNorm = 77.4841, GNorm = 1.6590, lr_0 = 3.1209e-04
Loss = 1.1545e-03, PNorm = 77.5018, GNorm = 0.7930, lr_0 = 3.0200e-04
Validation rmse = 0.922755
Epoch 16
Loss = 1.0510e-03, PNorm = 77.5148, GNorm = 0.7954, lr_0 = 2.9222e-04
Loss = 1.0509e-03, PNorm = 77.5317, GNorm = 0.7345, lr_0 = 2.8277e-04
Validation rmse = 0.932172
Epoch 17
Loss = 6.6814e-04, PNorm = 77.5511, GNorm = 1.1846, lr_0 = 2.7272e-04
Loss = 1.0808e-03, PNorm = 77.5693, GNorm = 0.6163, lr_0 = 2.6389e-04
Loss = 1.0086e-03, PNorm = 77.5867, GNorm = 1.2344, lr_0 = 2.5535e-04
Validation rmse = 0.881106
Epoch 18
Loss = 8.2287e-04, PNorm = 77.6011, GNorm = 1.5781, lr_0 = 2.4709e-04
Loss = 1.0820e-03, PNorm = 77.6133, GNorm = 0.6558, lr_0 = 2.3910e-04
Loss = 1.2365e-03, PNorm = 77.6283, GNorm = 0.8879, lr_0 = 2.3136e-04
Validation rmse = 0.884533
Epoch 19
Loss = 9.8697e-04, PNorm = 77.6452, GNorm = 0.7391, lr_0 = 2.2387e-04
Loss = 8.3888e-04, PNorm = 77.6605, GNorm = 1.1404, lr_0 = 2.1663e-04
Validation rmse = 0.894475
Epoch 20
Loss = 8.2155e-04, PNorm = 77.6719, GNorm = 0.5403, lr_0 = 2.0962e-04
Loss = 8.1845e-04, PNorm = 77.6867, GNorm = 0.6632, lr_0 = 2.0283e-04
Loss = 9.4853e-04, PNorm = 77.7000, GNorm = 1.5226, lr_0 = 1.9627e-04
Validation rmse = 0.897541
Epoch 21
Loss = 7.2555e-04, PNorm = 77.7112, GNorm = 0.3401, lr_0 = 1.8992e-04
Loss = 8.2738e-04, PNorm = 77.7241, GNorm = 0.5657, lr_0 = 1.8377e-04
Validation rmse = 0.890273
Epoch 22
Loss = 6.5369e-04, PNorm = 77.7364, GNorm = 0.8269, lr_0 = 1.7783e-04
Loss = 6.6128e-04, PNorm = 77.7483, GNorm = 0.7223, lr_0 = 1.7207e-04
Loss = 7.7926e-04, PNorm = 77.7591, GNorm = 0.9967, lr_0 = 1.6651e-04
Validation rmse = 0.892094
Epoch 23
Loss = 6.7087e-04, PNorm = 77.7715, GNorm = 0.6074, lr_0 = 1.6059e-04
Loss = 7.3915e-04, PNorm = 77.7833, GNorm = 0.9089, lr_0 = 1.5539e-04
Validation rmse = 0.876811
Epoch 24
Loss = 4.6363e-04, PNorm = 77.7955, GNorm = 0.5255, lr_0 = 1.5036e-04
Loss = 7.5860e-04, PNorm = 77.8069, GNorm = 0.5160, lr_0 = 1.4550e-04
Loss = 5.9198e-04, PNorm = 77.8164, GNorm = 0.5971, lr_0 = 1.4079e-04
Validation rmse = 0.885076
Epoch 25
Loss = 5.4752e-04, PNorm = 77.8243, GNorm = 0.8894, lr_0 = 1.3623e-04
Loss = 6.7730e-04, PNorm = 77.8326, GNorm = 0.7249, lr_0 = 1.3183e-04
Loss = 6.2582e-04, PNorm = 77.8412, GNorm = 0.6951, lr_0 = 1.2756e-04
Validation rmse = 0.910229
Epoch 26
Loss = 6.4818e-04, PNorm = 77.8488, GNorm = 0.8937, lr_0 = 1.2343e-04
Loss = 5.9825e-04, PNorm = 77.8574, GNorm = 0.8042, lr_0 = 1.1944e-04
Validation rmse = 0.900097
Epoch 27
Loss = 7.3248e-04, PNorm = 77.8648, GNorm = 1.6212, lr_0 = 1.1557e-04
Loss = 5.5642e-04, PNorm = 77.8725, GNorm = 0.8323, lr_0 = 1.1183e-04
Loss = 6.4101e-04, PNorm = 77.8803, GNorm = 0.4749, lr_0 = 1.0821e-04
Validation rmse = 0.884569
Epoch 28
Loss = 6.2502e-04, PNorm = 77.8896, GNorm = 1.4179, lr_0 = 1.0437e-04
Loss = 5.2919e-04, PNorm = 77.8972, GNorm = 0.4083, lr_0 = 1.0099e-04
Validation rmse = 0.890666
Epoch 29
Loss = 3.3038e-04, PNorm = 77.9034, GNorm = 0.2479, lr_0 = 1.0000e-04
Loss = 5.5152e-04, PNorm = 77.9098, GNorm = 0.4998, lr_0 = 1.0000e-04
Loss = 5.9878e-04, PNorm = 77.9161, GNorm = 1.2104, lr_0 = 1.0000e-04
Validation rmse = 0.924773
Model 0 best validation rmse = 0.866445 on epoch 13
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.697140
Ensemble test rmse = 0.697140
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 1.9870e-02, PNorm = 75.7844, GNorm = 3.2316, lr_0 = 2.9800e-04
Loss = 1.2819e-02, PNorm = 75.8447, GNorm = 2.7859, lr_0 = 4.7800e-04
Validation rmse = 1.495126
Epoch 1
Loss = 8.6717e-03, PNorm = 75.9374, GNorm = 6.0541, lr_0 = 6.7600e-04
Loss = 7.4490e-03, PNorm = 76.0311, GNorm = 4.0641, lr_0 = 8.5600e-04
Loss = 7.0450e-03, PNorm = 76.1415, GNorm = 3.9551, lr_0 = 9.9344e-04
Validation rmse = 1.484081
Epoch 2
Loss = 5.3262e-03, PNorm = 76.2472, GNorm = 3.2052, lr_0 = 9.6130e-04
Loss = 4.8680e-03, PNorm = 76.3471, GNorm = 3.6298, lr_0 = 9.3019e-04
Validation rmse = 1.092536
Epoch 3
Loss = 3.8137e-03, PNorm = 76.4248, GNorm = 3.1522, lr_0 = 9.0009e-04
Loss = 4.8410e-03, PNorm = 76.4879, GNorm = 5.2843, lr_0 = 8.7096e-04
Loss = 3.7812e-03, PNorm = 76.5497, GNorm = 1.9150, lr_0 = 8.4278e-04
Validation rmse = 1.032870
Epoch 4
Loss = 3.2277e-03, PNorm = 76.5985, GNorm = 1.0576, lr_0 = 8.1551e-04
Loss = 3.3565e-03, PNorm = 76.6418, GNorm = 1.5734, lr_0 = 7.8912e-04
Validation rmse = 0.962974
Epoch 5
Loss = 2.6877e-03, PNorm = 76.6876, GNorm = 0.8643, lr_0 = 7.6358e-04
Loss = 3.2825e-03, PNorm = 76.7315, GNorm = 2.0658, lr_0 = 7.3888e-04
Loss = 2.3173e-03, PNorm = 76.7692, GNorm = 0.8912, lr_0 = 7.1497e-04
Validation rmse = 0.914283
Epoch 6
Loss = 2.3615e-03, PNorm = 76.8178, GNorm = 1.3550, lr_0 = 6.8956e-04
Loss = 2.7629e-03, PNorm = 76.8580, GNorm = 0.5997, lr_0 = 6.6725e-04
Loss = 2.0661e-03, PNorm = 76.8903, GNorm = 3.4750, lr_0 = 6.4565e-04
Validation rmse = 0.943213
Epoch 7
Loss = 2.0422e-03, PNorm = 76.9248, GNorm = 1.3236, lr_0 = 6.2476e-04
Loss = 1.8649e-03, PNorm = 76.9543, GNorm = 1.3130, lr_0 = 6.0454e-04
Validation rmse = 0.833661
Epoch 8
Loss = 2.2485e-03, PNorm = 76.9883, GNorm = 1.1157, lr_0 = 5.8498e-04
Loss = 1.9607e-03, PNorm = 77.0255, GNorm = 0.7092, lr_0 = 5.6605e-04
Loss = 1.7690e-03, PNorm = 77.0551, GNorm = 0.9145, lr_0 = 5.4774e-04
Validation rmse = 0.785163
Epoch 9
Loss = 1.4067e-03, PNorm = 77.0823, GNorm = 0.3865, lr_0 = 5.3001e-04
Loss = 1.7693e-03, PNorm = 77.1116, GNorm = 2.9192, lr_0 = 5.1286e-04
Validation rmse = 0.872797
Epoch 10
Loss = 1.5058e-03, PNorm = 77.1442, GNorm = 0.7480, lr_0 = 4.9627e-04
Loss = 1.5304e-03, PNorm = 77.1729, GNorm = 0.9005, lr_0 = 4.8021e-04
Loss = 1.5002e-03, PNorm = 77.1989, GNorm = 0.6518, lr_0 = 4.6467e-04
Validation rmse = 0.812760
Epoch 11
Loss = 1.3035e-03, PNorm = 77.2278, GNorm = 0.6355, lr_0 = 4.4963e-04
Loss = 1.5447e-03, PNorm = 77.2574, GNorm = 1.7577, lr_0 = 4.3508e-04
Validation rmse = 0.778771
Epoch 12
Loss = 6.8912e-04, PNorm = 77.2851, GNorm = 0.6145, lr_0 = 4.1962e-04
Loss = 1.2789e-03, PNorm = 77.3069, GNorm = 1.7001, lr_0 = 4.0604e-04
Loss = 1.0992e-03, PNorm = 77.3245, GNorm = 1.1909, lr_0 = 3.9290e-04
Validation rmse = 0.763284
Epoch 13
Loss = 1.2622e-03, PNorm = 77.3436, GNorm = 2.2535, lr_0 = 3.8019e-04
Loss = 1.0575e-03, PNorm = 77.3709, GNorm = 0.6658, lr_0 = 3.6789e-04
Loss = 1.4389e-03, PNorm = 77.3898, GNorm = 2.0462, lr_0 = 3.5598e-04
Validation rmse = 0.706003
Epoch 14
Loss = 1.3987e-03, PNorm = 77.4141, GNorm = 2.4415, lr_0 = 3.4446e-04
Loss = 1.1273e-03, PNorm = 77.4386, GNorm = 0.9907, lr_0 = 3.3332e-04
Validation rmse = 0.895758
Epoch 15
Loss = 1.8121e-03, PNorm = 77.4622, GNorm = 1.0962, lr_0 = 3.2253e-04
Loss = 1.2414e-03, PNorm = 77.4847, GNorm = 1.1697, lr_0 = 3.1209e-04
Loss = 9.3714e-04, PNorm = 77.5022, GNorm = 0.8139, lr_0 = 3.0200e-04
Validation rmse = 0.774749
Epoch 16
Loss = 9.2010e-04, PNorm = 77.5182, GNorm = 0.7057, lr_0 = 2.9222e-04
Loss = 8.9892e-04, PNorm = 77.5317, GNorm = 0.9188, lr_0 = 2.8277e-04
Validation rmse = 0.715536
Epoch 17
Loss = 9.7205e-04, PNorm = 77.5499, GNorm = 1.2748, lr_0 = 2.7272e-04
Loss = 9.3298e-04, PNorm = 77.5641, GNorm = 0.4782, lr_0 = 2.6389e-04
Loss = 8.5334e-04, PNorm = 77.5785, GNorm = 0.8984, lr_0 = 2.5535e-04
Validation rmse = 0.698475
Epoch 18
Loss = 9.8005e-04, PNorm = 77.5943, GNorm = 0.7813, lr_0 = 2.4709e-04
Loss = 9.6672e-04, PNorm = 77.6088, GNorm = 1.4923, lr_0 = 2.3910e-04
Loss = 7.9597e-04, PNorm = 77.6183, GNorm = 0.5355, lr_0 = 2.3136e-04
Validation rmse = 0.680488
Epoch 19
Loss = 9.0099e-04, PNorm = 77.6301, GNorm = 0.8194, lr_0 = 2.2387e-04
Loss = 7.8642e-04, PNorm = 77.6423, GNorm = 0.5547, lr_0 = 2.1663e-04
Validation rmse = 0.662157
Epoch 20
Loss = 5.4458e-04, PNorm = 77.6563, GNorm = 0.6922, lr_0 = 2.0962e-04
Loss = 9.0783e-04, PNorm = 77.6676, GNorm = 1.6505, lr_0 = 2.0283e-04
Loss = 7.4534e-04, PNorm = 77.6784, GNorm = 0.4616, lr_0 = 1.9627e-04
Validation rmse = 0.659547
Epoch 21
Loss = 6.6971e-04, PNorm = 77.6894, GNorm = 0.4682, lr_0 = 1.8992e-04
Loss = 7.4076e-04, PNorm = 77.7019, GNorm = 0.4791, lr_0 = 1.8377e-04
Validation rmse = 0.674588
Epoch 22
Loss = 5.3293e-04, PNorm = 77.7126, GNorm = 0.5832, lr_0 = 1.7783e-04
Loss = 5.4047e-04, PNorm = 77.7211, GNorm = 0.6503, lr_0 = 1.7207e-04
Loss = 7.2030e-04, PNorm = 77.7310, GNorm = 0.3399, lr_0 = 1.6651e-04
Validation rmse = 0.670657
Epoch 23
Loss = 7.1459e-04, PNorm = 77.7424, GNorm = 0.4719, lr_0 = 1.6059e-04
Loss = 6.5382e-04, PNorm = 77.7524, GNorm = 1.1458, lr_0 = 1.5539e-04
Validation rmse = 0.707632
Epoch 24
Loss = 8.8459e-04, PNorm = 77.7617, GNorm = 1.8586, lr_0 = 1.5036e-04
Loss = 6.9864e-04, PNorm = 77.7693, GNorm = 1.5294, lr_0 = 1.4550e-04
Loss = 7.5068e-04, PNorm = 77.7787, GNorm = 1.8798, lr_0 = 1.4079e-04
Validation rmse = 0.680234
Epoch 25
Loss = 5.6263e-04, PNorm = 77.7875, GNorm = 0.9104, lr_0 = 1.3623e-04
Loss = 6.2009e-04, PNorm = 77.7937, GNorm = 1.2822, lr_0 = 1.3183e-04
Loss = 6.3045e-04, PNorm = 77.8011, GNorm = 1.2563, lr_0 = 1.2756e-04
Validation rmse = 0.658083
Epoch 26
Loss = 6.4326e-04, PNorm = 77.8107, GNorm = 0.6959, lr_0 = 1.2343e-04
Loss = 5.4159e-04, PNorm = 77.8173, GNorm = 0.8968, lr_0 = 1.1944e-04
Validation rmse = 0.663516
Epoch 27
Loss = 7.2487e-04, PNorm = 77.8248, GNorm = 1.7538, lr_0 = 1.1557e-04
Loss = 5.5752e-04, PNorm = 77.8318, GNorm = 0.6478, lr_0 = 1.1183e-04
Loss = 5.2101e-04, PNorm = 77.8377, GNorm = 0.7704, lr_0 = 1.0821e-04
Validation rmse = 0.662031
Epoch 28
Loss = 5.8643e-04, PNorm = 77.8453, GNorm = 1.4522, lr_0 = 1.0437e-04
Loss = 5.2526e-04, PNorm = 77.8506, GNorm = 0.5389, lr_0 = 1.0099e-04
Validation rmse = 0.649040
Epoch 29
Loss = 5.1223e-04, PNorm = 77.8568, GNorm = 0.9924, lr_0 = 1.0000e-04
Loss = 4.7906e-04, PNorm = 77.8626, GNorm = 0.6200, lr_0 = 1.0000e-04
Loss = 4.9955e-04, PNorm = 77.8677, GNorm = 0.9211, lr_0 = 1.0000e-04
Validation rmse = 0.636512
Model 0 best validation rmse = 0.636512 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.709886
Ensemble test rmse = 0.709886
10-fold cross validation
	Seed 0 ==> test rmse = 0.757741
	Seed 1 ==> test rmse = 0.606592
	Seed 2 ==> test rmse = 0.637968
	Seed 3 ==> test rmse = 0.866818
	Seed 4 ==> test rmse = 1.030011
	Seed 5 ==> test rmse = 0.672819
	Seed 6 ==> test rmse = 0.752020
	Seed 7 ==> test rmse = 0.707304
	Seed 8 ==> test rmse = 0.697140
	Seed 9 ==> test rmse = 0.709886
Overall test rmse = 0.743830 +/- 0.117063
Elapsed time = 0:10:31
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.4675e-02, PNorm = 46.0261, GNorm = 16.3336, lr_0 = 2.9800e-04
Loss = 1.2820e-02, PNorm = 46.0488, GNorm = 6.0382, lr_0 = 4.7800e-04
Validation rmse = 1.485666
Epoch 1
Loss = 6.9008e-03, PNorm = 46.0952, GNorm = 3.8002, lr_0 = 6.7600e-04
Loss = 7.3880e-03, PNorm = 46.1410, GNorm = 1.5269, lr_0 = 8.5600e-04
Loss = 6.3303e-03, PNorm = 46.1964, GNorm = 0.9288, lr_0 = 9.9344e-04
Validation rmse = 1.184097
Epoch 2
Loss = 6.5032e-03, PNorm = 46.2556, GNorm = 3.4702, lr_0 = 9.6130e-04
Loss = 5.3720e-03, PNorm = 46.3157, GNorm = 5.4733, lr_0 = 9.3019e-04
Validation rmse = 1.161319
Epoch 3
Loss = 5.0474e-03, PNorm = 46.3675, GNorm = 4.6816, lr_0 = 9.0009e-04
Loss = 4.6101e-03, PNorm = 46.4227, GNorm = 0.8936, lr_0 = 8.7096e-04
Loss = 5.0596e-03, PNorm = 46.4799, GNorm = 1.4482, lr_0 = 8.4278e-04
Validation rmse = 1.074079
Epoch 4
Loss = 3.6809e-03, PNorm = 46.5270, GNorm = 0.7476, lr_0 = 8.1551e-04
Loss = 3.6949e-03, PNorm = 46.5619, GNorm = 2.4311, lr_0 = 7.8912e-04
Validation rmse = 1.227840
Epoch 5
Loss = 4.2338e-03, PNorm = 46.5959, GNorm = 5.3459, lr_0 = 7.6358e-04
Loss = 3.8416e-03, PNorm = 46.6410, GNorm = 1.4153, lr_0 = 7.3888e-04
Loss = 3.5792e-03, PNorm = 46.6749, GNorm = 1.4395, lr_0 = 7.1497e-04
Validation rmse = 1.065364
Epoch 6
Loss = 2.5484e-03, PNorm = 46.7117, GNorm = 0.6881, lr_0 = 6.8956e-04
Loss = 2.5988e-03, PNorm = 46.7402, GNorm = 2.8104, lr_0 = 6.6725e-04
Loss = 2.4780e-03, PNorm = 46.7651, GNorm = 1.8275, lr_0 = 6.4565e-04
Validation rmse = 0.923696
Epoch 7
Loss = 1.9785e-03, PNorm = 46.7915, GNorm = 1.7345, lr_0 = 6.2476e-04
Loss = 2.9934e-03, PNorm = 46.8202, GNorm = 3.6221, lr_0 = 6.0454e-04
Validation rmse = 0.924736
Epoch 8
Loss = 1.9292e-03, PNorm = 46.8484, GNorm = 0.7163, lr_0 = 5.8498e-04
Loss = 2.6691e-03, PNorm = 46.8694, GNorm = 4.2588, lr_0 = 5.6605e-04
Loss = 2.2741e-03, PNorm = 46.8980, GNorm = 1.2783, lr_0 = 5.4774e-04
Validation rmse = 0.927410
Epoch 9
Loss = 1.6915e-03, PNorm = 46.9257, GNorm = 0.9759, lr_0 = 5.3001e-04
Loss = 1.9497e-03, PNorm = 46.9455, GNorm = 4.1100, lr_0 = 5.1286e-04
Validation rmse = 0.882403
Epoch 10
Loss = 1.6783e-03, PNorm = 46.9653, GNorm = 0.6654, lr_0 = 4.9627e-04
Loss = 1.8570e-03, PNorm = 46.9892, GNorm = 2.2088, lr_0 = 4.8021e-04
Loss = 1.8768e-03, PNorm = 47.0094, GNorm = 1.5989, lr_0 = 4.6467e-04
Validation rmse = 0.878531
Epoch 11
Loss = 1.6666e-03, PNorm = 47.0263, GNorm = 1.2098, lr_0 = 4.4963e-04
Loss = 1.5657e-03, PNorm = 47.0462, GNorm = 0.3191, lr_0 = 4.3508e-04
Validation rmse = 0.884713
Epoch 12
Loss = 1.5599e-03, PNorm = 47.0690, GNorm = 0.4808, lr_0 = 4.1962e-04
Loss = 1.5443e-03, PNorm = 47.0874, GNorm = 1.0943, lr_0 = 4.0604e-04
Loss = 1.6276e-03, PNorm = 47.1056, GNorm = 2.8972, lr_0 = 3.9290e-04
Validation rmse = 0.859924
Epoch 13
Loss = 1.4479e-03, PNorm = 47.1215, GNorm = 1.1680, lr_0 = 3.8019e-04
Loss = 1.7008e-03, PNorm = 47.1378, GNorm = 1.9507, lr_0 = 3.6789e-04
Loss = 1.5617e-03, PNorm = 47.1549, GNorm = 2.0378, lr_0 = 3.5598e-04
Validation rmse = 0.901662
Epoch 14
Loss = 1.4310e-03, PNorm = 47.1703, GNorm = 1.5553, lr_0 = 3.4446e-04
Loss = 1.2409e-03, PNorm = 47.1868, GNorm = 1.5956, lr_0 = 3.3332e-04
Validation rmse = 0.862250
Epoch 15
Loss = 1.1953e-03, PNorm = 47.2004, GNorm = 1.5706, lr_0 = 3.2253e-04
Loss = 1.5319e-03, PNorm = 47.2151, GNorm = 0.5934, lr_0 = 3.1209e-04
Loss = 1.3842e-03, PNorm = 47.2325, GNorm = 1.8658, lr_0 = 3.0200e-04
Validation rmse = 0.845073
Epoch 16
Loss = 1.3624e-03, PNorm = 47.2471, GNorm = 1.2947, lr_0 = 2.9222e-04
Loss = 1.3115e-03, PNorm = 47.2606, GNorm = 3.1157, lr_0 = 2.8277e-04
Validation rmse = 0.837631
Epoch 17
Loss = 1.2096e-03, PNorm = 47.2723, GNorm = 0.7818, lr_0 = 2.7272e-04
Loss = 1.1270e-03, PNorm = 47.2850, GNorm = 2.3774, lr_0 = 2.6389e-04
Loss = 1.2706e-03, PNorm = 47.2981, GNorm = 0.4834, lr_0 = 2.5535e-04
Validation rmse = 0.848234
Epoch 18
Loss = 1.2589e-03, PNorm = 47.3097, GNorm = 1.1342, lr_0 = 2.4709e-04
Loss = 1.0595e-03, PNorm = 47.3203, GNorm = 1.3217, lr_0 = 2.3910e-04
Loss = 1.0913e-03, PNorm = 47.3312, GNorm = 0.5937, lr_0 = 2.3136e-04
Validation rmse = 0.820719
Epoch 19
Loss = 1.1018e-03, PNorm = 47.3426, GNorm = 0.4425, lr_0 = 2.2387e-04
Loss = 1.2249e-03, PNorm = 47.3533, GNorm = 2.5597, lr_0 = 2.1663e-04
Validation rmse = 0.854129
Epoch 20
Loss = 8.9463e-04, PNorm = 47.3631, GNorm = 1.8132, lr_0 = 2.0962e-04
Loss = 1.1171e-03, PNorm = 47.3721, GNorm = 0.4947, lr_0 = 2.0283e-04
Loss = 1.0206e-03, PNorm = 47.3811, GNorm = 0.5921, lr_0 = 1.9627e-04
Validation rmse = 0.837549
Epoch 21
Loss = 9.5884e-04, PNorm = 47.3911, GNorm = 1.6042, lr_0 = 1.8992e-04
Loss = 9.3740e-04, PNorm = 47.3978, GNorm = 0.5840, lr_0 = 1.8377e-04
Validation rmse = 0.821650
Epoch 22
Loss = 1.0483e-03, PNorm = 47.4072, GNorm = 0.9466, lr_0 = 1.7783e-04
Loss = 9.9554e-04, PNorm = 47.4162, GNorm = 1.6166, lr_0 = 1.7207e-04
Loss = 9.7753e-04, PNorm = 47.4240, GNorm = 0.7845, lr_0 = 1.6651e-04
Validation rmse = 0.847549
Epoch 23
Loss = 7.8254e-04, PNorm = 47.4332, GNorm = 0.7100, lr_0 = 1.6059e-04
Loss = 9.1963e-04, PNorm = 47.4408, GNorm = 1.3059, lr_0 = 1.5539e-04
Validation rmse = 0.825262
Epoch 24
Loss = 8.3304e-04, PNorm = 47.4483, GNorm = 1.4831, lr_0 = 1.5036e-04
Loss = 8.3830e-04, PNorm = 47.4547, GNorm = 0.5828, lr_0 = 1.4550e-04
Loss = 8.9086e-04, PNorm = 47.4613, GNorm = 1.1820, lr_0 = 1.4079e-04
Validation rmse = 0.839412
Epoch 25
Loss = 8.0416e-04, PNorm = 47.4672, GNorm = 0.7472, lr_0 = 1.3623e-04
Loss = 9.2662e-04, PNorm = 47.4726, GNorm = 0.9171, lr_0 = 1.3183e-04
Loss = 8.9484e-04, PNorm = 47.4786, GNorm = 0.9659, lr_0 = 1.2756e-04
Validation rmse = 0.835772
Epoch 26
Loss = 7.0995e-04, PNorm = 47.4855, GNorm = 1.0652, lr_0 = 1.2343e-04
Loss = 7.9742e-04, PNorm = 47.4910, GNorm = 0.6829, lr_0 = 1.1944e-04
Validation rmse = 0.820557
Epoch 27
Loss = 7.9746e-04, PNorm = 47.4975, GNorm = 0.6196, lr_0 = 1.1557e-04
Loss = 8.9585e-04, PNorm = 47.5036, GNorm = 1.5875, lr_0 = 1.1183e-04
Loss = 7.6349e-04, PNorm = 47.5086, GNorm = 0.9209, lr_0 = 1.0821e-04
Validation rmse = 0.833208
Epoch 28
Loss = 8.5548e-04, PNorm = 47.5131, GNorm = 0.5805, lr_0 = 1.0437e-04
Loss = 7.5397e-04, PNorm = 47.5177, GNorm = 1.3586, lr_0 = 1.0099e-04
Validation rmse = 0.835071
Epoch 29
Loss = 1.0368e-03, PNorm = 47.5226, GNorm = 1.0488, lr_0 = 1.0000e-04
Loss = 7.5077e-04, PNorm = 47.5271, GNorm = 0.8476, lr_0 = 1.0000e-04
Loss = 9.4584e-04, PNorm = 47.5325, GNorm = 2.9986, lr_0 = 1.0000e-04
Validation rmse = 0.863216
Model 0 best validation rmse = 0.820557 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.768308
Ensemble test rmse = 0.768308
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.6381e-02, PNorm = 46.0265, GNorm = 5.4853, lr_0 = 2.9800e-04
Loss = 1.0270e-02, PNorm = 46.0510, GNorm = 6.9899, lr_0 = 4.7800e-04
Validation rmse = 1.769245
Epoch 1
Loss = 8.5416e-03, PNorm = 46.0869, GNorm = 1.6221, lr_0 = 6.7600e-04
Loss = 9.3951e-03, PNorm = 46.1335, GNorm = 5.3768, lr_0 = 8.5600e-04
Loss = 5.1915e-03, PNorm = 46.1838, GNorm = 1.7847, lr_0 = 9.9344e-04
Validation rmse = 1.268261
Epoch 2
Loss = 5.4321e-03, PNorm = 46.2333, GNorm = 2.5509, lr_0 = 9.6130e-04
Loss = 6.2431e-03, PNorm = 46.2835, GNorm = 3.9583, lr_0 = 9.3019e-04
Validation rmse = 1.256846
Epoch 3
Loss = 6.0160e-03, PNorm = 46.3345, GNorm = 6.4624, lr_0 = 9.0009e-04
Loss = 5.0496e-03, PNorm = 46.3855, GNorm = 3.0366, lr_0 = 8.7096e-04
Loss = 4.2430e-03, PNorm = 46.4349, GNorm = 2.1575, lr_0 = 8.4278e-04
Validation rmse = 1.027976
Epoch 4
Loss = 4.2210e-03, PNorm = 46.4753, GNorm = 3.1065, lr_0 = 8.1551e-04
Loss = 3.1171e-03, PNorm = 46.5178, GNorm = 1.5405, lr_0 = 7.8912e-04
Validation rmse = 0.895676
Epoch 5
Loss = 2.5042e-03, PNorm = 46.5598, GNorm = 1.3745, lr_0 = 7.6358e-04
Loss = 3.4166e-03, PNorm = 46.5968, GNorm = 4.6291, lr_0 = 7.3888e-04
Loss = 2.8568e-03, PNorm = 46.6328, GNorm = 3.3401, lr_0 = 7.1497e-04
Validation rmse = 0.932810
Epoch 6
Loss = 3.3279e-03, PNorm = 46.6693, GNorm = 0.8290, lr_0 = 6.8956e-04
Loss = 2.8566e-03, PNorm = 46.7074, GNorm = 2.9716, lr_0 = 6.6725e-04
Loss = 2.5285e-03, PNorm = 46.7391, GNorm = 1.9790, lr_0 = 6.4565e-04
Validation rmse = 0.853075
Epoch 7
Loss = 2.5668e-03, PNorm = 46.7698, GNorm = 2.8730, lr_0 = 6.2476e-04
Loss = 2.5661e-03, PNorm = 46.7980, GNorm = 4.2735, lr_0 = 6.0454e-04
Validation rmse = 1.022437
Epoch 8
Loss = 3.3071e-03, PNorm = 46.8306, GNorm = 4.0441, lr_0 = 5.8498e-04
Loss = 2.1834e-03, PNorm = 46.8579, GNorm = 1.0803, lr_0 = 5.6605e-04
Loss = 1.8994e-03, PNorm = 46.8849, GNorm = 0.5973, lr_0 = 5.4774e-04
Validation rmse = 0.795297
Epoch 9
Loss = 1.8079e-03, PNorm = 46.9111, GNorm = 1.7169, lr_0 = 5.3001e-04
Loss = 2.0982e-03, PNorm = 46.9432, GNorm = 0.6445, lr_0 = 5.1286e-04
Validation rmse = 0.806603
Epoch 10
Loss = 1.7672e-03, PNorm = 46.9643, GNorm = 2.1224, lr_0 = 4.9627e-04
Loss = 2.5338e-03, PNorm = 46.9892, GNorm = 2.3140, lr_0 = 4.8021e-04
Loss = 2.0779e-03, PNorm = 47.0135, GNorm = 3.3082, lr_0 = 4.6467e-04
Validation rmse = 0.844825
Epoch 11
Loss = 2.0482e-03, PNorm = 47.0383, GNorm = 1.5644, lr_0 = 4.4963e-04
Loss = 1.8388e-03, PNorm = 47.0579, GNorm = 1.3342, lr_0 = 4.3508e-04
Validation rmse = 0.747349
Epoch 12
Loss = 1.8200e-03, PNorm = 47.0810, GNorm = 1.3190, lr_0 = 4.1962e-04
Loss = 1.8807e-03, PNorm = 47.1015, GNorm = 1.9385, lr_0 = 4.0604e-04
Loss = 2.3714e-03, PNorm = 47.1242, GNorm = 1.8699, lr_0 = 3.9290e-04
Validation rmse = 1.035433
Epoch 13
Loss = 1.9684e-03, PNorm = 47.1462, GNorm = 1.5944, lr_0 = 3.8019e-04
Loss = 2.0652e-03, PNorm = 47.1647, GNorm = 2.6182, lr_0 = 3.6789e-04
Loss = 1.9243e-03, PNorm = 47.1822, GNorm = 1.1759, lr_0 = 3.5598e-04
Validation rmse = 0.718708
Epoch 14
Loss = 1.5605e-03, PNorm = 47.2022, GNorm = 0.6512, lr_0 = 3.4446e-04
Loss = 1.3710e-03, PNorm = 47.2162, GNorm = 1.6050, lr_0 = 3.3332e-04
Validation rmse = 0.739149
Epoch 15
Loss = 1.2010e-03, PNorm = 47.2315, GNorm = 1.2754, lr_0 = 3.2253e-04
Loss = 1.5993e-03, PNorm = 47.2472, GNorm = 2.8654, lr_0 = 3.1209e-04
Loss = 1.7307e-03, PNorm = 47.2637, GNorm = 0.8598, lr_0 = 3.0200e-04
Validation rmse = 0.745434
Epoch 16
Loss = 1.8475e-03, PNorm = 47.2797, GNorm = 2.1575, lr_0 = 2.9222e-04
Loss = 1.0257e-03, PNorm = 47.2936, GNorm = 0.7989, lr_0 = 2.8277e-04
Validation rmse = 0.684788
Epoch 17
Loss = 9.9421e-04, PNorm = 47.3059, GNorm = 0.5085, lr_0 = 2.7272e-04
Loss = 1.4231e-03, PNorm = 47.3176, GNorm = 0.7532, lr_0 = 2.6389e-04
Loss = 1.1711e-03, PNorm = 47.3312, GNorm = 1.0674, lr_0 = 2.5535e-04
Validation rmse = 0.686444
Epoch 18
Loss = 1.1901e-03, PNorm = 47.3431, GNorm = 0.9872, lr_0 = 2.4709e-04
Loss = 1.3169e-03, PNorm = 47.3539, GNorm = 0.7763, lr_0 = 2.3910e-04
Loss = 1.2093e-03, PNorm = 47.3652, GNorm = 1.2792, lr_0 = 2.3136e-04
Validation rmse = 0.690240
Epoch 19
Loss = 1.1604e-03, PNorm = 47.3751, GNorm = 1.1873, lr_0 = 2.2387e-04
Loss = 1.1576e-03, PNorm = 47.3858, GNorm = 1.2067, lr_0 = 2.1663e-04
Validation rmse = 0.668977
Epoch 20
Loss = 9.3432e-04, PNorm = 47.3970, GNorm = 0.9572, lr_0 = 2.0962e-04
Loss = 1.2759e-03, PNorm = 47.4063, GNorm = 0.7229, lr_0 = 2.0283e-04
Loss = 1.0574e-03, PNorm = 47.4152, GNorm = 0.5782, lr_0 = 1.9627e-04
Validation rmse = 0.668719
Epoch 21
Loss = 1.0819e-03, PNorm = 47.4235, GNorm = 0.3960, lr_0 = 1.8992e-04
Loss = 1.1738e-03, PNorm = 47.4318, GNorm = 1.5112, lr_0 = 1.8377e-04
Validation rmse = 0.663405
Epoch 22
Loss = 7.8130e-04, PNorm = 47.4411, GNorm = 0.9504, lr_0 = 1.7783e-04
Loss = 1.1522e-03, PNorm = 47.4480, GNorm = 1.1656, lr_0 = 1.7207e-04
Loss = 1.0860e-03, PNorm = 47.4567, GNorm = 1.0189, lr_0 = 1.6651e-04
Validation rmse = 0.679696
Epoch 23
Loss = 9.6203e-04, PNorm = 47.4678, GNorm = 1.5585, lr_0 = 1.6059e-04
Loss = 1.0715e-03, PNorm = 47.4766, GNorm = 1.2621, lr_0 = 1.5539e-04
Validation rmse = 0.752276
Epoch 24
Loss = 1.0978e-03, PNorm = 47.4847, GNorm = 1.9451, lr_0 = 1.5036e-04
Loss = 1.1942e-03, PNorm = 47.4924, GNorm = 1.8083, lr_0 = 1.4550e-04
Loss = 1.2018e-03, PNorm = 47.5007, GNorm = 2.0398, lr_0 = 1.4079e-04
Validation rmse = 0.725163
Epoch 25
Loss = 9.3406e-04, PNorm = 47.5070, GNorm = 1.5501, lr_0 = 1.3623e-04
Loss = 1.1453e-03, PNorm = 47.5133, GNorm = 0.8063, lr_0 = 1.3183e-04
Loss = 1.2063e-03, PNorm = 47.5207, GNorm = 0.5110, lr_0 = 1.2756e-04
Validation rmse = 0.673814
Epoch 26
Loss = 1.1419e-03, PNorm = 47.5270, GNorm = 0.9513, lr_0 = 1.2343e-04
Loss = 1.0690e-03, PNorm = 47.5331, GNorm = 1.7125, lr_0 = 1.1944e-04
Validation rmse = 0.658948
Epoch 27
Loss = 1.1771e-03, PNorm = 47.5380, GNorm = 1.0374, lr_0 = 1.1557e-04
Loss = 9.0353e-04, PNorm = 47.5446, GNorm = 1.3663, lr_0 = 1.1183e-04
Loss = 9.9707e-04, PNorm = 47.5518, GNorm = 0.5969, lr_0 = 1.0821e-04
Validation rmse = 0.658195
Epoch 28
Loss = 1.0588e-03, PNorm = 47.5581, GNorm = 0.7229, lr_0 = 1.0437e-04
Loss = 8.1662e-04, PNorm = 47.5628, GNorm = 0.4127, lr_0 = 1.0099e-04
Validation rmse = 0.659182
Epoch 29
Loss = 1.0106e-03, PNorm = 47.5671, GNorm = 1.5546, lr_0 = 1.0000e-04
Loss = 9.0851e-04, PNorm = 47.5725, GNorm = 1.1296, lr_0 = 1.0000e-04
Loss = 9.0394e-04, PNorm = 47.5772, GNorm = 0.8330, lr_0 = 1.0000e-04
Validation rmse = 0.643522
Model 0 best validation rmse = 0.643522 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.696907
Ensemble test rmse = 0.696907
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.9069e-02, PNorm = 46.0253, GNorm = 2.6761, lr_0 = 2.9800e-04
Loss = 1.2470e-02, PNorm = 46.0507, GNorm = 2.3642, lr_0 = 4.7800e-04
Validation rmse = 1.270823
Epoch 1
Loss = 7.0960e-03, PNorm = 46.0972, GNorm = 9.0694, lr_0 = 6.7600e-04
Loss = 7.1067e-03, PNorm = 46.1356, GNorm = 6.8574, lr_0 = 8.5600e-04
Loss = 8.0104e-03, PNorm = 46.1867, GNorm = 6.2447, lr_0 = 9.9344e-04
Validation rmse = 1.361817
Epoch 2
Loss = 6.3355e-03, PNorm = 46.2469, GNorm = 5.3251, lr_0 = 9.6130e-04
Loss = 6.1038e-03, PNorm = 46.2973, GNorm = 2.0690, lr_0 = 9.3019e-04
Validation rmse = 1.012333
Epoch 3
Loss = 4.8485e-03, PNorm = 46.3462, GNorm = 3.0534, lr_0 = 9.0009e-04
Loss = 4.0495e-03, PNorm = 46.3930, GNorm = 1.6161, lr_0 = 8.7096e-04
Loss = 4.3635e-03, PNorm = 46.4378, GNorm = 1.4662, lr_0 = 8.4278e-04
Validation rmse = 0.953612
Epoch 4
Loss = 4.6332e-03, PNorm = 46.4821, GNorm = 3.2847, lr_0 = 8.1551e-04
Loss = 4.9766e-03, PNorm = 46.5333, GNorm = 3.6094, lr_0 = 7.8912e-04
Validation rmse = 0.923494
Epoch 5
Loss = 3.3901e-03, PNorm = 46.5758, GNorm = 0.7137, lr_0 = 7.6358e-04
Loss = 3.0652e-03, PNorm = 46.6203, GNorm = 1.2056, lr_0 = 7.3888e-04
Loss = 3.0845e-03, PNorm = 46.6605, GNorm = 2.3195, lr_0 = 7.1497e-04
Validation rmse = 0.832264
Epoch 6
Loss = 3.0165e-03, PNorm = 46.6938, GNorm = 1.1101, lr_0 = 6.8956e-04
Loss = 2.3556e-03, PNorm = 46.7223, GNorm = 0.9666, lr_0 = 6.6725e-04
Loss = 2.7039e-03, PNorm = 46.7511, GNorm = 1.0260, lr_0 = 6.4565e-04
Validation rmse = 0.820645
Epoch 7
Loss = 2.6466e-03, PNorm = 46.7783, GNorm = 1.0173, lr_0 = 6.2476e-04
Loss = 2.2720e-03, PNorm = 46.8144, GNorm = 0.6014, lr_0 = 6.0454e-04
Validation rmse = 0.747814
Epoch 8
Loss = 2.5009e-03, PNorm = 46.8480, GNorm = 1.5542, lr_0 = 5.8498e-04
Loss = 1.8687e-03, PNorm = 46.8771, GNorm = 0.7219, lr_0 = 5.6605e-04
Loss = 2.3632e-03, PNorm = 46.9001, GNorm = 1.4960, lr_0 = 5.4774e-04
Validation rmse = 0.751820
Epoch 9
Loss = 2.4913e-03, PNorm = 46.9287, GNorm = 2.2236, lr_0 = 5.3001e-04
Loss = 2.5471e-03, PNorm = 46.9585, GNorm = 2.8139, lr_0 = 5.1286e-04
Validation rmse = 0.698983
Epoch 10
Loss = 2.0387e-03, PNorm = 46.9858, GNorm = 2.1400, lr_0 = 4.9627e-04
Loss = 1.9201e-03, PNorm = 47.0090, GNorm = 0.9575, lr_0 = 4.8021e-04
Loss = 2.2207e-03, PNorm = 47.0404, GNorm = 2.4731, lr_0 = 4.6467e-04
Validation rmse = 0.701196
Epoch 11
Loss = 2.0665e-03, PNorm = 47.0626, GNorm = 3.0597, lr_0 = 4.4963e-04
Loss = 1.9518e-03, PNorm = 47.0866, GNorm = 1.7496, lr_0 = 4.3508e-04
Validation rmse = 0.661812
Epoch 12
Loss = 1.1488e-03, PNorm = 47.1095, GNorm = 0.7646, lr_0 = 4.1962e-04
Loss = 1.7757e-03, PNorm = 47.1279, GNorm = 2.0234, lr_0 = 4.0604e-04
Loss = 1.4856e-03, PNorm = 47.1472, GNorm = 0.6746, lr_0 = 3.9290e-04
Validation rmse = 0.682246
Epoch 13
Loss = 1.5607e-03, PNorm = 47.1674, GNorm = 0.7859, lr_0 = 3.8019e-04
Loss = 1.6812e-03, PNorm = 47.1864, GNorm = 4.5029, lr_0 = 3.6789e-04
Loss = 2.1792e-03, PNorm = 47.2076, GNorm = 2.1017, lr_0 = 3.5598e-04
Validation rmse = 0.774577
Epoch 14
Loss = 1.6506e-03, PNorm = 47.2223, GNorm = 0.5288, lr_0 = 3.4446e-04
Loss = 1.6056e-03, PNorm = 47.2419, GNorm = 0.7168, lr_0 = 3.3332e-04
Validation rmse = 0.766368
Epoch 15
Loss = 1.7068e-03, PNorm = 47.2590, GNorm = 0.4383, lr_0 = 3.2253e-04
Loss = 1.4850e-03, PNorm = 47.2733, GNorm = 0.5406, lr_0 = 3.1209e-04
Loss = 1.8816e-03, PNorm = 47.2910, GNorm = 1.5710, lr_0 = 3.0200e-04
Validation rmse = 0.663280
Epoch 16
Loss = 1.3816e-03, PNorm = 47.3062, GNorm = 1.0378, lr_0 = 2.9222e-04
Loss = 1.2523e-03, PNorm = 47.3195, GNorm = 0.7313, lr_0 = 2.8277e-04
Validation rmse = 0.651028
Epoch 17
Loss = 1.0583e-03, PNorm = 47.3340, GNorm = 2.0345, lr_0 = 2.7272e-04
Loss = 1.1784e-03, PNorm = 47.3452, GNorm = 0.5787, lr_0 = 2.6389e-04
Loss = 1.5218e-03, PNorm = 47.3574, GNorm = 3.4399, lr_0 = 2.5535e-04
Validation rmse = 0.675440
Epoch 18
Loss = 1.2585e-03, PNorm = 47.3706, GNorm = 0.4750, lr_0 = 2.4709e-04
Loss = 1.3827e-03, PNorm = 47.3829, GNorm = 0.9575, lr_0 = 2.3910e-04
Loss = 1.1278e-03, PNorm = 47.3918, GNorm = 1.1184, lr_0 = 2.3136e-04
Validation rmse = 0.651296
Epoch 19
Loss = 1.4741e-03, PNorm = 47.4031, GNorm = 1.2647, lr_0 = 2.2387e-04
Loss = 1.1224e-03, PNorm = 47.4149, GNorm = 0.6307, lr_0 = 2.1663e-04
Validation rmse = 0.647109
Epoch 20
Loss = 1.1154e-03, PNorm = 47.4242, GNorm = 2.2273, lr_0 = 2.0962e-04
Loss = 1.0723e-03, PNorm = 47.4340, GNorm = 1.2583, lr_0 = 2.0283e-04
Loss = 1.0457e-03, PNorm = 47.4427, GNorm = 0.5162, lr_0 = 1.9627e-04
Validation rmse = 0.631697
Epoch 21
Loss = 1.0533e-03, PNorm = 47.4511, GNorm = 0.5028, lr_0 = 1.8992e-04
Loss = 1.1312e-03, PNorm = 47.4599, GNorm = 1.2715, lr_0 = 1.8377e-04
Validation rmse = 0.653755
Epoch 22
Loss = 9.9667e-04, PNorm = 47.4676, GNorm = 0.6508, lr_0 = 1.7783e-04
Loss = 1.1815e-03, PNorm = 47.4765, GNorm = 0.6173, lr_0 = 1.7207e-04
Loss = 9.7338e-04, PNorm = 47.4841, GNorm = 0.5190, lr_0 = 1.6651e-04
Validation rmse = 0.640327
Epoch 23
Loss = 1.0823e-03, PNorm = 47.4921, GNorm = 1.1291, lr_0 = 1.6059e-04
Loss = 1.1643e-03, PNorm = 47.4982, GNorm = 0.7634, lr_0 = 1.5539e-04
Validation rmse = 0.632745
Epoch 24
Loss = 1.0395e-03, PNorm = 47.5057, GNorm = 0.9258, lr_0 = 1.5036e-04
Loss = 9.0421e-04, PNorm = 47.5128, GNorm = 0.7281, lr_0 = 1.4550e-04
Loss = 8.1197e-04, PNorm = 47.5195, GNorm = 1.2312, lr_0 = 1.4079e-04
Validation rmse = 0.629219
Epoch 25
Loss = 1.0908e-03, PNorm = 47.5260, GNorm = 2.7267, lr_0 = 1.3623e-04
Loss = 1.0499e-03, PNorm = 47.5342, GNorm = 0.8761, lr_0 = 1.3183e-04
Loss = 1.0253e-03, PNorm = 47.5393, GNorm = 0.7027, lr_0 = 1.2756e-04
Validation rmse = 0.635388
Epoch 26
Loss = 9.4944e-04, PNorm = 47.5457, GNorm = 2.2732, lr_0 = 1.2343e-04
Loss = 9.6649e-04, PNorm = 47.5519, GNorm = 0.8226, lr_0 = 1.1944e-04
Validation rmse = 0.651908
Epoch 27
Loss = 1.0223e-03, PNorm = 47.5574, GNorm = 0.9607, lr_0 = 1.1557e-04
Loss = 1.1407e-03, PNorm = 47.5634, GNorm = 0.6702, lr_0 = 1.1183e-04
Loss = 7.9349e-04, PNorm = 47.5687, GNorm = 1.0363, lr_0 = 1.0821e-04
Validation rmse = 0.647322
Epoch 28
Loss = 8.8715e-04, PNorm = 47.5739, GNorm = 0.5747, lr_0 = 1.0437e-04
Loss = 1.0108e-03, PNorm = 47.5790, GNorm = 0.8748, lr_0 = 1.0099e-04
Validation rmse = 0.635893
Epoch 29
Loss = 1.1878e-03, PNorm = 47.5835, GNorm = 1.5167, lr_0 = 1.0000e-04
Loss = 9.8582e-04, PNorm = 47.5888, GNorm = 2.5295, lr_0 = 1.0000e-04
Loss = 8.0764e-04, PNorm = 47.5933, GNorm = 0.8674, lr_0 = 1.0000e-04
Validation rmse = 0.637176
Model 0 best validation rmse = 0.629219 on epoch 24
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.658745
Ensemble test rmse = 0.658745
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.6762e-02, PNorm = 46.0249, GNorm = 5.5817, lr_0 = 2.9800e-04
Loss = 9.0999e-03, PNorm = 46.0526, GNorm = 1.8092, lr_0 = 4.7800e-04
Validation rmse = 1.239116
Epoch 1
Loss = 8.3903e-03, PNorm = 46.0922, GNorm = 5.4040, lr_0 = 6.7600e-04
Loss = 9.0109e-03, PNorm = 46.1402, GNorm = 3.2282, lr_0 = 8.5600e-04
Loss = 7.3389e-03, PNorm = 46.2049, GNorm = 4.4620, lr_0 = 9.9344e-04
Validation rmse = 1.169742
Epoch 2
Loss = 5.6628e-03, PNorm = 46.2675, GNorm = 2.8730, lr_0 = 9.6130e-04
Loss = 4.8909e-03, PNorm = 46.3139, GNorm = 4.4466, lr_0 = 9.3019e-04
Validation rmse = 1.087504
Epoch 3
Loss = 4.9011e-03, PNorm = 46.3575, GNorm = 1.9014, lr_0 = 9.0009e-04
Loss = 4.3571e-03, PNorm = 46.4044, GNorm = 1.7183, lr_0 = 8.7096e-04
Loss = 4.2235e-03, PNorm = 46.4483, GNorm = 3.8459, lr_0 = 8.4278e-04
Validation rmse = 0.918332
Epoch 4
Loss = 4.0219e-03, PNorm = 46.4862, GNorm = 6.5918, lr_0 = 8.1551e-04
Loss = 4.1754e-03, PNorm = 46.5313, GNorm = 2.0675, lr_0 = 7.8912e-04
Validation rmse = 1.056850
Epoch 5
Loss = 4.2716e-03, PNorm = 46.5745, GNorm = 2.6151, lr_0 = 7.6358e-04
Loss = 3.0186e-03, PNorm = 46.6138, GNorm = 0.7486, lr_0 = 7.3888e-04
Loss = 3.2441e-03, PNorm = 46.6498, GNorm = 1.7118, lr_0 = 7.1497e-04
Validation rmse = 0.850773
Epoch 6
Loss = 2.5832e-03, PNorm = 46.6888, GNorm = 1.1902, lr_0 = 6.8956e-04
Loss = 2.6237e-03, PNorm = 46.7179, GNorm = 1.0312, lr_0 = 6.6725e-04
Loss = 2.4152e-03, PNorm = 46.7442, GNorm = 2.2469, lr_0 = 6.4565e-04
Validation rmse = 0.764185
Epoch 7
Loss = 2.0735e-03, PNorm = 46.7719, GNorm = 2.4873, lr_0 = 6.2476e-04
Loss = 2.6154e-03, PNorm = 46.8005, GNorm = 1.6556, lr_0 = 6.0454e-04
Validation rmse = 0.724942
Epoch 8
Loss = 1.7624e-03, PNorm = 46.8277, GNorm = 1.2406, lr_0 = 5.8498e-04
Loss = 2.0950e-03, PNorm = 46.8545, GNorm = 2.3550, lr_0 = 5.6605e-04
Loss = 2.1167e-03, PNorm = 46.8802, GNorm = 0.7719, lr_0 = 5.4774e-04
Validation rmse = 0.733603
Epoch 9
Loss = 2.2115e-03, PNorm = 46.9042, GNorm = 2.2540, lr_0 = 5.3001e-04
Loss = 2.4021e-03, PNorm = 46.9294, GNorm = 2.9427, lr_0 = 5.1286e-04
Validation rmse = 0.764865
Epoch 10
Loss = 1.0286e-03, PNorm = 46.9544, GNorm = 0.5484, lr_0 = 4.9627e-04
Loss = 1.8428e-03, PNorm = 46.9754, GNorm = 2.6176, lr_0 = 4.8021e-04
Loss = 2.1053e-03, PNorm = 46.9983, GNorm = 3.2105, lr_0 = 4.6467e-04
Validation rmse = 0.715610
Epoch 11
Loss = 1.5064e-03, PNorm = 47.0209, GNorm = 0.5990, lr_0 = 4.4963e-04
Loss = 1.9736e-03, PNorm = 47.0435, GNorm = 1.9100, lr_0 = 4.3508e-04
Validation rmse = 0.741413
Epoch 12
Loss = 2.0838e-03, PNorm = 47.0652, GNorm = 1.7688, lr_0 = 4.1962e-04
Loss = 1.9576e-03, PNorm = 47.0840, GNorm = 1.6831, lr_0 = 4.0604e-04
Loss = 1.8913e-03, PNorm = 47.1037, GNorm = 2.7432, lr_0 = 3.9290e-04
Validation rmse = 0.738987
Epoch 13
Loss = 2.0186e-03, PNorm = 47.1253, GNorm = 0.8802, lr_0 = 3.8019e-04
Loss = 1.7331e-03, PNorm = 47.1434, GNorm = 1.9932, lr_0 = 3.6789e-04
Loss = 1.3777e-03, PNorm = 47.1617, GNorm = 0.7191, lr_0 = 3.5598e-04
Validation rmse = 0.664412
Epoch 14
Loss = 1.2605e-03, PNorm = 47.1767, GNorm = 1.1398, lr_0 = 3.4446e-04
Loss = 1.3773e-03, PNorm = 47.1920, GNorm = 0.9052, lr_0 = 3.3332e-04
Validation rmse = 0.687029
Epoch 15
Loss = 1.2054e-03, PNorm = 47.2075, GNorm = 1.3786, lr_0 = 3.2253e-04
Loss = 1.3742e-03, PNorm = 47.2226, GNorm = 1.0177, lr_0 = 3.1209e-04
Loss = 1.3622e-03, PNorm = 47.2344, GNorm = 0.9854, lr_0 = 3.0200e-04
Validation rmse = 0.648192
Epoch 16
Loss = 1.3384e-03, PNorm = 47.2500, GNorm = 0.8592, lr_0 = 2.9222e-04
Loss = 1.4210e-03, PNorm = 47.2664, GNorm = 0.7001, lr_0 = 2.8277e-04
Validation rmse = 0.697399
Epoch 17
Loss = 1.2990e-03, PNorm = 47.2816, GNorm = 1.2074, lr_0 = 2.7272e-04
Loss = 1.2598e-03, PNorm = 47.2939, GNorm = 3.0916, lr_0 = 2.6389e-04
Loss = 1.3427e-03, PNorm = 47.3066, GNorm = 0.6618, lr_0 = 2.5535e-04
Validation rmse = 0.645485
Epoch 18
Loss = 1.1064e-03, PNorm = 47.3205, GNorm = 2.4234, lr_0 = 2.4709e-04
Loss = 1.3507e-03, PNorm = 47.3330, GNorm = 1.8689, lr_0 = 2.3910e-04
Loss = 1.0424e-03, PNorm = 47.3465, GNorm = 1.1172, lr_0 = 2.3136e-04
Validation rmse = 0.645009
Epoch 19
Loss = 1.3698e-03, PNorm = 47.3580, GNorm = 0.9062, lr_0 = 2.2387e-04
Loss = 1.1584e-03, PNorm = 47.3696, GNorm = 0.5609, lr_0 = 2.1663e-04
Validation rmse = 0.647001
Epoch 20
Loss = 1.1459e-03, PNorm = 47.3811, GNorm = 0.5012, lr_0 = 2.0962e-04
Loss = 1.3179e-03, PNorm = 47.3925, GNorm = 1.5636, lr_0 = 2.0283e-04
Loss = 1.2943e-03, PNorm = 47.4040, GNorm = 0.3977, lr_0 = 1.9627e-04
Validation rmse = 0.667372
Epoch 21
Loss = 1.0845e-03, PNorm = 47.4152, GNorm = 0.7449, lr_0 = 1.8992e-04
Loss = 1.4600e-03, PNorm = 47.4251, GNorm = 1.9448, lr_0 = 1.8377e-04
Validation rmse = 0.653919
Epoch 22
Loss = 1.5151e-03, PNorm = 47.4343, GNorm = 2.5868, lr_0 = 1.7783e-04
Loss = 1.0612e-03, PNorm = 47.4438, GNorm = 1.5244, lr_0 = 1.7207e-04
Loss = 9.4194e-04, PNorm = 47.4514, GNorm = 1.9551, lr_0 = 1.6651e-04
Validation rmse = 0.658481
Epoch 23
Loss = 1.1784e-03, PNorm = 47.4610, GNorm = 1.6472, lr_0 = 1.6059e-04
Loss = 9.5479e-04, PNorm = 47.4680, GNorm = 0.8562, lr_0 = 1.5539e-04
Validation rmse = 0.665133
Epoch 24
Loss = 9.8037e-04, PNorm = 47.4760, GNorm = 1.4193, lr_0 = 1.5036e-04
Loss = 9.0777e-04, PNorm = 47.4835, GNorm = 0.7147, lr_0 = 1.4550e-04
Loss = 8.5479e-04, PNorm = 47.4904, GNorm = 0.8433, lr_0 = 1.4079e-04
Validation rmse = 0.665293
Epoch 25
Loss = 1.0843e-03, PNorm = 47.4969, GNorm = 0.5491, lr_0 = 1.3623e-04
Loss = 9.8564e-04, PNorm = 47.5038, GNorm = 1.1188, lr_0 = 1.3183e-04
Loss = 1.0068e-03, PNorm = 47.5107, GNorm = 0.4305, lr_0 = 1.2756e-04
Validation rmse = 0.661791
Epoch 26
Loss = 9.7646e-04, PNorm = 47.5173, GNorm = 0.6069, lr_0 = 1.2343e-04
Loss = 8.4991e-04, PNorm = 47.5239, GNorm = 0.8130, lr_0 = 1.1944e-04
Validation rmse = 0.642504
Epoch 27
Loss = 7.2036e-04, PNorm = 47.5297, GNorm = 0.8058, lr_0 = 1.1557e-04
Loss = 9.7463e-04, PNorm = 47.5354, GNorm = 0.6484, lr_0 = 1.1183e-04
Loss = 8.0221e-04, PNorm = 47.5408, GNorm = 1.3696, lr_0 = 1.0821e-04
Validation rmse = 0.640875
Epoch 28
Loss = 8.5177e-04, PNorm = 47.5460, GNorm = 0.5976, lr_0 = 1.0437e-04
Loss = 9.7368e-04, PNorm = 47.5512, GNorm = 1.8224, lr_0 = 1.0099e-04
Validation rmse = 0.648797
Epoch 29
Loss = 6.7873e-04, PNorm = 47.5563, GNorm = 1.6454, lr_0 = 1.0000e-04
Loss = 7.5767e-04, PNorm = 47.5613, GNorm = 1.3798, lr_0 = 1.0000e-04
Loss = 9.8216e-04, PNorm = 47.5660, GNorm = 0.7731, lr_0 = 1.0000e-04
Validation rmse = 0.644248
Model 0 best validation rmse = 0.640875 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.894170
Ensemble test rmse = 0.894170
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.6799e-02, PNorm = 46.0250, GNorm = 7.4602, lr_0 = 2.9800e-04
Loss = 1.1350e-02, PNorm = 46.0502, GNorm = 15.2722, lr_0 = 4.7800e-04
Validation rmse = 1.509030
Epoch 1
Loss = 7.6028e-03, PNorm = 46.0887, GNorm = 6.0972, lr_0 = 6.7600e-04
Loss = 7.1042e-03, PNorm = 46.1339, GNorm = 7.3003, lr_0 = 8.5600e-04
Loss = 8.1161e-03, PNorm = 46.1915, GNorm = 4.7299, lr_0 = 9.9344e-04
Validation rmse = 1.406896
Epoch 2
Loss = 6.9580e-03, PNorm = 46.2662, GNorm = 3.6173, lr_0 = 9.6130e-04
Loss = 4.8887e-03, PNorm = 46.3235, GNorm = 2.8614, lr_0 = 9.3019e-04
Validation rmse = 1.046439
Epoch 3
Loss = 3.5426e-03, PNorm = 46.3788, GNorm = 2.2190, lr_0 = 9.0009e-04
Loss = 3.7624e-03, PNorm = 46.4272, GNorm = 2.9908, lr_0 = 8.7096e-04
Loss = 3.8956e-03, PNorm = 46.4822, GNorm = 0.8339, lr_0 = 8.4278e-04
Validation rmse = 1.006819
Epoch 4
Loss = 3.0944e-03, PNorm = 46.5251, GNorm = 0.7591, lr_0 = 8.1551e-04
Loss = 2.8912e-03, PNorm = 46.5646, GNorm = 0.9684, lr_0 = 7.8912e-04
Validation rmse = 0.934171
Epoch 5
Loss = 3.4378e-03, PNorm = 46.6057, GNorm = 2.5107, lr_0 = 7.6358e-04
Loss = 3.3425e-03, PNorm = 46.6441, GNorm = 1.2016, lr_0 = 7.3888e-04
Loss = 5.4049e-03, PNorm = 46.6893, GNorm = 4.4940, lr_0 = 7.1497e-04
Validation rmse = 1.130638
Epoch 6
Loss = 2.9636e-03, PNorm = 46.7368, GNorm = 2.0715, lr_0 = 6.8956e-04
Loss = 3.1827e-03, PNorm = 46.7766, GNorm = 1.1004, lr_0 = 6.6725e-04
Loss = 2.7165e-03, PNorm = 46.8108, GNorm = 4.7680, lr_0 = 6.4565e-04
Validation rmse = 0.904352
Epoch 7
Loss = 2.3538e-03, PNorm = 46.8432, GNorm = 0.5303, lr_0 = 6.2476e-04
Loss = 2.6802e-03, PNorm = 46.8698, GNorm = 5.1278, lr_0 = 6.0454e-04
Validation rmse = 0.987898
Epoch 8
Loss = 3.1567e-03, PNorm = 46.8957, GNorm = 5.0369, lr_0 = 5.8498e-04
Loss = 2.5319e-03, PNorm = 46.9265, GNorm = 2.9896, lr_0 = 5.6605e-04
Loss = 2.1476e-03, PNorm = 46.9510, GNorm = 1.0281, lr_0 = 5.4774e-04
Validation rmse = 0.852254
Epoch 9
Loss = 1.9645e-03, PNorm = 46.9787, GNorm = 0.7776, lr_0 = 5.3001e-04
Loss = 2.0195e-03, PNorm = 47.0027, GNorm = 1.6074, lr_0 = 5.1286e-04
Validation rmse = 0.806832
Epoch 10
Loss = 1.6140e-03, PNorm = 47.0215, GNorm = 0.9978, lr_0 = 4.9627e-04
Loss = 1.9301e-03, PNorm = 47.0387, GNorm = 0.9641, lr_0 = 4.8021e-04
Loss = 1.6428e-03, PNorm = 47.0594, GNorm = 1.9762, lr_0 = 4.6467e-04
Validation rmse = 0.789804
Epoch 11
Loss = 1.7332e-03, PNorm = 47.0760, GNorm = 4.1661, lr_0 = 4.4963e-04
Loss = 2.7148e-03, PNorm = 47.0990, GNorm = 2.4877, lr_0 = 4.3508e-04
Validation rmse = 0.860065
Epoch 12
Loss = 1.8045e-03, PNorm = 47.1260, GNorm = 0.8500, lr_0 = 4.1962e-04
Loss = 1.5365e-03, PNorm = 47.1493, GNorm = 1.3917, lr_0 = 4.0604e-04
Loss = 1.6051e-03, PNorm = 47.1687, GNorm = 0.6225, lr_0 = 3.9290e-04
Validation rmse = 0.773592
Epoch 13
Loss = 1.6239e-03, PNorm = 47.1886, GNorm = 3.1312, lr_0 = 3.8019e-04
Loss = 1.7225e-03, PNorm = 47.2072, GNorm = 0.9137, lr_0 = 3.6789e-04
Loss = 1.4289e-03, PNorm = 47.2215, GNorm = 0.7146, lr_0 = 3.5598e-04
Validation rmse = 0.839738
Epoch 14
Loss = 1.6024e-03, PNorm = 47.2398, GNorm = 2.0872, lr_0 = 3.4446e-04
Loss = 1.4747e-03, PNorm = 47.2568, GNorm = 1.6209, lr_0 = 3.3332e-04
Validation rmse = 0.758567
Epoch 15
Loss = 1.0855e-03, PNorm = 47.2734, GNorm = 2.3010, lr_0 = 3.2253e-04
Loss = 1.3679e-03, PNorm = 47.2883, GNorm = 1.2813, lr_0 = 3.1209e-04
Loss = 1.2566e-03, PNorm = 47.3019, GNorm = 1.3626, lr_0 = 3.0200e-04
Validation rmse = 0.779250
Epoch 16
Loss = 1.3864e-03, PNorm = 47.3184, GNorm = 1.6265, lr_0 = 2.9222e-04
Loss = 1.4697e-03, PNorm = 47.3340, GNorm = 2.3260, lr_0 = 2.8277e-04
Validation rmse = 0.736149
Epoch 17
Loss = 1.5048e-03, PNorm = 47.3482, GNorm = 1.6758, lr_0 = 2.7272e-04
Loss = 1.3243e-03, PNorm = 47.3613, GNorm = 1.3394, lr_0 = 2.6389e-04
Loss = 1.0689e-03, PNorm = 47.3741, GNorm = 0.4216, lr_0 = 2.5535e-04
Validation rmse = 0.741563
Epoch 18
Loss = 9.8378e-04, PNorm = 47.3869, GNorm = 0.4537, lr_0 = 2.4709e-04
Loss = 1.2791e-03, PNorm = 47.3984, GNorm = 1.6663, lr_0 = 2.3910e-04
Loss = 1.1664e-03, PNorm = 47.4109, GNorm = 0.8076, lr_0 = 2.3136e-04
Validation rmse = 0.763010
Epoch 19
Loss = 1.1802e-03, PNorm = 47.4215, GNorm = 0.6457, lr_0 = 2.2387e-04
Loss = 1.2508e-03, PNorm = 47.4334, GNorm = 0.5987, lr_0 = 2.1663e-04
Validation rmse = 0.728401
Epoch 20
Loss = 7.1820e-04, PNorm = 47.4441, GNorm = 0.2940, lr_0 = 2.0962e-04
Loss = 1.0593e-03, PNorm = 47.4546, GNorm = 0.6192, lr_0 = 2.0283e-04
Loss = 1.1028e-03, PNorm = 47.4636, GNorm = 1.6504, lr_0 = 1.9627e-04
Validation rmse = 0.764232
Epoch 21
Loss = 9.4817e-04, PNorm = 47.4739, GNorm = 0.4733, lr_0 = 1.8992e-04
Loss = 1.0949e-03, PNorm = 47.4832, GNorm = 1.1781, lr_0 = 1.8377e-04
Validation rmse = 0.732670
Epoch 22
Loss = 8.7647e-04, PNorm = 47.4939, GNorm = 1.0673, lr_0 = 1.7783e-04
Loss = 1.0626e-03, PNorm = 47.5020, GNorm = 2.0439, lr_0 = 1.7207e-04
Loss = 1.1760e-03, PNorm = 47.5113, GNorm = 1.5099, lr_0 = 1.6651e-04
Validation rmse = 0.725028
Epoch 23
Loss = 9.7282e-04, PNorm = 47.5207, GNorm = 1.0178, lr_0 = 1.6059e-04
Loss = 8.6852e-04, PNorm = 47.5286, GNorm = 0.8506, lr_0 = 1.5539e-04
Validation rmse = 0.720538
Epoch 24
Loss = 5.5615e-04, PNorm = 47.5361, GNorm = 0.4906, lr_0 = 1.5036e-04
Loss = 9.9010e-04, PNorm = 47.5427, GNorm = 1.9915, lr_0 = 1.4550e-04
Loss = 1.0256e-03, PNorm = 47.5505, GNorm = 0.7029, lr_0 = 1.4079e-04
Validation rmse = 0.721955
Epoch 25
Loss = 9.5047e-04, PNorm = 47.5584, GNorm = 1.2136, lr_0 = 1.3623e-04
Loss = 8.7180e-04, PNorm = 47.5658, GNorm = 1.3653, lr_0 = 1.3183e-04
Loss = 9.4801e-04, PNorm = 47.5722, GNorm = 1.5173, lr_0 = 1.2756e-04
Validation rmse = 0.727046
Epoch 26
Loss = 8.5991e-04, PNorm = 47.5784, GNorm = 0.8334, lr_0 = 1.2343e-04
Loss = 9.4796e-04, PNorm = 47.5841, GNorm = 1.2553, lr_0 = 1.1944e-04
Validation rmse = 0.714223
Epoch 27
Loss = 8.1007e-04, PNorm = 47.5899, GNorm = 0.9618, lr_0 = 1.1557e-04
Loss = 8.0669e-04, PNorm = 47.5952, GNorm = 0.5188, lr_0 = 1.1183e-04
Loss = 8.8066e-04, PNorm = 47.6009, GNorm = 0.9545, lr_0 = 1.0821e-04
Validation rmse = 0.712328
Epoch 28
Loss = 7.0964e-04, PNorm = 47.6071, GNorm = 1.3283, lr_0 = 1.0437e-04
Loss = 9.3253e-04, PNorm = 47.6123, GNorm = 0.5628, lr_0 = 1.0099e-04
Validation rmse = 0.726544
Epoch 29
Loss = 1.4973e-03, PNorm = 47.6177, GNorm = 0.8164, lr_0 = 1.0000e-04
Loss = 7.9172e-04, PNorm = 47.6231, GNorm = 1.1087, lr_0 = 1.0000e-04
Loss = 6.8065e-04, PNorm = 47.6282, GNorm = 0.6499, lr_0 = 1.0000e-04
Validation rmse = 0.697758
Model 0 best validation rmse = 0.697758 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.056610
Ensemble test rmse = 1.056610
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.7601e-02, PNorm = 46.0261, GNorm = 6.7725, lr_0 = 2.9800e-04
Loss = 1.1992e-02, PNorm = 46.0512, GNorm = 5.0880, lr_0 = 4.7800e-04
Validation rmse = 1.527313
Epoch 1
Loss = 7.5918e-03, PNorm = 46.0932, GNorm = 2.6081, lr_0 = 6.7600e-04
Loss = 6.4688e-03, PNorm = 46.1408, GNorm = 2.3365, lr_0 = 8.5600e-04
Loss = 6.4606e-03, PNorm = 46.1941, GNorm = 8.6075, lr_0 = 9.9344e-04
Validation rmse = 1.245187
Epoch 2
Loss = 5.5326e-03, PNorm = 46.2527, GNorm = 6.5929, lr_0 = 9.6130e-04
Loss = 5.0080e-03, PNorm = 46.3141, GNorm = 5.6921, lr_0 = 9.3019e-04
Validation rmse = 1.207299
Epoch 3
Loss = 3.3904e-03, PNorm = 46.3670, GNorm = 3.7327, lr_0 = 9.0009e-04
Loss = 4.0085e-03, PNorm = 46.4099, GNorm = 3.1627, lr_0 = 8.7096e-04
Loss = 4.3862e-03, PNorm = 46.4540, GNorm = 1.1723, lr_0 = 8.4278e-04
Validation rmse = 1.145929
Epoch 4
Loss = 3.4395e-03, PNorm = 46.5022, GNorm = 2.1675, lr_0 = 8.1551e-04
Loss = 3.7872e-03, PNorm = 46.5421, GNorm = 4.8004, lr_0 = 7.8912e-04
Validation rmse = 1.069631
Epoch 5
Loss = 2.4071e-03, PNorm = 46.5828, GNorm = 1.1459, lr_0 = 7.6358e-04
Loss = 2.9787e-03, PNorm = 46.6158, GNorm = 1.4116, lr_0 = 7.3888e-04
Loss = 4.3726e-03, PNorm = 46.6519, GNorm = 2.4161, lr_0 = 7.1497e-04
Validation rmse = 1.173216
Epoch 6
Loss = 3.6518e-03, PNorm = 46.7057, GNorm = 3.6773, lr_0 = 6.8956e-04
Loss = 3.6624e-03, PNorm = 46.7472, GNorm = 2.1457, lr_0 = 6.6725e-04
Loss = 2.5170e-03, PNorm = 46.7799, GNorm = 2.8800, lr_0 = 6.4565e-04
Validation rmse = 0.980850
Epoch 7
Loss = 2.2012e-03, PNorm = 46.8112, GNorm = 0.8243, lr_0 = 6.2476e-04
Loss = 2.6137e-03, PNorm = 46.8402, GNorm = 1.8281, lr_0 = 6.0454e-04
Validation rmse = 1.082054
Epoch 8
Loss = 2.2570e-03, PNorm = 46.8677, GNorm = 0.9890, lr_0 = 5.8498e-04
Loss = 2.2155e-03, PNorm = 46.8932, GNorm = 2.3344, lr_0 = 5.6605e-04
Loss = 1.9804e-03, PNorm = 46.9151, GNorm = 1.7192, lr_0 = 5.4774e-04
Validation rmse = 0.992751
Epoch 9
Loss = 1.9706e-03, PNorm = 46.9330, GNorm = 2.9315, lr_0 = 5.3001e-04
Loss = 1.9623e-03, PNorm = 46.9575, GNorm = 1.2087, lr_0 = 5.1286e-04
Validation rmse = 0.922189
Epoch 10
Loss = 1.5703e-03, PNorm = 46.9794, GNorm = 0.3998, lr_0 = 4.9627e-04
Loss = 1.5126e-03, PNorm = 46.9990, GNorm = 1.2394, lr_0 = 4.8021e-04
Loss = 2.0611e-03, PNorm = 47.0209, GNorm = 2.0477, lr_0 = 4.6467e-04
Validation rmse = 0.923778
Epoch 11
Loss = 1.5729e-03, PNorm = 47.0414, GNorm = 1.1325, lr_0 = 4.4963e-04
Loss = 1.9973e-03, PNorm = 47.0655, GNorm = 1.0453, lr_0 = 4.3508e-04
Validation rmse = 0.935630
Epoch 12
Loss = 1.5648e-03, PNorm = 47.0849, GNorm = 0.7790, lr_0 = 4.1962e-04
Loss = 1.9111e-03, PNorm = 47.1029, GNorm = 0.5225, lr_0 = 4.0604e-04
Loss = 1.6980e-03, PNorm = 47.1214, GNorm = 1.9687, lr_0 = 3.9290e-04
Validation rmse = 1.147764
Epoch 13
Loss = 2.0362e-03, PNorm = 47.1461, GNorm = 5.3247, lr_0 = 3.8019e-04
Loss = 1.6697e-03, PNorm = 47.1646, GNorm = 1.5854, lr_0 = 3.6789e-04
Loss = 1.9729e-03, PNorm = 47.1859, GNorm = 3.2929, lr_0 = 3.5598e-04
Validation rmse = 0.889954
Epoch 14
Loss = 2.1327e-03, PNorm = 47.2065, GNorm = 2.0836, lr_0 = 3.4446e-04
Loss = 1.5916e-03, PNorm = 47.2280, GNorm = 1.3229, lr_0 = 3.3332e-04
Validation rmse = 0.904725
Epoch 15
Loss = 1.5807e-03, PNorm = 47.2449, GNorm = 0.9714, lr_0 = 3.2253e-04
Loss = 1.2696e-03, PNorm = 47.2581, GNorm = 0.5807, lr_0 = 3.1209e-04
Loss = 1.1976e-03, PNorm = 47.2726, GNorm = 0.6187, lr_0 = 3.0200e-04
Validation rmse = 0.865871
Epoch 16
Loss = 1.5001e-03, PNorm = 47.2851, GNorm = 1.1417, lr_0 = 2.9222e-04
Loss = 1.2458e-03, PNorm = 47.2998, GNorm = 2.3555, lr_0 = 2.8277e-04
Validation rmse = 0.885946
Epoch 17
Loss = 1.6119e-03, PNorm = 47.3148, GNorm = 2.1140, lr_0 = 2.7272e-04
Loss = 1.2382e-03, PNorm = 47.3287, GNorm = 0.6421, lr_0 = 2.6389e-04
Loss = 1.2041e-03, PNorm = 47.3429, GNorm = 1.7016, lr_0 = 2.5535e-04
Validation rmse = 0.870879
Epoch 18
Loss = 1.3091e-03, PNorm = 47.3540, GNorm = 1.8882, lr_0 = 2.4709e-04
Loss = 1.2631e-03, PNorm = 47.3665, GNorm = 0.7974, lr_0 = 2.3910e-04
Loss = 1.2703e-03, PNorm = 47.3788, GNorm = 0.5966, lr_0 = 2.3136e-04
Validation rmse = 0.922856
Epoch 19
Loss = 1.2865e-03, PNorm = 47.3905, GNorm = 1.5032, lr_0 = 2.2387e-04
Loss = 1.2819e-03, PNorm = 47.4011, GNorm = 0.7580, lr_0 = 2.1663e-04
Validation rmse = 0.908336
Epoch 20
Loss = 9.5675e-04, PNorm = 47.4108, GNorm = 0.5925, lr_0 = 2.0962e-04
Loss = 1.2113e-03, PNorm = 47.4214, GNorm = 1.4705, lr_0 = 2.0283e-04
Loss = 1.1085e-03, PNorm = 47.4315, GNorm = 1.0060, lr_0 = 1.9627e-04
Validation rmse = 0.896977
Epoch 21
Loss = 1.0452e-03, PNorm = 47.4405, GNorm = 0.9450, lr_0 = 1.8992e-04
Loss = 1.0420e-03, PNorm = 47.4487, GNorm = 0.7163, lr_0 = 1.8377e-04
Validation rmse = 0.850711
Epoch 22
Loss = 1.0088e-03, PNorm = 47.4574, GNorm = 0.5384, lr_0 = 1.7783e-04
Loss = 8.0321e-04, PNorm = 47.4653, GNorm = 1.2349, lr_0 = 1.7207e-04
Loss = 1.1560e-03, PNorm = 47.4734, GNorm = 1.7433, lr_0 = 1.6651e-04
Validation rmse = 0.898363
Epoch 23
Loss = 8.1465e-04, PNorm = 47.4827, GNorm = 0.5723, lr_0 = 1.6059e-04
Loss = 8.9475e-04, PNorm = 47.4912, GNorm = 0.4712, lr_0 = 1.5539e-04
Validation rmse = 0.848259
Epoch 24
Loss = 1.1805e-03, PNorm = 47.4978, GNorm = 1.8220, lr_0 = 1.5036e-04
Loss = 1.1506e-03, PNorm = 47.5067, GNorm = 0.4988, lr_0 = 1.4550e-04
Loss = 8.8227e-04, PNorm = 47.5139, GNorm = 0.6693, lr_0 = 1.4079e-04
Validation rmse = 0.827587
Epoch 25
Loss = 8.3859e-04, PNorm = 47.5193, GNorm = 0.8183, lr_0 = 1.3623e-04
Loss = 9.4264e-04, PNorm = 47.5260, GNorm = 1.2178, lr_0 = 1.3183e-04
Loss = 9.0392e-04, PNorm = 47.5329, GNorm = 0.5809, lr_0 = 1.2756e-04
Validation rmse = 0.863104
Epoch 26
Loss = 9.2062e-04, PNorm = 47.5399, GNorm = 1.9341, lr_0 = 1.2343e-04
Loss = 8.1453e-04, PNorm = 47.5457, GNorm = 1.0622, lr_0 = 1.1944e-04
Validation rmse = 0.846804
Epoch 27
Loss = 7.7234e-04, PNorm = 47.5491, GNorm = 0.5986, lr_0 = 1.1557e-04
Loss = 9.5435e-04, PNorm = 47.5546, GNorm = 1.2988, lr_0 = 1.1183e-04
Loss = 9.2060e-04, PNorm = 47.5597, GNorm = 1.1297, lr_0 = 1.0821e-04
Validation rmse = 0.821749
Epoch 28
Loss = 9.3389e-04, PNorm = 47.5665, GNorm = 1.3462, lr_0 = 1.0437e-04
Loss = 7.4835e-04, PNorm = 47.5711, GNorm = 0.6703, lr_0 = 1.0099e-04
Validation rmse = 0.826114
Epoch 29
Loss = 5.0273e-04, PNorm = 47.5757, GNorm = 1.1860, lr_0 = 1.0000e-04
Loss = 8.1406e-04, PNorm = 47.5809, GNorm = 0.6782, lr_0 = 1.0000e-04
Loss = 8.1461e-04, PNorm = 47.5862, GNorm = 0.8096, lr_0 = 1.0000e-04
Validation rmse = 0.826682
Model 0 best validation rmse = 0.821749 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.673163
Ensemble test rmse = 0.673163
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.8218e-02, PNorm = 46.0240, GNorm = 12.4065, lr_0 = 2.9800e-04
Loss = 1.3389e-02, PNorm = 46.0488, GNorm = 7.2977, lr_0 = 4.7800e-04
Validation rmse = 1.689895
Epoch 1
Loss = 8.6468e-03, PNorm = 46.0942, GNorm = 6.1715, lr_0 = 6.7600e-04
Loss = 8.2205e-03, PNorm = 46.1465, GNorm = 1.1647, lr_0 = 8.5600e-04
Loss = 7.3633e-03, PNorm = 46.2038, GNorm = 2.0710, lr_0 = 9.9344e-04
Validation rmse = 1.743346
Epoch 2
Loss = 6.3910e-03, PNorm = 46.2700, GNorm = 1.7078, lr_0 = 9.6130e-04
Loss = 6.0168e-03, PNorm = 46.3209, GNorm = 2.7158, lr_0 = 9.3019e-04
Validation rmse = 1.248960
Epoch 3
Loss = 4.9981e-03, PNorm = 46.3765, GNorm = 2.2975, lr_0 = 9.0009e-04
Loss = 4.2561e-03, PNorm = 46.4257, GNorm = 2.7855, lr_0 = 8.7096e-04
Loss = 3.6347e-03, PNorm = 46.4757, GNorm = 1.9732, lr_0 = 8.4278e-04
Validation rmse = 1.138433
Epoch 4
Loss = 3.2564e-03, PNorm = 46.5212, GNorm = 0.9991, lr_0 = 8.1551e-04
Loss = 5.4648e-03, PNorm = 46.5660, GNorm = 1.9358, lr_0 = 7.8912e-04
Validation rmse = 1.241184
Epoch 5
Loss = 3.2820e-03, PNorm = 46.6147, GNorm = 4.3838, lr_0 = 7.6358e-04
Loss = 3.5116e-03, PNorm = 46.6540, GNorm = 1.1525, lr_0 = 7.3888e-04
Loss = 3.8849e-03, PNorm = 46.6965, GNorm = 1.7095, lr_0 = 7.1497e-04
Validation rmse = 1.117759
Epoch 6
Loss = 2.6816e-03, PNorm = 46.7429, GNorm = 0.7208, lr_0 = 6.8956e-04
Loss = 2.8388e-03, PNorm = 46.7822, GNorm = 3.5039, lr_0 = 6.6725e-04
Loss = 3.7890e-03, PNorm = 46.8231, GNorm = 1.0856, lr_0 = 6.4565e-04
Validation rmse = 1.147475
Epoch 7
Loss = 3.2987e-03, PNorm = 46.8636, GNorm = 3.5025, lr_0 = 6.2476e-04
Loss = 2.3973e-03, PNorm = 46.8969, GNorm = 1.4995, lr_0 = 6.0454e-04
Validation rmse = 1.069845
Epoch 8
Loss = 2.2585e-03, PNorm = 46.9267, GNorm = 1.2483, lr_0 = 5.8498e-04
Loss = 1.8024e-03, PNorm = 46.9523, GNorm = 0.5810, lr_0 = 5.6605e-04
Loss = 2.1096e-03, PNorm = 46.9759, GNorm = 0.4606, lr_0 = 5.4774e-04
Validation rmse = 1.056987
Epoch 9
Loss = 2.4951e-03, PNorm = 47.0073, GNorm = 4.8908, lr_0 = 5.3001e-04
Loss = 1.8370e-03, PNorm = 47.0369, GNorm = 1.6640, lr_0 = 5.1286e-04
Validation rmse = 1.071497
Epoch 10
Loss = 2.4016e-03, PNorm = 47.0667, GNorm = 1.8967, lr_0 = 4.9627e-04
Loss = 2.0688e-03, PNorm = 47.0918, GNorm = 1.3457, lr_0 = 4.8021e-04
Loss = 1.5022e-03, PNorm = 47.1158, GNorm = 1.3237, lr_0 = 4.6467e-04
Validation rmse = 1.050359
Epoch 11
Loss = 1.9139e-03, PNorm = 47.1407, GNorm = 3.3086, lr_0 = 4.4963e-04
Loss = 1.4501e-03, PNorm = 47.1608, GNorm = 0.5801, lr_0 = 4.3508e-04
Validation rmse = 1.029473
Epoch 12
Loss = 1.5955e-03, PNorm = 47.1850, GNorm = 1.5081, lr_0 = 4.1962e-04
Loss = 1.3724e-03, PNorm = 47.2061, GNorm = 0.7810, lr_0 = 4.0604e-04
Loss = 1.5291e-03, PNorm = 47.2221, GNorm = 1.0493, lr_0 = 3.9290e-04
Validation rmse = 0.983284
Epoch 13
Loss = 1.4337e-03, PNorm = 47.2443, GNorm = 0.9974, lr_0 = 3.8019e-04
Loss = 1.4059e-03, PNorm = 47.2619, GNorm = 0.9970, lr_0 = 3.6789e-04
Loss = 1.5221e-03, PNorm = 47.2807, GNorm = 1.6215, lr_0 = 3.5598e-04
Validation rmse = 0.995741
Epoch 14
Loss = 1.4043e-03, PNorm = 47.3014, GNorm = 0.5768, lr_0 = 3.4446e-04
Loss = 1.1414e-03, PNorm = 47.3169, GNorm = 1.1843, lr_0 = 3.3332e-04
Validation rmse = 1.003177
Epoch 15
Loss = 8.6369e-04, PNorm = 47.3338, GNorm = 0.5424, lr_0 = 3.2253e-04
Loss = 1.4437e-03, PNorm = 47.3525, GNorm = 1.2499, lr_0 = 3.1209e-04
Loss = 1.3358e-03, PNorm = 47.3700, GNorm = 3.1240, lr_0 = 3.0200e-04
Validation rmse = 1.115087
Epoch 16
Loss = 1.3501e-03, PNorm = 47.3856, GNorm = 1.2258, lr_0 = 2.9222e-04
Loss = 1.6107e-03, PNorm = 47.4010, GNorm = 1.4049, lr_0 = 2.8277e-04
Validation rmse = 1.035550
Epoch 17
Loss = 1.5541e-03, PNorm = 47.4212, GNorm = 2.3684, lr_0 = 2.7272e-04
Loss = 1.2398e-03, PNorm = 47.4363, GNorm = 1.1968, lr_0 = 2.6389e-04
Loss = 1.1375e-03, PNorm = 47.4498, GNorm = 1.3342, lr_0 = 2.5535e-04
Validation rmse = 1.011328
Epoch 18
Loss = 1.3158e-03, PNorm = 47.4637, GNorm = 1.6915, lr_0 = 2.4709e-04
Loss = 9.8346e-04, PNorm = 47.4752, GNorm = 1.0665, lr_0 = 2.3910e-04
Loss = 1.1234e-03, PNorm = 47.4854, GNorm = 0.6064, lr_0 = 2.3136e-04
Validation rmse = 0.995393
Epoch 19
Loss = 1.0626e-03, PNorm = 47.4964, GNorm = 0.6426, lr_0 = 2.2387e-04
Loss = 1.0229e-03, PNorm = 47.5080, GNorm = 0.6279, lr_0 = 2.1663e-04
Validation rmse = 0.989910
Epoch 20
Loss = 9.5285e-04, PNorm = 47.5183, GNorm = 0.5297, lr_0 = 2.0962e-04
Loss = 1.0495e-03, PNorm = 47.5298, GNorm = 0.6152, lr_0 = 2.0283e-04
Loss = 1.1223e-03, PNorm = 47.5412, GNorm = 1.3705, lr_0 = 1.9627e-04
Validation rmse = 1.000175
Epoch 21
Loss = 9.1960e-04, PNorm = 47.5508, GNorm = 1.0981, lr_0 = 1.8992e-04
Loss = 9.7023e-04, PNorm = 47.5598, GNorm = 0.8426, lr_0 = 1.8377e-04
Validation rmse = 0.967173
Epoch 22
Loss = 7.8108e-04, PNorm = 47.5681, GNorm = 0.9824, lr_0 = 1.7783e-04
Loss = 9.0031e-04, PNorm = 47.5769, GNorm = 0.4230, lr_0 = 1.7207e-04
Loss = 9.7525e-04, PNorm = 47.5843, GNorm = 0.7152, lr_0 = 1.6651e-04
Validation rmse = 0.983778
Epoch 23
Loss = 7.7502e-04, PNorm = 47.5929, GNorm = 1.4063, lr_0 = 1.6059e-04
Loss = 1.0540e-03, PNorm = 47.5995, GNorm = 0.8269, lr_0 = 1.5539e-04
Validation rmse = 0.972263
Epoch 24
Loss = 7.3591e-04, PNorm = 47.6072, GNorm = 0.8007, lr_0 = 1.5036e-04
Loss = 8.6593e-04, PNorm = 47.6155, GNorm = 0.6761, lr_0 = 1.4550e-04
Loss = 9.3919e-04, PNorm = 47.6239, GNorm = 0.6140, lr_0 = 1.4079e-04
Validation rmse = 0.982906
Epoch 25
Loss = 9.1096e-04, PNorm = 47.6307, GNorm = 0.7711, lr_0 = 1.3623e-04
Loss = 7.3729e-04, PNorm = 47.6368, GNorm = 0.8684, lr_0 = 1.3183e-04
Loss = 9.6185e-04, PNorm = 47.6427, GNorm = 0.5337, lr_0 = 1.2756e-04
Validation rmse = 0.967583
Epoch 26
Loss = 7.8647e-04, PNorm = 47.6494, GNorm = 0.8823, lr_0 = 1.2343e-04
Loss = 8.3319e-04, PNorm = 47.6558, GNorm = 0.6202, lr_0 = 1.1944e-04
Validation rmse = 0.977221
Epoch 27
Loss = 8.5915e-04, PNorm = 47.6625, GNorm = 0.9139, lr_0 = 1.1557e-04
Loss = 7.6972e-04, PNorm = 47.6697, GNorm = 1.1591, lr_0 = 1.1183e-04
Loss = 8.9587e-04, PNorm = 47.6749, GNorm = 0.6976, lr_0 = 1.0821e-04
Validation rmse = 0.974446
Epoch 28
Loss = 8.1872e-04, PNorm = 47.6793, GNorm = 0.5569, lr_0 = 1.0437e-04
Loss = 7.8101e-04, PNorm = 47.6844, GNorm = 1.5335, lr_0 = 1.0099e-04
Validation rmse = 0.972737
Epoch 29
Loss = 7.2698e-04, PNorm = 47.6897, GNorm = 0.4614, lr_0 = 1.0000e-04
Loss = 6.9862e-04, PNorm = 47.6947, GNorm = 0.9865, lr_0 = 1.0000e-04
Loss = 8.8197e-04, PNorm = 47.6998, GNorm = 0.4040, lr_0 = 1.0000e-04
Validation rmse = 0.964457
Model 0 best validation rmse = 0.964457 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.746598
Ensemble test rmse = 0.746598
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.4276e-02, PNorm = 46.0265, GNorm = 7.2588, lr_0 = 2.9800e-04
Loss = 1.2642e-02, PNorm = 46.0499, GNorm = 19.0482, lr_0 = 4.7800e-04
Validation rmse = 1.559889
Epoch 1
Loss = 7.5568e-03, PNorm = 46.0906, GNorm = 8.2090, lr_0 = 6.7600e-04
Loss = 7.9337e-03, PNorm = 46.1415, GNorm = 6.4588, lr_0 = 8.5600e-04
Loss = 7.3612e-03, PNorm = 46.2015, GNorm = 2.7083, lr_0 = 9.9344e-04
Validation rmse = 1.121563
Epoch 2
Loss = 5.6520e-03, PNorm = 46.2633, GNorm = 3.3765, lr_0 = 9.6130e-04
Loss = 5.0907e-03, PNorm = 46.3217, GNorm = 4.4944, lr_0 = 9.3019e-04
Validation rmse = 1.431513
Epoch 3
Loss = 4.8401e-03, PNorm = 46.3682, GNorm = 1.6530, lr_0 = 9.0009e-04
Loss = 4.2599e-03, PNorm = 46.4172, GNorm = 2.7140, lr_0 = 8.7096e-04
Loss = 4.6663e-03, PNorm = 46.4668, GNorm = 4.2322, lr_0 = 8.4278e-04
Validation rmse = 0.881197
Epoch 4
Loss = 3.5005e-03, PNorm = 46.5156, GNorm = 2.8303, lr_0 = 8.1551e-04
Loss = 3.6431e-03, PNorm = 46.5588, GNorm = 4.1688, lr_0 = 7.8912e-04
Validation rmse = 0.978670
Epoch 5
Loss = 3.4863e-03, PNorm = 46.6002, GNorm = 3.0992, lr_0 = 7.6358e-04
Loss = 3.2417e-03, PNorm = 46.6489, GNorm = 0.6382, lr_0 = 7.3888e-04
Loss = 3.3264e-03, PNorm = 46.6892, GNorm = 2.6491, lr_0 = 7.1497e-04
Validation rmse = 0.928476
Epoch 6
Loss = 4.1026e-03, PNorm = 46.7297, GNorm = 7.5190, lr_0 = 6.8956e-04
Loss = 3.6565e-03, PNorm = 46.7674, GNorm = 0.7359, lr_0 = 6.6725e-04
Loss = 2.8224e-03, PNorm = 46.8046, GNorm = 3.0301, lr_0 = 6.4565e-04
Validation rmse = 0.872205
Epoch 7
Loss = 2.6524e-03, PNorm = 46.8417, GNorm = 1.0113, lr_0 = 6.2476e-04
Loss = 2.3569e-03, PNorm = 46.8728, GNorm = 2.3839, lr_0 = 6.0454e-04
Validation rmse = 0.910075
Epoch 8
Loss = 1.5990e-03, PNorm = 46.9051, GNorm = 0.5408, lr_0 = 5.8498e-04
Loss = 2.2872e-03, PNorm = 46.9366, GNorm = 2.4712, lr_0 = 5.6605e-04
Loss = 2.3012e-03, PNorm = 46.9668, GNorm = 1.5960, lr_0 = 5.4774e-04
Validation rmse = 0.824637
Epoch 9
Loss = 2.1105e-03, PNorm = 46.9963, GNorm = 3.2399, lr_0 = 5.3001e-04
Loss = 2.5744e-03, PNorm = 47.0299, GNorm = 2.7550, lr_0 = 5.1286e-04
Validation rmse = 0.856812
Epoch 10
Loss = 1.9509e-03, PNorm = 47.0581, GNorm = 0.6923, lr_0 = 4.9627e-04
Loss = 1.8778e-03, PNorm = 47.0864, GNorm = 0.9739, lr_0 = 4.8021e-04
Loss = 2.1716e-03, PNorm = 47.1106, GNorm = 2.9221, lr_0 = 4.6467e-04
Validation rmse = 0.956631
Epoch 11
Loss = 2.5134e-03, PNorm = 47.1365, GNorm = 3.3798, lr_0 = 4.4963e-04
Loss = 1.6240e-03, PNorm = 47.1612, GNorm = 0.8876, lr_0 = 4.3508e-04
Validation rmse = 0.799880
Epoch 12
Loss = 1.9075e-03, PNorm = 47.1812, GNorm = 0.9680, lr_0 = 4.1962e-04
Loss = 1.5860e-03, PNorm = 47.2023, GNorm = 1.3568, lr_0 = 4.0604e-04
Loss = 1.6571e-03, PNorm = 47.2210, GNorm = 0.7168, lr_0 = 3.9290e-04
Validation rmse = 0.852215
Epoch 13
Loss = 1.6031e-03, PNorm = 47.2364, GNorm = 1.1737, lr_0 = 3.8019e-04
Loss = 1.3924e-03, PNorm = 47.2515, GNorm = 1.0866, lr_0 = 3.6789e-04
Loss = 1.5819e-03, PNorm = 47.2683, GNorm = 1.1415, lr_0 = 3.5598e-04
Validation rmse = 0.763819
Epoch 14
Loss = 1.3356e-03, PNorm = 47.2858, GNorm = 1.0408, lr_0 = 3.4446e-04
Loss = 1.3964e-03, PNorm = 47.3027, GNorm = 1.4731, lr_0 = 3.3332e-04
Validation rmse = 0.817217
Epoch 15
Loss = 6.9574e-04, PNorm = 47.3207, GNorm = 0.7195, lr_0 = 3.2253e-04
Loss = 1.5608e-03, PNorm = 47.3400, GNorm = 0.6163, lr_0 = 3.1209e-04
Loss = 1.2912e-03, PNorm = 47.3562, GNorm = 0.6356, lr_0 = 3.0200e-04
Validation rmse = 0.799213
Epoch 16
Loss = 1.1058e-03, PNorm = 47.3733, GNorm = 1.6594, lr_0 = 2.9222e-04
Loss = 1.4551e-03, PNorm = 47.3889, GNorm = 2.7428, lr_0 = 2.8277e-04
Validation rmse = 0.771597
Epoch 17
Loss = 9.1707e-04, PNorm = 47.4025, GNorm = 1.4892, lr_0 = 2.7272e-04
Loss = 1.1317e-03, PNorm = 47.4132, GNorm = 0.4863, lr_0 = 2.6389e-04
Loss = 1.3751e-03, PNorm = 47.4269, GNorm = 2.3118, lr_0 = 2.5535e-04
Validation rmse = 0.732862
Epoch 18
Loss = 1.0318e-03, PNorm = 47.4398, GNorm = 0.9387, lr_0 = 2.4709e-04
Loss = 1.0994e-03, PNorm = 47.4508, GNorm = 0.6949, lr_0 = 2.3910e-04
Loss = 1.3068e-03, PNorm = 47.4620, GNorm = 2.1900, lr_0 = 2.3136e-04
Validation rmse = 0.756504
Epoch 19
Loss = 1.2048e-03, PNorm = 47.4740, GNorm = 0.8260, lr_0 = 2.2387e-04
Loss = 1.1697e-03, PNorm = 47.4860, GNorm = 0.4603, lr_0 = 2.1663e-04
Validation rmse = 0.741623
Epoch 20
Loss = 1.4785e-03, PNorm = 47.4960, GNorm = 0.9461, lr_0 = 2.0962e-04
Loss = 1.1836e-03, PNorm = 47.5061, GNorm = 2.6100, lr_0 = 2.0283e-04
Loss = 1.0636e-03, PNorm = 47.5169, GNorm = 1.3470, lr_0 = 1.9627e-04
Validation rmse = 0.729984
Epoch 21
Loss = 1.1218e-03, PNorm = 47.5281, GNorm = 1.2633, lr_0 = 1.8992e-04
Loss = 9.8259e-04, PNorm = 47.5374, GNorm = 1.1669, lr_0 = 1.8377e-04
Validation rmse = 0.753356
Epoch 22
Loss = 1.2033e-03, PNorm = 47.5451, GNorm = 0.8671, lr_0 = 1.7783e-04
Loss = 9.4884e-04, PNorm = 47.5524, GNorm = 1.3955, lr_0 = 1.7207e-04
Loss = 1.0332e-03, PNorm = 47.5603, GNorm = 0.9354, lr_0 = 1.6651e-04
Validation rmse = 0.813026
Epoch 23
Loss = 8.7889e-04, PNorm = 47.5683, GNorm = 0.7282, lr_0 = 1.6059e-04
Loss = 9.2702e-04, PNorm = 47.5759, GNorm = 0.4406, lr_0 = 1.5539e-04
Validation rmse = 0.796393
Epoch 24
Loss = 5.5994e-04, PNorm = 47.5829, GNorm = 0.4466, lr_0 = 1.5036e-04
Loss = 9.7324e-04, PNorm = 47.5900, GNorm = 0.5467, lr_0 = 1.4550e-04
Loss = 9.3784e-04, PNorm = 47.5969, GNorm = 0.4098, lr_0 = 1.4079e-04
Validation rmse = 0.763597
Epoch 25
Loss = 6.9338e-04, PNorm = 47.6037, GNorm = 0.5501, lr_0 = 1.3623e-04
Loss = 8.3925e-04, PNorm = 47.6089, GNorm = 1.0378, lr_0 = 1.3183e-04
Loss = 9.8555e-04, PNorm = 47.6152, GNorm = 0.5481, lr_0 = 1.2756e-04
Validation rmse = 0.737226
Epoch 26
Loss = 7.6564e-04, PNorm = 47.6202, GNorm = 0.5125, lr_0 = 1.2343e-04
Loss = 9.1779e-04, PNorm = 47.6265, GNorm = 0.5290, lr_0 = 1.1944e-04
Validation rmse = 0.720559
Epoch 27
Loss = 7.3025e-04, PNorm = 47.6322, GNorm = 0.6305, lr_0 = 1.1557e-04
Loss = 9.3087e-04, PNorm = 47.6381, GNorm = 1.0496, lr_0 = 1.1183e-04
Loss = 9.2584e-04, PNorm = 47.6435, GNorm = 1.3382, lr_0 = 1.0821e-04
Validation rmse = 0.757935
Epoch 28
Loss = 7.9992e-04, PNorm = 47.6481, GNorm = 0.7354, lr_0 = 1.0437e-04
Loss = 7.7705e-04, PNorm = 47.6524, GNorm = 0.5557, lr_0 = 1.0099e-04
Validation rmse = 0.751321
Epoch 29
Loss = 6.2085e-04, PNorm = 47.6581, GNorm = 0.6771, lr_0 = 1.0000e-04
Loss = 8.4832e-04, PNorm = 47.6633, GNorm = 1.6657, lr_0 = 1.0000e-04
Loss = 8.6475e-04, PNorm = 47.6681, GNorm = 1.0719, lr_0 = 1.0000e-04
Validation rmse = 0.749816
Model 0 best validation rmse = 0.720559 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.705750
Ensemble test rmse = 0.705750
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.7981e-02, PNorm = 46.0248, GNorm = 12.2868, lr_0 = 2.9800e-04
Loss = 1.2757e-02, PNorm = 46.0469, GNorm = 2.9581, lr_0 = 4.7800e-04
Validation rmse = 1.629366
Epoch 1
Loss = 9.9585e-03, PNorm = 46.0928, GNorm = 1.3182, lr_0 = 6.7600e-04
Loss = 8.0511e-03, PNorm = 46.1423, GNorm = 0.9402, lr_0 = 8.5600e-04
Loss = 6.4195e-03, PNorm = 46.1943, GNorm = 1.0652, lr_0 = 9.9344e-04
Validation rmse = 1.357491
Epoch 2
Loss = 5.8146e-03, PNorm = 46.2520, GNorm = 3.7580, lr_0 = 9.6130e-04
Loss = 4.8305e-03, PNorm = 46.3035, GNorm = 5.0850, lr_0 = 9.3019e-04
Validation rmse = 1.405679
Epoch 3
Loss = 4.3870e-03, PNorm = 46.3542, GNorm = 1.2099, lr_0 = 9.0009e-04
Loss = 4.6508e-03, PNorm = 46.4006, GNorm = 3.1282, lr_0 = 8.7096e-04
Loss = 4.4918e-03, PNorm = 46.4517, GNorm = 2.1111, lr_0 = 8.4278e-04
Validation rmse = 1.097404
Epoch 4
Loss = 3.8297e-03, PNorm = 46.4929, GNorm = 1.2367, lr_0 = 8.1551e-04
Loss = 3.5640e-03, PNorm = 46.5372, GNorm = 3.2260, lr_0 = 7.8912e-04
Validation rmse = 1.137087
Epoch 5
Loss = 2.4041e-03, PNorm = 46.5730, GNorm = 1.0806, lr_0 = 7.6358e-04
Loss = 3.2345e-03, PNorm = 46.6110, GNorm = 3.1303, lr_0 = 7.3888e-04
Loss = 3.5164e-03, PNorm = 46.6483, GNorm = 1.1012, lr_0 = 7.1497e-04
Validation rmse = 1.066371
Epoch 6
Loss = 2.8613e-03, PNorm = 46.6926, GNorm = 2.9306, lr_0 = 6.8956e-04
Loss = 2.7738e-03, PNorm = 46.7287, GNorm = 0.9762, lr_0 = 6.6725e-04
Loss = 2.8740e-03, PNorm = 46.7509, GNorm = 1.6543, lr_0 = 6.4565e-04
Validation rmse = 1.001332
Epoch 7
Loss = 2.5202e-03, PNorm = 46.7786, GNorm = 0.7480, lr_0 = 6.2476e-04
Loss = 2.2094e-03, PNorm = 46.8059, GNorm = 1.6644, lr_0 = 6.0454e-04
Validation rmse = 0.979174
Epoch 8
Loss = 2.3740e-03, PNorm = 46.8308, GNorm = 1.0863, lr_0 = 5.8498e-04
Loss = 2.2864e-03, PNorm = 46.8616, GNorm = 1.2070, lr_0 = 5.6605e-04
Loss = 1.8559e-03, PNorm = 46.8905, GNorm = 1.1572, lr_0 = 5.4774e-04
Validation rmse = 1.018070
Epoch 9
Loss = 1.9835e-03, PNorm = 46.9150, GNorm = 0.9168, lr_0 = 5.3001e-04
Loss = 2.0760e-03, PNorm = 46.9396, GNorm = 0.8526, lr_0 = 5.1286e-04
Validation rmse = 0.976118
Epoch 10
Loss = 1.8761e-03, PNorm = 46.9631, GNorm = 2.1515, lr_0 = 4.9627e-04
Loss = 2.6535e-03, PNorm = 46.9868, GNorm = 4.2441, lr_0 = 4.8021e-04
Loss = 2.2967e-03, PNorm = 47.0088, GNorm = 1.5448, lr_0 = 4.6467e-04
Validation rmse = 1.021981
Epoch 11
Loss = 2.0375e-03, PNorm = 47.0343, GNorm = 0.9472, lr_0 = 4.4963e-04
Loss = 1.8855e-03, PNorm = 47.0599, GNorm = 3.3509, lr_0 = 4.3508e-04
Validation rmse = 0.957275
Epoch 12
Loss = 1.7443e-03, PNorm = 47.0815, GNorm = 1.9819, lr_0 = 4.1962e-04
Loss = 1.6954e-03, PNorm = 47.0983, GNorm = 2.8306, lr_0 = 4.0604e-04
Loss = 1.7457e-03, PNorm = 47.1162, GNorm = 3.9762, lr_0 = 3.9290e-04
Validation rmse = 0.954317
Epoch 13
Loss = 1.8219e-03, PNorm = 47.1352, GNorm = 1.0588, lr_0 = 3.8019e-04
Loss = 1.9524e-03, PNorm = 47.1524, GNorm = 2.1267, lr_0 = 3.6789e-04
Loss = 1.7022e-03, PNorm = 47.1721, GNorm = 0.5923, lr_0 = 3.5598e-04
Validation rmse = 0.913432
Epoch 14
Loss = 1.3322e-03, PNorm = 47.1885, GNorm = 0.5664, lr_0 = 3.4446e-04
Loss = 1.4792e-03, PNorm = 47.2047, GNorm = 0.8077, lr_0 = 3.3332e-04
Validation rmse = 0.951564
Epoch 15
Loss = 1.6225e-03, PNorm = 47.2203, GNorm = 0.8859, lr_0 = 3.2253e-04
Loss = 1.3947e-03, PNorm = 47.2356, GNorm = 0.8395, lr_0 = 3.1209e-04
Loss = 1.5343e-03, PNorm = 47.2512, GNorm = 1.3059, lr_0 = 3.0200e-04
Validation rmse = 0.962080
Epoch 16
Loss = 1.3395e-03, PNorm = 47.2633, GNorm = 0.9754, lr_0 = 2.9222e-04
Loss = 1.4177e-03, PNorm = 47.2780, GNorm = 0.6539, lr_0 = 2.8277e-04
Validation rmse = 0.957471
Epoch 17
Loss = 9.9546e-04, PNorm = 47.2932, GNorm = 1.3614, lr_0 = 2.7272e-04
Loss = 1.5714e-03, PNorm = 47.3091, GNorm = 0.7019, lr_0 = 2.6389e-04
Loss = 1.3194e-03, PNorm = 47.3202, GNorm = 1.5767, lr_0 = 2.5535e-04
Validation rmse = 0.918963
Epoch 18
Loss = 1.3610e-03, PNorm = 47.3305, GNorm = 1.6702, lr_0 = 2.4709e-04
Loss = 1.4486e-03, PNorm = 47.3403, GNorm = 1.5623, lr_0 = 2.3910e-04
Loss = 1.4817e-03, PNorm = 47.3541, GNorm = 0.8988, lr_0 = 2.3136e-04
Validation rmse = 0.962340
Epoch 19
Loss = 1.2619e-03, PNorm = 47.3665, GNorm = 2.0375, lr_0 = 2.2387e-04
Loss = 1.1244e-03, PNorm = 47.3776, GNorm = 1.2818, lr_0 = 2.1663e-04
Validation rmse = 0.951654
Epoch 20
Loss = 1.1581e-03, PNorm = 47.3867, GNorm = 0.8882, lr_0 = 2.0962e-04
Loss = 1.0574e-03, PNorm = 47.3970, GNorm = 0.9427, lr_0 = 2.0283e-04
Loss = 1.3171e-03, PNorm = 47.4084, GNorm = 2.3290, lr_0 = 1.9627e-04
Validation rmse = 0.935391
Epoch 21
Loss = 9.8733e-04, PNorm = 47.4162, GNorm = 0.6528, lr_0 = 1.8992e-04
Loss = 1.2262e-03, PNorm = 47.4244, GNorm = 0.6916, lr_0 = 1.8377e-04
Validation rmse = 0.953653
Epoch 22
Loss = 1.1061e-03, PNorm = 47.4341, GNorm = 1.0923, lr_0 = 1.7783e-04
Loss = 9.8215e-04, PNorm = 47.4440, GNorm = 0.9468, lr_0 = 1.7207e-04
Loss = 1.1501e-03, PNorm = 47.4514, GNorm = 0.5945, lr_0 = 1.6651e-04
Validation rmse = 0.926243
Epoch 23
Loss = 1.0821e-03, PNorm = 47.4592, GNorm = 1.0164, lr_0 = 1.6059e-04
Loss = 1.0495e-03, PNorm = 47.4678, GNorm = 0.7214, lr_0 = 1.5539e-04
Validation rmse = 0.948453
Epoch 24
Loss = 7.0871e-04, PNorm = 47.4754, GNorm = 1.1603, lr_0 = 1.5036e-04
Loss = 1.1633e-03, PNorm = 47.4840, GNorm = 0.6957, lr_0 = 1.4550e-04
Loss = 9.8003e-04, PNorm = 47.4901, GNorm = 0.7334, lr_0 = 1.4079e-04
Validation rmse = 0.946889
Epoch 25
Loss = 8.7803e-04, PNorm = 47.4973, GNorm = 0.6449, lr_0 = 1.3623e-04
Loss = 9.9728e-04, PNorm = 47.5039, GNorm = 1.1448, lr_0 = 1.3183e-04
Loss = 1.0888e-03, PNorm = 47.5111, GNorm = 1.2204, lr_0 = 1.2756e-04
Validation rmse = 0.966954
Epoch 26
Loss = 1.0946e-03, PNorm = 47.5172, GNorm = 1.4057, lr_0 = 1.2343e-04
Loss = 9.3067e-04, PNorm = 47.5239, GNorm = 1.1301, lr_0 = 1.1944e-04
Validation rmse = 0.959837
Epoch 27
Loss = 1.2606e-03, PNorm = 47.5299, GNorm = 1.8594, lr_0 = 1.1557e-04
Loss = 9.3196e-04, PNorm = 47.5353, GNorm = 1.3262, lr_0 = 1.1183e-04
Loss = 1.0041e-03, PNorm = 47.5400, GNorm = 0.8049, lr_0 = 1.0821e-04
Validation rmse = 0.948685
Epoch 28
Loss = 1.0252e-03, PNorm = 47.5461, GNorm = 1.2242, lr_0 = 1.0437e-04
Loss = 7.6155e-04, PNorm = 47.5520, GNorm = 0.4849, lr_0 = 1.0099e-04
Validation rmse = 0.934320
Epoch 29
Loss = 4.9331e-04, PNorm = 47.5561, GNorm = 0.6241, lr_0 = 1.0000e-04
Loss = 9.1412e-04, PNorm = 47.5608, GNorm = 0.5029, lr_0 = 1.0000e-04
Loss = 8.8210e-04, PNorm = 47.5648, GNorm = 1.1491, lr_0 = 1.0000e-04
Validation rmse = 0.990777
Model 0 best validation rmse = 0.913432 on epoch 13
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.730933
Ensemble test rmse = 0.730933
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.7620e-02, PNorm = 46.0252, GNorm = 10.4119, lr_0 = 2.9800e-04
Loss = 1.3098e-02, PNorm = 46.0498, GNorm = 8.8966, lr_0 = 4.7800e-04
Validation rmse = 1.569579
Epoch 1
Loss = 7.5193e-03, PNorm = 46.0935, GNorm = 3.4565, lr_0 = 6.7600e-04
Loss = 7.5788e-03, PNorm = 46.1425, GNorm = 5.4129, lr_0 = 8.5600e-04
Loss = 6.8518e-03, PNorm = 46.2050, GNorm = 3.0697, lr_0 = 9.9344e-04
Validation rmse = 1.305424
Epoch 2
Loss = 6.1094e-03, PNorm = 46.2688, GNorm = 3.9741, lr_0 = 9.6130e-04
Loss = 4.3248e-03, PNorm = 46.3290, GNorm = 6.0177, lr_0 = 9.3019e-04
Validation rmse = 1.057883
Epoch 3
Loss = 3.8311e-03, PNorm = 46.3786, GNorm = 2.5724, lr_0 = 9.0009e-04
Loss = 4.0783e-03, PNorm = 46.4262, GNorm = 2.4205, lr_0 = 8.7096e-04
Loss = 4.6286e-03, PNorm = 46.4732, GNorm = 1.1754, lr_0 = 8.4278e-04
Validation rmse = 1.064061
Epoch 4
Loss = 4.2734e-03, PNorm = 46.5176, GNorm = 3.5055, lr_0 = 8.1551e-04
Loss = 3.9157e-03, PNorm = 46.5612, GNorm = 2.1885, lr_0 = 7.8912e-04
Validation rmse = 1.123803
Epoch 5
Loss = 3.0141e-03, PNorm = 46.6039, GNorm = 1.4195, lr_0 = 7.6358e-04
Loss = 3.3111e-03, PNorm = 46.6422, GNorm = 2.0991, lr_0 = 7.3888e-04
Loss = 2.6894e-03, PNorm = 46.6733, GNorm = 2.5217, lr_0 = 7.1497e-04
Validation rmse = 1.023449
Epoch 6
Loss = 2.4527e-03, PNorm = 46.7131, GNorm = 0.9709, lr_0 = 6.8956e-04
Loss = 2.7208e-03, PNorm = 46.7478, GNorm = 3.0218, lr_0 = 6.6725e-04
Loss = 2.3416e-03, PNorm = 46.7777, GNorm = 3.8308, lr_0 = 6.4565e-04
Validation rmse = 0.903935
Epoch 7
Loss = 1.9243e-03, PNorm = 46.8085, GNorm = 1.0630, lr_0 = 6.2476e-04
Loss = 2.2399e-03, PNorm = 46.8346, GNorm = 0.9061, lr_0 = 6.0454e-04
Validation rmse = 0.942768
Epoch 8
Loss = 2.5529e-03, PNorm = 46.8648, GNorm = 2.9431, lr_0 = 5.8498e-04
Loss = 2.0819e-03, PNorm = 46.8984, GNorm = 0.5996, lr_0 = 5.6605e-04
Loss = 1.8574e-03, PNorm = 46.9265, GNorm = 2.6304, lr_0 = 5.4774e-04
Validation rmse = 0.856418
Epoch 9
Loss = 1.4978e-03, PNorm = 46.9518, GNorm = 1.1596, lr_0 = 5.3001e-04
Loss = 1.7502e-03, PNorm = 46.9757, GNorm = 2.6389, lr_0 = 5.1286e-04
Validation rmse = 0.828847
Epoch 10
Loss = 1.7134e-03, PNorm = 47.0031, GNorm = 2.2928, lr_0 = 4.9627e-04
Loss = 1.8376e-03, PNorm = 47.0287, GNorm = 0.5340, lr_0 = 4.8021e-04
Loss = 1.9101e-03, PNorm = 47.0570, GNorm = 0.9372, lr_0 = 4.6467e-04
Validation rmse = 0.836277
Epoch 11
Loss = 1.5528e-03, PNorm = 47.0808, GNorm = 0.6249, lr_0 = 4.4963e-04
Loss = 1.6585e-03, PNorm = 47.1034, GNorm = 1.2797, lr_0 = 4.3508e-04
Validation rmse = 0.814071
Epoch 12
Loss = 1.0787e-03, PNorm = 47.1254, GNorm = 0.8621, lr_0 = 4.1962e-04
Loss = 1.6980e-03, PNorm = 47.1477, GNorm = 0.7643, lr_0 = 4.0604e-04
Loss = 1.5617e-03, PNorm = 47.1703, GNorm = 1.3738, lr_0 = 3.9290e-04
Validation rmse = 0.834885
Epoch 13
Loss = 1.4651e-03, PNorm = 47.1853, GNorm = 0.7567, lr_0 = 3.8019e-04
Loss = 1.3806e-03, PNorm = 47.2077, GNorm = 0.7305, lr_0 = 3.6789e-04
Loss = 1.5430e-03, PNorm = 47.2254, GNorm = 0.9440, lr_0 = 3.5598e-04
Validation rmse = 0.766256
Epoch 14
Loss = 1.2849e-03, PNorm = 47.2450, GNorm = 1.2762, lr_0 = 3.4446e-04
Loss = 1.2645e-03, PNorm = 47.2626, GNorm = 0.5716, lr_0 = 3.3332e-04
Validation rmse = 0.904823
Epoch 15
Loss = 2.1202e-03, PNorm = 47.2792, GNorm = 1.3340, lr_0 = 3.2253e-04
Loss = 1.4194e-03, PNorm = 47.2982, GNorm = 0.8853, lr_0 = 3.1209e-04
Loss = 1.0889e-03, PNorm = 47.3152, GNorm = 0.8843, lr_0 = 3.0200e-04
Validation rmse = 0.797970
Epoch 16
Loss = 1.1687e-03, PNorm = 47.3296, GNorm = 0.3834, lr_0 = 2.9222e-04
Loss = 1.1142e-03, PNorm = 47.3424, GNorm = 0.7466, lr_0 = 2.8277e-04
Validation rmse = 0.754069
Epoch 17
Loss = 9.8127e-04, PNorm = 47.3579, GNorm = 0.8479, lr_0 = 2.7272e-04
Loss = 1.1207e-03, PNorm = 47.3703, GNorm = 0.5832, lr_0 = 2.6389e-04
Loss = 1.0909e-03, PNorm = 47.3812, GNorm = 0.4877, lr_0 = 2.5535e-04
Validation rmse = 0.761476
Epoch 18
Loss = 1.1547e-03, PNorm = 47.3922, GNorm = 0.4204, lr_0 = 2.4709e-04
Loss = 1.1559e-03, PNorm = 47.4060, GNorm = 2.9901, lr_0 = 2.3910e-04
Loss = 1.0447e-03, PNorm = 47.4170, GNorm = 0.6139, lr_0 = 2.3136e-04
Validation rmse = 0.747838
Epoch 19
Loss = 1.1357e-03, PNorm = 47.4272, GNorm = 0.9107, lr_0 = 2.2387e-04
Loss = 1.0574e-03, PNorm = 47.4373, GNorm = 0.6964, lr_0 = 2.1663e-04
Validation rmse = 0.716267
Epoch 20
Loss = 7.8469e-04, PNorm = 47.4478, GNorm = 0.5951, lr_0 = 2.0962e-04
Loss = 1.1136e-03, PNorm = 47.4571, GNorm = 1.4031, lr_0 = 2.0283e-04
Loss = 9.6130e-04, PNorm = 47.4666, GNorm = 1.2269, lr_0 = 1.9627e-04
Validation rmse = 0.749765
Epoch 21
Loss = 9.1129e-04, PNorm = 47.4760, GNorm = 0.5518, lr_0 = 1.8992e-04
Loss = 1.0524e-03, PNorm = 47.4861, GNorm = 0.9005, lr_0 = 1.8377e-04
Validation rmse = 0.754735
Epoch 22
Loss = 8.3239e-04, PNorm = 47.4960, GNorm = 0.3599, lr_0 = 1.7783e-04
Loss = 9.2723e-04, PNorm = 47.5040, GNorm = 0.5029, lr_0 = 1.7207e-04
Loss = 9.5581e-04, PNorm = 47.5111, GNorm = 0.4698, lr_0 = 1.6651e-04
Validation rmse = 0.743740
Epoch 23
Loss = 1.0726e-03, PNorm = 47.5191, GNorm = 1.2277, lr_0 = 1.6059e-04
Loss = 8.9019e-04, PNorm = 47.5279, GNorm = 1.4520, lr_0 = 1.5539e-04
Validation rmse = 0.753238
Epoch 24
Loss = 1.1501e-03, PNorm = 47.5357, GNorm = 1.9348, lr_0 = 1.5036e-04
Loss = 1.0778e-03, PNorm = 47.5429, GNorm = 2.7327, lr_0 = 1.4550e-04
Loss = 1.1350e-03, PNorm = 47.5503, GNorm = 3.1794, lr_0 = 1.4079e-04
Validation rmse = 0.771229
Epoch 25
Loss = 8.2578e-04, PNorm = 47.5578, GNorm = 1.2769, lr_0 = 1.3623e-04
Loss = 9.5295e-04, PNorm = 47.5641, GNorm = 2.2310, lr_0 = 1.3183e-04
Loss = 1.0227e-03, PNorm = 47.5704, GNorm = 1.6264, lr_0 = 1.2756e-04
Validation rmse = 0.717461
Epoch 26
Loss = 8.9412e-04, PNorm = 47.5776, GNorm = 0.8140, lr_0 = 1.2343e-04
Loss = 8.2965e-04, PNorm = 47.5830, GNorm = 1.0808, lr_0 = 1.1944e-04
Validation rmse = 0.737938
Epoch 27
Loss = 1.0532e-03, PNorm = 47.5887, GNorm = 2.1743, lr_0 = 1.1557e-04
Loss = 8.5032e-04, PNorm = 47.5952, GNorm = 0.5217, lr_0 = 1.1183e-04
Loss = 8.0956e-04, PNorm = 47.6003, GNorm = 0.4527, lr_0 = 1.0821e-04
Validation rmse = 0.724020
Epoch 28
Loss = 8.6476e-04, PNorm = 47.6058, GNorm = 1.4284, lr_0 = 1.0437e-04
Loss = 7.9802e-04, PNorm = 47.6105, GNorm = 0.4533, lr_0 = 1.0099e-04
Validation rmse = 0.763035
Epoch 29
Loss = 8.9648e-04, PNorm = 47.6158, GNorm = 2.1604, lr_0 = 1.0000e-04
Loss = 8.9463e-04, PNorm = 47.6216, GNorm = 0.7908, lr_0 = 1.0000e-04
Loss = 7.6628e-04, PNorm = 47.6259, GNorm = 0.5454, lr_0 = 1.0000e-04
Validation rmse = 0.720304
Model 0 best validation rmse = 0.716267 on epoch 19
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.755943
Ensemble test rmse = 0.755943
10-fold cross validation
	Seed 0 ==> test rmse = 0.768308
	Seed 1 ==> test rmse = 0.696907
	Seed 2 ==> test rmse = 0.658745
	Seed 3 ==> test rmse = 0.894170
	Seed 4 ==> test rmse = 1.056610
	Seed 5 ==> test rmse = 0.673163
	Seed 6 ==> test rmse = 0.746598
	Seed 7 ==> test rmse = 0.705750
	Seed 8 ==> test rmse = 0.730933
	Seed 9 ==> test rmse = 0.755943
Overall test rmse = 0.768713 +/- 0.114476
Elapsed time = 0:08:15
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.6796e-02, PNorm = 65.0286, GNorm = 9.0341, lr_0 = 2.9800e-04
Loss = 1.3104e-02, PNorm = 65.0752, GNorm = 3.2914, lr_0 = 4.7800e-04
Validation rmse = 1.648737
Epoch 1
Loss = 8.7812e-03, PNorm = 65.1500, GNorm = 4.6956, lr_0 = 6.7600e-04
Loss = 8.2752e-03, PNorm = 65.2400, GNorm = 7.8968, lr_0 = 8.5600e-04
Loss = 8.5346e-03, PNorm = 65.3515, GNorm = 1.7634, lr_0 = 9.9344e-04
Validation rmse = 1.299464
Epoch 2
Loss = 7.8983e-03, PNorm = 65.4734, GNorm = 2.6336, lr_0 = 9.6130e-04
Loss = 5.9847e-03, PNorm = 65.5715, GNorm = 1.5169, lr_0 = 9.3019e-04
Validation rmse = 1.228157
Epoch 3
Loss = 5.1821e-03, PNorm = 65.6625, GNorm = 1.8567, lr_0 = 9.0009e-04
Loss = 4.3346e-03, PNorm = 65.7513, GNorm = 0.8090, lr_0 = 8.7096e-04
Loss = 4.7518e-03, PNorm = 65.8222, GNorm = 4.1643, lr_0 = 8.4278e-04
Validation rmse = 1.135552
Epoch 4
Loss = 3.6934e-03, PNorm = 65.8914, GNorm = 0.6875, lr_0 = 8.1551e-04
Loss = 4.3633e-03, PNorm = 65.9448, GNorm = 3.8868, lr_0 = 7.8912e-04
Validation rmse = 1.413472
Epoch 5
Loss = 7.2466e-03, PNorm = 66.0002, GNorm = 5.0446, lr_0 = 7.6358e-04
Loss = 4.6733e-03, PNorm = 66.0600, GNorm = 2.0303, lr_0 = 7.3888e-04
Loss = 3.9494e-03, PNorm = 66.1161, GNorm = 2.1931, lr_0 = 7.1497e-04
Validation rmse = 0.962626
Epoch 6
Loss = 2.9934e-03, PNorm = 66.1718, GNorm = 0.8495, lr_0 = 6.8956e-04
Loss = 3.4236e-03, PNorm = 66.2145, GNorm = 0.7045, lr_0 = 6.6725e-04
Loss = 2.8181e-03, PNorm = 66.2461, GNorm = 2.0391, lr_0 = 6.4565e-04
Validation rmse = 0.976233
Epoch 7
Loss = 2.3782e-03, PNorm = 66.2856, GNorm = 1.2108, lr_0 = 6.2476e-04
Loss = 2.4376e-03, PNorm = 66.3199, GNorm = 1.1131, lr_0 = 6.0454e-04
Validation rmse = 0.894881
Epoch 8
Loss = 2.1477e-03, PNorm = 66.3502, GNorm = 0.7140, lr_0 = 5.8498e-04
Loss = 2.5396e-03, PNorm = 66.3789, GNorm = 1.5626, lr_0 = 5.6605e-04
Loss = 2.0162e-03, PNorm = 66.4171, GNorm = 2.1894, lr_0 = 5.4774e-04
Validation rmse = 0.936461
Epoch 9
Loss = 1.9487e-03, PNorm = 66.4518, GNorm = 1.5850, lr_0 = 5.3001e-04
Loss = 2.0870e-03, PNorm = 66.4784, GNorm = 1.7820, lr_0 = 5.1286e-04
Validation rmse = 0.858755
Epoch 10
Loss = 2.0369e-03, PNorm = 66.5064, GNorm = 1.6802, lr_0 = 4.9627e-04
Loss = 2.1091e-03, PNorm = 66.5444, GNorm = 1.7838, lr_0 = 4.8021e-04
Loss = 1.8634e-03, PNorm = 66.5754, GNorm = 1.9770, lr_0 = 4.6467e-04
Validation rmse = 0.882422
Epoch 11
Loss = 1.7453e-03, PNorm = 66.5928, GNorm = 0.7715, lr_0 = 4.4963e-04
Loss = 1.5171e-03, PNorm = 66.6208, GNorm = 0.5720, lr_0 = 4.3508e-04
Validation rmse = 0.880178
Epoch 12
Loss = 1.7614e-03, PNorm = 66.6514, GNorm = 1.1706, lr_0 = 4.1962e-04
Loss = 1.7992e-03, PNorm = 66.6720, GNorm = 1.2679, lr_0 = 4.0604e-04
Loss = 1.7375e-03, PNorm = 66.6983, GNorm = 2.5705, lr_0 = 3.9290e-04
Validation rmse = 0.803367
Epoch 13
Loss = 1.6496e-03, PNorm = 66.7235, GNorm = 2.0936, lr_0 = 3.8019e-04
Loss = 1.6259e-03, PNorm = 66.7476, GNorm = 1.2734, lr_0 = 3.6789e-04
Loss = 1.4870e-03, PNorm = 66.7686, GNorm = 1.2148, lr_0 = 3.5598e-04
Validation rmse = 0.830383
Epoch 14
Loss = 1.4478e-03, PNorm = 66.7873, GNorm = 1.2605, lr_0 = 3.4446e-04
Loss = 1.1826e-03, PNorm = 66.8056, GNorm = 1.8652, lr_0 = 3.3332e-04
Validation rmse = 0.821796
Epoch 15
Loss = 1.4056e-03, PNorm = 66.8246, GNorm = 2.1940, lr_0 = 3.2253e-04
Loss = 1.5647e-03, PNorm = 66.8410, GNorm = 1.8712, lr_0 = 3.1209e-04
Loss = 1.6899e-03, PNorm = 66.8635, GNorm = 2.8280, lr_0 = 3.0200e-04
Validation rmse = 0.829350
Epoch 16
Loss = 1.2105e-03, PNorm = 66.8830, GNorm = 0.6003, lr_0 = 2.9222e-04
Loss = 1.3229e-03, PNorm = 66.8987, GNorm = 1.9274, lr_0 = 2.8277e-04
Validation rmse = 0.809200
Epoch 17
Loss = 1.3467e-03, PNorm = 66.9129, GNorm = 0.5798, lr_0 = 2.7272e-04
Loss = 1.2638e-03, PNorm = 66.9286, GNorm = 1.5982, lr_0 = 2.6389e-04
Loss = 1.2837e-03, PNorm = 66.9469, GNorm = 1.4919, lr_0 = 2.5535e-04
Validation rmse = 0.799748
Epoch 18
Loss = 1.1870e-03, PNorm = 66.9597, GNorm = 0.4258, lr_0 = 2.4709e-04
Loss = 1.0564e-03, PNorm = 66.9714, GNorm = 2.2136, lr_0 = 2.3910e-04
Loss = 1.1370e-03, PNorm = 66.9855, GNorm = 0.5394, lr_0 = 2.3136e-04
Validation rmse = 0.764183
Epoch 19
Loss = 1.0571e-03, PNorm = 67.0026, GNorm = 0.4083, lr_0 = 2.2387e-04
Loss = 1.1508e-03, PNorm = 67.0146, GNorm = 2.2276, lr_0 = 2.1663e-04
Validation rmse = 0.786048
Epoch 20
Loss = 8.3514e-04, PNorm = 67.0277, GNorm = 1.2654, lr_0 = 2.0962e-04
Loss = 1.0511e-03, PNorm = 67.0382, GNorm = 0.5025, lr_0 = 2.0283e-04
Loss = 9.8884e-04, PNorm = 67.0503, GNorm = 0.3942, lr_0 = 1.9627e-04
Validation rmse = 0.803580
Epoch 21
Loss = 9.7332e-04, PNorm = 67.0613, GNorm = 1.5798, lr_0 = 1.8992e-04
Loss = 9.4345e-04, PNorm = 67.0701, GNorm = 0.7461, lr_0 = 1.8377e-04
Validation rmse = 0.777675
Epoch 22
Loss = 9.2200e-04, PNorm = 67.0822, GNorm = 0.4955, lr_0 = 1.7783e-04
Loss = 9.4817e-04, PNorm = 67.0910, GNorm = 1.1203, lr_0 = 1.7207e-04
Loss = 9.7692e-04, PNorm = 67.0994, GNorm = 0.5962, lr_0 = 1.6651e-04
Validation rmse = 0.809118
Epoch 23
Loss = 8.9822e-04, PNorm = 67.1094, GNorm = 0.9458, lr_0 = 1.6059e-04
Loss = 1.0555e-03, PNorm = 67.1188, GNorm = 1.7458, lr_0 = 1.5539e-04
Validation rmse = 0.772158
Epoch 24
Loss = 9.3856e-04, PNorm = 67.1280, GNorm = 0.9462, lr_0 = 1.5036e-04
Loss = 9.0368e-04, PNorm = 67.1354, GNorm = 1.1047, lr_0 = 1.4550e-04
Loss = 9.7508e-04, PNorm = 67.1428, GNorm = 0.5613, lr_0 = 1.4079e-04
Validation rmse = 0.795961
Epoch 25
Loss = 7.7718e-04, PNorm = 67.1514, GNorm = 0.4396, lr_0 = 1.3623e-04
Loss = 9.4976e-04, PNorm = 67.1587, GNorm = 0.5661, lr_0 = 1.3183e-04
Loss = 9.4014e-04, PNorm = 67.1659, GNorm = 0.7016, lr_0 = 1.2756e-04
Validation rmse = 0.812698
Epoch 26
Loss = 7.4492e-04, PNorm = 67.1734, GNorm = 0.8835, lr_0 = 1.2343e-04
Loss = 8.9654e-04, PNorm = 67.1788, GNorm = 0.4953, lr_0 = 1.1944e-04
Validation rmse = 0.772120
Epoch 27
Loss = 9.2717e-04, PNorm = 67.1863, GNorm = 0.7753, lr_0 = 1.1557e-04
Loss = 8.9937e-04, PNorm = 67.1931, GNorm = 1.1462, lr_0 = 1.1183e-04
Loss = 8.5742e-04, PNorm = 67.1989, GNorm = 0.5222, lr_0 = 1.0821e-04
Validation rmse = 0.782846
Epoch 28
Loss = 8.8237e-04, PNorm = 67.2062, GNorm = 0.4070, lr_0 = 1.0437e-04
Loss = 7.1741e-04, PNorm = 67.2128, GNorm = 0.4490, lr_0 = 1.0099e-04
Validation rmse = 0.791382
Epoch 29
Loss = 9.8745e-04, PNorm = 67.2175, GNorm = 1.2690, lr_0 = 1.0000e-04
Loss = 7.8204e-04, PNorm = 67.2236, GNorm = 0.6823, lr_0 = 1.0000e-04
Loss = 9.2518e-04, PNorm = 67.2290, GNorm = 2.3619, lr_0 = 1.0000e-04
Validation rmse = 0.789120
Model 0 best validation rmse = 0.764183 on epoch 18
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.784245
Ensemble test rmse = 0.784245
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.8787e-02, PNorm = 65.0280, GNorm = 6.9678, lr_0 = 2.9800e-04
Loss = 1.0667e-02, PNorm = 65.0739, GNorm = 12.0808, lr_0 = 4.7800e-04
Validation rmse = 1.803751
Epoch 1
Loss = 8.5085e-03, PNorm = 65.1408, GNorm = 3.2410, lr_0 = 6.7600e-04
Loss = 1.1151e-02, PNorm = 65.2290, GNorm = 2.8984, lr_0 = 8.5600e-04
Loss = 7.0968e-03, PNorm = 65.3344, GNorm = 0.6962, lr_0 = 9.9344e-04
Validation rmse = 1.468622
Epoch 2
Loss = 7.0382e-03, PNorm = 65.4404, GNorm = 6.1990, lr_0 = 9.6130e-04
Loss = 7.4657e-03, PNorm = 65.5403, GNorm = 1.2127, lr_0 = 9.3019e-04
Validation rmse = 1.296833
Epoch 3
Loss = 5.1187e-03, PNorm = 65.6313, GNorm = 2.3065, lr_0 = 9.0009e-04
Loss = 6.0545e-03, PNorm = 65.7144, GNorm = 1.6718, lr_0 = 8.7096e-04
Loss = 3.9585e-03, PNorm = 65.7903, GNorm = 2.2790, lr_0 = 8.4278e-04
Validation rmse = 0.979218
Epoch 4
Loss = 4.4357e-03, PNorm = 65.8538, GNorm = 2.1358, lr_0 = 8.1551e-04
Loss = 3.1152e-03, PNorm = 65.9193, GNorm = 1.7671, lr_0 = 7.8912e-04
Validation rmse = 0.882448
Epoch 5
Loss = 3.0942e-03, PNorm = 65.9695, GNorm = 2.0463, lr_0 = 7.6358e-04
Loss = 3.5099e-03, PNorm = 66.0190, GNorm = 3.0454, lr_0 = 7.3888e-04
Loss = 3.0356e-03, PNorm = 66.0647, GNorm = 1.5294, lr_0 = 7.1497e-04
Validation rmse = 1.226560
Epoch 6
Loss = 4.7802e-03, PNorm = 66.1111, GNorm = 2.4086, lr_0 = 6.8956e-04
Loss = 3.1634e-03, PNorm = 66.1570, GNorm = 2.1705, lr_0 = 6.6725e-04
Loss = 2.7726e-03, PNorm = 66.1971, GNorm = 1.7304, lr_0 = 6.4565e-04
Validation rmse = 0.849454
Epoch 7
Loss = 2.9002e-03, PNorm = 66.2357, GNorm = 2.6221, lr_0 = 6.2476e-04
Loss = 3.0283e-03, PNorm = 66.2711, GNorm = 6.7588, lr_0 = 6.0454e-04
Validation rmse = 1.105580
Epoch 8
Loss = 4.2154e-03, PNorm = 66.3168, GNorm = 4.7702, lr_0 = 5.8498e-04
Loss = 2.8754e-03, PNorm = 66.3616, GNorm = 0.8623, lr_0 = 5.6605e-04
Loss = 2.5755e-03, PNorm = 66.3968, GNorm = 2.9015, lr_0 = 5.4774e-04
Validation rmse = 0.833595
Epoch 9
Loss = 2.0359e-03, PNorm = 66.4274, GNorm = 1.2136, lr_0 = 5.3001e-04
Loss = 2.3642e-03, PNorm = 66.4611, GNorm = 0.9918, lr_0 = 5.1286e-04
Validation rmse = 0.850836
Epoch 10
Loss = 2.4215e-03, PNorm = 66.4854, GNorm = 3.6295, lr_0 = 4.9627e-04
Loss = 3.1795e-03, PNorm = 66.5146, GNorm = 3.4505, lr_0 = 4.8021e-04
Loss = 2.2853e-03, PNorm = 66.5464, GNorm = 1.7038, lr_0 = 4.6467e-04
Validation rmse = 0.873561
Epoch 11
Loss = 2.4591e-03, PNorm = 66.5788, GNorm = 1.0958, lr_0 = 4.4963e-04
Loss = 2.4338e-03, PNorm = 66.6046, GNorm = 0.8701, lr_0 = 4.3508e-04
Validation rmse = 0.782268
Epoch 12
Loss = 2.5084e-03, PNorm = 66.6357, GNorm = 1.7770, lr_0 = 4.1962e-04
Loss = 1.9645e-03, PNorm = 66.6636, GNorm = 1.5098, lr_0 = 4.0604e-04
Loss = 2.2568e-03, PNorm = 66.6894, GNorm = 0.9815, lr_0 = 3.9290e-04
Validation rmse = 0.944719
Epoch 13
Loss = 2.1844e-03, PNorm = 66.7140, GNorm = 1.2570, lr_0 = 3.8019e-04
Loss = 2.5849e-03, PNorm = 66.7357, GNorm = 2.3949, lr_0 = 3.6789e-04
Loss = 2.0041e-03, PNorm = 66.7530, GNorm = 0.7980, lr_0 = 3.5598e-04
Validation rmse = 0.712269
Epoch 14
Loss = 1.6223e-03, PNorm = 66.7739, GNorm = 0.6510, lr_0 = 3.4446e-04
Loss = 1.6022e-03, PNorm = 66.7915, GNorm = 2.0303, lr_0 = 3.3332e-04
Validation rmse = 0.767774
Epoch 15
Loss = 1.4052e-03, PNorm = 66.8106, GNorm = 0.5235, lr_0 = 3.2253e-04
Loss = 1.7246e-03, PNorm = 66.8260, GNorm = 2.5214, lr_0 = 3.1209e-04
Loss = 2.1142e-03, PNorm = 66.8464, GNorm = 1.1426, lr_0 = 3.0200e-04
Validation rmse = 0.750157
Epoch 16
Loss = 2.0393e-03, PNorm = 66.8658, GNorm = 1.0957, lr_0 = 2.9222e-04
Loss = 1.3390e-03, PNorm = 66.8829, GNorm = 0.6211, lr_0 = 2.8277e-04
Validation rmse = 0.675916
Epoch 17
Loss = 1.1567e-03, PNorm = 66.8994, GNorm = 0.3971, lr_0 = 2.7272e-04
Loss = 1.4842e-03, PNorm = 66.9157, GNorm = 0.4996, lr_0 = 2.6389e-04
Loss = 1.3708e-03, PNorm = 66.9310, GNorm = 1.5617, lr_0 = 2.5535e-04
Validation rmse = 0.695408
Epoch 18
Loss = 1.3894e-03, PNorm = 66.9446, GNorm = 0.6852, lr_0 = 2.4709e-04
Loss = 1.3847e-03, PNorm = 66.9603, GNorm = 0.7805, lr_0 = 2.3910e-04
Loss = 1.3379e-03, PNorm = 66.9758, GNorm = 1.0405, lr_0 = 2.3136e-04
Validation rmse = 0.681063
Epoch 19
Loss = 1.2730e-03, PNorm = 66.9866, GNorm = 1.6803, lr_0 = 2.2387e-04
Loss = 1.2943e-03, PNorm = 67.0007, GNorm = 0.5778, lr_0 = 2.1663e-04
Validation rmse = 0.676344
Epoch 20
Loss = 1.0333e-03, PNorm = 67.0159, GNorm = 0.5618, lr_0 = 2.0962e-04
Loss = 1.5270e-03, PNorm = 67.0314, GNorm = 0.9898, lr_0 = 2.0283e-04
Loss = 1.2112e-03, PNorm = 67.0431, GNorm = 0.6291, lr_0 = 1.9627e-04
Validation rmse = 0.708401
Epoch 21
Loss = 1.1413e-03, PNorm = 67.0547, GNorm = 0.4972, lr_0 = 1.8992e-04
Loss = 1.2653e-03, PNorm = 67.0672, GNorm = 1.8301, lr_0 = 1.8377e-04
Validation rmse = 0.655040
Epoch 22
Loss = 9.9364e-04, PNorm = 67.0779, GNorm = 1.3875, lr_0 = 1.7783e-04
Loss = 1.0918e-03, PNorm = 67.0861, GNorm = 0.5470, lr_0 = 1.7207e-04
Loss = 1.2747e-03, PNorm = 67.0960, GNorm = 1.4436, lr_0 = 1.6651e-04
Validation rmse = 0.660553
Epoch 23
Loss = 9.5059e-04, PNorm = 67.1085, GNorm = 1.2568, lr_0 = 1.6059e-04
Loss = 1.1466e-03, PNorm = 67.1198, GNorm = 1.2239, lr_0 = 1.5539e-04
Validation rmse = 0.725806
Epoch 24
Loss = 1.1809e-03, PNorm = 67.1282, GNorm = 1.5957, lr_0 = 1.5036e-04
Loss = 1.3710e-03, PNorm = 67.1373, GNorm = 1.6998, lr_0 = 1.4550e-04
Loss = 1.2357e-03, PNorm = 67.1496, GNorm = 1.5300, lr_0 = 1.4079e-04
Validation rmse = 0.719202
Epoch 25
Loss = 1.0159e-03, PNorm = 67.1596, GNorm = 0.4257, lr_0 = 1.3623e-04
Loss = 1.1670e-03, PNorm = 67.1693, GNorm = 1.0945, lr_0 = 1.3183e-04
Loss = 1.2698e-03, PNorm = 67.1787, GNorm = 0.4982, lr_0 = 1.2756e-04
Validation rmse = 0.655816
Epoch 26
Loss = 1.1098e-03, PNorm = 67.1855, GNorm = 0.6633, lr_0 = 1.2343e-04
Loss = 1.0952e-03, PNorm = 67.1951, GNorm = 1.0670, lr_0 = 1.1944e-04
Validation rmse = 0.645061
Epoch 27
Loss = 1.0997e-03, PNorm = 67.2018, GNorm = 0.5049, lr_0 = 1.1557e-04
Loss = 9.6721e-04, PNorm = 67.2094, GNorm = 1.8366, lr_0 = 1.1183e-04
Loss = 1.1433e-03, PNorm = 67.2174, GNorm = 0.3070, lr_0 = 1.0821e-04
Validation rmse = 0.658366
Epoch 28
Loss = 1.1490e-03, PNorm = 67.2258, GNorm = 0.8556, lr_0 = 1.0437e-04
Loss = 9.2978e-04, PNorm = 67.2325, GNorm = 0.6269, lr_0 = 1.0099e-04
Validation rmse = 0.654881
Epoch 29
Loss = 9.8947e-04, PNorm = 67.2393, GNorm = 1.2297, lr_0 = 1.0000e-04
Loss = 1.0329e-03, PNorm = 67.2457, GNorm = 1.1351, lr_0 = 1.0000e-04
Loss = 1.0095e-03, PNorm = 67.2527, GNorm = 0.6496, lr_0 = 1.0000e-04
Validation rmse = 0.656244
Model 0 best validation rmse = 0.645061 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.680039
Ensemble test rmse = 0.680039
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.9799e-02, PNorm = 65.0262, GNorm = 2.3703, lr_0 = 2.9800e-04
Loss = 1.4467e-02, PNorm = 65.0718, GNorm = 6.5133, lr_0 = 4.7800e-04
Validation rmse = 1.374839
Epoch 1
Loss = 8.8153e-03, PNorm = 65.1587, GNorm = 6.4513, lr_0 = 6.7600e-04
Loss = 7.9238e-03, PNorm = 65.2384, GNorm = 2.9269, lr_0 = 8.5600e-04
Loss = 9.1247e-03, PNorm = 65.3544, GNorm = 4.8299, lr_0 = 9.9344e-04
Validation rmse = 1.547061
Epoch 2
Loss = 7.7423e-03, PNorm = 65.4831, GNorm = 3.7423, lr_0 = 9.6130e-04
Loss = 6.4854e-03, PNorm = 65.5938, GNorm = 1.8871, lr_0 = 9.3019e-04
Validation rmse = 0.981145
Epoch 3
Loss = 4.5867e-03, PNorm = 65.6924, GNorm = 0.6363, lr_0 = 9.0009e-04
Loss = 3.9750e-03, PNorm = 65.7771, GNorm = 2.2907, lr_0 = 8.7096e-04
Loss = 4.1127e-03, PNorm = 65.8462, GNorm = 1.4758, lr_0 = 8.4278e-04
Validation rmse = 0.932015
Epoch 4
Loss = 4.5483e-03, PNorm = 65.9175, GNorm = 2.9889, lr_0 = 8.1551e-04
Loss = 4.8438e-03, PNorm = 65.9850, GNorm = 3.4584, lr_0 = 7.8912e-04
Validation rmse = 0.850569
Epoch 5
Loss = 2.9846e-03, PNorm = 66.0414, GNorm = 0.5056, lr_0 = 7.6358e-04
Loss = 3.9337e-03, PNorm = 66.1013, GNorm = 1.2210, lr_0 = 7.3888e-04
Loss = 3.3103e-03, PNorm = 66.1637, GNorm = 0.8119, lr_0 = 7.1497e-04
Validation rmse = 0.794986
Epoch 6
Loss = 3.4354e-03, PNorm = 66.2133, GNorm = 2.1060, lr_0 = 6.8956e-04
Loss = 2.8438e-03, PNorm = 66.2562, GNorm = 0.8192, lr_0 = 6.6725e-04
Loss = 3.3520e-03, PNorm = 66.3019, GNorm = 0.9895, lr_0 = 6.4565e-04
Validation rmse = 0.833015
Epoch 7
Loss = 2.7703e-03, PNorm = 66.3412, GNorm = 2.8627, lr_0 = 6.2476e-04
Loss = 2.4503e-03, PNorm = 66.3803, GNorm = 1.0457, lr_0 = 6.0454e-04
Validation rmse = 0.753990
Epoch 8
Loss = 2.4150e-03, PNorm = 66.4179, GNorm = 0.5499, lr_0 = 5.8498e-04
Loss = 2.1074e-03, PNorm = 66.4503, GNorm = 0.4781, lr_0 = 5.6605e-04
Loss = 2.3975e-03, PNorm = 66.4856, GNorm = 1.6279, lr_0 = 5.4774e-04
Validation rmse = 0.747285
Epoch 9
Loss = 2.5512e-03, PNorm = 66.5240, GNorm = 0.8064, lr_0 = 5.3001e-04
Loss = 2.5535e-03, PNorm = 66.5533, GNorm = 1.8146, lr_0 = 5.1286e-04
Validation rmse = 0.767130
Epoch 10
Loss = 2.0509e-03, PNorm = 66.5813, GNorm = 2.0138, lr_0 = 4.9627e-04
Loss = 2.0216e-03, PNorm = 66.6074, GNorm = 0.4574, lr_0 = 4.8021e-04
Loss = 2.3911e-03, PNorm = 66.6444, GNorm = 2.5030, lr_0 = 4.6467e-04
Validation rmse = 0.713444
Epoch 11
Loss = 1.9430e-03, PNorm = 66.6680, GNorm = 1.9741, lr_0 = 4.4963e-04
Loss = 1.9258e-03, PNorm = 66.6975, GNorm = 1.0027, lr_0 = 4.3508e-04
Validation rmse = 0.710441
Epoch 12
Loss = 1.1383e-03, PNorm = 66.7219, GNorm = 0.8586, lr_0 = 4.1962e-04
Loss = 1.9216e-03, PNorm = 66.7417, GNorm = 2.4567, lr_0 = 4.0604e-04
Loss = 1.5273e-03, PNorm = 66.7662, GNorm = 0.4949, lr_0 = 3.9290e-04
Validation rmse = 0.693466
Epoch 13
Loss = 1.5605e-03, PNorm = 66.7902, GNorm = 0.5810, lr_0 = 3.8019e-04
Loss = 1.7026e-03, PNorm = 66.8141, GNorm = 4.0466, lr_0 = 3.6789e-04
Loss = 2.3749e-03, PNorm = 66.8385, GNorm = 2.3742, lr_0 = 3.5598e-04
Validation rmse = 0.777321
Epoch 14
Loss = 1.6872e-03, PNorm = 66.8585, GNorm = 0.3925, lr_0 = 3.4446e-04
Loss = 1.6636e-03, PNorm = 66.8823, GNorm = 0.9490, lr_0 = 3.3332e-04
Validation rmse = 0.809027
Epoch 15
Loss = 1.9087e-03, PNorm = 66.8978, GNorm = 0.5084, lr_0 = 3.2253e-04
Loss = 1.4348e-03, PNorm = 66.9121, GNorm = 0.3601, lr_0 = 3.1209e-04
Loss = 2.0518e-03, PNorm = 66.9328, GNorm = 2.4895, lr_0 = 3.0200e-04
Validation rmse = 0.689530
Epoch 16
Loss = 1.5589e-03, PNorm = 66.9501, GNorm = 1.7886, lr_0 = 2.9222e-04
Loss = 1.4906e-03, PNorm = 66.9675, GNorm = 0.9276, lr_0 = 2.8277e-04
Validation rmse = 0.681771
Epoch 17
Loss = 1.3246e-03, PNorm = 66.9875, GNorm = 2.9224, lr_0 = 2.7272e-04
Loss = 1.2234e-03, PNorm = 67.0049, GNorm = 0.4079, lr_0 = 2.6389e-04
Loss = 1.4696e-03, PNorm = 67.0210, GNorm = 2.3767, lr_0 = 2.5535e-04
Validation rmse = 0.693565
Epoch 18
Loss = 1.4126e-03, PNorm = 67.0341, GNorm = 0.5941, lr_0 = 2.4709e-04
Loss = 1.4030e-03, PNorm = 67.0494, GNorm = 0.7324, lr_0 = 2.3910e-04
Loss = 1.2949e-03, PNorm = 67.0605, GNorm = 0.7997, lr_0 = 2.3136e-04
Validation rmse = 0.678694
Epoch 19
Loss = 1.4565e-03, PNorm = 67.0738, GNorm = 1.2867, lr_0 = 2.2387e-04
Loss = 1.2549e-03, PNorm = 67.0852, GNorm = 1.0318, lr_0 = 2.1663e-04
Validation rmse = 0.687870
Epoch 20
Loss = 1.2730e-03, PNorm = 67.0983, GNorm = 1.7215, lr_0 = 2.0962e-04
Loss = 1.0673e-03, PNorm = 67.1119, GNorm = 0.5489, lr_0 = 2.0283e-04
Loss = 1.1267e-03, PNorm = 67.1215, GNorm = 0.3839, lr_0 = 1.9627e-04
Validation rmse = 0.685645
Epoch 21
Loss = 1.1408e-03, PNorm = 67.1308, GNorm = 0.6117, lr_0 = 1.8992e-04
Loss = 1.2250e-03, PNorm = 67.1419, GNorm = 1.4318, lr_0 = 1.8377e-04
Validation rmse = 0.687594
Epoch 22
Loss = 9.2477e-04, PNorm = 67.1522, GNorm = 1.3175, lr_0 = 1.7783e-04
Loss = 1.2773e-03, PNorm = 67.1643, GNorm = 0.4859, lr_0 = 1.7207e-04
Loss = 1.1167e-03, PNorm = 67.1750, GNorm = 0.4758, lr_0 = 1.6651e-04
Validation rmse = 0.668568
Epoch 23
Loss = 1.0902e-03, PNorm = 67.1864, GNorm = 0.5728, lr_0 = 1.6059e-04
Loss = 1.1267e-03, PNorm = 67.1943, GNorm = 1.0911, lr_0 = 1.5539e-04
Validation rmse = 0.681236
Epoch 24
Loss = 1.3298e-03, PNorm = 67.2022, GNorm = 1.2654, lr_0 = 1.5036e-04
Loss = 1.0128e-03, PNorm = 67.2115, GNorm = 0.5051, lr_0 = 1.4550e-04
Loss = 1.0012e-03, PNorm = 67.2200, GNorm = 2.1921, lr_0 = 1.4079e-04
Validation rmse = 0.666671
Epoch 25
Loss = 1.1492e-03, PNorm = 67.2276, GNorm = 2.6841, lr_0 = 1.3623e-04
Loss = 1.0807e-03, PNorm = 67.2377, GNorm = 0.6869, lr_0 = 1.3183e-04
Loss = 9.9536e-04, PNorm = 67.2449, GNorm = 0.8826, lr_0 = 1.2756e-04
Validation rmse = 0.670339
Epoch 26
Loss = 8.9941e-04, PNorm = 67.2540, GNorm = 1.5972, lr_0 = 1.2343e-04
Loss = 9.7494e-04, PNorm = 67.2600, GNorm = 0.3421, lr_0 = 1.1944e-04
Validation rmse = 0.671198
Epoch 27
Loss = 1.0714e-03, PNorm = 67.2671, GNorm = 0.5589, lr_0 = 1.1557e-04
Loss = 1.0581e-03, PNorm = 67.2750, GNorm = 0.5340, lr_0 = 1.1183e-04
Loss = 8.7450e-04, PNorm = 67.2821, GNorm = 1.0540, lr_0 = 1.0821e-04
Validation rmse = 0.685640
Epoch 28
Loss = 9.2248e-04, PNorm = 67.2883, GNorm = 0.4323, lr_0 = 1.0437e-04
Loss = 9.8887e-04, PNorm = 67.2934, GNorm = 0.8308, lr_0 = 1.0099e-04
Validation rmse = 0.674639
Epoch 29
Loss = 1.1448e-03, PNorm = 67.2997, GNorm = 0.7643, lr_0 = 1.0000e-04
Loss = 9.2694e-04, PNorm = 67.3061, GNorm = 1.6634, lr_0 = 1.0000e-04
Loss = 8.0804e-04, PNorm = 67.3111, GNorm = 0.3413, lr_0 = 1.0000e-04
Validation rmse = 0.673485
Model 0 best validation rmse = 0.666671 on epoch 24
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.684674
Ensemble test rmse = 0.684674
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.8275e-02, PNorm = 65.0269, GNorm = 5.2131, lr_0 = 2.9800e-04
Loss = 1.0732e-02, PNorm = 65.0771, GNorm = 4.1674, lr_0 = 4.7800e-04
Validation rmse = 1.542571
Epoch 1
Loss = 1.1245e-02, PNorm = 65.1486, GNorm = 6.1713, lr_0 = 6.7600e-04
Loss = 9.6703e-03, PNorm = 65.2465, GNorm = 1.3734, lr_0 = 8.5600e-04
Loss = 7.5293e-03, PNorm = 65.3648, GNorm = 2.7308, lr_0 = 9.9344e-04
Validation rmse = 1.475447
Epoch 2
Loss = 8.3763e-03, PNorm = 65.4846, GNorm = 1.4227, lr_0 = 9.6130e-04
Loss = 5.2440e-03, PNorm = 65.5908, GNorm = 1.3840, lr_0 = 9.3019e-04
Validation rmse = 1.096334
Epoch 3
Loss = 4.3594e-03, PNorm = 65.6768, GNorm = 1.7271, lr_0 = 9.0009e-04
Loss = 4.4483e-03, PNorm = 65.7686, GNorm = 2.0379, lr_0 = 8.7096e-04
Loss = 5.1717e-03, PNorm = 65.8443, GNorm = 3.6703, lr_0 = 8.4278e-04
Validation rmse = 0.983074
Epoch 4
Loss = 4.0526e-03, PNorm = 65.9036, GNorm = 4.7379, lr_0 = 8.1551e-04
Loss = 4.0432e-03, PNorm = 65.9680, GNorm = 1.8494, lr_0 = 7.8912e-04
Validation rmse = 0.974214
Epoch 5
Loss = 3.9294e-03, PNorm = 66.0210, GNorm = 2.4351, lr_0 = 7.6358e-04
Loss = 2.8188e-03, PNorm = 66.0697, GNorm = 0.7499, lr_0 = 7.3888e-04
Loss = 3.3568e-03, PNorm = 66.1137, GNorm = 2.0377, lr_0 = 7.1497e-04
Validation rmse = 0.923683
Epoch 6
Loss = 3.0706e-03, PNorm = 66.1667, GNorm = 1.9067, lr_0 = 6.8956e-04
Loss = 3.2555e-03, PNorm = 66.2086, GNorm = 0.9756, lr_0 = 6.6725e-04
Loss = 3.0367e-03, PNorm = 66.2461, GNorm = 2.9169, lr_0 = 6.4565e-04
Validation rmse = 1.004690
Epoch 7
Loss = 2.8201e-03, PNorm = 66.2846, GNorm = 2.6495, lr_0 = 6.2476e-04
Loss = 3.1025e-03, PNorm = 66.3205, GNorm = 1.4690, lr_0 = 6.0454e-04
Validation rmse = 0.785530
Epoch 8
Loss = 2.1563e-03, PNorm = 66.3553, GNorm = 1.4120, lr_0 = 5.8498e-04
Loss = 2.3439e-03, PNorm = 66.3915, GNorm = 2.4422, lr_0 = 5.6605e-04
Loss = 2.0591e-03, PNorm = 66.4261, GNorm = 1.1908, lr_0 = 5.4774e-04
Validation rmse = 0.755332
Epoch 9
Loss = 1.9795e-03, PNorm = 66.4527, GNorm = 0.5754, lr_0 = 5.3001e-04
Loss = 2.1336e-03, PNorm = 66.4851, GNorm = 1.3117, lr_0 = 5.1286e-04
Validation rmse = 0.747283
Epoch 10
Loss = 1.1999e-03, PNorm = 66.5134, GNorm = 1.2370, lr_0 = 4.9627e-04
Loss = 1.7640e-03, PNorm = 66.5401, GNorm = 0.6456, lr_0 = 4.8021e-04
Loss = 2.0568e-03, PNorm = 66.5695, GNorm = 1.6428, lr_0 = 4.6467e-04
Validation rmse = 0.713742
Epoch 11
Loss = 1.4930e-03, PNorm = 66.5911, GNorm = 0.5479, lr_0 = 4.4963e-04
Loss = 2.0810e-03, PNorm = 66.6153, GNorm = 1.9820, lr_0 = 4.3508e-04
Validation rmse = 0.710204
Epoch 12
Loss = 2.0242e-03, PNorm = 66.6401, GNorm = 1.0382, lr_0 = 4.1962e-04
Loss = 1.8704e-03, PNorm = 66.6604, GNorm = 1.8438, lr_0 = 4.0604e-04
Loss = 1.6290e-03, PNorm = 66.6851, GNorm = 1.2004, lr_0 = 3.9290e-04
Validation rmse = 0.731340
Epoch 13
Loss = 1.9873e-03, PNorm = 66.7077, GNorm = 0.7609, lr_0 = 3.8019e-04
Loss = 1.8599e-03, PNorm = 66.7254, GNorm = 0.5523, lr_0 = 3.6789e-04
Loss = 1.7456e-03, PNorm = 66.7475, GNorm = 1.9766, lr_0 = 3.5598e-04
Validation rmse = 0.739560
Epoch 14
Loss = 1.7288e-03, PNorm = 66.7697, GNorm = 2.1312, lr_0 = 3.4446e-04
Loss = 1.5819e-03, PNorm = 66.7902, GNorm = 1.8240, lr_0 = 3.3332e-04
Validation rmse = 0.710901
Epoch 15
Loss = 1.3416e-03, PNorm = 66.8085, GNorm = 0.8349, lr_0 = 3.2253e-04
Loss = 1.6541e-03, PNorm = 66.8270, GNorm = 1.2409, lr_0 = 3.1209e-04
Loss = 1.6352e-03, PNorm = 66.8446, GNorm = 0.3699, lr_0 = 3.0200e-04
Validation rmse = 0.677421
Epoch 16
Loss = 1.5405e-03, PNorm = 66.8620, GNorm = 0.8059, lr_0 = 2.9222e-04
Loss = 1.4821e-03, PNorm = 66.8797, GNorm = 0.6991, lr_0 = 2.8277e-04
Validation rmse = 0.692230
Epoch 17
Loss = 1.3635e-03, PNorm = 66.8975, GNorm = 0.4470, lr_0 = 2.7272e-04
Loss = 1.2474e-03, PNorm = 66.9107, GNorm = 1.7891, lr_0 = 2.6389e-04
Loss = 1.3396e-03, PNorm = 66.9259, GNorm = 0.6417, lr_0 = 2.5535e-04
Validation rmse = 0.670200
Epoch 18
Loss = 1.2082e-03, PNorm = 66.9406, GNorm = 2.6807, lr_0 = 2.4709e-04
Loss = 1.5647e-03, PNorm = 66.9541, GNorm = 1.8734, lr_0 = 2.3910e-04
Loss = 1.2017e-03, PNorm = 66.9708, GNorm = 1.1759, lr_0 = 2.3136e-04
Validation rmse = 0.675350
Epoch 19
Loss = 1.3644e-03, PNorm = 66.9821, GNorm = 1.0738, lr_0 = 2.2387e-04
Loss = 1.1474e-03, PNorm = 66.9949, GNorm = 0.6435, lr_0 = 2.1663e-04
Validation rmse = 0.650204
Epoch 20
Loss = 1.2205e-03, PNorm = 67.0092, GNorm = 0.6427, lr_0 = 2.0962e-04
Loss = 1.3829e-03, PNorm = 67.0230, GNorm = 0.6032, lr_0 = 2.0283e-04
Loss = 1.4572e-03, PNorm = 67.0349, GNorm = 0.9503, lr_0 = 1.9627e-04
Validation rmse = 0.654731
Epoch 21
Loss = 1.2281e-03, PNorm = 67.0480, GNorm = 1.3159, lr_0 = 1.8992e-04
Loss = 1.4346e-03, PNorm = 67.0590, GNorm = 1.6224, lr_0 = 1.8377e-04
Validation rmse = 0.665747
Epoch 22
Loss = 1.5599e-03, PNorm = 67.0712, GNorm = 1.8457, lr_0 = 1.7783e-04
Loss = 1.1889e-03, PNorm = 67.0831, GNorm = 1.6243, lr_0 = 1.7207e-04
Loss = 9.5970e-04, PNorm = 67.0919, GNorm = 0.6567, lr_0 = 1.6651e-04
Validation rmse = 0.643351
Epoch 23
Loss = 1.1671e-03, PNorm = 67.1015, GNorm = 0.7160, lr_0 = 1.6059e-04
Loss = 9.6758e-04, PNorm = 67.1100, GNorm = 0.9612, lr_0 = 1.5539e-04
Validation rmse = 0.656331
Epoch 24
Loss = 9.9499e-04, PNorm = 67.1193, GNorm = 1.1104, lr_0 = 1.5036e-04
Loss = 9.4283e-04, PNorm = 67.1299, GNorm = 0.9243, lr_0 = 1.4550e-04
Loss = 9.7429e-04, PNorm = 67.1384, GNorm = 0.4503, lr_0 = 1.4079e-04
Validation rmse = 0.646738
Epoch 25
Loss = 1.0798e-03, PNorm = 67.1454, GNorm = 0.8353, lr_0 = 1.3623e-04
Loss = 1.0843e-03, PNorm = 67.1520, GNorm = 1.9011, lr_0 = 1.3183e-04
Loss = 1.2059e-03, PNorm = 67.1600, GNorm = 1.7418, lr_0 = 1.2756e-04
Validation rmse = 0.675603
Epoch 26
Loss = 1.1097e-03, PNorm = 67.1677, GNorm = 1.4942, lr_0 = 1.2343e-04
Loss = 1.0078e-03, PNorm = 67.1751, GNorm = 0.4871, lr_0 = 1.1944e-04
Validation rmse = 0.639127
Epoch 27
Loss = 7.9876e-04, PNorm = 67.1829, GNorm = 0.4506, lr_0 = 1.1557e-04
Loss = 9.7079e-04, PNorm = 67.1912, GNorm = 0.6521, lr_0 = 1.1183e-04
Loss = 9.3852e-04, PNorm = 67.1973, GNorm = 1.6392, lr_0 = 1.0821e-04
Validation rmse = 0.648134
Epoch 28
Loss = 9.0918e-04, PNorm = 67.2046, GNorm = 0.6375, lr_0 = 1.0437e-04
Loss = 1.0281e-03, PNorm = 67.2105, GNorm = 1.2755, lr_0 = 1.0099e-04
Validation rmse = 0.639689
Epoch 29
Loss = 6.3541e-04, PNorm = 67.2176, GNorm = 0.3976, lr_0 = 1.0000e-04
Loss = 8.1820e-04, PNorm = 67.2233, GNorm = 0.4154, lr_0 = 1.0000e-04
Loss = 9.7073e-04, PNorm = 67.2292, GNorm = 0.5820, lr_0 = 1.0000e-04
Validation rmse = 0.647544
Model 0 best validation rmse = 0.639127 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.840444
Ensemble test rmse = 0.840444
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.7623e-02, PNorm = 65.0290, GNorm = 6.6415, lr_0 = 2.9800e-04
Loss = 1.1582e-02, PNorm = 65.0787, GNorm = 10.5360, lr_0 = 4.7800e-04
Validation rmse = 1.569156
Epoch 1
Loss = 8.6460e-03, PNorm = 65.1452, GNorm = 2.5995, lr_0 = 6.7600e-04
Loss = 7.8664e-03, PNorm = 65.2317, GNorm = 5.6299, lr_0 = 8.5600e-04
Loss = 8.1830e-03, PNorm = 65.3394, GNorm = 5.1843, lr_0 = 9.9344e-04
Validation rmse = 1.552947
Epoch 2
Loss = 6.5675e-03, PNorm = 65.4630, GNorm = 2.1000, lr_0 = 9.6130e-04
Loss = 6.4064e-03, PNorm = 65.5593, GNorm = 2.7493, lr_0 = 9.3019e-04
Validation rmse = 1.248757
Epoch 3
Loss = 5.1380e-03, PNorm = 65.6563, GNorm = 2.6367, lr_0 = 9.0009e-04
Loss = 4.6834e-03, PNorm = 65.7282, GNorm = 4.7839, lr_0 = 8.7096e-04
Loss = 3.4723e-03, PNorm = 65.8023, GNorm = 0.9024, lr_0 = 8.4278e-04
Validation rmse = 0.983107
Epoch 4
Loss = 3.1378e-03, PNorm = 65.8613, GNorm = 1.2793, lr_0 = 8.1551e-04
Loss = 3.1192e-03, PNorm = 65.9102, GNorm = 3.8565, lr_0 = 7.8912e-04
Validation rmse = 0.916576
Epoch 5
Loss = 3.0459e-03, PNorm = 65.9622, GNorm = 1.3477, lr_0 = 7.6358e-04
Loss = 3.6180e-03, PNorm = 66.0111, GNorm = 0.9983, lr_0 = 7.3888e-04
Loss = 5.2841e-03, PNorm = 66.0628, GNorm = 3.6943, lr_0 = 7.1497e-04
Validation rmse = 1.170657
Epoch 6
Loss = 2.9173e-03, PNorm = 66.1264, GNorm = 0.8352, lr_0 = 6.8956e-04
Loss = 3.9046e-03, PNorm = 66.1742, GNorm = 1.2286, lr_0 = 6.6725e-04
Loss = 3.0786e-03, PNorm = 66.2239, GNorm = 4.4752, lr_0 = 6.4565e-04
Validation rmse = 0.959265
Epoch 7
Loss = 2.6733e-03, PNorm = 66.2663, GNorm = 0.6286, lr_0 = 6.2476e-04
Loss = 2.7306e-03, PNorm = 66.3045, GNorm = 3.8648, lr_0 = 6.0454e-04
Validation rmse = 1.011331
Epoch 8
Loss = 3.1930e-03, PNorm = 66.3368, GNorm = 4.8623, lr_0 = 5.8498e-04
Loss = 2.5304e-03, PNorm = 66.3765, GNorm = 1.8722, lr_0 = 5.6605e-04
Loss = 2.2589e-03, PNorm = 66.4083, GNorm = 1.0475, lr_0 = 5.4774e-04
Validation rmse = 0.803213
Epoch 9
Loss = 2.1716e-03, PNorm = 66.4390, GNorm = 2.6884, lr_0 = 5.3001e-04
Loss = 2.2047e-03, PNorm = 66.4700, GNorm = 0.6864, lr_0 = 5.1286e-04
Validation rmse = 0.785835
Epoch 10
Loss = 1.5394e-03, PNorm = 66.4979, GNorm = 0.3593, lr_0 = 4.9627e-04
Loss = 1.9999e-03, PNorm = 66.5274, GNorm = 1.2352, lr_0 = 4.8021e-04
Loss = 1.7960e-03, PNorm = 66.5567, GNorm = 2.4362, lr_0 = 4.6467e-04
Validation rmse = 0.827845
Epoch 11
Loss = 2.0436e-03, PNorm = 66.5768, GNorm = 5.1576, lr_0 = 4.4963e-04
Loss = 3.3819e-03, PNorm = 66.6089, GNorm = 2.4693, lr_0 = 4.3508e-04
Validation rmse = 0.880064
Epoch 12
Loss = 1.7229e-03, PNorm = 66.6458, GNorm = 0.7930, lr_0 = 4.1962e-04
Loss = 1.8548e-03, PNorm = 66.6743, GNorm = 0.6766, lr_0 = 4.0604e-04
Loss = 1.8311e-03, PNorm = 66.6986, GNorm = 0.4110, lr_0 = 3.9290e-04
Validation rmse = 0.791724
Epoch 13
Loss = 1.7531e-03, PNorm = 66.7206, GNorm = 2.2505, lr_0 = 3.8019e-04
Loss = 1.8914e-03, PNorm = 66.7429, GNorm = 1.0979, lr_0 = 3.6789e-04
Loss = 1.6126e-03, PNorm = 66.7646, GNorm = 1.0353, lr_0 = 3.5598e-04
Validation rmse = 0.849854
Epoch 14
Loss = 1.7578e-03, PNorm = 66.7857, GNorm = 2.3460, lr_0 = 3.4446e-04
Loss = 1.6020e-03, PNorm = 66.8052, GNorm = 1.3438, lr_0 = 3.3332e-04
Validation rmse = 0.765667
Epoch 15
Loss = 1.2965e-03, PNorm = 66.8239, GNorm = 1.6027, lr_0 = 3.2253e-04
Loss = 1.4943e-03, PNorm = 66.8406, GNorm = 1.1446, lr_0 = 3.1209e-04
Loss = 1.3268e-03, PNorm = 66.8560, GNorm = 0.9129, lr_0 = 3.0200e-04
Validation rmse = 0.779622
Epoch 16
Loss = 1.4767e-03, PNorm = 66.8758, GNorm = 0.7960, lr_0 = 2.9222e-04
Loss = 1.4885e-03, PNorm = 66.8903, GNorm = 0.5007, lr_0 = 2.8277e-04
Validation rmse = 0.781281
Epoch 17
Loss = 1.8385e-03, PNorm = 66.9089, GNorm = 1.0466, lr_0 = 2.7272e-04
Loss = 1.3781e-03, PNorm = 66.9283, GNorm = 1.5704, lr_0 = 2.6389e-04
Loss = 1.3230e-03, PNorm = 66.9457, GNorm = 0.8896, lr_0 = 2.5535e-04
Validation rmse = 0.745116
Epoch 18
Loss = 1.2222e-03, PNorm = 66.9617, GNorm = 0.7635, lr_0 = 2.4709e-04
Loss = 1.2920e-03, PNorm = 66.9737, GNorm = 1.3184, lr_0 = 2.3910e-04
Loss = 1.3597e-03, PNorm = 66.9881, GNorm = 0.6565, lr_0 = 2.3136e-04
Validation rmse = 0.784316
Epoch 19
Loss = 1.3311e-03, PNorm = 67.0000, GNorm = 0.8354, lr_0 = 2.2387e-04
Loss = 1.3742e-03, PNorm = 67.0126, GNorm = 0.5534, lr_0 = 2.1663e-04
Validation rmse = 0.756594
Epoch 20
Loss = 7.6137e-04, PNorm = 67.0272, GNorm = 0.5203, lr_0 = 2.0962e-04
Loss = 1.1738e-03, PNorm = 67.0386, GNorm = 0.5353, lr_0 = 2.0283e-04
Loss = 1.2346e-03, PNorm = 67.0481, GNorm = 1.5444, lr_0 = 1.9627e-04
Validation rmse = 0.783759
Epoch 21
Loss = 1.1328e-03, PNorm = 67.0592, GNorm = 0.7110, lr_0 = 1.8992e-04
Loss = 1.2565e-03, PNorm = 67.0709, GNorm = 2.1749, lr_0 = 1.8377e-04
Validation rmse = 0.715234
Epoch 22
Loss = 9.3589e-04, PNorm = 67.0838, GNorm = 0.5119, lr_0 = 1.7783e-04
Loss = 1.0666e-03, PNorm = 67.0907, GNorm = 1.8124, lr_0 = 1.7207e-04
Loss = 1.1949e-03, PNorm = 67.1018, GNorm = 1.1801, lr_0 = 1.6651e-04
Validation rmse = 0.726470
Epoch 23
Loss = 1.0559e-03, PNorm = 67.1148, GNorm = 0.9908, lr_0 = 1.6059e-04
Loss = 9.2366e-04, PNorm = 67.1224, GNorm = 1.4306, lr_0 = 1.5539e-04
Validation rmse = 0.739044
Epoch 24
Loss = 9.1359e-04, PNorm = 67.1308, GNorm = 0.9550, lr_0 = 1.5036e-04
Loss = 1.1267e-03, PNorm = 67.1393, GNorm = 2.3565, lr_0 = 1.4550e-04
Loss = 1.1740e-03, PNorm = 67.1507, GNorm = 0.6513, lr_0 = 1.4079e-04
Validation rmse = 0.735955
Epoch 25
Loss = 1.0807e-03, PNorm = 67.1607, GNorm = 0.6361, lr_0 = 1.3623e-04
Loss = 1.0230e-03, PNorm = 67.1706, GNorm = 1.8688, lr_0 = 1.3183e-04
Loss = 9.5679e-04, PNorm = 67.1774, GNorm = 1.6289, lr_0 = 1.2756e-04
Validation rmse = 0.723211
Epoch 26
Loss = 9.8979e-04, PNorm = 67.1844, GNorm = 1.3014, lr_0 = 1.2343e-04
Loss = 1.0819e-03, PNorm = 67.1924, GNorm = 1.6436, lr_0 = 1.1944e-04
Validation rmse = 0.726126
Epoch 27
Loss = 7.8703e-04, PNorm = 67.2019, GNorm = 0.6377, lr_0 = 1.1557e-04
Loss = 8.7192e-04, PNorm = 67.2091, GNorm = 0.4398, lr_0 = 1.1183e-04
Loss = 9.0895e-04, PNorm = 67.2155, GNorm = 0.9082, lr_0 = 1.0821e-04
Validation rmse = 0.720976
Epoch 28
Loss = 7.7932e-04, PNorm = 67.2238, GNorm = 1.1357, lr_0 = 1.0437e-04
Loss = 9.8652e-04, PNorm = 67.2309, GNorm = 0.3779, lr_0 = 1.0099e-04
Validation rmse = 0.738256
Epoch 29
Loss = 1.4638e-03, PNorm = 67.2368, GNorm = 0.4087, lr_0 = 1.0000e-04
Loss = 9.3259e-04, PNorm = 67.2440, GNorm = 1.3187, lr_0 = 1.0000e-04
Loss = 7.6066e-04, PNorm = 67.2514, GNorm = 0.6956, lr_0 = 1.0000e-04
Validation rmse = 0.719910
Model 0 best validation rmse = 0.715234 on epoch 21
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.024699
Ensemble test rmse = 1.024699
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.9294e-02, PNorm = 65.0282, GNorm = 6.2154, lr_0 = 2.9800e-04
Loss = 1.3694e-02, PNorm = 65.0740, GNorm = 3.5988, lr_0 = 4.7800e-04
Validation rmse = 1.601756
Epoch 1
Loss = 7.6483e-03, PNorm = 65.1542, GNorm = 7.4790, lr_0 = 6.7600e-04
Loss = 8.5370e-03, PNorm = 65.2452, GNorm = 8.1523, lr_0 = 8.5600e-04
Loss = 9.5355e-03, PNorm = 65.3629, GNorm = 3.2608, lr_0 = 9.9344e-04
Validation rmse = 1.444424
Epoch 2
Loss = 6.9181e-03, PNorm = 65.4968, GNorm = 5.2392, lr_0 = 9.6130e-04
Loss = 6.6981e-03, PNorm = 65.6169, GNorm = 2.8702, lr_0 = 9.3019e-04
Validation rmse = 1.288564
Epoch 3
Loss = 4.5528e-03, PNorm = 65.7193, GNorm = 4.3011, lr_0 = 9.0009e-04
Loss = 4.1694e-03, PNorm = 65.7997, GNorm = 0.8333, lr_0 = 8.7096e-04
Loss = 4.4183e-03, PNorm = 65.8714, GNorm = 2.5507, lr_0 = 8.4278e-04
Validation rmse = 1.104648
Epoch 4
Loss = 3.7615e-03, PNorm = 65.9455, GNorm = 2.0930, lr_0 = 8.1551e-04
Loss = 4.0056e-03, PNorm = 66.0042, GNorm = 7.1456, lr_0 = 7.8912e-04
Validation rmse = 1.105583
Epoch 5
Loss = 2.7957e-03, PNorm = 66.0616, GNorm = 0.6660, lr_0 = 7.6358e-04
Loss = 3.1913e-03, PNorm = 66.1141, GNorm = 1.8024, lr_0 = 7.3888e-04
Loss = 3.7245e-03, PNorm = 66.1685, GNorm = 1.5203, lr_0 = 7.1497e-04
Validation rmse = 1.047512
Epoch 6
Loss = 2.6399e-03, PNorm = 66.2367, GNorm = 1.4131, lr_0 = 6.8956e-04
Loss = 3.4570e-03, PNorm = 66.2812, GNorm = 1.3974, lr_0 = 6.6725e-04
Loss = 2.5225e-03, PNorm = 66.3241, GNorm = 2.3857, lr_0 = 6.4565e-04
Validation rmse = 0.991886
Epoch 7
Loss = 2.0513e-03, PNorm = 66.3650, GNorm = 0.6775, lr_0 = 6.2476e-04
Loss = 2.4530e-03, PNorm = 66.4028, GNorm = 2.2589, lr_0 = 6.0454e-04
Validation rmse = 1.020313
Epoch 8
Loss = 1.7677e-03, PNorm = 66.4424, GNorm = 1.7094, lr_0 = 5.8498e-04
Loss = 2.3321e-03, PNorm = 66.4799, GNorm = 5.9341, lr_0 = 5.6605e-04
Loss = 2.5956e-03, PNorm = 66.5110, GNorm = 0.4445, lr_0 = 5.4774e-04
Validation rmse = 1.020271
Epoch 9
Loss = 1.9753e-03, PNorm = 66.5422, GNorm = 2.4386, lr_0 = 5.3001e-04
Loss = 2.1366e-03, PNorm = 66.5763, GNorm = 0.7919, lr_0 = 5.1286e-04
Validation rmse = 0.972614
Epoch 10
Loss = 1.6486e-03, PNorm = 66.6134, GNorm = 1.2314, lr_0 = 4.9627e-04
Loss = 1.6359e-03, PNorm = 66.6420, GNorm = 0.9796, lr_0 = 4.8021e-04
Loss = 2.2436e-03, PNorm = 66.6725, GNorm = 1.4498, lr_0 = 4.6467e-04
Validation rmse = 0.961763
Epoch 11
Loss = 1.6862e-03, PNorm = 66.7040, GNorm = 2.3918, lr_0 = 4.4963e-04
Loss = 2.3249e-03, PNorm = 66.7380, GNorm = 2.3954, lr_0 = 4.3508e-04
Validation rmse = 1.025824
Epoch 12
Loss = 1.8485e-03, PNorm = 66.7694, GNorm = 1.4197, lr_0 = 4.1962e-04
Loss = 2.0936e-03, PNorm = 66.7976, GNorm = 2.2456, lr_0 = 4.0604e-04
Loss = 1.8056e-03, PNorm = 66.8234, GNorm = 1.3614, lr_0 = 3.9290e-04
Validation rmse = 1.054759
Epoch 13
Loss = 2.0194e-03, PNorm = 66.8472, GNorm = 4.7606, lr_0 = 3.8019e-04
Loss = 1.6195e-03, PNorm = 66.8684, GNorm = 0.9510, lr_0 = 3.6789e-04
Loss = 1.7879e-03, PNorm = 66.8927, GNorm = 2.4863, lr_0 = 3.5598e-04
Validation rmse = 0.908874
Epoch 14
Loss = 1.8879e-03, PNorm = 66.9182, GNorm = 1.4612, lr_0 = 3.4446e-04
Loss = 1.4979e-03, PNorm = 66.9412, GNorm = 1.0832, lr_0 = 3.3332e-04
Validation rmse = 0.972786
Epoch 15
Loss = 1.7580e-03, PNorm = 66.9599, GNorm = 1.2090, lr_0 = 3.2253e-04
Loss = 1.3540e-03, PNorm = 66.9785, GNorm = 0.5061, lr_0 = 3.1209e-04
Loss = 1.3811e-03, PNorm = 66.9965, GNorm = 0.7156, lr_0 = 3.0200e-04
Validation rmse = 0.931616
Epoch 16
Loss = 1.6131e-03, PNorm = 67.0117, GNorm = 1.3997, lr_0 = 2.9222e-04
Loss = 1.2938e-03, PNorm = 67.0274, GNorm = 2.1505, lr_0 = 2.8277e-04
Validation rmse = 0.906304
Epoch 17
Loss = 1.3419e-03, PNorm = 67.0466, GNorm = 1.2811, lr_0 = 2.7272e-04
Loss = 1.3620e-03, PNorm = 67.0654, GNorm = 0.6671, lr_0 = 2.6389e-04
Loss = 1.2169e-03, PNorm = 67.0842, GNorm = 0.8609, lr_0 = 2.5535e-04
Validation rmse = 0.901161
Epoch 18
Loss = 1.2488e-03, PNorm = 67.0970, GNorm = 0.9790, lr_0 = 2.4709e-04
Loss = 1.1637e-03, PNorm = 67.1102, GNorm = 0.4171, lr_0 = 2.3910e-04
Loss = 1.1117e-03, PNorm = 67.1228, GNorm = 0.6505, lr_0 = 2.3136e-04
Validation rmse = 0.901801
Epoch 19
Loss = 1.1242e-03, PNorm = 67.1352, GNorm = 1.5900, lr_0 = 2.2387e-04
Loss = 1.3272e-03, PNorm = 67.1493, GNorm = 0.4599, lr_0 = 2.1663e-04
Validation rmse = 0.897644
Epoch 20
Loss = 1.0146e-03, PNorm = 67.1623, GNorm = 0.4598, lr_0 = 2.0962e-04
Loss = 1.1462e-03, PNorm = 67.1780, GNorm = 1.2915, lr_0 = 2.0283e-04
Loss = 1.0420e-03, PNorm = 67.1885, GNorm = 0.5283, lr_0 = 1.9627e-04
Validation rmse = 0.919138
Epoch 21
Loss = 1.1744e-03, PNorm = 67.2010, GNorm = 1.4603, lr_0 = 1.8992e-04
Loss = 1.0355e-03, PNorm = 67.2107, GNorm = 0.8598, lr_0 = 1.8377e-04
Validation rmse = 0.887573
Epoch 22
Loss = 1.0410e-03, PNorm = 67.2228, GNorm = 0.8724, lr_0 = 1.7783e-04
Loss = 7.9350e-04, PNorm = 67.2324, GNorm = 1.4521, lr_0 = 1.7207e-04
Loss = 1.2471e-03, PNorm = 67.2414, GNorm = 0.8872, lr_0 = 1.6651e-04
Validation rmse = 0.957428
Epoch 23
Loss = 1.0125e-03, PNorm = 67.2544, GNorm = 0.4999, lr_0 = 1.6059e-04
Loss = 9.9702e-04, PNorm = 67.2654, GNorm = 0.5968, lr_0 = 1.5539e-04
Validation rmse = 0.854541
Epoch 24
Loss = 9.7461e-04, PNorm = 67.2732, GNorm = 1.2367, lr_0 = 1.5036e-04
Loss = 1.1435e-03, PNorm = 67.2845, GNorm = 0.4646, lr_0 = 1.4550e-04
Loss = 9.6245e-04, PNorm = 67.2936, GNorm = 0.5156, lr_0 = 1.4079e-04
Validation rmse = 0.850493
Epoch 25
Loss = 9.4966e-04, PNorm = 67.3010, GNorm = 0.8335, lr_0 = 1.3623e-04
Loss = 9.1098e-04, PNorm = 67.3115, GNorm = 0.3876, lr_0 = 1.3183e-04
Loss = 9.3846e-04, PNorm = 67.3195, GNorm = 0.3770, lr_0 = 1.2756e-04
Validation rmse = 0.843912
Epoch 26
Loss = 9.7088e-04, PNorm = 67.3269, GNorm = 1.9282, lr_0 = 1.2343e-04
Loss = 8.3470e-04, PNorm = 67.3349, GNorm = 1.3124, lr_0 = 1.1944e-04
Validation rmse = 0.859529
Epoch 27
Loss = 7.2734e-04, PNorm = 67.3372, GNorm = 0.5618, lr_0 = 1.1557e-04
Loss = 9.5825e-04, PNorm = 67.3460, GNorm = 0.9976, lr_0 = 1.1183e-04
Loss = 8.3236e-04, PNorm = 67.3523, GNorm = 0.9155, lr_0 = 1.0821e-04
Validation rmse = 0.828696
Epoch 28
Loss = 9.7805e-04, PNorm = 67.3609, GNorm = 1.3601, lr_0 = 1.0437e-04
Loss = 7.5450e-04, PNorm = 67.3660, GNorm = 1.3932, lr_0 = 1.0099e-04
Validation rmse = 0.835779
Epoch 29
Loss = 5.3989e-04, PNorm = 67.3707, GNorm = 0.9674, lr_0 = 1.0000e-04
Loss = 9.0842e-04, PNorm = 67.3786, GNorm = 1.0946, lr_0 = 1.0000e-04
Loss = 8.3861e-04, PNorm = 67.3860, GNorm = 0.7607, lr_0 = 1.0000e-04
Validation rmse = 0.847987
Model 0 best validation rmse = 0.828696 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.676174
Ensemble test rmse = 0.676174
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.9986e-02, PNorm = 65.0242, GNorm = 6.2413, lr_0 = 2.9800e-04
Loss = 1.6050e-02, PNorm = 65.0699, GNorm = 10.0801, lr_0 = 4.7800e-04
Validation rmse = 1.966199
Epoch 1
Loss = 1.1143e-02, PNorm = 65.1558, GNorm = 6.6604, lr_0 = 6.7600e-04
Loss = 1.0962e-02, PNorm = 65.2579, GNorm = 1.7957, lr_0 = 8.5600e-04
Loss = 8.2326e-03, PNorm = 65.3795, GNorm = 2.2788, lr_0 = 9.9344e-04
Validation rmse = 1.816393
Epoch 2
Loss = 6.5032e-03, PNorm = 65.5015, GNorm = 1.2624, lr_0 = 9.6130e-04
Loss = 5.4145e-03, PNorm = 65.5940, GNorm = 1.1169, lr_0 = 9.3019e-04
Validation rmse = 1.541839
Epoch 3
Loss = 8.2268e-03, PNorm = 65.6898, GNorm = 1.3933, lr_0 = 9.0009e-04
Loss = 5.6545e-03, PNorm = 65.7939, GNorm = 1.1653, lr_0 = 8.7096e-04
Loss = 4.6223e-03, PNorm = 65.8744, GNorm = 3.9001, lr_0 = 8.4278e-04
Validation rmse = 1.257543
Epoch 4
Loss = 4.5573e-03, PNorm = 65.9448, GNorm = 4.1298, lr_0 = 8.1551e-04
Loss = 5.8161e-03, PNorm = 66.0115, GNorm = 3.0267, lr_0 = 7.8912e-04
Validation rmse = 1.124424
Epoch 5
Loss = 2.1424e-03, PNorm = 66.0717, GNorm = 0.9271, lr_0 = 7.6358e-04
Loss = 4.1223e-03, PNorm = 66.1263, GNorm = 1.6550, lr_0 = 7.3888e-04
Loss = 3.2108e-03, PNorm = 66.1782, GNorm = 0.8070, lr_0 = 7.1497e-04
Validation rmse = 1.036526
Epoch 6
Loss = 2.5451e-03, PNorm = 66.2309, GNorm = 1.0181, lr_0 = 6.8956e-04
Loss = 2.8717e-03, PNorm = 66.2714, GNorm = 4.0054, lr_0 = 6.6725e-04
Loss = 3.6001e-03, PNorm = 66.3168, GNorm = 1.3052, lr_0 = 6.4565e-04
Validation rmse = 1.243619
Epoch 7
Loss = 3.3882e-03, PNorm = 66.3669, GNorm = 2.7477, lr_0 = 6.2476e-04
Loss = 2.5623e-03, PNorm = 66.4093, GNorm = 1.9753, lr_0 = 6.0454e-04
Validation rmse = 1.082098
Epoch 8
Loss = 2.6560e-03, PNorm = 66.4467, GNorm = 3.4239, lr_0 = 5.8498e-04
Loss = 2.0917e-03, PNorm = 66.4840, GNorm = 1.4087, lr_0 = 5.6605e-04
Loss = 2.7017e-03, PNorm = 66.5174, GNorm = 1.1710, lr_0 = 5.4774e-04
Validation rmse = 1.038565
Epoch 9
Loss = 3.1997e-03, PNorm = 66.5553, GNorm = 4.7311, lr_0 = 5.3001e-04
Loss = 2.4149e-03, PNorm = 66.5959, GNorm = 0.8161, lr_0 = 5.1286e-04
Validation rmse = 1.012267
Epoch 10
Loss = 2.6109e-03, PNorm = 66.6357, GNorm = 2.3775, lr_0 = 4.9627e-04
Loss = 2.3010e-03, PNorm = 66.6733, GNorm = 1.0421, lr_0 = 4.8021e-04
Loss = 1.8641e-03, PNorm = 66.7069, GNorm = 0.5548, lr_0 = 4.6467e-04
Validation rmse = 1.031239
Epoch 11
Loss = 2.0775e-03, PNorm = 66.7323, GNorm = 2.7430, lr_0 = 4.4963e-04
Loss = 1.6653e-03, PNorm = 66.7579, GNorm = 0.5268, lr_0 = 4.3508e-04
Validation rmse = 0.981613
Epoch 12
Loss = 1.3914e-03, PNorm = 66.7877, GNorm = 0.4698, lr_0 = 4.1962e-04
Loss = 1.4435e-03, PNorm = 66.8108, GNorm = 0.4913, lr_0 = 4.0604e-04
Loss = 1.6215e-03, PNorm = 66.8305, GNorm = 0.6674, lr_0 = 3.9290e-04
Validation rmse = 0.961977
Epoch 13
Loss = 1.6190e-03, PNorm = 66.8544, GNorm = 1.1538, lr_0 = 3.8019e-04
Loss = 1.6304e-03, PNorm = 66.8730, GNorm = 0.7642, lr_0 = 3.6789e-04
Loss = 1.6343e-03, PNorm = 66.8939, GNorm = 0.9254, lr_0 = 3.5598e-04
Validation rmse = 0.971845
Epoch 14
Loss = 1.6495e-03, PNorm = 66.9152, GNorm = 0.4973, lr_0 = 3.4446e-04
Loss = 1.4224e-03, PNorm = 66.9355, GNorm = 0.7020, lr_0 = 3.3332e-04
Validation rmse = 0.991261
Epoch 15
Loss = 1.0624e-03, PNorm = 66.9595, GNorm = 0.4357, lr_0 = 3.2253e-04
Loss = 1.8086e-03, PNorm = 66.9810, GNorm = 0.4391, lr_0 = 3.1209e-04
Loss = 1.5202e-03, PNorm = 67.0022, GNorm = 1.8511, lr_0 = 3.0200e-04
Validation rmse = 1.049832
Epoch 16
Loss = 1.2789e-03, PNorm = 67.0166, GNorm = 1.7914, lr_0 = 2.9222e-04
Loss = 1.5317e-03, PNorm = 67.0383, GNorm = 0.3935, lr_0 = 2.8277e-04
Validation rmse = 0.971562
Epoch 17
Loss = 1.2062e-03, PNorm = 67.0597, GNorm = 2.0099, lr_0 = 2.7272e-04
Loss = 1.3456e-03, PNorm = 67.0743, GNorm = 0.7293, lr_0 = 2.6389e-04
Loss = 1.2119e-03, PNorm = 67.0882, GNorm = 0.4359, lr_0 = 2.5535e-04
Validation rmse = 1.011192
Epoch 18
Loss = 1.6092e-03, PNorm = 67.1027, GNorm = 2.6045, lr_0 = 2.4709e-04
Loss = 1.1898e-03, PNorm = 67.1195, GNorm = 1.7151, lr_0 = 2.3910e-04
Loss = 1.3114e-03, PNorm = 67.1337, GNorm = 0.9884, lr_0 = 2.3136e-04
Validation rmse = 0.970178
Epoch 19
Loss = 1.2242e-03, PNorm = 67.1457, GNorm = 0.4117, lr_0 = 2.2387e-04
Loss = 1.1560e-03, PNorm = 67.1578, GNorm = 1.6592, lr_0 = 2.1663e-04
Validation rmse = 0.958327
Epoch 20
Loss = 1.0231e-03, PNorm = 67.1723, GNorm = 0.3486, lr_0 = 2.0962e-04
Loss = 1.0813e-03, PNorm = 67.1858, GNorm = 0.3152, lr_0 = 2.0283e-04
Loss = 1.2398e-03, PNorm = 67.1977, GNorm = 0.7871, lr_0 = 1.9627e-04
Validation rmse = 0.950812
Epoch 21
Loss = 1.1278e-03, PNorm = 67.2090, GNorm = 0.4900, lr_0 = 1.8992e-04
Loss = 1.0494e-03, PNorm = 67.2224, GNorm = 1.1588, lr_0 = 1.8377e-04
Validation rmse = 0.940947
Epoch 22
Loss = 9.0120e-04, PNorm = 67.2307, GNorm = 0.4776, lr_0 = 1.7783e-04
Loss = 1.0857e-03, PNorm = 67.2410, GNorm = 1.2944, lr_0 = 1.7207e-04
Loss = 1.1111e-03, PNorm = 67.2508, GNorm = 1.2977, lr_0 = 1.6651e-04
Validation rmse = 0.960591
Epoch 23
Loss = 1.0364e-03, PNorm = 67.2613, GNorm = 1.9262, lr_0 = 1.6059e-04
Loss = 1.2327e-03, PNorm = 67.2703, GNorm = 0.5281, lr_0 = 1.5539e-04
Validation rmse = 0.981156
Epoch 24
Loss = 9.2773e-04, PNorm = 67.2801, GNorm = 1.1361, lr_0 = 1.5036e-04
Loss = 1.0277e-03, PNorm = 67.2884, GNorm = 1.4916, lr_0 = 1.4550e-04
Loss = 1.2131e-03, PNorm = 67.2973, GNorm = 1.8902, lr_0 = 1.4079e-04
Validation rmse = 0.942504
Epoch 25
Loss = 1.0617e-03, PNorm = 67.3041, GNorm = 0.4754, lr_0 = 1.3623e-04
Loss = 7.5931e-04, PNorm = 67.3113, GNorm = 0.4585, lr_0 = 1.3183e-04
Loss = 1.2272e-03, PNorm = 67.3186, GNorm = 0.7786, lr_0 = 1.2756e-04
Validation rmse = 0.960800
Epoch 26
Loss = 9.7056e-04, PNorm = 67.3265, GNorm = 1.0573, lr_0 = 1.2343e-04
Loss = 8.7289e-04, PNorm = 67.3344, GNorm = 0.5431, lr_0 = 1.1944e-04
Validation rmse = 0.951838
Epoch 27
Loss = 8.5797e-04, PNorm = 67.3431, GNorm = 0.4642, lr_0 = 1.1557e-04
Loss = 8.9925e-04, PNorm = 67.3507, GNorm = 0.5865, lr_0 = 1.1183e-04
Loss = 8.9000e-04, PNorm = 67.3577, GNorm = 0.5920, lr_0 = 1.0821e-04
Validation rmse = 0.965322
Epoch 28
Loss = 9.6587e-04, PNorm = 67.3632, GNorm = 0.5657, lr_0 = 1.0437e-04
Loss = 9.3858e-04, PNorm = 67.3707, GNorm = 1.2742, lr_0 = 1.0099e-04
Validation rmse = 0.949570
Epoch 29
Loss = 9.0070e-04, PNorm = 67.3767, GNorm = 0.3252, lr_0 = 1.0000e-04
Loss = 7.8611e-04, PNorm = 67.3834, GNorm = 0.5017, lr_0 = 1.0000e-04
Loss = 9.8121e-04, PNorm = 67.3902, GNorm = 0.3770, lr_0 = 1.0000e-04
Validation rmse = 0.954872
Model 0 best validation rmse = 0.940947 on epoch 21
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.763615
Ensemble test rmse = 0.763615
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.6151e-02, PNorm = 65.0303, GNorm = 10.3780, lr_0 = 2.9800e-04
Loss = 1.4231e-02, PNorm = 65.0753, GNorm = 8.3300, lr_0 = 4.7800e-04
Validation rmse = 1.567310
Epoch 1
Loss = 1.0025e-02, PNorm = 65.1579, GNorm = 6.7885, lr_0 = 6.7600e-04
Loss = 8.5267e-03, PNorm = 65.2549, GNorm = 2.9617, lr_0 = 8.5600e-04
Loss = 7.1845e-03, PNorm = 65.3780, GNorm = 4.2200, lr_0 = 9.9344e-04
Validation rmse = 1.897325
Epoch 2
Loss = 8.5283e-03, PNorm = 65.5038, GNorm = 1.3330, lr_0 = 9.6130e-04
Loss = 6.1497e-03, PNorm = 65.6312, GNorm = 2.3818, lr_0 = 9.3019e-04
Validation rmse = 1.467076
Epoch 3
Loss = 5.2395e-03, PNorm = 65.7291, GNorm = 0.9518, lr_0 = 9.0009e-04
Loss = 4.7866e-03, PNorm = 65.8102, GNorm = 3.0892, lr_0 = 8.7096e-04
Loss = 4.9520e-03, PNorm = 65.8952, GNorm = 2.7113, lr_0 = 8.4278e-04
Validation rmse = 0.914437
Epoch 4
Loss = 3.8676e-03, PNorm = 65.9746, GNorm = 1.9907, lr_0 = 8.1551e-04
Loss = 3.4474e-03, PNorm = 66.0369, GNorm = 2.5183, lr_0 = 7.8912e-04
Validation rmse = 0.919170
Epoch 5
Loss = 3.4970e-03, PNorm = 66.0926, GNorm = 2.1904, lr_0 = 7.6358e-04
Loss = 3.5168e-03, PNorm = 66.1623, GNorm = 3.4813, lr_0 = 7.3888e-04
Loss = 3.3247e-03, PNorm = 66.2146, GNorm = 2.0833, lr_0 = 7.1497e-04
Validation rmse = 0.905664
Epoch 6
Loss = 3.6528e-03, PNorm = 66.2625, GNorm = 2.6171, lr_0 = 6.8956e-04
Loss = 4.0982e-03, PNorm = 66.3096, GNorm = 0.6151, lr_0 = 6.6725e-04
Loss = 3.2029e-03, PNorm = 66.3666, GNorm = 1.0069, lr_0 = 6.4565e-04
Validation rmse = 0.775444
Epoch 7
Loss = 2.5547e-03, PNorm = 66.4208, GNorm = 2.9778, lr_0 = 6.2476e-04
Loss = 3.0976e-03, PNorm = 66.4591, GNorm = 4.4374, lr_0 = 6.0454e-04
Validation rmse = 0.982679
Epoch 8
Loss = 2.0676e-03, PNorm = 66.5080, GNorm = 0.9407, lr_0 = 5.8498e-04
Loss = 2.7374e-03, PNorm = 66.5476, GNorm = 0.9579, lr_0 = 5.6605e-04
Loss = 2.5598e-03, PNorm = 66.5884, GNorm = 1.5809, lr_0 = 5.4774e-04
Validation rmse = 0.791980
Epoch 9
Loss = 2.0676e-03, PNorm = 66.6295, GNorm = 3.2535, lr_0 = 5.3001e-04
Loss = 2.7914e-03, PNorm = 66.6666, GNorm = 1.5682, lr_0 = 5.1286e-04
Validation rmse = 0.824016
Epoch 10
Loss = 1.9946e-03, PNorm = 66.7011, GNorm = 1.9307, lr_0 = 4.9627e-04
Loss = 1.8440e-03, PNorm = 66.7386, GNorm = 0.5278, lr_0 = 4.8021e-04
Loss = 2.1753e-03, PNorm = 66.7673, GNorm = 2.0051, lr_0 = 4.6467e-04
Validation rmse = 0.825962
Epoch 11
Loss = 2.2830e-03, PNorm = 66.8019, GNorm = 2.4897, lr_0 = 4.4963e-04
Loss = 1.7211e-03, PNorm = 66.8314, GNorm = 1.7298, lr_0 = 4.3508e-04
Validation rmse = 0.730749
Epoch 12
Loss = 1.8328e-03, PNorm = 66.8604, GNorm = 1.9496, lr_0 = 4.1962e-04
Loss = 1.4888e-03, PNorm = 66.8846, GNorm = 1.1299, lr_0 = 4.0604e-04
Loss = 1.8642e-03, PNorm = 66.9084, GNorm = 1.3889, lr_0 = 3.9290e-04
Validation rmse = 0.875278
Epoch 13
Loss = 1.7375e-03, PNorm = 66.9286, GNorm = 1.0680, lr_0 = 3.8019e-04
Loss = 1.4005e-03, PNorm = 66.9490, GNorm = 0.9421, lr_0 = 3.6789e-04
Loss = 1.7887e-03, PNorm = 66.9720, GNorm = 2.1246, lr_0 = 3.5598e-04
Validation rmse = 0.708668
Epoch 14
Loss = 1.4607e-03, PNorm = 66.9939, GNorm = 0.4827, lr_0 = 3.4446e-04
Loss = 1.5259e-03, PNorm = 67.0157, GNorm = 1.7617, lr_0 = 3.3332e-04
Validation rmse = 0.814086
Epoch 15
Loss = 7.8117e-04, PNorm = 67.0394, GNorm = 0.7676, lr_0 = 3.2253e-04
Loss = 1.7794e-03, PNorm = 67.0629, GNorm = 0.5280, lr_0 = 3.1209e-04
Loss = 1.3340e-03, PNorm = 67.0819, GNorm = 0.4632, lr_0 = 3.0200e-04
Validation rmse = 0.762680
Epoch 16
Loss = 1.0003e-03, PNorm = 67.1005, GNorm = 0.6899, lr_0 = 2.9222e-04
Loss = 1.4591e-03, PNorm = 67.1182, GNorm = 2.2459, lr_0 = 2.8277e-04
Validation rmse = 0.764810
Epoch 17
Loss = 1.0057e-03, PNorm = 67.1319, GNorm = 1.4408, lr_0 = 2.7272e-04
Loss = 1.0962e-03, PNorm = 67.1443, GNorm = 0.6053, lr_0 = 2.6389e-04
Loss = 1.4191e-03, PNorm = 67.1608, GNorm = 2.4038, lr_0 = 2.5535e-04
Validation rmse = 0.718974
Epoch 18
Loss = 1.1611e-03, PNorm = 67.1755, GNorm = 0.5749, lr_0 = 2.4709e-04
Loss = 1.1347e-03, PNorm = 67.1880, GNorm = 0.4401, lr_0 = 2.3910e-04
Loss = 1.3612e-03, PNorm = 67.1997, GNorm = 2.9528, lr_0 = 2.3136e-04
Validation rmse = 0.747504
Epoch 19
Loss = 1.2609e-03, PNorm = 67.2132, GNorm = 0.8033, lr_0 = 2.2387e-04
Loss = 1.3034e-03, PNorm = 67.2271, GNorm = 0.8471, lr_0 = 2.1663e-04
Validation rmse = 0.707841
Epoch 20
Loss = 1.3984e-03, PNorm = 67.2390, GNorm = 1.1324, lr_0 = 2.0962e-04
Loss = 1.1888e-03, PNorm = 67.2524, GNorm = 2.9698, lr_0 = 2.0283e-04
Loss = 1.1484e-03, PNorm = 67.2660, GNorm = 1.2892, lr_0 = 1.9627e-04
Validation rmse = 0.705714
Epoch 21
Loss = 1.2464e-03, PNorm = 67.2817, GNorm = 1.5477, lr_0 = 1.8992e-04
Loss = 1.0371e-03, PNorm = 67.2927, GNorm = 0.6224, lr_0 = 1.8377e-04
Validation rmse = 0.706626
Epoch 22
Loss = 1.0589e-03, PNorm = 67.3022, GNorm = 0.5830, lr_0 = 1.7783e-04
Loss = 9.5423e-04, PNorm = 67.3116, GNorm = 1.3726, lr_0 = 1.7207e-04
Loss = 1.0415e-03, PNorm = 67.3205, GNorm = 0.9803, lr_0 = 1.6651e-04
Validation rmse = 0.802468
Epoch 23
Loss = 8.6928e-04, PNorm = 67.3320, GNorm = 0.4546, lr_0 = 1.6059e-04
Loss = 9.9866e-04, PNorm = 67.3418, GNorm = 0.4687, lr_0 = 1.5539e-04
Validation rmse = 0.808550
Epoch 24
Loss = 6.0386e-04, PNorm = 67.3490, GNorm = 0.4962, lr_0 = 1.5036e-04
Loss = 1.0275e-03, PNorm = 67.3568, GNorm = 0.6454, lr_0 = 1.4550e-04
Loss = 1.0038e-03, PNorm = 67.3630, GNorm = 0.6167, lr_0 = 1.4079e-04
Validation rmse = 0.748876
Epoch 25
Loss = 7.2675e-04, PNorm = 67.3713, GNorm = 1.1519, lr_0 = 1.3623e-04
Loss = 8.9623e-04, PNorm = 67.3808, GNorm = 0.9356, lr_0 = 1.3183e-04
Loss = 1.0438e-03, PNorm = 67.3884, GNorm = 0.5570, lr_0 = 1.2756e-04
Validation rmse = 0.723510
Epoch 26
Loss = 8.1205e-04, PNorm = 67.3942, GNorm = 0.6717, lr_0 = 1.2343e-04
Loss = 8.7126e-04, PNorm = 67.4023, GNorm = 0.6704, lr_0 = 1.1944e-04
Validation rmse = 0.702566
Epoch 27
Loss = 6.9035e-04, PNorm = 67.4088, GNorm = 0.4328, lr_0 = 1.1557e-04
Loss = 9.6459e-04, PNorm = 67.4167, GNorm = 1.1651, lr_0 = 1.1183e-04
Loss = 9.5326e-04, PNorm = 67.4225, GNorm = 0.6941, lr_0 = 1.0821e-04
Validation rmse = 0.742808
Epoch 28
Loss = 8.6205e-04, PNorm = 67.4282, GNorm = 0.8518, lr_0 = 1.0437e-04
Loss = 7.9129e-04, PNorm = 67.4334, GNorm = 0.5142, lr_0 = 1.0099e-04
Validation rmse = 0.717520
Epoch 29
Loss = 6.8547e-04, PNorm = 67.4398, GNorm = 0.5840, lr_0 = 1.0000e-04
Loss = 8.8457e-04, PNorm = 67.4448, GNorm = 1.4218, lr_0 = 1.0000e-04
Loss = 9.2243e-04, PNorm = 67.4501, GNorm = 0.9518, lr_0 = 1.0000e-04
Validation rmse = 0.739837
Model 0 best validation rmse = 0.702566 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.708465
Ensemble test rmse = 0.708465
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.8859e-02, PNorm = 65.0271, GNorm = 8.1681, lr_0 = 2.9800e-04
Loss = 1.3749e-02, PNorm = 65.0667, GNorm = 2.8101, lr_0 = 4.7800e-04
Validation rmse = 1.897872
Epoch 1
Loss = 1.0667e-02, PNorm = 65.1474, GNorm = 1.8272, lr_0 = 6.7600e-04
Loss = 7.1173e-03, PNorm = 65.2396, GNorm = 2.1867, lr_0 = 8.5600e-04
Loss = 6.7011e-03, PNorm = 65.3402, GNorm = 4.3922, lr_0 = 9.9344e-04
Validation rmse = 1.437890
Epoch 2
Loss = 6.5002e-03, PNorm = 65.4542, GNorm = 5.5623, lr_0 = 9.6130e-04
Loss = 5.2129e-03, PNorm = 65.5608, GNorm = 6.1507, lr_0 = 9.3019e-04
Validation rmse = 1.304565
Epoch 3
Loss = 4.7088e-03, PNorm = 65.6504, GNorm = 3.3994, lr_0 = 9.0009e-04
Loss = 5.0665e-03, PNorm = 65.7289, GNorm = 2.0474, lr_0 = 8.7096e-04
Loss = 4.1680e-03, PNorm = 65.8018, GNorm = 3.8505, lr_0 = 8.4278e-04
Validation rmse = 1.083480
Epoch 4
Loss = 4.7281e-03, PNorm = 65.8583, GNorm = 5.9031, lr_0 = 8.1551e-04
Loss = 4.1956e-03, PNorm = 65.9228, GNorm = 1.9738, lr_0 = 7.8912e-04
Validation rmse = 1.087870
Epoch 5
Loss = 1.9999e-03, PNorm = 65.9670, GNorm = 0.7166, lr_0 = 7.6358e-04
Loss = 2.7630e-03, PNorm = 66.0052, GNorm = 1.8723, lr_0 = 7.3888e-04
Loss = 3.4441e-03, PNorm = 66.0434, GNorm = 2.4032, lr_0 = 7.1497e-04
Validation rmse = 1.242704
Epoch 6
Loss = 3.1702e-03, PNorm = 66.0892, GNorm = 0.5427, lr_0 = 6.8956e-04
Loss = 3.1190e-03, PNorm = 66.1379, GNorm = 2.0970, lr_0 = 6.6725e-04
Loss = 3.4733e-03, PNorm = 66.1733, GNorm = 1.7515, lr_0 = 6.4565e-04
Validation rmse = 0.977181
Epoch 7
Loss = 2.6492e-03, PNorm = 66.2117, GNorm = 1.2823, lr_0 = 6.2476e-04
Loss = 2.5827e-03, PNorm = 66.2483, GNorm = 2.5098, lr_0 = 6.0454e-04
Validation rmse = 0.987611
Epoch 8
Loss = 2.3838e-03, PNorm = 66.2778, GNorm = 1.2902, lr_0 = 5.8498e-04
Loss = 2.2076e-03, PNorm = 66.3104, GNorm = 1.0282, lr_0 = 5.6605e-04
Loss = 2.0593e-03, PNorm = 66.3414, GNorm = 0.6801, lr_0 = 5.4774e-04
Validation rmse = 1.014147
Epoch 9
Loss = 2.1724e-03, PNorm = 66.3663, GNorm = 1.8073, lr_0 = 5.3001e-04
Loss = 2.0347e-03, PNorm = 66.3992, GNorm = 0.7229, lr_0 = 5.1286e-04
Validation rmse = 0.961665
Epoch 10
Loss = 2.1267e-03, PNorm = 66.4255, GNorm = 2.7775, lr_0 = 4.9627e-04
Loss = 2.8501e-03, PNorm = 66.4512, GNorm = 3.4563, lr_0 = 4.8021e-04
Loss = 2.7218e-03, PNorm = 66.4790, GNorm = 2.5008, lr_0 = 4.6467e-04
Validation rmse = 1.013809
Epoch 11
Loss = 2.3233e-03, PNorm = 66.5105, GNorm = 2.5615, lr_0 = 4.4963e-04
Loss = 1.8377e-03, PNorm = 66.5379, GNorm = 2.1124, lr_0 = 4.3508e-04
Validation rmse = 0.953014
Epoch 12
Loss = 1.6407e-03, PNorm = 66.5644, GNorm = 0.8926, lr_0 = 4.1962e-04
Loss = 1.8811e-03, PNorm = 66.5837, GNorm = 3.0294, lr_0 = 4.0604e-04
Loss = 1.8630e-03, PNorm = 66.6080, GNorm = 3.2789, lr_0 = 3.9290e-04
Validation rmse = 0.951958
Epoch 13
Loss = 1.8081e-03, PNorm = 66.6274, GNorm = 1.1713, lr_0 = 3.8019e-04
Loss = 1.9718e-03, PNorm = 66.6506, GNorm = 1.7399, lr_0 = 3.6789e-04
Loss = 1.5952e-03, PNorm = 66.6707, GNorm = 1.7806, lr_0 = 3.5598e-04
Validation rmse = 0.942102
Epoch 14
Loss = 1.4209e-03, PNorm = 66.6874, GNorm = 0.7925, lr_0 = 3.4446e-04
Loss = 1.5220e-03, PNorm = 66.7065, GNorm = 1.1835, lr_0 = 3.3332e-04
Validation rmse = 0.951715
Epoch 15
Loss = 1.6593e-03, PNorm = 66.7244, GNorm = 0.7348, lr_0 = 3.2253e-04
Loss = 1.5466e-03, PNorm = 66.7432, GNorm = 1.5883, lr_0 = 3.1209e-04
Loss = 1.4279e-03, PNorm = 66.7608, GNorm = 0.5161, lr_0 = 3.0200e-04
Validation rmse = 0.959809
Epoch 16
Loss = 1.4459e-03, PNorm = 66.7735, GNorm = 1.2918, lr_0 = 2.9222e-04
Loss = 1.4480e-03, PNorm = 66.7896, GNorm = 0.7761, lr_0 = 2.8277e-04
Validation rmse = 1.000511
Epoch 17
Loss = 1.0944e-03, PNorm = 66.8078, GNorm = 1.3562, lr_0 = 2.7272e-04
Loss = 1.6352e-03, PNorm = 66.8277, GNorm = 1.2926, lr_0 = 2.6389e-04
Loss = 1.3199e-03, PNorm = 66.8427, GNorm = 1.3513, lr_0 = 2.5535e-04
Validation rmse = 0.921459
Epoch 18
Loss = 1.2578e-03, PNorm = 66.8535, GNorm = 1.1532, lr_0 = 2.4709e-04
Loss = 1.4232e-03, PNorm = 66.8649, GNorm = 0.6030, lr_0 = 2.3910e-04
Loss = 1.5694e-03, PNorm = 66.8799, GNorm = 1.2714, lr_0 = 2.3136e-04
Validation rmse = 0.951614
Epoch 19
Loss = 1.3472e-03, PNorm = 66.8969, GNorm = 1.7972, lr_0 = 2.2387e-04
Loss = 1.0867e-03, PNorm = 66.9107, GNorm = 0.9237, lr_0 = 2.1663e-04
Validation rmse = 0.952722
Epoch 20
Loss = 1.2099e-03, PNorm = 66.9190, GNorm = 0.7173, lr_0 = 2.0962e-04
Loss = 1.2406e-03, PNorm = 66.9312, GNorm = 0.6237, lr_0 = 2.0283e-04
Loss = 1.3107e-03, PNorm = 66.9429, GNorm = 2.0876, lr_0 = 1.9627e-04
Validation rmse = 0.947474
Epoch 21
Loss = 1.1163e-03, PNorm = 66.9525, GNorm = 1.1387, lr_0 = 1.8992e-04
Loss = 1.2330e-03, PNorm = 66.9619, GNorm = 0.5104, lr_0 = 1.8377e-04
Validation rmse = 0.936118
Epoch 22
Loss = 1.0947e-03, PNorm = 66.9722, GNorm = 1.1351, lr_0 = 1.7783e-04
Loss = 1.0569e-03, PNorm = 66.9828, GNorm = 1.4005, lr_0 = 1.7207e-04
Loss = 1.1968e-03, PNorm = 66.9936, GNorm = 0.4753, lr_0 = 1.6651e-04
Validation rmse = 0.936844
Epoch 23
Loss = 1.0880e-03, PNorm = 67.0031, GNorm = 0.5468, lr_0 = 1.6059e-04
Loss = 9.9417e-04, PNorm = 67.0122, GNorm = 0.4311, lr_0 = 1.5539e-04
Validation rmse = 0.948158
Epoch 24
Loss = 8.1678e-04, PNorm = 67.0223, GNorm = 0.4488, lr_0 = 1.5036e-04
Loss = 1.1510e-03, PNorm = 67.0315, GNorm = 0.9281, lr_0 = 1.4550e-04
Loss = 9.4879e-04, PNorm = 67.0387, GNorm = 0.7945, lr_0 = 1.4079e-04
Validation rmse = 0.961052
Epoch 25
Loss = 8.8838e-04, PNorm = 67.0452, GNorm = 0.5061, lr_0 = 1.3623e-04
Loss = 1.0327e-03, PNorm = 67.0534, GNorm = 1.1057, lr_0 = 1.3183e-04
Loss = 1.0701e-03, PNorm = 67.0614, GNorm = 0.7020, lr_0 = 1.2756e-04
Validation rmse = 0.957549
Epoch 26
Loss = 1.1176e-03, PNorm = 67.0697, GNorm = 0.4687, lr_0 = 1.2343e-04
Loss = 9.7015e-04, PNorm = 67.0783, GNorm = 1.6540, lr_0 = 1.1944e-04
Validation rmse = 0.949640
Epoch 27
Loss = 1.1441e-03, PNorm = 67.0858, GNorm = 1.7687, lr_0 = 1.1557e-04
Loss = 9.6935e-04, PNorm = 67.0921, GNorm = 0.8295, lr_0 = 1.1183e-04
Loss = 1.0734e-03, PNorm = 67.0979, GNorm = 1.0361, lr_0 = 1.0821e-04
Validation rmse = 0.971939
Epoch 28
Loss = 1.0634e-03, PNorm = 67.1060, GNorm = 1.3380, lr_0 = 1.0437e-04
Loss = 9.4675e-04, PNorm = 67.1117, GNorm = 0.5741, lr_0 = 1.0099e-04
Validation rmse = 0.948873
Epoch 29
Loss = 6.1155e-04, PNorm = 67.1169, GNorm = 0.6951, lr_0 = 1.0000e-04
Loss = 9.3802e-04, PNorm = 67.1223, GNorm = 0.4642, lr_0 = 1.0000e-04
Loss = 9.7675e-04, PNorm = 67.1289, GNorm = 1.9810, lr_0 = 1.0000e-04
Validation rmse = 0.987639
Model 0 best validation rmse = 0.921459 on epoch 17
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.698984
Ensemble test rmse = 0.698984
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.9493e-02, PNorm = 65.0252, GNorm = 4.1362, lr_0 = 2.9800e-04
Loss = 1.3972e-02, PNorm = 65.0734, GNorm = 3.0112, lr_0 = 4.7800e-04
Validation rmse = 1.501489
Epoch 1
Loss = 8.1544e-03, PNorm = 65.1528, GNorm = 3.6218, lr_0 = 6.7600e-04
Loss = 8.0340e-03, PNorm = 65.2472, GNorm = 3.3890, lr_0 = 8.5600e-04
Loss = 6.8062e-03, PNorm = 65.3589, GNorm = 3.3065, lr_0 = 9.9344e-04
Validation rmse = 1.267007
Epoch 2
Loss = 7.3963e-03, PNorm = 65.4745, GNorm = 6.5967, lr_0 = 9.6130e-04
Loss = 5.3241e-03, PNorm = 65.5899, GNorm = 3.4347, lr_0 = 9.3019e-04
Validation rmse = 1.110979
Epoch 3
Loss = 3.9876e-03, PNorm = 65.6861, GNorm = 2.6716, lr_0 = 9.0009e-04
Loss = 4.3689e-03, PNorm = 65.7708, GNorm = 4.7430, lr_0 = 8.7096e-04
Loss = 4.8055e-03, PNorm = 65.8490, GNorm = 2.1721, lr_0 = 8.4278e-04
Validation rmse = 1.103278
Epoch 4
Loss = 4.2816e-03, PNorm = 65.9178, GNorm = 1.4977, lr_0 = 8.1551e-04
Loss = 4.7794e-03, PNorm = 65.9869, GNorm = 2.8945, lr_0 = 7.8912e-04
Validation rmse = 1.239743
Epoch 5
Loss = 3.5007e-03, PNorm = 66.0492, GNorm = 1.5492, lr_0 = 7.6358e-04
Loss = 3.9913e-03, PNorm = 66.0987, GNorm = 1.7099, lr_0 = 7.3888e-04
Loss = 3.1305e-03, PNorm = 66.1432, GNorm = 2.9346, lr_0 = 7.1497e-04
Validation rmse = 1.031200
Epoch 6
Loss = 2.7387e-03, PNorm = 66.1990, GNorm = 1.1836, lr_0 = 6.8956e-04
Loss = 3.2956e-03, PNorm = 66.2406, GNorm = 2.1994, lr_0 = 6.6725e-04
Loss = 2.3757e-03, PNorm = 66.2845, GNorm = 2.2042, lr_0 = 6.4565e-04
Validation rmse = 0.991414
Epoch 7
Loss = 2.3485e-03, PNorm = 66.3305, GNorm = 1.1992, lr_0 = 6.2476e-04
Loss = 2.4708e-03, PNorm = 66.3649, GNorm = 1.3164, lr_0 = 6.0454e-04
Validation rmse = 1.036652
Epoch 8
Loss = 2.7936e-03, PNorm = 66.4112, GNorm = 2.0142, lr_0 = 5.8498e-04
Loss = 2.3977e-03, PNorm = 66.4585, GNorm = 0.8776, lr_0 = 5.6605e-04
Loss = 2.2103e-03, PNorm = 66.4927, GNorm = 1.0320, lr_0 = 5.4774e-04
Validation rmse = 0.862042
Epoch 9
Loss = 1.7320e-03, PNorm = 66.5245, GNorm = 0.4774, lr_0 = 5.3001e-04
Loss = 2.3249e-03, PNorm = 66.5562, GNorm = 0.9326, lr_0 = 5.1286e-04
Validation rmse = 0.856950
Epoch 10
Loss = 1.8275e-03, PNorm = 66.5955, GNorm = 2.5939, lr_0 = 4.9627e-04
Loss = 2.1366e-03, PNorm = 66.6265, GNorm = 1.9085, lr_0 = 4.8021e-04
Loss = 1.6001e-03, PNorm = 66.6577, GNorm = 2.0753, lr_0 = 4.6467e-04
Validation rmse = 0.813108
Epoch 11
Loss = 1.4454e-03, PNorm = 66.6904, GNorm = 0.9306, lr_0 = 4.4963e-04
Loss = 1.5939e-03, PNorm = 66.7241, GNorm = 1.6460, lr_0 = 4.3508e-04
Validation rmse = 0.792922
Epoch 12
Loss = 1.1036e-03, PNorm = 66.7499, GNorm = 0.5620, lr_0 = 4.1962e-04
Loss = 1.5633e-03, PNorm = 66.7756, GNorm = 1.2845, lr_0 = 4.0604e-04
Loss = 1.4196e-03, PNorm = 66.7966, GNorm = 0.8001, lr_0 = 3.9290e-04
Validation rmse = 0.777477
Epoch 13
Loss = 1.4610e-03, PNorm = 66.8151, GNorm = 1.9497, lr_0 = 3.8019e-04
Loss = 1.2925e-03, PNorm = 66.8429, GNorm = 0.4830, lr_0 = 3.6789e-04
Loss = 1.6326e-03, PNorm = 66.8631, GNorm = 1.3345, lr_0 = 3.5598e-04
Validation rmse = 0.763408
Epoch 14
Loss = 1.4999e-03, PNorm = 66.8872, GNorm = 2.1398, lr_0 = 3.4446e-04
Loss = 1.3203e-03, PNorm = 66.9128, GNorm = 1.4245, lr_0 = 3.3332e-04
Validation rmse = 0.966097
Epoch 15
Loss = 2.0586e-03, PNorm = 66.9290, GNorm = 0.9519, lr_0 = 3.2253e-04
Loss = 1.7830e-03, PNorm = 66.9521, GNorm = 1.2730, lr_0 = 3.1209e-04
Loss = 1.1760e-03, PNorm = 66.9751, GNorm = 0.7490, lr_0 = 3.0200e-04
Validation rmse = 0.806257
Epoch 16
Loss = 1.1598e-03, PNorm = 66.9924, GNorm = 0.6366, lr_0 = 2.9222e-04
Loss = 1.2627e-03, PNorm = 67.0078, GNorm = 0.5637, lr_0 = 2.8277e-04
Validation rmse = 0.753481
Epoch 17
Loss = 9.3233e-04, PNorm = 67.0305, GNorm = 0.2913, lr_0 = 2.7272e-04
Loss = 1.1427e-03, PNorm = 67.0449, GNorm = 0.5690, lr_0 = 2.6389e-04
Loss = 1.1084e-03, PNorm = 67.0588, GNorm = 0.6847, lr_0 = 2.5535e-04
Validation rmse = 0.762699
Epoch 18
Loss = 1.2252e-03, PNorm = 67.0751, GNorm = 0.3854, lr_0 = 2.4709e-04
Loss = 1.1503e-03, PNorm = 67.0898, GNorm = 1.8028, lr_0 = 2.3910e-04
Loss = 1.0569e-03, PNorm = 67.1020, GNorm = 0.4484, lr_0 = 2.3136e-04
Validation rmse = 0.750389
Epoch 19
Loss = 1.1758e-03, PNorm = 67.1166, GNorm = 0.8236, lr_0 = 2.2387e-04
Loss = 1.1548e-03, PNorm = 67.1286, GNorm = 0.6787, lr_0 = 2.1663e-04
Validation rmse = 0.736314
Epoch 20
Loss = 7.0027e-04, PNorm = 67.1432, GNorm = 0.3706, lr_0 = 2.0962e-04
Loss = 1.3725e-03, PNorm = 67.1550, GNorm = 2.5409, lr_0 = 2.0283e-04
Loss = 1.0403e-03, PNorm = 67.1660, GNorm = 0.6615, lr_0 = 1.9627e-04
Validation rmse = 0.767417
Epoch 21
Loss = 1.0484e-03, PNorm = 67.1777, GNorm = 0.4693, lr_0 = 1.8992e-04
Loss = 1.1722e-03, PNorm = 67.1903, GNorm = 0.6177, lr_0 = 1.8377e-04
Validation rmse = 0.748909
Epoch 22
Loss = 8.1252e-04, PNorm = 67.2010, GNorm = 0.4979, lr_0 = 1.7783e-04
Loss = 9.3804e-04, PNorm = 67.2123, GNorm = 0.4457, lr_0 = 1.7207e-04
Loss = 1.0431e-03, PNorm = 67.2224, GNorm = 0.4999, lr_0 = 1.6651e-04
Validation rmse = 0.745868
Epoch 23
Loss = 1.1162e-03, PNorm = 67.2305, GNorm = 0.3559, lr_0 = 1.6059e-04
Loss = 9.5841e-04, PNorm = 67.2418, GNorm = 1.8863, lr_0 = 1.5539e-04
Validation rmse = 0.739277
Epoch 24
Loss = 9.1268e-04, PNorm = 67.2539, GNorm = 0.5596, lr_0 = 1.5036e-04
Loss = 1.0126e-03, PNorm = 67.2629, GNorm = 1.9810, lr_0 = 1.4550e-04
Loss = 1.1006e-03, PNorm = 67.2717, GNorm = 1.8246, lr_0 = 1.4079e-04
Validation rmse = 0.796922
Epoch 25
Loss = 9.9242e-04, PNorm = 67.2797, GNorm = 0.9927, lr_0 = 1.3623e-04
Loss = 9.9070e-04, PNorm = 67.2882, GNorm = 1.7273, lr_0 = 1.3183e-04
Loss = 1.0791e-03, PNorm = 67.2966, GNorm = 1.6943, lr_0 = 1.2756e-04
Validation rmse = 0.744355
Epoch 26
Loss = 9.4619e-04, PNorm = 67.3062, GNorm = 0.7495, lr_0 = 1.2343e-04
Loss = 9.0066e-04, PNorm = 67.3132, GNorm = 0.3986, lr_0 = 1.1944e-04
Validation rmse = 0.747332
Epoch 27
Loss = 9.1989e-04, PNorm = 67.3205, GNorm = 1.1740, lr_0 = 1.1557e-04
Loss = 8.9145e-04, PNorm = 67.3263, GNorm = 0.5426, lr_0 = 1.1183e-04
Loss = 8.2828e-04, PNorm = 67.3320, GNorm = 0.4562, lr_0 = 1.0821e-04
Validation rmse = 0.743010
Epoch 28
Loss = 8.8458e-04, PNorm = 67.3378, GNorm = 0.5825, lr_0 = 1.0437e-04
Loss = 8.9498e-04, PNorm = 67.3430, GNorm = 0.3820, lr_0 = 1.0099e-04
Validation rmse = 0.771077
Epoch 29
Loss = 1.0198e-03, PNorm = 67.3504, GNorm = 1.5405, lr_0 = 1.0000e-04
Loss = 8.8157e-04, PNorm = 67.3559, GNorm = 0.8570, lr_0 = 1.0000e-04
Loss = 7.9026e-04, PNorm = 67.3601, GNorm = 0.4310, lr_0 = 1.0000e-04
Validation rmse = 0.742314
Model 0 best validation rmse = 0.736314 on epoch 19
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.730803
Ensemble test rmse = 0.730803
10-fold cross validation
	Seed 0 ==> test rmse = 0.784245
	Seed 1 ==> test rmse = 0.680039
	Seed 2 ==> test rmse = 0.684674
	Seed 3 ==> test rmse = 0.840444
	Seed 4 ==> test rmse = 1.024699
	Seed 5 ==> test rmse = 0.676174
	Seed 6 ==> test rmse = 0.763615
	Seed 7 ==> test rmse = 0.708465
	Seed 8 ==> test rmse = 0.698984
	Seed 9 ==> test rmse = 0.730803
Overall test rmse = 0.759214 +/- 0.101714
Elapsed time = 0:08:30
