Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.15000000000000002_ffn_num_layers_3_hidden_size_2300/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2300, bias=False)
      (W_h): Linear(in_features=2300, out_features=2300, bias=False)
      (W_o): Linear(in_features=2433, out_features=2300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=2300, out_features=2300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.15000000000000002, inplace=False)
    (4): Linear(in_features=2300, out_features=2300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.15000000000000002, inplace=False)
    (7): Linear(in_features=2300, out_features=1, bias=True)
  )
)
Number of parameters = 21,813,201
Moving model to cuda
Epoch 0
Loss = 1.6247e-02, PNorm = 97.7449, GNorm = 7.2867, lr_0 = 2.9800e-04
Loss = 1.4001e-02, PNorm = 97.8349, GNorm = 7.3956, lr_0 = 4.7800e-04
Validation rmse = 1.385466
Epoch 1
Loss = 7.8483e-03, PNorm = 97.9867, GNorm = 2.9702, lr_0 = 6.7600e-04
Loss = 1.1531e-02, PNorm = 98.1501, GNorm = 2.8197, lr_0 = 8.5600e-04
Loss = 7.4181e-03, PNorm = 98.3301, GNorm = 1.2721, lr_0 = 9.9344e-04
Validation rmse = 1.486142
Epoch 2
Loss = 7.0505e-03, PNorm = 98.4801, GNorm = 2.9988, lr_0 = 9.6130e-04
Loss = 5.3677e-03, PNorm = 98.6087, GNorm = 4.1641, lr_0 = 9.3019e-04
Validation rmse = 1.103385
Epoch 3
Loss = 3.8412e-03, PNorm = 98.7178, GNorm = 1.3405, lr_0 = 9.0009e-04
Loss = 4.2848e-03, PNorm = 98.8069, GNorm = 2.5822, lr_0 = 8.7096e-04
Loss = 4.3217e-03, PNorm = 98.8869, GNorm = 1.2163, lr_0 = 8.4278e-04
Validation rmse = 1.055967
Epoch 4
Loss = 3.1654e-03, PNorm = 98.9613, GNorm = 1.2643, lr_0 = 8.1551e-04
Loss = 4.6464e-03, PNorm = 99.0295, GNorm = 3.5110, lr_0 = 7.8912e-04
Validation rmse = 1.040830
Epoch 5
Loss = 3.3233e-03, PNorm = 99.0974, GNorm = 1.5217, lr_0 = 7.6358e-04
Loss = 3.6332e-03, PNorm = 99.1580, GNorm = 2.1829, lr_0 = 7.3888e-04
Loss = 4.8277e-03, PNorm = 99.2150, GNorm = 2.0493, lr_0 = 7.1497e-04
Validation rmse = 1.157273
Epoch 6
Loss = 3.9460e-03, PNorm = 99.2965, GNorm = 4.1437, lr_0 = 6.8956e-04
Loss = 3.5145e-03, PNorm = 99.3601, GNorm = 1.0273, lr_0 = 6.6725e-04
Loss = 3.7217e-03, PNorm = 99.4014, GNorm = 3.7717, lr_0 = 6.4565e-04
Validation rmse = 1.135497
Epoch 7
Loss = 2.7741e-03, PNorm = 99.4495, GNorm = 1.2725, lr_0 = 6.2476e-04
Loss = 2.6126e-03, PNorm = 99.4820, GNorm = 2.4253, lr_0 = 6.0454e-04
Validation rmse = 0.865278
Epoch 8
Loss = 1.9653e-03, PNorm = 99.5148, GNorm = 0.6309, lr_0 = 5.8498e-04
Loss = 3.0558e-03, PNorm = 99.5448, GNorm = 2.2978, lr_0 = 5.6605e-04
Loss = 2.5171e-03, PNorm = 99.5881, GNorm = 4.2534, lr_0 = 5.4774e-04
Validation rmse = 1.105313
Epoch 9
Loss = 3.0963e-03, PNorm = 99.6296, GNorm = 2.7335, lr_0 = 5.3001e-04
Loss = 2.7079e-03, PNorm = 99.6675, GNorm = 1.1421, lr_0 = 5.1286e-04
Validation rmse = 0.962382
Epoch 10
Loss = 2.8425e-03, PNorm = 99.7048, GNorm = 0.6800, lr_0 = 4.9627e-04
Loss = 2.6216e-03, PNorm = 99.7508, GNorm = 3.0652, lr_0 = 4.8021e-04
Loss = 2.5355e-03, PNorm = 99.7843, GNorm = 0.8219, lr_0 = 4.6467e-04
Validation rmse = 0.849218
Epoch 11
Loss = 2.0531e-03, PNorm = 99.8101, GNorm = 0.5998, lr_0 = 4.4963e-04
Loss = 1.7946e-03, PNorm = 99.8410, GNorm = 0.4514, lr_0 = 4.3508e-04
Validation rmse = 0.813179
Epoch 12
Loss = 1.8459e-03, PNorm = 99.8710, GNorm = 0.6285, lr_0 = 4.1962e-04
Loss = 1.7072e-03, PNorm = 99.8970, GNorm = 0.8298, lr_0 = 4.0604e-04
Loss = 1.8891e-03, PNorm = 99.9256, GNorm = 2.3341, lr_0 = 3.9290e-04
Validation rmse = 0.807359
Epoch 13
Loss = 1.7202e-03, PNorm = 99.9514, GNorm = 1.8829, lr_0 = 3.8019e-04
Loss = 2.0511e-03, PNorm = 99.9771, GNorm = 1.4290, lr_0 = 3.6789e-04
Loss = 1.7755e-03, PNorm = 100.0053, GNorm = 1.2808, lr_0 = 3.5598e-04
Validation rmse = 0.858775
Epoch 14
Loss = 1.6509e-03, PNorm = 100.0278, GNorm = 1.2094, lr_0 = 3.4446e-04
Loss = 1.3380e-03, PNorm = 100.0499, GNorm = 0.6616, lr_0 = 3.3332e-04
Validation rmse = 0.839381
Epoch 15
Loss = 1.4380e-03, PNorm = 100.0689, GNorm = 1.0946, lr_0 = 3.2253e-04
Loss = 1.6605e-03, PNorm = 100.0877, GNorm = 1.5492, lr_0 = 3.1209e-04
Loss = 1.6034e-03, PNorm = 100.1132, GNorm = 1.7541, lr_0 = 3.0200e-04
Validation rmse = 0.803812
Epoch 16
Loss = 1.2460e-03, PNorm = 100.1334, GNorm = 0.8939, lr_0 = 2.9222e-04
Loss = 1.3990e-03, PNorm = 100.1456, GNorm = 2.3192, lr_0 = 2.8277e-04
Validation rmse = 0.810521
Epoch 17
Loss = 1.3316e-03, PNorm = 100.1600, GNorm = 0.9261, lr_0 = 2.7272e-04
Loss = 1.3121e-03, PNorm = 100.1785, GNorm = 1.3597, lr_0 = 2.6389e-04
Loss = 1.2516e-03, PNorm = 100.1952, GNorm = 1.2791, lr_0 = 2.5535e-04
Validation rmse = 0.781448
Epoch 18
Loss = 1.2976e-03, PNorm = 100.2099, GNorm = 0.7810, lr_0 = 2.4709e-04
Loss = 1.1412e-03, PNorm = 100.2263, GNorm = 1.8578, lr_0 = 2.3910e-04
Loss = 1.1584e-03, PNorm = 100.2402, GNorm = 0.3356, lr_0 = 2.3136e-04
Validation rmse = 0.784171
Epoch 19
Loss = 1.1728e-03, PNorm = 100.2550, GNorm = 1.0308, lr_0 = 2.2387e-04
Loss = 1.2925e-03, PNorm = 100.2681, GNorm = 1.8731, lr_0 = 2.1663e-04
Validation rmse = 0.786207
Epoch 20
Loss = 9.6954e-04, PNorm = 100.2817, GNorm = 0.9395, lr_0 = 2.0962e-04
Loss = 1.0980e-03, PNorm = 100.2944, GNorm = 0.3412, lr_0 = 2.0283e-04
Loss = 9.3470e-04, PNorm = 100.3081, GNorm = 0.6056, lr_0 = 1.9627e-04
Validation rmse = 0.786200
Epoch 21
Loss = 1.0427e-03, PNorm = 100.3204, GNorm = 1.6859, lr_0 = 1.8992e-04
Loss = 9.3780e-04, PNorm = 100.3310, GNorm = 0.3718, lr_0 = 1.8377e-04
Validation rmse = 0.786156
Epoch 22
Loss = 1.0574e-03, PNorm = 100.3435, GNorm = 1.0046, lr_0 = 1.7783e-04
Loss = 9.5096e-04, PNorm = 100.3557, GNorm = 1.4791, lr_0 = 1.7207e-04
Loss = 9.2475e-04, PNorm = 100.3662, GNorm = 0.5817, lr_0 = 1.6651e-04
Validation rmse = 0.816534
Epoch 23
Loss = 9.1307e-04, PNorm = 100.3769, GNorm = 0.6819, lr_0 = 1.6059e-04
Loss = 9.5427e-04, PNorm = 100.3874, GNorm = 0.8050, lr_0 = 1.5539e-04
Validation rmse = 0.763359
Epoch 24
Loss = 8.2339e-04, PNorm = 100.3961, GNorm = 0.4663, lr_0 = 1.5036e-04
Loss = 8.3688e-04, PNorm = 100.4046, GNorm = 1.3098, lr_0 = 1.4550e-04
Loss = 9.2843e-04, PNorm = 100.4126, GNorm = 0.4576, lr_0 = 1.4079e-04
Validation rmse = 0.788734
Epoch 25
Loss = 8.2805e-04, PNorm = 100.4208, GNorm = 0.7023, lr_0 = 1.3623e-04
Loss = 9.1689e-04, PNorm = 100.4295, GNorm = 0.4075, lr_0 = 1.3183e-04
Loss = 8.1407e-04, PNorm = 100.4376, GNorm = 0.5969, lr_0 = 1.2756e-04
Validation rmse = 0.776291
Epoch 26
Loss = 7.4182e-04, PNorm = 100.4449, GNorm = 0.4200, lr_0 = 1.2343e-04
Loss = 8.6094e-04, PNorm = 100.4516, GNorm = 0.5161, lr_0 = 1.1944e-04
Validation rmse = 0.782885
Epoch 27
Loss = 8.1956e-04, PNorm = 100.4599, GNorm = 0.5277, lr_0 = 1.1557e-04
Loss = 8.9147e-04, PNorm = 100.4680, GNorm = 0.4305, lr_0 = 1.1183e-04
Loss = 8.0049e-04, PNorm = 100.4743, GNorm = 0.3958, lr_0 = 1.0821e-04
Validation rmse = 0.786307
Epoch 28
Loss = 8.4300e-04, PNorm = 100.4813, GNorm = 1.0725, lr_0 = 1.0437e-04
Loss = 7.3164e-04, PNorm = 100.4871, GNorm = 0.6650, lr_0 = 1.0099e-04
Validation rmse = 0.783762
Epoch 29
Loss = 1.0221e-03, PNorm = 100.4931, GNorm = 0.4806, lr_0 = 1.0000e-04
Loss = 7.6307e-04, PNorm = 100.5000, GNorm = 0.6628, lr_0 = 1.0000e-04
Loss = 8.7499e-04, PNorm = 100.5068, GNorm = 2.3175, lr_0 = 1.0000e-04
Validation rmse = 0.799904
Model 0 best validation rmse = 0.763359 on epoch 23
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.762214
Ensemble test rmse = 0.762214
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.15000000000000002_ffn_num_layers_3_hidden_size_2300/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2300, bias=False)
      (W_h): Linear(in_features=2300, out_features=2300, bias=False)
      (W_o): Linear(in_features=2433, out_features=2300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=2300, out_features=2300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.15000000000000002, inplace=False)
    (4): Linear(in_features=2300, out_features=2300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.15000000000000002, inplace=False)
    (7): Linear(in_features=2300, out_features=1, bias=True)
  )
)
Number of parameters = 21,813,201
Moving model to cuda
Epoch 0
Loss = 2.1790e-02, PNorm = 97.7389, GNorm = 2.7485, lr_0 = 2.9800e-04
Loss = 1.4809e-02, PNorm = 97.8335, GNorm = 3.1176, lr_0 = 4.7800e-04
Validation rmse = 1.833055
Epoch 1
Loss = 1.1144e-02, PNorm = 97.9887, GNorm = 1.4867, lr_0 = 6.7600e-04
Loss = 8.8986e-03, PNorm = 98.1626, GNorm = 1.6060, lr_0 = 8.5600e-04
Loss = 7.7759e-03, PNorm = 98.3214, GNorm = 5.9411, lr_0 = 9.9344e-04
Validation rmse = 1.303784
Epoch 2
Loss = 6.3654e-03, PNorm = 98.4665, GNorm = 1.5275, lr_0 = 9.6130e-04
Loss = 5.6373e-03, PNorm = 98.5887, GNorm = 1.8786, lr_0 = 9.3019e-04
Validation rmse = 1.316421
Epoch 3
Loss = 5.6687e-03, PNorm = 98.6936, GNorm = 3.8028, lr_0 = 9.0009e-04
Loss = 5.3921e-03, PNorm = 98.7919, GNorm = 1.2485, lr_0 = 8.7096e-04
Loss = 4.7542e-03, PNorm = 98.8747, GNorm = 4.7985, lr_0 = 8.4278e-04
Validation rmse = 1.034596
Epoch 4
Loss = 5.4606e-03, PNorm = 98.9494, GNorm = 3.3436, lr_0 = 8.1551e-04
Loss = 3.6736e-03, PNorm = 99.0300, GNorm = 1.5704, lr_0 = 7.8912e-04
Validation rmse = 0.928339
Epoch 5
Loss = 3.0279e-03, PNorm = 99.0928, GNorm = 2.5269, lr_0 = 7.6358e-04
Loss = 3.5182e-03, PNorm = 99.1528, GNorm = 1.9891, lr_0 = 7.3888e-04
Loss = 3.0408e-03, PNorm = 99.2031, GNorm = 3.3823, lr_0 = 7.1497e-04
Validation rmse = 1.224329
Epoch 6
Loss = 4.7833e-03, PNorm = 99.2616, GNorm = 1.5219, lr_0 = 6.8956e-04
Loss = 3.2434e-03, PNorm = 99.3271, GNorm = 0.8392, lr_0 = 6.6725e-04
Loss = 2.7490e-03, PNorm = 99.3789, GNorm = 1.0328, lr_0 = 6.4565e-04
Validation rmse = 0.824694
Epoch 7
Loss = 2.5476e-03, PNorm = 99.4251, GNorm = 1.8138, lr_0 = 6.2476e-04
Loss = 2.9280e-03, PNorm = 99.4653, GNorm = 5.7483, lr_0 = 6.0454e-04
Validation rmse = 0.880068
Epoch 8
Loss = 3.8859e-03, PNorm = 99.5119, GNorm = 3.8216, lr_0 = 5.8498e-04
Loss = 3.4581e-03, PNorm = 99.5652, GNorm = 1.3772, lr_0 = 5.6605e-04
Loss = 2.8091e-03, PNorm = 99.6156, GNorm = 2.5391, lr_0 = 5.4774e-04
Validation rmse = 0.845548
Epoch 9
Loss = 2.2522e-03, PNorm = 99.6591, GNorm = 1.1092, lr_0 = 5.3001e-04
Loss = 2.3613e-03, PNorm = 99.6970, GNorm = 1.3078, lr_0 = 5.1286e-04
Validation rmse = 0.856831
Epoch 10
Loss = 2.5688e-03, PNorm = 99.7295, GNorm = 3.1685, lr_0 = 4.9627e-04
Loss = 3.4451e-03, PNorm = 99.7650, GNorm = 2.8875, lr_0 = 4.8021e-04
Loss = 2.3505e-03, PNorm = 99.8026, GNorm = 1.1149, lr_0 = 4.6467e-04
Validation rmse = 0.839961
Epoch 11
Loss = 2.4294e-03, PNorm = 99.8459, GNorm = 0.7275, lr_0 = 4.4963e-04
Loss = 2.2133e-03, PNorm = 99.8792, GNorm = 0.5233, lr_0 = 4.3508e-04
Validation rmse = 0.818028
Epoch 12
Loss = 2.4317e-03, PNorm = 99.9187, GNorm = 2.1896, lr_0 = 4.1962e-04
Loss = 1.8320e-03, PNorm = 99.9554, GNorm = 1.0908, lr_0 = 4.0604e-04
Loss = 1.8947e-03, PNorm = 99.9855, GNorm = 1.0917, lr_0 = 3.9290e-04
Validation rmse = 0.857061
Epoch 13
Loss = 1.8055e-03, PNorm = 100.0139, GNorm = 1.1978, lr_0 = 3.8019e-04
Loss = 2.3032e-03, PNorm = 100.0353, GNorm = 1.9104, lr_0 = 3.6789e-04
Loss = 2.2121e-03, PNorm = 100.0589, GNorm = 1.8434, lr_0 = 3.5598e-04
Validation rmse = 0.730450
Epoch 14
Loss = 1.6583e-03, PNorm = 100.0892, GNorm = 0.8838, lr_0 = 3.4446e-04
Loss = 1.5823e-03, PNorm = 100.1126, GNorm = 1.5085, lr_0 = 3.3332e-04
Validation rmse = 0.741132
Epoch 15
Loss = 1.2524e-03, PNorm = 100.1358, GNorm = 0.6628, lr_0 = 3.2253e-04
Loss = 1.5537e-03, PNorm = 100.1572, GNorm = 1.8905, lr_0 = 3.1209e-04
Loss = 1.7646e-03, PNorm = 100.1794, GNorm = 0.5135, lr_0 = 3.0200e-04
Validation rmse = 0.711078
Epoch 16
Loss = 1.7143e-03, PNorm = 100.2006, GNorm = 0.9081, lr_0 = 2.9222e-04
Loss = 9.6862e-04, PNorm = 100.2190, GNorm = 0.4303, lr_0 = 2.8277e-04
Validation rmse = 0.682763
Epoch 17
Loss = 1.1840e-03, PNorm = 100.2357, GNorm = 1.1200, lr_0 = 2.7272e-04
Loss = 1.4629e-03, PNorm = 100.2518, GNorm = 0.6019, lr_0 = 2.6389e-04
Loss = 1.4513e-03, PNorm = 100.2681, GNorm = 1.7342, lr_0 = 2.5535e-04
Validation rmse = 0.688358
Epoch 18
Loss = 1.2499e-03, PNorm = 100.2852, GNorm = 0.5340, lr_0 = 2.4709e-04
Loss = 1.2752e-03, PNorm = 100.3024, GNorm = 0.4161, lr_0 = 2.3910e-04
Loss = 1.2001e-03, PNorm = 100.3191, GNorm = 1.1100, lr_0 = 2.3136e-04
Validation rmse = 0.699989
Epoch 19
Loss = 1.1421e-03, PNorm = 100.3310, GNorm = 1.3011, lr_0 = 2.2387e-04
Loss = 1.2084e-03, PNorm = 100.3472, GNorm = 0.4595, lr_0 = 2.1663e-04
Validation rmse = 0.680488
Epoch 20
Loss = 9.7570e-04, PNorm = 100.3636, GNorm = 0.3738, lr_0 = 2.0962e-04
Loss = 1.2519e-03, PNorm = 100.3779, GNorm = 0.8077, lr_0 = 2.0283e-04
Loss = 1.2018e-03, PNorm = 100.3915, GNorm = 0.5841, lr_0 = 1.9627e-04
Validation rmse = 0.706722
Epoch 21
Loss = 1.0883e-03, PNorm = 100.4032, GNorm = 0.5050, lr_0 = 1.8992e-04
Loss = 1.2106e-03, PNorm = 100.4158, GNorm = 2.4810, lr_0 = 1.8377e-04
Validation rmse = 0.695471
Epoch 22
Loss = 1.0420e-03, PNorm = 100.4282, GNorm = 1.3318, lr_0 = 1.7783e-04
Loss = 1.1093e-03, PNorm = 100.4409, GNorm = 0.3402, lr_0 = 1.7207e-04
Loss = 1.1094e-03, PNorm = 100.4520, GNorm = 1.3211, lr_0 = 1.6651e-04
Validation rmse = 0.664775
Epoch 23
Loss = 8.7447e-04, PNorm = 100.4637, GNorm = 1.0994, lr_0 = 1.6059e-04
Loss = 1.0585e-03, PNorm = 100.4759, GNorm = 0.6672, lr_0 = 1.5539e-04
Validation rmse = 0.790152
Epoch 24
Loss = 1.1095e-03, PNorm = 100.4859, GNorm = 1.3613, lr_0 = 1.5036e-04
Loss = 1.3055e-03, PNorm = 100.4972, GNorm = 1.6644, lr_0 = 1.4550e-04
Loss = 1.0278e-03, PNorm = 100.5091, GNorm = 0.8140, lr_0 = 1.4079e-04
Validation rmse = 0.680065
Epoch 25
Loss = 7.4826e-04, PNorm = 100.5182, GNorm = 0.3407, lr_0 = 1.3623e-04
Loss = 9.4975e-04, PNorm = 100.5277, GNorm = 0.9160, lr_0 = 1.3183e-04
Loss = 1.0977e-03, PNorm = 100.5386, GNorm = 0.4439, lr_0 = 1.2756e-04
Validation rmse = 0.672077
Epoch 26
Loss = 9.1708e-04, PNorm = 100.5471, GNorm = 0.4860, lr_0 = 1.2343e-04
Loss = 9.0024e-04, PNorm = 100.5553, GNorm = 0.6401, lr_0 = 1.1944e-04
Validation rmse = 0.679458
Epoch 27
Loss = 8.6427e-04, PNorm = 100.5631, GNorm = 0.5025, lr_0 = 1.1557e-04
Loss = 8.4195e-04, PNorm = 100.5698, GNorm = 1.1754, lr_0 = 1.1183e-04
Loss = 8.4533e-04, PNorm = 100.5779, GNorm = 0.3225, lr_0 = 1.0821e-04
Validation rmse = 0.682980
Epoch 28
Loss = 9.4214e-04, PNorm = 100.5878, GNorm = 0.6624, lr_0 = 1.0437e-04
Loss = 7.5479e-04, PNorm = 100.5939, GNorm = 0.4476, lr_0 = 1.0099e-04
Validation rmse = 0.675754
Epoch 29
Loss = 8.1656e-04, PNorm = 100.6001, GNorm = 0.4667, lr_0 = 1.0000e-04
Loss = 7.8939e-04, PNorm = 100.6077, GNorm = 0.5936, lr_0 = 1.0000e-04
Loss = 7.5645e-04, PNorm = 100.6144, GNorm = 0.3403, lr_0 = 1.0000e-04
Validation rmse = 0.687343
Model 0 best validation rmse = 0.664775 on epoch 22
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.642158
Ensemble test rmse = 0.642158
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.15000000000000002_ffn_num_layers_3_hidden_size_2300/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2300, bias=False)
      (W_h): Linear(in_features=2300, out_features=2300, bias=False)
      (W_o): Linear(in_features=2433, out_features=2300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=2300, out_features=2300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.15000000000000002, inplace=False)
    (4): Linear(in_features=2300, out_features=2300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.15000000000000002, inplace=False)
    (7): Linear(in_features=2300, out_features=1, bias=True)
  )
)
Number of parameters = 21,813,201
Moving model to cuda
Epoch 0
Loss = 2.1084e-02, PNorm = 97.7393, GNorm = 7.0448, lr_0 = 2.9800e-04
Loss = 1.2980e-02, PNorm = 97.8384, GNorm = 8.1002, lr_0 = 4.7800e-04
Validation rmse = 1.304896
Epoch 1
Loss = 8.0644e-03, PNorm = 97.9891, GNorm = 1.6834, lr_0 = 6.7600e-04
Loss = 9.6103e-03, PNorm = 98.1322, GNorm = 3.1633, lr_0 = 8.5600e-04
Loss = 1.1840e-02, PNorm = 98.3028, GNorm = 0.8091, lr_0 = 9.9344e-04
Validation rmse = 1.631794
Epoch 2
Loss = 8.8076e-03, PNorm = 98.4812, GNorm = 0.7558, lr_0 = 9.6130e-04
Loss = 7.2889e-03, PNorm = 98.6257, GNorm = 2.0873, lr_0 = 9.3019e-04
Validation rmse = 1.179666
Epoch 3
Loss = 4.7996e-03, PNorm = 98.7365, GNorm = 1.5663, lr_0 = 9.0009e-04
Loss = 4.9047e-03, PNorm = 98.8334, GNorm = 1.7691, lr_0 = 8.7096e-04
Loss = 4.6179e-03, PNorm = 98.9114, GNorm = 2.7219, lr_0 = 8.4278e-04
Validation rmse = 1.035188
Epoch 4
Loss = 4.4985e-03, PNorm = 98.9878, GNorm = 0.9735, lr_0 = 8.1551e-04
Loss = 4.0600e-03, PNorm = 99.0604, GNorm = 0.6029, lr_0 = 7.8912e-04
Validation rmse = 0.963179
Epoch 5
Loss = 4.0623e-03, PNorm = 99.1239, GNorm = 3.0824, lr_0 = 7.6358e-04
Loss = 3.2987e-03, PNorm = 99.1872, GNorm = 1.2854, lr_0 = 7.3888e-04
Loss = 3.1621e-03, PNorm = 99.2409, GNorm = 0.9114, lr_0 = 7.1497e-04
Validation rmse = 0.995970
Epoch 6
Loss = 3.5815e-03, PNorm = 99.2963, GNorm = 1.0163, lr_0 = 6.8956e-04
Loss = 2.5999e-03, PNorm = 99.3463, GNorm = 1.0629, lr_0 = 6.6725e-04
Loss = 2.8208e-03, PNorm = 99.3912, GNorm = 1.4350, lr_0 = 6.4565e-04
Validation rmse = 0.961753
Epoch 7
Loss = 2.8067e-03, PNorm = 99.4372, GNorm = 1.4126, lr_0 = 6.2476e-04
Loss = 2.2798e-03, PNorm = 99.4867, GNorm = 1.6177, lr_0 = 6.0454e-04
Validation rmse = 0.810560
Epoch 8
Loss = 3.2114e-03, PNorm = 99.5293, GNorm = 2.4834, lr_0 = 5.8498e-04
Loss = 2.0111e-03, PNorm = 99.5683, GNorm = 0.4903, lr_0 = 5.6605e-04
Loss = 2.2256e-03, PNorm = 99.6044, GNorm = 1.1049, lr_0 = 5.4774e-04
Validation rmse = 0.710944
Epoch 9
Loss = 2.3821e-03, PNorm = 99.6433, GNorm = 2.6973, lr_0 = 5.3001e-04
Loss = 2.1690e-03, PNorm = 99.6846, GNorm = 1.3518, lr_0 = 5.1286e-04
Validation rmse = 0.699539
Epoch 10
Loss = 2.2066e-03, PNorm = 99.7182, GNorm = 2.8398, lr_0 = 4.9627e-04
Loss = 1.7537e-03, PNorm = 99.7488, GNorm = 1.5705, lr_0 = 4.8021e-04
Loss = 2.6460e-03, PNorm = 99.7869, GNorm = 3.4606, lr_0 = 4.6467e-04
Validation rmse = 0.741333
Epoch 11
Loss = 2.4165e-03, PNorm = 99.8158, GNorm = 2.2208, lr_0 = 4.4963e-04
Loss = 2.2307e-03, PNorm = 99.8498, GNorm = 1.3882, lr_0 = 4.3508e-04
Validation rmse = 0.718596
Epoch 12
Loss = 1.4458e-03, PNorm = 99.8796, GNorm = 1.1541, lr_0 = 4.1962e-04
Loss = 1.8718e-03, PNorm = 99.9044, GNorm = 2.7629, lr_0 = 4.0604e-04
Loss = 1.5516e-03, PNorm = 99.9285, GNorm = 1.0747, lr_0 = 3.9290e-04
Validation rmse = 0.673500
Epoch 13
Loss = 1.5097e-03, PNorm = 99.9512, GNorm = 0.8367, lr_0 = 3.8019e-04
Loss = 1.5496e-03, PNorm = 99.9735, GNorm = 1.5104, lr_0 = 3.6789e-04
Loss = 1.7241e-03, PNorm = 99.9967, GNorm = 2.8678, lr_0 = 3.5598e-04
Validation rmse = 0.746454
Epoch 14
Loss = 1.4977e-03, PNorm = 100.0154, GNorm = 2.5247, lr_0 = 3.4446e-04
Loss = 2.2111e-03, PNorm = 100.0441, GNorm = 3.4970, lr_0 = 3.3332e-04
Validation rmse = 0.971696
Epoch 15
Loss = 2.3670e-03, PNorm = 100.0689, GNorm = 0.7430, lr_0 = 3.2253e-04
Loss = 1.8378e-03, PNorm = 100.0895, GNorm = 0.5178, lr_0 = 3.1209e-04
Loss = 2.2145e-03, PNorm = 100.1161, GNorm = 2.0133, lr_0 = 3.0200e-04
Validation rmse = 0.716553
Epoch 16
Loss = 1.4611e-03, PNorm = 100.1377, GNorm = 0.8708, lr_0 = 2.9222e-04
Loss = 1.4501e-03, PNorm = 100.1558, GNorm = 1.3507, lr_0 = 2.8277e-04
Validation rmse = 0.696114
Epoch 17
Loss = 1.0957e-03, PNorm = 100.1717, GNorm = 2.4926, lr_0 = 2.7272e-04
Loss = 1.2159e-03, PNorm = 100.1873, GNorm = 1.0660, lr_0 = 2.6389e-04
Loss = 1.6199e-03, PNorm = 100.2030, GNorm = 1.8380, lr_0 = 2.5535e-04
Validation rmse = 0.699967
Epoch 18
Loss = 1.3822e-03, PNorm = 100.2193, GNorm = 0.6985, lr_0 = 2.4709e-04
Loss = 1.4788e-03, PNorm = 100.2346, GNorm = 0.6529, lr_0 = 2.3910e-04
Loss = 1.1080e-03, PNorm = 100.2430, GNorm = 0.3562, lr_0 = 2.3136e-04
Validation rmse = 0.687147
Epoch 19
Loss = 1.3191e-03, PNorm = 100.2578, GNorm = 1.4679, lr_0 = 2.2387e-04
Loss = 1.1160e-03, PNorm = 100.2704, GNorm = 1.1088, lr_0 = 2.1663e-04
Validation rmse = 0.687114
Epoch 20
Loss = 1.2360e-03, PNorm = 100.2836, GNorm = 1.3782, lr_0 = 2.0962e-04
Loss = 1.0941e-03, PNorm = 100.2970, GNorm = 1.0581, lr_0 = 2.0283e-04
Loss = 1.0767e-03, PNorm = 100.3047, GNorm = 0.3667, lr_0 = 1.9627e-04
Validation rmse = 0.685682
Epoch 21
Loss = 1.0397e-03, PNorm = 100.3148, GNorm = 0.8963, lr_0 = 1.8992e-04
Loss = 1.1276e-03, PNorm = 100.3257, GNorm = 1.0324, lr_0 = 1.8377e-04
Validation rmse = 0.678915
Epoch 22
Loss = 8.4454e-04, PNorm = 100.3349, GNorm = 0.4018, lr_0 = 1.7783e-04
Loss = 1.1843e-03, PNorm = 100.3463, GNorm = 0.6812, lr_0 = 1.7207e-04
Loss = 1.0514e-03, PNorm = 100.3562, GNorm = 0.5734, lr_0 = 1.6651e-04
Validation rmse = 0.673657
Epoch 23
Loss = 1.0111e-03, PNorm = 100.3681, GNorm = 0.6496, lr_0 = 1.6059e-04
Loss = 1.0550e-03, PNorm = 100.3767, GNorm = 1.0382, lr_0 = 1.5539e-04
Validation rmse = 0.665272
Epoch 24
Loss = 1.0142e-03, PNorm = 100.3859, GNorm = 0.7934, lr_0 = 1.5036e-04
Loss = 8.7139e-04, PNorm = 100.3955, GNorm = 0.9130, lr_0 = 1.4550e-04
Loss = 1.1100e-03, PNorm = 100.4031, GNorm = 1.8168, lr_0 = 1.4079e-04
Validation rmse = 0.669638
Epoch 25
Loss = 1.0890e-03, PNorm = 100.4123, GNorm = 2.8770, lr_0 = 1.3623e-04
Loss = 1.0339e-03, PNorm = 100.4228, GNorm = 0.9113, lr_0 = 1.3183e-04
Loss = 1.0163e-03, PNorm = 100.4298, GNorm = 0.4715, lr_0 = 1.2756e-04
Validation rmse = 0.677481
Epoch 26
Loss = 9.3881e-04, PNorm = 100.4377, GNorm = 1.8581, lr_0 = 1.2343e-04
Loss = 9.5689e-04, PNorm = 100.4444, GNorm = 0.3026, lr_0 = 1.1944e-04
Validation rmse = 0.670046
Epoch 27
Loss = 1.1083e-03, PNorm = 100.4508, GNorm = 0.5340, lr_0 = 1.1557e-04
Loss = 9.9061e-04, PNorm = 100.4583, GNorm = 0.5667, lr_0 = 1.1183e-04
Loss = 8.4080e-04, PNorm = 100.4644, GNorm = 1.0017, lr_0 = 1.0821e-04
Validation rmse = 0.661097
Epoch 28
Loss = 9.0773e-04, PNorm = 100.4710, GNorm = 0.3445, lr_0 = 1.0437e-04
Loss = 9.0791e-04, PNorm = 100.4765, GNorm = 0.8995, lr_0 = 1.0099e-04
Validation rmse = 0.686039
Epoch 29
Loss = 8.7252e-04, PNorm = 100.4820, GNorm = 0.9765, lr_0 = 1.0000e-04
Loss = 9.0905e-04, PNorm = 100.4883, GNorm = 1.5155, lr_0 = 1.0000e-04
Loss = 7.6878e-04, PNorm = 100.4935, GNorm = 0.5809, lr_0 = 1.0000e-04
Validation rmse = 0.673890
Model 0 best validation rmse = 0.661097 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.689468
Ensemble test rmse = 0.689468
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.15000000000000002_ffn_num_layers_3_hidden_size_2300/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2300, bias=False)
      (W_h): Linear(in_features=2300, out_features=2300, bias=False)
      (W_o): Linear(in_features=2433, out_features=2300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=2300, out_features=2300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.15000000000000002, inplace=False)
    (4): Linear(in_features=2300, out_features=2300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.15000000000000002, inplace=False)
    (7): Linear(in_features=2300, out_features=1, bias=True)
  )
)
Number of parameters = 21,813,201
Moving model to cuda
Epoch 0
Loss = 1.9265e-02, PNorm = 97.7403, GNorm = 6.6501, lr_0 = 2.9800e-04
Loss = 1.3599e-02, PNorm = 97.8398, GNorm = 1.5700, lr_0 = 4.7800e-04
Validation rmse = 1.636323
Epoch 1
Loss = 9.7705e-03, PNorm = 97.9992, GNorm = 5.0031, lr_0 = 6.7600e-04
Loss = 9.8855e-03, PNorm = 98.1728, GNorm = 4.9214, lr_0 = 8.5600e-04
Loss = 8.1350e-03, PNorm = 98.3559, GNorm = 3.0232, lr_0 = 9.9344e-04
Validation rmse = 1.344890
Epoch 2
Loss = 7.0668e-03, PNorm = 98.5225, GNorm = 2.3509, lr_0 = 9.6130e-04
Loss = 5.7130e-03, PNorm = 98.6451, GNorm = 2.4148, lr_0 = 9.3019e-04
Validation rmse = 1.040801
Epoch 3
Loss = 3.8729e-03, PNorm = 98.7524, GNorm = 1.2415, lr_0 = 9.0009e-04
Loss = 4.7123e-03, PNorm = 98.8605, GNorm = 5.4047, lr_0 = 8.7096e-04
Loss = 4.4266e-03, PNorm = 98.9500, GNorm = 1.0649, lr_0 = 8.4278e-04
Validation rmse = 1.453119
Epoch 4
Loss = 6.7640e-03, PNorm = 99.0307, GNorm = 4.9541, lr_0 = 8.1551e-04
Loss = 4.6287e-03, PNorm = 99.1219, GNorm = 1.1602, lr_0 = 7.8912e-04
Validation rmse = 0.935087
Epoch 5
Loss = 3.0076e-03, PNorm = 99.1957, GNorm = 1.0793, lr_0 = 7.6358e-04
Loss = 3.4049e-03, PNorm = 99.2584, GNorm = 0.6023, lr_0 = 7.3888e-04
Loss = 3.4342e-03, PNorm = 99.3175, GNorm = 2.0626, lr_0 = 7.1497e-04
Validation rmse = 0.945175
Epoch 6
Loss = 3.1071e-03, PNorm = 99.3860, GNorm = 1.1525, lr_0 = 6.8956e-04
Loss = 2.9214e-03, PNorm = 99.4373, GNorm = 1.5396, lr_0 = 6.6725e-04
Loss = 3.1788e-03, PNorm = 99.4890, GNorm = 4.4858, lr_0 = 6.4565e-04
Validation rmse = 0.942342
Epoch 7
Loss = 2.6260e-03, PNorm = 99.5415, GNorm = 2.4871, lr_0 = 6.2476e-04
Loss = 3.1713e-03, PNorm = 99.5868, GNorm = 2.6946, lr_0 = 6.0454e-04
Validation rmse = 0.850250
Epoch 8
Loss = 2.3404e-03, PNorm = 99.6312, GNorm = 2.5484, lr_0 = 5.8498e-04
Loss = 2.5675e-03, PNorm = 99.6716, GNorm = 3.5439, lr_0 = 5.6605e-04
Loss = 2.3270e-03, PNorm = 99.7168, GNorm = 1.5868, lr_0 = 5.4774e-04
Validation rmse = 0.736610
Epoch 9
Loss = 2.1441e-03, PNorm = 99.7569, GNorm = 1.3122, lr_0 = 5.3001e-04
Loss = 2.4519e-03, PNorm = 99.8009, GNorm = 1.3789, lr_0 = 5.1286e-04
Validation rmse = 0.755186
Epoch 10
Loss = 1.4459e-03, PNorm = 99.8405, GNorm = 0.7004, lr_0 = 4.9627e-04
Loss = 1.7397e-03, PNorm = 99.8771, GNorm = 0.7150, lr_0 = 4.8021e-04
Loss = 2.0270e-03, PNorm = 99.9063, GNorm = 1.5411, lr_0 = 4.6467e-04
Validation rmse = 0.712047
Epoch 11
Loss = 1.5448e-03, PNorm = 99.9367, GNorm = 0.7168, lr_0 = 4.4963e-04
Loss = 1.9570e-03, PNorm = 99.9711, GNorm = 1.0708, lr_0 = 4.3508e-04
Validation rmse = 0.776383
Epoch 12
Loss = 2.6930e-03, PNorm = 100.0028, GNorm = 2.4126, lr_0 = 4.1962e-04
Loss = 2.0497e-03, PNorm = 100.0322, GNorm = 0.9647, lr_0 = 4.0604e-04
Loss = 1.7534e-03, PNorm = 100.0627, GNorm = 2.1460, lr_0 = 3.9290e-04
Validation rmse = 0.733393
Epoch 13
Loss = 1.8618e-03, PNorm = 100.0927, GNorm = 1.4328, lr_0 = 3.8019e-04
Loss = 1.7215e-03, PNorm = 100.1220, GNorm = 1.4892, lr_0 = 3.6789e-04
Loss = 1.4720e-03, PNorm = 100.1545, GNorm = 0.8230, lr_0 = 3.5598e-04
Validation rmse = 0.665087
Epoch 14
Loss = 1.5469e-03, PNorm = 100.1833, GNorm = 0.6098, lr_0 = 3.4446e-04
Loss = 1.4145e-03, PNorm = 100.2015, GNorm = 0.8269, lr_0 = 3.3332e-04
Validation rmse = 0.706338
Epoch 15
Loss = 1.4639e-03, PNorm = 100.2244, GNorm = 2.2348, lr_0 = 3.2253e-04
Loss = 1.3503e-03, PNorm = 100.2500, GNorm = 1.0817, lr_0 = 3.1209e-04
Loss = 1.4471e-03, PNorm = 100.2716, GNorm = 1.5061, lr_0 = 3.0200e-04
Validation rmse = 0.704014
Epoch 16
Loss = 1.6584e-03, PNorm = 100.2969, GNorm = 0.5898, lr_0 = 2.9222e-04
Loss = 1.4432e-03, PNorm = 100.3206, GNorm = 0.8207, lr_0 = 2.8277e-04
Validation rmse = 0.693586
Epoch 17
Loss = 1.2367e-03, PNorm = 100.3433, GNorm = 0.4612, lr_0 = 2.7272e-04
Loss = 1.2785e-03, PNorm = 100.3625, GNorm = 1.7906, lr_0 = 2.6389e-04
Loss = 1.2600e-03, PNorm = 100.3829, GNorm = 0.8427, lr_0 = 2.5535e-04
Validation rmse = 0.689827
Epoch 18
Loss = 1.2146e-03, PNorm = 100.4011, GNorm = 2.5792, lr_0 = 2.4709e-04
Loss = 1.3078e-03, PNorm = 100.4193, GNorm = 0.8011, lr_0 = 2.3910e-04
Loss = 1.0271e-03, PNorm = 100.4400, GNorm = 0.9714, lr_0 = 2.3136e-04
Validation rmse = 0.659700
Epoch 19
Loss = 1.2136e-03, PNorm = 100.4569, GNorm = 0.7729, lr_0 = 2.2387e-04
Loss = 1.0377e-03, PNorm = 100.4734, GNorm = 1.0101, lr_0 = 2.1663e-04
Validation rmse = 0.640384
Epoch 20
Loss = 1.0221e-03, PNorm = 100.4888, GNorm = 0.5891, lr_0 = 2.0962e-04
Loss = 1.1455e-03, PNorm = 100.5041, GNorm = 0.6613, lr_0 = 2.0283e-04
Loss = 1.2161e-03, PNorm = 100.5186, GNorm = 0.2811, lr_0 = 1.9627e-04
Validation rmse = 0.654291
Epoch 21
Loss = 1.0343e-03, PNorm = 100.5336, GNorm = 0.4006, lr_0 = 1.8992e-04
Loss = 1.3260e-03, PNorm = 100.5475, GNorm = 1.9249, lr_0 = 1.8377e-04
Validation rmse = 0.707418
Epoch 22
Loss = 1.5350e-03, PNorm = 100.5600, GNorm = 2.3564, lr_0 = 1.7783e-04
Loss = 1.1017e-03, PNorm = 100.5735, GNorm = 0.7119, lr_0 = 1.7207e-04
Loss = 9.5982e-04, PNorm = 100.5859, GNorm = 1.4250, lr_0 = 1.6651e-04
Validation rmse = 0.653358
Epoch 23
Loss = 1.0328e-03, PNorm = 100.5987, GNorm = 0.6053, lr_0 = 1.6059e-04
Loss = 8.0655e-04, PNorm = 100.6095, GNorm = 0.7085, lr_0 = 1.5539e-04
Validation rmse = 0.664977
Epoch 24
Loss = 8.3966e-04, PNorm = 100.6210, GNorm = 1.1516, lr_0 = 1.5036e-04
Loss = 8.3604e-04, PNorm = 100.6341, GNorm = 0.3865, lr_0 = 1.4550e-04
Loss = 8.3045e-04, PNorm = 100.6432, GNorm = 0.3625, lr_0 = 1.4079e-04
Validation rmse = 0.662962
Epoch 25
Loss = 9.0250e-04, PNorm = 100.6521, GNorm = 0.2682, lr_0 = 1.3623e-04
Loss = 9.1849e-04, PNorm = 100.6610, GNorm = 0.3720, lr_0 = 1.3183e-04
Loss = 1.0151e-03, PNorm = 100.6710, GNorm = 0.6770, lr_0 = 1.2756e-04
Validation rmse = 0.663114
Epoch 26
Loss = 9.3139e-04, PNorm = 100.6813, GNorm = 0.4588, lr_0 = 1.2343e-04
Loss = 7.6763e-04, PNorm = 100.6896, GNorm = 0.9310, lr_0 = 1.1944e-04
Validation rmse = 0.646993
Epoch 27
Loss = 7.5405e-04, PNorm = 100.6981, GNorm = 0.4919, lr_0 = 1.1557e-04
Loss = 8.3903e-04, PNorm = 100.7081, GNorm = 0.5463, lr_0 = 1.1183e-04
Loss = 7.5559e-04, PNorm = 100.7149, GNorm = 0.6461, lr_0 = 1.0821e-04
Validation rmse = 0.652529
Epoch 28
Loss = 7.8458e-04, PNorm = 100.7232, GNorm = 0.5017, lr_0 = 1.0437e-04
Loss = 8.4426e-04, PNorm = 100.7306, GNorm = 1.1403, lr_0 = 1.0099e-04
Validation rmse = 0.651383
Epoch 29
Loss = 6.0461e-04, PNorm = 100.7376, GNorm = 0.2442, lr_0 = 1.0000e-04
Loss = 7.0169e-04, PNorm = 100.7437, GNorm = 0.3914, lr_0 = 1.0000e-04
Loss = 8.6166e-04, PNorm = 100.7500, GNorm = 0.4406, lr_0 = 1.0000e-04
Validation rmse = 0.637985
Model 0 best validation rmse = 0.637985 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.859463
Ensemble test rmse = 0.859463
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.15000000000000002_ffn_num_layers_3_hidden_size_2300/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2300, bias=False)
      (W_h): Linear(in_features=2300, out_features=2300, bias=False)
      (W_o): Linear(in_features=2433, out_features=2300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=2300, out_features=2300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.15000000000000002, inplace=False)
    (4): Linear(in_features=2300, out_features=2300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.15000000000000002, inplace=False)
    (7): Linear(in_features=2300, out_features=1, bias=True)
  )
)
Number of parameters = 21,813,201
Moving model to cuda
Epoch 0
Loss = 1.9969e-02, PNorm = 97.7414, GNorm = 1.9083, lr_0 = 2.9800e-04
Loss = 1.7796e-02, PNorm = 97.8330, GNorm = 3.7401, lr_0 = 4.7800e-04
Validation rmse = 1.895799
Epoch 1
Loss = 1.2568e-02, PNorm = 97.9948, GNorm = 2.0659, lr_0 = 6.7600e-04
Loss = 9.4548e-03, PNorm = 98.1634, GNorm = 3.3796, lr_0 = 8.5600e-04
Loss = 8.9954e-03, PNorm = 98.3353, GNorm = 3.8693, lr_0 = 9.9344e-04
Validation rmse = 1.459675
Epoch 2
Loss = 7.4745e-03, PNorm = 98.4869, GNorm = 3.0403, lr_0 = 9.6130e-04
Loss = 4.7487e-03, PNorm = 98.6066, GNorm = 1.1390, lr_0 = 9.3019e-04
Validation rmse = 1.189311
Epoch 3
Loss = 4.7000e-03, PNorm = 98.7056, GNorm = 1.0328, lr_0 = 9.0009e-04
Loss = 4.6750e-03, PNorm = 98.7846, GNorm = 3.2183, lr_0 = 8.7096e-04
Loss = 3.8213e-03, PNorm = 98.8596, GNorm = 0.7370, lr_0 = 8.4278e-04
Validation rmse = 1.094520
Epoch 4
Loss = 3.3183e-03, PNorm = 98.9253, GNorm = 0.5913, lr_0 = 8.1551e-04
Loss = 3.4125e-03, PNorm = 98.9856, GNorm = 5.2856, lr_0 = 7.8912e-04
Validation rmse = 1.116927
Epoch 5
Loss = 4.5306e-03, PNorm = 99.0526, GNorm = 3.0991, lr_0 = 7.6358e-04
Loss = 4.1547e-03, PNorm = 99.1206, GNorm = 2.1735, lr_0 = 7.3888e-04
Loss = 4.2115e-03, PNorm = 99.1786, GNorm = 3.0457, lr_0 = 7.1497e-04
Validation rmse = 1.002153
Epoch 6
Loss = 3.3024e-03, PNorm = 99.2347, GNorm = 2.2090, lr_0 = 6.8956e-04
Loss = 3.7692e-03, PNorm = 99.2927, GNorm = 2.4441, lr_0 = 6.6725e-04
Loss = 3.2985e-03, PNorm = 99.3432, GNorm = 2.7465, lr_0 = 6.4565e-04
Validation rmse = 0.907712
Epoch 7
Loss = 2.5209e-03, PNorm = 99.3886, GNorm = 2.1882, lr_0 = 6.2476e-04
Loss = 2.6940e-03, PNorm = 99.4329, GNorm = 0.9941, lr_0 = 6.0454e-04
Validation rmse = 0.864866
Epoch 8
Loss = 2.4279e-03, PNorm = 99.4707, GNorm = 3.6825, lr_0 = 5.8498e-04
Loss = 2.6351e-03, PNorm = 99.5147, GNorm = 1.0554, lr_0 = 5.6605e-04
Loss = 2.2441e-03, PNorm = 99.5463, GNorm = 1.3039, lr_0 = 5.4774e-04
Validation rmse = 0.836140
Epoch 9
Loss = 2.3564e-03, PNorm = 99.5831, GNorm = 2.6690, lr_0 = 5.3001e-04
Loss = 2.2282e-03, PNorm = 99.6187, GNorm = 0.9168, lr_0 = 5.1286e-04
Validation rmse = 0.836497
Epoch 10
Loss = 2.0318e-03, PNorm = 99.6519, GNorm = 0.7002, lr_0 = 4.9627e-04
Loss = 2.4084e-03, PNorm = 99.6848, GNorm = 1.9797, lr_0 = 4.8021e-04
Loss = 1.9043e-03, PNorm = 99.7206, GNorm = 1.3531, lr_0 = 4.6467e-04
Validation rmse = 0.805528
Epoch 11
Loss = 1.9637e-03, PNorm = 99.7489, GNorm = 3.2851, lr_0 = 4.4963e-04
Loss = 3.1185e-03, PNorm = 99.7819, GNorm = 2.3429, lr_0 = 4.3508e-04
Validation rmse = 0.872590
Epoch 12
Loss = 1.8489e-03, PNorm = 99.8194, GNorm = 0.8929, lr_0 = 4.1962e-04
Loss = 1.7384e-03, PNorm = 99.8506, GNorm = 0.8769, lr_0 = 4.0604e-04
Loss = 1.5781e-03, PNorm = 99.8779, GNorm = 1.1141, lr_0 = 3.9290e-04
Validation rmse = 0.881057
Epoch 13
Loss = 2.1235e-03, PNorm = 99.9004, GNorm = 4.0265, lr_0 = 3.8019e-04
Loss = 1.8662e-03, PNorm = 99.9276, GNorm = 2.1357, lr_0 = 3.6789e-04
Loss = 1.6782e-03, PNorm = 99.9508, GNorm = 1.0769, lr_0 = 3.5598e-04
Validation rmse = 0.777788
Epoch 14
Loss = 1.4960e-03, PNorm = 99.9689, GNorm = 0.7111, lr_0 = 3.4446e-04
Loss = 1.4109e-03, PNorm = 99.9918, GNorm = 1.0823, lr_0 = 3.3332e-04
Validation rmse = 0.776635
Epoch 15
Loss = 1.3363e-03, PNorm = 100.0128, GNorm = 0.8428, lr_0 = 3.2253e-04
Loss = 1.4679e-03, PNorm = 100.0291, GNorm = 0.5458, lr_0 = 3.1209e-04
Loss = 1.2571e-03, PNorm = 100.0454, GNorm = 0.9982, lr_0 = 3.0200e-04
Validation rmse = 0.792900
Epoch 16
Loss = 1.3123e-03, PNorm = 100.0666, GNorm = 0.4214, lr_0 = 2.9222e-04
Loss = 1.4285e-03, PNorm = 100.0828, GNorm = 2.0751, lr_0 = 2.8277e-04
Validation rmse = 0.747864
Epoch 17
Loss = 1.3096e-03, PNorm = 100.1012, GNorm = 0.4814, lr_0 = 2.7272e-04
Loss = 1.4112e-03, PNorm = 100.1183, GNorm = 0.6655, lr_0 = 2.6389e-04
Loss = 1.2348e-03, PNorm = 100.1336, GNorm = 0.4882, lr_0 = 2.5535e-04
Validation rmse = 0.746416
Epoch 18
Loss = 1.0873e-03, PNorm = 100.1508, GNorm = 0.7010, lr_0 = 2.4709e-04
Loss = 1.3329e-03, PNorm = 100.1652, GNorm = 1.4937, lr_0 = 2.3910e-04
Loss = 1.2970e-03, PNorm = 100.1801, GNorm = 0.6815, lr_0 = 2.3136e-04
Validation rmse = 0.826420
Epoch 19
Loss = 1.3328e-03, PNorm = 100.1947, GNorm = 0.7409, lr_0 = 2.2387e-04
Loss = 1.2275e-03, PNorm = 100.2110, GNorm = 0.6591, lr_0 = 2.1663e-04
Validation rmse = 0.739675
Epoch 20
Loss = 7.7614e-04, PNorm = 100.2253, GNorm = 0.7267, lr_0 = 2.0962e-04
Loss = 1.1307e-03, PNorm = 100.2383, GNorm = 0.6692, lr_0 = 2.0283e-04
Loss = 1.1921e-03, PNorm = 100.2508, GNorm = 0.9494, lr_0 = 1.9627e-04
Validation rmse = 0.775592
Epoch 21
Loss = 1.0560e-03, PNorm = 100.2635, GNorm = 0.5378, lr_0 = 1.8992e-04
Loss = 1.1740e-03, PNorm = 100.2756, GNorm = 2.2688, lr_0 = 1.8377e-04
Validation rmse = 0.754232
Epoch 22
Loss = 8.4890e-04, PNorm = 100.2864, GNorm = 0.7357, lr_0 = 1.7783e-04
Loss = 1.1009e-03, PNorm = 100.2941, GNorm = 1.5865, lr_0 = 1.7207e-04
Loss = 1.2561e-03, PNorm = 100.3057, GNorm = 0.9705, lr_0 = 1.6651e-04
Validation rmse = 0.752436
Epoch 23
Loss = 1.0950e-03, PNorm = 100.3213, GNorm = 0.7615, lr_0 = 1.6059e-04
Loss = 9.5090e-04, PNorm = 100.3315, GNorm = 2.1271, lr_0 = 1.5539e-04
Validation rmse = 0.762599
Epoch 24
Loss = 8.5811e-04, PNorm = 100.3414, GNorm = 1.3366, lr_0 = 1.5036e-04
Loss = 1.1081e-03, PNorm = 100.3492, GNorm = 2.0207, lr_0 = 1.4550e-04
Loss = 1.0916e-03, PNorm = 100.3609, GNorm = 0.6793, lr_0 = 1.4079e-04
Validation rmse = 0.753367
Epoch 25
Loss = 9.6055e-04, PNorm = 100.3716, GNorm = 0.5444, lr_0 = 1.3623e-04
Loss = 9.0801e-04, PNorm = 100.3820, GNorm = 0.5218, lr_0 = 1.3183e-04
Loss = 9.5193e-04, PNorm = 100.3883, GNorm = 1.3361, lr_0 = 1.2756e-04
Validation rmse = 0.736073
Epoch 26
Loss = 9.1389e-04, PNorm = 100.3948, GNorm = 0.8813, lr_0 = 1.2343e-04
Loss = 9.0111e-04, PNorm = 100.4025, GNorm = 1.3269, lr_0 = 1.1944e-04
Validation rmse = 0.732409
Epoch 27
Loss = 7.3335e-04, PNorm = 100.4105, GNorm = 0.4585, lr_0 = 1.1557e-04
Loss = 7.8264e-04, PNorm = 100.4158, GNorm = 0.3411, lr_0 = 1.1183e-04
Loss = 8.7297e-04, PNorm = 100.4221, GNorm = 0.6427, lr_0 = 1.0821e-04
Validation rmse = 0.733149
Epoch 28
Loss = 6.5971e-04, PNorm = 100.4311, GNorm = 0.6984, lr_0 = 1.0437e-04
Loss = 8.8475e-04, PNorm = 100.4376, GNorm = 0.4251, lr_0 = 1.0099e-04
Validation rmse = 0.760360
Epoch 29
Loss = 1.2253e-03, PNorm = 100.4446, GNorm = 0.3566, lr_0 = 1.0000e-04
Loss = 7.8760e-04, PNorm = 100.4524, GNorm = 0.8756, lr_0 = 1.0000e-04
Loss = 6.7507e-04, PNorm = 100.4587, GNorm = 0.9368, lr_0 = 1.0000e-04
Validation rmse = 0.734765
Model 0 best validation rmse = 0.732409 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.006945
Ensemble test rmse = 1.006945
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.15000000000000002_ffn_num_layers_3_hidden_size_2300/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2300, bias=False)
      (W_h): Linear(in_features=2300, out_features=2300, bias=False)
      (W_o): Linear(in_features=2433, out_features=2300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=2300, out_features=2300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.15000000000000002, inplace=False)
    (4): Linear(in_features=2300, out_features=2300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.15000000000000002, inplace=False)
    (7): Linear(in_features=2300, out_features=1, bias=True)
  )
)
Number of parameters = 21,813,201
Moving model to cuda
Epoch 0
Loss = 1.8574e-02, PNorm = 97.7433, GNorm = 7.6907, lr_0 = 2.9800e-04
Loss = 1.3540e-02, PNorm = 97.8349, GNorm = 12.0076, lr_0 = 4.7800e-04
Validation rmse = 1.576898
Epoch 1
Loss = 9.1075e-03, PNorm = 97.9799, GNorm = 1.8210, lr_0 = 6.7600e-04
Loss = 8.5708e-03, PNorm = 98.1348, GNorm = 1.8137, lr_0 = 8.5600e-04
Loss = 1.0734e-02, PNorm = 98.3013, GNorm = 3.4309, lr_0 = 9.9344e-04
Validation rmse = 1.950213
Epoch 2
Loss = 8.0089e-03, PNorm = 98.4855, GNorm = 2.9490, lr_0 = 9.6130e-04
Loss = 8.2840e-03, PNorm = 98.6304, GNorm = 1.4775, lr_0 = 9.3019e-04
Validation rmse = 1.308228
Epoch 3
Loss = 4.0032e-03, PNorm = 98.7581, GNorm = 1.6672, lr_0 = 9.0009e-04
Loss = 5.1274e-03, PNorm = 98.8544, GNorm = 1.9097, lr_0 = 8.7096e-04
Loss = 6.0796e-03, PNorm = 98.9506, GNorm = 4.3214, lr_0 = 8.4278e-04
Validation rmse = 1.354243
Epoch 4
Loss = 4.5670e-03, PNorm = 99.0439, GNorm = 4.5891, lr_0 = 8.1551e-04
Loss = 4.2830e-03, PNorm = 99.1186, GNorm = 3.4439, lr_0 = 7.8912e-04
Validation rmse = 1.067280
Epoch 5
Loss = 3.5690e-03, PNorm = 99.1876, GNorm = 1.1463, lr_0 = 7.6358e-04
Loss = 3.3036e-03, PNorm = 99.2460, GNorm = 1.6133, lr_0 = 7.3888e-04
Loss = 4.5347e-03, PNorm = 99.3035, GNorm = 1.3378, lr_0 = 7.1497e-04
Validation rmse = 1.151481
Epoch 6
Loss = 3.5898e-03, PNorm = 99.3877, GNorm = 2.1957, lr_0 = 6.8956e-04
Loss = 3.7368e-03, PNorm = 99.4459, GNorm = 1.1713, lr_0 = 6.6725e-04
Loss = 2.8439e-03, PNorm = 99.4994, GNorm = 1.4321, lr_0 = 6.4565e-04
Validation rmse = 0.995310
Epoch 7
Loss = 2.4089e-03, PNorm = 99.5502, GNorm = 0.4962, lr_0 = 6.2476e-04
Loss = 2.6893e-03, PNorm = 99.5913, GNorm = 1.3003, lr_0 = 6.0454e-04
Validation rmse = 1.061606
Epoch 8
Loss = 1.8003e-03, PNorm = 99.6331, GNorm = 1.3269, lr_0 = 5.8498e-04
Loss = 2.4326e-03, PNorm = 99.6733, GNorm = 2.7891, lr_0 = 5.6605e-04
Loss = 2.9119e-03, PNorm = 99.7131, GNorm = 0.8401, lr_0 = 5.4774e-04
Validation rmse = 1.148120
Epoch 9
Loss = 2.2073e-03, PNorm = 99.7472, GNorm = 2.8762, lr_0 = 5.3001e-04
Loss = 2.5347e-03, PNorm = 99.7882, GNorm = 1.6605, lr_0 = 5.1286e-04
Validation rmse = 1.016458
Epoch 10
Loss = 1.7172e-03, PNorm = 99.8283, GNorm = 1.3698, lr_0 = 4.9627e-04
Loss = 1.9689e-03, PNorm = 99.8642, GNorm = 0.6774, lr_0 = 4.8021e-04
Loss = 2.7066e-03, PNorm = 99.9078, GNorm = 1.2959, lr_0 = 4.6467e-04
Validation rmse = 0.974373
Epoch 11
Loss = 2.0892e-03, PNorm = 99.9529, GNorm = 2.7853, lr_0 = 4.4963e-04
Loss = 2.3919e-03, PNorm = 99.9950, GNorm = 0.9943, lr_0 = 4.3508e-04
Validation rmse = 1.002522
Epoch 12
Loss = 1.9320e-03, PNorm = 100.0300, GNorm = 1.2449, lr_0 = 4.1962e-04
Loss = 1.7971e-03, PNorm = 100.0542, GNorm = 0.4709, lr_0 = 4.0604e-04
Loss = 1.6846e-03, PNorm = 100.0813, GNorm = 0.7854, lr_0 = 3.9290e-04
Validation rmse = 1.150287
Epoch 13
Loss = 2.2327e-03, PNorm = 100.1112, GNorm = 4.0301, lr_0 = 3.8019e-04
Loss = 1.8722e-03, PNorm = 100.1309, GNorm = 0.7530, lr_0 = 3.6789e-04
Loss = 2.1410e-03, PNorm = 100.1563, GNorm = 3.0518, lr_0 = 3.5598e-04
Validation rmse = 0.982340
Epoch 14
Loss = 2.0468e-03, PNorm = 100.1885, GNorm = 1.3201, lr_0 = 3.4446e-04
Loss = 1.6979e-03, PNorm = 100.2090, GNorm = 0.7157, lr_0 = 3.3332e-04
Validation rmse = 1.002660
Epoch 15
Loss = 1.9540e-03, PNorm = 100.2280, GNorm = 1.1559, lr_0 = 3.2253e-04
Loss = 1.3703e-03, PNorm = 100.2458, GNorm = 0.4188, lr_0 = 3.1209e-04
Loss = 1.3653e-03, PNorm = 100.2657, GNorm = 0.7612, lr_0 = 3.0200e-04
Validation rmse = 0.916861
Epoch 16
Loss = 1.5972e-03, PNorm = 100.2854, GNorm = 1.1997, lr_0 = 2.9222e-04
Loss = 1.4430e-03, PNorm = 100.3044, GNorm = 2.8395, lr_0 = 2.8277e-04
Validation rmse = 0.952194
Epoch 17
Loss = 1.4531e-03, PNorm = 100.3248, GNorm = 1.0643, lr_0 = 2.7272e-04
Loss = 1.3637e-03, PNorm = 100.3445, GNorm = 0.6357, lr_0 = 2.6389e-04
Loss = 1.1714e-03, PNorm = 100.3640, GNorm = 0.4027, lr_0 = 2.5535e-04
Validation rmse = 0.924898
Epoch 18
Loss = 1.2900e-03, PNorm = 100.3787, GNorm = 1.0772, lr_0 = 2.4709e-04
Loss = 1.1543e-03, PNorm = 100.3936, GNorm = 0.6854, lr_0 = 2.3910e-04
Loss = 1.0688e-03, PNorm = 100.4092, GNorm = 0.8867, lr_0 = 2.3136e-04
Validation rmse = 0.927893
Epoch 19
Loss = 1.1151e-03, PNorm = 100.4217, GNorm = 1.1163, lr_0 = 2.2387e-04
Loss = 1.2965e-03, PNorm = 100.4359, GNorm = 1.2613, lr_0 = 2.1663e-04
Validation rmse = 0.924224
Epoch 20
Loss = 9.8040e-04, PNorm = 100.4497, GNorm = 0.6081, lr_0 = 2.0962e-04
Loss = 1.1629e-03, PNorm = 100.4643, GNorm = 1.6331, lr_0 = 2.0283e-04
Loss = 1.1308e-03, PNorm = 100.4760, GNorm = 0.4722, lr_0 = 1.9627e-04
Validation rmse = 0.922389
Epoch 21
Loss = 1.1907e-03, PNorm = 100.4907, GNorm = 1.1716, lr_0 = 1.8992e-04
Loss = 1.1335e-03, PNorm = 100.5014, GNorm = 0.9498, lr_0 = 1.8377e-04
Validation rmse = 0.901906
Epoch 22
Loss = 1.0092e-03, PNorm = 100.5157, GNorm = 1.0601, lr_0 = 1.7783e-04
Loss = 8.2097e-04, PNorm = 100.5284, GNorm = 0.9031, lr_0 = 1.7207e-04
Loss = 1.1501e-03, PNorm = 100.5399, GNorm = 1.0487, lr_0 = 1.6651e-04
Validation rmse = 0.921551
Epoch 23
Loss = 8.6916e-04, PNorm = 100.5520, GNorm = 0.7310, lr_0 = 1.6059e-04
Loss = 1.0198e-03, PNorm = 100.5627, GNorm = 0.4120, lr_0 = 1.5539e-04
Validation rmse = 0.846721
Epoch 24
Loss = 9.7184e-04, PNorm = 100.5716, GNorm = 1.2111, lr_0 = 1.5036e-04
Loss = 1.0416e-03, PNorm = 100.5845, GNorm = 0.5461, lr_0 = 1.4550e-04
Loss = 8.7162e-04, PNorm = 100.5917, GNorm = 0.3610, lr_0 = 1.4079e-04
Validation rmse = 0.852959
Epoch 25
Loss = 8.6658e-04, PNorm = 100.5997, GNorm = 0.9504, lr_0 = 1.3623e-04
Loss = 8.8327e-04, PNorm = 100.6097, GNorm = 0.5385, lr_0 = 1.3183e-04
Loss = 8.5353e-04, PNorm = 100.6179, GNorm = 0.5079, lr_0 = 1.2756e-04
Validation rmse = 0.843947
Epoch 26
Loss = 8.9256e-04, PNorm = 100.6248, GNorm = 1.1478, lr_0 = 1.2343e-04
Loss = 8.3210e-04, PNorm = 100.6333, GNorm = 1.0291, lr_0 = 1.1944e-04
Validation rmse = 0.926165
Epoch 27
Loss = 7.9597e-04, PNorm = 100.6392, GNorm = 0.9998, lr_0 = 1.1557e-04
Loss = 9.1699e-04, PNorm = 100.6497, GNorm = 0.4974, lr_0 = 1.1183e-04
Loss = 7.8374e-04, PNorm = 100.6555, GNorm = 0.9738, lr_0 = 1.0821e-04
Validation rmse = 0.836861
Epoch 28
Loss = 1.0092e-03, PNorm = 100.6642, GNorm = 2.0118, lr_0 = 1.0437e-04
Loss = 7.7063e-04, PNorm = 100.6712, GNorm = 0.3474, lr_0 = 1.0099e-04
Validation rmse = 0.835404
Epoch 29
Loss = 4.3597e-04, PNorm = 100.6765, GNorm = 0.4282, lr_0 = 1.0000e-04
Loss = 7.8977e-04, PNorm = 100.6837, GNorm = 0.2828, lr_0 = 1.0000e-04
Loss = 7.5973e-04, PNorm = 100.6906, GNorm = 0.3117, lr_0 = 1.0000e-04
Validation rmse = 0.858330
Model 0 best validation rmse = 0.835404 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.681701
Ensemble test rmse = 0.681701
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.15000000000000002_ffn_num_layers_3_hidden_size_2300/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2300, bias=False)
      (W_h): Linear(in_features=2300, out_features=2300, bias=False)
      (W_o): Linear(in_features=2433, out_features=2300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=2300, out_features=2300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.15000000000000002, inplace=False)
    (4): Linear(in_features=2300, out_features=2300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.15000000000000002, inplace=False)
    (7): Linear(in_features=2300, out_features=1, bias=True)
  )
)
Number of parameters = 21,813,201
Moving model to cuda
Epoch 0
Loss = 2.0293e-02, PNorm = 97.7388, GNorm = 2.6923, lr_0 = 2.9800e-04
Loss = 1.3508e-02, PNorm = 97.8379, GNorm = 3.7990, lr_0 = 4.7800e-04
Validation rmse = 1.655452
Epoch 1
Loss = 9.2991e-03, PNorm = 97.9914, GNorm = 7.9241, lr_0 = 6.7600e-04
Loss = 8.2412e-03, PNorm = 98.1453, GNorm = 4.4557, lr_0 = 8.5600e-04
Loss = 8.9060e-03, PNorm = 98.3239, GNorm = 2.6804, lr_0 = 9.9344e-04
Validation rmse = 1.598161
Epoch 2
Loss = 8.1136e-03, PNorm = 98.5019, GNorm = 3.0351, lr_0 = 9.6130e-04
Loss = 6.8717e-03, PNorm = 98.6300, GNorm = 1.0825, lr_0 = 9.3019e-04
Validation rmse = 1.660600
Epoch 3
Loss = 8.6269e-03, PNorm = 98.7493, GNorm = 6.0882, lr_0 = 9.0009e-04
Loss = 4.8423e-03, PNorm = 98.8655, GNorm = 1.1917, lr_0 = 8.7096e-04
Loss = 4.7274e-03, PNorm = 98.9463, GNorm = 1.4376, lr_0 = 8.4278e-04
Validation rmse = 1.204550
Epoch 4
Loss = 3.6131e-03, PNorm = 99.0253, GNorm = 1.3732, lr_0 = 8.1551e-04
Loss = 4.7838e-03, PNorm = 99.0869, GNorm = 3.4558, lr_0 = 7.8912e-04
Validation rmse = 1.220408
Epoch 5
Loss = 3.7596e-03, PNorm = 99.1533, GNorm = 4.0595, lr_0 = 7.6358e-04
Loss = 4.0440e-03, PNorm = 99.2140, GNorm = 1.7311, lr_0 = 7.3888e-04
Loss = 4.0210e-03, PNorm = 99.2731, GNorm = 1.3981, lr_0 = 7.1497e-04
Validation rmse = 1.228717
Epoch 6
Loss = 3.4851e-03, PNorm = 99.3392, GNorm = 0.6549, lr_0 = 6.8956e-04
Loss = 3.4272e-03, PNorm = 99.3962, GNorm = 7.5511, lr_0 = 6.6725e-04
Loss = 4.1560e-03, PNorm = 99.4543, GNorm = 2.0362, lr_0 = 6.4565e-04
Validation rmse = 1.346746
Epoch 7
Loss = 3.5176e-03, PNorm = 99.5131, GNorm = 1.5658, lr_0 = 6.2476e-04
Loss = 2.6348e-03, PNorm = 99.5631, GNorm = 1.2151, lr_0 = 6.0454e-04
Validation rmse = 1.048801
Epoch 8
Loss = 2.8647e-03, PNorm = 99.6032, GNorm = 2.8839, lr_0 = 5.8498e-04
Loss = 2.2267e-03, PNorm = 99.6456, GNorm = 0.9645, lr_0 = 5.6605e-04
Loss = 2.4070e-03, PNorm = 99.6826, GNorm = 1.4533, lr_0 = 5.4774e-04
Validation rmse = 1.111483
Epoch 9
Loss = 3.7336e-03, PNorm = 99.7242, GNorm = 5.8608, lr_0 = 5.3001e-04
Loss = 2.8454e-03, PNorm = 99.7753, GNorm = 2.2911, lr_0 = 5.1286e-04
Validation rmse = 1.034632
Epoch 10
Loss = 3.0094e-03, PNorm = 99.8306, GNorm = 2.6576, lr_0 = 4.9627e-04
Loss = 2.6192e-03, PNorm = 99.8722, GNorm = 1.5686, lr_0 = 4.8021e-04
Loss = 1.8330e-03, PNorm = 99.9046, GNorm = 0.7172, lr_0 = 4.6467e-04
Validation rmse = 1.004836
Epoch 11
Loss = 1.9043e-03, PNorm = 99.9362, GNorm = 1.7586, lr_0 = 4.4963e-04
Loss = 1.7113e-03, PNorm = 99.9656, GNorm = 0.5310, lr_0 = 4.3508e-04
Validation rmse = 0.988673
Epoch 12
Loss = 1.6792e-03, PNorm = 100.0008, GNorm = 0.7928, lr_0 = 4.1962e-04
Loss = 1.3907e-03, PNorm = 100.0296, GNorm = 1.1990, lr_0 = 4.0604e-04
Loss = 1.6246e-03, PNorm = 100.0539, GNorm = 0.7479, lr_0 = 3.9290e-04
Validation rmse = 0.980575
Epoch 13
Loss = 1.5211e-03, PNorm = 100.0796, GNorm = 0.8914, lr_0 = 3.8019e-04
Loss = 1.3726e-03, PNorm = 100.0989, GNorm = 0.5976, lr_0 = 3.6789e-04
Loss = 1.6174e-03, PNorm = 100.1233, GNorm = 0.6813, lr_0 = 3.5598e-04
Validation rmse = 0.969983
Epoch 14
Loss = 1.4567e-03, PNorm = 100.1479, GNorm = 1.5764, lr_0 = 3.4446e-04
Loss = 1.2759e-03, PNorm = 100.1715, GNorm = 0.5849, lr_0 = 3.3332e-04
Validation rmse = 0.966839
Epoch 15
Loss = 8.6326e-04, PNorm = 100.1965, GNorm = 0.4509, lr_0 = 3.2253e-04
Loss = 1.5829e-03, PNorm = 100.2184, GNorm = 1.1006, lr_0 = 3.1209e-04
Loss = 1.5023e-03, PNorm = 100.2416, GNorm = 2.0940, lr_0 = 3.0200e-04
Validation rmse = 0.983739
Epoch 16
Loss = 1.3338e-03, PNorm = 100.2609, GNorm = 0.5967, lr_0 = 2.9222e-04
Loss = 1.4871e-03, PNorm = 100.2856, GNorm = 0.8721, lr_0 = 2.8277e-04
Validation rmse = 0.982408
Epoch 17
Loss = 1.1791e-03, PNorm = 100.3130, GNorm = 1.1178, lr_0 = 2.7272e-04
Loss = 1.3815e-03, PNorm = 100.3332, GNorm = 1.0446, lr_0 = 2.6389e-04
Loss = 1.4023e-03, PNorm = 100.3519, GNorm = 0.4361, lr_0 = 2.5535e-04
Validation rmse = 1.073373
Epoch 18
Loss = 1.6759e-03, PNorm = 100.3731, GNorm = 2.6319, lr_0 = 2.4709e-04
Loss = 1.2723e-03, PNorm = 100.3942, GNorm = 2.2621, lr_0 = 2.3910e-04
Loss = 1.3282e-03, PNorm = 100.4116, GNorm = 1.1730, lr_0 = 2.3136e-04
Validation rmse = 0.980875
Epoch 19
Loss = 1.0881e-03, PNorm = 100.4236, GNorm = 0.2982, lr_0 = 2.2387e-04
Loss = 1.0297e-03, PNorm = 100.4381, GNorm = 1.1227, lr_0 = 2.1663e-04
Validation rmse = 0.961027
Epoch 20
Loss = 1.0173e-03, PNorm = 100.4535, GNorm = 0.7089, lr_0 = 2.0962e-04
Loss = 1.0789e-03, PNorm = 100.4673, GNorm = 0.7993, lr_0 = 2.0283e-04
Loss = 1.1923e-03, PNorm = 100.4803, GNorm = 0.5079, lr_0 = 1.9627e-04
Validation rmse = 0.953548
Epoch 21
Loss = 9.5704e-04, PNorm = 100.4924, GNorm = 0.3921, lr_0 = 1.8992e-04
Loss = 9.4010e-04, PNorm = 100.5059, GNorm = 1.0532, lr_0 = 1.8377e-04
Validation rmse = 0.951003
Epoch 22
Loss = 1.0015e-03, PNorm = 100.5172, GNorm = 0.6597, lr_0 = 1.7783e-04
Loss = 9.1990e-04, PNorm = 100.5295, GNorm = 0.5437, lr_0 = 1.7207e-04
Loss = 9.7889e-04, PNorm = 100.5398, GNorm = 1.0690, lr_0 = 1.6651e-04
Validation rmse = 0.948258
Epoch 23
Loss = 9.9685e-04, PNorm = 100.5511, GNorm = 2.4657, lr_0 = 1.6059e-04
Loss = 1.1424e-03, PNorm = 100.5607, GNorm = 0.5592, lr_0 = 1.5539e-04
Validation rmse = 0.970815
Epoch 24
Loss = 8.5215e-04, PNorm = 100.5718, GNorm = 0.8539, lr_0 = 1.5036e-04
Loss = 1.0125e-03, PNorm = 100.5831, GNorm = 0.9822, lr_0 = 1.4550e-04
Loss = 1.0921e-03, PNorm = 100.5942, GNorm = 1.7607, lr_0 = 1.4079e-04
Validation rmse = 0.938397
Epoch 25
Loss = 9.0820e-04, PNorm = 100.6030, GNorm = 1.0961, lr_0 = 1.3623e-04
Loss = 6.7677e-04, PNorm = 100.6112, GNorm = 0.3113, lr_0 = 1.3183e-04
Loss = 1.0837e-03, PNorm = 100.6193, GNorm = 0.8454, lr_0 = 1.2756e-04
Validation rmse = 0.954055
Epoch 26
Loss = 8.1256e-04, PNorm = 100.6280, GNorm = 0.8053, lr_0 = 1.2343e-04
Loss = 8.6396e-04, PNorm = 100.6372, GNorm = 0.6538, lr_0 = 1.1944e-04
Validation rmse = 0.952394
Epoch 27
Loss = 6.9094e-04, PNorm = 100.6453, GNorm = 0.3877, lr_0 = 1.1557e-04
Loss = 7.4950e-04, PNorm = 100.6525, GNorm = 0.5350, lr_0 = 1.1183e-04
Loss = 7.6055e-04, PNorm = 100.6594, GNorm = 0.6878, lr_0 = 1.0821e-04
Validation rmse = 0.937134
Epoch 28
Loss = 6.9911e-04, PNorm = 100.6659, GNorm = 0.3264, lr_0 = 1.0437e-04
Loss = 7.7895e-04, PNorm = 100.6732, GNorm = 0.9837, lr_0 = 1.0099e-04
Validation rmse = 0.939019
Epoch 29
Loss = 7.9921e-04, PNorm = 100.6785, GNorm = 0.6124, lr_0 = 1.0000e-04
Loss = 7.4578e-04, PNorm = 100.6856, GNorm = 0.7502, lr_0 = 1.0000e-04
Loss = 9.0371e-04, PNorm = 100.6925, GNorm = 0.3807, lr_0 = 1.0000e-04
Validation rmse = 0.940864
Model 0 best validation rmse = 0.937134 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.748855
Ensemble test rmse = 0.748855
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.15000000000000002_ffn_num_layers_3_hidden_size_2300/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2300, bias=False)
      (W_h): Linear(in_features=2300, out_features=2300, bias=False)
      (W_o): Linear(in_features=2433, out_features=2300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=2300, out_features=2300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.15000000000000002, inplace=False)
    (4): Linear(in_features=2300, out_features=2300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.15000000000000002, inplace=False)
    (7): Linear(in_features=2300, out_features=1, bias=True)
  )
)
Number of parameters = 21,813,201
Moving model to cuda
Epoch 0
Loss = 1.7422e-02, PNorm = 97.7456, GNorm = 19.6923, lr_0 = 2.9800e-04
Loss = 1.4987e-02, PNorm = 97.8349, GNorm = 3.2947, lr_0 = 4.7800e-04
Validation rmse = 1.700780
Epoch 1
Loss = 9.4581e-03, PNorm = 97.9878, GNorm = 2.5245, lr_0 = 6.7600e-04
Loss = 7.7619e-03, PNorm = 98.1447, GNorm = 1.7702, lr_0 = 8.5600e-04
Loss = 7.7405e-03, PNorm = 98.3094, GNorm = 1.6483, lr_0 = 9.9344e-04
Validation rmse = 1.385775
Epoch 2
Loss = 6.8513e-03, PNorm = 98.4728, GNorm = 2.9182, lr_0 = 9.6130e-04
Loss = 7.4746e-03, PNorm = 98.6011, GNorm = 5.5627, lr_0 = 9.3019e-04
Validation rmse = 1.306700
Epoch 3
Loss = 5.8474e-03, PNorm = 98.7285, GNorm = 3.1655, lr_0 = 9.0009e-04
Loss = 5.3353e-03, PNorm = 98.8258, GNorm = 2.8120, lr_0 = 8.7096e-04
Loss = 5.7772e-03, PNorm = 98.9189, GNorm = 1.2151, lr_0 = 8.4278e-04
Validation rmse = 0.941969
Epoch 4
Loss = 4.2007e-03, PNorm = 98.9998, GNorm = 1.2445, lr_0 = 8.1551e-04
Loss = 3.7835e-03, PNorm = 99.0652, GNorm = 1.0607, lr_0 = 7.8912e-04
Validation rmse = 0.979926
Epoch 5
Loss = 3.9654e-03, PNorm = 99.1232, GNorm = 2.1691, lr_0 = 7.6358e-04
Loss = 3.7354e-03, PNorm = 99.1944, GNorm = 1.8853, lr_0 = 7.3888e-04
Loss = 3.6776e-03, PNorm = 99.2442, GNorm = 2.0872, lr_0 = 7.1497e-04
Validation rmse = 0.966394
Epoch 6
Loss = 3.6888e-03, PNorm = 99.3017, GNorm = 3.2274, lr_0 = 6.8956e-04
Loss = 4.5757e-03, PNorm = 99.3555, GNorm = 0.5393, lr_0 = 6.6725e-04
Loss = 3.8281e-03, PNorm = 99.4137, GNorm = 0.7194, lr_0 = 6.4565e-04
Validation rmse = 0.785390
Epoch 7
Loss = 2.8793e-03, PNorm = 99.4704, GNorm = 3.0691, lr_0 = 6.2476e-04
Loss = 3.0991e-03, PNorm = 99.5118, GNorm = 4.0903, lr_0 = 6.0454e-04
Validation rmse = 0.986887
Epoch 8
Loss = 1.9056e-03, PNorm = 99.5594, GNorm = 1.1658, lr_0 = 5.8498e-04
Loss = 2.8048e-03, PNorm = 99.6003, GNorm = 2.0675, lr_0 = 5.6605e-04
Loss = 2.6973e-03, PNorm = 99.6429, GNorm = 1.5069, lr_0 = 5.4774e-04
Validation rmse = 0.828460
Epoch 9
Loss = 2.2247e-03, PNorm = 99.6883, GNorm = 2.8243, lr_0 = 5.3001e-04
Loss = 2.7189e-03, PNorm = 99.7318, GNorm = 2.4350, lr_0 = 5.1286e-04
Validation rmse = 0.818038
Epoch 10
Loss = 2.3107e-03, PNorm = 99.7726, GNorm = 1.2550, lr_0 = 4.9627e-04
Loss = 1.7547e-03, PNorm = 99.8115, GNorm = 0.6950, lr_0 = 4.8021e-04
Loss = 2.2131e-03, PNorm = 99.8403, GNorm = 1.8685, lr_0 = 4.6467e-04
Validation rmse = 0.805823
Epoch 11
Loss = 2.2210e-03, PNorm = 99.8786, GNorm = 1.0530, lr_0 = 4.4963e-04
Loss = 1.5787e-03, PNorm = 99.9156, GNorm = 0.7907, lr_0 = 4.3508e-04
Validation rmse = 0.720971
Epoch 12
Loss = 1.8796e-03, PNorm = 99.9398, GNorm = 1.7322, lr_0 = 4.1962e-04
Loss = 1.7829e-03, PNorm = 99.9625, GNorm = 2.2293, lr_0 = 4.0604e-04
Loss = 2.2478e-03, PNorm = 99.9895, GNorm = 1.4757, lr_0 = 3.9290e-04
Validation rmse = 0.895433
Epoch 13
Loss = 1.8295e-03, PNorm = 100.0175, GNorm = 1.2361, lr_0 = 3.8019e-04
Loss = 1.6252e-03, PNorm = 100.0424, GNorm = 1.6049, lr_0 = 3.6789e-04
Loss = 1.8306e-03, PNorm = 100.0698, GNorm = 1.9873, lr_0 = 3.5598e-04
Validation rmse = 0.716415
Epoch 14
Loss = 1.5657e-03, PNorm = 100.0930, GNorm = 1.0781, lr_0 = 3.4446e-04
Loss = 1.4786e-03, PNorm = 100.1151, GNorm = 1.1501, lr_0 = 3.3332e-04
Validation rmse = 0.768519
Epoch 15
Loss = 6.7987e-04, PNorm = 100.1375, GNorm = 0.5603, lr_0 = 3.2253e-04
Loss = 1.5668e-03, PNorm = 100.1587, GNorm = 0.9118, lr_0 = 3.1209e-04
Loss = 1.3912e-03, PNorm = 100.1764, GNorm = 0.6242, lr_0 = 3.0200e-04
Validation rmse = 0.783381
Epoch 16
Loss = 1.1650e-03, PNorm = 100.1955, GNorm = 1.1138, lr_0 = 2.9222e-04
Loss = 1.3629e-03, PNorm = 100.2160, GNorm = 1.5841, lr_0 = 2.8277e-04
Validation rmse = 0.810147
Epoch 17
Loss = 1.3245e-03, PNorm = 100.2337, GNorm = 1.8392, lr_0 = 2.7272e-04
Loss = 1.1076e-03, PNorm = 100.2485, GNorm = 0.7365, lr_0 = 2.6389e-04
Loss = 1.4091e-03, PNorm = 100.2636, GNorm = 2.0320, lr_0 = 2.5535e-04
Validation rmse = 0.726250
Epoch 18
Loss = 1.0338e-03, PNorm = 100.2788, GNorm = 0.4904, lr_0 = 2.4709e-04
Loss = 1.1777e-03, PNorm = 100.2926, GNorm = 0.4096, lr_0 = 2.3910e-04
Loss = 1.1855e-03, PNorm = 100.3056, GNorm = 1.6939, lr_0 = 2.3136e-04
Validation rmse = 0.780693
Epoch 19
Loss = 1.0827e-03, PNorm = 100.3206, GNorm = 0.8455, lr_0 = 2.2387e-04
Loss = 1.1481e-03, PNorm = 100.3347, GNorm = 0.5287, lr_0 = 2.1663e-04
Validation rmse = 0.730243
Epoch 20
Loss = 1.2867e-03, PNorm = 100.3484, GNorm = 0.5765, lr_0 = 2.0962e-04
Loss = 1.1671e-03, PNorm = 100.3612, GNorm = 3.0492, lr_0 = 2.0283e-04
Loss = 1.1067e-03, PNorm = 100.3753, GNorm = 1.7211, lr_0 = 1.9627e-04
Validation rmse = 0.741309
Epoch 21
Loss = 1.2128e-03, PNorm = 100.3890, GNorm = 1.8834, lr_0 = 1.8992e-04
Loss = 1.0617e-03, PNorm = 100.3995, GNorm = 0.6339, lr_0 = 1.8377e-04
Validation rmse = 0.712050
Epoch 22
Loss = 1.1326e-03, PNorm = 100.4098, GNorm = 0.5927, lr_0 = 1.7783e-04
Loss = 9.6055e-04, PNorm = 100.4213, GNorm = 0.8759, lr_0 = 1.7207e-04
Loss = 1.0060e-03, PNorm = 100.4330, GNorm = 0.5038, lr_0 = 1.6651e-04
Validation rmse = 0.807432
Epoch 23
Loss = 8.2151e-04, PNorm = 100.4432, GNorm = 0.6844, lr_0 = 1.6059e-04
Loss = 9.4877e-04, PNorm = 100.4543, GNorm = 0.6303, lr_0 = 1.5539e-04
Validation rmse = 0.843476
Epoch 24
Loss = 5.7603e-04, PNorm = 100.4623, GNorm = 0.7563, lr_0 = 1.5036e-04
Loss = 1.0044e-03, PNorm = 100.4706, GNorm = 1.1865, lr_0 = 1.4550e-04
Loss = 8.9023e-04, PNorm = 100.4790, GNorm = 0.8401, lr_0 = 1.4079e-04
Validation rmse = 0.758642
Epoch 25
Loss = 7.1501e-04, PNorm = 100.4886, GNorm = 0.9390, lr_0 = 1.3623e-04
Loss = 8.3774e-04, PNorm = 100.4975, GNorm = 1.1307, lr_0 = 1.3183e-04
Loss = 9.9656e-04, PNorm = 100.5070, GNorm = 0.4884, lr_0 = 1.2756e-04
Validation rmse = 0.749461
Epoch 26
Loss = 7.5212e-04, PNorm = 100.5137, GNorm = 0.5575, lr_0 = 1.2343e-04
Loss = 8.7037e-04, PNorm = 100.5218, GNorm = 0.5652, lr_0 = 1.1944e-04
Validation rmse = 0.721369
Epoch 27
Loss = 7.4156e-04, PNorm = 100.5284, GNorm = 0.6901, lr_0 = 1.1557e-04
Loss = 9.0775e-04, PNorm = 100.5354, GNorm = 0.4881, lr_0 = 1.1183e-04
Loss = 8.8937e-04, PNorm = 100.5417, GNorm = 0.5203, lr_0 = 1.0821e-04
Validation rmse = 0.743133
Epoch 28
Loss = 7.6353e-04, PNorm = 100.5484, GNorm = 1.1203, lr_0 = 1.0437e-04
Loss = 7.3124e-04, PNorm = 100.5538, GNorm = 0.4853, lr_0 = 1.0099e-04
Validation rmse = 0.735428
Epoch 29
Loss = 5.6451e-04, PNorm = 100.5613, GNorm = 0.4081, lr_0 = 1.0000e-04
Loss = 8.4569e-04, PNorm = 100.5670, GNorm = 1.7526, lr_0 = 1.0000e-04
Loss = 8.8576e-04, PNorm = 100.5742, GNorm = 1.0012, lr_0 = 1.0000e-04
Validation rmse = 0.752824
Model 0 best validation rmse = 0.712050 on epoch 21
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.678840
Ensemble test rmse = 0.678840
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.15000000000000002_ffn_num_layers_3_hidden_size_2300/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2300, bias=False)
      (W_h): Linear(in_features=2300, out_features=2300, bias=False)
      (W_o): Linear(in_features=2433, out_features=2300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=2300, out_features=2300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.15000000000000002, inplace=False)
    (4): Linear(in_features=2300, out_features=2300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.15000000000000002, inplace=False)
    (7): Linear(in_features=2300, out_features=1, bias=True)
  )
)
Number of parameters = 21,813,201
Moving model to cuda
Epoch 0
Loss = 2.1568e-02, PNorm = 97.7409, GNorm = 3.4159, lr_0 = 2.9800e-04
Loss = 1.5936e-02, PNorm = 97.8404, GNorm = 1.1364, lr_0 = 4.7800e-04
Validation rmse = 2.169146
Epoch 1
Loss = 1.3009e-02, PNorm = 98.0038, GNorm = 1.2595, lr_0 = 6.7600e-04
Loss = 8.2711e-03, PNorm = 98.1754, GNorm = 1.0101, lr_0 = 8.5600e-04
Loss = 6.7855e-03, PNorm = 98.3386, GNorm = 4.8482, lr_0 = 9.9344e-04
Validation rmse = 1.577021
Epoch 2
Loss = 8.1739e-03, PNorm = 98.4974, GNorm = 0.9663, lr_0 = 9.6130e-04
Loss = 6.3959e-03, PNorm = 98.6446, GNorm = 0.8626, lr_0 = 9.3019e-04
Validation rmse = 1.327643
Epoch 3
Loss = 4.3893e-03, PNorm = 98.7594, GNorm = 3.2325, lr_0 = 9.0009e-04
Loss = 4.3457e-03, PNorm = 98.8460, GNorm = 1.0724, lr_0 = 8.7096e-04
Loss = 4.3989e-03, PNorm = 98.9301, GNorm = 0.4753, lr_0 = 8.4278e-04
Validation rmse = 1.103800
Epoch 4
Loss = 4.2450e-03, PNorm = 99.0002, GNorm = 3.7770, lr_0 = 8.1551e-04
Loss = 4.2539e-03, PNorm = 99.0708, GNorm = 4.1859, lr_0 = 7.8912e-04
Validation rmse = 1.386208
Epoch 5
Loss = 3.4138e-03, PNorm = 99.1320, GNorm = 2.8482, lr_0 = 7.6358e-04
Loss = 3.1079e-03, PNorm = 99.1864, GNorm = 1.8117, lr_0 = 7.3888e-04
Loss = 3.9023e-03, PNorm = 99.2351, GNorm = 1.1987, lr_0 = 7.1497e-04
Validation rmse = 1.110072
Epoch 6
Loss = 2.5260e-03, PNorm = 99.2953, GNorm = 1.0000, lr_0 = 6.8956e-04
Loss = 2.5805e-03, PNorm = 99.3495, GNorm = 0.9709, lr_0 = 6.6725e-04
Loss = 2.9032e-03, PNorm = 99.3863, GNorm = 0.7949, lr_0 = 6.4565e-04
Validation rmse = 1.008765
Epoch 7
Loss = 2.6305e-03, PNorm = 99.4355, GNorm = 2.9628, lr_0 = 6.2476e-04
Loss = 2.4720e-03, PNorm = 99.4774, GNorm = 0.8805, lr_0 = 6.0454e-04
Validation rmse = 1.024012
Epoch 8
Loss = 2.1778e-03, PNorm = 99.5136, GNorm = 1.1281, lr_0 = 5.8498e-04
Loss = 2.7601e-03, PNorm = 99.5573, GNorm = 1.0602, lr_0 = 5.6605e-04
Loss = 1.9493e-03, PNorm = 99.5972, GNorm = 1.3866, lr_0 = 5.4774e-04
Validation rmse = 1.052213
Epoch 9
Loss = 2.0317e-03, PNorm = 99.6323, GNorm = 0.4917, lr_0 = 5.3001e-04
Loss = 2.1613e-03, PNorm = 99.6733, GNorm = 0.8758, lr_0 = 5.1286e-04
Validation rmse = 0.957261
Epoch 10
Loss = 1.8160e-03, PNorm = 99.7064, GNorm = 2.1719, lr_0 = 4.9627e-04
Loss = 2.7527e-03, PNorm = 99.7423, GNorm = 2.7921, lr_0 = 4.8021e-04
Loss = 2.8864e-03, PNorm = 99.7810, GNorm = 2.3912, lr_0 = 4.6467e-04
Validation rmse = 1.019005
Epoch 11
Loss = 2.3924e-03, PNorm = 99.8184, GNorm = 2.6026, lr_0 = 4.4963e-04
Loss = 1.8125e-03, PNorm = 99.8545, GNorm = 0.4910, lr_0 = 4.3508e-04
Validation rmse = 0.980248
Epoch 12
Loss = 1.5740e-03, PNorm = 99.8854, GNorm = 1.7780, lr_0 = 4.1962e-04
Loss = 1.8961e-03, PNorm = 99.9112, GNorm = 2.8770, lr_0 = 4.0604e-04
Loss = 2.0698e-03, PNorm = 99.9447, GNorm = 2.6935, lr_0 = 3.9290e-04
Validation rmse = 0.973183
Epoch 13
Loss = 1.7746e-03, PNorm = 99.9717, GNorm = 1.9375, lr_0 = 3.8019e-04
Loss = 1.8418e-03, PNorm = 100.0009, GNorm = 0.7824, lr_0 = 3.6789e-04
Loss = 1.6282e-03, PNorm = 100.0279, GNorm = 1.1059, lr_0 = 3.5598e-04
Validation rmse = 0.939804
Epoch 14
Loss = 1.3783e-03, PNorm = 100.0499, GNorm = 0.6220, lr_0 = 3.4446e-04
Loss = 1.5036e-03, PNorm = 100.0714, GNorm = 0.5658, lr_0 = 3.3332e-04
Validation rmse = 0.928095
Epoch 15
Loss = 1.6045e-03, PNorm = 100.0914, GNorm = 0.9469, lr_0 = 3.2253e-04
Loss = 1.6078e-03, PNorm = 100.1140, GNorm = 2.4032, lr_0 = 3.1209e-04
Loss = 1.4299e-03, PNorm = 100.1363, GNorm = 0.7733, lr_0 = 3.0200e-04
Validation rmse = 0.984944
Epoch 16
Loss = 1.5384e-03, PNorm = 100.1494, GNorm = 0.7747, lr_0 = 2.9222e-04
Loss = 1.4089e-03, PNorm = 100.1697, GNorm = 0.6959, lr_0 = 2.8277e-04
Validation rmse = 0.977022
Epoch 17
Loss = 8.9396e-04, PNorm = 100.1928, GNorm = 0.9675, lr_0 = 2.7272e-04
Loss = 1.4939e-03, PNorm = 100.2118, GNorm = 0.6546, lr_0 = 2.6389e-04
Loss = 1.2997e-03, PNorm = 100.2289, GNorm = 0.8353, lr_0 = 2.5535e-04
Validation rmse = 0.908655
Epoch 18
Loss = 1.0543e-03, PNorm = 100.2435, GNorm = 1.3259, lr_0 = 2.4709e-04
Loss = 1.3139e-03, PNorm = 100.2549, GNorm = 0.6635, lr_0 = 2.3910e-04
Loss = 1.5483e-03, PNorm = 100.2714, GNorm = 0.6413, lr_0 = 2.3136e-04
Validation rmse = 0.905475
Epoch 19
Loss = 1.1644e-03, PNorm = 100.2888, GNorm = 0.5248, lr_0 = 2.2387e-04
Loss = 1.0500e-03, PNorm = 100.3020, GNorm = 1.9798, lr_0 = 2.1663e-04
Validation rmse = 0.916916
Epoch 20
Loss = 1.1943e-03, PNorm = 100.3138, GNorm = 1.3342, lr_0 = 2.0962e-04
Loss = 1.0804e-03, PNorm = 100.3275, GNorm = 0.4213, lr_0 = 2.0283e-04
Loss = 1.2399e-03, PNorm = 100.3408, GNorm = 1.6857, lr_0 = 1.9627e-04
Validation rmse = 0.908487
Epoch 21
Loss = 1.0419e-03, PNorm = 100.3529, GNorm = 0.9183, lr_0 = 1.8992e-04
Loss = 1.0839e-03, PNorm = 100.3635, GNorm = 0.7087, lr_0 = 1.8377e-04
Validation rmse = 0.934171
Epoch 22
Loss = 1.0444e-03, PNorm = 100.3754, GNorm = 0.6920, lr_0 = 1.7783e-04
Loss = 9.8415e-04, PNorm = 100.3883, GNorm = 0.5281, lr_0 = 1.7207e-04
Loss = 1.1032e-03, PNorm = 100.4008, GNorm = 0.7787, lr_0 = 1.6651e-04
Validation rmse = 0.923553
Epoch 23
Loss = 9.5671e-04, PNorm = 100.4123, GNorm = 0.4032, lr_0 = 1.6059e-04
Loss = 9.7972e-04, PNorm = 100.4223, GNorm = 0.4786, lr_0 = 1.5539e-04
Validation rmse = 0.914795
Epoch 24
Loss = 7.6551e-04, PNorm = 100.4334, GNorm = 0.7562, lr_0 = 1.5036e-04
Loss = 1.0946e-03, PNorm = 100.4449, GNorm = 0.8308, lr_0 = 1.4550e-04
Loss = 8.3738e-04, PNorm = 100.4542, GNorm = 0.7367, lr_0 = 1.4079e-04
Validation rmse = 0.918770
Epoch 25
Loss = 8.0972e-04, PNorm = 100.4615, GNorm = 0.7343, lr_0 = 1.3623e-04
Loss = 9.5787e-04, PNorm = 100.4694, GNorm = 0.6107, lr_0 = 1.3183e-04
Loss = 9.2830e-04, PNorm = 100.4790, GNorm = 0.9954, lr_0 = 1.2756e-04
Validation rmse = 0.936001
Epoch 26
Loss = 9.6375e-04, PNorm = 100.4879, GNorm = 0.6253, lr_0 = 1.2343e-04
Loss = 8.9152e-04, PNorm = 100.4965, GNorm = 1.1874, lr_0 = 1.1944e-04
Validation rmse = 0.941983
Epoch 27
Loss = 1.0014e-03, PNorm = 100.5048, GNorm = 1.3040, lr_0 = 1.1557e-04
Loss = 8.7706e-04, PNorm = 100.5116, GNorm = 0.6838, lr_0 = 1.1183e-04
Loss = 9.0814e-04, PNorm = 100.5183, GNorm = 0.6887, lr_0 = 1.0821e-04
Validation rmse = 0.945451
Epoch 28
Loss = 8.6042e-04, PNorm = 100.5268, GNorm = 0.9213, lr_0 = 1.0437e-04
Loss = 7.5468e-04, PNorm = 100.5334, GNorm = 0.6783, lr_0 = 1.0099e-04
Validation rmse = 0.945885
Epoch 29
Loss = 5.2102e-04, PNorm = 100.5394, GNorm = 0.6031, lr_0 = 1.0000e-04
Loss = 8.3227e-04, PNorm = 100.5443, GNorm = 0.8251, lr_0 = 1.0000e-04
Loss = 8.2506e-04, PNorm = 100.5514, GNorm = 1.1345, lr_0 = 1.0000e-04
Validation rmse = 0.966301
Model 0 best validation rmse = 0.905475 on epoch 18
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.725200
Ensemble test rmse = 0.725200
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.15000000000000002,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.15000000000000002_ffn_num_layers_3_hidden_size_2300/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.15000000000000002, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2300, bias=False)
      (W_h): Linear(in_features=2300, out_features=2300, bias=False)
      (W_o): Linear(in_features=2433, out_features=2300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.15000000000000002, inplace=False)
    (1): Linear(in_features=2300, out_features=2300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.15000000000000002, inplace=False)
    (4): Linear(in_features=2300, out_features=2300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.15000000000000002, inplace=False)
    (7): Linear(in_features=2300, out_features=1, bias=True)
  )
)
Number of parameters = 21,813,201
Moving model to cuda
Epoch 0
Loss = 1.8388e-02, PNorm = 97.7449, GNorm = 2.5166, lr_0 = 2.9800e-04
Loss = 1.4370e-02, PNorm = 97.8379, GNorm = 2.0798, lr_0 = 4.7800e-04
Validation rmse = 1.600979
Epoch 1
Loss = 8.1980e-03, PNorm = 97.9815, GNorm = 5.7507, lr_0 = 6.7600e-04
Loss = 8.2013e-03, PNorm = 98.1270, GNorm = 1.2921, lr_0 = 8.5600e-04
Loss = 6.9928e-03, PNorm = 98.2821, GNorm = 1.3670, lr_0 = 9.9344e-04
Validation rmse = 1.228730
Epoch 2
Loss = 8.1241e-03, PNorm = 98.4380, GNorm = 4.3534, lr_0 = 9.6130e-04
Loss = 5.4352e-03, PNorm = 98.5832, GNorm = 1.7866, lr_0 = 9.3019e-04
Validation rmse = 1.106221
Epoch 3
Loss = 3.3776e-03, PNorm = 98.6963, GNorm = 1.6906, lr_0 = 9.0009e-04
Loss = 4.4419e-03, PNorm = 98.7937, GNorm = 2.7967, lr_0 = 8.7096e-04
Loss = 5.1557e-03, PNorm = 98.8904, GNorm = 3.9094, lr_0 = 8.4278e-04
Validation rmse = 1.134819
Epoch 4
Loss = 4.4556e-03, PNorm = 98.9733, GNorm = 0.6354, lr_0 = 8.1551e-04
Loss = 5.1047e-03, PNorm = 99.0522, GNorm = 2.3353, lr_0 = 7.8912e-04
Validation rmse = 1.283678
Epoch 5
Loss = 3.3849e-03, PNorm = 99.1243, GNorm = 1.1681, lr_0 = 7.6358e-04
Loss = 4.3666e-03, PNorm = 99.1889, GNorm = 1.6905, lr_0 = 7.3888e-04
Loss = 2.8470e-03, PNorm = 99.2355, GNorm = 1.7284, lr_0 = 7.1497e-04
Validation rmse = 1.035895
Epoch 6
Loss = 2.5739e-03, PNorm = 99.2948, GNorm = 1.0395, lr_0 = 6.8956e-04
Loss = 3.4275e-03, PNorm = 99.3437, GNorm = 2.3003, lr_0 = 6.6725e-04
Loss = 2.5091e-03, PNorm = 99.3868, GNorm = 4.0425, lr_0 = 6.4565e-04
Validation rmse = 0.988771
Epoch 7
Loss = 2.6442e-03, PNorm = 99.4337, GNorm = 1.2994, lr_0 = 6.2476e-04
Loss = 2.5713e-03, PNorm = 99.4719, GNorm = 1.0496, lr_0 = 6.0454e-04
Validation rmse = 0.925834
Epoch 8
Loss = 2.4325e-03, PNorm = 99.5190, GNorm = 0.5426, lr_0 = 5.8498e-04
Loss = 2.4253e-03, PNorm = 99.5638, GNorm = 2.7093, lr_0 = 5.6605e-04
Loss = 2.1751e-03, PNorm = 99.5999, GNorm = 1.4168, lr_0 = 5.4774e-04
Validation rmse = 0.868277
Epoch 9
Loss = 1.7579e-03, PNorm = 99.6351, GNorm = 0.7528, lr_0 = 5.3001e-04
Loss = 1.8063e-03, PNorm = 99.6696, GNorm = 0.7897, lr_0 = 5.1286e-04
Validation rmse = 0.842917
Epoch 10
Loss = 1.6323e-03, PNorm = 99.7125, GNorm = 0.8543, lr_0 = 4.9627e-04
Loss = 2.0515e-03, PNorm = 99.7443, GNorm = 1.7508, lr_0 = 4.8021e-04
Loss = 2.2769e-03, PNorm = 99.7757, GNorm = 1.6357, lr_0 = 4.6467e-04
Validation rmse = 1.011741
Epoch 11
Loss = 2.3665e-03, PNorm = 99.8147, GNorm = 1.0450, lr_0 = 4.4963e-04
Loss = 1.9034e-03, PNorm = 99.8528, GNorm = 1.1866, lr_0 = 4.3508e-04
Validation rmse = 0.830470
Epoch 12
Loss = 1.3590e-03, PNorm = 99.8833, GNorm = 0.6099, lr_0 = 4.1962e-04
Loss = 1.5571e-03, PNorm = 99.9095, GNorm = 0.4959, lr_0 = 4.0604e-04
Loss = 1.3994e-03, PNorm = 99.9339, GNorm = 0.6100, lr_0 = 3.9290e-04
Validation rmse = 0.816288
Epoch 13
Loss = 1.5935e-03, PNorm = 99.9551, GNorm = 1.4433, lr_0 = 3.8019e-04
Loss = 1.4264e-03, PNorm = 99.9840, GNorm = 1.2924, lr_0 = 3.6789e-04
Loss = 1.5267e-03, PNorm = 100.0066, GNorm = 1.3511, lr_0 = 3.5598e-04
Validation rmse = 0.811350
Epoch 14
Loss = 1.5656e-03, PNorm = 100.0328, GNorm = 1.2284, lr_0 = 3.4446e-04
Loss = 1.2352e-03, PNorm = 100.0613, GNorm = 1.1131, lr_0 = 3.3332e-04
Validation rmse = 0.929609
Epoch 15
Loss = 1.6511e-03, PNorm = 100.0813, GNorm = 0.8141, lr_0 = 3.2253e-04
Loss = 1.5065e-03, PNorm = 100.1051, GNorm = 0.6018, lr_0 = 3.1209e-04
Loss = 1.2022e-03, PNorm = 100.1237, GNorm = 1.3114, lr_0 = 3.0200e-04
Validation rmse = 0.819190
Epoch 16
Loss = 1.2326e-03, PNorm = 100.1387, GNorm = 0.7687, lr_0 = 2.9222e-04
Loss = 1.2482e-03, PNorm = 100.1558, GNorm = 0.4628, lr_0 = 2.8277e-04
Validation rmse = 0.776342
Epoch 17
Loss = 1.0311e-03, PNorm = 100.1783, GNorm = 0.4594, lr_0 = 2.7272e-04
Loss = 1.0777e-03, PNorm = 100.1929, GNorm = 0.3612, lr_0 = 2.6389e-04
Loss = 1.1099e-03, PNorm = 100.2073, GNorm = 0.5778, lr_0 = 2.5535e-04
Validation rmse = 0.776201
Epoch 18
Loss = 1.2991e-03, PNorm = 100.2260, GNorm = 0.8968, lr_0 = 2.4709e-04
Loss = 1.2218e-03, PNorm = 100.2420, GNorm = 0.8778, lr_0 = 2.3910e-04
Loss = 1.1268e-03, PNorm = 100.2550, GNorm = 0.7015, lr_0 = 2.3136e-04
Validation rmse = 0.778722
Epoch 19
Loss = 1.4094e-03, PNorm = 100.2707, GNorm = 1.5788, lr_0 = 2.2387e-04
Loss = 1.1476e-03, PNorm = 100.2859, GNorm = 0.7682, lr_0 = 2.1663e-04
Validation rmse = 0.757564
Epoch 20
Loss = 6.8661e-04, PNorm = 100.2999, GNorm = 0.7703, lr_0 = 2.0962e-04
Loss = 1.3479e-03, PNorm = 100.3117, GNorm = 1.7250, lr_0 = 2.0283e-04
Loss = 9.5645e-04, PNorm = 100.3248, GNorm = 0.4508, lr_0 = 1.9627e-04
Validation rmse = 0.778375
Epoch 21
Loss = 9.5268e-04, PNorm = 100.3348, GNorm = 0.4194, lr_0 = 1.8992e-04
Loss = 1.0965e-03, PNorm = 100.3479, GNorm = 0.4788, lr_0 = 1.8377e-04
Validation rmse = 0.743517
Epoch 22
Loss = 6.3976e-04, PNorm = 100.3595, GNorm = 0.7034, lr_0 = 1.7783e-04
Loss = 8.6510e-04, PNorm = 100.3707, GNorm = 0.4207, lr_0 = 1.7207e-04
Loss = 1.1062e-03, PNorm = 100.3796, GNorm = 0.5854, lr_0 = 1.6651e-04
Validation rmse = 0.741551
Epoch 23
Loss = 1.0417e-03, PNorm = 100.3871, GNorm = 0.3105, lr_0 = 1.6059e-04
Loss = 1.0469e-03, PNorm = 100.3971, GNorm = 1.3675, lr_0 = 1.5539e-04
Validation rmse = 0.752563
Epoch 24
Loss = 1.0120e-03, PNorm = 100.4090, GNorm = 0.9046, lr_0 = 1.5036e-04
Loss = 8.5844e-04, PNorm = 100.4194, GNorm = 0.9584, lr_0 = 1.4550e-04
Loss = 9.5161e-04, PNorm = 100.4275, GNorm = 1.5827, lr_0 = 1.4079e-04
Validation rmse = 0.749515
Epoch 25
Loss = 8.5248e-04, PNorm = 100.4352, GNorm = 0.5622, lr_0 = 1.3623e-04
Loss = 8.6149e-04, PNorm = 100.4424, GNorm = 1.3927, lr_0 = 1.3183e-04
Loss = 9.5124e-04, PNorm = 100.4500, GNorm = 1.5155, lr_0 = 1.2756e-04
Validation rmse = 0.727394
Epoch 26
Loss = 9.6415e-04, PNorm = 100.4598, GNorm = 0.8627, lr_0 = 1.2343e-04
Loss = 8.3924e-04, PNorm = 100.4679, GNorm = 0.7955, lr_0 = 1.1944e-04
Validation rmse = 0.758967
Epoch 27
Loss = 7.9310e-04, PNorm = 100.4763, GNorm = 1.3990, lr_0 = 1.1557e-04
Loss = 8.5980e-04, PNorm = 100.4839, GNorm = 0.9436, lr_0 = 1.1183e-04
Loss = 8.1356e-04, PNorm = 100.4909, GNorm = 0.8868, lr_0 = 1.0821e-04
Validation rmse = 0.770034
Epoch 28
Loss = 8.8079e-04, PNorm = 100.4980, GNorm = 1.0447, lr_0 = 1.0437e-04
Loss = 8.6079e-04, PNorm = 100.5035, GNorm = 0.5428, lr_0 = 1.0099e-04
Validation rmse = 0.812239
Epoch 29
Loss = 8.4540e-04, PNorm = 100.5111, GNorm = 1.2285, lr_0 = 1.0000e-04
Loss = 8.3106e-04, PNorm = 100.5163, GNorm = 0.8530, lr_0 = 1.0000e-04
Loss = 7.4112e-04, PNorm = 100.5212, GNorm = 0.6173, lr_0 = 1.0000e-04
Validation rmse = 0.741135
Model 0 best validation rmse = 0.727394 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.678984
Ensemble test rmse = 0.678984
10-fold cross validation
	Seed 0 ==> test rmse = 0.762214
	Seed 1 ==> test rmse = 0.642158
	Seed 2 ==> test rmse = 0.689468
	Seed 3 ==> test rmse = 0.859463
	Seed 4 ==> test rmse = 1.006945
	Seed 5 ==> test rmse = 0.681701
	Seed 6 ==> test rmse = 0.748855
	Seed 7 ==> test rmse = 0.678840
	Seed 8 ==> test rmse = 0.725200
	Seed 9 ==> test rmse = 0.678984
Overall test rmse = 0.747383 +/- 0.104291
Elapsed time = 0:10:38
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.30000000000000004_ffn_num_layers_2_hidden_size_1400/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=1400, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,276,201
Moving model to cuda
Epoch 0
Loss = 1.7154e-02, PNorm = 67.3377, GNorm = 3.0414, lr_0 = 2.9800e-04
Loss = 1.4405e-02, PNorm = 67.4013, GNorm = 10.9277, lr_0 = 4.7800e-04
Validation rmse = 1.486350
Epoch 1
Loss = 1.0022e-02, PNorm = 67.5009, GNorm = 5.3275, lr_0 = 6.7600e-04
Loss = 1.5463e-02, PNorm = 67.6103, GNorm = 7.1907, lr_0 = 8.5600e-04
Loss = 1.0240e-02, PNorm = 67.7634, GNorm = 4.9166, lr_0 = 9.9344e-04
Validation rmse = 1.567413
Epoch 2
Loss = 8.8595e-03, PNorm = 67.8896, GNorm = 3.1489, lr_0 = 9.6130e-04
Loss = 7.5326e-03, PNorm = 68.0048, GNorm = 2.7027, lr_0 = 9.3019e-04
Validation rmse = 1.362492
Epoch 3
Loss = 6.7854e-03, PNorm = 68.1098, GNorm = 2.2058, lr_0 = 9.0009e-04
Loss = 6.2857e-03, PNorm = 68.2067, GNorm = 1.5371, lr_0 = 8.7096e-04
Loss = 4.9968e-03, PNorm = 68.2768, GNorm = 1.8613, lr_0 = 8.4278e-04
Validation rmse = 1.080414
Epoch 4
Loss = 3.9687e-03, PNorm = 68.3472, GNorm = 0.8416, lr_0 = 8.1551e-04
Loss = 5.0192e-03, PNorm = 68.4014, GNorm = 1.0634, lr_0 = 7.8912e-04
Validation rmse = 1.024956
Epoch 5
Loss = 3.3586e-03, PNorm = 68.4581, GNorm = 1.2363, lr_0 = 7.6358e-04
Loss = 4.0995e-03, PNorm = 68.5232, GNorm = 1.8509, lr_0 = 7.3888e-04
Loss = 4.6721e-03, PNorm = 68.5721, GNorm = 3.4956, lr_0 = 7.1497e-04
Validation rmse = 1.130267
Epoch 6
Loss = 4.1687e-03, PNorm = 68.6323, GNorm = 3.0659, lr_0 = 6.8956e-04
Loss = 4.3812e-03, PNorm = 68.6850, GNorm = 1.3818, lr_0 = 6.6725e-04
Loss = 4.5824e-03, PNorm = 68.7182, GNorm = 5.9253, lr_0 = 6.4565e-04
Validation rmse = 1.142968
Epoch 7
Loss = 3.7772e-03, PNorm = 68.7622, GNorm = 2.8507, lr_0 = 6.2476e-04
Loss = 3.6975e-03, PNorm = 68.8039, GNorm = 3.3123, lr_0 = 6.0454e-04
Validation rmse = 1.023351
Epoch 8
Loss = 2.5431e-03, PNorm = 68.8355, GNorm = 1.0045, lr_0 = 5.8498e-04
Loss = 4.0139e-03, PNorm = 68.8600, GNorm = 4.0536, lr_0 = 5.6605e-04
Loss = 3.5601e-03, PNorm = 68.8976, GNorm = 1.8607, lr_0 = 5.4774e-04
Validation rmse = 0.979307
Epoch 9
Loss = 2.6509e-03, PNorm = 68.9329, GNorm = 1.0106, lr_0 = 5.3001e-04
Loss = 3.2835e-03, PNorm = 68.9619, GNorm = 3.8314, lr_0 = 5.1286e-04
Validation rmse = 0.955081
Epoch 10
Loss = 3.1677e-03, PNorm = 68.9890, GNorm = 1.1473, lr_0 = 4.9627e-04
Loss = 3.0905e-03, PNorm = 69.0213, GNorm = 3.6573, lr_0 = 4.8021e-04
Loss = 3.2026e-03, PNorm = 69.0481, GNorm = 1.8948, lr_0 = 4.6467e-04
Validation rmse = 0.994809
Epoch 11
Loss = 3.0576e-03, PNorm = 69.0710, GNorm = 0.9678, lr_0 = 4.4963e-04
Loss = 2.4309e-03, PNorm = 69.0936, GNorm = 0.4579, lr_0 = 4.3508e-04
Validation rmse = 0.946072
Epoch 12
Loss = 2.4823e-03, PNorm = 69.1145, GNorm = 1.4644, lr_0 = 4.1962e-04
Loss = 2.6834e-03, PNorm = 69.1339, GNorm = 1.2912, lr_0 = 4.0604e-04
Loss = 2.6548e-03, PNorm = 69.1559, GNorm = 1.6333, lr_0 = 3.9290e-04
Validation rmse = 0.878335
Epoch 13
Loss = 3.0086e-03, PNorm = 69.1773, GNorm = 4.1543, lr_0 = 3.8019e-04
Loss = 3.1260e-03, PNorm = 69.2018, GNorm = 2.5598, lr_0 = 3.6789e-04
Loss = 2.3614e-03, PNorm = 69.2267, GNorm = 1.4631, lr_0 = 3.5598e-04
Validation rmse = 0.911068
Epoch 14
Loss = 2.5210e-03, PNorm = 69.2441, GNorm = 0.7527, lr_0 = 3.4446e-04
Loss = 2.2505e-03, PNorm = 69.2607, GNorm = 1.9760, lr_0 = 3.3332e-04
Validation rmse = 0.893686
Epoch 15
Loss = 2.0324e-03, PNorm = 69.2713, GNorm = 3.1521, lr_0 = 3.2253e-04
Loss = 2.7858e-03, PNorm = 69.2856, GNorm = 2.6764, lr_0 = 3.1209e-04
Loss = 2.3162e-03, PNorm = 69.3028, GNorm = 1.3287, lr_0 = 3.0200e-04
Validation rmse = 0.874499
Epoch 16
Loss = 2.2666e-03, PNorm = 69.3197, GNorm = 2.2235, lr_0 = 2.9222e-04
Loss = 2.2054e-03, PNorm = 69.3382, GNorm = 3.0581, lr_0 = 2.8277e-04
Validation rmse = 0.860658
Epoch 17
Loss = 1.9019e-03, PNorm = 69.3507, GNorm = 1.2128, lr_0 = 2.7272e-04
Loss = 2.0975e-03, PNorm = 69.3628, GNorm = 2.5882, lr_0 = 2.6389e-04
Loss = 2.1042e-03, PNorm = 69.3773, GNorm = 0.8472, lr_0 = 2.5535e-04
Validation rmse = 0.858534
Epoch 18
Loss = 2.2703e-03, PNorm = 69.3894, GNorm = 1.8920, lr_0 = 2.4709e-04
Loss = 2.0974e-03, PNorm = 69.4025, GNorm = 1.8141, lr_0 = 2.3910e-04
Loss = 1.9680e-03, PNorm = 69.4125, GNorm = 0.8662, lr_0 = 2.3136e-04
Validation rmse = 0.828352
Epoch 19
Loss = 1.9531e-03, PNorm = 69.4245, GNorm = 1.0287, lr_0 = 2.2387e-04
Loss = 2.3013e-03, PNorm = 69.4343, GNorm = 0.7897, lr_0 = 2.1663e-04
Validation rmse = 0.884490
Epoch 20
Loss = 1.7090e-03, PNorm = 69.4428, GNorm = 1.0974, lr_0 = 2.0962e-04
Loss = 2.1477e-03, PNorm = 69.4497, GNorm = 0.9268, lr_0 = 2.0283e-04
Loss = 1.9601e-03, PNorm = 69.4610, GNorm = 0.8770, lr_0 = 1.9627e-04
Validation rmse = 0.834728
Epoch 21
Loss = 1.8584e-03, PNorm = 69.4722, GNorm = 2.1917, lr_0 = 1.8992e-04
Loss = 1.7501e-03, PNorm = 69.4788, GNorm = 1.0511, lr_0 = 1.8377e-04
Validation rmse = 0.862510
Epoch 22
Loss = 1.7398e-03, PNorm = 69.4875, GNorm = 1.4961, lr_0 = 1.7783e-04
Loss = 1.8220e-03, PNorm = 69.4982, GNorm = 0.4958, lr_0 = 1.7207e-04
Loss = 1.8593e-03, PNorm = 69.5069, GNorm = 0.9234, lr_0 = 1.6651e-04
Validation rmse = 0.862431
Epoch 23
Loss = 1.7913e-03, PNorm = 69.5140, GNorm = 1.1205, lr_0 = 1.6059e-04
Loss = 1.9591e-03, PNorm = 69.5209, GNorm = 1.2039, lr_0 = 1.5539e-04
Validation rmse = 0.832043
Epoch 24
Loss = 1.4836e-03, PNorm = 69.5291, GNorm = 1.9695, lr_0 = 1.5036e-04
Loss = 1.6152e-03, PNorm = 69.5345, GNorm = 0.9795, lr_0 = 1.4550e-04
Loss = 1.6233e-03, PNorm = 69.5399, GNorm = 2.3876, lr_0 = 1.4079e-04
Validation rmse = 0.868398
Epoch 25
Loss = 1.6765e-03, PNorm = 69.5459, GNorm = 0.7641, lr_0 = 1.3623e-04
Loss = 1.7243e-03, PNorm = 69.5502, GNorm = 0.9920, lr_0 = 1.3183e-04
Loss = 1.7716e-03, PNorm = 69.5562, GNorm = 0.9533, lr_0 = 1.2756e-04
Validation rmse = 0.851324
Epoch 26
Loss = 1.4488e-03, PNorm = 69.5619, GNorm = 0.5917, lr_0 = 1.2343e-04
Loss = 1.7652e-03, PNorm = 69.5643, GNorm = 0.8880, lr_0 = 1.1944e-04
Validation rmse = 0.846084
Epoch 27
Loss = 1.5698e-03, PNorm = 69.5686, GNorm = 0.7443, lr_0 = 1.1557e-04
Loss = 1.6977e-03, PNorm = 69.5738, GNorm = 1.1857, lr_0 = 1.1183e-04
Loss = 1.4710e-03, PNorm = 69.5788, GNorm = 0.5736, lr_0 = 1.0821e-04
Validation rmse = 0.836848
Epoch 28
Loss = 1.9142e-03, PNorm = 69.5827, GNorm = 2.8280, lr_0 = 1.0437e-04
Loss = 1.4093e-03, PNorm = 69.5883, GNorm = 0.6287, lr_0 = 1.0099e-04
Validation rmse = 0.843092
Epoch 29
Loss = 1.7168e-03, PNorm = 69.5916, GNorm = 1.9582, lr_0 = 1.0000e-04
Loss = 1.5515e-03, PNorm = 69.5968, GNorm = 1.5055, lr_0 = 1.0000e-04
Loss = 1.8571e-03, PNorm = 69.6018, GNorm = 2.0387, lr_0 = 1.0000e-04
Validation rmse = 0.827101
Model 0 best validation rmse = 0.827101 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.761586
Ensemble test rmse = 0.761586
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.30000000000000004_ffn_num_layers_2_hidden_size_1400/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=1400, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,276,201
Moving model to cuda
Epoch 0
Loss = 2.0288e-02, PNorm = 67.3346, GNorm = 4.3849, lr_0 = 2.9800e-04
Loss = 1.3972e-02, PNorm = 67.3916, GNorm = 3.5343, lr_0 = 4.7800e-04
Validation rmse = 1.725984
Epoch 1
Loss = 1.1444e-02, PNorm = 67.4841, GNorm = 5.9915, lr_0 = 6.7600e-04
Loss = 1.0605e-02, PNorm = 67.6050, GNorm = 4.3967, lr_0 = 8.5600e-04
Loss = 7.5735e-03, PNorm = 67.7387, GNorm = 2.2737, lr_0 = 9.9344e-04
Validation rmse = 1.551689
Epoch 2
Loss = 8.5906e-03, PNorm = 67.8862, GNorm = 5.6832, lr_0 = 9.6130e-04
Loss = 7.7861e-03, PNorm = 68.0124, GNorm = 1.6793, lr_0 = 9.3019e-04
Validation rmse = 1.262758
Epoch 3
Loss = 7.3650e-03, PNorm = 68.1302, GNorm = 5.8738, lr_0 = 9.0009e-04
Loss = 7.6024e-03, PNorm = 68.2277, GNorm = 3.3279, lr_0 = 8.7096e-04
Loss = 5.8974e-03, PNorm = 68.3148, GNorm = 1.5530, lr_0 = 8.4278e-04
Validation rmse = 1.119980
Epoch 4
Loss = 5.6492e-03, PNorm = 68.3873, GNorm = 2.3746, lr_0 = 8.1551e-04
Loss = 4.1096e-03, PNorm = 68.4573, GNorm = 2.5411, lr_0 = 7.8912e-04
Validation rmse = 1.025524
Epoch 5
Loss = 2.9865e-03, PNorm = 68.5165, GNorm = 1.0443, lr_0 = 7.6358e-04
Loss = 4.3472e-03, PNorm = 68.5665, GNorm = 2.9255, lr_0 = 7.3888e-04
Loss = 3.6267e-03, PNorm = 68.6160, GNorm = 1.1451, lr_0 = 7.1497e-04
Validation rmse = 1.281779
Epoch 6
Loss = 5.4148e-03, PNorm = 68.6654, GNorm = 1.9849, lr_0 = 6.8956e-04
Loss = 4.2203e-03, PNorm = 68.7210, GNorm = 1.8881, lr_0 = 6.6725e-04
Loss = 3.4998e-03, PNorm = 68.7649, GNorm = 2.2022, lr_0 = 6.4565e-04
Validation rmse = 0.896304
Epoch 7
Loss = 3.2325e-03, PNorm = 68.8060, GNorm = 0.9180, lr_0 = 6.2476e-04
Loss = 3.5337e-03, PNorm = 68.8364, GNorm = 7.0605, lr_0 = 6.0454e-04
Validation rmse = 1.041394
Epoch 8
Loss = 4.5456e-03, PNorm = 68.8755, GNorm = 4.7859, lr_0 = 5.8498e-04
Loss = 3.7222e-03, PNorm = 68.9134, GNorm = 1.8903, lr_0 = 5.6605e-04
Loss = 3.5477e-03, PNorm = 68.9517, GNorm = 3.9222, lr_0 = 5.4774e-04
Validation rmse = 0.917262
Epoch 9
Loss = 3.0435e-03, PNorm = 68.9909, GNorm = 2.2088, lr_0 = 5.3001e-04
Loss = 2.8788e-03, PNorm = 69.0279, GNorm = 0.8039, lr_0 = 5.1286e-04
Validation rmse = 0.907356
Epoch 10
Loss = 2.5592e-03, PNorm = 69.0527, GNorm = 2.2308, lr_0 = 4.9627e-04
Loss = 3.2893e-03, PNorm = 69.0762, GNorm = 2.7979, lr_0 = 4.8021e-04
Loss = 2.8771e-03, PNorm = 69.1015, GNorm = 2.9664, lr_0 = 4.6467e-04
Validation rmse = 0.951286
Epoch 11
Loss = 3.0945e-03, PNorm = 69.1278, GNorm = 1.2278, lr_0 = 4.4963e-04
Loss = 2.7431e-03, PNorm = 69.1496, GNorm = 1.8136, lr_0 = 4.3508e-04
Validation rmse = 0.834628
Epoch 12
Loss = 3.1311e-03, PNorm = 69.1755, GNorm = 1.5149, lr_0 = 4.1962e-04
Loss = 2.7584e-03, PNorm = 69.2032, GNorm = 1.3366, lr_0 = 4.0604e-04
Loss = 2.9351e-03, PNorm = 69.2301, GNorm = 1.5515, lr_0 = 3.9290e-04
Validation rmse = 1.002754
Epoch 13
Loss = 2.4295e-03, PNorm = 69.2516, GNorm = 1.4238, lr_0 = 3.8019e-04
Loss = 3.1745e-03, PNorm = 69.2678, GNorm = 1.5497, lr_0 = 3.6789e-04
Loss = 2.9246e-03, PNorm = 69.2870, GNorm = 1.5107, lr_0 = 3.5598e-04
Validation rmse = 0.802211
Epoch 14
Loss = 2.6637e-03, PNorm = 69.3114, GNorm = 0.9248, lr_0 = 3.4446e-04
Loss = 2.4050e-03, PNorm = 69.3279, GNorm = 2.9305, lr_0 = 3.3332e-04
Validation rmse = 0.814986
Epoch 15
Loss = 1.8061e-03, PNorm = 69.3459, GNorm = 1.2451, lr_0 = 3.2253e-04
Loss = 2.4074e-03, PNorm = 69.3597, GNorm = 3.1519, lr_0 = 3.1209e-04
Loss = 2.8594e-03, PNorm = 69.3732, GNorm = 2.7863, lr_0 = 3.0200e-04
Validation rmse = 0.905657
Epoch 16
Loss = 2.7757e-03, PNorm = 69.3918, GNorm = 1.9814, lr_0 = 2.9222e-04
Loss = 2.0005e-03, PNorm = 69.4090, GNorm = 0.6685, lr_0 = 2.8277e-04
Validation rmse = 0.832254
Epoch 17
Loss = 1.6885e-03, PNorm = 69.4242, GNorm = 0.4789, lr_0 = 2.7272e-04
Loss = 2.3295e-03, PNorm = 69.4357, GNorm = 1.0070, lr_0 = 2.6389e-04
Loss = 1.8914e-03, PNorm = 69.4500, GNorm = 2.0870, lr_0 = 2.5535e-04
Validation rmse = 0.784143
Epoch 18
Loss = 1.9698e-03, PNorm = 69.4586, GNorm = 0.6253, lr_0 = 2.4709e-04
Loss = 2.3866e-03, PNorm = 69.4706, GNorm = 1.3764, lr_0 = 2.3910e-04
Loss = 2.1458e-03, PNorm = 69.4828, GNorm = 1.3601, lr_0 = 2.3136e-04
Validation rmse = 0.775671
Epoch 19
Loss = 2.2698e-03, PNorm = 69.4900, GNorm = 1.7354, lr_0 = 2.2387e-04
Loss = 2.0789e-03, PNorm = 69.5006, GNorm = 1.1295, lr_0 = 2.1663e-04
Validation rmse = 0.767102
Epoch 20
Loss = 1.9338e-03, PNorm = 69.5120, GNorm = 2.5671, lr_0 = 2.0962e-04
Loss = 2.2641e-03, PNorm = 69.5216, GNorm = 0.7115, lr_0 = 2.0283e-04
Loss = 1.8853e-03, PNorm = 69.5302, GNorm = 2.0474, lr_0 = 1.9627e-04
Validation rmse = 0.819306
Epoch 21
Loss = 1.9724e-03, PNorm = 69.5373, GNorm = 1.6061, lr_0 = 1.8992e-04
Loss = 2.0825e-03, PNorm = 69.5448, GNorm = 1.0088, lr_0 = 1.8377e-04
Validation rmse = 0.751476
Epoch 22
Loss = 1.5032e-03, PNorm = 69.5547, GNorm = 0.9867, lr_0 = 1.7783e-04
Loss = 1.7951e-03, PNorm = 69.5608, GNorm = 0.9186, lr_0 = 1.7207e-04
Loss = 1.9923e-03, PNorm = 69.5682, GNorm = 0.8914, lr_0 = 1.6651e-04
Validation rmse = 0.757784
Epoch 23
Loss = 1.7957e-03, PNorm = 69.5796, GNorm = 1.5600, lr_0 = 1.6059e-04
Loss = 1.9673e-03, PNorm = 69.5882, GNorm = 0.7939, lr_0 = 1.5539e-04
Validation rmse = 0.842223
Epoch 24
Loss = 2.0163e-03, PNorm = 69.5937, GNorm = 2.5850, lr_0 = 1.5036e-04
Loss = 2.0444e-03, PNorm = 69.6000, GNorm = 1.9516, lr_0 = 1.4550e-04
Loss = 1.9343e-03, PNorm = 69.6077, GNorm = 1.1839, lr_0 = 1.4079e-04
Validation rmse = 0.747664
Epoch 25
Loss = 1.7372e-03, PNorm = 69.6144, GNorm = 1.9749, lr_0 = 1.3623e-04
Loss = 1.8571e-03, PNorm = 69.6211, GNorm = 1.4012, lr_0 = 1.3183e-04
Loss = 2.0359e-03, PNorm = 69.6288, GNorm = 0.8075, lr_0 = 1.2756e-04
Validation rmse = 0.747089
Epoch 26
Loss = 1.8626e-03, PNorm = 69.6331, GNorm = 0.5917, lr_0 = 1.2343e-04
Loss = 2.0089e-03, PNorm = 69.6378, GNorm = 0.7888, lr_0 = 1.1944e-04
Validation rmse = 0.745516
Epoch 27
Loss = 2.3631e-03, PNorm = 69.6422, GNorm = 1.3007, lr_0 = 1.1557e-04
Loss = 1.6867e-03, PNorm = 69.6476, GNorm = 2.6219, lr_0 = 1.1183e-04
Loss = 1.8485e-03, PNorm = 69.6535, GNorm = 1.6805, lr_0 = 1.0821e-04
Validation rmse = 0.729719
Epoch 28
Loss = 1.7765e-03, PNorm = 69.6594, GNorm = 0.9619, lr_0 = 1.0437e-04
Loss = 1.8326e-03, PNorm = 69.6637, GNorm = 1.3265, lr_0 = 1.0099e-04
Validation rmse = 0.737605
Epoch 29
Loss = 1.5540e-03, PNorm = 69.6663, GNorm = 2.3900, lr_0 = 1.0000e-04
Loss = 1.7368e-03, PNorm = 69.6701, GNorm = 0.7323, lr_0 = 1.0000e-04
Loss = 1.7625e-03, PNorm = 69.6754, GNorm = 1.3540, lr_0 = 1.0000e-04
Validation rmse = 0.744608
Model 0 best validation rmse = 0.729719 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.750693
Ensemble test rmse = 0.750693
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.30000000000000004_ffn_num_layers_2_hidden_size_1400/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=1400, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,276,201
Moving model to cuda
Epoch 0
Loss = 1.8198e-02, PNorm = 67.3365, GNorm = 4.1195, lr_0 = 2.9800e-04
Loss = 1.4915e-02, PNorm = 67.3910, GNorm = 5.3119, lr_0 = 4.7800e-04
Validation rmse = 1.801945
Epoch 1
Loss = 1.5335e-02, PNorm = 67.4820, GNorm = 7.1149, lr_0 = 6.7600e-04
Loss = 1.2255e-02, PNorm = 67.5989, GNorm = 1.7195, lr_0 = 8.5600e-04
Loss = 8.6563e-03, PNorm = 67.7438, GNorm = 3.1802, lr_0 = 9.9344e-04
Validation rmse = 1.294928
Epoch 2
Loss = 8.6176e-03, PNorm = 67.8818, GNorm = 2.4286, lr_0 = 9.6130e-04
Loss = 6.9312e-03, PNorm = 68.0022, GNorm = 2.4937, lr_0 = 9.3019e-04
Validation rmse = 1.066494
Epoch 3
Loss = 5.9652e-03, PNorm = 68.1080, GNorm = 5.2161, lr_0 = 9.0009e-04
Loss = 5.7770e-03, PNorm = 68.2043, GNorm = 2.0429, lr_0 = 8.7096e-04
Loss = 6.2669e-03, PNorm = 68.2833, GNorm = 1.7398, lr_0 = 8.4278e-04
Validation rmse = 1.052273
Epoch 4
Loss = 5.2807e-03, PNorm = 68.3588, GNorm = 1.4050, lr_0 = 8.1551e-04
Loss = 4.7559e-03, PNorm = 68.4234, GNorm = 0.8884, lr_0 = 7.8912e-04
Validation rmse = 1.036518
Epoch 5
Loss = 5.4310e-03, PNorm = 68.4878, GNorm = 4.4474, lr_0 = 7.6358e-04
Loss = 4.3966e-03, PNorm = 68.5444, GNorm = 2.6645, lr_0 = 7.3888e-04
Loss = 4.4195e-03, PNorm = 68.5953, GNorm = 1.1995, lr_0 = 7.1497e-04
Validation rmse = 0.974289
Epoch 6
Loss = 4.4912e-03, PNorm = 68.6418, GNorm = 1.5522, lr_0 = 6.8956e-04
Loss = 3.3880e-03, PNorm = 68.6837, GNorm = 3.9177, lr_0 = 6.6725e-04
Loss = 4.6555e-03, PNorm = 68.7247, GNorm = 2.1322, lr_0 = 6.4565e-04
Validation rmse = 0.905781
Epoch 7
Loss = 4.1844e-03, PNorm = 68.7676, GNorm = 7.3814, lr_0 = 6.2476e-04
Loss = 4.0066e-03, PNorm = 68.8080, GNorm = 3.3075, lr_0 = 6.0454e-04
Validation rmse = 0.830004
Epoch 8
Loss = 3.1913e-03, PNorm = 68.8480, GNorm = 0.9629, lr_0 = 5.8498e-04
Loss = 3.2146e-03, PNorm = 68.8872, GNorm = 2.7127, lr_0 = 5.6605e-04
Loss = 3.0428e-03, PNorm = 68.9225, GNorm = 1.6674, lr_0 = 5.4774e-04
Validation rmse = 0.842078
Epoch 9
Loss = 3.7609e-03, PNorm = 68.9557, GNorm = 2.8200, lr_0 = 5.3001e-04
Loss = 3.6484e-03, PNorm = 68.9873, GNorm = 3.5979, lr_0 = 5.1286e-04
Validation rmse = 0.800102
Epoch 10
Loss = 3.0559e-03, PNorm = 69.0134, GNorm = 3.0742, lr_0 = 4.9627e-04
Loss = 3.5604e-03, PNorm = 69.0474, GNorm = 3.2330, lr_0 = 4.8021e-04
Loss = 3.4106e-03, PNorm = 69.0804, GNorm = 2.1737, lr_0 = 4.6467e-04
Validation rmse = 0.831053
Epoch 11
Loss = 2.8964e-03, PNorm = 69.1065, GNorm = 1.4973, lr_0 = 4.4963e-04
Loss = 3.0171e-03, PNorm = 69.1286, GNorm = 1.3596, lr_0 = 4.3508e-04
Validation rmse = 0.903391
Epoch 12
Loss = 2.7981e-03, PNorm = 69.1520, GNorm = 2.9388, lr_0 = 4.1962e-04
Loss = 2.9246e-03, PNorm = 69.1675, GNorm = 0.9561, lr_0 = 4.0604e-04
Loss = 2.4009e-03, PNorm = 69.1893, GNorm = 0.6563, lr_0 = 3.9290e-04
Validation rmse = 0.763137
Epoch 13
Loss = 2.1712e-03, PNorm = 69.2107, GNorm = 1.0516, lr_0 = 3.8019e-04
Loss = 2.7137e-03, PNorm = 69.2297, GNorm = 4.2106, lr_0 = 3.6789e-04
Loss = 2.7868e-03, PNorm = 69.2460, GNorm = 1.2428, lr_0 = 3.5598e-04
Validation rmse = 0.750966
Epoch 14
Loss = 2.6452e-03, PNorm = 69.2601, GNorm = 0.8135, lr_0 = 3.4446e-04
Loss = 2.6740e-03, PNorm = 69.2801, GNorm = 1.1450, lr_0 = 3.3332e-04
Validation rmse = 0.901642
Epoch 15
Loss = 2.8296e-03, PNorm = 69.3003, GNorm = 1.0229, lr_0 = 3.2253e-04
Loss = 2.3493e-03, PNorm = 69.3159, GNorm = 2.0912, lr_0 = 3.1209e-04
Loss = 3.1010e-03, PNorm = 69.3344, GNorm = 1.4179, lr_0 = 3.0200e-04
Validation rmse = 0.803083
Epoch 16
Loss = 2.4002e-03, PNorm = 69.3510, GNorm = 0.8607, lr_0 = 2.9222e-04
Loss = 2.1502e-03, PNorm = 69.3651, GNorm = 0.6664, lr_0 = 2.8277e-04
Validation rmse = 0.735560
Epoch 17
Loss = 2.3191e-03, PNorm = 69.3766, GNorm = 2.3353, lr_0 = 2.7272e-04
Loss = 2.1957e-03, PNorm = 69.3840, GNorm = 2.6301, lr_0 = 2.6389e-04
Loss = 2.4637e-03, PNorm = 69.4005, GNorm = 2.5083, lr_0 = 2.5535e-04
Validation rmse = 0.747388
Epoch 18
Loss = 2.3196e-03, PNorm = 69.4101, GNorm = 0.6488, lr_0 = 2.4709e-04
Loss = 2.4488e-03, PNorm = 69.4207, GNorm = 1.4684, lr_0 = 2.3910e-04
Loss = 2.1743e-03, PNorm = 69.4323, GNorm = 0.9363, lr_0 = 2.3136e-04
Validation rmse = 0.757031
Epoch 19
Loss = 2.5239e-03, PNorm = 69.4436, GNorm = 2.0485, lr_0 = 2.2387e-04
Loss = 1.9847e-03, PNorm = 69.4536, GNorm = 1.6460, lr_0 = 2.1663e-04
Validation rmse = 0.737520
Epoch 20
Loss = 1.9984e-03, PNorm = 69.4628, GNorm = 1.6618, lr_0 = 2.0962e-04
Loss = 1.8955e-03, PNorm = 69.4717, GNorm = 0.6119, lr_0 = 2.0283e-04
Loss = 1.9290e-03, PNorm = 69.4785, GNorm = 0.6018, lr_0 = 1.9627e-04
Validation rmse = 0.706327
Epoch 21
Loss = 1.9040e-03, PNorm = 69.4863, GNorm = 0.9129, lr_0 = 1.8992e-04
Loss = 2.4060e-03, PNorm = 69.4960, GNorm = 2.9054, lr_0 = 1.8377e-04
Validation rmse = 0.774017
Epoch 22
Loss = 2.2459e-03, PNorm = 69.5032, GNorm = 3.0142, lr_0 = 1.7783e-04
Loss = 2.1945e-03, PNorm = 69.5115, GNorm = 0.4797, lr_0 = 1.7207e-04
Loss = 2.0360e-03, PNorm = 69.5200, GNorm = 0.7271, lr_0 = 1.6651e-04
Validation rmse = 0.711650
Epoch 23
Loss = 2.0942e-03, PNorm = 69.5308, GNorm = 0.8234, lr_0 = 1.6059e-04
Loss = 1.9897e-03, PNorm = 69.5396, GNorm = 1.7734, lr_0 = 1.5539e-04
Validation rmse = 0.751964
Epoch 24
Loss = 2.3940e-03, PNorm = 69.5434, GNorm = 1.5980, lr_0 = 1.5036e-04
Loss = 1.8666e-03, PNorm = 69.5485, GNorm = 0.9504, lr_0 = 1.4550e-04
Loss = 2.0659e-03, PNorm = 69.5566, GNorm = 3.0031, lr_0 = 1.4079e-04
Validation rmse = 0.741933
Epoch 25
Loss = 2.2441e-03, PNorm = 69.5650, GNorm = 3.7099, lr_0 = 1.3623e-04
Loss = 1.8640e-03, PNorm = 69.5713, GNorm = 1.3824, lr_0 = 1.3183e-04
Loss = 1.7880e-03, PNorm = 69.5748, GNorm = 2.5573, lr_0 = 1.2756e-04
Validation rmse = 0.699216
Epoch 26
Loss = 1.9074e-03, PNorm = 69.5802, GNorm = 3.0178, lr_0 = 1.2343e-04
Loss = 1.9579e-03, PNorm = 69.5848, GNorm = 1.3201, lr_0 = 1.1944e-04
Validation rmse = 0.716397
Epoch 27
Loss = 2.4724e-03, PNorm = 69.5898, GNorm = 1.0206, lr_0 = 1.1557e-04
Loss = 2.0643e-03, PNorm = 69.5952, GNorm = 2.1130, lr_0 = 1.1183e-04
Loss = 1.7896e-03, PNorm = 69.6006, GNorm = 0.7874, lr_0 = 1.0821e-04
Validation rmse = 0.760781
Epoch 28
Loss = 1.8644e-03, PNorm = 69.6065, GNorm = 0.6130, lr_0 = 1.0437e-04
Loss = 2.0029e-03, PNorm = 69.6098, GNorm = 1.0385, lr_0 = 1.0099e-04
Validation rmse = 0.721293
Epoch 29
Loss = 2.0928e-03, PNorm = 69.6125, GNorm = 1.6663, lr_0 = 1.0000e-04
Loss = 1.9534e-03, PNorm = 69.6168, GNorm = 1.5563, lr_0 = 1.0000e-04
Loss = 1.7595e-03, PNorm = 69.6216, GNorm = 2.0486, lr_0 = 1.0000e-04
Validation rmse = 0.733050
Model 0 best validation rmse = 0.699216 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.734320
Ensemble test rmse = 0.734320
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.30000000000000004_ffn_num_layers_2_hidden_size_1400/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=1400, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,276,201
Moving model to cuda
Epoch 0
Loss = 1.7908e-02, PNorm = 67.3376, GNorm = 8.9087, lr_0 = 2.9800e-04
Loss = 1.3853e-02, PNorm = 67.3949, GNorm = 4.9461, lr_0 = 4.7800e-04
Validation rmse = 1.503555
Epoch 1
Loss = 1.1881e-02, PNorm = 67.4894, GNorm = 4.1065, lr_0 = 6.7600e-04
Loss = 1.1463e-02, PNorm = 67.6084, GNorm = 1.6257, lr_0 = 8.5600e-04
Loss = 9.1556e-03, PNorm = 67.7584, GNorm = 4.3611, lr_0 = 9.9344e-04
Validation rmse = 1.503012
Epoch 2
Loss = 8.6132e-03, PNorm = 67.9072, GNorm = 2.0679, lr_0 = 9.6130e-04
Loss = 6.7106e-03, PNorm = 68.0234, GNorm = 5.5241, lr_0 = 9.3019e-04
Validation rmse = 1.178100
Epoch 3
Loss = 5.9034e-03, PNorm = 68.1272, GNorm = 3.9779, lr_0 = 9.0009e-04
Loss = 6.0447e-03, PNorm = 68.2314, GNorm = 3.4486, lr_0 = 8.7096e-04
Loss = 5.9540e-03, PNorm = 68.3219, GNorm = 5.3155, lr_0 = 8.4278e-04
Validation rmse = 1.195928
Epoch 4
Loss = 6.0682e-03, PNorm = 68.3953, GNorm = 6.1430, lr_0 = 8.1551e-04
Loss = 4.5514e-03, PNorm = 68.4681, GNorm = 3.9042, lr_0 = 7.8912e-04
Validation rmse = 0.984418
Epoch 5
Loss = 4.2382e-03, PNorm = 68.5315, GNorm = 1.8134, lr_0 = 7.6358e-04
Loss = 3.8624e-03, PNorm = 68.5813, GNorm = 1.5613, lr_0 = 7.3888e-04
Loss = 4.6824e-03, PNorm = 68.6267, GNorm = 4.0297, lr_0 = 7.1497e-04
Validation rmse = 1.046148
Epoch 6
Loss = 4.1613e-03, PNorm = 68.6846, GNorm = 2.5663, lr_0 = 6.8956e-04
Loss = 4.3150e-03, PNorm = 68.7298, GNorm = 3.6901, lr_0 = 6.6725e-04
Loss = 3.8354e-03, PNorm = 68.7751, GNorm = 1.1784, lr_0 = 6.4565e-04
Validation rmse = 1.011336
Epoch 7
Loss = 3.8767e-03, PNorm = 68.8157, GNorm = 1.1336, lr_0 = 6.2476e-04
Loss = 3.4259e-03, PNorm = 68.8576, GNorm = 0.8661, lr_0 = 6.0454e-04
Validation rmse = 0.893685
Epoch 8
Loss = 2.9950e-03, PNorm = 68.8904, GNorm = 0.8388, lr_0 = 5.8498e-04
Loss = 3.1781e-03, PNorm = 68.9219, GNorm = 1.3083, lr_0 = 5.6605e-04
Loss = 3.0771e-03, PNorm = 68.9540, GNorm = 1.9297, lr_0 = 5.4774e-04
Validation rmse = 0.852491
Epoch 9
Loss = 3.1310e-03, PNorm = 68.9849, GNorm = 0.7413, lr_0 = 5.3001e-04
Loss = 2.8392e-03, PNorm = 69.0179, GNorm = 1.7301, lr_0 = 5.1286e-04
Validation rmse = 0.859500
Epoch 10
Loss = 2.1925e-03, PNorm = 69.0453, GNorm = 1.9333, lr_0 = 4.9627e-04
Loss = 2.8868e-03, PNorm = 69.0706, GNorm = 0.9915, lr_0 = 4.8021e-04
Loss = 3.2728e-03, PNorm = 69.0954, GNorm = 2.7150, lr_0 = 4.6467e-04
Validation rmse = 0.848936
Epoch 11
Loss = 2.6336e-03, PNorm = 69.1166, GNorm = 2.9130, lr_0 = 4.4963e-04
Loss = 3.4188e-03, PNorm = 69.1389, GNorm = 0.6386, lr_0 = 4.3508e-04
Validation rmse = 0.880516
Epoch 12
Loss = 3.1104e-03, PNorm = 69.1669, GNorm = 2.9362, lr_0 = 4.1962e-04
Loss = 3.0439e-03, PNorm = 69.1881, GNorm = 2.3042, lr_0 = 4.0604e-04
Loss = 2.8289e-03, PNorm = 69.2110, GNorm = 2.3279, lr_0 = 3.9290e-04
Validation rmse = 0.799953
Epoch 13
Loss = 2.6917e-03, PNorm = 69.2356, GNorm = 2.2981, lr_0 = 3.8019e-04
Loss = 2.6527e-03, PNorm = 69.2519, GNorm = 2.9227, lr_0 = 3.6789e-04
Loss = 2.4891e-03, PNorm = 69.2738, GNorm = 1.2124, lr_0 = 3.5598e-04
Validation rmse = 0.794067
Epoch 14
Loss = 2.6489e-03, PNorm = 69.2938, GNorm = 1.9290, lr_0 = 3.4446e-04
Loss = 2.5424e-03, PNorm = 69.3128, GNorm = 0.8042, lr_0 = 3.3332e-04
Validation rmse = 0.786710
Epoch 15
Loss = 1.8773e-03, PNorm = 69.3298, GNorm = 0.6978, lr_0 = 3.2253e-04
Loss = 2.4777e-03, PNorm = 69.3462, GNorm = 0.7885, lr_0 = 3.1209e-04
Loss = 2.5367e-03, PNorm = 69.3603, GNorm = 2.2465, lr_0 = 3.0200e-04
Validation rmse = 0.754546
Epoch 16
Loss = 2.3702e-03, PNorm = 69.3743, GNorm = 0.7170, lr_0 = 2.9222e-04
Loss = 2.5606e-03, PNorm = 69.3889, GNorm = 1.0404, lr_0 = 2.8277e-04
Validation rmse = 0.768957
Epoch 17
Loss = 2.2032e-03, PNorm = 69.4067, GNorm = 0.8512, lr_0 = 2.7272e-04
Loss = 2.1160e-03, PNorm = 69.4169, GNorm = 5.2068, lr_0 = 2.6389e-04
Loss = 2.3404e-03, PNorm = 69.4270, GNorm = 0.7631, lr_0 = 2.5535e-04
Validation rmse = 0.754978
Epoch 18
Loss = 1.8981e-03, PNorm = 69.4404, GNorm = 2.6746, lr_0 = 2.4709e-04
Loss = 2.5612e-03, PNorm = 69.4510, GNorm = 2.6236, lr_0 = 2.3910e-04
Loss = 2.0570e-03, PNorm = 69.4653, GNorm = 0.9905, lr_0 = 2.3136e-04
Validation rmse = 0.758632
Epoch 19
Loss = 2.2268e-03, PNorm = 69.4754, GNorm = 1.6573, lr_0 = 2.2387e-04
Loss = 2.0999e-03, PNorm = 69.4876, GNorm = 1.4793, lr_0 = 2.1663e-04
Validation rmse = 0.759191
Epoch 20
Loss = 2.3695e-03, PNorm = 69.4978, GNorm = 0.8889, lr_0 = 2.0962e-04
Loss = 2.2319e-03, PNorm = 69.5073, GNorm = 0.6727, lr_0 = 2.0283e-04
Loss = 2.1370e-03, PNorm = 69.5168, GNorm = 0.7848, lr_0 = 1.9627e-04
Validation rmse = 0.726095
Epoch 21
Loss = 1.9653e-03, PNorm = 69.5270, GNorm = 1.7485, lr_0 = 1.8992e-04
Loss = 2.5412e-03, PNorm = 69.5354, GNorm = 2.6219, lr_0 = 1.8377e-04
Validation rmse = 0.719623
Epoch 22
Loss = 2.9604e-03, PNorm = 69.5476, GNorm = 2.6840, lr_0 = 1.7783e-04
Loss = 2.1372e-03, PNorm = 69.5600, GNorm = 3.2013, lr_0 = 1.7207e-04
Loss = 1.7815e-03, PNorm = 69.5680, GNorm = 1.8636, lr_0 = 1.6651e-04
Validation rmse = 0.713524
Epoch 23
Loss = 2.1936e-03, PNorm = 69.5735, GNorm = 1.0145, lr_0 = 1.6059e-04
Loss = 1.7497e-03, PNorm = 69.5818, GNorm = 0.9410, lr_0 = 1.5539e-04
Validation rmse = 0.722091
Epoch 24
Loss = 2.3212e-03, PNorm = 69.5896, GNorm = 2.3992, lr_0 = 1.5036e-04
Loss = 1.8374e-03, PNorm = 69.5981, GNorm = 0.7806, lr_0 = 1.4550e-04
Loss = 1.9495e-03, PNorm = 69.6044, GNorm = 0.8956, lr_0 = 1.4079e-04
Validation rmse = 0.705609
Epoch 25
Loss = 2.0677e-03, PNorm = 69.6105, GNorm = 1.0173, lr_0 = 1.3623e-04
Loss = 1.9050e-03, PNorm = 69.6168, GNorm = 1.1074, lr_0 = 1.3183e-04
Loss = 1.9043e-03, PNorm = 69.6248, GNorm = 0.5250, lr_0 = 1.2756e-04
Validation rmse = 0.705676
Epoch 26
Loss = 1.9318e-03, PNorm = 69.6315, GNorm = 1.1366, lr_0 = 1.2343e-04
Loss = 1.8508e-03, PNorm = 69.6356, GNorm = 0.8294, lr_0 = 1.1944e-04
Validation rmse = 0.702119
Epoch 27
Loss = 1.6215e-03, PNorm = 69.6418, GNorm = 0.7488, lr_0 = 1.1557e-04
Loss = 1.9043e-03, PNorm = 69.6479, GNorm = 0.7771, lr_0 = 1.1183e-04
Loss = 1.6741e-03, PNorm = 69.6518, GNorm = 2.1865, lr_0 = 1.0821e-04
Validation rmse = 0.702857
Epoch 28
Loss = 1.8792e-03, PNorm = 69.6568, GNorm = 0.5617, lr_0 = 1.0437e-04
Loss = 2.0137e-03, PNorm = 69.6612, GNorm = 1.5426, lr_0 = 1.0099e-04
Validation rmse = 0.736558
Epoch 29
Loss = 1.3335e-03, PNorm = 69.6660, GNorm = 0.6236, lr_0 = 1.0000e-04
Loss = 1.7529e-03, PNorm = 69.6704, GNorm = 0.6271, lr_0 = 1.0000e-04
Loss = 2.1044e-03, PNorm = 69.6747, GNorm = 2.0371, lr_0 = 1.0000e-04
Validation rmse = 0.733718
Model 0 best validation rmse = 0.702119 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.817007
Ensemble test rmse = 0.817007
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.30000000000000004_ffn_num_layers_2_hidden_size_1400/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=1400, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,276,201
Moving model to cuda
Epoch 0
Loss = 1.8036e-02, PNorm = 67.3355, GNorm = 3.0889, lr_0 = 2.9800e-04
Loss = 1.7262e-02, PNorm = 67.3873, GNorm = 8.4754, lr_0 = 4.7800e-04
Validation rmse = 2.147635
Epoch 1
Loss = 1.4594e-02, PNorm = 67.4859, GNorm = 9.0192, lr_0 = 6.7600e-04
Loss = 1.0895e-02, PNorm = 67.6061, GNorm = 3.1222, lr_0 = 8.5600e-04
Loss = 9.3920e-03, PNorm = 67.7574, GNorm = 1.7070, lr_0 = 9.9344e-04
Validation rmse = 1.467056
Epoch 2
Loss = 8.2149e-03, PNorm = 67.9030, GNorm = 3.3271, lr_0 = 9.6130e-04
Loss = 7.7977e-03, PNorm = 68.0275, GNorm = 1.8866, lr_0 = 9.3019e-04
Validation rmse = 1.306494
Epoch 3
Loss = 6.3773e-03, PNorm = 68.1422, GNorm = 3.2402, lr_0 = 9.0009e-04
Loss = 6.1672e-03, PNorm = 68.2424, GNorm = 5.0016, lr_0 = 8.7096e-04
Loss = 4.7629e-03, PNorm = 68.3314, GNorm = 2.1555, lr_0 = 8.4278e-04
Validation rmse = 1.156306
Epoch 4
Loss = 4.6939e-03, PNorm = 68.4092, GNorm = 2.2305, lr_0 = 8.1551e-04
Loss = 5.3517e-03, PNorm = 68.4865, GNorm = 3.1431, lr_0 = 7.8912e-04
Validation rmse = 1.147603
Epoch 5
Loss = 5.6013e-03, PNorm = 68.5643, GNorm = 2.8846, lr_0 = 7.6358e-04
Loss = 4.0861e-03, PNorm = 68.6324, GNorm = 0.9654, lr_0 = 7.3888e-04
Loss = 4.0099e-03, PNorm = 68.6864, GNorm = 3.2121, lr_0 = 7.1497e-04
Validation rmse = 1.002256
Epoch 6
Loss = 3.8440e-03, PNorm = 68.7306, GNorm = 2.8031, lr_0 = 6.8956e-04
Loss = 3.8125e-03, PNorm = 68.7809, GNorm = 2.1230, lr_0 = 6.6725e-04
Loss = 3.9428e-03, PNorm = 68.8251, GNorm = 4.6468, lr_0 = 6.4565e-04
Validation rmse = 1.089768
Epoch 7
Loss = 3.1874e-03, PNorm = 68.8638, GNorm = 0.9958, lr_0 = 6.2476e-04
Loss = 3.6665e-03, PNorm = 68.9018, GNorm = 4.0952, lr_0 = 6.0454e-04
Validation rmse = 1.063362
Epoch 8
Loss = 4.1875e-03, PNorm = 68.9365, GNorm = 4.3673, lr_0 = 5.8498e-04
Loss = 3.3944e-03, PNorm = 68.9751, GNorm = 1.1321, lr_0 = 5.6605e-04
Loss = 3.1729e-03, PNorm = 69.0065, GNorm = 1.2692, lr_0 = 5.4774e-04
Validation rmse = 0.952252
Epoch 9
Loss = 2.9193e-03, PNorm = 69.0364, GNorm = 1.5183, lr_0 = 5.3001e-04
Loss = 2.9101e-03, PNorm = 69.0625, GNorm = 1.5487, lr_0 = 5.1286e-04
Validation rmse = 0.902804
Epoch 10
Loss = 2.4799e-03, PNorm = 69.0884, GNorm = 1.6865, lr_0 = 4.9627e-04
Loss = 2.9897e-03, PNorm = 69.1147, GNorm = 2.6484, lr_0 = 4.8021e-04
Loss = 2.8190e-03, PNorm = 69.1405, GNorm = 2.2757, lr_0 = 4.6467e-04
Validation rmse = 0.930036
Epoch 11
Loss = 2.6507e-03, PNorm = 69.1627, GNorm = 2.3111, lr_0 = 4.4963e-04
Loss = 4.0949e-03, PNorm = 69.1940, GNorm = 1.8249, lr_0 = 4.3508e-04
Validation rmse = 0.945594
Epoch 12
Loss = 2.3125e-03, PNorm = 69.2267, GNorm = 1.0744, lr_0 = 4.1962e-04
Loss = 2.6728e-03, PNorm = 69.2522, GNorm = 0.8523, lr_0 = 4.0604e-04
Loss = 2.6225e-03, PNorm = 69.2764, GNorm = 1.3323, lr_0 = 3.9290e-04
Validation rmse = 0.892819
Epoch 13
Loss = 2.9451e-03, PNorm = 69.2966, GNorm = 1.9675, lr_0 = 3.8019e-04
Loss = 2.6885e-03, PNorm = 69.3161, GNorm = 0.8062, lr_0 = 3.6789e-04
Loss = 2.2257e-03, PNorm = 69.3375, GNorm = 1.9172, lr_0 = 3.5598e-04
Validation rmse = 0.887419
Epoch 14
Loss = 2.4577e-03, PNorm = 69.3516, GNorm = 1.4822, lr_0 = 3.4446e-04
Loss = 2.3291e-03, PNorm = 69.3708, GNorm = 1.1675, lr_0 = 3.3332e-04
Validation rmse = 0.886168
Epoch 15
Loss = 1.9302e-03, PNorm = 69.3908, GNorm = 1.7976, lr_0 = 3.2253e-04
Loss = 2.4878e-03, PNorm = 69.4059, GNorm = 1.0229, lr_0 = 3.1209e-04
Loss = 2.2076e-03, PNorm = 69.4207, GNorm = 1.3778, lr_0 = 3.0200e-04
Validation rmse = 0.900074
Epoch 16
Loss = 2.3109e-03, PNorm = 69.4366, GNorm = 1.7249, lr_0 = 2.9222e-04
Loss = 2.6457e-03, PNorm = 69.4502, GNorm = 2.7930, lr_0 = 2.8277e-04
Validation rmse = 0.853631
Epoch 17
Loss = 3.3998e-03, PNorm = 69.4685, GNorm = 3.0991, lr_0 = 2.7272e-04
Loss = 2.6455e-03, PNorm = 69.4873, GNorm = 2.4570, lr_0 = 2.6389e-04
Loss = 2.1689e-03, PNorm = 69.5039, GNorm = 1.0467, lr_0 = 2.5535e-04
Validation rmse = 0.910240
Epoch 18
Loss = 2.2969e-03, PNorm = 69.5183, GNorm = 2.3247, lr_0 = 2.4709e-04
Loss = 2.2800e-03, PNorm = 69.5289, GNorm = 2.2799, lr_0 = 2.3910e-04
Loss = 2.1641e-03, PNorm = 69.5388, GNorm = 1.2663, lr_0 = 2.3136e-04
Validation rmse = 0.847782
Epoch 19
Loss = 2.1929e-03, PNorm = 69.5474, GNorm = 1.9426, lr_0 = 2.2387e-04
Loss = 2.2141e-03, PNorm = 69.5568, GNorm = 1.2045, lr_0 = 2.1663e-04
Validation rmse = 0.812951
Epoch 20
Loss = 1.5367e-03, PNorm = 69.5698, GNorm = 0.5083, lr_0 = 2.0962e-04
Loss = 1.9853e-03, PNorm = 69.5823, GNorm = 0.9512, lr_0 = 2.0283e-04
Loss = 2.1553e-03, PNorm = 69.5918, GNorm = 1.4476, lr_0 = 1.9627e-04
Validation rmse = 0.834522
Epoch 21
Loss = 1.9540e-03, PNorm = 69.6006, GNorm = 0.6458, lr_0 = 1.8992e-04
Loss = 2.0970e-03, PNorm = 69.6079, GNorm = 1.3916, lr_0 = 1.8377e-04
Validation rmse = 0.806304
Epoch 22
Loss = 1.6686e-03, PNorm = 69.6179, GNorm = 0.8527, lr_0 = 1.7783e-04
Loss = 1.8096e-03, PNorm = 69.6265, GNorm = 2.6277, lr_0 = 1.7207e-04
Loss = 1.8152e-03, PNorm = 69.6346, GNorm = 0.6134, lr_0 = 1.6651e-04
Validation rmse = 0.811464
Epoch 23
Loss = 1.8822e-03, PNorm = 69.6447, GNorm = 1.9689, lr_0 = 1.6059e-04
Loss = 1.6889e-03, PNorm = 69.6512, GNorm = 0.5924, lr_0 = 1.5539e-04
Validation rmse = 0.780399
Epoch 24
Loss = 1.3411e-03, PNorm = 69.6594, GNorm = 1.2001, lr_0 = 1.5036e-04
Loss = 2.0331e-03, PNorm = 69.6650, GNorm = 3.2529, lr_0 = 1.4550e-04
Loss = 2.1475e-03, PNorm = 69.6725, GNorm = 1.8105, lr_0 = 1.4079e-04
Validation rmse = 0.797771
Epoch 25
Loss = 2.2895e-03, PNorm = 69.6792, GNorm = 2.7069, lr_0 = 1.3623e-04
Loss = 1.8975e-03, PNorm = 69.6878, GNorm = 2.5332, lr_0 = 1.3183e-04
Loss = 1.7675e-03, PNorm = 69.6948, GNorm = 1.1665, lr_0 = 1.2756e-04
Validation rmse = 0.805526
Epoch 26
Loss = 1.8286e-03, PNorm = 69.7002, GNorm = 0.9081, lr_0 = 1.2343e-04
Loss = 1.9467e-03, PNorm = 69.7063, GNorm = 1.6194, lr_0 = 1.1944e-04
Validation rmse = 0.805555
Epoch 27
Loss = 1.5866e-03, PNorm = 69.7122, GNorm = 1.0619, lr_0 = 1.1557e-04
Loss = 1.5884e-03, PNorm = 69.7176, GNorm = 0.4852, lr_0 = 1.1183e-04
Loss = 1.9196e-03, PNorm = 69.7233, GNorm = 1.9881, lr_0 = 1.0821e-04
Validation rmse = 0.789071
Epoch 28
Loss = 1.4746e-03, PNorm = 69.7291, GNorm = 1.2969, lr_0 = 1.0437e-04
Loss = 1.6927e-03, PNorm = 69.7331, GNorm = 0.5167, lr_0 = 1.0099e-04
Validation rmse = 0.800694
Epoch 29
Loss = 2.3136e-03, PNorm = 69.7376, GNorm = 0.5800, lr_0 = 1.0000e-04
Loss = 1.6791e-03, PNorm = 69.7423, GNorm = 1.1616, lr_0 = 1.0000e-04
Loss = 1.5821e-03, PNorm = 69.7479, GNorm = 1.0869, lr_0 = 1.0000e-04
Validation rmse = 0.778944
Model 0 best validation rmse = 0.778944 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.937639
Ensemble test rmse = 0.937639
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.30000000000000004_ffn_num_layers_2_hidden_size_1400/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=1400, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,276,201
Moving model to cuda
Epoch 0
Loss = 1.8458e-02, PNorm = 67.3361, GNorm = 3.4861, lr_0 = 2.9800e-04
Loss = 1.6321e-02, PNorm = 67.3919, GNorm = 5.9018, lr_0 = 4.7800e-04
Validation rmse = 1.929704
Epoch 1
Loss = 1.2668e-02, PNorm = 67.4804, GNorm = 1.7942, lr_0 = 6.7600e-04
Loss = 1.0476e-02, PNorm = 67.6058, GNorm = 2.9168, lr_0 = 8.5600e-04
Loss = 1.1901e-02, PNorm = 67.7363, GNorm = 4.0674, lr_0 = 9.9344e-04
Validation rmse = 2.098567
Epoch 2
Loss = 9.6386e-03, PNorm = 67.8869, GNorm = 3.0958, lr_0 = 9.6130e-04
Loss = 9.2380e-03, PNorm = 68.0086, GNorm = 1.5410, lr_0 = 9.3019e-04
Validation rmse = 1.354457
Epoch 3
Loss = 5.5800e-03, PNorm = 68.1223, GNorm = 1.4031, lr_0 = 9.0009e-04
Loss = 5.6053e-03, PNorm = 68.2102, GNorm = 2.0959, lr_0 = 8.7096e-04
Loss = 5.8068e-03, PNorm = 68.2890, GNorm = 6.1586, lr_0 = 8.4278e-04
Validation rmse = 1.234175
Epoch 4
Loss = 5.4811e-03, PNorm = 68.3785, GNorm = 2.2721, lr_0 = 8.1551e-04
Loss = 5.0229e-03, PNorm = 68.4480, GNorm = 5.3785, lr_0 = 7.8912e-04
Validation rmse = 1.110495
Epoch 5
Loss = 4.1514e-03, PNorm = 68.5074, GNorm = 1.8082, lr_0 = 7.6358e-04
Loss = 4.1584e-03, PNorm = 68.5618, GNorm = 1.9592, lr_0 = 7.3888e-04
Loss = 5.0499e-03, PNorm = 68.6170, GNorm = 1.9944, lr_0 = 7.1497e-04
Validation rmse = 1.072230
Epoch 6
Loss = 4.3417e-03, PNorm = 68.6771, GNorm = 1.9082, lr_0 = 6.8956e-04
Loss = 4.5607e-03, PNorm = 68.7217, GNorm = 1.5101, lr_0 = 6.6725e-04
Loss = 3.5622e-03, PNorm = 68.7663, GNorm = 1.9913, lr_0 = 6.4565e-04
Validation rmse = 1.066786
Epoch 7
Loss = 3.3497e-03, PNorm = 68.8091, GNorm = 1.5991, lr_0 = 6.2476e-04
Loss = 3.6923e-03, PNorm = 68.8489, GNorm = 1.7009, lr_0 = 6.0454e-04
Validation rmse = 1.051855
Epoch 8
Loss = 3.3265e-03, PNorm = 68.8838, GNorm = 2.4715, lr_0 = 5.8498e-04
Loss = 3.5595e-03, PNorm = 68.9196, GNorm = 1.2081, lr_0 = 5.6605e-04
Loss = 3.1867e-03, PNorm = 68.9548, GNorm = 2.0555, lr_0 = 5.4774e-04
Validation rmse = 1.137315
Epoch 9
Loss = 3.3724e-03, PNorm = 68.9791, GNorm = 2.0072, lr_0 = 5.3001e-04
Loss = 3.3502e-03, PNorm = 69.0127, GNorm = 1.1585, lr_0 = 5.1286e-04
Validation rmse = 0.998589
Epoch 10
Loss = 2.4828e-03, PNorm = 69.0461, GNorm = 1.3405, lr_0 = 4.9627e-04
Loss = 2.5322e-03, PNorm = 69.0732, GNorm = 0.9241, lr_0 = 4.8021e-04
Loss = 3.6523e-03, PNorm = 69.1016, GNorm = 1.4799, lr_0 = 4.6467e-04
Validation rmse = 0.982708
Epoch 11
Loss = 2.8232e-03, PNorm = 69.1330, GNorm = 3.0306, lr_0 = 4.4963e-04
Loss = 3.1267e-03, PNorm = 69.1608, GNorm = 3.1473, lr_0 = 4.3508e-04
Validation rmse = 1.144167
Epoch 12
Loss = 3.5100e-03, PNorm = 69.1877, GNorm = 2.6303, lr_0 = 4.1962e-04
Loss = 2.7663e-03, PNorm = 69.2099, GNorm = 0.6610, lr_0 = 4.0604e-04
Loss = 2.5726e-03, PNorm = 69.2326, GNorm = 0.7952, lr_0 = 3.9290e-04
Validation rmse = 1.251723
Epoch 13
Loss = 3.7314e-03, PNorm = 69.2539, GNorm = 6.0893, lr_0 = 3.8019e-04
Loss = 3.0541e-03, PNorm = 69.2765, GNorm = 0.9170, lr_0 = 3.6789e-04
Loss = 3.5879e-03, PNorm = 69.3001, GNorm = 2.0813, lr_0 = 3.5598e-04
Validation rmse = 1.173919
Epoch 14
Loss = 3.0241e-03, PNorm = 69.3231, GNorm = 1.0319, lr_0 = 3.4446e-04
Loss = 2.4425e-03, PNorm = 69.3433, GNorm = 1.6713, lr_0 = 3.3332e-04
Validation rmse = 1.017149
Epoch 15
Loss = 3.0267e-03, PNorm = 69.3598, GNorm = 1.8627, lr_0 = 3.2253e-04
Loss = 2.6891e-03, PNorm = 69.3766, GNorm = 0.6452, lr_0 = 3.1209e-04
Loss = 2.1997e-03, PNorm = 69.3943, GNorm = 1.0453, lr_0 = 3.0200e-04
Validation rmse = 0.910157
Epoch 16
Loss = 2.3106e-03, PNorm = 69.4074, GNorm = 1.4008, lr_0 = 2.9222e-04
Loss = 2.0448e-03, PNorm = 69.4206, GNorm = 1.5663, lr_0 = 2.8277e-04
Validation rmse = 0.898281
Epoch 17
Loss = 2.4265e-03, PNorm = 69.4348, GNorm = 1.2121, lr_0 = 2.7272e-04
Loss = 2.4587e-03, PNorm = 69.4499, GNorm = 1.2779, lr_0 = 2.6389e-04
Loss = 2.1556e-03, PNorm = 69.4670, GNorm = 2.6608, lr_0 = 2.5535e-04
Validation rmse = 0.902648
Epoch 18
Loss = 2.1295e-03, PNorm = 69.4788, GNorm = 1.0091, lr_0 = 2.4709e-04
Loss = 2.2791e-03, PNorm = 69.4918, GNorm = 1.1060, lr_0 = 2.3910e-04
Loss = 2.0953e-03, PNorm = 69.5017, GNorm = 0.9466, lr_0 = 2.3136e-04
Validation rmse = 0.872990
Epoch 19
Loss = 2.0068e-03, PNorm = 69.5119, GNorm = 1.0893, lr_0 = 2.2387e-04
Loss = 2.2567e-03, PNorm = 69.5221, GNorm = 1.9193, lr_0 = 2.1663e-04
Validation rmse = 0.888045
Epoch 20
Loss = 1.7595e-03, PNorm = 69.5325, GNorm = 1.4751, lr_0 = 2.0962e-04
Loss = 2.3941e-03, PNorm = 69.5422, GNorm = 1.1780, lr_0 = 2.0283e-04
Loss = 2.1415e-03, PNorm = 69.5541, GNorm = 1.2972, lr_0 = 1.9627e-04
Validation rmse = 0.895288
Epoch 21
Loss = 2.0703e-03, PNorm = 69.5665, GNorm = 0.5395, lr_0 = 1.8992e-04
Loss = 1.9797e-03, PNorm = 69.5726, GNorm = 2.9795, lr_0 = 1.8377e-04
Validation rmse = 0.838179
Epoch 22
Loss = 2.0453e-03, PNorm = 69.5826, GNorm = 0.8722, lr_0 = 1.7783e-04
Loss = 1.7164e-03, PNorm = 69.5901, GNorm = 1.9723, lr_0 = 1.7207e-04
Loss = 2.0681e-03, PNorm = 69.5974, GNorm = 1.9159, lr_0 = 1.6651e-04
Validation rmse = 0.939039
Epoch 23
Loss = 1.9530e-03, PNorm = 69.6059, GNorm = 1.0854, lr_0 = 1.6059e-04
Loss = 1.9729e-03, PNorm = 69.6133, GNorm = 1.3318, lr_0 = 1.5539e-04
Validation rmse = 0.821964
Epoch 24
Loss = 1.5098e-03, PNorm = 69.6227, GNorm = 0.8303, lr_0 = 1.5036e-04
Loss = 2.1738e-03, PNorm = 69.6317, GNorm = 0.5169, lr_0 = 1.4550e-04
Loss = 1.7037e-03, PNorm = 69.6411, GNorm = 0.6554, lr_0 = 1.4079e-04
Validation rmse = 0.824698
Epoch 25
Loss = 1.8994e-03, PNorm = 69.6457, GNorm = 1.2188, lr_0 = 1.3623e-04
Loss = 1.7487e-03, PNorm = 69.6530, GNorm = 0.6416, lr_0 = 1.3183e-04
Loss = 1.8926e-03, PNorm = 69.6593, GNorm = 0.6400, lr_0 = 1.2756e-04
Validation rmse = 0.830957
Epoch 26
Loss = 1.8442e-03, PNorm = 69.6651, GNorm = 1.2403, lr_0 = 1.2343e-04
Loss = 1.8320e-03, PNorm = 69.6732, GNorm = 2.8605, lr_0 = 1.1944e-04
Validation rmse = 0.895279
Epoch 27
Loss = 2.0813e-03, PNorm = 69.6769, GNorm = 2.4466, lr_0 = 1.1557e-04
Loss = 1.9341e-03, PNorm = 69.6839, GNorm = 0.7686, lr_0 = 1.1183e-04
Loss = 1.8115e-03, PNorm = 69.6887, GNorm = 0.9964, lr_0 = 1.0821e-04
Validation rmse = 0.841496
Epoch 28
Loss = 2.1009e-03, PNorm = 69.6944, GNorm = 2.1631, lr_0 = 1.0437e-04
Loss = 1.6517e-03, PNorm = 69.6998, GNorm = 1.7494, lr_0 = 1.0099e-04
Validation rmse = 0.818542
Epoch 29
Loss = 1.0108e-03, PNorm = 69.7037, GNorm = 0.7557, lr_0 = 1.0000e-04
Loss = 2.1164e-03, PNorm = 69.7085, GNorm = 1.0314, lr_0 = 1.0000e-04
Loss = 1.8634e-03, PNorm = 69.7123, GNorm = 0.6464, lr_0 = 1.0000e-04
Validation rmse = 0.826068
Model 0 best validation rmse = 0.818542 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.678481
Ensemble test rmse = 0.678481
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.30000000000000004_ffn_num_layers_2_hidden_size_1400/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=1400, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,276,201
Moving model to cuda
Epoch 0
Loss = 1.8751e-02, PNorm = 67.3345, GNorm = 3.4345, lr_0 = 2.9800e-04
Loss = 1.4692e-02, PNorm = 67.3968, GNorm = 3.3132, lr_0 = 4.7800e-04
Validation rmse = 1.915082
Epoch 1
Loss = 1.4169e-02, PNorm = 67.4918, GNorm = 8.4419, lr_0 = 6.7600e-04
Loss = 1.2753e-02, PNorm = 67.6180, GNorm = 1.4356, lr_0 = 8.5600e-04
Loss = 1.0072e-02, PNorm = 67.7645, GNorm = 5.7827, lr_0 = 9.9344e-04
Validation rmse = 1.690874
Epoch 2
Loss = 7.2272e-03, PNorm = 67.9039, GNorm = 2.6314, lr_0 = 9.6130e-04
Loss = 7.1893e-03, PNorm = 68.0013, GNorm = 2.1297, lr_0 = 9.3019e-04
Validation rmse = 1.399895
Epoch 3
Loss = 7.6903e-03, PNorm = 68.1073, GNorm = 1.5496, lr_0 = 9.0009e-04
Loss = 5.3820e-03, PNorm = 68.2065, GNorm = 1.9771, lr_0 = 8.7096e-04
Loss = 5.3948e-03, PNorm = 68.2918, GNorm = 2.3131, lr_0 = 8.4278e-04
Validation rmse = 1.278854
Epoch 4
Loss = 4.8211e-03, PNorm = 68.3665, GNorm = 1.3608, lr_0 = 8.1551e-04
Loss = 5.6833e-03, PNorm = 68.4305, GNorm = 4.5928, lr_0 = 7.8912e-04
Validation rmse = 1.212869
Epoch 5
Loss = 3.6862e-03, PNorm = 68.4950, GNorm = 3.5989, lr_0 = 7.6358e-04
Loss = 4.5037e-03, PNorm = 68.5551, GNorm = 2.3659, lr_0 = 7.3888e-04
Loss = 4.8508e-03, PNorm = 68.6125, GNorm = 3.8504, lr_0 = 7.1497e-04
Validation rmse = 1.142451
Epoch 6
Loss = 3.7297e-03, PNorm = 68.6734, GNorm = 1.7609, lr_0 = 6.8956e-04
Loss = 4.4294e-03, PNorm = 68.7220, GNorm = 7.9700, lr_0 = 6.6725e-04
Loss = 5.3763e-03, PNorm = 68.7759, GNorm = 1.4999, lr_0 = 6.4565e-04
Validation rmse = 1.294927
Epoch 7
Loss = 4.6024e-03, PNorm = 68.8280, GNorm = 3.6785, lr_0 = 6.2476e-04
Loss = 4.1707e-03, PNorm = 68.8719, GNorm = 3.0750, lr_0 = 6.0454e-04
Validation rmse = 1.146602
Epoch 8
Loss = 3.3809e-03, PNorm = 68.9176, GNorm = 1.6378, lr_0 = 5.8498e-04
Loss = 2.9876e-03, PNorm = 68.9569, GNorm = 0.8950, lr_0 = 5.6605e-04
Loss = 3.4424e-03, PNorm = 68.9879, GNorm = 1.5630, lr_0 = 5.4774e-04
Validation rmse = 1.048799
Epoch 9
Loss = 3.7069e-03, PNorm = 69.0246, GNorm = 5.2574, lr_0 = 5.3001e-04
Loss = 2.5568e-03, PNorm = 69.0650, GNorm = 0.7142, lr_0 = 5.1286e-04
Validation rmse = 1.008343
Epoch 10
Loss = 3.5298e-03, PNorm = 69.0964, GNorm = 2.0557, lr_0 = 4.9627e-04
Loss = 3.0599e-03, PNorm = 69.1259, GNorm = 1.5149, lr_0 = 4.8021e-04
Loss = 2.5842e-03, PNorm = 69.1542, GNorm = 1.5311, lr_0 = 4.6467e-04
Validation rmse = 1.060118
Epoch 11
Loss = 3.1610e-03, PNorm = 69.1818, GNorm = 2.6268, lr_0 = 4.4963e-04
Loss = 2.4125e-03, PNorm = 69.2014, GNorm = 0.9205, lr_0 = 4.3508e-04
Validation rmse = 0.995710
Epoch 12
Loss = 2.2876e-03, PNorm = 69.2296, GNorm = 0.9946, lr_0 = 4.1962e-04
Loss = 2.4587e-03, PNorm = 69.2551, GNorm = 0.9252, lr_0 = 4.0604e-04
Loss = 2.8636e-03, PNorm = 69.2737, GNorm = 2.0820, lr_0 = 3.9290e-04
Validation rmse = 1.022700
Epoch 13
Loss = 3.0118e-03, PNorm = 69.3002, GNorm = 3.1866, lr_0 = 3.8019e-04
Loss = 2.5014e-03, PNorm = 69.3233, GNorm = 1.6667, lr_0 = 3.6789e-04
Loss = 2.6464e-03, PNorm = 69.3451, GNorm = 1.2285, lr_0 = 3.5598e-04
Validation rmse = 0.983299
Epoch 14
Loss = 2.3127e-03, PNorm = 69.3644, GNorm = 0.6305, lr_0 = 3.4446e-04
Loss = 2.1456e-03, PNorm = 69.3809, GNorm = 2.7677, lr_0 = 3.3332e-04
Validation rmse = 1.022842
Epoch 15
Loss = 1.9807e-03, PNorm = 69.3964, GNorm = 0.7652, lr_0 = 3.2253e-04
Loss = 2.6679e-03, PNorm = 69.4197, GNorm = 0.7218, lr_0 = 3.1209e-04
Loss = 2.4441e-03, PNorm = 69.4432, GNorm = 2.4440, lr_0 = 3.0200e-04
Validation rmse = 1.004455
Epoch 16
Loss = 2.0614e-03, PNorm = 69.4633, GNorm = 3.0581, lr_0 = 2.9222e-04
Loss = 2.1686e-03, PNorm = 69.4814, GNorm = 2.2985, lr_0 = 2.8277e-04
Validation rmse = 0.944269
Epoch 17
Loss = 2.0548e-03, PNorm = 69.4986, GNorm = 2.4062, lr_0 = 2.7272e-04
Loss = 2.1934e-03, PNorm = 69.5140, GNorm = 1.7463, lr_0 = 2.6389e-04
Loss = 1.9798e-03, PNorm = 69.5256, GNorm = 0.6704, lr_0 = 2.5535e-04
Validation rmse = 1.022860
Epoch 18
Loss = 2.5975e-03, PNorm = 69.5403, GNorm = 3.1493, lr_0 = 2.4709e-04
Loss = 2.0920e-03, PNorm = 69.5557, GNorm = 3.2206, lr_0 = 2.3910e-04
Loss = 2.3360e-03, PNorm = 69.5711, GNorm = 2.2377, lr_0 = 2.3136e-04
Validation rmse = 1.022281
Epoch 19
Loss = 2.4084e-03, PNorm = 69.5817, GNorm = 2.1877, lr_0 = 2.2387e-04
Loss = 1.9518e-03, PNorm = 69.5959, GNorm = 0.8651, lr_0 = 2.1663e-04
Validation rmse = 0.954964
Epoch 20
Loss = 1.5704e-03, PNorm = 69.6116, GNorm = 0.5087, lr_0 = 2.0962e-04
Loss = 2.2368e-03, PNorm = 69.6231, GNorm = 1.1194, lr_0 = 2.0283e-04
Loss = 1.9777e-03, PNorm = 69.6342, GNorm = 0.8740, lr_0 = 1.9627e-04
Validation rmse = 0.949218
Epoch 21
Loss = 1.7337e-03, PNorm = 69.6439, GNorm = 0.6722, lr_0 = 1.8992e-04
Loss = 1.6922e-03, PNorm = 69.6543, GNorm = 1.0625, lr_0 = 1.8377e-04
Validation rmse = 0.952516
Epoch 22
Loss = 1.5322e-03, PNorm = 69.6609, GNorm = 0.6784, lr_0 = 1.7783e-04
Loss = 1.8249e-03, PNorm = 69.6702, GNorm = 1.4594, lr_0 = 1.7207e-04
Loss = 2.0823e-03, PNorm = 69.6799, GNorm = 1.0396, lr_0 = 1.6651e-04
Validation rmse = 0.950977
Epoch 23
Loss = 1.8649e-03, PNorm = 69.6882, GNorm = 3.5522, lr_0 = 1.6059e-04
Loss = 2.0017e-03, PNorm = 69.6955, GNorm = 0.8659, lr_0 = 1.5539e-04
Validation rmse = 0.962791
Epoch 24
Loss = 1.5625e-03, PNorm = 69.7051, GNorm = 0.9331, lr_0 = 1.5036e-04
Loss = 1.6890e-03, PNorm = 69.7126, GNorm = 0.7494, lr_0 = 1.4550e-04
Loss = 1.8187e-03, PNorm = 69.7214, GNorm = 0.7063, lr_0 = 1.4079e-04
Validation rmse = 0.967747
Epoch 25
Loss = 1.8937e-03, PNorm = 69.7271, GNorm = 1.2778, lr_0 = 1.3623e-04
Loss = 1.4305e-03, PNorm = 69.7329, GNorm = 0.5602, lr_0 = 1.3183e-04
Loss = 2.1031e-03, PNorm = 69.7382, GNorm = 1.0078, lr_0 = 1.2756e-04
Validation rmse = 0.951309
Epoch 26
Loss = 1.7439e-03, PNorm = 69.7452, GNorm = 1.2666, lr_0 = 1.2343e-04
Loss = 1.6862e-03, PNorm = 69.7513, GNorm = 0.8782, lr_0 = 1.1944e-04
Validation rmse = 0.969658
Epoch 27
Loss = 1.5775e-03, PNorm = 69.7568, GNorm = 1.2282, lr_0 = 1.1557e-04
Loss = 1.7366e-03, PNorm = 69.7628, GNorm = 1.0604, lr_0 = 1.1183e-04
Loss = 1.7790e-03, PNorm = 69.7692, GNorm = 0.7320, lr_0 = 1.0821e-04
Validation rmse = 0.990125
Epoch 28
Loss = 1.7609e-03, PNorm = 69.7749, GNorm = 0.8465, lr_0 = 1.0437e-04
Loss = 1.6176e-03, PNorm = 69.7793, GNorm = 2.3118, lr_0 = 1.0099e-04
Validation rmse = 0.950454
Epoch 29
Loss = 1.4546e-03, PNorm = 69.7841, GNorm = 0.6996, lr_0 = 1.0000e-04
Loss = 1.5549e-03, PNorm = 69.7884, GNorm = 1.4356, lr_0 = 1.0000e-04
Loss = 1.8692e-03, PNorm = 69.7924, GNorm = 0.8516, lr_0 = 1.0000e-04
Validation rmse = 0.949992
Model 0 best validation rmse = 0.944269 on epoch 16
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.819215
Ensemble test rmse = 0.819215
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.30000000000000004_ffn_num_layers_2_hidden_size_1400/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=1400, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,276,201
Moving model to cuda
Epoch 0
Loss = 1.8119e-02, PNorm = 67.3346, GNorm = 3.8728, lr_0 = 2.9800e-04
Loss = 1.3762e-02, PNorm = 67.3955, GNorm = 5.6752, lr_0 = 4.7800e-04
Validation rmse = 2.033403
Epoch 1
Loss = 1.5680e-02, PNorm = 67.4870, GNorm = 5.9618, lr_0 = 6.7600e-04
Loss = 1.2081e-02, PNorm = 67.6140, GNorm = 1.8054, lr_0 = 8.5600e-04
Loss = 9.0739e-03, PNorm = 67.7637, GNorm = 2.5801, lr_0 = 9.9344e-04
Validation rmse = 1.836369
Epoch 2
Loss = 9.2988e-03, PNorm = 67.9044, GNorm = 2.3322, lr_0 = 9.6130e-04
Loss = 6.9748e-03, PNorm = 68.0350, GNorm = 3.4465, lr_0 = 9.3019e-04
Validation rmse = 1.448313
Epoch 3
Loss = 6.2543e-03, PNorm = 68.1267, GNorm = 1.4354, lr_0 = 9.0009e-04
Loss = 5.2830e-03, PNorm = 68.2104, GNorm = 1.9755, lr_0 = 8.7096e-04
Loss = 6.2728e-03, PNorm = 68.2932, GNorm = 4.9672, lr_0 = 8.4278e-04
Validation rmse = 1.202102
Epoch 4
Loss = 5.5084e-03, PNorm = 68.3791, GNorm = 4.9187, lr_0 = 8.1551e-04
Loss = 4.3554e-03, PNorm = 68.4451, GNorm = 1.5207, lr_0 = 7.8912e-04
Validation rmse = 0.979830
Epoch 5
Loss = 4.7830e-03, PNorm = 68.5026, GNorm = 1.9601, lr_0 = 7.6358e-04
Loss = 4.1224e-03, PNorm = 68.5687, GNorm = 0.8749, lr_0 = 7.3888e-04
Loss = 4.9685e-03, PNorm = 68.6179, GNorm = 5.0523, lr_0 = 7.1497e-04
Validation rmse = 1.163910
Epoch 6
Loss = 6.3223e-03, PNorm = 68.6680, GNorm = 4.1416, lr_0 = 6.8956e-04
Loss = 5.2667e-03, PNorm = 68.7204, GNorm = 0.8374, lr_0 = 6.6725e-04
Loss = 4.4650e-03, PNorm = 68.7731, GNorm = 3.3189, lr_0 = 6.4565e-04
Validation rmse = 0.835103
Epoch 7
Loss = 3.6102e-03, PNorm = 68.8175, GNorm = 1.6160, lr_0 = 6.2476e-04
Loss = 3.7313e-03, PNorm = 68.8560, GNorm = 3.3117, lr_0 = 6.0454e-04
Validation rmse = 1.006353
Epoch 8
Loss = 3.0854e-03, PNorm = 68.8993, GNorm = 1.1353, lr_0 = 5.8498e-04
Loss = 3.3530e-03, PNorm = 68.9316, GNorm = 1.9584, lr_0 = 5.6605e-04
Loss = 3.2785e-03, PNorm = 68.9668, GNorm = 2.8389, lr_0 = 5.4774e-04
Validation rmse = 0.819673
Epoch 9
Loss = 3.2468e-03, PNorm = 69.0014, GNorm = 3.5757, lr_0 = 5.3001e-04
Loss = 3.7556e-03, PNorm = 69.0385, GNorm = 3.2458, lr_0 = 5.1286e-04
Validation rmse = 0.860403
Epoch 10
Loss = 2.7020e-03, PNorm = 69.0703, GNorm = 1.6397, lr_0 = 4.9627e-04
Loss = 2.8384e-03, PNorm = 69.1026, GNorm = 0.9012, lr_0 = 4.8021e-04
Loss = 3.3092e-03, PNorm = 69.1284, GNorm = 3.6542, lr_0 = 4.6467e-04
Validation rmse = 0.902228
Epoch 11
Loss = 3.1203e-03, PNorm = 69.1575, GNorm = 2.9252, lr_0 = 4.4963e-04
Loss = 2.4939e-03, PNorm = 69.1844, GNorm = 1.1031, lr_0 = 4.3508e-04
Validation rmse = 0.886211
Epoch 12
Loss = 2.8063e-03, PNorm = 69.2054, GNorm = 1.1920, lr_0 = 4.1962e-04
Loss = 2.9645e-03, PNorm = 69.2299, GNorm = 2.7804, lr_0 = 4.0604e-04
Loss = 2.9761e-03, PNorm = 69.2538, GNorm = 1.3412, lr_0 = 3.9290e-04
Validation rmse = 0.879279
Epoch 13
Loss = 2.6415e-03, PNorm = 69.2720, GNorm = 1.4754, lr_0 = 3.8019e-04
Loss = 2.4428e-03, PNorm = 69.2885, GNorm = 0.9587, lr_0 = 3.6789e-04
Loss = 2.5920e-03, PNorm = 69.3093, GNorm = 2.0785, lr_0 = 3.5598e-04
Validation rmse = 0.766762
Epoch 14
Loss = 2.6435e-03, PNorm = 69.3297, GNorm = 2.4634, lr_0 = 3.4446e-04
Loss = 2.9099e-03, PNorm = 69.3478, GNorm = 3.1934, lr_0 = 3.3332e-04
Validation rmse = 0.853708
Epoch 15
Loss = 1.7249e-03, PNorm = 69.3682, GNorm = 1.7124, lr_0 = 3.2253e-04
Loss = 2.6407e-03, PNorm = 69.3927, GNorm = 0.8743, lr_0 = 3.1209e-04
Loss = 2.4046e-03, PNorm = 69.4100, GNorm = 2.4931, lr_0 = 3.0200e-04
Validation rmse = 0.915166
Epoch 16
Loss = 2.5052e-03, PNorm = 69.4289, GNorm = 3.3558, lr_0 = 2.9222e-04
Loss = 2.5357e-03, PNorm = 69.4490, GNorm = 2.5956, lr_0 = 2.8277e-04
Validation rmse = 0.802725
Epoch 17
Loss = 1.9324e-03, PNorm = 69.4602, GNorm = 1.7348, lr_0 = 2.7272e-04
Loss = 2.0525e-03, PNorm = 69.4707, GNorm = 1.6078, lr_0 = 2.6389e-04
Loss = 2.5828e-03, PNorm = 69.4871, GNorm = 1.3397, lr_0 = 2.5535e-04
Validation rmse = 0.804980
Epoch 18
Loss = 1.8523e-03, PNorm = 69.5035, GNorm = 1.0920, lr_0 = 2.4709e-04
Loss = 2.1772e-03, PNorm = 69.5140, GNorm = 1.3688, lr_0 = 2.3910e-04
Loss = 2.3447e-03, PNorm = 69.5192, GNorm = 2.0233, lr_0 = 2.3136e-04
Validation rmse = 0.809069
Epoch 19
Loss = 2.0636e-03, PNorm = 69.5260, GNorm = 0.8345, lr_0 = 2.2387e-04
Loss = 1.9880e-03, PNorm = 69.5389, GNorm = 0.6691, lr_0 = 2.1663e-04
Validation rmse = 0.779390
Epoch 20
Loss = 2.5596e-03, PNorm = 69.5504, GNorm = 0.8685, lr_0 = 2.0962e-04
Loss = 2.2139e-03, PNorm = 69.5590, GNorm = 2.0536, lr_0 = 2.0283e-04
Loss = 1.9822e-03, PNorm = 69.5695, GNorm = 0.5622, lr_0 = 1.9627e-04
Validation rmse = 0.841779
Epoch 21
Loss = 2.0328e-03, PNorm = 69.5817, GNorm = 2.4763, lr_0 = 1.8992e-04
Loss = 1.9499e-03, PNorm = 69.5905, GNorm = 1.1799, lr_0 = 1.8377e-04
Validation rmse = 0.738958
Epoch 22
Loss = 1.9538e-03, PNorm = 69.5987, GNorm = 1.0524, lr_0 = 1.7783e-04
Loss = 2.0326e-03, PNorm = 69.6083, GNorm = 1.8842, lr_0 = 1.7207e-04
Loss = 1.8849e-03, PNorm = 69.6151, GNorm = 0.8973, lr_0 = 1.6651e-04
Validation rmse = 0.819501
Epoch 23
Loss = 1.5687e-03, PNorm = 69.6248, GNorm = 0.6967, lr_0 = 1.6059e-04
Loss = 2.0291e-03, PNorm = 69.6317, GNorm = 0.9882, lr_0 = 1.5539e-04
Validation rmse = 0.919569
Epoch 24
Loss = 1.2005e-03, PNorm = 69.6388, GNorm = 1.2777, lr_0 = 1.5036e-04
Loss = 1.9520e-03, PNorm = 69.6459, GNorm = 0.7796, lr_0 = 1.4550e-04
Loss = 2.0892e-03, PNorm = 69.6526, GNorm = 0.9162, lr_0 = 1.4079e-04
Validation rmse = 0.771744
Epoch 25
Loss = 1.2643e-03, PNorm = 69.6584, GNorm = 1.1761, lr_0 = 1.3623e-04
Loss = 1.8364e-03, PNorm = 69.6666, GNorm = 1.1884, lr_0 = 1.3183e-04
Loss = 2.0158e-03, PNorm = 69.6730, GNorm = 0.9900, lr_0 = 1.2756e-04
Validation rmse = 0.759222
Epoch 26
Loss = 1.6217e-03, PNorm = 69.6754, GNorm = 0.9636, lr_0 = 1.2343e-04
Loss = 1.7225e-03, PNorm = 69.6811, GNorm = 1.3094, lr_0 = 1.1944e-04
Validation rmse = 0.754060
Epoch 27
Loss = 1.5200e-03, PNorm = 69.6853, GNorm = 1.1124, lr_0 = 1.1557e-04
Loss = 1.8792e-03, PNorm = 69.6931, GNorm = 0.7866, lr_0 = 1.1183e-04
Loss = 1.9810e-03, PNorm = 69.6976, GNorm = 1.3262, lr_0 = 1.0821e-04
Validation rmse = 0.766115
Epoch 28
Loss = 1.6535e-03, PNorm = 69.7027, GNorm = 1.5425, lr_0 = 1.0437e-04
Loss = 1.6848e-03, PNorm = 69.7082, GNorm = 1.0049, lr_0 = 1.0099e-04
Validation rmse = 0.747391
Epoch 29
Loss = 1.6558e-03, PNorm = 69.7143, GNorm = 1.6077, lr_0 = 1.0000e-04
Loss = 1.8562e-03, PNorm = 69.7190, GNorm = 2.0523, lr_0 = 1.0000e-04
Loss = 1.6510e-03, PNorm = 69.7239, GNorm = 1.3402, lr_0 = 1.0000e-04
Validation rmse = 0.786894
Model 0 best validation rmse = 0.738958 on epoch 21
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.705032
Ensemble test rmse = 0.705032
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.30000000000000004_ffn_num_layers_2_hidden_size_1400/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=1400, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,276,201
Moving model to cuda
Epoch 0
Loss = 1.7968e-02, PNorm = 67.3366, GNorm = 2.9980, lr_0 = 2.9800e-04
Loss = 1.3467e-02, PNorm = 67.3945, GNorm = 5.9362, lr_0 = 4.7800e-04
Validation rmse = 1.953170
Epoch 1
Loss = 1.3571e-02, PNorm = 67.4897, GNorm = 8.7132, lr_0 = 6.7600e-04
Loss = 1.0742e-02, PNorm = 67.6077, GNorm = 4.5796, lr_0 = 8.5600e-04
Loss = 8.7691e-03, PNorm = 67.7445, GNorm = 7.4993, lr_0 = 9.9344e-04
Validation rmse = 1.642625
Epoch 2
Loss = 7.5420e-03, PNorm = 67.8802, GNorm = 1.7556, lr_0 = 9.6130e-04
Loss = 7.0758e-03, PNorm = 68.0031, GNorm = 5.4105, lr_0 = 9.3019e-04
Validation rmse = 1.541062
Epoch 3
Loss = 5.8485e-03, PNorm = 68.1133, GNorm = 2.4640, lr_0 = 9.0009e-04
Loss = 6.7187e-03, PNorm = 68.1999, GNorm = 3.9948, lr_0 = 8.7096e-04
Loss = 6.0889e-03, PNorm = 68.2874, GNorm = 1.3035, lr_0 = 8.4278e-04
Validation rmse = 1.153927
Epoch 4
Loss = 5.0083e-03, PNorm = 68.3629, GNorm = 2.3387, lr_0 = 8.1551e-04
Loss = 4.9180e-03, PNorm = 68.4382, GNorm = 4.7342, lr_0 = 7.8912e-04
Validation rmse = 1.144925
Epoch 5
Loss = 2.9687e-03, PNorm = 68.5005, GNorm = 1.7724, lr_0 = 7.6358e-04
Loss = 3.7039e-03, PNorm = 68.5490, GNorm = 5.2112, lr_0 = 7.3888e-04
Loss = 4.6651e-03, PNorm = 68.5898, GNorm = 1.9603, lr_0 = 7.1497e-04
Validation rmse = 1.062555
Epoch 6
Loss = 3.6637e-03, PNorm = 68.6416, GNorm = 1.9712, lr_0 = 6.8956e-04
Loss = 3.9654e-03, PNorm = 68.6878, GNorm = 1.2238, lr_0 = 6.6725e-04
Loss = 4.3108e-03, PNorm = 68.7311, GNorm = 3.8121, lr_0 = 6.4565e-04
Validation rmse = 1.062362
Epoch 7
Loss = 3.3888e-03, PNorm = 68.7669, GNorm = 2.0162, lr_0 = 6.2476e-04
Loss = 3.6202e-03, PNorm = 68.7995, GNorm = 0.7067, lr_0 = 6.0454e-04
Validation rmse = 1.044355
Epoch 8
Loss = 3.2860e-03, PNorm = 68.8364, GNorm = 3.0435, lr_0 = 5.8498e-04
Loss = 3.5803e-03, PNorm = 68.8729, GNorm = 2.6485, lr_0 = 5.6605e-04
Loss = 2.8988e-03, PNorm = 68.9112, GNorm = 1.7760, lr_0 = 5.4774e-04
Validation rmse = 0.972754
Epoch 9
Loss = 2.7761e-03, PNorm = 68.9354, GNorm = 0.9900, lr_0 = 5.3001e-04
Loss = 3.1203e-03, PNorm = 68.9701, GNorm = 1.0859, lr_0 = 5.1286e-04
Validation rmse = 1.034669
Epoch 10
Loss = 2.9512e-03, PNorm = 68.9995, GNorm = 0.8250, lr_0 = 4.9627e-04
Loss = 3.3416e-03, PNorm = 69.0315, GNorm = 1.2232, lr_0 = 4.8021e-04
Loss = 3.3023e-03, PNorm = 69.0549, GNorm = 0.9725, lr_0 = 4.6467e-04
Validation rmse = 0.962824
Epoch 11
Loss = 2.8686e-03, PNorm = 69.0823, GNorm = 0.7929, lr_0 = 4.4963e-04
Loss = 2.7419e-03, PNorm = 69.1081, GNorm = 3.6087, lr_0 = 4.3508e-04
Validation rmse = 0.907666
Epoch 12
Loss = 2.4479e-03, PNorm = 69.1364, GNorm = 1.5976, lr_0 = 4.1962e-04
Loss = 2.5073e-03, PNorm = 69.1567, GNorm = 3.9095, lr_0 = 4.0604e-04
Loss = 2.8301e-03, PNorm = 69.1802, GNorm = 3.2486, lr_0 = 3.9290e-04
Validation rmse = 0.867411
Epoch 13
Loss = 2.7593e-03, PNorm = 69.2049, GNorm = 1.0867, lr_0 = 3.8019e-04
Loss = 3.6657e-03, PNorm = 69.2269, GNorm = 2.8293, lr_0 = 3.6789e-04
Loss = 2.8219e-03, PNorm = 69.2517, GNorm = 1.7938, lr_0 = 3.5598e-04
Validation rmse = 0.883164
Epoch 14
Loss = 2.5298e-03, PNorm = 69.2710, GNorm = 1.9438, lr_0 = 3.4446e-04
Loss = 2.3023e-03, PNorm = 69.2889, GNorm = 1.1592, lr_0 = 3.3332e-04
Validation rmse = 0.869812
Epoch 15
Loss = 2.4374e-03, PNorm = 69.3070, GNorm = 1.2103, lr_0 = 3.2253e-04
Loss = 2.4836e-03, PNorm = 69.3250, GNorm = 1.3162, lr_0 = 3.1209e-04
Loss = 2.3073e-03, PNorm = 69.3408, GNorm = 0.9522, lr_0 = 3.0200e-04
Validation rmse = 0.868370
Epoch 16
Loss = 2.2419e-03, PNorm = 69.3552, GNorm = 1.4103, lr_0 = 2.9222e-04
Loss = 2.2555e-03, PNorm = 69.3704, GNorm = 1.4537, lr_0 = 2.8277e-04
Validation rmse = 0.899486
Epoch 17
Loss = 2.3843e-03, PNorm = 69.3869, GNorm = 1.8670, lr_0 = 2.7272e-04
Loss = 2.6602e-03, PNorm = 69.4034, GNorm = 0.7132, lr_0 = 2.6389e-04
Loss = 1.9390e-03, PNorm = 69.4164, GNorm = 0.7437, lr_0 = 2.5535e-04
Validation rmse = 0.858831
Epoch 18
Loss = 2.1581e-03, PNorm = 69.4268, GNorm = 0.7690, lr_0 = 2.4709e-04
Loss = 2.2694e-03, PNorm = 69.4379, GNorm = 1.5718, lr_0 = 2.3910e-04
Loss = 2.3529e-03, PNorm = 69.4522, GNorm = 1.7615, lr_0 = 2.3136e-04
Validation rmse = 0.867603
Epoch 19
Loss = 2.3408e-03, PNorm = 69.4666, GNorm = 3.7908, lr_0 = 2.2387e-04
Loss = 1.9305e-03, PNorm = 69.4782, GNorm = 2.2146, lr_0 = 2.1663e-04
Validation rmse = 0.877118
Epoch 20
Loss = 2.2106e-03, PNorm = 69.4869, GNorm = 2.0841, lr_0 = 2.0962e-04
Loss = 2.2779e-03, PNorm = 69.4973, GNorm = 0.5476, lr_0 = 2.0283e-04
Loss = 2.2544e-03, PNorm = 69.5087, GNorm = 1.8750, lr_0 = 1.9627e-04
Validation rmse = 0.834790
Epoch 21
Loss = 1.9044e-03, PNorm = 69.5149, GNorm = 0.9043, lr_0 = 1.8992e-04
Loss = 2.2201e-03, PNorm = 69.5228, GNorm = 1.1834, lr_0 = 1.8377e-04
Validation rmse = 0.848395
Epoch 22
Loss = 2.1209e-03, PNorm = 69.5317, GNorm = 2.7302, lr_0 = 1.7783e-04
Loss = 1.8679e-03, PNorm = 69.5417, GNorm = 0.6561, lr_0 = 1.7207e-04
Loss = 2.3356e-03, PNorm = 69.5505, GNorm = 0.8692, lr_0 = 1.6651e-04
Validation rmse = 0.844383
Epoch 23
Loss = 2.0894e-03, PNorm = 69.5593, GNorm = 1.0216, lr_0 = 1.6059e-04
Loss = 1.8286e-03, PNorm = 69.5668, GNorm = 0.9622, lr_0 = 1.5539e-04
Validation rmse = 0.851037
Epoch 24
Loss = 2.1923e-03, PNorm = 69.5748, GNorm = 1.3019, lr_0 = 1.5036e-04
Loss = 2.2624e-03, PNorm = 69.5816, GNorm = 1.1293, lr_0 = 1.4550e-04
Loss = 1.8828e-03, PNorm = 69.5874, GNorm = 1.3720, lr_0 = 1.4079e-04
Validation rmse = 0.847642
Epoch 25
Loss = 1.7322e-03, PNorm = 69.5933, GNorm = 0.7855, lr_0 = 1.3623e-04
Loss = 1.8377e-03, PNorm = 69.6003, GNorm = 2.6432, lr_0 = 1.3183e-04
Loss = 2.0307e-03, PNorm = 69.6084, GNorm = 0.8388, lr_0 = 1.2756e-04
Validation rmse = 0.849956
Epoch 26
Loss = 1.8798e-03, PNorm = 69.6145, GNorm = 1.6755, lr_0 = 1.2343e-04
Loss = 1.7229e-03, PNorm = 69.6201, GNorm = 0.5404, lr_0 = 1.1944e-04
Validation rmse = 0.841795
Epoch 27
Loss = 1.8179e-03, PNorm = 69.6265, GNorm = 0.9190, lr_0 = 1.1557e-04
Loss = 1.8097e-03, PNorm = 69.6313, GNorm = 0.4707, lr_0 = 1.1183e-04
Loss = 1.8248e-03, PNorm = 69.6362, GNorm = 0.9625, lr_0 = 1.0821e-04
Validation rmse = 0.848847
Epoch 28
Loss = 1.9318e-03, PNorm = 69.6431, GNorm = 0.6121, lr_0 = 1.0437e-04
Loss = 1.7429e-03, PNorm = 69.6478, GNorm = 0.4587, lr_0 = 1.0099e-04
Validation rmse = 0.841129
Epoch 29
Loss = 1.5383e-03, PNorm = 69.6530, GNorm = 1.1887, lr_0 = 1.0000e-04
Loss = 1.9965e-03, PNorm = 69.6577, GNorm = 0.8231, lr_0 = 1.0000e-04
Loss = 1.7865e-03, PNorm = 69.6608, GNorm = 3.2632, lr_0 = 1.0000e-04
Validation rmse = 0.895618
Model 0 best validation rmse = 0.834790 on epoch 20
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.775208
Ensemble test rmse = 0.775208
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.30000000000000004_ffn_num_layers_2_hidden_size_1400/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=1400, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,276,201
Moving model to cuda
Epoch 0
Loss = 1.7358e-02, PNorm = 67.3374, GNorm = 3.8839, lr_0 = 2.9800e-04
Loss = 1.5360e-02, PNorm = 67.3994, GNorm = 20.7705, lr_0 = 4.7800e-04
Validation rmse = 1.736873
Epoch 1
Loss = 1.2472e-02, PNorm = 67.4871, GNorm = 4.0534, lr_0 = 6.7600e-04
Loss = 1.1230e-02, PNorm = 67.6149, GNorm = 4.0890, lr_0 = 8.5600e-04
Loss = 9.5294e-03, PNorm = 67.7488, GNorm = 2.5918, lr_0 = 9.9344e-04
Validation rmse = 1.489287
Epoch 2
Loss = 8.3951e-03, PNorm = 67.8934, GNorm = 2.0390, lr_0 = 9.6130e-04
Loss = 5.7193e-03, PNorm = 68.0146, GNorm = 1.7886, lr_0 = 9.3019e-04
Validation rmse = 1.286586
Epoch 3
Loss = 5.0691e-03, PNorm = 68.1102, GNorm = 3.4446, lr_0 = 9.0009e-04
Loss = 6.0871e-03, PNorm = 68.1978, GNorm = 4.5287, lr_0 = 8.7096e-04
Loss = 5.5553e-03, PNorm = 68.2820, GNorm = 3.4503, lr_0 = 8.4278e-04
Validation rmse = 1.209798
Epoch 4
Loss = 4.8018e-03, PNorm = 68.3578, GNorm = 2.4502, lr_0 = 8.1551e-04
Loss = 5.0306e-03, PNorm = 68.4265, GNorm = 0.9783, lr_0 = 7.8912e-04
Validation rmse = 1.037381
Epoch 5
Loss = 3.8298e-03, PNorm = 68.4910, GNorm = 2.8321, lr_0 = 7.6358e-04
Loss = 4.9409e-03, PNorm = 68.5437, GNorm = 3.4640, lr_0 = 7.3888e-04
Loss = 4.9337e-03, PNorm = 68.5970, GNorm = 6.3097, lr_0 = 7.1497e-04
Validation rmse = 1.175536
Epoch 6
Loss = 4.1990e-03, PNorm = 68.6568, GNorm = 1.4910, lr_0 = 6.8956e-04
Loss = 4.3053e-03, PNorm = 68.7058, GNorm = 1.6308, lr_0 = 6.6725e-04
Loss = 3.3787e-03, PNorm = 68.7426, GNorm = 1.5694, lr_0 = 6.4565e-04
Validation rmse = 0.946906
Epoch 7
Loss = 3.0100e-03, PNorm = 68.7936, GNorm = 0.8563, lr_0 = 6.2476e-04
Loss = 3.1471e-03, PNorm = 68.8261, GNorm = 2.1322, lr_0 = 6.0454e-04
Validation rmse = 0.923554
Epoch 8
Loss = 2.7921e-03, PNorm = 68.8609, GNorm = 1.0991, lr_0 = 5.8498e-04
Loss = 3.4620e-03, PNorm = 68.8963, GNorm = 1.3109, lr_0 = 5.6605e-04
Loss = 3.1493e-03, PNorm = 68.9297, GNorm = 1.3546, lr_0 = 5.4774e-04
Validation rmse = 0.934012
Epoch 9
Loss = 2.2758e-03, PNorm = 68.9613, GNorm = 1.1949, lr_0 = 5.3001e-04
Loss = 3.3451e-03, PNorm = 68.9946, GNorm = 1.3089, lr_0 = 5.1286e-04
Validation rmse = 0.918127
Epoch 10
Loss = 2.9038e-03, PNorm = 69.0359, GNorm = 3.1303, lr_0 = 4.9627e-04
Loss = 3.3150e-03, PNorm = 69.0672, GNorm = 2.2295, lr_0 = 4.8021e-04
Loss = 2.9124e-03, PNorm = 69.0985, GNorm = 3.2393, lr_0 = 4.6467e-04
Validation rmse = 0.879975
Epoch 11
Loss = 2.5328e-03, PNorm = 69.1294, GNorm = 1.2322, lr_0 = 4.4963e-04
Loss = 2.5949e-03, PNorm = 69.1555, GNorm = 2.7560, lr_0 = 4.3508e-04
Validation rmse = 0.931958
Epoch 12
Loss = 2.8254e-03, PNorm = 69.1761, GNorm = 2.7927, lr_0 = 4.1962e-04
Loss = 2.5728e-03, PNorm = 69.2013, GNorm = 0.9238, lr_0 = 4.0604e-04
Loss = 2.3815e-03, PNorm = 69.2271, GNorm = 0.9264, lr_0 = 3.9290e-04
Validation rmse = 0.864277
Epoch 13
Loss = 2.1877e-03, PNorm = 69.2414, GNorm = 3.9127, lr_0 = 3.8019e-04
Loss = 2.1097e-03, PNorm = 69.2602, GNorm = 3.7730, lr_0 = 3.6789e-04
Loss = 2.6133e-03, PNorm = 69.2767, GNorm = 1.6799, lr_0 = 3.5598e-04
Validation rmse = 0.879310
Epoch 14
Loss = 2.2825e-03, PNorm = 69.2949, GNorm = 0.9658, lr_0 = 3.4446e-04
Loss = 2.1422e-03, PNorm = 69.3176, GNorm = 0.6295, lr_0 = 3.3332e-04
Validation rmse = 0.985896
Epoch 15
Loss = 3.1152e-03, PNorm = 69.3354, GNorm = 2.3796, lr_0 = 3.2253e-04
Loss = 2.3862e-03, PNorm = 69.3493, GNorm = 0.6919, lr_0 = 3.1209e-04
Loss = 1.9564e-03, PNorm = 69.3666, GNorm = 2.1759, lr_0 = 3.0200e-04
Validation rmse = 0.843397
Epoch 16
Loss = 2.0396e-03, PNorm = 69.3848, GNorm = 1.9284, lr_0 = 2.9222e-04
Loss = 1.8854e-03, PNorm = 69.3990, GNorm = 0.9273, lr_0 = 2.8277e-04
Validation rmse = 0.838483
Epoch 17
Loss = 1.8002e-03, PNorm = 69.4161, GNorm = 1.9720, lr_0 = 2.7272e-04
Loss = 2.1920e-03, PNorm = 69.4282, GNorm = 1.2213, lr_0 = 2.6389e-04
Loss = 2.3145e-03, PNorm = 69.4380, GNorm = 1.2667, lr_0 = 2.5535e-04
Validation rmse = 0.857038
Epoch 18
Loss = 2.0703e-03, PNorm = 69.4461, GNorm = 0.7797, lr_0 = 2.4709e-04
Loss = 2.2143e-03, PNorm = 69.4580, GNorm = 1.8841, lr_0 = 2.3910e-04
Loss = 1.7417e-03, PNorm = 69.4726, GNorm = 2.2612, lr_0 = 2.3136e-04
Validation rmse = 0.823854
Epoch 19
Loss = 2.0780e-03, PNorm = 69.4876, GNorm = 0.8512, lr_0 = 2.2387e-04
Loss = 1.9891e-03, PNorm = 69.4944, GNorm = 1.3077, lr_0 = 2.1663e-04
Validation rmse = 0.811517
Epoch 20
Loss = 1.5580e-03, PNorm = 69.5067, GNorm = 1.5123, lr_0 = 2.0962e-04
Loss = 1.9865e-03, PNorm = 69.5169, GNorm = 0.8620, lr_0 = 2.0283e-04
Loss = 1.8352e-03, PNorm = 69.5232, GNorm = 0.6453, lr_0 = 1.9627e-04
Validation rmse = 0.872116
Epoch 21
Loss = 2.1646e-03, PNorm = 69.5317, GNorm = 0.9667, lr_0 = 1.8992e-04
Loss = 2.0201e-03, PNorm = 69.5429, GNorm = 0.7486, lr_0 = 1.8377e-04
Validation rmse = 0.823263
Epoch 22
Loss = 1.7381e-03, PNorm = 69.5521, GNorm = 0.6088, lr_0 = 1.7783e-04
Loss = 1.6318e-03, PNorm = 69.5627, GNorm = 0.6849, lr_0 = 1.7207e-04
Loss = 1.7494e-03, PNorm = 69.5692, GNorm = 1.3883, lr_0 = 1.6651e-04
Validation rmse = 0.831138
Epoch 23
Loss = 1.9929e-03, PNorm = 69.5748, GNorm = 0.5436, lr_0 = 1.6059e-04
Loss = 1.8350e-03, PNorm = 69.5818, GNorm = 0.9969, lr_0 = 1.5539e-04
Validation rmse = 0.796166
Epoch 24
Loss = 1.4963e-03, PNorm = 69.5904, GNorm = 0.6030, lr_0 = 1.5036e-04
Loss = 1.7657e-03, PNorm = 69.5990, GNorm = 0.8555, lr_0 = 1.4550e-04
Loss = 2.0440e-03, PNorm = 69.6059, GNorm = 1.7562, lr_0 = 1.4079e-04
Validation rmse = 0.813385
Epoch 25
Loss = 1.7463e-03, PNorm = 69.6112, GNorm = 0.5795, lr_0 = 1.3623e-04
Loss = 1.8870e-03, PNorm = 69.6170, GNorm = 1.9910, lr_0 = 1.3183e-04
Loss = 2.0678e-03, PNorm = 69.6217, GNorm = 1.3512, lr_0 = 1.2756e-04
Validation rmse = 0.799530
Epoch 26
Loss = 1.8256e-03, PNorm = 69.6276, GNorm = 1.1628, lr_0 = 1.2343e-04
Loss = 1.6892e-03, PNorm = 69.6350, GNorm = 1.1401, lr_0 = 1.1944e-04
Validation rmse = 0.797474
Epoch 27
Loss = 1.7289e-03, PNorm = 69.6402, GNorm = 2.4033, lr_0 = 1.1557e-04
Loss = 1.7361e-03, PNorm = 69.6445, GNorm = 1.3296, lr_0 = 1.1183e-04
Loss = 1.8299e-03, PNorm = 69.6509, GNorm = 1.1222, lr_0 = 1.0821e-04
Validation rmse = 0.826383
Epoch 28
Loss = 1.7732e-03, PNorm = 69.6570, GNorm = 1.5300, lr_0 = 1.0437e-04
Loss = 1.7969e-03, PNorm = 69.6611, GNorm = 1.5193, lr_0 = 1.0099e-04
Validation rmse = 0.801385
Epoch 29
Loss = 1.5714e-03, PNorm = 69.6659, GNorm = 2.2143, lr_0 = 1.0000e-04
Loss = 1.7589e-03, PNorm = 69.6714, GNorm = 1.3649, lr_0 = 1.0000e-04
Loss = 1.6300e-03, PNorm = 69.6758, GNorm = 1.6954, lr_0 = 1.0000e-04
Validation rmse = 0.789025
Model 0 best validation rmse = 0.789025 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.790986
Ensemble test rmse = 0.790986
10-fold cross validation
	Seed 0 ==> test rmse = 0.761586
	Seed 1 ==> test rmse = 0.750693
	Seed 2 ==> test rmse = 0.734320
	Seed 3 ==> test rmse = 0.817007
	Seed 4 ==> test rmse = 0.937639
	Seed 5 ==> test rmse = 0.678481
	Seed 6 ==> test rmse = 0.819215
	Seed 7 ==> test rmse = 0.705032
	Seed 8 ==> test rmse = 0.775208
	Seed 9 ==> test rmse = 0.790986
Overall test rmse = 0.777017 +/- 0.068573
Elapsed time = 0:07:55
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_500/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=500, out_features=500, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 1,142,001
Moving model to cuda
Epoch 0
Loss = 1.8859e-02, PNorm = 47.8630, GNorm = 8.8139, lr_0 = 2.9800e-04
Loss = 1.8619e-02, PNorm = 47.8745, GNorm = 6.1589, lr_0 = 4.7800e-04
Validation rmse = 1.850051
Epoch 1
Loss = 1.2508e-02, PNorm = 47.9026, GNorm = 3.7077, lr_0 = 6.7600e-04
Loss = 1.1413e-02, PNorm = 47.9419, GNorm = 3.2859, lr_0 = 8.5600e-04
Loss = 8.9960e-03, PNorm = 47.9868, GNorm = 4.3565, lr_0 = 9.9344e-04
Validation rmse = 1.302836
Epoch 2
Loss = 7.8720e-03, PNorm = 48.0308, GNorm = 5.3217, lr_0 = 9.6130e-04
Loss = 6.9386e-03, PNorm = 48.0684, GNorm = 6.2429, lr_0 = 9.3019e-04
Validation rmse = 1.229284
Epoch 3
Loss = 6.7154e-03, PNorm = 48.0954, GNorm = 4.3653, lr_0 = 9.0009e-04
Loss = 6.6236e-03, PNorm = 48.1219, GNorm = 1.6646, lr_0 = 8.7096e-04
Loss = 7.0924e-03, PNorm = 48.1510, GNorm = 3.1802, lr_0 = 8.4278e-04
Validation rmse = 1.179603
Epoch 4
Loss = 5.5788e-03, PNorm = 48.1736, GNorm = 5.0379, lr_0 = 8.1551e-04
Loss = 5.5810e-03, PNorm = 48.1863, GNorm = 0.8354, lr_0 = 7.8912e-04
Validation rmse = 1.481504
Epoch 5
Loss = 6.9301e-03, PNorm = 48.2045, GNorm = 7.2416, lr_0 = 7.6358e-04
Loss = 5.9620e-03, PNorm = 48.2240, GNorm = 3.3125, lr_0 = 7.3888e-04
Loss = 4.7240e-03, PNorm = 48.2442, GNorm = 2.4243, lr_0 = 7.1497e-04
Validation rmse = 1.081993
Epoch 6
Loss = 3.9129e-03, PNorm = 48.2608, GNorm = 1.3776, lr_0 = 6.8956e-04
Loss = 4.0289e-03, PNorm = 48.2701, GNorm = 1.0508, lr_0 = 6.6725e-04
Loss = 3.8328e-03, PNorm = 48.2811, GNorm = 1.3511, lr_0 = 6.4565e-04
Validation rmse = 1.039416
Epoch 7
Loss = 2.8798e-03, PNorm = 48.2913, GNorm = 1.5078, lr_0 = 6.2476e-04
Loss = 4.0428e-03, PNorm = 48.3016, GNorm = 1.6209, lr_0 = 6.0454e-04
Validation rmse = 1.051671
Epoch 8
Loss = 2.7050e-03, PNorm = 48.3122, GNorm = 0.8323, lr_0 = 5.8498e-04
Loss = 4.0361e-03, PNorm = 48.3208, GNorm = 6.1357, lr_0 = 5.6605e-04
Loss = 3.5343e-03, PNorm = 48.3305, GNorm = 1.7012, lr_0 = 5.4774e-04
Validation rmse = 1.075308
Epoch 9
Loss = 3.5882e-03, PNorm = 48.3382, GNorm = 1.8743, lr_0 = 5.3001e-04
Loss = 3.3245e-03, PNorm = 48.3505, GNorm = 1.4750, lr_0 = 5.1286e-04
Validation rmse = 1.066500
Epoch 10
Loss = 3.3498e-03, PNorm = 48.3561, GNorm = 1.8223, lr_0 = 4.9627e-04
Loss = 3.2459e-03, PNorm = 48.3672, GNorm = 3.1209, lr_0 = 4.8021e-04
Loss = 3.4403e-03, PNorm = 48.3719, GNorm = 1.3691, lr_0 = 4.6467e-04
Validation rmse = 0.966048
Epoch 11
Loss = 3.1294e-03, PNorm = 48.3806, GNorm = 2.0989, lr_0 = 4.4963e-04
Loss = 2.8730e-03, PNorm = 48.3876, GNorm = 0.6018, lr_0 = 4.3508e-04
Validation rmse = 0.960876
Epoch 12
Loss = 3.3162e-03, PNorm = 48.3967, GNorm = 2.6591, lr_0 = 4.1962e-04
Loss = 2.7476e-03, PNorm = 48.4017, GNorm = 1.1656, lr_0 = 4.0604e-04
Loss = 3.2685e-03, PNorm = 48.4075, GNorm = 3.6591, lr_0 = 3.9290e-04
Validation rmse = 0.934341
Epoch 13
Loss = 2.6857e-03, PNorm = 48.4132, GNorm = 1.3530, lr_0 = 3.8019e-04
Loss = 3.0852e-03, PNorm = 48.4198, GNorm = 1.7627, lr_0 = 3.6789e-04
Loss = 2.8250e-03, PNorm = 48.4248, GNorm = 2.1129, lr_0 = 3.5598e-04
Validation rmse = 1.054827
Epoch 14
Loss = 2.6478e-03, PNorm = 48.4313, GNorm = 1.0925, lr_0 = 3.4446e-04
Loss = 3.0222e-03, PNorm = 48.4357, GNorm = 3.0589, lr_0 = 3.3332e-04
Validation rmse = 0.890364
Epoch 15
Loss = 2.8018e-03, PNorm = 48.4431, GNorm = 1.9029, lr_0 = 3.2253e-04
Loss = 2.5748e-03, PNorm = 48.4457, GNorm = 1.3827, lr_0 = 3.1209e-04
Loss = 2.5013e-03, PNorm = 48.4500, GNorm = 0.8234, lr_0 = 3.0200e-04
Validation rmse = 0.983531
Epoch 16
Loss = 2.2369e-03, PNorm = 48.4536, GNorm = 0.8474, lr_0 = 2.9222e-04
Loss = 2.6620e-03, PNorm = 48.4590, GNorm = 1.1569, lr_0 = 2.8277e-04
Validation rmse = 0.909960
Epoch 17
Loss = 2.4051e-03, PNorm = 48.4628, GNorm = 3.0654, lr_0 = 2.7272e-04
Loss = 2.4005e-03, PNorm = 48.4664, GNorm = 2.1220, lr_0 = 2.6389e-04
Loss = 2.4673e-03, PNorm = 48.4702, GNorm = 1.5781, lr_0 = 2.5535e-04
Validation rmse = 0.943269
Epoch 18
Loss = 2.5888e-03, PNorm = 48.4743, GNorm = 1.5063, lr_0 = 2.4709e-04
Loss = 2.6888e-03, PNorm = 48.4768, GNorm = 1.0702, lr_0 = 2.3910e-04
Loss = 2.1796e-03, PNorm = 48.4809, GNorm = 3.2718, lr_0 = 2.3136e-04
Validation rmse = 0.864109
Epoch 19
Loss = 2.4653e-03, PNorm = 48.4834, GNorm = 1.7452, lr_0 = 2.2387e-04
Loss = 2.2498e-03, PNorm = 48.4879, GNorm = 1.0503, lr_0 = 2.1663e-04
Validation rmse = 0.910224
Epoch 20
Loss = 1.6607e-03, PNorm = 48.4900, GNorm = 0.9106, lr_0 = 2.0962e-04
Loss = 2.2283e-03, PNorm = 48.4935, GNorm = 1.6483, lr_0 = 2.0283e-04
Loss = 2.1064e-03, PNorm = 48.4947, GNorm = 2.6633, lr_0 = 1.9627e-04
Validation rmse = 0.959241
Epoch 21
Loss = 2.3572e-03, PNorm = 48.4984, GNorm = 1.0693, lr_0 = 1.8992e-04
Loss = 2.1995e-03, PNorm = 48.5009, GNorm = 4.2869, lr_0 = 1.8377e-04
Validation rmse = 0.859333
Epoch 22
Loss = 2.2341e-03, PNorm = 48.5037, GNorm = 2.6318, lr_0 = 1.7783e-04
Loss = 1.9801e-03, PNorm = 48.5060, GNorm = 1.1861, lr_0 = 1.7207e-04
Loss = 2.0998e-03, PNorm = 48.5075, GNorm = 1.0048, lr_0 = 1.6651e-04
Validation rmse = 0.867972
Epoch 23
Loss = 1.9634e-03, PNorm = 48.5104, GNorm = 1.3664, lr_0 = 1.6059e-04
Loss = 2.3595e-03, PNorm = 48.5121, GNorm = 2.2856, lr_0 = 1.5539e-04
Validation rmse = 0.886326
Epoch 24
Loss = 1.5354e-03, PNorm = 48.5146, GNorm = 2.0142, lr_0 = 1.5036e-04
Loss = 2.1914e-03, PNorm = 48.5163, GNorm = 1.0405, lr_0 = 1.4550e-04
Loss = 1.8986e-03, PNorm = 48.5188, GNorm = 0.7364, lr_0 = 1.4079e-04
Validation rmse = 0.890887
Epoch 25
Loss = 1.7816e-03, PNorm = 48.5194, GNorm = 3.2069, lr_0 = 1.3623e-04
Loss = 1.9746e-03, PNorm = 48.5211, GNorm = 0.7852, lr_0 = 1.3183e-04
Loss = 2.3653e-03, PNorm = 48.5235, GNorm = 2.7827, lr_0 = 1.2756e-04
Validation rmse = 0.843988
Epoch 26
Loss = 1.7231e-03, PNorm = 48.5254, GNorm = 0.7516, lr_0 = 1.2343e-04
Loss = 2.0234e-03, PNorm = 48.5269, GNorm = 1.4157, lr_0 = 1.1944e-04
Validation rmse = 0.856565
Epoch 27
Loss = 2.1098e-03, PNorm = 48.5284, GNorm = 1.3906, lr_0 = 1.1557e-04
Loss = 2.3005e-03, PNorm = 48.5305, GNorm = 0.8565, lr_0 = 1.1183e-04
Loss = 1.6624e-03, PNorm = 48.5320, GNorm = 1.8793, lr_0 = 1.0821e-04
Validation rmse = 0.875017
Epoch 28
Loss = 2.0438e-03, PNorm = 48.5331, GNorm = 1.4837, lr_0 = 1.0437e-04
Loss = 1.8639e-03, PNorm = 48.5347, GNorm = 1.1410, lr_0 = 1.0099e-04
Validation rmse = 0.877118
Epoch 29
Loss = 2.3692e-03, PNorm = 48.5353, GNorm = 0.9894, lr_0 = 1.0000e-04
Loss = 2.0995e-03, PNorm = 48.5360, GNorm = 1.3290, lr_0 = 1.0000e-04
Loss = 2.3165e-03, PNorm = 48.5369, GNorm = 3.8197, lr_0 = 1.0000e-04
Validation rmse = 0.867509
Model 0 best validation rmse = 0.843988 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.813823
Ensemble test rmse = 0.813823
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_500/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=500, out_features=500, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 1,142,001
Moving model to cuda
Epoch 0
Loss = 2.0710e-02, PNorm = 47.8636, GNorm = 5.4331, lr_0 = 2.9800e-04
Loss = 1.5819e-02, PNorm = 47.8767, GNorm = 4.5505, lr_0 = 4.7800e-04
Validation rmse = 1.977283
Epoch 1
Loss = 1.3034e-02, PNorm = 47.9043, GNorm = 8.2631, lr_0 = 6.7600e-04
Loss = 1.1183e-02, PNorm = 47.9455, GNorm = 3.8863, lr_0 = 8.5600e-04
Loss = 8.8696e-03, PNorm = 47.9869, GNorm = 2.3963, lr_0 = 9.9344e-04
Validation rmse = 1.719014
Epoch 2
Loss = 9.2431e-03, PNorm = 48.0328, GNorm = 5.3462, lr_0 = 9.6130e-04
Loss = 9.2756e-03, PNorm = 48.0680, GNorm = 4.1202, lr_0 = 9.3019e-04
Validation rmse = 1.516415
Epoch 3
Loss = 8.4992e-03, PNorm = 48.1017, GNorm = 2.3625, lr_0 = 9.0009e-04
Loss = 7.1414e-03, PNorm = 48.1288, GNorm = 4.9039, lr_0 = 8.7096e-04
Loss = 6.3829e-03, PNorm = 48.1517, GNorm = 1.4068, lr_0 = 8.4278e-04
Validation rmse = 1.170733
Epoch 4
Loss = 5.7813e-03, PNorm = 48.1676, GNorm = 3.3902, lr_0 = 8.1551e-04
Loss = 5.0801e-03, PNorm = 48.1891, GNorm = 3.4684, lr_0 = 7.8912e-04
Validation rmse = 1.137961
Epoch 5
Loss = 3.1467e-03, PNorm = 48.2038, GNorm = 1.2737, lr_0 = 7.6358e-04
Loss = 4.8290e-03, PNorm = 48.2194, GNorm = 0.9427, lr_0 = 7.3888e-04
Loss = 4.2151e-03, PNorm = 48.2349, GNorm = 1.0054, lr_0 = 7.1497e-04
Validation rmse = 0.986065
Epoch 6
Loss = 4.3550e-03, PNorm = 48.2510, GNorm = 1.3504, lr_0 = 6.8956e-04
Loss = 3.9722e-03, PNorm = 48.2680, GNorm = 0.8038, lr_0 = 6.6725e-04
Loss = 3.7012e-03, PNorm = 48.2809, GNorm = 1.8888, lr_0 = 6.4565e-04
Validation rmse = 0.953193
Epoch 7
Loss = 3.5621e-03, PNorm = 48.2918, GNorm = 1.8544, lr_0 = 6.2476e-04
Loss = 3.4541e-03, PNorm = 48.3023, GNorm = 3.2999, lr_0 = 6.0454e-04
Validation rmse = 0.911042
Epoch 8
Loss = 4.0730e-03, PNorm = 48.3118, GNorm = 1.2006, lr_0 = 5.8498e-04
Loss = 4.5099e-03, PNorm = 48.3210, GNorm = 4.7531, lr_0 = 5.6605e-04
Loss = 3.6371e-03, PNorm = 48.3323, GNorm = 1.6019, lr_0 = 5.4774e-04
Validation rmse = 0.865200
Epoch 9
Loss = 3.9925e-03, PNorm = 48.3392, GNorm = 3.1733, lr_0 = 5.3001e-04
Loss = 4.3282e-03, PNorm = 48.3519, GNorm = 4.9646, lr_0 = 5.1286e-04
Validation rmse = 0.868689
Epoch 10
Loss = 2.8559e-03, PNorm = 48.3594, GNorm = 1.3357, lr_0 = 4.9627e-04
Loss = 3.5380e-03, PNorm = 48.3671, GNorm = 1.6046, lr_0 = 4.8021e-04
Loss = 3.0347e-03, PNorm = 48.3738, GNorm = 1.2265, lr_0 = 4.6467e-04
Validation rmse = 0.865665
Epoch 11
Loss = 3.0780e-03, PNorm = 48.3822, GNorm = 1.4085, lr_0 = 4.4963e-04
Loss = 3.5526e-03, PNorm = 48.3893, GNorm = 1.2263, lr_0 = 4.3508e-04
Validation rmse = 0.920583
Epoch 12
Loss = 3.8462e-03, PNorm = 48.3968, GNorm = 1.9424, lr_0 = 4.1962e-04
Loss = 3.3745e-03, PNorm = 48.4063, GNorm = 2.9408, lr_0 = 4.0604e-04
Loss = 3.3675e-03, PNorm = 48.4129, GNorm = 2.4132, lr_0 = 3.9290e-04
Validation rmse = 1.003730
Epoch 13
Loss = 3.5949e-03, PNorm = 48.4196, GNorm = 4.5347, lr_0 = 3.8019e-04
Loss = 3.2225e-03, PNorm = 48.4281, GNorm = 1.9303, lr_0 = 3.6789e-04
Loss = 3.2214e-03, PNorm = 48.4325, GNorm = 1.4335, lr_0 = 3.5598e-04
Validation rmse = 0.820941
Epoch 14
Loss = 3.4950e-03, PNorm = 48.4387, GNorm = 4.3700, lr_0 = 3.4446e-04
Loss = 2.7136e-03, PNorm = 48.4445, GNorm = 2.2124, lr_0 = 3.3332e-04
Validation rmse = 0.837819
Epoch 15
Loss = 2.4862e-03, PNorm = 48.4497, GNorm = 2.4784, lr_0 = 3.2253e-04
Loss = 2.9016e-03, PNorm = 48.4553, GNorm = 2.5872, lr_0 = 3.1209e-04
Loss = 3.0737e-03, PNorm = 48.4599, GNorm = 1.7648, lr_0 = 3.0200e-04
Validation rmse = 0.877800
Epoch 16
Loss = 3.9923e-03, PNorm = 48.4652, GNorm = 7.6241, lr_0 = 2.9222e-04
Loss = 2.3105e-03, PNorm = 48.4683, GNorm = 2.7567, lr_0 = 2.8277e-04
Validation rmse = 0.791682
Epoch 17
Loss = 2.6609e-03, PNorm = 48.4721, GNorm = 3.0452, lr_0 = 2.7272e-04
Loss = 2.9192e-03, PNorm = 48.4762, GNorm = 1.0794, lr_0 = 2.6389e-04
Loss = 2.6627e-03, PNorm = 48.4819, GNorm = 1.6432, lr_0 = 2.5535e-04
Validation rmse = 0.832934
Epoch 18
Loss = 2.4546e-03, PNorm = 48.4846, GNorm = 1.9772, lr_0 = 2.4709e-04
Loss = 3.1980e-03, PNorm = 48.4892, GNorm = 1.4876, lr_0 = 2.3910e-04
Loss = 2.4741e-03, PNorm = 48.4926, GNorm = 1.3722, lr_0 = 2.3136e-04
Validation rmse = 0.881135
Epoch 19
Loss = 2.5982e-03, PNorm = 48.4953, GNorm = 1.8161, lr_0 = 2.2387e-04
Loss = 2.6454e-03, PNorm = 48.4993, GNorm = 1.2601, lr_0 = 2.1663e-04
Validation rmse = 0.845061
Epoch 20
Loss = 2.6702e-03, PNorm = 48.5015, GNorm = 1.4628, lr_0 = 2.0962e-04
Loss = 2.6168e-03, PNorm = 48.5050, GNorm = 1.2678, lr_0 = 2.0283e-04
Loss = 2.1791e-03, PNorm = 48.5078, GNorm = 1.2741, lr_0 = 1.9627e-04
Validation rmse = 0.757711
Epoch 21
Loss = 2.6613e-03, PNorm = 48.5098, GNorm = 1.6759, lr_0 = 1.8992e-04
Loss = 2.3369e-03, PNorm = 48.5130, GNorm = 4.2620, lr_0 = 1.8377e-04
Validation rmse = 0.804837
Epoch 22
Loss = 2.1268e-03, PNorm = 48.5154, GNorm = 0.8226, lr_0 = 1.7783e-04
Loss = 2.1608e-03, PNorm = 48.5175, GNorm = 0.8729, lr_0 = 1.7207e-04
Loss = 2.3800e-03, PNorm = 48.5201, GNorm = 3.0737, lr_0 = 1.6651e-04
Validation rmse = 0.777481
Epoch 23
Loss = 2.3389e-03, PNorm = 48.5230, GNorm = 0.8966, lr_0 = 1.6059e-04
Loss = 1.9677e-03, PNorm = 48.5250, GNorm = 0.7197, lr_0 = 1.5539e-04
Validation rmse = 0.871576
Epoch 24
Loss = 1.4762e-03, PNorm = 48.5267, GNorm = 1.4622, lr_0 = 1.5036e-04
Loss = 2.5656e-03, PNorm = 48.5286, GNorm = 1.6280, lr_0 = 1.4550e-04
Loss = 2.1835e-03, PNorm = 48.5307, GNorm = 1.3906, lr_0 = 1.4079e-04
Validation rmse = 0.797348
Epoch 25
Loss = 1.8464e-03, PNorm = 48.5323, GNorm = 0.8625, lr_0 = 1.3623e-04
Loss = 2.0986e-03, PNorm = 48.5338, GNorm = 1.3605, lr_0 = 1.3183e-04
Loss = 2.6148e-03, PNorm = 48.5358, GNorm = 1.3690, lr_0 = 1.2756e-04
Validation rmse = 0.817789
Epoch 26
Loss = 2.2979e-03, PNorm = 48.5380, GNorm = 1.7508, lr_0 = 1.2343e-04
Loss = 2.2927e-03, PNorm = 48.5393, GNorm = 1.2077, lr_0 = 1.1944e-04
Validation rmse = 0.771277
Epoch 27
Loss = 2.2321e-03, PNorm = 48.5409, GNorm = 1.0569, lr_0 = 1.1557e-04
Loss = 2.2373e-03, PNorm = 48.5415, GNorm = 1.6717, lr_0 = 1.1183e-04
Loss = 2.3152e-03, PNorm = 48.5427, GNorm = 0.7580, lr_0 = 1.0821e-04
Validation rmse = 0.819725
Epoch 28
Loss = 2.3337e-03, PNorm = 48.5456, GNorm = 2.0521, lr_0 = 1.0437e-04
Loss = 2.0811e-03, PNorm = 48.5467, GNorm = 1.4856, lr_0 = 1.0099e-04
Validation rmse = 0.857835
Epoch 29
Loss = 3.3515e-03, PNorm = 48.5474, GNorm = 3.8413, lr_0 = 1.0000e-04
Loss = 2.1325e-03, PNorm = 48.5495, GNorm = 1.0312, lr_0 = 1.0000e-04
Loss = 1.9691e-03, PNorm = 48.5509, GNorm = 0.9781, lr_0 = 1.0000e-04
Validation rmse = 0.789063
Model 0 best validation rmse = 0.757711 on epoch 20
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.774831
Ensemble test rmse = 0.774831
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_500/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=500, out_features=500, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 1,142,001
Moving model to cuda
Epoch 0
Loss = 2.0789e-02, PNorm = 47.8629, GNorm = 5.5543, lr_0 = 2.9800e-04
Loss = 1.6890e-02, PNorm = 47.8760, GNorm = 3.5985, lr_0 = 4.7800e-04
Validation rmse = 1.559871
Epoch 1
Loss = 1.5486e-02, PNorm = 47.9029, GNorm = 3.1687, lr_0 = 6.7600e-04
Loss = 1.1867e-02, PNorm = 47.9419, GNorm = 2.6821, lr_0 = 8.5600e-04
Loss = 1.0230e-02, PNorm = 47.9895, GNorm = 7.7016, lr_0 = 9.9344e-04
Validation rmse = 1.568973
Epoch 2
Loss = 1.0857e-02, PNorm = 48.0411, GNorm = 7.4388, lr_0 = 9.6130e-04
Loss = 7.6957e-03, PNorm = 48.0820, GNorm = 1.8940, lr_0 = 9.3019e-04
Validation rmse = 1.207479
Epoch 3
Loss = 6.8506e-03, PNorm = 48.1061, GNorm = 5.1901, lr_0 = 9.0009e-04
Loss = 6.1905e-03, PNorm = 48.1341, GNorm = 2.4118, lr_0 = 8.7096e-04
Loss = 6.1019e-03, PNorm = 48.1565, GNorm = 1.8260, lr_0 = 8.4278e-04
Validation rmse = 1.074378
Epoch 4
Loss = 5.5971e-03, PNorm = 48.1798, GNorm = 1.5663, lr_0 = 8.1551e-04
Loss = 6.1674e-03, PNorm = 48.1983, GNorm = 2.8793, lr_0 = 7.8912e-04
Validation rmse = 0.942741
Epoch 5
Loss = 5.6022e-03, PNorm = 48.2173, GNorm = 1.7949, lr_0 = 7.6358e-04
Loss = 5.0277e-03, PNorm = 48.2408, GNorm = 3.0433, lr_0 = 7.3888e-04
Loss = 4.5645e-03, PNorm = 48.2559, GNorm = 2.0469, lr_0 = 7.1497e-04
Validation rmse = 1.041920
Epoch 6
Loss = 5.2665e-03, PNorm = 48.2707, GNorm = 2.7312, lr_0 = 6.8956e-04
Loss = 4.6677e-03, PNorm = 48.2843, GNorm = 4.9586, lr_0 = 6.6725e-04
Loss = 3.8657e-03, PNorm = 48.3000, GNorm = 1.8965, lr_0 = 6.4565e-04
Validation rmse = 0.863330
Epoch 7
Loss = 3.6138e-03, PNorm = 48.3100, GNorm = 3.2179, lr_0 = 6.2476e-04
Loss = 3.9236e-03, PNorm = 48.3240, GNorm = 3.4590, lr_0 = 6.0454e-04
Validation rmse = 0.875709
Epoch 8
Loss = 3.9785e-03, PNorm = 48.3362, GNorm = 1.3565, lr_0 = 5.8498e-04
Loss = 3.5834e-03, PNorm = 48.3457, GNorm = 1.7308, lr_0 = 5.6605e-04
Loss = 3.3909e-03, PNorm = 48.3581, GNorm = 4.0245, lr_0 = 5.4774e-04
Validation rmse = 0.777819
Epoch 9
Loss = 3.4206e-03, PNorm = 48.3667, GNorm = 5.8977, lr_0 = 5.3001e-04
Loss = 3.5900e-03, PNorm = 48.3782, GNorm = 4.7997, lr_0 = 5.1286e-04
Validation rmse = 1.002796
Epoch 10
Loss = 4.1861e-03, PNorm = 48.3883, GNorm = 3.5046, lr_0 = 4.9627e-04
Loss = 3.3855e-03, PNorm = 48.3999, GNorm = 3.4378, lr_0 = 4.8021e-04
Loss = 3.9669e-03, PNorm = 48.4085, GNorm = 1.1473, lr_0 = 4.6467e-04
Validation rmse = 0.904254
Epoch 11
Loss = 2.8833e-03, PNorm = 48.4176, GNorm = 1.2735, lr_0 = 4.4963e-04
Loss = 3.3436e-03, PNorm = 48.4210, GNorm = 1.0140, lr_0 = 4.3508e-04
Validation rmse = 0.995522
Epoch 12
Loss = 2.4659e-03, PNorm = 48.4293, GNorm = 4.0618, lr_0 = 4.1962e-04
Loss = 3.7085e-03, PNorm = 48.4371, GNorm = 2.3126, lr_0 = 4.0604e-04
Loss = 2.9951e-03, PNorm = 48.4431, GNorm = 2.2085, lr_0 = 3.9290e-04
Validation rmse = 0.820946
Epoch 13
Loss = 2.7197e-03, PNorm = 48.4512, GNorm = 2.0086, lr_0 = 3.8019e-04
Loss = 2.9163e-03, PNorm = 48.4594, GNorm = 1.7574, lr_0 = 3.6789e-04
Loss = 3.1683e-03, PNorm = 48.4655, GNorm = 2.2797, lr_0 = 3.5598e-04
Validation rmse = 0.815587
Epoch 14
Loss = 2.7835e-03, PNorm = 48.4699, GNorm = 1.0753, lr_0 = 3.4446e-04
Loss = 3.0580e-03, PNorm = 48.4760, GNorm = 1.5148, lr_0 = 3.3332e-04
Validation rmse = 0.922677
Epoch 15
Loss = 3.0597e-03, PNorm = 48.4788, GNorm = 3.6144, lr_0 = 3.2253e-04
Loss = 3.0481e-03, PNorm = 48.4851, GNorm = 3.4311, lr_0 = 3.1209e-04
Loss = 3.3280e-03, PNorm = 48.4906, GNorm = 2.5989, lr_0 = 3.0200e-04
Validation rmse = 0.748849
Epoch 16
Loss = 2.6859e-03, PNorm = 48.4957, GNorm = 1.8972, lr_0 = 2.9222e-04
Loss = 2.3700e-03, PNorm = 48.4997, GNorm = 1.6752, lr_0 = 2.8277e-04
Validation rmse = 0.720018
Epoch 17
Loss = 2.2086e-03, PNorm = 48.5052, GNorm = 1.7554, lr_0 = 2.7272e-04
Loss = 2.3980e-03, PNorm = 48.5074, GNorm = 1.8663, lr_0 = 2.6389e-04
Loss = 2.9118e-03, PNorm = 48.5121, GNorm = 1.7876, lr_0 = 2.5535e-04
Validation rmse = 0.752164
Epoch 18
Loss = 2.4247e-03, PNorm = 48.5162, GNorm = 0.6218, lr_0 = 2.4709e-04
Loss = 2.8240e-03, PNorm = 48.5181, GNorm = 1.7593, lr_0 = 2.3910e-04
Loss = 2.5466e-03, PNorm = 48.5231, GNorm = 1.8051, lr_0 = 2.3136e-04
Validation rmse = 0.695492
Epoch 19
Loss = 3.0301e-03, PNorm = 48.5253, GNorm = 1.1414, lr_0 = 2.2387e-04
Loss = 2.1823e-03, PNorm = 48.5289, GNorm = 1.0883, lr_0 = 2.1663e-04
Validation rmse = 0.724954
Epoch 20
Loss = 2.4087e-03, PNorm = 48.5313, GNorm = 2.7918, lr_0 = 2.0962e-04
Loss = 2.5826e-03, PNorm = 48.5349, GNorm = 2.0249, lr_0 = 2.0283e-04
Loss = 2.1878e-03, PNorm = 48.5378, GNorm = 1.4089, lr_0 = 1.9627e-04
Validation rmse = 0.781407
Epoch 21
Loss = 2.0848e-03, PNorm = 48.5392, GNorm = 0.9637, lr_0 = 1.8992e-04
Loss = 2.7459e-03, PNorm = 48.5428, GNorm = 2.3504, lr_0 = 1.8377e-04
Validation rmse = 0.806908
Epoch 22
Loss = 2.4766e-03, PNorm = 48.5446, GNorm = 1.4998, lr_0 = 1.7783e-04
Loss = 2.5479e-03, PNorm = 48.5479, GNorm = 2.0092, lr_0 = 1.7207e-04
Loss = 2.4802e-03, PNorm = 48.5510, GNorm = 2.1541, lr_0 = 1.6651e-04
Validation rmse = 0.763266
Epoch 23
Loss = 2.2666e-03, PNorm = 48.5527, GNorm = 1.1145, lr_0 = 1.6059e-04
Loss = 2.3963e-03, PNorm = 48.5543, GNorm = 2.1703, lr_0 = 1.5539e-04
Validation rmse = 0.689636
Epoch 24
Loss = 2.4986e-03, PNorm = 48.5570, GNorm = 2.3448, lr_0 = 1.5036e-04
Loss = 2.2881e-03, PNorm = 48.5584, GNorm = 2.2978, lr_0 = 1.4550e-04
Loss = 2.5177e-03, PNorm = 48.5601, GNorm = 3.2216, lr_0 = 1.4079e-04
Validation rmse = 0.680576
Epoch 25
Loss = 2.4731e-03, PNorm = 48.5627, GNorm = 2.0181, lr_0 = 1.3623e-04
Loss = 2.4038e-03, PNorm = 48.5652, GNorm = 2.9141, lr_0 = 1.3183e-04
Loss = 2.0799e-03, PNorm = 48.5668, GNorm = 1.1022, lr_0 = 1.2756e-04
Validation rmse = 0.715859
Epoch 26
Loss = 2.5204e-03, PNorm = 48.5677, GNorm = 4.1565, lr_0 = 1.2343e-04
Loss = 1.9982e-03, PNorm = 48.5691, GNorm = 0.7580, lr_0 = 1.1944e-04
Validation rmse = 0.740139
Epoch 27
Loss = 2.8360e-03, PNorm = 48.5711, GNorm = 1.4001, lr_0 = 1.1557e-04
Loss = 2.5540e-03, PNorm = 48.5727, GNorm = 1.4023, lr_0 = 1.1183e-04
Loss = 2.1258e-03, PNorm = 48.5738, GNorm = 0.9966, lr_0 = 1.0821e-04
Validation rmse = 0.718279
Epoch 28
Loss = 2.1609e-03, PNorm = 48.5757, GNorm = 1.3050, lr_0 = 1.0437e-04
Loss = 2.3860e-03, PNorm = 48.5763, GNorm = 2.6205, lr_0 = 1.0099e-04
Validation rmse = 0.725671
Epoch 29
Loss = 2.1561e-03, PNorm = 48.5773, GNorm = 2.4133, lr_0 = 1.0000e-04
Loss = 2.3731e-03, PNorm = 48.5784, GNorm = 2.7212, lr_0 = 1.0000e-04
Loss = 1.8580e-03, PNorm = 48.5801, GNorm = 1.1609, lr_0 = 1.0000e-04
Validation rmse = 0.717326
Model 0 best validation rmse = 0.680576 on epoch 24
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.712575
Ensemble test rmse = 0.712575
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_500/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=500, out_features=500, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 1,142,001
Moving model to cuda
Epoch 0
Loss = 1.9995e-02, PNorm = 47.8627, GNorm = 5.5347, lr_0 = 2.9800e-04
Loss = 1.5917e-02, PNorm = 47.8772, GNorm = 3.9566, lr_0 = 4.7800e-04
Validation rmse = 1.622836
Epoch 1
Loss = 1.1588e-02, PNorm = 47.9039, GNorm = 5.4136, lr_0 = 6.7600e-04
Loss = 1.1378e-02, PNorm = 47.9434, GNorm = 5.0665, lr_0 = 8.5600e-04
Loss = 1.1102e-02, PNorm = 47.9903, GNorm = 5.2643, lr_0 = 9.9344e-04
Validation rmse = 1.509465
Epoch 2
Loss = 9.7232e-03, PNorm = 48.0374, GNorm = 3.5166, lr_0 = 9.6130e-04
Loss = 8.0922e-03, PNorm = 48.0728, GNorm = 2.7147, lr_0 = 9.3019e-04
Validation rmse = 1.187861
Epoch 3
Loss = 6.5418e-03, PNorm = 48.1021, GNorm = 3.4440, lr_0 = 9.0009e-04
Loss = 6.1608e-03, PNorm = 48.1255, GNorm = 2.6344, lr_0 = 8.7096e-04
Loss = 5.8351e-03, PNorm = 48.1477, GNorm = 5.7297, lr_0 = 8.4278e-04
Validation rmse = 1.266094
Epoch 4
Loss = 6.6310e-03, PNorm = 48.1636, GNorm = 7.4599, lr_0 = 8.1551e-04
Loss = 4.9012e-03, PNorm = 48.1869, GNorm = 4.5067, lr_0 = 7.8912e-04
Validation rmse = 1.020976
Epoch 5
Loss = 5.0619e-03, PNorm = 48.2024, GNorm = 2.1909, lr_0 = 7.6358e-04
Loss = 4.3877e-03, PNorm = 48.2165, GNorm = 2.3495, lr_0 = 7.3888e-04
Loss = 5.3117e-03, PNorm = 48.2345, GNorm = 4.3196, lr_0 = 7.1497e-04
Validation rmse = 1.305316
Epoch 6
Loss = 5.5886e-03, PNorm = 48.2509, GNorm = 3.5178, lr_0 = 6.8956e-04
Loss = 5.1276e-03, PNorm = 48.2717, GNorm = 8.5579, lr_0 = 6.6725e-04
Loss = 4.6173e-03, PNorm = 48.2844, GNorm = 1.5698, lr_0 = 6.4565e-04
Validation rmse = 0.828864
Epoch 7
Loss = 3.5815e-03, PNorm = 48.2952, GNorm = 1.8935, lr_0 = 6.2476e-04
Loss = 3.9947e-03, PNorm = 48.3060, GNorm = 3.4462, lr_0 = 6.0454e-04
Validation rmse = 1.002678
Epoch 8
Loss = 3.7492e-03, PNorm = 48.3162, GNorm = 1.9871, lr_0 = 5.8498e-04
Loss = 3.5417e-03, PNorm = 48.3287, GNorm = 1.4457, lr_0 = 5.6605e-04
Loss = 3.3718e-03, PNorm = 48.3393, GNorm = 1.2117, lr_0 = 5.4774e-04
Validation rmse = 0.760331
Epoch 9
Loss = 3.6039e-03, PNorm = 48.3476, GNorm = 4.3324, lr_0 = 5.3001e-04
Loss = 3.3740e-03, PNorm = 48.3579, GNorm = 0.9702, lr_0 = 5.1286e-04
Validation rmse = 0.765937
Epoch 10
Loss = 2.0395e-03, PNorm = 48.3662, GNorm = 1.4475, lr_0 = 4.9627e-04
Loss = 3.0486e-03, PNorm = 48.3732, GNorm = 2.0367, lr_0 = 4.8021e-04
Loss = 3.3885e-03, PNorm = 48.3815, GNorm = 2.5545, lr_0 = 4.6467e-04
Validation rmse = 0.759093
Epoch 11
Loss = 2.5387e-03, PNorm = 48.3886, GNorm = 1.1080, lr_0 = 4.4963e-04
Loss = 3.2224e-03, PNorm = 48.3948, GNorm = 1.1709, lr_0 = 4.3508e-04
Validation rmse = 0.806409
Epoch 12
Loss = 1.9986e-03, PNorm = 48.4028, GNorm = 0.8802, lr_0 = 4.1962e-04
Loss = 3.4162e-03, PNorm = 48.4077, GNorm = 5.6097, lr_0 = 4.0604e-04
Loss = 3.4476e-03, PNorm = 48.4144, GNorm = 4.0967, lr_0 = 3.9290e-04
Validation rmse = 0.737842
Epoch 13
Loss = 3.3419e-03, PNorm = 48.4235, GNorm = 3.5915, lr_0 = 3.8019e-04
Loss = 2.9221e-03, PNorm = 48.4295, GNorm = 1.5490, lr_0 = 3.6789e-04
Loss = 2.5645e-03, PNorm = 48.4369, GNorm = 1.8341, lr_0 = 3.5598e-04
Validation rmse = 0.726101
Epoch 14
Loss = 2.3144e-03, PNorm = 48.4422, GNorm = 2.1342, lr_0 = 3.4446e-04
Loss = 2.7064e-03, PNorm = 48.4471, GNorm = 2.4738, lr_0 = 3.3332e-04
Validation rmse = 0.781367
Epoch 15
Loss = 2.5261e-03, PNorm = 48.4521, GNorm = 2.4676, lr_0 = 3.2253e-04
Loss = 3.1134e-03, PNorm = 48.4576, GNorm = 4.0570, lr_0 = 3.1209e-04
Loss = 3.2589e-03, PNorm = 48.4633, GNorm = 5.7940, lr_0 = 3.0200e-04
Validation rmse = 0.848946
Epoch 16
Loss = 3.1325e-03, PNorm = 48.4689, GNorm = 1.5973, lr_0 = 2.9222e-04
Loss = 3.2471e-03, PNorm = 48.4751, GNorm = 1.4459, lr_0 = 2.8277e-04
Validation rmse = 0.792692
Epoch 17
Loss = 2.5068e-03, PNorm = 48.4810, GNorm = 1.0257, lr_0 = 2.7272e-04
Loss = 2.4322e-03, PNorm = 48.4841, GNorm = 3.6660, lr_0 = 2.6389e-04
Loss = 2.5012e-03, PNorm = 48.4881, GNorm = 2.2012, lr_0 = 2.5535e-04
Validation rmse = 0.713774
Epoch 18
Loss = 2.3016e-03, PNorm = 48.4910, GNorm = 3.9101, lr_0 = 2.4709e-04
Loss = 2.7214e-03, PNorm = 48.4944, GNorm = 2.3302, lr_0 = 2.3910e-04
Loss = 2.3214e-03, PNorm = 48.4989, GNorm = 1.1976, lr_0 = 2.3136e-04
Validation rmse = 0.713430
Epoch 19
Loss = 2.6001e-03, PNorm = 48.5029, GNorm = 1.9104, lr_0 = 2.2387e-04
Loss = 2.3138e-03, PNorm = 48.5074, GNorm = 1.0596, lr_0 = 2.1663e-04
Validation rmse = 0.708146
Epoch 20
Loss = 2.2744e-03, PNorm = 48.5105, GNorm = 1.1246, lr_0 = 2.0962e-04
Loss = 2.1953e-03, PNorm = 48.5144, GNorm = 2.2156, lr_0 = 2.0283e-04
Loss = 2.4010e-03, PNorm = 48.5161, GNorm = 1.4627, lr_0 = 1.9627e-04
Validation rmse = 0.828060
Epoch 21
Loss = 2.6043e-03, PNorm = 48.5194, GNorm = 1.2418, lr_0 = 1.8992e-04
Loss = 2.5041e-03, PNorm = 48.5210, GNorm = 2.0322, lr_0 = 1.8377e-04
Validation rmse = 0.752577
Epoch 22
Loss = 3.2669e-03, PNorm = 48.5224, GNorm = 3.6514, lr_0 = 1.7783e-04
Loss = 2.2711e-03, PNorm = 48.5261, GNorm = 2.8806, lr_0 = 1.7207e-04
Loss = 2.0257e-03, PNorm = 48.5282, GNorm = 0.9034, lr_0 = 1.6651e-04
Validation rmse = 0.836830
Epoch 23
Loss = 2.6696e-03, PNorm = 48.5306, GNorm = 0.9613, lr_0 = 1.6059e-04
Loss = 1.9602e-03, PNorm = 48.5328, GNorm = 1.3457, lr_0 = 1.5539e-04
Validation rmse = 0.732016
Epoch 24
Loss = 1.9823e-03, PNorm = 48.5342, GNorm = 1.0150, lr_0 = 1.5036e-04
Loss = 2.1900e-03, PNorm = 48.5360, GNorm = 1.1018, lr_0 = 1.4550e-04
Loss = 2.1465e-03, PNorm = 48.5367, GNorm = 1.5888, lr_0 = 1.4079e-04
Validation rmse = 0.730325
Epoch 25
Loss = 2.0393e-03, PNorm = 48.5391, GNorm = 0.8481, lr_0 = 1.3623e-04
Loss = 2.0363e-03, PNorm = 48.5408, GNorm = 0.9900, lr_0 = 1.3183e-04
Loss = 2.2536e-03, PNorm = 48.5426, GNorm = 1.4800, lr_0 = 1.2756e-04
Validation rmse = 0.792477
Epoch 26
Loss = 2.2191e-03, PNorm = 48.5452, GNorm = 2.5829, lr_0 = 1.2343e-04
Loss = 2.0998e-03, PNorm = 48.5458, GNorm = 1.5230, lr_0 = 1.1944e-04
Validation rmse = 0.750179
Epoch 27
Loss = 1.8235e-03, PNorm = 48.5477, GNorm = 1.1559, lr_0 = 1.1557e-04
Loss = 2.0951e-03, PNorm = 48.5496, GNorm = 1.2682, lr_0 = 1.1183e-04
Loss = 2.1106e-03, PNorm = 48.5503, GNorm = 2.6949, lr_0 = 1.0821e-04
Validation rmse = 0.699919
Epoch 28
Loss = 2.2959e-03, PNorm = 48.5527, GNorm = 1.1372, lr_0 = 1.0437e-04
Loss = 2.3933e-03, PNorm = 48.5539, GNorm = 2.6377, lr_0 = 1.0099e-04
Validation rmse = 0.674341
Epoch 29
Loss = 1.7926e-03, PNorm = 48.5553, GNorm = 1.9009, lr_0 = 1.0000e-04
Loss = 1.8989e-03, PNorm = 48.5566, GNorm = 1.3732, lr_0 = 1.0000e-04
Loss = 2.1165e-03, PNorm = 48.5573, GNorm = 0.7440, lr_0 = 1.0000e-04
Validation rmse = 0.710875
Model 0 best validation rmse = 0.674341 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.907805
Ensemble test rmse = 0.907805
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_500/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=500, out_features=500, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 1,142,001
Moving model to cuda
Epoch 0
Loss = 2.1702e-02, PNorm = 47.8617, GNorm = 3.8520, lr_0 = 2.9800e-04
Loss = 1.6614e-02, PNorm = 47.8747, GNorm = 4.3305, lr_0 = 4.7800e-04
Validation rmse = 2.094700
Epoch 1
Loss = 1.6054e-02, PNorm = 47.8990, GNorm = 8.8924, lr_0 = 6.7600e-04
Loss = 1.3136e-02, PNorm = 47.9374, GNorm = 5.1987, lr_0 = 8.5600e-04
Loss = 9.8091e-03, PNorm = 47.9851, GNorm = 1.8753, lr_0 = 9.9344e-04
Validation rmse = 1.601223
Epoch 2
Loss = 7.9843e-03, PNorm = 48.0327, GNorm = 1.9844, lr_0 = 9.6130e-04
Loss = 7.2665e-03, PNorm = 48.0635, GNorm = 2.1863, lr_0 = 9.3019e-04
Validation rmse = 1.557236
Epoch 3
Loss = 7.0684e-03, PNorm = 48.0956, GNorm = 2.8308, lr_0 = 9.0009e-04
Loss = 7.3851e-03, PNorm = 48.1221, GNorm = 2.8294, lr_0 = 8.7096e-04
Loss = 5.8350e-03, PNorm = 48.1486, GNorm = 1.5170, lr_0 = 8.4278e-04
Validation rmse = 1.283319
Epoch 4
Loss = 4.6449e-03, PNorm = 48.1743, GNorm = 4.5794, lr_0 = 8.1551e-04
Loss = 5.6211e-03, PNorm = 48.1909, GNorm = 1.2153, lr_0 = 7.8912e-04
Validation rmse = 1.354167
Epoch 5
Loss = 6.9054e-03, PNorm = 48.2127, GNorm = 6.1341, lr_0 = 7.6358e-04
Loss = 4.8468e-03, PNorm = 48.2305, GNorm = 1.9785, lr_0 = 7.3888e-04
Loss = 5.2583e-03, PNorm = 48.2506, GNorm = 1.6262, lr_0 = 7.1497e-04
Validation rmse = 1.118345
Epoch 6
Loss = 5.6040e-03, PNorm = 48.2627, GNorm = 6.0750, lr_0 = 6.8956e-04
Loss = 4.5307e-03, PNorm = 48.2803, GNorm = 2.4239, lr_0 = 6.6725e-04
Loss = 3.9115e-03, PNorm = 48.2899, GNorm = 5.6380, lr_0 = 6.4565e-04
Validation rmse = 1.145542
Epoch 7
Loss = 3.5452e-03, PNorm = 48.3010, GNorm = 1.3098, lr_0 = 6.2476e-04
Loss = 3.7150e-03, PNorm = 48.3133, GNorm = 2.5106, lr_0 = 6.0454e-04
Validation rmse = 1.006889
Epoch 8
Loss = 3.4997e-03, PNorm = 48.3220, GNorm = 3.0837, lr_0 = 5.8498e-04
Loss = 3.6167e-03, PNorm = 48.3343, GNorm = 4.9992, lr_0 = 5.6605e-04
Loss = 3.4000e-03, PNorm = 48.3441, GNorm = 2.9839, lr_0 = 5.4774e-04
Validation rmse = 0.976719
Epoch 9
Loss = 3.3713e-03, PNorm = 48.3543, GNorm = 1.1767, lr_0 = 5.3001e-04
Loss = 3.4275e-03, PNorm = 48.3639, GNorm = 2.4529, lr_0 = 5.1286e-04
Validation rmse = 1.104896
Epoch 10
Loss = 3.4770e-03, PNorm = 48.3721, GNorm = 2.5848, lr_0 = 4.9627e-04
Loss = 3.0791e-03, PNorm = 48.3791, GNorm = 1.1405, lr_0 = 4.8021e-04
Loss = 3.0137e-03, PNorm = 48.3896, GNorm = 1.9288, lr_0 = 4.6467e-04
Validation rmse = 0.947966
Epoch 11
Loss = 3.1058e-03, PNorm = 48.3935, GNorm = 2.1859, lr_0 = 4.4963e-04
Loss = 3.4850e-03, PNorm = 48.4027, GNorm = 1.0874, lr_0 = 4.3508e-04
Validation rmse = 0.927021
Epoch 12
Loss = 2.8319e-03, PNorm = 48.4099, GNorm = 1.2616, lr_0 = 4.1962e-04
Loss = 2.5313e-03, PNorm = 48.4195, GNorm = 0.8365, lr_0 = 4.0604e-04
Loss = 2.5830e-03, PNorm = 48.4254, GNorm = 1.0202, lr_0 = 3.9290e-04
Validation rmse = 0.934717
Epoch 13
Loss = 3.3378e-03, PNorm = 48.4310, GNorm = 4.4053, lr_0 = 3.8019e-04
Loss = 2.5714e-03, PNorm = 48.4339, GNorm = 1.2636, lr_0 = 3.6789e-04
Loss = 2.4549e-03, PNorm = 48.4407, GNorm = 1.3319, lr_0 = 3.5598e-04
Validation rmse = 1.117580
Epoch 14
Loss = 2.9055e-03, PNorm = 48.4464, GNorm = 3.4275, lr_0 = 3.4446e-04
Loss = 2.4570e-03, PNorm = 48.4497, GNorm = 1.2359, lr_0 = 3.3332e-04
Validation rmse = 0.911729
Epoch 15
Loss = 1.9197e-03, PNorm = 48.4568, GNorm = 1.0688, lr_0 = 3.2253e-04
Loss = 2.6004e-03, PNorm = 48.4604, GNorm = 1.1266, lr_0 = 3.1209e-04
Loss = 2.3532e-03, PNorm = 48.4652, GNorm = 0.9079, lr_0 = 3.0200e-04
Validation rmse = 0.874949
Epoch 16
Loss = 2.4227e-03, PNorm = 48.4683, GNorm = 0.9453, lr_0 = 2.9222e-04
Loss = 2.6414e-03, PNorm = 48.4734, GNorm = 4.3363, lr_0 = 2.8277e-04
Validation rmse = 0.857041
Epoch 17
Loss = 2.4428e-03, PNorm = 48.4773, GNorm = 3.7247, lr_0 = 2.7272e-04
Loss = 2.3778e-03, PNorm = 48.4819, GNorm = 0.7488, lr_0 = 2.6389e-04
Loss = 2.1624e-03, PNorm = 48.4843, GNorm = 0.5622, lr_0 = 2.5535e-04
Validation rmse = 0.991042
Epoch 18
Loss = 2.3711e-03, PNorm = 48.4879, GNorm = 1.6168, lr_0 = 2.4709e-04
Loss = 2.5135e-03, PNorm = 48.4911, GNorm = 3.0685, lr_0 = 2.3910e-04
Loss = 2.2768e-03, PNorm = 48.4949, GNorm = 2.1647, lr_0 = 2.3136e-04
Validation rmse = 0.914085
Epoch 19
Loss = 2.3838e-03, PNorm = 48.4982, GNorm = 3.2827, lr_0 = 2.2387e-04
Loss = 2.5254e-03, PNorm = 48.5006, GNorm = 4.2244, lr_0 = 2.1663e-04
Validation rmse = 0.988478
Epoch 20
Loss = 1.9848e-03, PNorm = 48.5036, GNorm = 1.5288, lr_0 = 2.0962e-04
Loss = 2.5236e-03, PNorm = 48.5074, GNorm = 1.0685, lr_0 = 2.0283e-04
Loss = 2.2693e-03, PNorm = 48.5094, GNorm = 1.1632, lr_0 = 1.9627e-04
Validation rmse = 0.954094
Epoch 21
Loss = 2.0444e-03, PNorm = 48.5109, GNorm = 1.1272, lr_0 = 1.8992e-04
Loss = 2.1934e-03, PNorm = 48.5131, GNorm = 3.5498, lr_0 = 1.8377e-04
Validation rmse = 0.898984
Epoch 22
Loss = 1.9131e-03, PNorm = 48.5155, GNorm = 0.9672, lr_0 = 1.7783e-04
Loss = 1.7434e-03, PNorm = 48.5175, GNorm = 3.0066, lr_0 = 1.7207e-04
Loss = 2.0550e-03, PNorm = 48.5196, GNorm = 0.6569, lr_0 = 1.6651e-04
Validation rmse = 0.845469
Epoch 23
Loss = 2.2538e-03, PNorm = 48.5222, GNorm = 1.7622, lr_0 = 1.6059e-04
Loss = 1.8979e-03, PNorm = 48.5242, GNorm = 3.0867, lr_0 = 1.5539e-04
Validation rmse = 0.900192
Epoch 24
Loss = 1.4052e-03, PNorm = 48.5267, GNorm = 0.9032, lr_0 = 1.5036e-04
Loss = 2.2829e-03, PNorm = 48.5278, GNorm = 1.7723, lr_0 = 1.4550e-04
Loss = 2.1675e-03, PNorm = 48.5298, GNorm = 1.2044, lr_0 = 1.4079e-04
Validation rmse = 0.867001
Epoch 25
Loss = 2.5157e-03, PNorm = 48.5331, GNorm = 4.4220, lr_0 = 1.3623e-04
Loss = 2.2152e-03, PNorm = 48.5347, GNorm = 2.6700, lr_0 = 1.3183e-04
Loss = 1.9591e-03, PNorm = 48.5365, GNorm = 1.4520, lr_0 = 1.2756e-04
Validation rmse = 0.865286
Epoch 26
Loss = 1.8032e-03, PNorm = 48.5382, GNorm = 1.4305, lr_0 = 1.2343e-04
Loss = 2.3294e-03, PNorm = 48.5392, GNorm = 1.7869, lr_0 = 1.1944e-04
Validation rmse = 0.884621
Epoch 27
Loss = 1.9378e-03, PNorm = 48.5412, GNorm = 1.4584, lr_0 = 1.1557e-04
Loss = 2.0160e-03, PNorm = 48.5426, GNorm = 1.6964, lr_0 = 1.1183e-04
Loss = 1.9482e-03, PNorm = 48.5439, GNorm = 3.4219, lr_0 = 1.0821e-04
Validation rmse = 0.906840
Epoch 28
Loss = 1.6783e-03, PNorm = 48.5465, GNorm = 0.9634, lr_0 = 1.0437e-04
Loss = 1.8646e-03, PNorm = 48.5464, GNorm = 1.0581, lr_0 = 1.0099e-04
Validation rmse = 0.860014
Epoch 29
Loss = 2.6185e-03, PNorm = 48.5475, GNorm = 2.3234, lr_0 = 1.0000e-04
Loss = 1.9117e-03, PNorm = 48.5491, GNorm = 2.5819, lr_0 = 1.0000e-04
Loss = 1.7120e-03, PNorm = 48.5501, GNorm = 2.0611, lr_0 = 1.0000e-04
Validation rmse = 0.880719
Model 0 best validation rmse = 0.845469 on epoch 22
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 1.092303
Ensemble test rmse = 1.092303
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_500/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=500, out_features=500, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 1,142,001
Moving model to cuda
Epoch 0
Loss = 2.0804e-02, PNorm = 47.8622, GNorm = 4.0576, lr_0 = 2.9800e-04
Loss = 1.6873e-02, PNorm = 47.8743, GNorm = 4.0014, lr_0 = 4.7800e-04
Validation rmse = 1.937363
Epoch 1
Loss = 1.2841e-02, PNorm = 47.9021, GNorm = 3.3980, lr_0 = 6.7600e-04
Loss = 1.1053e-02, PNorm = 47.9414, GNorm = 2.5487, lr_0 = 8.5600e-04
Loss = 1.0585e-02, PNorm = 47.9818, GNorm = 3.7153, lr_0 = 9.9344e-04
Validation rmse = 1.995186
Epoch 2
Loss = 8.9302e-03, PNorm = 48.0247, GNorm = 7.5544, lr_0 = 9.6130e-04
Loss = 7.9090e-03, PNorm = 48.0608, GNorm = 3.0406, lr_0 = 9.3019e-04
Validation rmse = 1.562070
Epoch 3
Loss = 6.2275e-03, PNorm = 48.0906, GNorm = 2.3141, lr_0 = 9.0009e-04
Loss = 5.9007e-03, PNorm = 48.1168, GNorm = 2.4007, lr_0 = 8.7096e-04
Loss = 6.2960e-03, PNorm = 48.1368, GNorm = 1.0075, lr_0 = 8.4278e-04
Validation rmse = 1.173665
Epoch 4
Loss = 5.2626e-03, PNorm = 48.1596, GNorm = 6.8954, lr_0 = 8.1551e-04
Loss = 4.9950e-03, PNorm = 48.1816, GNorm = 2.8024, lr_0 = 7.8912e-04
Validation rmse = 1.127647
Epoch 5
Loss = 3.5013e-03, PNorm = 48.2014, GNorm = 1.2241, lr_0 = 7.6358e-04
Loss = 4.5936e-03, PNorm = 48.2150, GNorm = 5.7128, lr_0 = 7.3888e-04
Loss = 4.5573e-03, PNorm = 48.2320, GNorm = 3.3071, lr_0 = 7.1497e-04
Validation rmse = 1.144906
Epoch 6
Loss = 3.9998e-03, PNorm = 48.2526, GNorm = 4.4847, lr_0 = 6.8956e-04
Loss = 5.8112e-03, PNorm = 48.2650, GNorm = 2.3727, lr_0 = 6.6725e-04
Loss = 3.6765e-03, PNorm = 48.2803, GNorm = 1.8531, lr_0 = 6.4565e-04
Validation rmse = 1.125382
Epoch 7
Loss = 3.3465e-03, PNorm = 48.2938, GNorm = 1.8940, lr_0 = 6.2476e-04
Loss = 4.3542e-03, PNorm = 48.3063, GNorm = 2.7000, lr_0 = 6.0454e-04
Validation rmse = 1.235993
Epoch 8
Loss = 3.6748e-03, PNorm = 48.3180, GNorm = 3.7272, lr_0 = 5.8498e-04
Loss = 3.7778e-03, PNorm = 48.3297, GNorm = 2.9705, lr_0 = 5.6605e-04
Loss = 3.3819e-03, PNorm = 48.3380, GNorm = 1.7163, lr_0 = 5.4774e-04
Validation rmse = 1.037895
Epoch 9
Loss = 2.9912e-03, PNorm = 48.3441, GNorm = 5.7582, lr_0 = 5.3001e-04
Loss = 3.4593e-03, PNorm = 48.3532, GNorm = 1.5993, lr_0 = 5.1286e-04
Validation rmse = 0.948690
Epoch 10
Loss = 2.5572e-03, PNorm = 48.3621, GNorm = 2.0551, lr_0 = 4.9627e-04
Loss = 2.7573e-03, PNorm = 48.3707, GNorm = 2.1351, lr_0 = 4.8021e-04
Loss = 3.6640e-03, PNorm = 48.3806, GNorm = 4.8307, lr_0 = 4.6467e-04
Validation rmse = 1.176598
Epoch 11
Loss = 3.6333e-03, PNorm = 48.3889, GNorm = 3.8221, lr_0 = 4.4963e-04
Loss = 3.1634e-03, PNorm = 48.3965, GNorm = 1.1705, lr_0 = 4.3508e-04
Validation rmse = 1.084787
Epoch 12
Loss = 3.0223e-03, PNorm = 48.4034, GNorm = 1.2959, lr_0 = 4.1962e-04
Loss = 2.7031e-03, PNorm = 48.4089, GNorm = 0.8805, lr_0 = 4.0604e-04
Loss = 2.8570e-03, PNorm = 48.4138, GNorm = 1.4042, lr_0 = 3.9290e-04
Validation rmse = 1.420097
Epoch 13
Loss = 3.5386e-03, PNorm = 48.4217, GNorm = 7.4959, lr_0 = 3.8019e-04
Loss = 3.3839e-03, PNorm = 48.4256, GNorm = 3.1010, lr_0 = 3.6789e-04
Loss = 3.6786e-03, PNorm = 48.4351, GNorm = 2.0385, lr_0 = 3.5598e-04
Validation rmse = 1.166787
Epoch 14
Loss = 3.1105e-03, PNorm = 48.4401, GNorm = 1.0202, lr_0 = 3.4446e-04
Loss = 2.7998e-03, PNorm = 48.4452, GNorm = 1.5003, lr_0 = 3.3332e-04
Validation rmse = 1.053992
Epoch 15
Loss = 2.8510e-03, PNorm = 48.4507, GNorm = 1.4118, lr_0 = 3.2253e-04
Loss = 2.5984e-03, PNorm = 48.4534, GNorm = 0.9974, lr_0 = 3.1209e-04
Loss = 2.7799e-03, PNorm = 48.4587, GNorm = 1.0982, lr_0 = 3.0200e-04
Validation rmse = 1.009745
Epoch 16
Loss = 2.5817e-03, PNorm = 48.4636, GNorm = 1.3957, lr_0 = 2.9222e-04
Loss = 2.2866e-03, PNorm = 48.4684, GNorm = 3.4922, lr_0 = 2.8277e-04
Validation rmse = 1.074264
Epoch 17
Loss = 2.2982e-03, PNorm = 48.4732, GNorm = 0.9841, lr_0 = 2.7272e-04
Loss = 2.6395e-03, PNorm = 48.4790, GNorm = 1.1699, lr_0 = 2.6389e-04
Loss = 2.3431e-03, PNorm = 48.4825, GNorm = 1.2224, lr_0 = 2.5535e-04
Validation rmse = 0.945196
Epoch 18
Loss = 2.5884e-03, PNorm = 48.4860, GNorm = 1.0298, lr_0 = 2.4709e-04
Loss = 2.3464e-03, PNorm = 48.4894, GNorm = 2.7916, lr_0 = 2.3910e-04
Loss = 2.4936e-03, PNorm = 48.4924, GNorm = 2.7020, lr_0 = 2.3136e-04
Validation rmse = 0.951223
Epoch 19
Loss = 2.6440e-03, PNorm = 48.4949, GNorm = 1.7032, lr_0 = 2.2387e-04
Loss = 2.5343e-03, PNorm = 48.4976, GNorm = 1.7500, lr_0 = 2.1663e-04
Validation rmse = 1.160102
Epoch 20
Loss = 2.2561e-03, PNorm = 48.5010, GNorm = 1.2701, lr_0 = 2.0962e-04
Loss = 2.4399e-03, PNorm = 48.5042, GNorm = 1.7862, lr_0 = 2.0283e-04
Loss = 2.2989e-03, PNorm = 48.5065, GNorm = 2.6790, lr_0 = 1.9627e-04
Validation rmse = 1.017149
Epoch 21
Loss = 2.4292e-03, PNorm = 48.5086, GNorm = 1.1705, lr_0 = 1.8992e-04
Loss = 2.2204e-03, PNorm = 48.5109, GNorm = 1.5142, lr_0 = 1.8377e-04
Validation rmse = 1.053011
Epoch 22
Loss = 4.2104e-03, PNorm = 48.5136, GNorm = 1.7075, lr_0 = 1.7783e-04
Loss = 1.8832e-03, PNorm = 48.5176, GNorm = 3.5019, lr_0 = 1.7207e-04
Loss = 2.6051e-03, PNorm = 48.5187, GNorm = 1.8960, lr_0 = 1.6651e-04
Validation rmse = 1.015467
Epoch 23
Loss = 2.3348e-03, PNorm = 48.5234, GNorm = 1.6882, lr_0 = 1.6059e-04
Loss = 2.4708e-03, PNorm = 48.5244, GNorm = 1.3927, lr_0 = 1.5539e-04
Validation rmse = 1.018876
Epoch 24
Loss = 2.4081e-03, PNorm = 48.5273, GNorm = 1.5340, lr_0 = 1.5036e-04
Loss = 2.4888e-03, PNorm = 48.5293, GNorm = 1.7432, lr_0 = 1.4550e-04
Loss = 2.2091e-03, PNorm = 48.5329, GNorm = 1.2361, lr_0 = 1.4079e-04
Validation rmse = 1.005358
Epoch 25
Loss = 1.9520e-03, PNorm = 48.5339, GNorm = 1.2542, lr_0 = 1.3623e-04
Loss = 2.3828e-03, PNorm = 48.5364, GNorm = 1.2252, lr_0 = 1.3183e-04
Loss = 2.1055e-03, PNorm = 48.5385, GNorm = 1.0905, lr_0 = 1.2756e-04
Validation rmse = 1.044621
Epoch 26
Loss = 2.5379e-03, PNorm = 48.5399, GNorm = 5.0887, lr_0 = 1.2343e-04
Loss = 1.9741e-03, PNorm = 48.5427, GNorm = 1.3073, lr_0 = 1.1944e-04
Validation rmse = 1.135387
Epoch 27
Loss = 2.9708e-03, PNorm = 48.5436, GNorm = 4.6717, lr_0 = 1.1557e-04
Loss = 2.1055e-03, PNorm = 48.5455, GNorm = 1.2824, lr_0 = 1.1183e-04
Loss = 2.3048e-03, PNorm = 48.5475, GNorm = 2.1231, lr_0 = 1.0821e-04
Validation rmse = 1.005276
Epoch 28
Loss = 2.1644e-03, PNorm = 48.5489, GNorm = 1.0685, lr_0 = 1.0437e-04
Loss = 2.3935e-03, PNorm = 48.5506, GNorm = 3.1037, lr_0 = 1.0099e-04
Validation rmse = 1.042625
Epoch 29
Loss = 1.4760e-03, PNorm = 48.5509, GNorm = 2.2769, lr_0 = 1.0000e-04
Loss = 2.3068e-03, PNorm = 48.5532, GNorm = 0.6965, lr_0 = 1.0000e-04
Loss = 2.0974e-03, PNorm = 48.5539, GNorm = 0.7345, lr_0 = 1.0000e-04
Validation rmse = 0.963651
Model 0 best validation rmse = 0.945196 on epoch 17
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.711131
Ensemble test rmse = 0.711131
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_500/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=500, out_features=500, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 1,142,001
Moving model to cuda
Epoch 0
Loss = 1.9360e-02, PNorm = 47.8628, GNorm = 3.7891, lr_0 = 2.9800e-04
Loss = 1.7175e-02, PNorm = 47.8760, GNorm = 8.9979, lr_0 = 4.7800e-04
Validation rmse = 1.918432
Epoch 1
Loss = 1.2866e-02, PNorm = 47.9037, GNorm = 2.9498, lr_0 = 6.7600e-04
Loss = 1.3673e-02, PNorm = 47.9405, GNorm = 2.1516, lr_0 = 8.5600e-04
Loss = 9.0154e-03, PNorm = 47.9873, GNorm = 4.3483, lr_0 = 9.9344e-04
Validation rmse = 1.733205
Epoch 2
Loss = 7.0387e-03, PNorm = 48.0364, GNorm = 1.5448, lr_0 = 9.6130e-04
Loss = 7.4165e-03, PNorm = 48.0665, GNorm = 1.8024, lr_0 = 9.3019e-04
Validation rmse = 1.319922
Epoch 3
Loss = 7.2200e-03, PNorm = 48.1021, GNorm = 4.8403, lr_0 = 9.0009e-04
Loss = 6.7261e-03, PNorm = 48.1301, GNorm = 3.4685, lr_0 = 8.7096e-04
Loss = 4.9815e-03, PNorm = 48.1546, GNorm = 1.2274, lr_0 = 8.4278e-04
Validation rmse = 1.288386
Epoch 4
Loss = 4.4966e-03, PNorm = 48.1785, GNorm = 2.3593, lr_0 = 8.1551e-04
Loss = 5.8478e-03, PNorm = 48.1963, GNorm = 6.7946, lr_0 = 7.8912e-04
Validation rmse = 1.186975
Epoch 5
Loss = 3.6716e-03, PNorm = 48.2191, GNorm = 1.1514, lr_0 = 7.6358e-04
Loss = 4.8357e-03, PNorm = 48.2352, GNorm = 3.9703, lr_0 = 7.3888e-04
Loss = 5.4392e-03, PNorm = 48.2532, GNorm = 1.3227, lr_0 = 7.1497e-04
Validation rmse = 1.335208
Epoch 6
Loss = 4.7361e-03, PNorm = 48.2709, GNorm = 1.2125, lr_0 = 6.8956e-04
Loss = 5.8993e-03, PNorm = 48.2885, GNorm = 4.5562, lr_0 = 6.6725e-04
Loss = 4.3488e-03, PNorm = 48.3060, GNorm = 4.7851, lr_0 = 6.4565e-04
Validation rmse = 1.125861
Epoch 7
Loss = 4.2245e-03, PNorm = 48.3200, GNorm = 1.1270, lr_0 = 6.2476e-04
Loss = 3.8682e-03, PNorm = 48.3319, GNorm = 3.3996, lr_0 = 6.0454e-04
Validation rmse = 1.094711
Epoch 8
Loss = 3.2914e-03, PNorm = 48.3447, GNorm = 3.2499, lr_0 = 5.8498e-04
Loss = 3.2879e-03, PNorm = 48.3565, GNorm = 1.4908, lr_0 = 5.6605e-04
Loss = 3.6845e-03, PNorm = 48.3659, GNorm = 1.5319, lr_0 = 5.4774e-04
Validation rmse = 1.094801
Epoch 9
Loss = 3.8725e-03, PNorm = 48.3735, GNorm = 4.5141, lr_0 = 5.3001e-04
Loss = 3.2435e-03, PNorm = 48.3860, GNorm = 2.6395, lr_0 = 5.1286e-04
Validation rmse = 1.095376
Epoch 10
Loss = 2.9704e-03, PNorm = 48.3969, GNorm = 2.1821, lr_0 = 4.9627e-04
Loss = 3.6886e-03, PNorm = 48.4063, GNorm = 2.4052, lr_0 = 4.8021e-04
Loss = 2.7566e-03, PNorm = 48.4169, GNorm = 2.9241, lr_0 = 4.6467e-04
Validation rmse = 1.072976
Epoch 11
Loss = 3.1401e-03, PNorm = 48.4262, GNorm = 1.2621, lr_0 = 4.4963e-04
Loss = 2.6216e-03, PNorm = 48.4327, GNorm = 1.2479, lr_0 = 4.3508e-04
Validation rmse = 1.040718
Epoch 12
Loss = 2.9746e-03, PNorm = 48.4414, GNorm = 1.5295, lr_0 = 4.1962e-04
Loss = 2.5977e-03, PNorm = 48.4496, GNorm = 2.0079, lr_0 = 4.0604e-04
Loss = 2.7763e-03, PNorm = 48.4550, GNorm = 2.2380, lr_0 = 3.9290e-04
Validation rmse = 1.145046
Epoch 13
Loss = 2.8929e-03, PNorm = 48.4628, GNorm = 3.4243, lr_0 = 3.8019e-04
Loss = 3.0717e-03, PNorm = 48.4665, GNorm = 5.9208, lr_0 = 3.6789e-04
Loss = 3.0552e-03, PNorm = 48.4718, GNorm = 0.7581, lr_0 = 3.5598e-04
Validation rmse = 1.042484
Epoch 14
Loss = 2.8942e-03, PNorm = 48.4787, GNorm = 1.0203, lr_0 = 3.4446e-04
Loss = 2.3198e-03, PNorm = 48.4844, GNorm = 2.1220, lr_0 = 3.3332e-04
Validation rmse = 1.068966
Epoch 15
Loss = 1.8223e-03, PNorm = 48.4883, GNorm = 0.9071, lr_0 = 3.2253e-04
Loss = 2.7404e-03, PNorm = 48.4950, GNorm = 2.8932, lr_0 = 3.1209e-04
Loss = 2.6578e-03, PNorm = 48.4999, GNorm = 2.3544, lr_0 = 3.0200e-04
Validation rmse = 1.026420
Epoch 16
Loss = 1.8781e-03, PNorm = 48.5036, GNorm = 2.0410, lr_0 = 2.9222e-04
Loss = 2.1968e-03, PNorm = 48.5069, GNorm = 0.9508, lr_0 = 2.8277e-04
Validation rmse = 1.011169
Epoch 17
Loss = 2.0039e-03, PNorm = 48.5103, GNorm = 2.2446, lr_0 = 2.7272e-04
Loss = 2.3703e-03, PNorm = 48.5150, GNorm = 1.9895, lr_0 = 2.6389e-04
Loss = 2.5681e-03, PNorm = 48.5188, GNorm = 1.8297, lr_0 = 2.5535e-04
Validation rmse = 1.028229
Epoch 18
Loss = 2.5917e-03, PNorm = 48.5220, GNorm = 1.0698, lr_0 = 2.4709e-04
Loss = 1.9117e-03, PNorm = 48.5256, GNorm = 1.6768, lr_0 = 2.3910e-04
Loss = 2.3030e-03, PNorm = 48.5305, GNorm = 0.8385, lr_0 = 2.3136e-04
Validation rmse = 0.981146
Epoch 19
Loss = 2.5500e-03, PNorm = 48.5328, GNorm = 0.8974, lr_0 = 2.2387e-04
Loss = 2.5056e-03, PNorm = 48.5373, GNorm = 3.2731, lr_0 = 2.1663e-04
Validation rmse = 0.992353
Epoch 20
Loss = 2.5822e-03, PNorm = 48.5415, GNorm = 1.0413, lr_0 = 2.0962e-04
Loss = 2.5136e-03, PNorm = 48.5448, GNorm = 2.1398, lr_0 = 2.0283e-04
Loss = 1.9762e-03, PNorm = 48.5470, GNorm = 0.6562, lr_0 = 1.9627e-04
Validation rmse = 0.998408
Epoch 21
Loss = 1.7538e-03, PNorm = 48.5494, GNorm = 0.8263, lr_0 = 1.8992e-04
Loss = 2.1048e-03, PNorm = 48.5521, GNorm = 0.9556, lr_0 = 1.8377e-04
Validation rmse = 0.979282
Epoch 22
Loss = 2.0462e-03, PNorm = 48.5536, GNorm = 1.2023, lr_0 = 1.7783e-04
Loss = 2.2290e-03, PNorm = 48.5572, GNorm = 1.3803, lr_0 = 1.7207e-04
Loss = 2.3130e-03, PNorm = 48.5594, GNorm = 2.1996, lr_0 = 1.6651e-04
Validation rmse = 0.984605
Epoch 23
Loss = 2.1234e-03, PNorm = 48.5612, GNorm = 3.0223, lr_0 = 1.6059e-04
Loss = 2.2997e-03, PNorm = 48.5628, GNorm = 1.2326, lr_0 = 1.5539e-04
Validation rmse = 0.992152
Epoch 24
Loss = 1.4969e-03, PNorm = 48.5673, GNorm = 1.2561, lr_0 = 1.5036e-04
Loss = 2.1238e-03, PNorm = 48.5684, GNorm = 0.7802, lr_0 = 1.4550e-04
Loss = 2.1560e-03, PNorm = 48.5703, GNorm = 1.0952, lr_0 = 1.4079e-04
Validation rmse = 0.986706
Epoch 25
Loss = 2.3479e-03, PNorm = 48.5720, GNorm = 1.0399, lr_0 = 1.3623e-04
Loss = 1.7346e-03, PNorm = 48.5736, GNorm = 1.0651, lr_0 = 1.3183e-04
Loss = 2.3743e-03, PNorm = 48.5757, GNorm = 1.0150, lr_0 = 1.2756e-04
Validation rmse = 0.991382
Epoch 26
Loss = 1.9449e-03, PNorm = 48.5763, GNorm = 0.7795, lr_0 = 1.2343e-04
Loss = 2.0529e-03, PNorm = 48.5780, GNorm = 0.9092, lr_0 = 1.1944e-04
Validation rmse = 0.970630
Epoch 27
Loss = 2.5280e-03, PNorm = 48.5799, GNorm = 4.1436, lr_0 = 1.1557e-04
Loss = 2.0407e-03, PNorm = 48.5807, GNorm = 0.9478, lr_0 = 1.1183e-04
Loss = 2.1151e-03, PNorm = 48.5819, GNorm = 0.9582, lr_0 = 1.0821e-04
Validation rmse = 0.977902
Epoch 28
Loss = 2.0636e-03, PNorm = 48.5837, GNorm = 1.0390, lr_0 = 1.0437e-04
Loss = 2.0877e-03, PNorm = 48.5853, GNorm = 1.2429, lr_0 = 1.0099e-04
Validation rmse = 0.993996
Epoch 29
Loss = 1.8240e-03, PNorm = 48.5867, GNorm = 0.9566, lr_0 = 1.0000e-04
Loss = 1.9919e-03, PNorm = 48.5882, GNorm = 1.4706, lr_0 = 1.0000e-04
Loss = 2.1539e-03, PNorm = 48.5891, GNorm = 1.1116, lr_0 = 1.0000e-04
Validation rmse = 0.991223
Model 0 best validation rmse = 0.970630 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.811021
Ensemble test rmse = 0.811021
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_500/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=500, out_features=500, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 1,142,001
Moving model to cuda
Epoch 0
Loss = 1.8561e-02, PNorm = 47.8637, GNorm = 5.8060, lr_0 = 2.9800e-04
Loss = 1.6378e-02, PNorm = 47.8761, GNorm = 8.2423, lr_0 = 4.7800e-04
Validation rmse = 1.733084
Epoch 1
Loss = 1.5567e-02, PNorm = 47.9002, GNorm = 3.8084, lr_0 = 6.7600e-04
Loss = 1.4701e-02, PNorm = 47.9416, GNorm = 4.2171, lr_0 = 8.5600e-04
Loss = 1.0907e-02, PNorm = 47.9905, GNorm = 2.8279, lr_0 = 9.9344e-04
Validation rmse = 1.444467
Epoch 2
Loss = 9.7738e-03, PNorm = 48.0380, GNorm = 1.9362, lr_0 = 9.6130e-04
Loss = 7.6335e-03, PNorm = 48.0735, GNorm = 6.8478, lr_0 = 9.3019e-04
Validation rmse = 1.338122
Epoch 3
Loss = 8.4195e-03, PNorm = 48.1021, GNorm = 7.5297, lr_0 = 9.0009e-04
Loss = 8.7493e-03, PNorm = 48.1314, GNorm = 7.6037, lr_0 = 8.7096e-04
Loss = 7.9648e-03, PNorm = 48.1612, GNorm = 10.0136, lr_0 = 8.4278e-04
Validation rmse = 1.189143
Epoch 4
Loss = 6.0775e-03, PNorm = 48.1827, GNorm = 1.4801, lr_0 = 8.1551e-04
Loss = 5.8337e-03, PNorm = 48.2049, GNorm = 3.2715, lr_0 = 7.8912e-04
Validation rmse = 0.998439
Epoch 5
Loss = 4.7797e-03, PNorm = 48.2252, GNorm = 2.3794, lr_0 = 7.6358e-04
Loss = 5.0603e-03, PNorm = 48.2442, GNorm = 4.6168, lr_0 = 7.3888e-04
Loss = 5.2811e-03, PNorm = 48.2618, GNorm = 3.4119, lr_0 = 7.1497e-04
Validation rmse = 1.000942
Epoch 6
Loss = 5.7399e-03, PNorm = 48.2833, GNorm = 8.1261, lr_0 = 6.8956e-04
Loss = 4.2504e-03, PNorm = 48.2972, GNorm = 4.6805, lr_0 = 6.6725e-04
Loss = 4.1870e-03, PNorm = 48.3129, GNorm = 2.5948, lr_0 = 6.4565e-04
Validation rmse = 0.882506
Epoch 7
Loss = 3.6002e-03, PNorm = 48.3257, GNorm = 3.6605, lr_0 = 6.2476e-04
Loss = 4.2912e-03, PNorm = 48.3399, GNorm = 1.4020, lr_0 = 6.0454e-04
Validation rmse = 0.893938
Epoch 8
Loss = 2.9008e-03, PNorm = 48.3521, GNorm = 3.4348, lr_0 = 5.8498e-04
Loss = 3.5078e-03, PNorm = 48.3643, GNorm = 1.4193, lr_0 = 5.6605e-04
Loss = 3.5682e-03, PNorm = 48.3742, GNorm = 3.0120, lr_0 = 5.4774e-04
Validation rmse = 0.895165
Epoch 9
Loss = 3.1111e-03, PNorm = 48.3863, GNorm = 1.8738, lr_0 = 5.3001e-04
Loss = 4.0803e-03, PNorm = 48.3969, GNorm = 2.4789, lr_0 = 5.1286e-04
Validation rmse = 1.032410
Epoch 10
Loss = 3.8666e-03, PNorm = 48.4110, GNorm = 1.2129, lr_0 = 4.9627e-04
Loss = 3.5040e-03, PNorm = 48.4201, GNorm = 2.2009, lr_0 = 4.8021e-04
Loss = 3.5891e-03, PNorm = 48.4307, GNorm = 1.2176, lr_0 = 4.6467e-04
Validation rmse = 0.833979
Epoch 11
Loss = 4.4072e-03, PNorm = 48.4420, GNorm = 1.8933, lr_0 = 4.4963e-04
Loss = 2.3961e-03, PNorm = 48.4516, GNorm = 1.2195, lr_0 = 4.3508e-04
Validation rmse = 0.822454
Epoch 12
Loss = 2.4464e-03, PNorm = 48.4580, GNorm = 1.6484, lr_0 = 4.1962e-04
Loss = 2.7443e-03, PNorm = 48.4670, GNorm = 2.9797, lr_0 = 4.0604e-04
Loss = 3.0377e-03, PNorm = 48.4714, GNorm = 0.8926, lr_0 = 3.9290e-04
Validation rmse = 0.820525
Epoch 13
Loss = 3.0823e-03, PNorm = 48.4783, GNorm = 1.3239, lr_0 = 3.8019e-04
Loss = 2.6975e-03, PNorm = 48.4849, GNorm = 3.3963, lr_0 = 3.6789e-04
Loss = 3.4543e-03, PNorm = 48.4897, GNorm = 4.8143, lr_0 = 3.5598e-04
Validation rmse = 0.841790
Epoch 14
Loss = 2.7204e-03, PNorm = 48.4972, GNorm = 1.2694, lr_0 = 3.4446e-04
Loss = 2.6300e-03, PNorm = 48.5020, GNorm = 1.2216, lr_0 = 3.3332e-04
Validation rmse = 0.812929
Epoch 15
Loss = 1.9715e-03, PNorm = 48.5082, GNorm = 2.3717, lr_0 = 3.2253e-04
Loss = 2.6967e-03, PNorm = 48.5121, GNorm = 1.9596, lr_0 = 3.1209e-04
Loss = 2.4701e-03, PNorm = 48.5168, GNorm = 2.3182, lr_0 = 3.0200e-04
Validation rmse = 0.798385
Epoch 16
Loss = 2.6936e-03, PNorm = 48.5222, GNorm = 1.5019, lr_0 = 2.9222e-04
Loss = 2.6004e-03, PNorm = 48.5271, GNorm = 1.8881, lr_0 = 2.8277e-04
Validation rmse = 0.782680
Epoch 17
Loss = 1.5835e-03, PNorm = 48.5329, GNorm = 1.5953, lr_0 = 2.7272e-04
Loss = 2.1105e-03, PNorm = 48.5366, GNorm = 1.3224, lr_0 = 2.6389e-04
Loss = 2.8479e-03, PNorm = 48.5430, GNorm = 2.0603, lr_0 = 2.5535e-04
Validation rmse = 0.788715
Epoch 18
Loss = 2.1857e-03, PNorm = 48.5470, GNorm = 1.7053, lr_0 = 2.4709e-04
Loss = 2.5264e-03, PNorm = 48.5508, GNorm = 1.5527, lr_0 = 2.3910e-04
Loss = 2.4087e-03, PNorm = 48.5535, GNorm = 3.4421, lr_0 = 2.3136e-04
Validation rmse = 0.774124
Epoch 19
Loss = 2.4716e-03, PNorm = 48.5574, GNorm = 1.7135, lr_0 = 2.2387e-04
Loss = 2.3404e-03, PNorm = 48.5607, GNorm = 2.3848, lr_0 = 2.1663e-04
Validation rmse = 0.758917
Epoch 20
Loss = 2.8216e-03, PNorm = 48.5651, GNorm = 2.0472, lr_0 = 2.0962e-04
Loss = 2.2858e-03, PNorm = 48.5676, GNorm = 1.9974, lr_0 = 2.0283e-04
Loss = 2.2238e-03, PNorm = 48.5714, GNorm = 1.4728, lr_0 = 1.9627e-04
Validation rmse = 0.781184
Epoch 21
Loss = 2.3587e-03, PNorm = 48.5735, GNorm = 1.1293, lr_0 = 1.8992e-04
Loss = 2.1767e-03, PNorm = 48.5774, GNorm = 3.9429, lr_0 = 1.8377e-04
Validation rmse = 0.749921
Epoch 22
Loss = 2.2801e-03, PNorm = 48.5796, GNorm = 1.2621, lr_0 = 1.7783e-04
Loss = 2.0658e-03, PNorm = 48.5828, GNorm = 1.0113, lr_0 = 1.7207e-04
Loss = 2.2922e-03, PNorm = 48.5849, GNorm = 1.3270, lr_0 = 1.6651e-04
Validation rmse = 0.759736
Epoch 23
Loss = 1.8748e-03, PNorm = 48.5875, GNorm = 2.2853, lr_0 = 1.6059e-04
Loss = 2.2712e-03, PNorm = 48.5892, GNorm = 2.0687, lr_0 = 1.5539e-04
Validation rmse = 0.803306
Epoch 24
Loss = 1.7164e-03, PNorm = 48.5908, GNorm = 1.3791, lr_0 = 1.5036e-04
Loss = 2.3812e-03, PNorm = 48.5935, GNorm = 2.8804, lr_0 = 1.4550e-04
Loss = 2.2532e-03, PNorm = 48.5962, GNorm = 0.9039, lr_0 = 1.4079e-04
Validation rmse = 0.736035
Epoch 25
Loss = 1.8154e-03, PNorm = 48.5980, GNorm = 2.5317, lr_0 = 1.3623e-04
Loss = 2.0690e-03, PNorm = 48.6001, GNorm = 1.6931, lr_0 = 1.3183e-04
Loss = 2.1510e-03, PNorm = 48.6026, GNorm = 1.4766, lr_0 = 1.2756e-04
Validation rmse = 0.789478
Epoch 26
Loss = 1.9337e-03, PNorm = 48.6038, GNorm = 1.3295, lr_0 = 1.2343e-04
Loss = 1.9130e-03, PNorm = 48.6063, GNorm = 2.2559, lr_0 = 1.1944e-04
Validation rmse = 0.743092
Epoch 27
Loss = 1.8350e-03, PNorm = 48.6071, GNorm = 1.4709, lr_0 = 1.1557e-04
Loss = 2.2659e-03, PNorm = 48.6094, GNorm = 1.6469, lr_0 = 1.1183e-04
Loss = 2.1759e-03, PNorm = 48.6113, GNorm = 1.0314, lr_0 = 1.0821e-04
Validation rmse = 0.750619
Epoch 28
Loss = 2.1535e-03, PNorm = 48.6122, GNorm = 1.2226, lr_0 = 1.0437e-04
Loss = 1.8265e-03, PNorm = 48.6138, GNorm = 2.2665, lr_0 = 1.0099e-04
Validation rmse = 0.741070
Epoch 29
Loss = 1.8487e-03, PNorm = 48.6154, GNorm = 1.0292, lr_0 = 1.0000e-04
Loss = 2.1752e-03, PNorm = 48.6155, GNorm = 1.1897, lr_0 = 1.0000e-04
Loss = 1.9689e-03, PNorm = 48.6175, GNorm = 1.6436, lr_0 = 1.0000e-04
Validation rmse = 0.738426
Model 0 best validation rmse = 0.736035 on epoch 24
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.702329
Ensemble test rmse = 0.702329
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_500/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=500, out_features=500, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 1,142,001
Moving model to cuda
Epoch 0
Loss = 1.9707e-02, PNorm = 47.8637, GNorm = 5.0724, lr_0 = 2.9800e-04
Loss = 1.5968e-02, PNorm = 47.8751, GNorm = 3.2438, lr_0 = 4.7800e-04
Validation rmse = 1.972995
Epoch 1
Loss = 1.5008e-02, PNorm = 47.9000, GNorm = 2.0709, lr_0 = 6.7600e-04
Loss = 1.0717e-02, PNorm = 47.9425, GNorm = 3.5261, lr_0 = 8.5600e-04
Loss = 9.4294e-03, PNorm = 47.9835, GNorm = 2.7614, lr_0 = 9.9344e-04
Validation rmse = 1.616851
Epoch 2
Loss = 8.7409e-03, PNorm = 48.0287, GNorm = 4.7529, lr_0 = 9.6130e-04
Loss = 6.9159e-03, PNorm = 48.0630, GNorm = 1.8745, lr_0 = 9.3019e-04
Validation rmse = 1.520849
Epoch 3
Loss = 6.5129e-03, PNorm = 48.0932, GNorm = 2.8769, lr_0 = 9.0009e-04
Loss = 7.9472e-03, PNorm = 48.1168, GNorm = 4.8522, lr_0 = 8.7096e-04
Loss = 6.5378e-03, PNorm = 48.1389, GNorm = 4.2903, lr_0 = 8.4278e-04
Validation rmse = 1.304783
Epoch 4
Loss = 5.7498e-03, PNorm = 48.1648, GNorm = 1.4206, lr_0 = 8.1551e-04
Loss = 5.0910e-03, PNorm = 48.1861, GNorm = 1.7913, lr_0 = 7.8912e-04
Validation rmse = 1.147775
Epoch 5
Loss = 3.7504e-03, PNorm = 48.2037, GNorm = 1.7332, lr_0 = 7.6358e-04
Loss = 4.3008e-03, PNorm = 48.2227, GNorm = 1.4346, lr_0 = 7.3888e-04
Loss = 5.0091e-03, PNorm = 48.2361, GNorm = 2.5859, lr_0 = 7.1497e-04
Validation rmse = 1.245102
Epoch 6
Loss = 3.8827e-03, PNorm = 48.2505, GNorm = 2.6783, lr_0 = 6.8956e-04
Loss = 3.9743e-03, PNorm = 48.2636, GNorm = 2.1120, lr_0 = 6.6725e-04
Loss = 3.6839e-03, PNorm = 48.2760, GNorm = 1.8211, lr_0 = 6.4565e-04
Validation rmse = 1.105181
Epoch 7
Loss = 3.7788e-03, PNorm = 48.2886, GNorm = 3.5765, lr_0 = 6.2476e-04
Loss = 3.5261e-03, PNorm = 48.3004, GNorm = 1.4300, lr_0 = 6.0454e-04
Validation rmse = 1.038493
Epoch 8
Loss = 3.7583e-03, PNorm = 48.3135, GNorm = 1.0752, lr_0 = 5.8498e-04
Loss = 3.7711e-03, PNorm = 48.3252, GNorm = 3.0507, lr_0 = 5.6605e-04
Loss = 3.1037e-03, PNorm = 48.3372, GNorm = 7.2468, lr_0 = 5.4774e-04
Validation rmse = 1.169834
Epoch 9
Loss = 3.2451e-03, PNorm = 48.3452, GNorm = 3.5087, lr_0 = 5.3001e-04
Loss = 3.7068e-03, PNorm = 48.3557, GNorm = 3.3533, lr_0 = 5.1286e-04
Validation rmse = 0.970820
Epoch 10
Loss = 4.5391e-03, PNorm = 48.3638, GNorm = 5.5610, lr_0 = 4.9627e-04
Loss = 3.5653e-03, PNorm = 48.3730, GNorm = 4.1964, lr_0 = 4.8021e-04
Loss = 3.3431e-03, PNorm = 48.3788, GNorm = 2.1415, lr_0 = 4.6467e-04
Validation rmse = 0.911670
Epoch 11
Loss = 2.9746e-03, PNorm = 48.3889, GNorm = 1.9436, lr_0 = 4.4963e-04
Loss = 3.0491e-03, PNorm = 48.3956, GNorm = 1.3494, lr_0 = 4.3508e-04
Validation rmse = 0.900923
Epoch 12
Loss = 2.1466e-03, PNorm = 48.4046, GNorm = 2.9731, lr_0 = 4.1962e-04
Loss = 2.9339e-03, PNorm = 48.4096, GNorm = 1.1641, lr_0 = 4.0604e-04
Loss = 2.9391e-03, PNorm = 48.4163, GNorm = 1.7040, lr_0 = 3.9290e-04
Validation rmse = 1.069578
Epoch 13
Loss = 3.2654e-03, PNorm = 48.4234, GNorm = 1.7620, lr_0 = 3.8019e-04
Loss = 3.1851e-03, PNorm = 48.4282, GNorm = 1.4614, lr_0 = 3.6789e-04
Loss = 3.1038e-03, PNorm = 48.4365, GNorm = 1.6594, lr_0 = 3.5598e-04
Validation rmse = 1.031846
Epoch 14
Loss = 2.7266e-03, PNorm = 48.4398, GNorm = 2.4645, lr_0 = 3.4446e-04
Loss = 2.7592e-03, PNorm = 48.4471, GNorm = 1.2295, lr_0 = 3.3332e-04
Validation rmse = 0.946816
Epoch 15
Loss = 2.4768e-03, PNorm = 48.4519, GNorm = 1.4723, lr_0 = 3.2253e-04
Loss = 2.7372e-03, PNorm = 48.4563, GNorm = 2.1936, lr_0 = 3.1209e-04
Loss = 2.6110e-03, PNorm = 48.4610, GNorm = 0.9921, lr_0 = 3.0200e-04
Validation rmse = 0.976838
Epoch 16
Loss = 2.7233e-03, PNorm = 48.4658, GNorm = 1.8384, lr_0 = 2.9222e-04
Loss = 2.7189e-03, PNorm = 48.4705, GNorm = 1.2050, lr_0 = 2.8277e-04
Validation rmse = 1.028020
Epoch 17
Loss = 2.1708e-03, PNorm = 48.4747, GNorm = 3.2856, lr_0 = 2.7272e-04
Loss = 2.8591e-03, PNorm = 48.4801, GNorm = 1.6834, lr_0 = 2.6389e-04
Loss = 2.7315e-03, PNorm = 48.4836, GNorm = 5.2206, lr_0 = 2.5535e-04
Validation rmse = 1.039359
Epoch 18
Loss = 2.4515e-03, PNorm = 48.4870, GNorm = 3.0423, lr_0 = 2.4709e-04
Loss = 2.2012e-03, PNorm = 48.4915, GNorm = 1.9961, lr_0 = 2.3910e-04
Loss = 2.3874e-03, PNorm = 48.4946, GNorm = 0.7736, lr_0 = 2.3136e-04
Validation rmse = 0.936207
Epoch 19
Loss = 2.4060e-03, PNorm = 48.4984, GNorm = 1.6483, lr_0 = 2.2387e-04
Loss = 2.4544e-03, PNorm = 48.5008, GNorm = 1.4510, lr_0 = 2.1663e-04
Validation rmse = 0.947986
Epoch 20
Loss = 2.5652e-03, PNorm = 48.5039, GNorm = 1.2835, lr_0 = 2.0962e-04
Loss = 2.1576e-03, PNorm = 48.5058, GNorm = 0.9274, lr_0 = 2.0283e-04
Loss = 2.3961e-03, PNorm = 48.5089, GNorm = 1.5038, lr_0 = 1.9627e-04
Validation rmse = 0.977847
Epoch 21
Loss = 1.9884e-03, PNorm = 48.5113, GNorm = 1.2011, lr_0 = 1.8992e-04
Loss = 2.6928e-03, PNorm = 48.5137, GNorm = 2.8545, lr_0 = 1.8377e-04
Validation rmse = 0.952561
Epoch 22
Loss = 2.1178e-03, PNorm = 48.5159, GNorm = 1.3076, lr_0 = 1.7783e-04
Loss = 2.0832e-03, PNorm = 48.5191, GNorm = 1.5152, lr_0 = 1.7207e-04
Loss = 2.3695e-03, PNorm = 48.5219, GNorm = 2.9038, lr_0 = 1.6651e-04
Validation rmse = 0.913462
Epoch 23
Loss = 2.3311e-03, PNorm = 48.5238, GNorm = 1.5240, lr_0 = 1.6059e-04
Loss = 2.0898e-03, PNorm = 48.5267, GNorm = 2.2519, lr_0 = 1.5539e-04
Validation rmse = 0.924807
Epoch 24
Loss = 2.1198e-03, PNorm = 48.5282, GNorm = 1.3455, lr_0 = 1.5036e-04
Loss = 2.6623e-03, PNorm = 48.5302, GNorm = 1.8932, lr_0 = 1.4550e-04
Loss = 2.0685e-03, PNorm = 48.5331, GNorm = 1.4769, lr_0 = 1.4079e-04
Validation rmse = 0.912568
Epoch 25
Loss = 1.9799e-03, PNorm = 48.5348, GNorm = 2.1635, lr_0 = 1.3623e-04
Loss = 2.3220e-03, PNorm = 48.5360, GNorm = 1.8779, lr_0 = 1.3183e-04
Loss = 2.3182e-03, PNorm = 48.5374, GNorm = 1.5670, lr_0 = 1.2756e-04
Validation rmse = 0.994309
Epoch 26
Loss = 2.2757e-03, PNorm = 48.5389, GNorm = 2.0322, lr_0 = 1.2343e-04
Loss = 2.0017e-03, PNorm = 48.5400, GNorm = 1.8430, lr_0 = 1.1944e-04
Validation rmse = 0.961185
Epoch 27
Loss = 2.0395e-03, PNorm = 48.5418, GNorm = 1.9821, lr_0 = 1.1557e-04
Loss = 2.1069e-03, PNorm = 48.5428, GNorm = 1.2633, lr_0 = 1.1183e-04
Loss = 2.1920e-03, PNorm = 48.5445, GNorm = 2.2791, lr_0 = 1.0821e-04
Validation rmse = 0.887081
Epoch 28
Loss = 2.5401e-03, PNorm = 48.5460, GNorm = 1.1235, lr_0 = 1.0437e-04
Loss = 1.8980e-03, PNorm = 48.5464, GNorm = 0.8174, lr_0 = 1.0099e-04
Validation rmse = 0.932211
Epoch 29
Loss = 1.8236e-03, PNorm = 48.5476, GNorm = 2.1620, lr_0 = 1.0000e-04
Loss = 2.1729e-03, PNorm = 48.5494, GNorm = 1.0728, lr_0 = 1.0000e-04
Loss = 1.7123e-03, PNorm = 48.5504, GNorm = 2.2010, lr_0 = 1.0000e-04
Validation rmse = 0.966099
Model 0 best validation rmse = 0.887081 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.745251
Ensemble test rmse = 0.745251
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.30000000000000004,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.30000000000000004_ffn_num_layers_3_hidden_size_500/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.30000000000000004, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.30000000000000004, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.30000000000000004, inplace=False)
    (4): Linear(in_features=500, out_features=500, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.30000000000000004, inplace=False)
    (7): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 1,142,001
Moving model to cuda
Epoch 0
Loss = 2.1320e-02, PNorm = 47.8623, GNorm = 5.7341, lr_0 = 2.9800e-04
Loss = 1.7506e-02, PNorm = 47.8745, GNorm = 2.8149, lr_0 = 4.7800e-04
Validation rmse = 1.903079
Epoch 1
Loss = 1.1311e-02, PNorm = 47.9036, GNorm = 4.2563, lr_0 = 6.7600e-04
Loss = 1.2240e-02, PNorm = 47.9420, GNorm = 9.0353, lr_0 = 8.5600e-04
Loss = 1.0393e-02, PNorm = 47.9927, GNorm = 4.7367, lr_0 = 9.9344e-04
Validation rmse = 1.494696
Epoch 2
Loss = 8.9479e-03, PNorm = 48.0367, GNorm = 3.1349, lr_0 = 9.6130e-04
Loss = 6.7404e-03, PNorm = 48.0725, GNorm = 5.8801, lr_0 = 9.3019e-04
Validation rmse = 1.267641
Epoch 3
Loss = 5.5222e-03, PNorm = 48.0996, GNorm = 5.5499, lr_0 = 9.0009e-04
Loss = 6.2897e-03, PNorm = 48.1251, GNorm = 9.4491, lr_0 = 8.7096e-04
Loss = 5.4544e-03, PNorm = 48.1482, GNorm = 7.2430, lr_0 = 8.4278e-04
Validation rmse = 1.109165
Epoch 4
Loss = 5.7451e-03, PNorm = 48.1692, GNorm = 4.2032, lr_0 = 8.1551e-04
Loss = 6.0807e-03, PNorm = 48.1881, GNorm = 5.9290, lr_0 = 7.8912e-04
Validation rmse = 1.046438
Epoch 5
Loss = 4.5577e-03, PNorm = 48.2088, GNorm = 3.3343, lr_0 = 7.6358e-04
Loss = 5.4251e-03, PNorm = 48.2242, GNorm = 5.3492, lr_0 = 7.3888e-04
Loss = 4.1262e-03, PNorm = 48.2423, GNorm = 2.8075, lr_0 = 7.1497e-04
Validation rmse = 1.045691
Epoch 6
Loss = 4.0045e-03, PNorm = 48.2568, GNorm = 2.8181, lr_0 = 6.8956e-04
Loss = 4.1459e-03, PNorm = 48.2692, GNorm = 4.3735, lr_0 = 6.6725e-04
Loss = 3.3961e-03, PNorm = 48.2803, GNorm = 1.8569, lr_0 = 6.4565e-04
Validation rmse = 1.071271
Epoch 7
Loss = 3.6607e-03, PNorm = 48.2930, GNorm = 1.4109, lr_0 = 6.2476e-04
Loss = 3.9451e-03, PNorm = 48.3022, GNorm = 3.8877, lr_0 = 6.0454e-04
Validation rmse = 0.946900
Epoch 8
Loss = 3.9021e-03, PNorm = 48.3160, GNorm = 2.2019, lr_0 = 5.8498e-04
Loss = 3.7787e-03, PNorm = 48.3251, GNorm = 1.3740, lr_0 = 5.6605e-04
Loss = 3.1401e-03, PNorm = 48.3347, GNorm = 2.5737, lr_0 = 5.4774e-04
Validation rmse = 1.017613
Epoch 9
Loss = 2.7229e-03, PNorm = 48.3428, GNorm = 1.6736, lr_0 = 5.3001e-04
Loss = 3.6942e-03, PNorm = 48.3507, GNorm = 3.1336, lr_0 = 5.1286e-04
Validation rmse = 1.114913
Epoch 10
Loss = 4.0591e-03, PNorm = 48.3571, GNorm = 2.9542, lr_0 = 4.9627e-04
Loss = 3.4493e-03, PNorm = 48.3658, GNorm = 1.5550, lr_0 = 4.8021e-04
Loss = 3.6014e-03, PNorm = 48.3752, GNorm = 6.0693, lr_0 = 4.6467e-04
Validation rmse = 1.055147
Epoch 11
Loss = 2.8871e-03, PNorm = 48.3849, GNorm = 1.4450, lr_0 = 4.4963e-04
Loss = 3.0724e-03, PNorm = 48.3920, GNorm = 1.0022, lr_0 = 4.3508e-04
Validation rmse = 1.042844
Epoch 12
Loss = 3.1848e-03, PNorm = 48.3990, GNorm = 4.1611, lr_0 = 4.1962e-04
Loss = 2.9739e-03, PNorm = 48.4074, GNorm = 2.6160, lr_0 = 4.0604e-04
Loss = 2.6092e-03, PNorm = 48.4162, GNorm = 2.9509, lr_0 = 3.9290e-04
Validation rmse = 0.923940
Epoch 13
Loss = 2.4282e-03, PNorm = 48.4191, GNorm = 1.1711, lr_0 = 3.8019e-04
Loss = 2.3367e-03, PNorm = 48.4251, GNorm = 1.4072, lr_0 = 3.6789e-04
Loss = 2.9409e-03, PNorm = 48.4311, GNorm = 1.4163, lr_0 = 3.5598e-04
Validation rmse = 0.935036
Epoch 14
Loss = 2.4828e-03, PNorm = 48.4386, GNorm = 1.1903, lr_0 = 3.4446e-04
Loss = 2.3915e-03, PNorm = 48.4425, GNorm = 1.1356, lr_0 = 3.3332e-04
Validation rmse = 0.874472
Epoch 15
Loss = 2.3786e-03, PNorm = 48.4497, GNorm = 1.6999, lr_0 = 3.2253e-04
Loss = 2.6299e-03, PNorm = 48.4533, GNorm = 2.0198, lr_0 = 3.1209e-04
Loss = 2.8362e-03, PNorm = 48.4606, GNorm = 3.4855, lr_0 = 3.0200e-04
Validation rmse = 0.864513
Epoch 16
Loss = 2.4258e-03, PNorm = 48.4644, GNorm = 0.9714, lr_0 = 2.9222e-04
Loss = 2.4861e-03, PNorm = 48.4675, GNorm = 1.0895, lr_0 = 2.8277e-04
Validation rmse = 0.932455
Epoch 17
Loss = 1.8764e-03, PNorm = 48.4732, GNorm = 2.2500, lr_0 = 2.7272e-04
Loss = 2.3164e-03, PNorm = 48.4780, GNorm = 1.7295, lr_0 = 2.6389e-04
Loss = 2.7869e-03, PNorm = 48.4818, GNorm = 3.6769, lr_0 = 2.5535e-04
Validation rmse = 0.865470
Epoch 18
Loss = 2.4207e-03, PNorm = 48.4855, GNorm = 1.1864, lr_0 = 2.4709e-04
Loss = 2.4376e-03, PNorm = 48.4894, GNorm = 1.7886, lr_0 = 2.3910e-04
Loss = 2.0491e-03, PNorm = 48.4931, GNorm = 2.5132, lr_0 = 2.3136e-04
Validation rmse = 0.921892
Epoch 19
Loss = 2.1004e-03, PNorm = 48.4963, GNorm = 0.8512, lr_0 = 2.2387e-04
Loss = 2.4457e-03, PNorm = 48.4986, GNorm = 1.7223, lr_0 = 2.1663e-04
Validation rmse = 0.838857
Epoch 20
Loss = 2.2042e-03, PNorm = 48.5021, GNorm = 0.8580, lr_0 = 2.0962e-04
Loss = 2.2218e-03, PNorm = 48.5066, GNorm = 3.0047, lr_0 = 2.0283e-04
Loss = 2.2659e-03, PNorm = 48.5083, GNorm = 2.1633, lr_0 = 1.9627e-04
Validation rmse = 0.847802
Epoch 21
Loss = 2.4031e-03, PNorm = 48.5103, GNorm = 3.0990, lr_0 = 1.8992e-04
Loss = 2.6839e-03, PNorm = 48.5134, GNorm = 1.3107, lr_0 = 1.8377e-04
Validation rmse = 0.811085
Epoch 22
Loss = 1.7493e-03, PNorm = 48.5173, GNorm = 0.8608, lr_0 = 1.7783e-04
Loss = 2.2133e-03, PNorm = 48.5191, GNorm = 1.0383, lr_0 = 1.7207e-04
Loss = 2.2987e-03, PNorm = 48.5222, GNorm = 1.6273, lr_0 = 1.6651e-04
Validation rmse = 0.882311
Epoch 23
Loss = 2.2241e-03, PNorm = 48.5237, GNorm = 0.9078, lr_0 = 1.6059e-04
Loss = 1.8595e-03, PNorm = 48.5261, GNorm = 0.9760, lr_0 = 1.5539e-04
Validation rmse = 0.875540
Epoch 24
Loss = 2.3613e-03, PNorm = 48.5277, GNorm = 1.4071, lr_0 = 1.5036e-04
Loss = 2.3246e-03, PNorm = 48.5293, GNorm = 1.8454, lr_0 = 1.4550e-04
Loss = 2.3344e-03, PNorm = 48.5322, GNorm = 1.3171, lr_0 = 1.4079e-04
Validation rmse = 0.816432
Epoch 25
Loss = 2.4069e-03, PNorm = 48.5348, GNorm = 1.8812, lr_0 = 1.3623e-04
Loss = 1.8213e-03, PNorm = 48.5364, GNorm = 1.3278, lr_0 = 1.3183e-04
Loss = 2.2182e-03, PNorm = 48.5380, GNorm = 1.4046, lr_0 = 1.2756e-04
Validation rmse = 0.876444
Epoch 26
Loss = 1.9373e-03, PNorm = 48.5396, GNorm = 2.0074, lr_0 = 1.2343e-04
Loss = 1.8418e-03, PNorm = 48.5412, GNorm = 0.7913, lr_0 = 1.1944e-04
Validation rmse = 0.794142
Epoch 27
Loss = 1.9803e-03, PNorm = 48.5430, GNorm = 0.9827, lr_0 = 1.1557e-04
Loss = 2.1094e-03, PNorm = 48.5448, GNorm = 1.9572, lr_0 = 1.1183e-04
Loss = 1.9576e-03, PNorm = 48.5458, GNorm = 1.3824, lr_0 = 1.0821e-04
Validation rmse = 0.859300
Epoch 28
Loss = 2.2357e-03, PNorm = 48.5478, GNorm = 2.3242, lr_0 = 1.0437e-04
Loss = 2.0674e-03, PNorm = 48.5491, GNorm = 3.5624, lr_0 = 1.0099e-04
Validation rmse = 0.838476
Epoch 29
Loss = 1.9355e-03, PNorm = 48.5500, GNorm = 1.0123, lr_0 = 1.0000e-04
Loss = 2.1799e-03, PNorm = 48.5514, GNorm = 1.5781, lr_0 = 1.0000e-04
Loss = 2.1728e-03, PNorm = 48.5525, GNorm = 1.6145, lr_0 = 1.0000e-04
Validation rmse = 0.889919
Model 0 best validation rmse = 0.794142 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.749019
Ensemble test rmse = 0.749019
10-fold cross validation
	Seed 0 ==> test rmse = 0.813823
	Seed 1 ==> test rmse = 0.774831
	Seed 2 ==> test rmse = 0.712575
	Seed 3 ==> test rmse = 0.907805
	Seed 4 ==> test rmse = 1.092303
	Seed 5 ==> test rmse = 0.711131
	Seed 6 ==> test rmse = 0.811021
	Seed 7 ==> test rmse = 0.702329
	Seed 8 ==> test rmse = 0.745251
	Seed 9 ==> test rmse = 0.749019
Overall test rmse = 0.802009 +/- 0.113422
Elapsed time = 0:08:20
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.1_ffn_num_layers_2_hidden_size_1100/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1100, out_features=1100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 3,941,301
Moving model to cuda
Epoch 0
Loss = 1.4752e-02, PNorm = 60.2252, GNorm = 8.2899, lr_0 = 2.9800e-04
Loss = 1.1593e-02, PNorm = 60.2589, GNorm = 7.9839, lr_0 = 4.7800e-04
Validation rmse = 1.441067
Epoch 1
Loss = 8.1039e-03, PNorm = 60.3138, GNorm = 6.3814, lr_0 = 6.7600e-04
Loss = 6.3485e-03, PNorm = 60.3719, GNorm = 3.8440, lr_0 = 8.5600e-04
Loss = 6.9327e-03, PNorm = 60.4421, GNorm = 2.5007, lr_0 = 9.9344e-04
Validation rmse = 1.106080
Epoch 2
Loss = 5.4635e-03, PNorm = 60.5116, GNorm = 2.5042, lr_0 = 9.6130e-04
Loss = 5.2916e-03, PNorm = 60.5787, GNorm = 2.9253, lr_0 = 9.3019e-04
Validation rmse = 1.204461
Epoch 3
Loss = 4.9745e-03, PNorm = 60.6380, GNorm = 2.8154, lr_0 = 9.0009e-04
Loss = 4.4742e-03, PNorm = 60.6926, GNorm = 1.1428, lr_0 = 8.7096e-04
Loss = 4.2773e-03, PNorm = 60.7448, GNorm = 2.1817, lr_0 = 8.4278e-04
Validation rmse = 1.038420
Epoch 4
Loss = 2.9537e-03, PNorm = 60.7899, GNorm = 2.1201, lr_0 = 8.1551e-04
Loss = 3.2404e-03, PNorm = 60.8239, GNorm = 2.6311, lr_0 = 7.8912e-04
Validation rmse = 1.060453
Epoch 5
Loss = 3.3079e-03, PNorm = 60.8596, GNorm = 3.2567, lr_0 = 7.6358e-04
Loss = 2.9867e-03, PNorm = 60.8944, GNorm = 2.8513, lr_0 = 7.3888e-04
Loss = 3.1710e-03, PNorm = 60.9270, GNorm = 3.3032, lr_0 = 7.1497e-04
Validation rmse = 1.023489
Epoch 6
Loss = 3.0278e-03, PNorm = 60.9774, GNorm = 3.8711, lr_0 = 6.8956e-04
Loss = 2.7816e-03, PNorm = 61.0152, GNorm = 0.8388, lr_0 = 6.6725e-04
Loss = 2.7981e-03, PNorm = 61.0398, GNorm = 2.8933, lr_0 = 6.4565e-04
Validation rmse = 0.993661
Epoch 7
Loss = 2.2709e-03, PNorm = 61.0695, GNorm = 1.9037, lr_0 = 6.2476e-04
Loss = 2.5232e-03, PNorm = 61.0966, GNorm = 2.7320, lr_0 = 6.0454e-04
Validation rmse = 0.861207
Epoch 8
Loss = 1.8681e-03, PNorm = 61.1226, GNorm = 1.4862, lr_0 = 5.8498e-04
Loss = 2.6298e-03, PNorm = 61.1424, GNorm = 2.9226, lr_0 = 5.6605e-04
Loss = 2.0664e-03, PNorm = 61.1708, GNorm = 2.5675, lr_0 = 5.4774e-04
Validation rmse = 0.985536
Epoch 9
Loss = 2.0084e-03, PNorm = 61.1972, GNorm = 1.5220, lr_0 = 5.3001e-04
Loss = 1.7122e-03, PNorm = 61.2189, GNorm = 0.9335, lr_0 = 5.1286e-04
Validation rmse = 0.884694
Epoch 10
Loss = 2.1264e-03, PNorm = 61.2419, GNorm = 1.9432, lr_0 = 4.9627e-04
Loss = 2.3972e-03, PNorm = 61.2702, GNorm = 3.2392, lr_0 = 4.8021e-04
Loss = 1.9663e-03, PNorm = 61.2928, GNorm = 2.2999, lr_0 = 4.6467e-04
Validation rmse = 0.890978
Epoch 11
Loss = 1.7027e-03, PNorm = 61.3107, GNorm = 1.7570, lr_0 = 4.4963e-04
Loss = 1.5890e-03, PNorm = 61.3321, GNorm = 0.6954, lr_0 = 4.3508e-04
Validation rmse = 0.842065
Epoch 12
Loss = 1.4588e-03, PNorm = 61.3537, GNorm = 0.7858, lr_0 = 4.1962e-04
Loss = 1.4868e-03, PNorm = 61.3695, GNorm = 0.6428, lr_0 = 4.0604e-04
Loss = 1.5271e-03, PNorm = 61.3865, GNorm = 2.4536, lr_0 = 3.9290e-04
Validation rmse = 0.823758
Epoch 13
Loss = 1.5456e-03, PNorm = 61.4013, GNorm = 2.3390, lr_0 = 3.8019e-04
Loss = 1.5310e-03, PNorm = 61.4169, GNorm = 1.7153, lr_0 = 3.6789e-04
Loss = 1.3159e-03, PNorm = 61.4301, GNorm = 1.5850, lr_0 = 3.5598e-04
Validation rmse = 0.858407
Epoch 14
Loss = 1.4005e-03, PNorm = 61.4449, GNorm = 1.7307, lr_0 = 3.4446e-04
Loss = 1.1270e-03, PNorm = 61.4591, GNorm = 1.1549, lr_0 = 3.3332e-04
Validation rmse = 0.843681
Epoch 15
Loss = 1.3752e-03, PNorm = 61.4682, GNorm = 1.4594, lr_0 = 3.2253e-04
Loss = 1.5331e-03, PNorm = 61.4808, GNorm = 1.0182, lr_0 = 3.1209e-04
Loss = 1.3811e-03, PNorm = 61.4993, GNorm = 2.7413, lr_0 = 3.0200e-04
Validation rmse = 0.850689
Epoch 16
Loss = 1.2677e-03, PNorm = 61.5159, GNorm = 1.1121, lr_0 = 2.9222e-04
Loss = 1.2108e-03, PNorm = 61.5292, GNorm = 1.5487, lr_0 = 2.8277e-04
Validation rmse = 0.823127
Epoch 17
Loss = 1.0771e-03, PNorm = 61.5408, GNorm = 0.6246, lr_0 = 2.7272e-04
Loss = 1.0991e-03, PNorm = 61.5531, GNorm = 1.1031, lr_0 = 2.6389e-04
Loss = 1.2321e-03, PNorm = 61.5661, GNorm = 1.5114, lr_0 = 2.5535e-04
Validation rmse = 0.831226
Epoch 18
Loss = 1.0807e-03, PNorm = 61.5745, GNorm = 0.5188, lr_0 = 2.4709e-04
Loss = 9.9771e-04, PNorm = 61.5835, GNorm = 0.9188, lr_0 = 2.3910e-04
Loss = 1.0207e-03, PNorm = 61.5939, GNorm = 0.9503, lr_0 = 2.3136e-04
Validation rmse = 0.794036
Epoch 19
Loss = 1.0189e-03, PNorm = 61.6049, GNorm = 0.5194, lr_0 = 2.2387e-04
Loss = 1.0918e-03, PNorm = 61.6148, GNorm = 2.0958, lr_0 = 2.1663e-04
Validation rmse = 0.803276
Epoch 20
Loss = 9.0094e-04, PNorm = 61.6238, GNorm = 0.7232, lr_0 = 2.0962e-04
Loss = 1.0803e-03, PNorm = 61.6327, GNorm = 1.1891, lr_0 = 2.0283e-04
Loss = 9.7491e-04, PNorm = 61.6427, GNorm = 0.8657, lr_0 = 1.9627e-04
Validation rmse = 0.806917
Epoch 21
Loss = 8.5110e-04, PNorm = 61.6519, GNorm = 1.2951, lr_0 = 1.8992e-04
Loss = 8.2586e-04, PNorm = 61.6585, GNorm = 0.6198, lr_0 = 1.8377e-04
Validation rmse = 0.813572
Epoch 22
Loss = 1.0465e-03, PNorm = 61.6680, GNorm = 0.6143, lr_0 = 1.7783e-04
Loss = 9.4265e-04, PNorm = 61.6779, GNorm = 1.6763, lr_0 = 1.7207e-04
Loss = 9.3905e-04, PNorm = 61.6866, GNorm = 0.9529, lr_0 = 1.6651e-04
Validation rmse = 0.820846
Epoch 23
Loss = 8.2914e-04, PNorm = 61.6937, GNorm = 0.4948, lr_0 = 1.6059e-04
Loss = 1.0300e-03, PNorm = 61.7017, GNorm = 2.5629, lr_0 = 1.5539e-04
Validation rmse = 0.797764
Epoch 24
Loss = 8.2593e-04, PNorm = 61.7086, GNorm = 1.6299, lr_0 = 1.5036e-04
Loss = 8.7000e-04, PNorm = 61.7171, GNorm = 0.3685, lr_0 = 1.4550e-04
Loss = 8.4141e-04, PNorm = 61.7243, GNorm = 0.7879, lr_0 = 1.4079e-04
Validation rmse = 0.801795
Epoch 25
Loss = 6.6704e-04, PNorm = 61.7307, GNorm = 0.3538, lr_0 = 1.3623e-04
Loss = 8.2649e-04, PNorm = 61.7358, GNorm = 0.7038, lr_0 = 1.3183e-04
Loss = 7.6004e-04, PNorm = 61.7419, GNorm = 0.8352, lr_0 = 1.2756e-04
Validation rmse = 0.811582
Epoch 26
Loss = 6.4912e-04, PNorm = 61.7488, GNorm = 1.1881, lr_0 = 1.2343e-04
Loss = 7.7790e-04, PNorm = 61.7534, GNorm = 0.5961, lr_0 = 1.1944e-04
Validation rmse = 0.792401
Epoch 27
Loss = 6.4022e-04, PNorm = 61.7593, GNorm = 0.5507, lr_0 = 1.1557e-04
Loss = 8.8981e-04, PNorm = 61.7652, GNorm = 1.2153, lr_0 = 1.1183e-04
Loss = 6.8523e-04, PNorm = 61.7703, GNorm = 0.9734, lr_0 = 1.0821e-04
Validation rmse = 0.815407
Epoch 28
Loss = 6.9958e-04, PNorm = 61.7755, GNorm = 0.4634, lr_0 = 1.0437e-04
Loss = 6.9451e-04, PNorm = 61.7804, GNorm = 0.4559, lr_0 = 1.0099e-04
Validation rmse = 0.801791
Epoch 29
Loss = 8.4135e-04, PNorm = 61.7853, GNorm = 0.9664, lr_0 = 1.0000e-04
Loss = 6.8095e-04, PNorm = 61.7895, GNorm = 0.8208, lr_0 = 1.0000e-04
Loss = 8.6094e-04, PNorm = 61.7946, GNorm = 2.4633, lr_0 = 1.0000e-04
Validation rmse = 0.827705
Model 0 best validation rmse = 0.792401 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.777294
Ensemble test rmse = 0.777294
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.1_ffn_num_layers_2_hidden_size_1100/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1100, out_features=1100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 3,941,301
Moving model to cuda
Epoch 0
Loss = 1.7635e-02, PNorm = 60.2255, GNorm = 3.0965, lr_0 = 2.9800e-04
Loss = 1.2424e-02, PNorm = 60.2565, GNorm = 7.5708, lr_0 = 4.7800e-04
Validation rmse = 1.535769
Epoch 1
Loss = 7.7062e-03, PNorm = 60.3117, GNorm = 4.3957, lr_0 = 6.7600e-04
Loss = 7.2567e-03, PNorm = 60.3719, GNorm = 2.1081, lr_0 = 8.5600e-04
Loss = 5.5334e-03, PNorm = 60.4297, GNorm = 2.5461, lr_0 = 9.9344e-04
Validation rmse = 1.237002
Epoch 2
Loss = 4.7750e-03, PNorm = 60.4906, GNorm = 2.3364, lr_0 = 9.6130e-04
Loss = 5.7337e-03, PNorm = 60.5459, GNorm = 1.4938, lr_0 = 9.3019e-04
Validation rmse = 1.242705
Epoch 3
Loss = 4.6548e-03, PNorm = 60.5973, GNorm = 1.4710, lr_0 = 9.0009e-04
Loss = 4.8401e-03, PNorm = 60.6461, GNorm = 5.3678, lr_0 = 8.7096e-04
Loss = 4.7157e-03, PNorm = 60.6954, GNorm = 0.9013, lr_0 = 8.4278e-04
Validation rmse = 1.082920
Epoch 4
Loss = 4.9255e-03, PNorm = 60.7359, GNorm = 2.5480, lr_0 = 8.1551e-04
Loss = 3.8843e-03, PNorm = 60.7793, GNorm = 3.3516, lr_0 = 7.8912e-04
Validation rmse = 0.894683
Epoch 5
Loss = 2.8578e-03, PNorm = 60.8240, GNorm = 2.0390, lr_0 = 7.6358e-04
Loss = 4.5191e-03, PNorm = 60.8646, GNorm = 1.8056, lr_0 = 7.3888e-04
Loss = 3.4255e-03, PNorm = 60.9026, GNorm = 1.5113, lr_0 = 7.1497e-04
Validation rmse = 0.940808
Epoch 6
Loss = 3.4816e-03, PNorm = 60.9383, GNorm = 2.2403, lr_0 = 6.8956e-04
Loss = 3.0975e-03, PNorm = 60.9760, GNorm = 1.9116, lr_0 = 6.6725e-04
Loss = 2.5853e-03, PNorm = 61.0076, GNorm = 0.5316, lr_0 = 6.4565e-04
Validation rmse = 0.790619
Epoch 7
Loss = 2.2120e-03, PNorm = 61.0360, GNorm = 0.6256, lr_0 = 6.2476e-04
Loss = 2.1697e-03, PNorm = 61.0570, GNorm = 2.3913, lr_0 = 6.0454e-04
Validation rmse = 0.832262
Epoch 8
Loss = 2.7878e-03, PNorm = 61.0813, GNorm = 2.9125, lr_0 = 5.8498e-04
Loss = 2.2488e-03, PNorm = 61.1060, GNorm = 1.9148, lr_0 = 5.6605e-04
Loss = 1.9387e-03, PNorm = 61.1278, GNorm = 1.1846, lr_0 = 5.4774e-04
Validation rmse = 0.783970
Epoch 9
Loss = 1.7991e-03, PNorm = 61.1522, GNorm = 1.5764, lr_0 = 5.3001e-04
Loss = 2.1466e-03, PNorm = 61.1798, GNorm = 0.8368, lr_0 = 5.1286e-04
Validation rmse = 0.843671
Epoch 10
Loss = 2.2934e-03, PNorm = 61.1969, GNorm = 3.0413, lr_0 = 4.9627e-04
Loss = 2.8058e-03, PNorm = 61.2175, GNorm = 3.3793, lr_0 = 4.8021e-04
Loss = 2.0932e-03, PNorm = 61.2368, GNorm = 2.3749, lr_0 = 4.6467e-04
Validation rmse = 0.796862
Epoch 11
Loss = 2.1871e-03, PNorm = 61.2600, GNorm = 2.5043, lr_0 = 4.4963e-04
Loss = 1.9578e-03, PNorm = 61.2786, GNorm = 0.5836, lr_0 = 4.3508e-04
Validation rmse = 0.732232
Epoch 12
Loss = 1.9107e-03, PNorm = 61.2979, GNorm = 1.0769, lr_0 = 4.1962e-04
Loss = 1.8754e-03, PNorm = 61.3174, GNorm = 2.0358, lr_0 = 4.0604e-04
Loss = 2.0150e-03, PNorm = 61.3363, GNorm = 2.1148, lr_0 = 3.9290e-04
Validation rmse = 0.895189
Epoch 13
Loss = 1.7167e-03, PNorm = 61.3521, GNorm = 1.8535, lr_0 = 3.8019e-04
Loss = 1.9319e-03, PNorm = 61.3670, GNorm = 2.1062, lr_0 = 3.6789e-04
Loss = 2.0080e-03, PNorm = 61.3790, GNorm = 1.8413, lr_0 = 3.5598e-04
Validation rmse = 0.712798
Epoch 14
Loss = 1.6127e-03, PNorm = 61.3959, GNorm = 1.9849, lr_0 = 3.4446e-04
Loss = 1.5346e-03, PNorm = 61.4078, GNorm = 1.7920, lr_0 = 3.3332e-04
Validation rmse = 0.731030
Epoch 15
Loss = 1.2730e-03, PNorm = 61.4224, GNorm = 1.1504, lr_0 = 3.2253e-04
Loss = 1.5081e-03, PNorm = 61.4369, GNorm = 2.3636, lr_0 = 3.1209e-04
Loss = 1.7679e-03, PNorm = 61.4510, GNorm = 0.5718, lr_0 = 3.0200e-04
Validation rmse = 0.735119
Epoch 16
Loss = 1.8270e-03, PNorm = 61.4641, GNorm = 1.2073, lr_0 = 2.9222e-04
Loss = 1.0230e-03, PNorm = 61.4750, GNorm = 0.9145, lr_0 = 2.8277e-04
Validation rmse = 0.677971
Epoch 17
Loss = 1.0625e-03, PNorm = 61.4855, GNorm = 0.8885, lr_0 = 2.7272e-04
Loss = 1.3740e-03, PNorm = 61.4956, GNorm = 0.6027, lr_0 = 2.6389e-04
Loss = 1.2123e-03, PNorm = 61.5066, GNorm = 1.1166, lr_0 = 2.5535e-04
Validation rmse = 0.684585
Epoch 18
Loss = 1.2066e-03, PNorm = 61.5159, GNorm = 0.5880, lr_0 = 2.4709e-04
Loss = 1.4050e-03, PNorm = 61.5263, GNorm = 0.8707, lr_0 = 2.3910e-04
Loss = 1.2872e-03, PNorm = 61.5380, GNorm = 1.4657, lr_0 = 2.3136e-04
Validation rmse = 0.681888
Epoch 19
Loss = 1.2321e-03, PNorm = 61.5468, GNorm = 1.4138, lr_0 = 2.2387e-04
Loss = 1.1984e-03, PNorm = 61.5548, GNorm = 1.5821, lr_0 = 2.1663e-04
Validation rmse = 0.660516
Epoch 20
Loss = 8.9422e-04, PNorm = 61.5654, GNorm = 0.3592, lr_0 = 2.0962e-04
Loss = 1.3774e-03, PNorm = 61.5748, GNorm = 1.2713, lr_0 = 2.0283e-04
Loss = 1.2217e-03, PNorm = 61.5826, GNorm = 1.4717, lr_0 = 1.9627e-04
Validation rmse = 0.655049
Epoch 21
Loss = 1.0079e-03, PNorm = 61.5909, GNorm = 1.3606, lr_0 = 1.8992e-04
Loss = 1.1430e-03, PNorm = 61.5998, GNorm = 2.3896, lr_0 = 1.8377e-04
Validation rmse = 0.656092
Epoch 22
Loss = 8.5171e-04, PNorm = 61.6078, GNorm = 1.1346, lr_0 = 1.7783e-04
Loss = 1.0761e-03, PNorm = 61.6147, GNorm = 1.3827, lr_0 = 1.7207e-04
Loss = 1.0502e-03, PNorm = 61.6223, GNorm = 0.6210, lr_0 = 1.6651e-04
Validation rmse = 0.674877
Epoch 23
Loss = 9.7469e-04, PNorm = 61.6327, GNorm = 1.5851, lr_0 = 1.6059e-04
Loss = 1.0788e-03, PNorm = 61.6404, GNorm = 0.8747, lr_0 = 1.5539e-04
Validation rmse = 0.748081
Epoch 24
Loss = 1.0792e-03, PNorm = 61.6467, GNorm = 1.5774, lr_0 = 1.5036e-04
Loss = 1.1585e-03, PNorm = 61.6530, GNorm = 1.9460, lr_0 = 1.4550e-04
Loss = 1.0890e-03, PNorm = 61.6611, GNorm = 1.4087, lr_0 = 1.4079e-04
Validation rmse = 0.695576
Epoch 25
Loss = 8.9138e-04, PNorm = 61.6676, GNorm = 1.1456, lr_0 = 1.3623e-04
Loss = 1.0953e-03, PNorm = 61.6738, GNorm = 0.5675, lr_0 = 1.3183e-04
Loss = 1.1318e-03, PNorm = 61.6802, GNorm = 0.5365, lr_0 = 1.2756e-04
Validation rmse = 0.661083
Epoch 26
Loss = 1.0885e-03, PNorm = 61.6859, GNorm = 0.4964, lr_0 = 1.2343e-04
Loss = 9.4119e-04, PNorm = 61.6909, GNorm = 1.0852, lr_0 = 1.1944e-04
Validation rmse = 0.641715
Epoch 27
Loss = 1.1032e-03, PNorm = 61.6949, GNorm = 0.8293, lr_0 = 1.1557e-04
Loss = 8.1732e-04, PNorm = 61.7007, GNorm = 0.6057, lr_0 = 1.1183e-04
Loss = 9.7050e-04, PNorm = 61.7071, GNorm = 0.2996, lr_0 = 1.0821e-04
Validation rmse = 0.647195
Epoch 28
Loss = 1.0412e-03, PNorm = 61.7130, GNorm = 0.7867, lr_0 = 1.0437e-04
Loss = 8.2136e-04, PNorm = 61.7166, GNorm = 0.4158, lr_0 = 1.0099e-04
Validation rmse = 0.659869
Epoch 29
Loss = 8.5640e-04, PNorm = 61.7209, GNorm = 1.3936, lr_0 = 1.0000e-04
Loss = 9.2647e-04, PNorm = 61.7258, GNorm = 1.1045, lr_0 = 1.0000e-04
Loss = 8.6221e-04, PNorm = 61.7305, GNorm = 0.9766, lr_0 = 1.0000e-04
Validation rmse = 0.638717
Model 0 best validation rmse = 0.638717 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.640943
Ensemble test rmse = 0.640943
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.1_ffn_num_layers_2_hidden_size_1100/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1100, out_features=1100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 3,941,301
Moving model to cuda
Epoch 0
Loss = 1.8105e-02, PNorm = 60.2237, GNorm = 3.1913, lr_0 = 2.9800e-04
Loss = 1.2410e-02, PNorm = 60.2576, GNorm = 3.2334, lr_0 = 4.7800e-04
Validation rmse = 1.625189
Epoch 1
Loss = 1.0092e-02, PNorm = 60.3176, GNorm = 5.1193, lr_0 = 6.7600e-04
Loss = 8.6576e-03, PNorm = 60.3822, GNorm = 3.0375, lr_0 = 8.5600e-04
Loss = 6.3512e-03, PNorm = 60.4531, GNorm = 2.0389, lr_0 = 9.9344e-04
Validation rmse = 1.196824
Epoch 2
Loss = 7.1578e-03, PNorm = 60.5322, GNorm = 11.9059, lr_0 = 9.6130e-04
Loss = 7.7720e-03, PNorm = 60.6093, GNorm = 3.7208, lr_0 = 9.3019e-04
Validation rmse = 1.074579
Epoch 3
Loss = 5.7434e-03, PNorm = 60.6766, GNorm = 5.6403, lr_0 = 9.0009e-04
Loss = 5.0688e-03, PNorm = 60.7261, GNorm = 2.5416, lr_0 = 8.7096e-04
Loss = 5.3686e-03, PNorm = 60.7782, GNorm = 4.0875, lr_0 = 8.4278e-04
Validation rmse = 0.928963
Epoch 4
Loss = 4.1406e-03, PNorm = 60.8273, GNorm = 3.1843, lr_0 = 8.1551e-04
Loss = 4.0927e-03, PNorm = 60.8716, GNorm = 4.1600, lr_0 = 7.8912e-04
Validation rmse = 0.882670
Epoch 5
Loss = 3.4364e-03, PNorm = 60.9119, GNorm = 0.7463, lr_0 = 7.6358e-04
Loss = 3.2281e-03, PNorm = 60.9534, GNorm = 1.7100, lr_0 = 7.3888e-04
Loss = 2.8801e-03, PNorm = 60.9923, GNorm = 1.7027, lr_0 = 7.1497e-04
Validation rmse = 0.836595
Epoch 6
Loss = 3.2058e-03, PNorm = 61.0245, GNorm = 2.0209, lr_0 = 6.8956e-04
Loss = 2.5932e-03, PNorm = 61.0576, GNorm = 1.5888, lr_0 = 6.6725e-04
Loss = 3.1550e-03, PNorm = 61.0906, GNorm = 2.3309, lr_0 = 6.4565e-04
Validation rmse = 0.775862
Epoch 7
Loss = 2.8776e-03, PNorm = 61.1243, GNorm = 4.5104, lr_0 = 6.2476e-04
Loss = 2.5707e-03, PNorm = 61.1645, GNorm = 1.9694, lr_0 = 6.0454e-04
Validation rmse = 0.787126
Epoch 8
Loss = 2.5824e-03, PNorm = 61.1998, GNorm = 0.5603, lr_0 = 5.8498e-04
Loss = 1.7857e-03, PNorm = 61.2255, GNorm = 1.1702, lr_0 = 5.6605e-04
Loss = 2.1903e-03, PNorm = 61.2481, GNorm = 1.5985, lr_0 = 5.4774e-04
Validation rmse = 0.768488
Epoch 9
Loss = 2.4959e-03, PNorm = 61.2753, GNorm = 0.6218, lr_0 = 5.3001e-04
Loss = 2.4414e-03, PNorm = 61.3038, GNorm = 3.1622, lr_0 = 5.1286e-04
Validation rmse = 0.732056
Epoch 10
Loss = 2.3678e-03, PNorm = 61.3305, GNorm = 1.2677, lr_0 = 4.9627e-04
Loss = 2.0829e-03, PNorm = 61.3506, GNorm = 2.0227, lr_0 = 4.8021e-04
Loss = 2.3689e-03, PNorm = 61.3798, GNorm = 3.5302, lr_0 = 4.6467e-04
Validation rmse = 0.682368
Epoch 11
Loss = 1.9060e-03, PNorm = 61.3996, GNorm = 2.2636, lr_0 = 4.4963e-04
Loss = 2.0303e-03, PNorm = 61.4218, GNorm = 0.7603, lr_0 = 4.3508e-04
Validation rmse = 0.674852
Epoch 12
Loss = 9.5725e-04, PNorm = 61.4428, GNorm = 0.5990, lr_0 = 4.1962e-04
Loss = 1.7439e-03, PNorm = 61.4599, GNorm = 2.5639, lr_0 = 4.0604e-04
Loss = 1.4655e-03, PNorm = 61.4788, GNorm = 0.7817, lr_0 = 3.9290e-04
Validation rmse = 0.699813
Epoch 13
Loss = 1.4671e-03, PNorm = 61.4948, GNorm = 0.9310, lr_0 = 3.8019e-04
Loss = 1.5635e-03, PNorm = 61.5130, GNorm = 3.4827, lr_0 = 3.6789e-04
Loss = 2.0695e-03, PNorm = 61.5324, GNorm = 1.7248, lr_0 = 3.5598e-04
Validation rmse = 0.740037
Epoch 14
Loss = 1.5323e-03, PNorm = 61.5450, GNorm = 0.7871, lr_0 = 3.4446e-04
Loss = 1.5288e-03, PNorm = 61.5633, GNorm = 0.7682, lr_0 = 3.3332e-04
Validation rmse = 0.761187
Epoch 15
Loss = 1.7152e-03, PNorm = 61.5792, GNorm = 0.4463, lr_0 = 3.2253e-04
Loss = 1.3842e-03, PNorm = 61.5934, GNorm = 0.8499, lr_0 = 3.1209e-04
Loss = 1.7636e-03, PNorm = 61.6116, GNorm = 2.1620, lr_0 = 3.0200e-04
Validation rmse = 0.658101
Epoch 16
Loss = 1.2705e-03, PNorm = 61.6261, GNorm = 1.1708, lr_0 = 2.9222e-04
Loss = 1.3382e-03, PNorm = 61.6391, GNorm = 0.8973, lr_0 = 2.8277e-04
Validation rmse = 0.643318
Epoch 17
Loss = 9.6461e-04, PNorm = 61.6540, GNorm = 2.1775, lr_0 = 2.7272e-04
Loss = 1.1628e-03, PNorm = 61.6650, GNorm = 0.6426, lr_0 = 2.6389e-04
Loss = 1.4762e-03, PNorm = 61.6769, GNorm = 2.3548, lr_0 = 2.5535e-04
Validation rmse = 0.664824
Epoch 18
Loss = 1.2086e-03, PNorm = 61.6892, GNorm = 0.4003, lr_0 = 2.4709e-04
Loss = 1.3271e-03, PNorm = 61.7012, GNorm = 0.6486, lr_0 = 2.3910e-04
Loss = 1.1343e-03, PNorm = 61.7067, GNorm = 0.6505, lr_0 = 2.3136e-04
Validation rmse = 0.656311
Epoch 19
Loss = 1.2809e-03, PNorm = 61.7183, GNorm = 1.0980, lr_0 = 2.2387e-04
Loss = 1.0214e-03, PNorm = 61.7281, GNorm = 0.9699, lr_0 = 2.1663e-04
Validation rmse = 0.648761
Epoch 20
Loss = 1.0923e-03, PNorm = 61.7381, GNorm = 2.2395, lr_0 = 2.0962e-04
Loss = 1.0197e-03, PNorm = 61.7476, GNorm = 1.2008, lr_0 = 2.0283e-04
Loss = 1.1254e-03, PNorm = 61.7552, GNorm = 0.6016, lr_0 = 1.9627e-04
Validation rmse = 0.643659
Epoch 21
Loss = 1.0104e-03, PNorm = 61.7636, GNorm = 0.6793, lr_0 = 1.8992e-04
Loss = 1.1321e-03, PNorm = 61.7719, GNorm = 1.4470, lr_0 = 1.8377e-04
Validation rmse = 0.655411
Epoch 22
Loss = 1.0109e-03, PNorm = 61.7802, GNorm = 0.5341, lr_0 = 1.7783e-04
Loss = 1.1578e-03, PNorm = 61.7891, GNorm = 0.5480, lr_0 = 1.7207e-04
Loss = 9.6924e-04, PNorm = 61.7973, GNorm = 0.9498, lr_0 = 1.6651e-04
Validation rmse = 0.643666
Epoch 23
Loss = 1.0519e-03, PNorm = 61.8064, GNorm = 1.0349, lr_0 = 1.6059e-04
Loss = 1.0688e-03, PNorm = 61.8128, GNorm = 0.9890, lr_0 = 1.5539e-04
Validation rmse = 0.639260
Epoch 24
Loss = 1.0856e-03, PNorm = 61.8191, GNorm = 1.5824, lr_0 = 1.5036e-04
Loss = 9.0085e-04, PNorm = 61.8253, GNorm = 0.4721, lr_0 = 1.4550e-04
Loss = 7.9651e-04, PNorm = 61.8316, GNorm = 1.6949, lr_0 = 1.4079e-04
Validation rmse = 0.629949
Epoch 25
Loss = 9.0365e-04, PNorm = 61.8375, GNorm = 2.4612, lr_0 = 1.3623e-04
Loss = 9.5169e-04, PNorm = 61.8443, GNorm = 0.8296, lr_0 = 1.3183e-04
Loss = 9.0230e-04, PNorm = 61.8481, GNorm = 0.6796, lr_0 = 1.2756e-04
Validation rmse = 0.636855
Epoch 26
Loss = 8.3264e-04, PNorm = 61.8529, GNorm = 1.8419, lr_0 = 1.2343e-04
Loss = 9.3053e-04, PNorm = 61.8592, GNorm = 0.5794, lr_0 = 1.1944e-04
Validation rmse = 0.637244
Epoch 27
Loss = 8.9472e-04, PNorm = 61.8647, GNorm = 0.7576, lr_0 = 1.1557e-04
Loss = 9.5101e-04, PNorm = 61.8705, GNorm = 0.8062, lr_0 = 1.1183e-04
Loss = 7.6841e-04, PNorm = 61.8752, GNorm = 1.2419, lr_0 = 1.0821e-04
Validation rmse = 0.647547
Epoch 28
Loss = 9.0427e-04, PNorm = 61.8789, GNorm = 0.6803, lr_0 = 1.0437e-04
Loss = 8.2544e-04, PNorm = 61.8827, GNorm = 0.5401, lr_0 = 1.0099e-04
Validation rmse = 0.631143
Epoch 29
Loss = 1.0447e-03, PNorm = 61.8870, GNorm = 1.2589, lr_0 = 1.0000e-04
Loss = 8.7162e-04, PNorm = 61.8926, GNorm = 1.6605, lr_0 = 1.0000e-04
Loss = 7.1200e-04, PNorm = 61.8966, GNorm = 0.5781, lr_0 = 1.0000e-04
Validation rmse = 0.624047
Model 0 best validation rmse = 0.624047 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.678325
Ensemble test rmse = 0.678325
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.1_ffn_num_layers_2_hidden_size_1100/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1100, out_features=1100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 3,941,301
Moving model to cuda
Epoch 0
Loss = 1.6926e-02, PNorm = 60.2238, GNorm = 11.7175, lr_0 = 2.9800e-04
Loss = 1.0445e-02, PNorm = 60.2587, GNorm = 2.0176, lr_0 = 4.7800e-04
Validation rmse = 1.247645
Epoch 1
Loss = 5.3267e-03, PNorm = 60.3150, GNorm = 2.8560, lr_0 = 6.7600e-04
Loss = 6.7033e-03, PNorm = 60.3756, GNorm = 10.5163, lr_0 = 8.5600e-04
Loss = 8.1035e-03, PNorm = 60.4519, GNorm = 1.4649, lr_0 = 9.9344e-04
Validation rmse = 1.120186
Epoch 2
Loss = 5.8929e-03, PNorm = 60.5311, GNorm = 1.5660, lr_0 = 9.6130e-04
Loss = 5.1962e-03, PNorm = 60.5948, GNorm = 6.1765, lr_0 = 9.3019e-04
Validation rmse = 1.245234
Epoch 3
Loss = 5.3316e-03, PNorm = 60.6549, GNorm = 0.9676, lr_0 = 9.0009e-04
Loss = 4.3235e-03, PNorm = 60.7132, GNorm = 2.3349, lr_0 = 8.7096e-04
Loss = 4.0981e-03, PNorm = 60.7631, GNorm = 1.7989, lr_0 = 8.4278e-04
Validation rmse = 0.902984
Epoch 4
Loss = 3.2913e-03, PNorm = 60.8067, GNorm = 4.4118, lr_0 = 8.1551e-04
Loss = 3.6002e-03, PNorm = 60.8463, GNorm = 3.4290, lr_0 = 7.8912e-04
Validation rmse = 0.936316
Epoch 5
Loss = 4.0877e-03, PNorm = 60.8854, GNorm = 4.4434, lr_0 = 7.6358e-04
Loss = 2.4884e-03, PNorm = 60.9181, GNorm = 0.6810, lr_0 = 7.3888e-04
Loss = 3.0790e-03, PNorm = 60.9537, GNorm = 2.3446, lr_0 = 7.1497e-04
Validation rmse = 0.860934
Epoch 6
Loss = 2.8424e-03, PNorm = 60.9959, GNorm = 2.4599, lr_0 = 6.8956e-04
Loss = 2.7081e-03, PNorm = 61.0248, GNorm = 1.1001, lr_0 = 6.6725e-04
Loss = 2.8660e-03, PNorm = 61.0546, GNorm = 5.1912, lr_0 = 6.4565e-04
Validation rmse = 0.744285
Epoch 7
Loss = 2.3300e-03, PNorm = 61.0869, GNorm = 3.7000, lr_0 = 6.2476e-04
Loss = 2.9474e-03, PNorm = 61.1154, GNorm = 2.1529, lr_0 = 6.0454e-04
Validation rmse = 0.727614
Epoch 8
Loss = 1.9450e-03, PNorm = 61.1400, GNorm = 1.1395, lr_0 = 5.8498e-04
Loss = 2.1694e-03, PNorm = 61.1672, GNorm = 2.8833, lr_0 = 5.6605e-04
Loss = 2.2627e-03, PNorm = 61.1947, GNorm = 0.8604, lr_0 = 5.4774e-04
Validation rmse = 0.714739
Epoch 9
Loss = 2.3120e-03, PNorm = 61.2193, GNorm = 1.4929, lr_0 = 5.3001e-04
Loss = 2.6301e-03, PNorm = 61.2440, GNorm = 2.9902, lr_0 = 5.1286e-04
Validation rmse = 0.777442
Epoch 10
Loss = 1.0485e-03, PNorm = 61.2675, GNorm = 0.6283, lr_0 = 4.9627e-04
Loss = 1.9569e-03, PNorm = 61.2887, GNorm = 2.7272, lr_0 = 4.8021e-04
Loss = 2.2146e-03, PNorm = 61.3131, GNorm = 1.9389, lr_0 = 4.6467e-04
Validation rmse = 0.750118
Epoch 11
Loss = 1.7145e-03, PNorm = 61.3346, GNorm = 0.8945, lr_0 = 4.4963e-04
Loss = 2.1877e-03, PNorm = 61.3586, GNorm = 2.5957, lr_0 = 4.3508e-04
Validation rmse = 0.730103
Epoch 12
Loss = 1.7978e-03, PNorm = 61.3844, GNorm = 0.9205, lr_0 = 4.1962e-04
Loss = 1.6003e-03, PNorm = 61.4029, GNorm = 1.2967, lr_0 = 4.0604e-04
Loss = 1.6973e-03, PNorm = 61.4198, GNorm = 1.9397, lr_0 = 3.9290e-04
Validation rmse = 0.711821
Epoch 13
Loss = 1.8758e-03, PNorm = 61.4381, GNorm = 1.9234, lr_0 = 3.8019e-04
Loss = 1.7139e-03, PNorm = 61.4562, GNorm = 2.4160, lr_0 = 3.6789e-04
Loss = 1.4276e-03, PNorm = 61.4775, GNorm = 0.7691, lr_0 = 3.5598e-04
Validation rmse = 0.681906
Epoch 14
Loss = 1.4361e-03, PNorm = 61.4974, GNorm = 1.0985, lr_0 = 3.4446e-04
Loss = 1.4000e-03, PNorm = 61.5127, GNorm = 0.6111, lr_0 = 3.3332e-04
Validation rmse = 0.682357
Epoch 15
Loss = 1.0371e-03, PNorm = 61.5264, GNorm = 0.5611, lr_0 = 3.2253e-04
Loss = 1.3383e-03, PNorm = 61.5415, GNorm = 0.9084, lr_0 = 3.1209e-04
Loss = 1.3100e-03, PNorm = 61.5549, GNorm = 0.5522, lr_0 = 3.0200e-04
Validation rmse = 0.626372
Epoch 16
Loss = 1.2998e-03, PNorm = 61.5717, GNorm = 0.7491, lr_0 = 2.9222e-04
Loss = 1.3989e-03, PNorm = 61.5873, GNorm = 0.9781, lr_0 = 2.8277e-04
Validation rmse = 0.705261
Epoch 17
Loss = 1.2353e-03, PNorm = 61.6019, GNorm = 1.3564, lr_0 = 2.7272e-04
Loss = 1.1860e-03, PNorm = 61.6119, GNorm = 2.2497, lr_0 = 2.6389e-04
Loss = 1.2434e-03, PNorm = 61.6235, GNorm = 0.4623, lr_0 = 2.5535e-04
Validation rmse = 0.639544
Epoch 18
Loss = 1.1260e-03, PNorm = 61.6366, GNorm = 2.7473, lr_0 = 2.4709e-04
Loss = 1.2946e-03, PNorm = 61.6485, GNorm = 0.9915, lr_0 = 2.3910e-04
Loss = 1.0545e-03, PNorm = 61.6630, GNorm = 1.0612, lr_0 = 2.3136e-04
Validation rmse = 0.628258
Epoch 19
Loss = 1.2522e-03, PNorm = 61.6731, GNorm = 0.9396, lr_0 = 2.2387e-04
Loss = 1.0505e-03, PNorm = 61.6828, GNorm = 0.4485, lr_0 = 2.1663e-04
Validation rmse = 0.636395
Epoch 20
Loss = 1.0916e-03, PNorm = 61.6929, GNorm = 0.6244, lr_0 = 2.0962e-04
Loss = 1.2976e-03, PNorm = 61.7032, GNorm = 0.8231, lr_0 = 2.0283e-04
Loss = 1.2460e-03, PNorm = 61.7144, GNorm = 0.3301, lr_0 = 1.9627e-04
Validation rmse = 0.656139
Epoch 21
Loss = 1.0658e-03, PNorm = 61.7257, GNorm = 0.6594, lr_0 = 1.8992e-04
Loss = 1.3530e-03, PNorm = 61.7362, GNorm = 2.0920, lr_0 = 1.8377e-04
Validation rmse = 0.671424
Epoch 22
Loss = 1.6461e-03, PNorm = 61.7448, GNorm = 2.4671, lr_0 = 1.7783e-04
Loss = 1.0554e-03, PNorm = 61.7544, GNorm = 1.1138, lr_0 = 1.7207e-04
Loss = 8.2635e-04, PNorm = 61.7624, GNorm = 0.9105, lr_0 = 1.6651e-04
Validation rmse = 0.643667
Epoch 23
Loss = 1.0955e-03, PNorm = 61.7723, GNorm = 1.1906, lr_0 = 1.6059e-04
Loss = 8.5668e-04, PNorm = 61.7787, GNorm = 0.9049, lr_0 = 1.5539e-04
Validation rmse = 0.657742
Epoch 24
Loss = 8.4423e-04, PNorm = 61.7862, GNorm = 1.2297, lr_0 = 1.5036e-04
Loss = 8.4735e-04, PNorm = 61.7937, GNorm = 0.6032, lr_0 = 1.4550e-04
Loss = 8.0334e-04, PNorm = 61.7998, GNorm = 0.5045, lr_0 = 1.4079e-04
Validation rmse = 0.642109
Epoch 25
Loss = 8.8901e-04, PNorm = 61.8061, GNorm = 0.4934, lr_0 = 1.3623e-04
Loss = 9.4244e-04, PNorm = 61.8126, GNorm = 1.0835, lr_0 = 1.3183e-04
Loss = 9.7661e-04, PNorm = 61.8191, GNorm = 0.4973, lr_0 = 1.2756e-04
Validation rmse = 0.645893
Epoch 26
Loss = 8.5733e-04, PNorm = 61.8260, GNorm = 0.5133, lr_0 = 1.2343e-04
Loss = 7.5162e-04, PNorm = 61.8322, GNorm = 0.6051, lr_0 = 1.1944e-04
Validation rmse = 0.639915
Epoch 27
Loss = 6.8959e-04, PNorm = 61.8384, GNorm = 0.7356, lr_0 = 1.1557e-04
Loss = 8.9343e-04, PNorm = 61.8443, GNorm = 0.4758, lr_0 = 1.1183e-04
Loss = 7.9501e-04, PNorm = 61.8499, GNorm = 0.8635, lr_0 = 1.0821e-04
Validation rmse = 0.637181
Epoch 28
Loss = 7.5554e-04, PNorm = 61.8552, GNorm = 0.6318, lr_0 = 1.0437e-04
Loss = 9.3722e-04, PNorm = 61.8604, GNorm = 0.8418, lr_0 = 1.0099e-04
Validation rmse = 0.625271
Epoch 29
Loss = 5.2207e-04, PNorm = 61.8657, GNorm = 0.8727, lr_0 = 1.0000e-04
Loss = 7.4086e-04, PNorm = 61.8706, GNorm = 1.0714, lr_0 = 1.0000e-04
Loss = 8.8099e-04, PNorm = 61.8748, GNorm = 0.6168, lr_0 = 1.0000e-04
Validation rmse = 0.639840
Model 0 best validation rmse = 0.625271 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.875781
Ensemble test rmse = 0.875781
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.1_ffn_num_layers_2_hidden_size_1100/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1100, out_features=1100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 3,941,301
Moving model to cuda
Epoch 0
Loss = 1.7335e-02, PNorm = 60.2247, GNorm = 5.8631, lr_0 = 2.9800e-04
Loss = 1.0790e-02, PNorm = 60.2621, GNorm = 2.9636, lr_0 = 4.7800e-04
Validation rmse = 1.837235
Epoch 1
Loss = 1.1886e-02, PNorm = 60.3129, GNorm = 9.7065, lr_0 = 6.7600e-04
Loss = 8.8261e-03, PNorm = 60.3794, GNorm = 3.2949, lr_0 = 8.5600e-04
Loss = 6.8302e-03, PNorm = 60.4513, GNorm = 3.8158, lr_0 = 9.9344e-04
Validation rmse = 1.276366
Epoch 2
Loss = 6.2124e-03, PNorm = 60.5205, GNorm = 4.4134, lr_0 = 9.6130e-04
Loss = 4.0481e-03, PNorm = 60.5807, GNorm = 3.1543, lr_0 = 9.3019e-04
Validation rmse = 1.063713
Epoch 3
Loss = 4.8889e-03, PNorm = 60.6332, GNorm = 6.9724, lr_0 = 9.0009e-04
Loss = 4.5155e-03, PNorm = 60.6819, GNorm = 3.1085, lr_0 = 8.7096e-04
Loss = 3.7040e-03, PNorm = 60.7304, GNorm = 2.1443, lr_0 = 8.4278e-04
Validation rmse = 1.020639
Epoch 4
Loss = 3.0219e-03, PNorm = 60.7755, GNorm = 1.5791, lr_0 = 8.1551e-04
Loss = 3.0005e-03, PNorm = 60.8095, GNorm = 5.6420, lr_0 = 7.8912e-04
Validation rmse = 0.934454
Epoch 5
Loss = 3.2639e-03, PNorm = 60.8463, GNorm = 1.6871, lr_0 = 7.6358e-04
Loss = 3.7614e-03, PNorm = 60.8846, GNorm = 2.4196, lr_0 = 7.3888e-04
Loss = 4.0929e-03, PNorm = 60.9234, GNorm = 2.1636, lr_0 = 7.1497e-04
Validation rmse = 0.916815
Epoch 6
Loss = 3.1997e-03, PNorm = 60.9598, GNorm = 4.3410, lr_0 = 6.8956e-04
Loss = 3.0548e-03, PNorm = 60.9967, GNorm = 1.1532, lr_0 = 6.6725e-04
Loss = 2.7045e-03, PNorm = 61.0244, GNorm = 5.5197, lr_0 = 6.4565e-04
Validation rmse = 0.955111
Epoch 7
Loss = 2.4889e-03, PNorm = 61.0524, GNorm = 1.6634, lr_0 = 6.2476e-04
Loss = 2.5645e-03, PNorm = 61.0739, GNorm = 2.9287, lr_0 = 6.0454e-04
Validation rmse = 0.932033
Epoch 8
Loss = 2.9246e-03, PNorm = 61.0997, GNorm = 4.6426, lr_0 = 5.8498e-04
Loss = 2.2532e-03, PNorm = 61.1277, GNorm = 1.4112, lr_0 = 5.6605e-04
Loss = 1.9278e-03, PNorm = 61.1476, GNorm = 0.8181, lr_0 = 5.4774e-04
Validation rmse = 0.791675
Epoch 9
Loss = 2.1519e-03, PNorm = 61.1711, GNorm = 3.9539, lr_0 = 5.3001e-04
Loss = 2.2179e-03, PNorm = 61.1936, GNorm = 0.9218, lr_0 = 5.1286e-04
Validation rmse = 0.756255
Epoch 10
Loss = 1.6522e-03, PNorm = 61.2140, GNorm = 0.4892, lr_0 = 4.9627e-04
Loss = 1.8280e-03, PNorm = 61.2331, GNorm = 0.7075, lr_0 = 4.8021e-04
Loss = 1.6220e-03, PNorm = 61.2533, GNorm = 1.8063, lr_0 = 4.6467e-04
Validation rmse = 0.775372
Epoch 11
Loss = 1.8317e-03, PNorm = 61.2689, GNorm = 4.6416, lr_0 = 4.4963e-04
Loss = 2.6014e-03, PNorm = 61.2911, GNorm = 3.2317, lr_0 = 4.3508e-04
Validation rmse = 0.883219
Epoch 12
Loss = 2.0585e-03, PNorm = 61.3157, GNorm = 1.9579, lr_0 = 4.1962e-04
Loss = 1.7342e-03, PNorm = 61.3399, GNorm = 1.5894, lr_0 = 4.0604e-04
Loss = 1.6509e-03, PNorm = 61.3576, GNorm = 1.0985, lr_0 = 3.9290e-04
Validation rmse = 0.818491
Epoch 13
Loss = 1.7714e-03, PNorm = 61.3728, GNorm = 3.4723, lr_0 = 3.8019e-04
Loss = 1.7660e-03, PNorm = 61.3876, GNorm = 0.7143, lr_0 = 3.6789e-04
Loss = 1.5668e-03, PNorm = 61.4022, GNorm = 2.1451, lr_0 = 3.5598e-04
Validation rmse = 0.880266
Epoch 14
Loss = 2.0012e-03, PNorm = 61.4197, GNorm = 2.3523, lr_0 = 3.4446e-04
Loss = 1.6517e-03, PNorm = 61.4365, GNorm = 1.1677, lr_0 = 3.3332e-04
Validation rmse = 0.737555
Epoch 15
Loss = 1.1383e-03, PNorm = 61.4550, GNorm = 2.5143, lr_0 = 3.2253e-04
Loss = 1.3544e-03, PNorm = 61.4681, GNorm = 1.1706, lr_0 = 3.1209e-04
Loss = 1.2804e-03, PNorm = 61.4808, GNorm = 0.8043, lr_0 = 3.0200e-04
Validation rmse = 0.778162
Epoch 16
Loss = 1.3851e-03, PNorm = 61.4969, GNorm = 0.6952, lr_0 = 2.9222e-04
Loss = 1.3268e-03, PNorm = 61.5104, GNorm = 0.6237, lr_0 = 2.8277e-04
Validation rmse = 0.765621
Epoch 17
Loss = 1.5649e-03, PNorm = 61.5202, GNorm = 0.8544, lr_0 = 2.7272e-04
Loss = 1.3534e-03, PNorm = 61.5331, GNorm = 0.6277, lr_0 = 2.6389e-04
Loss = 1.2072e-03, PNorm = 61.5446, GNorm = 0.8006, lr_0 = 2.5535e-04
Validation rmse = 0.731411
Epoch 18
Loss = 9.5439e-04, PNorm = 61.5569, GNorm = 0.3672, lr_0 = 2.4709e-04
Loss = 1.1937e-03, PNorm = 61.5675, GNorm = 1.1280, lr_0 = 2.3910e-04
Loss = 1.1355e-03, PNorm = 61.5791, GNorm = 0.5145, lr_0 = 2.3136e-04
Validation rmse = 0.746645
Epoch 19
Loss = 1.0986e-03, PNorm = 61.5882, GNorm = 1.0195, lr_0 = 2.2387e-04
Loss = 1.3135e-03, PNorm = 61.5974, GNorm = 0.8930, lr_0 = 2.1663e-04
Validation rmse = 0.743822
Epoch 20
Loss = 7.2275e-04, PNorm = 61.6079, GNorm = 0.3860, lr_0 = 2.0962e-04
Loss = 1.0351e-03, PNorm = 61.6163, GNorm = 0.9836, lr_0 = 2.0283e-04
Loss = 1.0186e-03, PNorm = 61.6255, GNorm = 1.6664, lr_0 = 1.9627e-04
Validation rmse = 0.749363
Epoch 21
Loss = 9.9642e-04, PNorm = 61.6354, GNorm = 0.5807, lr_0 = 1.8992e-04
Loss = 1.0095e-03, PNorm = 61.6437, GNorm = 1.9088, lr_0 = 1.8377e-04
Validation rmse = 0.732971
Epoch 22
Loss = 9.4823e-04, PNorm = 61.6524, GNorm = 1.1829, lr_0 = 1.7783e-04
Loss = 9.4480e-04, PNorm = 61.6592, GNorm = 1.0471, lr_0 = 1.7207e-04
Loss = 1.1637e-03, PNorm = 61.6678, GNorm = 0.7889, lr_0 = 1.6651e-04
Validation rmse = 0.738050
Epoch 23
Loss = 1.0793e-03, PNorm = 61.6774, GNorm = 0.9659, lr_0 = 1.6059e-04
Loss = 8.9010e-04, PNorm = 61.6837, GNorm = 1.7218, lr_0 = 1.5539e-04
Validation rmse = 0.742586
Epoch 24
Loss = 7.1705e-04, PNorm = 61.6899, GNorm = 0.6518, lr_0 = 1.5036e-04
Loss = 1.0604e-03, PNorm = 61.6949, GNorm = 2.4957, lr_0 = 1.4550e-04
Loss = 1.1310e-03, PNorm = 61.7029, GNorm = 1.1225, lr_0 = 1.4079e-04
Validation rmse = 0.734195
Epoch 25
Loss = 8.9358e-04, PNorm = 61.7097, GNorm = 0.6481, lr_0 = 1.3623e-04
Loss = 8.5483e-04, PNorm = 61.7166, GNorm = 1.2682, lr_0 = 1.3183e-04
Loss = 8.8958e-04, PNorm = 61.7209, GNorm = 1.4223, lr_0 = 1.2756e-04
Validation rmse = 0.736301
Epoch 26
Loss = 8.1818e-04, PNorm = 61.7260, GNorm = 0.9258, lr_0 = 1.2343e-04
Loss = 9.1651e-04, PNorm = 61.7319, GNorm = 1.0253, lr_0 = 1.1944e-04
Validation rmse = 0.724816
Epoch 27
Loss = 7.9618e-04, PNorm = 61.7382, GNorm = 0.7510, lr_0 = 1.1557e-04
Loss = 7.6477e-04, PNorm = 61.7435, GNorm = 0.6511, lr_0 = 1.1183e-04
Loss = 8.8902e-04, PNorm = 61.7488, GNorm = 0.8010, lr_0 = 1.0821e-04
Validation rmse = 0.727635
Epoch 28
Loss = 6.5211e-04, PNorm = 61.7548, GNorm = 1.1777, lr_0 = 1.0437e-04
Loss = 9.5619e-04, PNorm = 61.7594, GNorm = 0.4149, lr_0 = 1.0099e-04
Validation rmse = 0.760917
Epoch 29
Loss = 1.3084e-03, PNorm = 61.7639, GNorm = 0.5341, lr_0 = 1.0000e-04
Loss = 8.1449e-04, PNorm = 61.7696, GNorm = 1.0223, lr_0 = 1.0000e-04
Loss = 6.7291e-04, PNorm = 61.7740, GNorm = 0.9211, lr_0 = 1.0000e-04
Validation rmse = 0.704859
Model 0 best validation rmse = 0.704859 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.068219
Ensemble test rmse = 1.068219
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.1_ffn_num_layers_2_hidden_size_1100/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1100, out_features=1100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 3,941,301
Moving model to cuda
Epoch 0
Loss = 1.7194e-02, PNorm = 60.2245, GNorm = 3.0670, lr_0 = 2.9800e-04
Loss = 1.3198e-02, PNorm = 60.2568, GNorm = 7.0756, lr_0 = 4.7800e-04
Validation rmse = 1.518463
Epoch 1
Loss = 7.8717e-03, PNorm = 60.3135, GNorm = 4.5703, lr_0 = 6.7600e-04
Loss = 7.4206e-03, PNorm = 60.3800, GNorm = 1.5320, lr_0 = 8.5600e-04
Loss = 6.7563e-03, PNorm = 60.4555, GNorm = 4.3231, lr_0 = 9.9344e-04
Validation rmse = 1.772756
Epoch 2
Loss = 6.7072e-03, PNorm = 60.5358, GNorm = 2.5774, lr_0 = 9.6130e-04
Loss = 5.2811e-03, PNorm = 60.6132, GNorm = 2.3267, lr_0 = 9.3019e-04
Validation rmse = 1.149244
Epoch 3
Loss = 3.7701e-03, PNorm = 60.6720, GNorm = 3.1507, lr_0 = 9.0009e-04
Loss = 4.7514e-03, PNorm = 60.7227, GNorm = 2.7076, lr_0 = 8.7096e-04
Loss = 5.3630e-03, PNorm = 60.7805, GNorm = 6.5008, lr_0 = 8.4278e-04
Validation rmse = 1.338610
Epoch 4
Loss = 4.3680e-03, PNorm = 60.8417, GNorm = 4.6943, lr_0 = 8.1551e-04
Loss = 3.9439e-03, PNorm = 60.8921, GNorm = 4.3260, lr_0 = 7.8912e-04
Validation rmse = 1.043935
Epoch 5
Loss = 3.1849e-03, PNorm = 60.9361, GNorm = 1.3236, lr_0 = 7.6358e-04
Loss = 2.8591e-03, PNorm = 60.9698, GNorm = 0.7286, lr_0 = 7.3888e-04
Loss = 3.4889e-03, PNorm = 61.0025, GNorm = 0.8695, lr_0 = 7.1497e-04
Validation rmse = 0.991971
Epoch 6
Loss = 2.6432e-03, PNorm = 61.0539, GNorm = 2.4619, lr_0 = 6.8956e-04
Loss = 3.2972e-03, PNorm = 61.0851, GNorm = 1.2144, lr_0 = 6.6725e-04
Loss = 2.5204e-03, PNorm = 61.1148, GNorm = 3.3097, lr_0 = 6.4565e-04
Validation rmse = 0.911291
Epoch 7
Loss = 2.2317e-03, PNorm = 61.1485, GNorm = 1.0911, lr_0 = 6.2476e-04
Loss = 2.4244e-03, PNorm = 61.1745, GNorm = 1.5087, lr_0 = 6.0454e-04
Validation rmse = 1.018464
Epoch 8
Loss = 2.1853e-03, PNorm = 61.2025, GNorm = 1.2261, lr_0 = 5.8498e-04
Loss = 2.2724e-03, PNorm = 61.2340, GNorm = 1.9512, lr_0 = 5.6605e-04
Loss = 2.0255e-03, PNorm = 61.2612, GNorm = 2.4414, lr_0 = 5.4774e-04
Validation rmse = 0.949306
Epoch 9
Loss = 1.8332e-03, PNorm = 61.2820, GNorm = 1.2805, lr_0 = 5.3001e-04
Loss = 2.0193e-03, PNorm = 61.3092, GNorm = 0.8517, lr_0 = 5.1286e-04
Validation rmse = 0.887018
Epoch 10
Loss = 1.3511e-03, PNorm = 61.3342, GNorm = 1.8713, lr_0 = 4.9627e-04
Loss = 1.7205e-03, PNorm = 61.3581, GNorm = 0.7315, lr_0 = 4.8021e-04
Loss = 2.3479e-03, PNorm = 61.3841, GNorm = 1.8507, lr_0 = 4.6467e-04
Validation rmse = 0.890188
Epoch 11
Loss = 1.6154e-03, PNorm = 61.4116, GNorm = 1.6627, lr_0 = 4.4963e-04
Loss = 2.1991e-03, PNorm = 61.4356, GNorm = 3.7551, lr_0 = 4.3508e-04
Validation rmse = 1.053931
Epoch 12
Loss = 2.5062e-03, PNorm = 61.4587, GNorm = 2.4232, lr_0 = 4.1962e-04
Loss = 1.7021e-03, PNorm = 61.4800, GNorm = 0.5485, lr_0 = 4.0604e-04
Loss = 1.5365e-03, PNorm = 61.4991, GNorm = 1.8760, lr_0 = 3.9290e-04
Validation rmse = 0.956893
Epoch 13
Loss = 1.7996e-03, PNorm = 61.5205, GNorm = 4.5575, lr_0 = 3.8019e-04
Loss = 1.4407e-03, PNorm = 61.5355, GNorm = 1.2028, lr_0 = 3.6789e-04
Loss = 1.5118e-03, PNorm = 61.5504, GNorm = 1.7618, lr_0 = 3.5598e-04
Validation rmse = 0.834510
Epoch 14
Loss = 1.8144e-03, PNorm = 61.5696, GNorm = 2.7187, lr_0 = 3.4446e-04
Loss = 1.4476e-03, PNorm = 61.5862, GNorm = 0.6065, lr_0 = 3.3332e-04
Validation rmse = 0.877110
Epoch 15
Loss = 1.6191e-03, PNorm = 61.5997, GNorm = 1.9055, lr_0 = 3.2253e-04
Loss = 1.2665e-03, PNorm = 61.6139, GNorm = 0.6582, lr_0 = 3.1209e-04
Loss = 1.1945e-03, PNorm = 61.6289, GNorm = 0.9221, lr_0 = 3.0200e-04
Validation rmse = 0.849170
Epoch 16
Loss = 1.3793e-03, PNorm = 61.6401, GNorm = 0.9459, lr_0 = 2.9222e-04
Loss = 1.1514e-03, PNorm = 61.6526, GNorm = 1.7163, lr_0 = 2.8277e-04
Validation rmse = 0.850749
Epoch 17
Loss = 1.5958e-03, PNorm = 61.6665, GNorm = 1.9913, lr_0 = 2.7272e-04
Loss = 1.2646e-03, PNorm = 61.6803, GNorm = 0.6160, lr_0 = 2.6389e-04
Loss = 1.1696e-03, PNorm = 61.6934, GNorm = 1.5888, lr_0 = 2.5535e-04
Validation rmse = 0.833916
Epoch 18
Loss = 1.1609e-03, PNorm = 61.7003, GNorm = 1.5664, lr_0 = 2.4709e-04
Loss = 1.1657e-03, PNorm = 61.7096, GNorm = 0.9064, lr_0 = 2.3910e-04
Loss = 1.2052e-03, PNorm = 61.7205, GNorm = 0.5852, lr_0 = 2.3136e-04
Validation rmse = 0.897372
Epoch 19
Loss = 1.2821e-03, PNorm = 61.7307, GNorm = 1.7503, lr_0 = 2.2387e-04
Loss = 1.2137e-03, PNorm = 61.7410, GNorm = 1.0464, lr_0 = 2.1663e-04
Validation rmse = 0.870119
Epoch 20
Loss = 9.6016e-04, PNorm = 61.7497, GNorm = 0.7015, lr_0 = 2.0962e-04
Loss = 1.1524e-03, PNorm = 61.7625, GNorm = 1.7558, lr_0 = 2.0283e-04
Loss = 1.1137e-03, PNorm = 61.7715, GNorm = 0.9830, lr_0 = 1.9627e-04
Validation rmse = 0.855981
Epoch 21
Loss = 1.0717e-03, PNorm = 61.7815, GNorm = 0.7191, lr_0 = 1.8992e-04
Loss = 9.8296e-04, PNorm = 61.7901, GNorm = 1.0622, lr_0 = 1.8377e-04
Validation rmse = 0.825135
Epoch 22
Loss = 9.4055e-04, PNorm = 61.7994, GNorm = 0.5172, lr_0 = 1.7783e-04
Loss = 8.0178e-04, PNorm = 61.8083, GNorm = 0.9174, lr_0 = 1.7207e-04
Loss = 1.0499e-03, PNorm = 61.8152, GNorm = 1.3831, lr_0 = 1.6651e-04
Validation rmse = 0.850456
Epoch 23
Loss = 8.3658e-04, PNorm = 61.8238, GNorm = 0.5995, lr_0 = 1.6059e-04
Loss = 8.7986e-04, PNorm = 61.8311, GNorm = 0.7572, lr_0 = 1.5539e-04
Validation rmse = 0.804764
Epoch 24
Loss = 6.8849e-04, PNorm = 61.8376, GNorm = 1.1203, lr_0 = 1.5036e-04
Loss = 1.0022e-03, PNorm = 61.8467, GNorm = 0.6807, lr_0 = 1.4550e-04
Loss = 8.5741e-04, PNorm = 61.8533, GNorm = 0.5927, lr_0 = 1.4079e-04
Validation rmse = 0.792057
Epoch 25
Loss = 8.6022e-04, PNorm = 61.8583, GNorm = 0.8678, lr_0 = 1.3623e-04
Loss = 8.4788e-04, PNorm = 61.8635, GNorm = 0.3554, lr_0 = 1.3183e-04
Loss = 8.2339e-04, PNorm = 61.8693, GNorm = 0.3645, lr_0 = 1.2756e-04
Validation rmse = 0.803445
Epoch 26
Loss = 8.5822e-04, PNorm = 61.8741, GNorm = 1.0531, lr_0 = 1.2343e-04
Loss = 7.0792e-04, PNorm = 61.8786, GNorm = 1.2006, lr_0 = 1.1944e-04
Validation rmse = 0.823970
Epoch 27
Loss = 8.3166e-04, PNorm = 61.8816, GNorm = 0.6013, lr_0 = 1.1557e-04
Loss = 8.9402e-04, PNorm = 61.8878, GNorm = 0.6512, lr_0 = 1.1183e-04
Loss = 8.3018e-04, PNorm = 61.8922, GNorm = 1.8098, lr_0 = 1.0821e-04
Validation rmse = 0.776399
Epoch 28
Loss = 9.7011e-04, PNorm = 61.8992, GNorm = 1.8644, lr_0 = 1.0437e-04
Loss = 7.3161e-04, PNorm = 61.9031, GNorm = 0.4722, lr_0 = 1.0099e-04
Validation rmse = 0.787190
Epoch 29
Loss = 4.6141e-04, PNorm = 61.9072, GNorm = 0.3987, lr_0 = 1.0000e-04
Loss = 8.3774e-04, PNorm = 61.9119, GNorm = 0.6284, lr_0 = 1.0000e-04
Loss = 7.4316e-04, PNorm = 61.9160, GNorm = 0.3604, lr_0 = 1.0000e-04
Validation rmse = 0.793101
Model 0 best validation rmse = 0.776399 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.680936
Ensemble test rmse = 0.680936
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.1_ffn_num_layers_2_hidden_size_1100/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1100, out_features=1100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 3,941,301
Moving model to cuda
Epoch 0
Loss = 1.8440e-02, PNorm = 60.2219, GNorm = 9.7880, lr_0 = 2.9800e-04
Loss = 1.4874e-02, PNorm = 60.2557, GNorm = 12.2816, lr_0 = 4.7800e-04
Validation rmse = 1.952386
Epoch 1
Loss = 9.9978e-03, PNorm = 60.3191, GNorm = 6.6988, lr_0 = 6.7600e-04
Loss = 9.5020e-03, PNorm = 60.3917, GNorm = 2.4792, lr_0 = 8.5600e-04
Loss = 8.4049e-03, PNorm = 60.4728, GNorm = 4.0743, lr_0 = 9.9344e-04
Validation rmse = 1.703458
Epoch 2
Loss = 6.1107e-03, PNorm = 60.5574, GNorm = 1.0088, lr_0 = 9.6130e-04
Loss = 5.7544e-03, PNorm = 60.6162, GNorm = 1.7174, lr_0 = 9.3019e-04
Validation rmse = 1.246659
Epoch 3
Loss = 5.0198e-03, PNorm = 60.6808, GNorm = 3.5552, lr_0 = 9.0009e-04
Loss = 4.1909e-03, PNorm = 60.7404, GNorm = 2.1264, lr_0 = 8.7096e-04
Loss = 3.5951e-03, PNorm = 60.7903, GNorm = 1.9054, lr_0 = 8.4278e-04
Validation rmse = 1.130161
Epoch 4
Loss = 2.9897e-03, PNorm = 60.8418, GNorm = 0.8872, lr_0 = 8.1551e-04
Loss = 4.0812e-03, PNorm = 60.8821, GNorm = 2.6199, lr_0 = 7.8912e-04
Validation rmse = 1.143650
Epoch 5
Loss = 2.7911e-03, PNorm = 60.9235, GNorm = 3.5443, lr_0 = 7.6358e-04
Loss = 3.3634e-03, PNorm = 60.9623, GNorm = 1.0026, lr_0 = 7.3888e-04
Loss = 3.1601e-03, PNorm = 61.0000, GNorm = 0.9699, lr_0 = 7.1497e-04
Validation rmse = 1.109257
Epoch 6
Loss = 2.7135e-03, PNorm = 61.0427, GNorm = 3.8400, lr_0 = 6.8956e-04
Loss = 3.0126e-03, PNorm = 61.0847, GNorm = 4.8939, lr_0 = 6.6725e-04
Loss = 3.9065e-03, PNorm = 61.1274, GNorm = 1.8472, lr_0 = 6.4565e-04
Validation rmse = 1.290657
Epoch 7
Loss = 3.3099e-03, PNorm = 61.1656, GNorm = 1.8282, lr_0 = 6.2476e-04
Loss = 2.6018e-03, PNorm = 61.1996, GNorm = 1.3492, lr_0 = 6.0454e-04
Validation rmse = 1.081924
Epoch 8
Loss = 2.4117e-03, PNorm = 61.2309, GNorm = 4.0291, lr_0 = 5.8498e-04
Loss = 2.0422e-03, PNorm = 61.2606, GNorm = 2.0358, lr_0 = 5.6605e-04
Loss = 2.4441e-03, PNorm = 61.2835, GNorm = 1.8373, lr_0 = 5.4774e-04
Validation rmse = 1.075977
Epoch 9
Loss = 2.6352e-03, PNorm = 61.3123, GNorm = 4.1371, lr_0 = 5.3001e-04
Loss = 1.9677e-03, PNorm = 61.3416, GNorm = 1.6212, lr_0 = 5.1286e-04
Validation rmse = 1.050072
Epoch 10
Loss = 2.4670e-03, PNorm = 61.3712, GNorm = 2.8938, lr_0 = 4.9627e-04
Loss = 2.1325e-03, PNorm = 61.3954, GNorm = 0.7215, lr_0 = 4.8021e-04
Loss = 1.5557e-03, PNorm = 61.4160, GNorm = 0.9189, lr_0 = 4.6467e-04
Validation rmse = 1.030626
Epoch 11
Loss = 1.8618e-03, PNorm = 61.4365, GNorm = 2.8123, lr_0 = 4.4963e-04
Loss = 1.5248e-03, PNorm = 61.4530, GNorm = 0.5894, lr_0 = 4.3508e-04
Validation rmse = 0.995787
Epoch 12
Loss = 1.4650e-03, PNorm = 61.4767, GNorm = 1.0194, lr_0 = 4.1962e-04
Loss = 1.4473e-03, PNorm = 61.4950, GNorm = 1.2561, lr_0 = 4.0604e-04
Loss = 1.5423e-03, PNorm = 61.5082, GNorm = 0.6582, lr_0 = 3.9290e-04
Validation rmse = 0.955825
Epoch 13
Loss = 1.3718e-03, PNorm = 61.5280, GNorm = 1.3150, lr_0 = 3.8019e-04
Loss = 1.4148e-03, PNorm = 61.5440, GNorm = 0.6254, lr_0 = 3.6789e-04
Loss = 1.4806e-03, PNorm = 61.5584, GNorm = 0.9745, lr_0 = 3.5598e-04
Validation rmse = 0.969921
Epoch 14
Loss = 1.3807e-03, PNorm = 61.5746, GNorm = 1.1008, lr_0 = 3.4446e-04
Loss = 1.2783e-03, PNorm = 61.5878, GNorm = 0.6933, lr_0 = 3.3332e-04
Validation rmse = 0.983568
Epoch 15
Loss = 8.5592e-04, PNorm = 61.6037, GNorm = 0.5739, lr_0 = 3.2253e-04
Loss = 1.6600e-03, PNorm = 61.6203, GNorm = 0.4381, lr_0 = 3.1209e-04
Loss = 1.4713e-03, PNorm = 61.6340, GNorm = 2.8606, lr_0 = 3.0200e-04
Validation rmse = 1.052118
Epoch 16
Loss = 1.2615e-03, PNorm = 61.6468, GNorm = 1.9886, lr_0 = 2.9222e-04
Loss = 1.3032e-03, PNorm = 61.6608, GNorm = 0.7836, lr_0 = 2.8277e-04
Validation rmse = 0.975833
Epoch 17
Loss = 1.1476e-03, PNorm = 61.6767, GNorm = 2.3785, lr_0 = 2.7272e-04
Loss = 1.1332e-03, PNorm = 61.6883, GNorm = 1.5096, lr_0 = 2.6389e-04
Loss = 1.0469e-03, PNorm = 61.7002, GNorm = 0.5498, lr_0 = 2.5535e-04
Validation rmse = 0.992747
Epoch 18
Loss = 1.5080e-03, PNorm = 61.7108, GNorm = 1.3052, lr_0 = 2.4709e-04
Loss = 1.0542e-03, PNorm = 61.7228, GNorm = 0.6907, lr_0 = 2.3910e-04
Loss = 1.1047e-03, PNorm = 61.7321, GNorm = 1.1723, lr_0 = 2.3136e-04
Validation rmse = 0.953964
Epoch 19
Loss = 1.0248e-03, PNorm = 61.7408, GNorm = 0.7421, lr_0 = 2.2387e-04
Loss = 1.0227e-03, PNorm = 61.7507, GNorm = 1.2012, lr_0 = 2.1663e-04
Validation rmse = 0.950655
Epoch 20
Loss = 9.2936e-04, PNorm = 61.7583, GNorm = 0.4375, lr_0 = 2.0962e-04
Loss = 1.0193e-03, PNorm = 61.7673, GNorm = 0.4202, lr_0 = 2.0283e-04
Loss = 1.0308e-03, PNorm = 61.7778, GNorm = 0.4660, lr_0 = 1.9627e-04
Validation rmse = 0.948090
Epoch 21
Loss = 9.3165e-04, PNorm = 61.7852, GNorm = 1.0916, lr_0 = 1.8992e-04
Loss = 9.7127e-04, PNorm = 61.7930, GNorm = 1.0492, lr_0 = 1.8377e-04
Validation rmse = 0.951367
Epoch 22
Loss = 7.9888e-04, PNorm = 61.7996, GNorm = 0.6304, lr_0 = 1.7783e-04
Loss = 8.4774e-04, PNorm = 61.8083, GNorm = 0.6608, lr_0 = 1.7207e-04
Loss = 1.0130e-03, PNorm = 61.8160, GNorm = 1.0850, lr_0 = 1.6651e-04
Validation rmse = 0.945249
Epoch 23
Loss = 8.5232e-04, PNorm = 61.8230, GNorm = 1.4753, lr_0 = 1.6059e-04
Loss = 1.1208e-03, PNorm = 61.8288, GNorm = 0.4783, lr_0 = 1.5539e-04
Validation rmse = 0.952527
Epoch 24
Loss = 8.4130e-04, PNorm = 61.8368, GNorm = 0.9780, lr_0 = 1.5036e-04
Loss = 9.7971e-04, PNorm = 61.8438, GNorm = 1.2695, lr_0 = 1.4550e-04
Loss = 9.6672e-04, PNorm = 61.8506, GNorm = 1.2144, lr_0 = 1.4079e-04
Validation rmse = 0.933198
Epoch 25
Loss = 9.4382e-04, PNorm = 61.8562, GNorm = 0.5850, lr_0 = 1.3623e-04
Loss = 7.1032e-04, PNorm = 61.8617, GNorm = 0.5569, lr_0 = 1.3183e-04
Loss = 1.0942e-03, PNorm = 61.8673, GNorm = 1.9756, lr_0 = 1.2756e-04
Validation rmse = 0.933071
Epoch 26
Loss = 8.0973e-04, PNorm = 61.8737, GNorm = 1.1098, lr_0 = 1.2343e-04
Loss = 8.1823e-04, PNorm = 61.8803, GNorm = 0.7937, lr_0 = 1.1944e-04
Validation rmse = 0.935001
Epoch 27
Loss = 7.6204e-04, PNorm = 61.8847, GNorm = 0.5012, lr_0 = 1.1557e-04
Loss = 7.2587e-04, PNorm = 61.8898, GNorm = 0.3996, lr_0 = 1.1183e-04
Loss = 8.5073e-04, PNorm = 61.8950, GNorm = 0.7366, lr_0 = 1.0821e-04
Validation rmse = 0.948438
Epoch 28
Loss = 8.6033e-04, PNorm = 61.8993, GNorm = 0.5645, lr_0 = 1.0437e-04
Loss = 7.3238e-04, PNorm = 61.9039, GNorm = 0.8682, lr_0 = 1.0099e-04
Validation rmse = 0.937154
Epoch 29
Loss = 6.5304e-04, PNorm = 61.9079, GNorm = 0.7091, lr_0 = 1.0000e-04
Loss = 7.4209e-04, PNorm = 61.9125, GNorm = 1.2802, lr_0 = 1.0000e-04
Loss = 9.6203e-04, PNorm = 61.9176, GNorm = 0.8964, lr_0 = 1.0000e-04
Validation rmse = 0.934956
Model 0 best validation rmse = 0.933071 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.725553
Ensemble test rmse = 0.725553
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.1_ffn_num_layers_2_hidden_size_1100/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1100, out_features=1100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 3,941,301
Moving model to cuda
Epoch 0
Loss = 1.4228e-02, PNorm = 60.2263, GNorm = 4.2463, lr_0 = 2.9800e-04
Loss = 1.0433e-02, PNorm = 60.2595, GNorm = 1.9984, lr_0 = 4.7800e-04
Validation rmse = 1.538811
Epoch 1
Loss = 1.1706e-02, PNorm = 60.3148, GNorm = 5.6661, lr_0 = 6.7600e-04
Loss = 9.6024e-03, PNorm = 60.3892, GNorm = 4.7752, lr_0 = 8.5600e-04
Loss = 6.6052e-03, PNorm = 60.4727, GNorm = 1.7459, lr_0 = 9.9344e-04
Validation rmse = 1.558706
Epoch 2
Loss = 7.0111e-03, PNorm = 60.5453, GNorm = 4.6601, lr_0 = 9.6130e-04
Loss = 5.8214e-03, PNorm = 60.6160, GNorm = 7.1035, lr_0 = 9.3019e-04
Validation rmse = 1.264534
Epoch 3
Loss = 4.8415e-03, PNorm = 60.6782, GNorm = 4.3703, lr_0 = 9.0009e-04
Loss = 4.8924e-03, PNorm = 60.7284, GNorm = 4.7623, lr_0 = 8.7096e-04
Loss = 4.8977e-03, PNorm = 60.7816, GNorm = 5.1200, lr_0 = 8.4278e-04
Validation rmse = 0.915972
Epoch 4
Loss = 4.0211e-03, PNorm = 60.8364, GNorm = 2.0228, lr_0 = 8.1551e-04
Loss = 3.9394e-03, PNorm = 60.8801, GNorm = 4.4929, lr_0 = 7.8912e-04
Validation rmse = 0.888583
Epoch 5
Loss = 2.5245e-03, PNorm = 60.9195, GNorm = 1.1667, lr_0 = 7.6358e-04
Loss = 3.0488e-03, PNorm = 60.9637, GNorm = 2.6139, lr_0 = 7.3888e-04
Loss = 3.2301e-03, PNorm = 60.9968, GNorm = 1.0698, lr_0 = 7.1497e-04
Validation rmse = 0.938963
Epoch 6
Loss = 2.7289e-03, PNorm = 61.0321, GNorm = 2.8222, lr_0 = 6.8956e-04
Loss = 2.8380e-03, PNorm = 61.0642, GNorm = 4.7767, lr_0 = 6.6725e-04
Loss = 2.7629e-03, PNorm = 61.0981, GNorm = 4.3454, lr_0 = 6.4565e-04
Validation rmse = 0.837878
Epoch 7
Loss = 2.6678e-03, PNorm = 61.1311, GNorm = 0.8034, lr_0 = 6.2476e-04
Loss = 2.3419e-03, PNorm = 61.1582, GNorm = 2.5063, lr_0 = 6.0454e-04
Validation rmse = 0.984145
Epoch 8
Loss = 1.5687e-03, PNorm = 61.1893, GNorm = 1.5465, lr_0 = 5.8498e-04
Loss = 2.1639e-03, PNorm = 61.2160, GNorm = 4.4469, lr_0 = 5.6605e-04
Loss = 2.2653e-03, PNorm = 61.2461, GNorm = 1.3949, lr_0 = 5.4774e-04
Validation rmse = 0.863119
Epoch 9
Loss = 1.9600e-03, PNorm = 61.2763, GNorm = 2.3639, lr_0 = 5.3001e-04
Loss = 2.3837e-03, PNorm = 61.3055, GNorm = 1.0688, lr_0 = 5.1286e-04
Validation rmse = 0.842010
Epoch 10
Loss = 2.0948e-03, PNorm = 61.3341, GNorm = 0.9555, lr_0 = 4.9627e-04
Loss = 1.8398e-03, PNorm = 61.3633, GNorm = 0.7462, lr_0 = 4.8021e-04
Loss = 1.9530e-03, PNorm = 61.3841, GNorm = 2.2381, lr_0 = 4.6467e-04
Validation rmse = 0.910316
Epoch 11
Loss = 1.9884e-03, PNorm = 61.4086, GNorm = 0.7216, lr_0 = 4.4963e-04
Loss = 1.5391e-03, PNorm = 61.4308, GNorm = 1.3432, lr_0 = 4.3508e-04
Validation rmse = 0.759725
Epoch 12
Loss = 1.9029e-03, PNorm = 61.4497, GNorm = 1.7440, lr_0 = 4.1962e-04
Loss = 1.4381e-03, PNorm = 61.4659, GNorm = 0.7227, lr_0 = 4.0604e-04
Loss = 1.8467e-03, PNorm = 61.4829, GNorm = 0.9152, lr_0 = 3.9290e-04
Validation rmse = 1.016859
Epoch 13
Loss = 1.8642e-03, PNorm = 61.4981, GNorm = 2.1335, lr_0 = 3.8019e-04
Loss = 1.6044e-03, PNorm = 61.5145, GNorm = 0.5518, lr_0 = 3.6789e-04
Loss = 1.8778e-03, PNorm = 61.5305, GNorm = 0.9520, lr_0 = 3.5598e-04
Validation rmse = 0.744324
Epoch 14
Loss = 1.3627e-03, PNorm = 61.5469, GNorm = 0.9309, lr_0 = 3.4446e-04
Loss = 1.3588e-03, PNorm = 61.5634, GNorm = 0.8803, lr_0 = 3.3332e-04
Validation rmse = 0.797266
Epoch 15
Loss = 5.4520e-04, PNorm = 61.5794, GNorm = 0.5196, lr_0 = 3.2253e-04
Loss = 1.5146e-03, PNorm = 61.5918, GNorm = 0.7034, lr_0 = 3.1209e-04
Loss = 1.2949e-03, PNorm = 61.6030, GNorm = 0.6036, lr_0 = 3.0200e-04
Validation rmse = 0.794035
Epoch 16
Loss = 9.8713e-04, PNorm = 61.6171, GNorm = 0.9586, lr_0 = 2.9222e-04
Loss = 1.3048e-03, PNorm = 61.6274, GNorm = 2.7916, lr_0 = 2.8277e-04
Validation rmse = 0.809036
Epoch 17
Loss = 1.0927e-03, PNorm = 61.6394, GNorm = 2.0464, lr_0 = 2.7272e-04
Loss = 1.0035e-03, PNorm = 61.6492, GNorm = 0.5829, lr_0 = 2.6389e-04
Loss = 1.2889e-03, PNorm = 61.6578, GNorm = 1.6322, lr_0 = 2.5535e-04
Validation rmse = 0.767836
Epoch 18
Loss = 9.8013e-04, PNorm = 61.6671, GNorm = 0.7568, lr_0 = 2.4709e-04
Loss = 1.0619e-03, PNorm = 61.6762, GNorm = 0.5852, lr_0 = 2.3910e-04
Loss = 1.3013e-03, PNorm = 61.6864, GNorm = 2.5820, lr_0 = 2.3136e-04
Validation rmse = 0.760829
Epoch 19
Loss = 1.1480e-03, PNorm = 61.6979, GNorm = 1.7253, lr_0 = 2.2387e-04
Loss = 1.0938e-03, PNorm = 61.7091, GNorm = 0.4218, lr_0 = 2.1663e-04
Validation rmse = 0.740428
Epoch 20
Loss = 1.2897e-03, PNorm = 61.7178, GNorm = 0.6695, lr_0 = 2.0962e-04
Loss = 1.0462e-03, PNorm = 61.7240, GNorm = 2.0727, lr_0 = 2.0283e-04
Loss = 1.0006e-03, PNorm = 61.7324, GNorm = 0.8764, lr_0 = 1.9627e-04
Validation rmse = 0.750826
Epoch 21
Loss = 9.9957e-04, PNorm = 61.7417, GNorm = 1.1701, lr_0 = 1.8992e-04
Loss = 9.2353e-04, PNorm = 61.7493, GNorm = 0.7537, lr_0 = 1.8377e-04
Validation rmse = 0.736045
Epoch 22
Loss = 1.0662e-03, PNorm = 61.7554, GNorm = 0.7464, lr_0 = 1.7783e-04
Loss = 9.0843e-04, PNorm = 61.7623, GNorm = 1.7020, lr_0 = 1.7207e-04
Loss = 9.7889e-04, PNorm = 61.7694, GNorm = 0.4882, lr_0 = 1.6651e-04
Validation rmse = 0.806562
Epoch 23
Loss = 7.6474e-04, PNorm = 61.7751, GNorm = 0.6290, lr_0 = 1.6059e-04
Loss = 9.3852e-04, PNorm = 61.7821, GNorm = 0.4830, lr_0 = 1.5539e-04
Validation rmse = 0.800165
Epoch 24
Loss = 5.9933e-04, PNorm = 61.7880, GNorm = 0.8432, lr_0 = 1.5036e-04
Loss = 9.2263e-04, PNorm = 61.7946, GNorm = 0.6770, lr_0 = 1.4550e-04
Loss = 9.2252e-04, PNorm = 61.8004, GNorm = 0.5328, lr_0 = 1.4079e-04
Validation rmse = 0.783965
Epoch 25
Loss = 7.0866e-04, PNorm = 61.8073, GNorm = 0.8936, lr_0 = 1.3623e-04
Loss = 8.8630e-04, PNorm = 61.8143, GNorm = 1.1729, lr_0 = 1.3183e-04
Loss = 9.6357e-04, PNorm = 61.8207, GNorm = 0.5114, lr_0 = 1.2756e-04
Validation rmse = 0.757758
Epoch 26
Loss = 7.8441e-04, PNorm = 61.8247, GNorm = 0.8896, lr_0 = 1.2343e-04
Loss = 8.7227e-04, PNorm = 61.8299, GNorm = 0.8644, lr_0 = 1.1944e-04
Validation rmse = 0.755671
Epoch 27
Loss = 6.7482e-04, PNorm = 61.8352, GNorm = 1.0522, lr_0 = 1.1557e-04
Loss = 8.8131e-04, PNorm = 61.8411, GNorm = 0.5055, lr_0 = 1.1183e-04
Loss = 8.4287e-04, PNorm = 61.8451, GNorm = 0.6798, lr_0 = 1.0821e-04
Validation rmse = 0.753477
Epoch 28
Loss = 8.0270e-04, PNorm = 61.8483, GNorm = 0.9942, lr_0 = 1.0437e-04
Loss = 7.7084e-04, PNorm = 61.8512, GNorm = 0.6158, lr_0 = 1.0099e-04
Validation rmse = 0.759752
Epoch 29
Loss = 5.2405e-04, PNorm = 61.8554, GNorm = 0.7543, lr_0 = 1.0000e-04
Loss = 8.5653e-04, PNorm = 61.8595, GNorm = 2.1878, lr_0 = 1.0000e-04
Loss = 8.5156e-04, PNorm = 61.8637, GNorm = 0.9165, lr_0 = 1.0000e-04
Validation rmse = 0.775795
Model 0 best validation rmse = 0.736045 on epoch 21
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.691041
Ensemble test rmse = 0.691041
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.1_ffn_num_layers_2_hidden_size_1100/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1100, out_features=1100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 3,941,301
Moving model to cuda
Epoch 0
Loss = 1.8945e-02, PNorm = 60.2233, GNorm = 11.7426, lr_0 = 2.9800e-04
Loss = 1.3406e-02, PNorm = 60.2553, GNorm = 2.2402, lr_0 = 4.7800e-04
Validation rmse = 1.631498
Epoch 1
Loss = 1.0394e-02, PNorm = 60.3189, GNorm = 6.5564, lr_0 = 6.7600e-04
Loss = 9.0631e-03, PNorm = 60.3906, GNorm = 2.0319, lr_0 = 8.5600e-04
Loss = 6.9899e-03, PNorm = 60.4602, GNorm = 0.9189, lr_0 = 9.9344e-04
Validation rmse = 1.398554
Epoch 2
Loss = 5.8530e-03, PNorm = 60.5359, GNorm = 1.9807, lr_0 = 9.6130e-04
Loss = 5.0496e-03, PNorm = 60.6017, GNorm = 2.6129, lr_0 = 9.3019e-04
Validation rmse = 1.166885
Epoch 3
Loss = 4.0189e-03, PNorm = 60.6621, GNorm = 1.7151, lr_0 = 9.0009e-04
Loss = 4.0620e-03, PNorm = 60.7140, GNorm = 1.6643, lr_0 = 8.7096e-04
Loss = 4.0913e-03, PNorm = 60.7620, GNorm = 2.0572, lr_0 = 8.4278e-04
Validation rmse = 1.081614
Epoch 4
Loss = 3.7930e-03, PNorm = 60.8015, GNorm = 2.2279, lr_0 = 8.1551e-04
Loss = 3.4522e-03, PNorm = 60.8411, GNorm = 1.8877, lr_0 = 7.8912e-04
Validation rmse = 1.198382
Epoch 5
Loss = 2.7829e-03, PNorm = 60.8727, GNorm = 2.8477, lr_0 = 7.6358e-04
Loss = 2.8921e-03, PNorm = 60.9040, GNorm = 1.0264, lr_0 = 7.3888e-04
Loss = 3.8507e-03, PNorm = 60.9327, GNorm = 2.6591, lr_0 = 7.1497e-04
Validation rmse = 1.011362
Epoch 6
Loss = 2.7190e-03, PNorm = 60.9723, GNorm = 2.4828, lr_0 = 6.8956e-04
Loss = 2.6224e-03, PNorm = 61.0076, GNorm = 1.0426, lr_0 = 6.6725e-04
Loss = 2.6593e-03, PNorm = 61.0304, GNorm = 2.2635, lr_0 = 6.4565e-04
Validation rmse = 0.966441
Epoch 7
Loss = 2.4670e-03, PNorm = 61.0575, GNorm = 2.6426, lr_0 = 6.2476e-04
Loss = 2.2811e-03, PNorm = 61.0840, GNorm = 0.6820, lr_0 = 6.0454e-04
Validation rmse = 1.056587
Epoch 8
Loss = 2.5319e-03, PNorm = 61.1087, GNorm = 3.1323, lr_0 = 5.8498e-04
Loss = 2.3447e-03, PNorm = 61.1354, GNorm = 1.7980, lr_0 = 5.6605e-04
Loss = 2.0782e-03, PNorm = 61.1571, GNorm = 1.0458, lr_0 = 5.4774e-04
Validation rmse = 1.031869
Epoch 9
Loss = 1.9710e-03, PNorm = 61.1770, GNorm = 1.0708, lr_0 = 5.3001e-04
Loss = 2.1418e-03, PNorm = 61.1982, GNorm = 0.8904, lr_0 = 5.1286e-04
Validation rmse = 0.963997
Epoch 10
Loss = 2.0154e-03, PNorm = 61.2179, GNorm = 1.3839, lr_0 = 4.9627e-04
Loss = 2.3067e-03, PNorm = 61.2381, GNorm = 3.1684, lr_0 = 4.8021e-04
Loss = 2.2702e-03, PNorm = 61.2592, GNorm = 1.9612, lr_0 = 4.6467e-04
Validation rmse = 0.977376
Epoch 11
Loss = 1.9142e-03, PNorm = 61.2824, GNorm = 2.1260, lr_0 = 4.4963e-04
Loss = 1.6633e-03, PNorm = 61.3016, GNorm = 2.3273, lr_0 = 4.3508e-04
Validation rmse = 0.911594
Epoch 12
Loss = 1.5173e-03, PNorm = 61.3204, GNorm = 0.9847, lr_0 = 4.1962e-04
Loss = 2.0369e-03, PNorm = 61.3361, GNorm = 4.4959, lr_0 = 4.0604e-04
Loss = 2.0146e-03, PNorm = 61.3564, GNorm = 4.1786, lr_0 = 3.9290e-04
Validation rmse = 0.922075
Epoch 13
Loss = 1.7124e-03, PNorm = 61.3762, GNorm = 0.6943, lr_0 = 3.8019e-04
Loss = 1.8758e-03, PNorm = 61.3929, GNorm = 2.5111, lr_0 = 3.6789e-04
Loss = 1.6672e-03, PNorm = 61.4101, GNorm = 0.6633, lr_0 = 3.5598e-04
Validation rmse = 0.895317
Epoch 14
Loss = 1.2854e-03, PNorm = 61.4257, GNorm = 0.4749, lr_0 = 3.4446e-04
Loss = 1.4720e-03, PNorm = 61.4416, GNorm = 0.5554, lr_0 = 3.3332e-04
Validation rmse = 0.940102
Epoch 15
Loss = 1.5646e-03, PNorm = 61.4536, GNorm = 1.6820, lr_0 = 3.2253e-04
Loss = 1.4748e-03, PNorm = 61.4678, GNorm = 0.6609, lr_0 = 3.1209e-04
Loss = 1.3856e-03, PNorm = 61.4816, GNorm = 0.6575, lr_0 = 3.0200e-04
Validation rmse = 0.935024
Epoch 16
Loss = 1.3497e-03, PNorm = 61.4924, GNorm = 1.1360, lr_0 = 2.9222e-04
Loss = 1.4585e-03, PNorm = 61.5076, GNorm = 0.7503, lr_0 = 2.8277e-04
Validation rmse = 0.976563
Epoch 17
Loss = 9.8338e-04, PNorm = 61.5231, GNorm = 2.5069, lr_0 = 2.7272e-04
Loss = 1.5845e-03, PNorm = 61.5387, GNorm = 1.2574, lr_0 = 2.6389e-04
Loss = 1.1558e-03, PNorm = 61.5519, GNorm = 0.6871, lr_0 = 2.5535e-04
Validation rmse = 0.913416
Epoch 18
Loss = 1.1196e-03, PNorm = 61.5604, GNorm = 1.7124, lr_0 = 2.4709e-04
Loss = 1.2986e-03, PNorm = 61.5689, GNorm = 1.0444, lr_0 = 2.3910e-04
Loss = 1.3894e-03, PNorm = 61.5796, GNorm = 1.0947, lr_0 = 2.3136e-04
Validation rmse = 0.943273
Epoch 19
Loss = 1.1730e-03, PNorm = 61.5903, GNorm = 0.9490, lr_0 = 2.2387e-04
Loss = 1.0304e-03, PNorm = 61.5993, GNorm = 1.6423, lr_0 = 2.1663e-04
Validation rmse = 0.930319
Epoch 20
Loss = 1.1308e-03, PNorm = 61.6071, GNorm = 0.6678, lr_0 = 2.0962e-04
Loss = 1.0021e-03, PNorm = 61.6181, GNorm = 0.4784, lr_0 = 2.0283e-04
Loss = 1.2392e-03, PNorm = 61.6277, GNorm = 1.9737, lr_0 = 1.9627e-04
Validation rmse = 0.953036
Epoch 21
Loss = 9.2541e-04, PNorm = 61.6346, GNorm = 1.0741, lr_0 = 1.8992e-04
Loss = 1.1690e-03, PNorm = 61.6422, GNorm = 0.6618, lr_0 = 1.8377e-04
Validation rmse = 0.941668
Epoch 22
Loss = 9.9234e-04, PNorm = 61.6497, GNorm = 0.8840, lr_0 = 1.7783e-04
Loss = 8.9645e-04, PNorm = 61.6592, GNorm = 1.1739, lr_0 = 1.7207e-04
Loss = 1.1018e-03, PNorm = 61.6676, GNorm = 0.7176, lr_0 = 1.6651e-04
Validation rmse = 0.910978
Epoch 23
Loss = 8.9689e-04, PNorm = 61.6755, GNorm = 0.6464, lr_0 = 1.6059e-04
Loss = 9.4339e-04, PNorm = 61.6816, GNorm = 0.5301, lr_0 = 1.5539e-04
Validation rmse = 0.924606
Epoch 24
Loss = 8.7642e-04, PNorm = 61.6894, GNorm = 0.9907, lr_0 = 1.5036e-04
Loss = 1.1028e-03, PNorm = 61.6963, GNorm = 1.0350, lr_0 = 1.4550e-04
Loss = 8.3701e-04, PNorm = 61.7020, GNorm = 0.9011, lr_0 = 1.4079e-04
Validation rmse = 0.930960
Epoch 25
Loss = 7.7936e-04, PNorm = 61.7080, GNorm = 0.5922, lr_0 = 1.3623e-04
Loss = 9.0899e-04, PNorm = 61.7140, GNorm = 1.1978, lr_0 = 1.3183e-04
Loss = 9.1190e-04, PNorm = 61.7194, GNorm = 0.5234, lr_0 = 1.2756e-04
Validation rmse = 0.927643
Epoch 26
Loss = 8.7709e-04, PNorm = 61.7250, GNorm = 0.5446, lr_0 = 1.2343e-04
Loss = 8.3723e-04, PNorm = 61.7306, GNorm = 0.5908, lr_0 = 1.1944e-04
Validation rmse = 0.944482
Epoch 27
Loss = 1.0522e-03, PNorm = 61.7363, GNorm = 1.2589, lr_0 = 1.1557e-04
Loss = 8.3209e-04, PNorm = 61.7416, GNorm = 1.2324, lr_0 = 1.1183e-04
Loss = 9.1952e-04, PNorm = 61.7469, GNorm = 0.8922, lr_0 = 1.0821e-04
Validation rmse = 0.920594
Epoch 28
Loss = 9.3130e-04, PNorm = 61.7541, GNorm = 1.3486, lr_0 = 1.0437e-04
Loss = 6.8163e-04, PNorm = 61.7582, GNorm = 0.4021, lr_0 = 1.0099e-04
Validation rmse = 0.921401
Epoch 29
Loss = 6.0122e-04, PNorm = 61.7619, GNorm = 0.4709, lr_0 = 1.0000e-04
Loss = 8.1644e-04, PNorm = 61.7656, GNorm = 0.6213, lr_0 = 1.0000e-04
Loss = 8.5244e-04, PNorm = 61.7690, GNorm = 0.9296, lr_0 = 1.0000e-04
Validation rmse = 0.959690
Model 0 best validation rmse = 0.895317 on epoch 13
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.737894
Ensemble test rmse = 0.737894
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.1_ffn_num_layers_2_hidden_size_1100/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1100, out_features=1100, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 3,941,301
Moving model to cuda
Epoch 0
Loss = 1.8156e-02, PNorm = 60.2241, GNorm = 6.1346, lr_0 = 2.9800e-04
Loss = 1.1896e-02, PNorm = 60.2613, GNorm = 2.3455, lr_0 = 4.7800e-04
Validation rmse = 1.369059
Epoch 1
Loss = 7.4808e-03, PNorm = 60.3141, GNorm = 4.7335, lr_0 = 6.7600e-04
Loss = 7.0410e-03, PNorm = 60.3717, GNorm = 4.7480, lr_0 = 8.5600e-04
Loss = 6.6234e-03, PNorm = 60.4453, GNorm = 5.3740, lr_0 = 9.9344e-04
Validation rmse = 1.652987
Epoch 2
Loss = 5.4490e-03, PNorm = 60.5147, GNorm = 4.6949, lr_0 = 9.6130e-04
Loss = 5.2611e-03, PNorm = 60.5835, GNorm = 4.1749, lr_0 = 9.3019e-04
Validation rmse = 1.099228
Epoch 3
Loss = 4.8567e-03, PNorm = 60.6512, GNorm = 3.5717, lr_0 = 9.0009e-04
Loss = 5.0664e-03, PNorm = 60.7034, GNorm = 6.5941, lr_0 = 8.7096e-04
Loss = 3.8220e-03, PNorm = 60.7566, GNorm = 2.2941, lr_0 = 8.4278e-04
Validation rmse = 1.024717
Epoch 4
Loss = 3.5711e-03, PNorm = 60.8059, GNorm = 1.2471, lr_0 = 8.1551e-04
Loss = 3.5793e-03, PNorm = 60.8485, GNorm = 1.7814, lr_0 = 7.8912e-04
Validation rmse = 0.976471
Epoch 5
Loss = 2.7125e-03, PNorm = 60.8846, GNorm = 1.4083, lr_0 = 7.6358e-04
Loss = 3.4356e-03, PNorm = 60.9180, GNorm = 1.8966, lr_0 = 7.3888e-04
Loss = 2.6929e-03, PNorm = 60.9476, GNorm = 1.9785, lr_0 = 7.1497e-04
Validation rmse = 0.990700
Epoch 6
Loss = 2.7150e-03, PNorm = 60.9837, GNorm = 1.8727, lr_0 = 6.8956e-04
Loss = 2.8112e-03, PNorm = 61.0146, GNorm = 2.3205, lr_0 = 6.6725e-04
Loss = 2.4870e-03, PNorm = 61.0443, GNorm = 6.2284, lr_0 = 6.4565e-04
Validation rmse = 0.887858
Epoch 7
Loss = 2.0597e-03, PNorm = 61.0759, GNorm = 0.8775, lr_0 = 6.2476e-04
Loss = 2.3753e-03, PNorm = 61.1019, GNorm = 1.2387, lr_0 = 6.0454e-04
Validation rmse = 0.943254
Epoch 8
Loss = 2.6474e-03, PNorm = 61.1321, GNorm = 2.7081, lr_0 = 5.8498e-04
Loss = 2.4615e-03, PNorm = 61.1635, GNorm = 1.3260, lr_0 = 5.6605e-04
Loss = 1.8782e-03, PNorm = 61.1897, GNorm = 2.1816, lr_0 = 5.4774e-04
Validation rmse = 0.831263
Epoch 9
Loss = 1.5522e-03, PNorm = 61.2118, GNorm = 0.5535, lr_0 = 5.3001e-04
Loss = 1.8940e-03, PNorm = 61.2361, GNorm = 3.0723, lr_0 = 5.1286e-04
Validation rmse = 0.886708
Epoch 10
Loss = 1.8089e-03, PNorm = 61.2614, GNorm = 0.9447, lr_0 = 4.9627e-04
Loss = 1.7824e-03, PNorm = 61.2854, GNorm = 1.1003, lr_0 = 4.8021e-04
Loss = 1.8251e-03, PNorm = 61.3095, GNorm = 1.1637, lr_0 = 4.6467e-04
Validation rmse = 0.791052
Epoch 11
Loss = 1.7523e-03, PNorm = 61.3339, GNorm = 1.1267, lr_0 = 4.4963e-04
Loss = 1.6636e-03, PNorm = 61.3577, GNorm = 1.4725, lr_0 = 4.3508e-04
Validation rmse = 0.781381
Epoch 12
Loss = 9.6637e-04, PNorm = 61.3787, GNorm = 1.1316, lr_0 = 4.1962e-04
Loss = 1.5031e-03, PNorm = 61.3970, GNorm = 0.8647, lr_0 = 4.0604e-04
Loss = 1.3292e-03, PNorm = 61.4110, GNorm = 0.8529, lr_0 = 3.9290e-04
Validation rmse = 0.774860
Epoch 13
Loss = 1.4663e-03, PNorm = 61.4245, GNorm = 1.4229, lr_0 = 3.8019e-04
Loss = 1.2295e-03, PNorm = 61.4463, GNorm = 0.9324, lr_0 = 3.6789e-04
Loss = 1.5058e-03, PNorm = 61.4642, GNorm = 1.7088, lr_0 = 3.5598e-04
Validation rmse = 0.759984
Epoch 14
Loss = 1.5881e-03, PNorm = 61.4833, GNorm = 1.9830, lr_0 = 3.4446e-04
Loss = 1.2998e-03, PNorm = 61.4996, GNorm = 1.0559, lr_0 = 3.3332e-04
Validation rmse = 0.924841
Epoch 15
Loss = 2.0104e-03, PNorm = 61.5141, GNorm = 1.1489, lr_0 = 3.2253e-04
Loss = 1.5732e-03, PNorm = 61.5318, GNorm = 1.6543, lr_0 = 3.1209e-04
Loss = 1.2084e-03, PNorm = 61.5480, GNorm = 0.9570, lr_0 = 3.0200e-04
Validation rmse = 0.811126
Epoch 16
Loss = 1.1639e-03, PNorm = 61.5616, GNorm = 0.3654, lr_0 = 2.9222e-04
Loss = 1.2753e-03, PNorm = 61.5719, GNorm = 0.6183, lr_0 = 2.8277e-04
Validation rmse = 0.726933
Epoch 17
Loss = 1.1506e-03, PNorm = 61.5878, GNorm = 0.7179, lr_0 = 2.7272e-04
Loss = 1.1630e-03, PNorm = 61.5977, GNorm = 0.4977, lr_0 = 2.6389e-04
Loss = 1.1489e-03, PNorm = 61.6077, GNorm = 0.7678, lr_0 = 2.5535e-04
Validation rmse = 0.723785
Epoch 18
Loss = 1.1908e-03, PNorm = 61.6172, GNorm = 1.4992, lr_0 = 2.4709e-04
Loss = 1.4136e-03, PNorm = 61.6296, GNorm = 2.9533, lr_0 = 2.3910e-04
Loss = 9.9795e-04, PNorm = 61.6413, GNorm = 0.6896, lr_0 = 2.3136e-04
Validation rmse = 0.734809
Epoch 19
Loss = 1.1114e-03, PNorm = 61.6517, GNorm = 0.6799, lr_0 = 2.2387e-04
Loss = 1.0528e-03, PNorm = 61.6616, GNorm = 0.7925, lr_0 = 2.1663e-04
Validation rmse = 0.696903
Epoch 20
Loss = 7.4314e-04, PNorm = 61.6698, GNorm = 0.9779, lr_0 = 2.0962e-04
Loss = 1.1760e-03, PNorm = 61.6772, GNorm = 1.7819, lr_0 = 2.0283e-04
Loss = 1.0592e-03, PNorm = 61.6847, GNorm = 1.4150, lr_0 = 1.9627e-04
Validation rmse = 0.713277
Epoch 21
Loss = 9.0406e-04, PNorm = 61.6926, GNorm = 0.7265, lr_0 = 1.8992e-04
Loss = 1.0293e-03, PNorm = 61.7013, GNorm = 1.2432, lr_0 = 1.8377e-04
Validation rmse = 0.730153
Epoch 22
Loss = 7.0866e-04, PNorm = 61.7090, GNorm = 0.4415, lr_0 = 1.7783e-04
Loss = 8.4629e-04, PNorm = 61.7152, GNorm = 0.8392, lr_0 = 1.7207e-04
Loss = 9.0815e-04, PNorm = 61.7223, GNorm = 0.4487, lr_0 = 1.6651e-04
Validation rmse = 0.715112
Epoch 23
Loss = 1.0450e-03, PNorm = 61.7289, GNorm = 1.0318, lr_0 = 1.6059e-04
Loss = 9.4981e-04, PNorm = 61.7373, GNorm = 2.4166, lr_0 = 1.5539e-04
Validation rmse = 0.697803
Epoch 24
Loss = 9.0141e-04, PNorm = 61.7454, GNorm = 0.9573, lr_0 = 1.5036e-04
Loss = 1.0512e-03, PNorm = 61.7513, GNorm = 2.9490, lr_0 = 1.4550e-04
Loss = 1.2210e-03, PNorm = 61.7588, GNorm = 2.5240, lr_0 = 1.4079e-04
Validation rmse = 0.731971
Epoch 25
Loss = 8.4683e-04, PNorm = 61.7655, GNorm = 0.8955, lr_0 = 1.3623e-04
Loss = 9.2163e-04, PNorm = 61.7719, GNorm = 1.7777, lr_0 = 1.3183e-04
Loss = 9.0488e-04, PNorm = 61.7775, GNorm = 1.5207, lr_0 = 1.2756e-04
Validation rmse = 0.689598
Epoch 26
Loss = 8.5464e-04, PNorm = 61.7838, GNorm = 0.8332, lr_0 = 1.2343e-04
Loss = 7.7283e-04, PNorm = 61.7892, GNorm = 0.8090, lr_0 = 1.1944e-04
Validation rmse = 0.721483
Epoch 27
Loss = 9.4658e-04, PNorm = 61.7944, GNorm = 1.9378, lr_0 = 1.1557e-04
Loss = 8.3382e-04, PNorm = 61.7999, GNorm = 0.8322, lr_0 = 1.1183e-04
Loss = 8.0124e-04, PNorm = 61.8040, GNorm = 1.2892, lr_0 = 1.0821e-04
Validation rmse = 0.707872
Epoch 28
Loss = 8.4886e-04, PNorm = 61.8093, GNorm = 1.7299, lr_0 = 1.0437e-04
Loss = 8.3956e-04, PNorm = 61.8140, GNorm = 0.5709, lr_0 = 1.0099e-04
Validation rmse = 0.767446
Epoch 29
Loss = 8.9618e-04, PNorm = 61.8191, GNorm = 2.7667, lr_0 = 1.0000e-04
Loss = 8.6848e-04, PNorm = 61.8238, GNorm = 1.2854, lr_0 = 1.0000e-04
Loss = 6.9185e-04, PNorm = 61.8279, GNorm = 0.4859, lr_0 = 1.0000e-04
Validation rmse = 0.705834
Model 0 best validation rmse = 0.689598 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.714106
Ensemble test rmse = 0.714106
10-fold cross validation
	Seed 0 ==> test rmse = 0.777294
	Seed 1 ==> test rmse = 0.640943
	Seed 2 ==> test rmse = 0.678325
	Seed 3 ==> test rmse = 0.875781
	Seed 4 ==> test rmse = 1.068219
	Seed 5 ==> test rmse = 0.680936
	Seed 6 ==> test rmse = 0.725553
	Seed 7 ==> test rmse = 0.691041
	Seed 8 ==> test rmse = 0.737894
	Seed 9 ==> test rmse = 0.714106
Overall test rmse = 0.759009 +/- 0.120136
Elapsed time = 0:08:26
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.05_ffn_num_layers_2_hidden_size_1400/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1400, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,276,201
Moving model to cuda
Epoch 0
Loss = 1.5820e-02, PNorm = 67.3340, GNorm = 3.9208, lr_0 = 2.9800e-04
Loss = 1.2062e-02, PNorm = 67.3858, GNorm = 1.5559, lr_0 = 4.7800e-04
Validation rmse = 1.298751
Epoch 1
Loss = 7.5644e-03, PNorm = 67.4682, GNorm = 6.1822, lr_0 = 6.7600e-04
Loss = 1.0739e-02, PNorm = 67.5670, GNorm = 4.4360, lr_0 = 8.5600e-04
Loss = 6.7698e-03, PNorm = 67.6990, GNorm = 3.0659, lr_0 = 9.9344e-04
Validation rmse = 1.180931
Epoch 2
Loss = 5.3955e-03, PNorm = 67.8180, GNorm = 2.5105, lr_0 = 9.6130e-04
Loss = 4.4530e-03, PNorm = 67.9273, GNorm = 1.0412, lr_0 = 9.3019e-04
Validation rmse = 1.236295
Epoch 3
Loss = 4.6001e-03, PNorm = 68.0179, GNorm = 3.2060, lr_0 = 9.0009e-04
Loss = 3.6361e-03, PNorm = 68.0957, GNorm = 0.6421, lr_0 = 8.7096e-04
Loss = 3.3614e-03, PNorm = 68.1633, GNorm = 1.1594, lr_0 = 8.4278e-04
Validation rmse = 1.008012
Epoch 4
Loss = 2.7362e-03, PNorm = 68.2252, GNorm = 0.8055, lr_0 = 8.1551e-04
Loss = 3.6211e-03, PNorm = 68.2811, GNorm = 5.2079, lr_0 = 7.8912e-04
Validation rmse = 1.189578
Epoch 5
Loss = 5.0128e-03, PNorm = 68.3338, GNorm = 4.8392, lr_0 = 7.6358e-04
Loss = 3.3396e-03, PNorm = 68.3880, GNorm = 1.9159, lr_0 = 7.3888e-04
Loss = 3.4114e-03, PNorm = 68.4400, GNorm = 2.1709, lr_0 = 7.1497e-04
Validation rmse = 1.029546
Epoch 6
Loss = 3.1615e-03, PNorm = 68.5104, GNorm = 2.8384, lr_0 = 6.8956e-04
Loss = 2.8891e-03, PNorm = 68.5624, GNorm = 0.7877, lr_0 = 6.6725e-04
Loss = 3.1321e-03, PNorm = 68.5955, GNorm = 4.2009, lr_0 = 6.4565e-04
Validation rmse = 0.987526
Epoch 7
Loss = 2.3507e-03, PNorm = 68.6412, GNorm = 1.9481, lr_0 = 6.2476e-04
Loss = 2.7345e-03, PNorm = 68.6866, GNorm = 3.2087, lr_0 = 6.0454e-04
Validation rmse = 0.862778
Epoch 8
Loss = 1.9013e-03, PNorm = 68.7252, GNorm = 0.9732, lr_0 = 5.8498e-04
Loss = 2.2770e-03, PNorm = 68.7608, GNorm = 1.6207, lr_0 = 5.6605e-04
Loss = 1.9020e-03, PNorm = 68.7972, GNorm = 3.7481, lr_0 = 5.4774e-04
Validation rmse = 0.979522
Epoch 9
Loss = 2.0969e-03, PNorm = 68.8316, GNorm = 2.5457, lr_0 = 5.3001e-04
Loss = 1.8686e-03, PNorm = 68.8654, GNorm = 0.6632, lr_0 = 5.1286e-04
Validation rmse = 0.839953
Epoch 10
Loss = 2.2020e-03, PNorm = 68.8949, GNorm = 4.3823, lr_0 = 4.9627e-04
Loss = 2.0993e-03, PNorm = 68.9343, GNorm = 0.5631, lr_0 = 4.8021e-04
Loss = 1.8129e-03, PNorm = 68.9677, GNorm = 2.3651, lr_0 = 4.6467e-04
Validation rmse = 0.837983
Epoch 11
Loss = 1.4835e-03, PNorm = 68.9874, GNorm = 0.8390, lr_0 = 4.4963e-04
Loss = 1.3754e-03, PNorm = 69.0141, GNorm = 1.0786, lr_0 = 4.3508e-04
Validation rmse = 0.874787
Epoch 12
Loss = 1.6344e-03, PNorm = 69.0428, GNorm = 1.4174, lr_0 = 4.1962e-04
Loss = 1.7925e-03, PNorm = 69.0661, GNorm = 1.4257, lr_0 = 4.0604e-04
Loss = 1.4804e-03, PNorm = 69.0883, GNorm = 1.4750, lr_0 = 3.9290e-04
Validation rmse = 0.808378
Epoch 13
Loss = 1.6335e-03, PNorm = 69.1094, GNorm = 3.0351, lr_0 = 3.8019e-04
Loss = 1.6769e-03, PNorm = 69.1296, GNorm = 1.7463, lr_0 = 3.6789e-04
Loss = 1.3488e-03, PNorm = 69.1503, GNorm = 0.5689, lr_0 = 3.5598e-04
Validation rmse = 0.809838
Epoch 14
Loss = 1.3051e-03, PNorm = 69.1709, GNorm = 1.1070, lr_0 = 3.4446e-04
Loss = 1.0642e-03, PNorm = 69.1905, GNorm = 2.2085, lr_0 = 3.3332e-04
Validation rmse = 0.808924
Epoch 15
Loss = 1.2442e-03, PNorm = 69.2099, GNorm = 1.8468, lr_0 = 3.2253e-04
Loss = 1.5398e-03, PNorm = 69.2291, GNorm = 2.4864, lr_0 = 3.1209e-04
Loss = 1.4764e-03, PNorm = 69.2539, GNorm = 2.9237, lr_0 = 3.0200e-04
Validation rmse = 0.806967
Epoch 16
Loss = 1.0757e-03, PNorm = 69.2764, GNorm = 0.4676, lr_0 = 2.9222e-04
Loss = 1.1960e-03, PNorm = 69.2914, GNorm = 1.6744, lr_0 = 2.8277e-04
Validation rmse = 0.812668
Epoch 17
Loss = 1.2310e-03, PNorm = 69.3073, GNorm = 1.1469, lr_0 = 2.7272e-04
Loss = 1.0361e-03, PNorm = 69.3237, GNorm = 0.7658, lr_0 = 2.6389e-04
Loss = 1.1620e-03, PNorm = 69.3425, GNorm = 2.1018, lr_0 = 2.5535e-04
Validation rmse = 0.793807
Epoch 18
Loss = 1.0099e-03, PNorm = 69.3571, GNorm = 0.4673, lr_0 = 2.4709e-04
Loss = 9.9147e-04, PNorm = 69.3713, GNorm = 1.5099, lr_0 = 2.3910e-04
Loss = 9.7144e-04, PNorm = 69.3864, GNorm = 0.2512, lr_0 = 2.3136e-04
Validation rmse = 0.785032
Epoch 19
Loss = 1.0159e-03, PNorm = 69.4021, GNorm = 0.4110, lr_0 = 2.2387e-04
Loss = 1.0415e-03, PNorm = 69.4165, GNorm = 1.6727, lr_0 = 2.1663e-04
Validation rmse = 0.791214
Epoch 20
Loss = 8.4674e-04, PNorm = 69.4310, GNorm = 0.9088, lr_0 = 2.0962e-04
Loss = 1.0136e-03, PNorm = 69.4462, GNorm = 0.8220, lr_0 = 2.0283e-04
Loss = 9.0852e-04, PNorm = 69.4617, GNorm = 0.4621, lr_0 = 1.9627e-04
Validation rmse = 0.784636
Epoch 21
Loss = 8.2425e-04, PNorm = 69.4732, GNorm = 1.3111, lr_0 = 1.8992e-04
Loss = 7.8717e-04, PNorm = 69.4827, GNorm = 0.6253, lr_0 = 1.8377e-04
Validation rmse = 0.775581
Epoch 22
Loss = 7.4212e-04, PNorm = 69.4979, GNorm = 0.3981, lr_0 = 1.7783e-04
Loss = 7.7896e-04, PNorm = 69.5120, GNorm = 1.6366, lr_0 = 1.7207e-04
Loss = 8.6682e-04, PNorm = 69.5214, GNorm = 0.7940, lr_0 = 1.6651e-04
Validation rmse = 0.781551
Epoch 23
Loss = 7.6326e-04, PNorm = 69.5329, GNorm = 0.6236, lr_0 = 1.6059e-04
Loss = 8.9716e-04, PNorm = 69.5451, GNorm = 1.8009, lr_0 = 1.5539e-04
Validation rmse = 0.766306
Epoch 24
Loss = 7.9044e-04, PNorm = 69.5568, GNorm = 1.4220, lr_0 = 1.5036e-04
Loss = 7.4966e-04, PNorm = 69.5675, GNorm = 1.3567, lr_0 = 1.4550e-04
Loss = 7.6667e-04, PNorm = 69.5756, GNorm = 0.4557, lr_0 = 1.4079e-04
Validation rmse = 0.789713
Epoch 25
Loss = 6.5226e-04, PNorm = 69.5853, GNorm = 0.4953, lr_0 = 1.3623e-04
Loss = 7.9929e-04, PNorm = 69.5948, GNorm = 0.5907, lr_0 = 1.3183e-04
Loss = 7.8573e-04, PNorm = 69.6035, GNorm = 0.5925, lr_0 = 1.2756e-04
Validation rmse = 0.783205
Epoch 26
Loss = 6.2289e-04, PNorm = 69.6118, GNorm = 0.7608, lr_0 = 1.2343e-04
Loss = 7.0860e-04, PNorm = 69.6188, GNorm = 0.5124, lr_0 = 1.1944e-04
Validation rmse = 0.771921
Epoch 27
Loss = 7.7254e-04, PNorm = 69.6283, GNorm = 0.6427, lr_0 = 1.1557e-04
Loss = 7.6093e-04, PNorm = 69.6373, GNorm = 1.3560, lr_0 = 1.1183e-04
Loss = 6.6707e-04, PNorm = 69.6449, GNorm = 1.0254, lr_0 = 1.0821e-04
Validation rmse = 0.794746
Epoch 28
Loss = 6.8159e-04, PNorm = 69.6529, GNorm = 0.3414, lr_0 = 1.0437e-04
Loss = 6.1757e-04, PNorm = 69.6609, GNorm = 0.5796, lr_0 = 1.0099e-04
Validation rmse = 0.784175
Epoch 29
Loss = 9.2270e-04, PNorm = 69.6689, GNorm = 0.4747, lr_0 = 1.0000e-04
Loss = 6.4403e-04, PNorm = 69.6766, GNorm = 0.6655, lr_0 = 1.0000e-04
Loss = 7.9738e-04, PNorm = 69.6846, GNorm = 2.5336, lr_0 = 1.0000e-04
Validation rmse = 0.804221
Model 0 best validation rmse = 0.766306 on epoch 23
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.718065
Ensemble test rmse = 0.718065
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.05_ffn_num_layers_2_hidden_size_1400/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1400, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,276,201
Moving model to cuda
Epoch 0
Loss = 1.7831e-02, PNorm = 67.3334, GNorm = 12.6905, lr_0 = 2.9800e-04
Loss = 1.3510e-02, PNorm = 67.3808, GNorm = 4.1493, lr_0 = 4.7800e-04
Validation rmse = 1.766156
Epoch 1
Loss = 9.4927e-03, PNorm = 67.4721, GNorm = 2.5782, lr_0 = 6.7600e-04
Loss = 8.4007e-03, PNorm = 67.5871, GNorm = 4.2497, lr_0 = 8.5600e-04
Loss = 5.4875e-03, PNorm = 67.6937, GNorm = 2.6492, lr_0 = 9.9344e-04
Validation rmse = 1.460304
Epoch 2
Loss = 5.9453e-03, PNorm = 67.8079, GNorm = 1.2360, lr_0 = 9.6130e-04
Loss = 5.6930e-03, PNorm = 67.9195, GNorm = 1.3272, lr_0 = 9.3019e-04
Validation rmse = 1.156335
Epoch 3
Loss = 4.0575e-03, PNorm = 68.0242, GNorm = 1.2611, lr_0 = 9.0009e-04
Loss = 4.5742e-03, PNorm = 68.1179, GNorm = 3.2804, lr_0 = 8.7096e-04
Loss = 4.4230e-03, PNorm = 68.1967, GNorm = 0.7953, lr_0 = 8.4278e-04
Validation rmse = 0.964349
Epoch 4
Loss = 3.9281e-03, PNorm = 68.2674, GNorm = 2.1711, lr_0 = 8.1551e-04
Loss = 2.9776e-03, PNorm = 68.3379, GNorm = 1.2019, lr_0 = 7.8912e-04
Validation rmse = 0.847023
Epoch 5
Loss = 2.5419e-03, PNorm = 68.3935, GNorm = 1.1000, lr_0 = 7.6358e-04
Loss = 3.9701e-03, PNorm = 68.4470, GNorm = 3.1360, lr_0 = 7.3888e-04
Loss = 3.4342e-03, PNorm = 68.5026, GNorm = 1.4210, lr_0 = 7.1497e-04
Validation rmse = 1.003989
Epoch 6
Loss = 3.6877e-03, PNorm = 68.5594, GNorm = 0.4824, lr_0 = 6.8956e-04
Loss = 2.9324e-03, PNorm = 68.6174, GNorm = 1.5598, lr_0 = 6.6725e-04
Loss = 2.3912e-03, PNorm = 68.6632, GNorm = 1.4823, lr_0 = 6.4565e-04
Validation rmse = 0.838234
Epoch 7
Loss = 2.6013e-03, PNorm = 68.7049, GNorm = 2.7824, lr_0 = 6.2476e-04
Loss = 2.6617e-03, PNorm = 68.7414, GNorm = 4.3310, lr_0 = 6.0454e-04
Validation rmse = 0.914504
Epoch 8
Loss = 3.3667e-03, PNorm = 68.7885, GNorm = 3.7424, lr_0 = 5.8498e-04
Loss = 2.3223e-03, PNorm = 68.8318, GNorm = 1.4020, lr_0 = 5.6605e-04
Loss = 2.0136e-03, PNorm = 68.8675, GNorm = 0.4459, lr_0 = 5.4774e-04
Validation rmse = 0.780530
Epoch 9
Loss = 1.8670e-03, PNorm = 68.8993, GNorm = 1.5455, lr_0 = 5.3001e-04
Loss = 2.0536e-03, PNorm = 68.9363, GNorm = 0.7688, lr_0 = 5.1286e-04
Validation rmse = 0.781793
Epoch 10
Loss = 1.6727e-03, PNorm = 68.9650, GNorm = 1.1753, lr_0 = 4.9627e-04
Loss = 2.4854e-03, PNorm = 68.9980, GNorm = 1.0645, lr_0 = 4.8021e-04
Loss = 1.7725e-03, PNorm = 69.0299, GNorm = 2.2543, lr_0 = 4.6467e-04
Validation rmse = 0.763919
Epoch 11
Loss = 2.0209e-03, PNorm = 69.0678, GNorm = 2.8436, lr_0 = 4.4963e-04
Loss = 1.7993e-03, PNorm = 69.0973, GNorm = 0.6700, lr_0 = 4.3508e-04
Validation rmse = 0.727947
Epoch 12
Loss = 1.9637e-03, PNorm = 69.1274, GNorm = 1.9218, lr_0 = 4.1962e-04
Loss = 1.7198e-03, PNorm = 69.1559, GNorm = 0.7695, lr_0 = 4.0604e-04
Loss = 1.9467e-03, PNorm = 69.1863, GNorm = 2.0283, lr_0 = 3.9290e-04
Validation rmse = 0.851054
Epoch 13
Loss = 1.5342e-03, PNorm = 69.2105, GNorm = 1.5969, lr_0 = 3.8019e-04
Loss = 1.8459e-03, PNorm = 69.2332, GNorm = 0.5526, lr_0 = 3.6789e-04
Loss = 2.2847e-03, PNorm = 69.2530, GNorm = 2.3173, lr_0 = 3.5598e-04
Validation rmse = 0.731452
Epoch 14
Loss = 1.7052e-03, PNorm = 69.2807, GNorm = 1.6769, lr_0 = 3.4446e-04
Loss = 1.6063e-03, PNorm = 69.3027, GNorm = 2.1262, lr_0 = 3.3332e-04
Validation rmse = 0.748069
Epoch 15
Loss = 1.1639e-03, PNorm = 69.3275, GNorm = 1.0562, lr_0 = 3.2253e-04
Loss = 1.6046e-03, PNorm = 69.3482, GNorm = 2.8985, lr_0 = 3.1209e-04
Loss = 1.7363e-03, PNorm = 69.3726, GNorm = 0.6280, lr_0 = 3.0200e-04
Validation rmse = 0.715863
Epoch 16
Loss = 1.7254e-03, PNorm = 69.3961, GNorm = 1.0893, lr_0 = 2.9222e-04
Loss = 9.4365e-04, PNorm = 69.4135, GNorm = 0.7851, lr_0 = 2.8277e-04
Validation rmse = 0.666413
Epoch 17
Loss = 1.0648e-03, PNorm = 69.4308, GNorm = 0.8274, lr_0 = 2.7272e-04
Loss = 1.2440e-03, PNorm = 69.4474, GNorm = 0.7785, lr_0 = 2.6389e-04
Loss = 1.1010e-03, PNorm = 69.4658, GNorm = 0.9406, lr_0 = 2.5535e-04
Validation rmse = 0.651553
Epoch 18
Loss = 1.1296e-03, PNorm = 69.4829, GNorm = 0.4893, lr_0 = 2.4709e-04
Loss = 1.2702e-03, PNorm = 69.5023, GNorm = 0.5421, lr_0 = 2.3910e-04
Loss = 1.1131e-03, PNorm = 69.5195, GNorm = 0.7477, lr_0 = 2.3136e-04
Validation rmse = 0.661515
Epoch 19
Loss = 1.0947e-03, PNorm = 69.5317, GNorm = 1.0869, lr_0 = 2.2387e-04
Loss = 1.0487e-03, PNorm = 69.5468, GNorm = 0.4993, lr_0 = 2.1663e-04
Validation rmse = 0.649040
Epoch 20
Loss = 7.9629e-04, PNorm = 69.5632, GNorm = 0.7690, lr_0 = 2.0962e-04
Loss = 1.1565e-03, PNorm = 69.5795, GNorm = 0.8808, lr_0 = 2.0283e-04
Loss = 1.0619e-03, PNorm = 69.5931, GNorm = 0.5174, lr_0 = 1.9627e-04
Validation rmse = 0.663635
Epoch 21
Loss = 9.0667e-04, PNorm = 69.6048, GNorm = 1.0230, lr_0 = 1.8992e-04
Loss = 1.0687e-03, PNorm = 69.6195, GNorm = 2.2441, lr_0 = 1.8377e-04
Validation rmse = 0.648374
Epoch 22
Loss = 8.8766e-04, PNorm = 69.6333, GNorm = 1.4199, lr_0 = 1.7783e-04
Loss = 9.8524e-04, PNorm = 69.6433, GNorm = 0.4543, lr_0 = 1.7207e-04
Loss = 9.6976e-04, PNorm = 69.6566, GNorm = 1.0150, lr_0 = 1.6651e-04
Validation rmse = 0.659959
Epoch 23
Loss = 8.3990e-04, PNorm = 69.6723, GNorm = 1.2345, lr_0 = 1.6059e-04
Loss = 9.8652e-04, PNorm = 69.6864, GNorm = 0.9875, lr_0 = 1.5539e-04
Validation rmse = 0.732248
Epoch 24
Loss = 9.0918e-04, PNorm = 69.6974, GNorm = 1.6489, lr_0 = 1.5036e-04
Loss = 1.0968e-03, PNorm = 69.7086, GNorm = 1.7768, lr_0 = 1.4550e-04
Loss = 1.0463e-03, PNorm = 69.7216, GNorm = 1.4356, lr_0 = 1.4079e-04
Validation rmse = 0.688014
Epoch 25
Loss = 6.8137e-04, PNorm = 69.7331, GNorm = 0.4474, lr_0 = 1.3623e-04
Loss = 9.1994e-04, PNorm = 69.7440, GNorm = 0.6829, lr_0 = 1.3183e-04
Loss = 9.8987e-04, PNorm = 69.7552, GNorm = 0.4018, lr_0 = 1.2756e-04
Validation rmse = 0.666626
Epoch 26
Loss = 9.3671e-04, PNorm = 69.7643, GNorm = 0.4318, lr_0 = 1.2343e-04
Loss = 8.7206e-04, PNorm = 69.7737, GNorm = 1.0524, lr_0 = 1.1944e-04
Validation rmse = 0.642326
Epoch 27
Loss = 9.3678e-04, PNorm = 69.7808, GNorm = 0.5006, lr_0 = 1.1557e-04
Loss = 7.8066e-04, PNorm = 69.7904, GNorm = 1.1858, lr_0 = 1.1183e-04
Loss = 8.5648e-04, PNorm = 69.8000, GNorm = 0.5588, lr_0 = 1.0821e-04
Validation rmse = 0.647037
Epoch 28
Loss = 8.8402e-04, PNorm = 69.8090, GNorm = 0.5963, lr_0 = 1.0437e-04
Loss = 6.5384e-04, PNorm = 69.8155, GNorm = 0.3911, lr_0 = 1.0099e-04
Validation rmse = 0.635249
Epoch 29
Loss = 7.8011e-04, PNorm = 69.8234, GNorm = 0.9959, lr_0 = 1.0000e-04
Loss = 8.0838e-04, PNorm = 69.8325, GNorm = 1.0854, lr_0 = 1.0000e-04
Loss = 7.6159e-04, PNorm = 69.8411, GNorm = 1.3187, lr_0 = 1.0000e-04
Validation rmse = 0.654077
Model 0 best validation rmse = 0.635249 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.644551
Ensemble test rmse = 0.644551
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.05_ffn_num_layers_2_hidden_size_1400/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1400, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,276,201
Moving model to cuda
Epoch 0
Loss = 1.7445e-02, PNorm = 67.3351, GNorm = 7.8322, lr_0 = 2.9800e-04
Loss = 1.1787e-02, PNorm = 67.3860, GNorm = 5.7779, lr_0 = 4.7800e-04
Validation rmse = 1.248946
Epoch 1
Loss = 7.6228e-03, PNorm = 67.4755, GNorm = 6.7315, lr_0 = 6.7600e-04
Loss = 8.6586e-03, PNorm = 67.5653, GNorm = 2.4168, lr_0 = 8.5600e-04
Loss = 1.0439e-02, PNorm = 67.7014, GNorm = 1.2862, lr_0 = 9.9344e-04
Validation rmse = 1.507675
Epoch 2
Loss = 7.4470e-03, PNorm = 67.8507, GNorm = 2.0808, lr_0 = 9.6130e-04
Loss = 6.1366e-03, PNorm = 67.9838, GNorm = 1.5939, lr_0 = 9.3019e-04
Validation rmse = 0.970302
Epoch 3
Loss = 4.2004e-03, PNorm = 68.0852, GNorm = 0.6946, lr_0 = 9.0009e-04
Loss = 3.7094e-03, PNorm = 68.1755, GNorm = 2.2978, lr_0 = 8.7096e-04
Loss = 3.8372e-03, PNorm = 68.2472, GNorm = 0.8802, lr_0 = 8.4278e-04
Validation rmse = 0.887000
Epoch 4
Loss = 4.8375e-03, PNorm = 68.3198, GNorm = 2.6194, lr_0 = 8.1551e-04
Loss = 5.0613e-03, PNorm = 68.3951, GNorm = 2.7155, lr_0 = 7.8912e-04
Validation rmse = 0.806655
Epoch 5
Loss = 2.5926e-03, PNorm = 68.4615, GNorm = 0.5162, lr_0 = 7.6358e-04
Loss = 3.1815e-03, PNorm = 68.5216, GNorm = 2.5678, lr_0 = 7.3888e-04
Loss = 3.0256e-03, PNorm = 68.5739, GNorm = 2.4599, lr_0 = 7.1497e-04
Validation rmse = 0.815978
Epoch 6
Loss = 2.8111e-03, PNorm = 68.6193, GNorm = 1.4823, lr_0 = 6.8956e-04
Loss = 2.1410e-03, PNorm = 68.6553, GNorm = 1.5908, lr_0 = 6.6725e-04
Loss = 2.8482e-03, PNorm = 68.6931, GNorm = 1.2396, lr_0 = 6.4565e-04
Validation rmse = 0.844923
Epoch 7
Loss = 2.6863e-03, PNorm = 68.7323, GNorm = 3.8194, lr_0 = 6.2476e-04
Loss = 2.5253e-03, PNorm = 68.7797, GNorm = 2.6565, lr_0 = 6.0454e-04
Validation rmse = 0.758042
Epoch 8
Loss = 2.5379e-03, PNorm = 68.8220, GNorm = 0.6697, lr_0 = 5.8498e-04
Loss = 1.8739e-03, PNorm = 68.8571, GNorm = 0.5226, lr_0 = 5.6605e-04
Loss = 1.8848e-03, PNorm = 68.8904, GNorm = 1.2860, lr_0 = 5.4774e-04
Validation rmse = 0.725002
Epoch 9
Loss = 2.3557e-03, PNorm = 68.9254, GNorm = 1.3262, lr_0 = 5.3001e-04
Loss = 2.5954e-03, PNorm = 68.9615, GNorm = 2.7784, lr_0 = 5.1286e-04
Validation rmse = 0.730237
Epoch 10
Loss = 2.0940e-03, PNorm = 68.9955, GNorm = 2.5968, lr_0 = 4.9627e-04
Loss = 1.8698e-03, PNorm = 69.0240, GNorm = 1.0041, lr_0 = 4.8021e-04
Loss = 2.0409e-03, PNorm = 69.0608, GNorm = 2.6107, lr_0 = 4.6467e-04
Validation rmse = 0.731171
Epoch 11
Loss = 1.8150e-03, PNorm = 69.0822, GNorm = 2.0301, lr_0 = 4.4963e-04
Loss = 1.7041e-03, PNorm = 69.1101, GNorm = 1.1769, lr_0 = 4.3508e-04
Validation rmse = 0.714997
Epoch 12
Loss = 1.0817e-03, PNorm = 69.1377, GNorm = 0.6417, lr_0 = 4.1962e-04
Loss = 1.7785e-03, PNorm = 69.1616, GNorm = 2.6245, lr_0 = 4.0604e-04
Loss = 1.3042e-03, PNorm = 69.1876, GNorm = 0.8581, lr_0 = 3.9290e-04
Validation rmse = 0.692878
Epoch 13
Loss = 1.5159e-03, PNorm = 69.2110, GNorm = 0.4998, lr_0 = 3.8019e-04
Loss = 1.4996e-03, PNorm = 69.2344, GNorm = 3.2381, lr_0 = 3.6789e-04
Loss = 2.0542e-03, PNorm = 69.2581, GNorm = 2.5631, lr_0 = 3.5598e-04
Validation rmse = 0.751991
Epoch 14
Loss = 1.5009e-03, PNorm = 69.2768, GNorm = 0.8749, lr_0 = 3.4446e-04
Loss = 1.5263e-03, PNorm = 69.3038, GNorm = 0.6976, lr_0 = 3.3332e-04
Validation rmse = 0.784745
Epoch 15
Loss = 1.5825e-03, PNorm = 69.3241, GNorm = 0.4993, lr_0 = 3.2253e-04
Loss = 1.3816e-03, PNorm = 69.3399, GNorm = 0.5631, lr_0 = 3.1209e-04
Loss = 1.7077e-03, PNorm = 69.3626, GNorm = 2.3086, lr_0 = 3.0200e-04
Validation rmse = 0.714740
Epoch 16
Loss = 1.2235e-03, PNorm = 69.3805, GNorm = 0.4739, lr_0 = 2.9222e-04
Loss = 1.2914e-03, PNorm = 69.3989, GNorm = 1.5204, lr_0 = 2.8277e-04
Validation rmse = 0.677017
Epoch 17
Loss = 1.0445e-03, PNorm = 69.4189, GNorm = 2.3307, lr_0 = 2.7272e-04
Loss = 1.0129e-03, PNorm = 69.4374, GNorm = 0.7034, lr_0 = 2.6389e-04
Loss = 1.3755e-03, PNorm = 69.4559, GNorm = 2.2721, lr_0 = 2.5535e-04
Validation rmse = 0.713572
Epoch 18
Loss = 1.1607e-03, PNorm = 69.4739, GNorm = 0.3799, lr_0 = 2.4709e-04
Loss = 1.2685e-03, PNorm = 69.4928, GNorm = 0.5246, lr_0 = 2.3910e-04
Loss = 1.0567e-03, PNorm = 69.5044, GNorm = 0.2901, lr_0 = 2.3136e-04
Validation rmse = 0.693382
Epoch 19
Loss = 1.2610e-03, PNorm = 69.5197, GNorm = 1.2698, lr_0 = 2.2387e-04
Loss = 9.9102e-04, PNorm = 69.5329, GNorm = 0.6169, lr_0 = 2.1663e-04
Validation rmse = 0.727524
Epoch 20
Loss = 1.1478e-03, PNorm = 69.5454, GNorm = 2.3810, lr_0 = 2.0962e-04
Loss = 9.0354e-04, PNorm = 69.5600, GNorm = 0.5419, lr_0 = 2.0283e-04
Loss = 8.9566e-04, PNorm = 69.5710, GNorm = 0.3961, lr_0 = 1.9627e-04
Validation rmse = 0.680577
Epoch 21
Loss = 9.6608e-04, PNorm = 69.5812, GNorm = 0.4402, lr_0 = 1.8992e-04
Loss = 1.0515e-03, PNorm = 69.5943, GNorm = 1.2632, lr_0 = 1.8377e-04
Validation rmse = 0.681057
Epoch 22
Loss = 7.8236e-04, PNorm = 69.6048, GNorm = 0.5106, lr_0 = 1.7783e-04
Loss = 1.0642e-03, PNorm = 69.6183, GNorm = 0.8246, lr_0 = 1.7207e-04
Loss = 9.0742e-04, PNorm = 69.6307, GNorm = 0.4457, lr_0 = 1.6651e-04
Validation rmse = 0.668215
Epoch 23
Loss = 8.8249e-04, PNorm = 69.6442, GNorm = 0.5039, lr_0 = 1.6059e-04
Loss = 9.8211e-04, PNorm = 69.6542, GNorm = 1.0948, lr_0 = 1.5539e-04
Validation rmse = 0.694391
Epoch 24
Loss = 1.0790e-03, PNorm = 69.6630, GNorm = 1.3154, lr_0 = 1.5036e-04
Loss = 7.6741e-04, PNorm = 69.6727, GNorm = 0.4735, lr_0 = 1.4550e-04
Loss = 7.8890e-04, PNorm = 69.6827, GNorm = 1.4371, lr_0 = 1.4079e-04
Validation rmse = 0.671440
Epoch 25
Loss = 9.7816e-04, PNorm = 69.6928, GNorm = 2.6787, lr_0 = 1.3623e-04
Loss = 9.1693e-04, PNorm = 69.7049, GNorm = 1.0622, lr_0 = 1.3183e-04
Loss = 8.5188e-04, PNorm = 69.7130, GNorm = 0.5580, lr_0 = 1.2756e-04
Validation rmse = 0.687724
Epoch 26
Loss = 8.2721e-04, PNorm = 69.7221, GNorm = 2.0607, lr_0 = 1.2343e-04
Loss = 8.4704e-04, PNorm = 69.7303, GNorm = 0.5522, lr_0 = 1.1944e-04
Validation rmse = 0.686016
Epoch 27
Loss = 9.1436e-04, PNorm = 69.7382, GNorm = 0.5548, lr_0 = 1.1557e-04
Loss = 8.8640e-04, PNorm = 69.7467, GNorm = 0.7651, lr_0 = 1.1183e-04
Loss = 7.5478e-04, PNorm = 69.7544, GNorm = 1.2608, lr_0 = 1.0821e-04
Validation rmse = 0.685197
Epoch 28
Loss = 7.9614e-04, PNorm = 69.7631, GNorm = 0.4960, lr_0 = 1.0437e-04
Loss = 7.9194e-04, PNorm = 69.7701, GNorm = 0.6343, lr_0 = 1.0099e-04
Validation rmse = 0.685269
Epoch 29
Loss = 9.5185e-04, PNorm = 69.7768, GNorm = 0.8048, lr_0 = 1.0000e-04
Loss = 8.0888e-04, PNorm = 69.7843, GNorm = 1.8705, lr_0 = 1.0000e-04
Loss = 6.7878e-04, PNorm = 69.7905, GNorm = 0.5959, lr_0 = 1.0000e-04
Validation rmse = 0.678703
Model 0 best validation rmse = 0.668215 on epoch 22
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.678781
Ensemble test rmse = 0.678781
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.05_ffn_num_layers_2_hidden_size_1400/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1400, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,276,201
Moving model to cuda
Epoch 0
Loss = 1.4493e-02, PNorm = 67.3384, GNorm = 2.4967, lr_0 = 2.9800e-04
Loss = 1.1442e-02, PNorm = 67.3807, GNorm = 3.6543, lr_0 = 4.7800e-04
Validation rmse = 1.625772
Epoch 1
Loss = 7.9831e-03, PNorm = 67.4576, GNorm = 1.7049, lr_0 = 6.7600e-04
Loss = 8.4156e-03, PNorm = 67.5537, GNorm = 2.9608, lr_0 = 8.5600e-04
Loss = 6.8470e-03, PNorm = 67.6715, GNorm = 0.8203, lr_0 = 9.9344e-04
Validation rmse = 1.209692
Epoch 2
Loss = 6.9588e-03, PNorm = 67.7939, GNorm = 2.7936, lr_0 = 9.6130e-04
Loss = 4.9653e-03, PNorm = 67.9070, GNorm = 0.7869, lr_0 = 9.3019e-04
Validation rmse = 1.081914
Epoch 3
Loss = 3.9253e-03, PNorm = 68.0029, GNorm = 2.9562, lr_0 = 9.0009e-04
Loss = 4.3362e-03, PNorm = 68.0958, GNorm = 0.9272, lr_0 = 8.7096e-04
Loss = 4.8926e-03, PNorm = 68.1765, GNorm = 5.9995, lr_0 = 8.4278e-04
Validation rmse = 1.019952
Epoch 4
Loss = 4.3216e-03, PNorm = 68.2426, GNorm = 5.3407, lr_0 = 8.1551e-04
Loss = 3.7449e-03, PNorm = 68.3159, GNorm = 0.9437, lr_0 = 7.8912e-04
Validation rmse = 0.982151
Epoch 5
Loss = 3.7561e-03, PNorm = 68.3765, GNorm = 2.3617, lr_0 = 7.6358e-04
Loss = 2.6389e-03, PNorm = 68.4277, GNorm = 1.3584, lr_0 = 7.3888e-04
Loss = 3.3393e-03, PNorm = 68.4717, GNorm = 0.8463, lr_0 = 7.1497e-04
Validation rmse = 0.950705
Epoch 6
Loss = 3.1554e-03, PNorm = 68.5313, GNorm = 1.9118, lr_0 = 6.8956e-04
Loss = 3.0581e-03, PNorm = 68.5757, GNorm = 1.1848, lr_0 = 6.6725e-04
Loss = 2.9989e-03, PNorm = 68.6200, GNorm = 4.4153, lr_0 = 6.4565e-04
Validation rmse = 0.882281
Epoch 7
Loss = 2.4311e-03, PNorm = 68.6660, GNorm = 2.9203, lr_0 = 6.2476e-04
Loss = 2.7324e-03, PNorm = 68.7054, GNorm = 3.3989, lr_0 = 6.0454e-04
Validation rmse = 0.760103
Epoch 8
Loss = 2.0078e-03, PNorm = 68.7451, GNorm = 1.8578, lr_0 = 5.8498e-04
Loss = 2.1862e-03, PNorm = 68.7777, GNorm = 2.8184, lr_0 = 5.6605e-04
Loss = 2.3421e-03, PNorm = 68.8150, GNorm = 0.7139, lr_0 = 5.4774e-04
Validation rmse = 0.723743
Epoch 9
Loss = 2.1176e-03, PNorm = 68.8526, GNorm = 0.5071, lr_0 = 5.3001e-04
Loss = 2.4117e-03, PNorm = 68.8905, GNorm = 1.4148, lr_0 = 5.1286e-04
Validation rmse = 0.786853
Epoch 10
Loss = 1.2324e-03, PNorm = 68.9245, GNorm = 0.5574, lr_0 = 4.9627e-04
Loss = 1.7553e-03, PNorm = 68.9539, GNorm = 2.2795, lr_0 = 4.8021e-04
Loss = 2.0109e-03, PNorm = 68.9837, GNorm = 2.8932, lr_0 = 4.6467e-04
Validation rmse = 0.693057
Epoch 11
Loss = 1.3252e-03, PNorm = 69.0075, GNorm = 1.2709, lr_0 = 4.4963e-04
Loss = 1.8807e-03, PNorm = 69.0376, GNorm = 1.5132, lr_0 = 4.3508e-04
Validation rmse = 0.734442
Epoch 12
Loss = 2.2063e-03, PNorm = 69.0674, GNorm = 2.0015, lr_0 = 4.1962e-04
Loss = 1.6387e-03, PNorm = 69.0923, GNorm = 0.9709, lr_0 = 4.0604e-04
Loss = 1.5122e-03, PNorm = 69.1173, GNorm = 1.6730, lr_0 = 3.9290e-04
Validation rmse = 0.702830
Epoch 13
Loss = 1.7337e-03, PNorm = 69.1415, GNorm = 1.8995, lr_0 = 3.8019e-04
Loss = 1.7199e-03, PNorm = 69.1641, GNorm = 2.3643, lr_0 = 3.6789e-04
Loss = 1.4587e-03, PNorm = 69.1944, GNorm = 1.2236, lr_0 = 3.5598e-04
Validation rmse = 0.669925
Epoch 14
Loss = 1.3608e-03, PNorm = 69.2181, GNorm = 0.8325, lr_0 = 3.4446e-04
Loss = 1.3020e-03, PNorm = 69.2397, GNorm = 1.1348, lr_0 = 3.3332e-04
Validation rmse = 0.676341
Epoch 15
Loss = 1.1351e-03, PNorm = 69.2591, GNorm = 0.8239, lr_0 = 3.2253e-04
Loss = 1.2831e-03, PNorm = 69.2792, GNorm = 0.8193, lr_0 = 3.1209e-04
Loss = 1.3338e-03, PNorm = 69.2976, GNorm = 0.7851, lr_0 = 3.0200e-04
Validation rmse = 0.654169
Epoch 16
Loss = 1.3686e-03, PNorm = 69.3176, GNorm = 0.6051, lr_0 = 2.9222e-04
Loss = 1.3057e-03, PNorm = 69.3394, GNorm = 0.7425, lr_0 = 2.8277e-04
Validation rmse = 0.665624
Epoch 17
Loss = 1.1228e-03, PNorm = 69.3608, GNorm = 0.3130, lr_0 = 2.7272e-04
Loss = 1.1380e-03, PNorm = 69.3764, GNorm = 2.8174, lr_0 = 2.6389e-04
Loss = 1.2534e-03, PNorm = 69.3954, GNorm = 0.4499, lr_0 = 2.5535e-04
Validation rmse = 0.642506
Epoch 18
Loss = 9.5736e-04, PNorm = 69.4122, GNorm = 2.0448, lr_0 = 2.4709e-04
Loss = 1.2221e-03, PNorm = 69.4279, GNorm = 0.9107, lr_0 = 2.3910e-04
Loss = 9.1345e-04, PNorm = 69.4473, GNorm = 0.5750, lr_0 = 2.3136e-04
Validation rmse = 0.635607
Epoch 19
Loss = 1.1324e-03, PNorm = 69.4618, GNorm = 0.8640, lr_0 = 2.2387e-04
Loss = 9.2998e-04, PNorm = 69.4776, GNorm = 0.6461, lr_0 = 2.1663e-04
Validation rmse = 0.633512
Epoch 20
Loss = 1.0301e-03, PNorm = 69.4934, GNorm = 0.9111, lr_0 = 2.0962e-04
Loss = 1.2083e-03, PNorm = 69.5084, GNorm = 0.4107, lr_0 = 2.0283e-04
Loss = 1.3559e-03, PNorm = 69.5219, GNorm = 0.7930, lr_0 = 1.9627e-04
Validation rmse = 0.647648
Epoch 21
Loss = 1.0416e-03, PNorm = 69.5388, GNorm = 1.0856, lr_0 = 1.8992e-04
Loss = 1.2911e-03, PNorm = 69.5549, GNorm = 1.5147, lr_0 = 1.8377e-04
Validation rmse = 0.641804
Epoch 22
Loss = 1.1594e-03, PNorm = 69.5682, GNorm = 1.6066, lr_0 = 1.7783e-04
Loss = 9.8494e-04, PNorm = 69.5823, GNorm = 0.5633, lr_0 = 1.7207e-04
Loss = 7.7778e-04, PNorm = 69.5928, GNorm = 0.5930, lr_0 = 1.6651e-04
Validation rmse = 0.623276
Epoch 23
Loss = 1.0500e-03, PNorm = 69.6044, GNorm = 0.9786, lr_0 = 1.6059e-04
Loss = 7.9861e-04, PNorm = 69.6139, GNorm = 0.5549, lr_0 = 1.5539e-04
Validation rmse = 0.651680
Epoch 24
Loss = 7.9732e-04, PNorm = 69.6243, GNorm = 1.2167, lr_0 = 1.5036e-04
Loss = 7.9264e-04, PNorm = 69.6371, GNorm = 0.9215, lr_0 = 1.4550e-04
Loss = 8.5086e-04, PNorm = 69.6461, GNorm = 0.9735, lr_0 = 1.4079e-04
Validation rmse = 0.648739
Epoch 25
Loss = 8.6581e-04, PNorm = 69.6553, GNorm = 1.2229, lr_0 = 1.3623e-04
Loss = 9.8559e-04, PNorm = 69.6643, GNorm = 1.5657, lr_0 = 1.3183e-04
Loss = 1.0158e-03, PNorm = 69.6749, GNorm = 1.2878, lr_0 = 1.2756e-04
Validation rmse = 0.654691
Epoch 26
Loss = 8.2745e-04, PNorm = 69.6851, GNorm = 0.5226, lr_0 = 1.2343e-04
Loss = 7.4217e-04, PNorm = 69.6925, GNorm = 0.7640, lr_0 = 1.1944e-04
Validation rmse = 0.628117
Epoch 27
Loss = 6.0221e-04, PNorm = 69.7007, GNorm = 0.4316, lr_0 = 1.1557e-04
Loss = 7.7436e-04, PNorm = 69.7098, GNorm = 0.5829, lr_0 = 1.1183e-04
Loss = 7.3665e-04, PNorm = 69.7164, GNorm = 1.0744, lr_0 = 1.0821e-04
Validation rmse = 0.627773
Epoch 28
Loss = 7.1470e-04, PNorm = 69.7259, GNorm = 0.3231, lr_0 = 1.0437e-04
Loss = 8.3826e-04, PNorm = 69.7335, GNorm = 1.0854, lr_0 = 1.0099e-04
Validation rmse = 0.630580
Epoch 29
Loss = 4.9965e-04, PNorm = 69.7411, GNorm = 0.2702, lr_0 = 1.0000e-04
Loss = 6.5145e-04, PNorm = 69.7473, GNorm = 0.5189, lr_0 = 1.0000e-04
Loss = 8.0878e-04, PNorm = 69.7546, GNorm = 0.6635, lr_0 = 1.0000e-04
Validation rmse = 0.624438
Model 0 best validation rmse = 0.623276 on epoch 22
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.851190
Ensemble test rmse = 0.851190
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.05_ffn_num_layers_2_hidden_size_1400/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1400, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,276,201
Moving model to cuda
Epoch 0
Loss = 1.7049e-02, PNorm = 67.3334, GNorm = 1.5192, lr_0 = 2.9800e-04
Loss = 1.4510e-02, PNorm = 67.3826, GNorm = 6.4458, lr_0 = 4.7800e-04
Validation rmse = 1.812696
Epoch 1
Loss = 1.1181e-02, PNorm = 67.4726, GNorm = 7.5861, lr_0 = 6.7600e-04
Loss = 8.5912e-03, PNorm = 67.5824, GNorm = 3.4081, lr_0 = 8.5600e-04
Loss = 6.7663e-03, PNorm = 67.7135, GNorm = 1.7778, lr_0 = 9.9344e-04
Validation rmse = 1.258569
Epoch 2
Loss = 5.5584e-03, PNorm = 67.8505, GNorm = 0.7591, lr_0 = 9.6130e-04
Loss = 4.9823e-03, PNorm = 67.9691, GNorm = 3.9493, lr_0 = 9.3019e-04
Validation rmse = 1.219760
Epoch 3
Loss = 4.5858e-03, PNorm = 68.0690, GNorm = 4.9485, lr_0 = 9.0009e-04
Loss = 4.2300e-03, PNorm = 68.1566, GNorm = 3.9146, lr_0 = 8.7096e-04
Loss = 3.5275e-03, PNorm = 68.2437, GNorm = 0.6821, lr_0 = 8.4278e-04
Validation rmse = 0.960641
Epoch 4
Loss = 2.9308e-03, PNorm = 68.3172, GNorm = 1.2941, lr_0 = 8.1551e-04
Loss = 3.0641e-03, PNorm = 68.3783, GNorm = 1.8443, lr_0 = 7.8912e-04
Validation rmse = 0.903423
Epoch 5
Loss = 2.5833e-03, PNorm = 68.4378, GNorm = 1.1719, lr_0 = 7.6358e-04
Loss = 3.2626e-03, PNorm = 68.4937, GNorm = 1.3599, lr_0 = 7.3888e-04
Loss = 4.9120e-03, PNorm = 68.5538, GNorm = 2.6405, lr_0 = 7.1497e-04
Validation rmse = 1.142471
Epoch 6
Loss = 2.9233e-03, PNorm = 68.6250, GNorm = 1.9724, lr_0 = 6.8956e-04
Loss = 2.6593e-03, PNorm = 68.6781, GNorm = 2.0373, lr_0 = 6.6725e-04
Loss = 2.8654e-03, PNorm = 68.7215, GNorm = 6.0886, lr_0 = 6.4565e-04
Validation rmse = 0.949349
Epoch 7
Loss = 2.5217e-03, PNorm = 68.7675, GNorm = 0.6080, lr_0 = 6.2476e-04
Loss = 2.3261e-03, PNorm = 68.8098, GNorm = 1.8585, lr_0 = 6.0454e-04
Validation rmse = 0.890614
Epoch 8
Loss = 2.8950e-03, PNorm = 68.8499, GNorm = 5.0489, lr_0 = 5.8498e-04
Loss = 2.6873e-03, PNorm = 68.8955, GNorm = 0.8489, lr_0 = 5.6605e-04
Loss = 2.1716e-03, PNorm = 68.9285, GNorm = 1.8502, lr_0 = 5.4774e-04
Validation rmse = 0.789794
Epoch 9
Loss = 2.0367e-03, PNorm = 68.9673, GNorm = 3.2151, lr_0 = 5.3001e-04
Loss = 2.0209e-03, PNorm = 69.0041, GNorm = 0.7693, lr_0 = 5.1286e-04
Validation rmse = 0.774750
Epoch 10
Loss = 1.3577e-03, PNorm = 69.0365, GNorm = 0.4398, lr_0 = 4.9627e-04
Loss = 1.6877e-03, PNorm = 69.0677, GNorm = 0.8733, lr_0 = 4.8021e-04
Loss = 1.5413e-03, PNorm = 69.0969, GNorm = 2.2352, lr_0 = 4.6467e-04
Validation rmse = 0.806292
Epoch 11
Loss = 1.6895e-03, PNorm = 69.1172, GNorm = 3.7318, lr_0 = 4.4963e-04
Loss = 2.8555e-03, PNorm = 69.1553, GNorm = 2.5168, lr_0 = 4.3508e-04
Validation rmse = 0.862444
Epoch 12
Loss = 1.7039e-03, PNorm = 69.1918, GNorm = 0.7899, lr_0 = 4.1962e-04
Loss = 1.6581e-03, PNorm = 69.2266, GNorm = 0.5296, lr_0 = 4.0604e-04
Loss = 1.4883e-03, PNorm = 69.2554, GNorm = 1.1326, lr_0 = 3.9290e-04
Validation rmse = 0.853147
Epoch 13
Loss = 2.0133e-03, PNorm = 69.2798, GNorm = 3.2824, lr_0 = 3.8019e-04
Loss = 1.8960e-03, PNorm = 69.3056, GNorm = 1.1551, lr_0 = 3.6789e-04
Loss = 1.4068e-03, PNorm = 69.3309, GNorm = 1.3553, lr_0 = 3.5598e-04
Validation rmse = 0.824254
Epoch 14
Loss = 1.5121e-03, PNorm = 69.3550, GNorm = 1.9005, lr_0 = 3.4446e-04
Loss = 1.3609e-03, PNorm = 69.3771, GNorm = 1.7363, lr_0 = 3.3332e-04
Validation rmse = 0.772419
Epoch 15
Loss = 1.2613e-03, PNorm = 69.3985, GNorm = 1.9072, lr_0 = 3.2253e-04
Loss = 1.3030e-03, PNorm = 69.4172, GNorm = 1.1120, lr_0 = 3.1209e-04
Loss = 1.1409e-03, PNorm = 69.4379, GNorm = 1.2069, lr_0 = 3.0200e-04
Validation rmse = 0.784278
Epoch 16
Loss = 1.1800e-03, PNorm = 69.4597, GNorm = 0.4443, lr_0 = 2.9222e-04
Loss = 1.2796e-03, PNorm = 69.4774, GNorm = 0.5159, lr_0 = 2.8277e-04
Validation rmse = 0.767994
Epoch 17
Loss = 1.3764e-03, PNorm = 69.4986, GNorm = 0.9889, lr_0 = 2.7272e-04
Loss = 1.1987e-03, PNorm = 69.5191, GNorm = 0.6280, lr_0 = 2.6389e-04
Loss = 9.7554e-04, PNorm = 69.5364, GNorm = 0.3858, lr_0 = 2.5535e-04
Validation rmse = 0.726674
Epoch 18
Loss = 8.8119e-04, PNorm = 69.5524, GNorm = 0.3893, lr_0 = 2.4709e-04
Loss = 1.1660e-03, PNorm = 69.5666, GNorm = 1.2788, lr_0 = 2.3910e-04
Loss = 1.1168e-03, PNorm = 69.5841, GNorm = 1.0440, lr_0 = 2.3136e-04
Validation rmse = 0.782110
Epoch 19
Loss = 1.0649e-03, PNorm = 69.5981, GNorm = 0.3864, lr_0 = 2.2387e-04
Loss = 1.0383e-03, PNorm = 69.6143, GNorm = 0.4539, lr_0 = 2.1663e-04
Validation rmse = 0.724995
Epoch 20
Loss = 6.7319e-04, PNorm = 69.6310, GNorm = 0.2790, lr_0 = 2.0962e-04
Loss = 9.3993e-04, PNorm = 69.6440, GNorm = 0.6420, lr_0 = 2.0283e-04
Loss = 1.0336e-03, PNorm = 69.6560, GNorm = 1.6977, lr_0 = 1.9627e-04
Validation rmse = 0.760171
Epoch 21
Loss = 8.5786e-04, PNorm = 69.6695, GNorm = 0.4374, lr_0 = 1.8992e-04
Loss = 1.0274e-03, PNorm = 69.6837, GNorm = 1.5127, lr_0 = 1.8377e-04
Validation rmse = 0.740819
Epoch 22
Loss = 8.2655e-04, PNorm = 69.6992, GNorm = 0.6348, lr_0 = 1.7783e-04
Loss = 9.4178e-04, PNorm = 69.7093, GNorm = 1.7868, lr_0 = 1.7207e-04
Loss = 1.0340e-03, PNorm = 69.7215, GNorm = 1.1386, lr_0 = 1.6651e-04
Validation rmse = 0.743462
Epoch 23
Loss = 9.2225e-04, PNorm = 69.7383, GNorm = 0.7824, lr_0 = 1.6059e-04
Loss = 7.4433e-04, PNorm = 69.7490, GNorm = 1.4542, lr_0 = 1.5539e-04
Validation rmse = 0.735487
Epoch 24
Loss = 5.0636e-04, PNorm = 69.7611, GNorm = 0.4910, lr_0 = 1.5036e-04
Loss = 9.0692e-04, PNorm = 69.7718, GNorm = 2.0680, lr_0 = 1.4550e-04
Loss = 9.7767e-04, PNorm = 69.7857, GNorm = 0.7984, lr_0 = 1.4079e-04
Validation rmse = 0.733081
Epoch 25
Loss = 8.3890e-04, PNorm = 69.7966, GNorm = 0.5700, lr_0 = 1.3623e-04
Loss = 7.9248e-04, PNorm = 69.8078, GNorm = 0.6394, lr_0 = 1.3183e-04
Loss = 7.9646e-04, PNorm = 69.8158, GNorm = 1.0499, lr_0 = 1.2756e-04
Validation rmse = 0.722921
Epoch 26
Loss = 7.3653e-04, PNorm = 69.8246, GNorm = 0.5486, lr_0 = 1.2343e-04
Loss = 8.5616e-04, PNorm = 69.8342, GNorm = 1.1516, lr_0 = 1.1944e-04
Validation rmse = 0.723979
Epoch 27
Loss = 6.9668e-04, PNorm = 69.8448, GNorm = 1.0339, lr_0 = 1.1557e-04
Loss = 6.8573e-04, PNorm = 69.8527, GNorm = 0.3943, lr_0 = 1.1183e-04
Loss = 7.1877e-04, PNorm = 69.8607, GNorm = 0.3702, lr_0 = 1.0821e-04
Validation rmse = 0.725123
Epoch 28
Loss = 5.3916e-04, PNorm = 69.8701, GNorm = 0.4717, lr_0 = 1.0437e-04
Loss = 7.8221e-04, PNorm = 69.8779, GNorm = 0.4190, lr_0 = 1.0099e-04
Validation rmse = 0.757278
Epoch 29
Loss = 1.2887e-03, PNorm = 69.8863, GNorm = 0.4410, lr_0 = 1.0000e-04
Loss = 6.9135e-04, PNorm = 69.8954, GNorm = 1.0613, lr_0 = 1.0000e-04
Loss = 5.5578e-04, PNorm = 69.9036, GNorm = 0.6257, lr_0 = 1.0000e-04
Validation rmse = 0.722187
Model 0 best validation rmse = 0.722187 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.016475
Ensemble test rmse = 1.016475
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.05_ffn_num_layers_2_hidden_size_1400/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1400, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,276,201
Moving model to cuda
Epoch 0
Loss = 1.5633e-02, PNorm = 67.3366, GNorm = 3.2123, lr_0 = 2.9800e-04
Loss = 1.3045e-02, PNorm = 67.3819, GNorm = 12.0565, lr_0 = 4.7800e-04
Validation rmse = 1.677670
Epoch 1
Loss = 9.2031e-03, PNorm = 67.4588, GNorm = 1.3135, lr_0 = 6.7600e-04
Loss = 7.7729e-03, PNorm = 67.5627, GNorm = 2.0629, lr_0 = 8.5600e-04
Loss = 8.3515e-03, PNorm = 67.6772, GNorm = 1.3966, lr_0 = 9.9344e-04
Validation rmse = 1.835269
Epoch 2
Loss = 7.3106e-03, PNorm = 67.8057, GNorm = 1.0298, lr_0 = 9.6130e-04
Loss = 6.6652e-03, PNorm = 67.9278, GNorm = 3.1603, lr_0 = 9.3019e-04
Validation rmse = 1.334732
Epoch 3
Loss = 4.3702e-03, PNorm = 68.0269, GNorm = 3.1633, lr_0 = 9.0009e-04
Loss = 4.3231e-03, PNorm = 68.1108, GNorm = 1.5926, lr_0 = 8.7096e-04
Loss = 4.3516e-03, PNorm = 68.1837, GNorm = 1.4424, lr_0 = 8.4278e-04
Validation rmse = 1.085922
Epoch 4
Loss = 3.1940e-03, PNorm = 68.2575, GNorm = 2.9247, lr_0 = 8.1551e-04
Loss = 3.3691e-03, PNorm = 68.3158, GNorm = 3.4626, lr_0 = 7.8912e-04
Validation rmse = 1.050449
Epoch 5
Loss = 2.9459e-03, PNorm = 68.3703, GNorm = 1.3179, lr_0 = 7.6358e-04
Loss = 2.9488e-03, PNorm = 68.4193, GNorm = 1.1645, lr_0 = 7.3888e-04
Loss = 4.4439e-03, PNorm = 68.4695, GNorm = 2.9102, lr_0 = 7.1497e-04
Validation rmse = 1.231680
Epoch 6
Loss = 4.1256e-03, PNorm = 68.5424, GNorm = 3.1364, lr_0 = 6.8956e-04
Loss = 4.3813e-03, PNorm = 68.5844, GNorm = 1.6101, lr_0 = 6.6725e-04
Loss = 2.8198e-03, PNorm = 68.6365, GNorm = 2.2656, lr_0 = 6.4565e-04
Validation rmse = 1.003354
Epoch 7
Loss = 2.3842e-03, PNorm = 68.6804, GNorm = 0.5669, lr_0 = 6.2476e-04
Loss = 2.6508e-03, PNorm = 68.7211, GNorm = 1.4775, lr_0 = 6.0454e-04
Validation rmse = 1.117699
Epoch 8
Loss = 2.0567e-03, PNorm = 68.7552, GNorm = 0.8747, lr_0 = 5.8498e-04
Loss = 2.3500e-03, PNorm = 68.7915, GNorm = 2.8787, lr_0 = 5.6605e-04
Loss = 2.5918e-03, PNorm = 68.8236, GNorm = 1.6585, lr_0 = 5.4774e-04
Validation rmse = 1.054347
Epoch 9
Loss = 2.2332e-03, PNorm = 68.8508, GNorm = 2.6667, lr_0 = 5.3001e-04
Loss = 2.3902e-03, PNorm = 68.8854, GNorm = 1.0249, lr_0 = 5.1286e-04
Validation rmse = 0.996798
Epoch 10
Loss = 1.6025e-03, PNorm = 68.9190, GNorm = 1.4952, lr_0 = 4.9627e-04
Loss = 1.6735e-03, PNorm = 68.9460, GNorm = 0.9397, lr_0 = 4.8021e-04
Loss = 2.2674e-03, PNorm = 68.9748, GNorm = 1.1859, lr_0 = 4.6467e-04
Validation rmse = 0.971419
Epoch 11
Loss = 1.6900e-03, PNorm = 69.0049, GNorm = 2.4782, lr_0 = 4.4963e-04
Loss = 2.1424e-03, PNorm = 69.0340, GNorm = 3.1619, lr_0 = 4.3508e-04
Validation rmse = 1.066811
Epoch 12
Loss = 2.1179e-03, PNorm = 69.0624, GNorm = 2.1404, lr_0 = 4.1962e-04
Loss = 1.7734e-03, PNorm = 69.0870, GNorm = 1.4564, lr_0 = 4.0604e-04
Loss = 1.5839e-03, PNorm = 69.1124, GNorm = 0.7898, lr_0 = 3.9290e-04
Validation rmse = 1.084579
Epoch 13
Loss = 2.0190e-03, PNorm = 69.1366, GNorm = 4.7417, lr_0 = 3.8019e-04
Loss = 1.6378e-03, PNorm = 69.1557, GNorm = 1.4875, lr_0 = 3.6789e-04
Loss = 1.8478e-03, PNorm = 69.1761, GNorm = 2.5256, lr_0 = 3.5598e-04
Validation rmse = 0.918264
Epoch 14
Loss = 2.0301e-03, PNorm = 69.2025, GNorm = 1.6005, lr_0 = 3.4446e-04
Loss = 1.4572e-03, PNorm = 69.2243, GNorm = 1.1737, lr_0 = 3.3332e-04
Validation rmse = 0.993740
Epoch 15
Loss = 1.6361e-03, PNorm = 69.2422, GNorm = 1.0302, lr_0 = 3.2253e-04
Loss = 1.2459e-03, PNorm = 69.2595, GNorm = 0.3625, lr_0 = 3.1209e-04
Loss = 1.2919e-03, PNorm = 69.2790, GNorm = 0.8760, lr_0 = 3.0200e-04
Validation rmse = 0.943115
Epoch 16
Loss = 1.5676e-03, PNorm = 69.2968, GNorm = 1.6336, lr_0 = 2.9222e-04
Loss = 1.5579e-03, PNorm = 69.3143, GNorm = 3.5818, lr_0 = 2.8277e-04
Validation rmse = 0.957495
Epoch 17
Loss = 1.2685e-03, PNorm = 69.3344, GNorm = 0.8328, lr_0 = 2.7272e-04
Loss = 1.4473e-03, PNorm = 69.3529, GNorm = 1.2579, lr_0 = 2.6389e-04
Loss = 1.1338e-03, PNorm = 69.3719, GNorm = 0.5506, lr_0 = 2.5535e-04
Validation rmse = 0.914373
Epoch 18
Loss = 1.2718e-03, PNorm = 69.3865, GNorm = 1.7555, lr_0 = 2.4709e-04
Loss = 1.1147e-03, PNorm = 69.4020, GNorm = 0.3532, lr_0 = 2.3910e-04
Loss = 1.1279e-03, PNorm = 69.4170, GNorm = 0.5564, lr_0 = 2.3136e-04
Validation rmse = 0.920923
Epoch 19
Loss = 1.1094e-03, PNorm = 69.4304, GNorm = 1.5107, lr_0 = 2.2387e-04
Loss = 1.2991e-03, PNorm = 69.4450, GNorm = 1.4693, lr_0 = 2.1663e-04
Validation rmse = 0.929739
Epoch 20
Loss = 9.8851e-04, PNorm = 69.4570, GNorm = 0.5608, lr_0 = 2.0962e-04
Loss = 1.1222e-03, PNorm = 69.4726, GNorm = 0.5655, lr_0 = 2.0283e-04
Loss = 1.0481e-03, PNorm = 69.4840, GNorm = 0.6767, lr_0 = 1.9627e-04
Validation rmse = 0.921524
Epoch 21
Loss = 1.0839e-03, PNorm = 69.4961, GNorm = 1.2771, lr_0 = 1.8992e-04
Loss = 1.0467e-03, PNorm = 69.5083, GNorm = 0.7342, lr_0 = 1.8377e-04
Validation rmse = 0.921337
Epoch 22
Loss = 1.0127e-03, PNorm = 69.5217, GNorm = 1.0253, lr_0 = 1.7783e-04
Loss = 7.2628e-04, PNorm = 69.5313, GNorm = 0.9068, lr_0 = 1.7207e-04
Loss = 1.2177e-03, PNorm = 69.5420, GNorm = 1.3626, lr_0 = 1.6651e-04
Validation rmse = 0.962490
Epoch 23
Loss = 9.1534e-04, PNorm = 69.5541, GNorm = 0.5162, lr_0 = 1.6059e-04
Loss = 9.4574e-04, PNorm = 69.5648, GNorm = 0.4764, lr_0 = 1.5539e-04
Validation rmse = 0.858865
Epoch 24
Loss = 8.7677e-04, PNorm = 69.5729, GNorm = 0.7969, lr_0 = 1.5036e-04
Loss = 1.0111e-03, PNorm = 69.5855, GNorm = 0.4078, lr_0 = 1.4550e-04
Loss = 9.1317e-04, PNorm = 69.5944, GNorm = 0.5960, lr_0 = 1.4079e-04
Validation rmse = 0.860097
Epoch 25
Loss = 7.9529e-04, PNorm = 69.6022, GNorm = 0.6144, lr_0 = 1.3623e-04
Loss = 9.2042e-04, PNorm = 69.6135, GNorm = 0.2373, lr_0 = 1.3183e-04
Loss = 8.6280e-04, PNorm = 69.6224, GNorm = 0.7313, lr_0 = 1.2756e-04
Validation rmse = 0.861863
Epoch 26
Loss = 9.6095e-04, PNorm = 69.6304, GNorm = 2.4992, lr_0 = 1.2343e-04
Loss = 7.9922e-04, PNorm = 69.6397, GNorm = 0.8532, lr_0 = 1.1944e-04
Validation rmse = 0.900061
Epoch 27
Loss = 7.3898e-04, PNorm = 69.6443, GNorm = 0.4832, lr_0 = 1.1557e-04
Loss = 9.7802e-04, PNorm = 69.6535, GNorm = 0.3006, lr_0 = 1.1183e-04
Loss = 8.5933e-04, PNorm = 69.6599, GNorm = 1.3123, lr_0 = 1.0821e-04
Validation rmse = 0.845618
Epoch 28
Loss = 9.7425e-04, PNorm = 69.6695, GNorm = 1.9600, lr_0 = 1.0437e-04
Loss = 7.1677e-04, PNorm = 69.6763, GNorm = 0.7945, lr_0 = 1.0099e-04
Validation rmse = 0.845327
Epoch 29
Loss = 3.8895e-04, PNorm = 69.6819, GNorm = 0.5570, lr_0 = 1.0000e-04
Loss = 8.1348e-04, PNorm = 69.6894, GNorm = 0.5538, lr_0 = 1.0000e-04
Loss = 7.2426e-04, PNorm = 69.6966, GNorm = 0.4622, lr_0 = 1.0000e-04
Validation rmse = 0.861393
Model 0 best validation rmse = 0.845327 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.685527
Ensemble test rmse = 0.685527
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.05_ffn_num_layers_2_hidden_size_1400/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1400, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,276,201
Moving model to cuda
Epoch 0
Loss = 1.8310e-02, PNorm = 67.3340, GNorm = 2.2300, lr_0 = 2.9800e-04
Loss = 1.3362e-02, PNorm = 67.3845, GNorm = 13.4858, lr_0 = 4.7800e-04
Validation rmse = 1.610328
Epoch 1
Loss = 7.8877e-03, PNorm = 67.4686, GNorm = 2.7011, lr_0 = 6.7600e-04
Loss = 8.2873e-03, PNorm = 67.5575, GNorm = 9.0488, lr_0 = 8.5600e-04
Loss = 7.3277e-03, PNorm = 67.6781, GNorm = 5.0731, lr_0 = 9.9344e-04
Validation rmse = 1.614794
Epoch 2
Loss = 6.2441e-03, PNorm = 67.7950, GNorm = 1.3552, lr_0 = 9.6130e-04
Loss = 5.0394e-03, PNorm = 67.8849, GNorm = 1.1477, lr_0 = 9.3019e-04
Validation rmse = 1.276613
Epoch 3
Loss = 5.9489e-03, PNorm = 67.9775, GNorm = 4.5496, lr_0 = 9.0009e-04
Loss = 5.0258e-03, PNorm = 68.0789, GNorm = 2.7563, lr_0 = 8.7096e-04
Loss = 3.7423e-03, PNorm = 68.1554, GNorm = 1.0928, lr_0 = 8.4278e-04
Validation rmse = 1.144489
Epoch 4
Loss = 3.1215e-03, PNorm = 68.2210, GNorm = 0.7123, lr_0 = 8.1551e-04
Loss = 4.1711e-03, PNorm = 68.2741, GNorm = 1.1049, lr_0 = 7.8912e-04
Validation rmse = 1.275827
Epoch 5
Loss = 4.2961e-03, PNorm = 68.3327, GNorm = 5.6600, lr_0 = 7.6358e-04
Loss = 3.5882e-03, PNorm = 68.3926, GNorm = 1.8517, lr_0 = 7.3888e-04
Loss = 3.0159e-03, PNorm = 68.4461, GNorm = 1.9594, lr_0 = 7.1497e-04
Validation rmse = 1.042240
Epoch 6
Loss = 2.7779e-03, PNorm = 68.5019, GNorm = 2.3193, lr_0 = 6.8956e-04
Loss = 3.1545e-03, PNorm = 68.5523, GNorm = 6.8621, lr_0 = 6.6725e-04
Loss = 3.9224e-03, PNorm = 68.6061, GNorm = 2.5903, lr_0 = 6.4565e-04
Validation rmse = 1.306994
Epoch 7
Loss = 3.1976e-03, PNorm = 68.6569, GNorm = 1.6908, lr_0 = 6.2476e-04
Loss = 2.1930e-03, PNorm = 68.7041, GNorm = 1.6375, lr_0 = 6.0454e-04
Validation rmse = 1.021175
Epoch 8
Loss = 2.1987e-03, PNorm = 68.7452, GNorm = 2.3652, lr_0 = 5.8498e-04
Loss = 1.7777e-03, PNorm = 68.7804, GNorm = 0.6212, lr_0 = 5.6605e-04
Loss = 1.9936e-03, PNorm = 68.8105, GNorm = 0.7035, lr_0 = 5.4774e-04
Validation rmse = 1.015448
Epoch 9
Loss = 2.3465e-03, PNorm = 68.8458, GNorm = 3.2054, lr_0 = 5.3001e-04
Loss = 1.6545e-03, PNorm = 68.8804, GNorm = 0.8499, lr_0 = 5.1286e-04
Validation rmse = 0.952071
Epoch 10
Loss = 1.6746e-03, PNorm = 68.9163, GNorm = 1.5041, lr_0 = 4.9627e-04
Loss = 1.7816e-03, PNorm = 68.9465, GNorm = 0.5693, lr_0 = 4.8021e-04
Loss = 1.6962e-03, PNorm = 68.9709, GNorm = 2.2547, lr_0 = 4.6467e-04
Validation rmse = 1.022898
Epoch 11
Loss = 1.7643e-03, PNorm = 69.0014, GNorm = 0.8236, lr_0 = 4.4963e-04
Loss = 1.9118e-03, PNorm = 69.0269, GNorm = 1.9983, lr_0 = 4.3508e-04
Validation rmse = 1.027526
Epoch 12
Loss = 1.8934e-03, PNorm = 69.0628, GNorm = 2.3792, lr_0 = 4.1962e-04
Loss = 1.5335e-03, PNorm = 69.0910, GNorm = 1.8799, lr_0 = 4.0604e-04
Loss = 1.4252e-03, PNorm = 69.1124, GNorm = 1.1922, lr_0 = 3.9290e-04
Validation rmse = 0.959645
Epoch 13
Loss = 1.3049e-03, PNorm = 69.1403, GNorm = 1.4580, lr_0 = 3.8019e-04
Loss = 1.2684e-03, PNorm = 69.1595, GNorm = 1.3985, lr_0 = 3.6789e-04
Loss = 1.3975e-03, PNorm = 69.1812, GNorm = 0.9284, lr_0 = 3.5598e-04
Validation rmse = 0.926866
Epoch 14
Loss = 1.1930e-03, PNorm = 69.2036, GNorm = 1.3865, lr_0 = 3.4446e-04
Loss = 1.1294e-03, PNorm = 69.2236, GNorm = 1.7450, lr_0 = 3.3332e-04
Validation rmse = 0.937972
Epoch 15
Loss = 7.5592e-04, PNorm = 69.2483, GNorm = 0.6356, lr_0 = 3.2253e-04
Loss = 1.6008e-03, PNorm = 69.2702, GNorm = 2.3530, lr_0 = 3.1209e-04
Loss = 1.4396e-03, PNorm = 69.2887, GNorm = 2.1040, lr_0 = 3.0200e-04
Validation rmse = 0.977836
Epoch 16
Loss = 1.3693e-03, PNorm = 69.3056, GNorm = 1.0797, lr_0 = 2.9222e-04
Loss = 1.4884e-03, PNorm = 69.3293, GNorm = 1.8427, lr_0 = 2.8277e-04
Validation rmse = 0.945884
Epoch 17
Loss = 9.5269e-04, PNorm = 69.3566, GNorm = 0.8061, lr_0 = 2.7272e-04
Loss = 1.2943e-03, PNorm = 69.3750, GNorm = 1.0436, lr_0 = 2.6389e-04
Loss = 1.1611e-03, PNorm = 69.3890, GNorm = 0.7362, lr_0 = 2.5535e-04
Validation rmse = 1.061042
Epoch 18
Loss = 1.7546e-03, PNorm = 69.4052, GNorm = 2.7865, lr_0 = 2.4709e-04
Loss = 1.0821e-03, PNorm = 69.4231, GNorm = 1.9108, lr_0 = 2.3910e-04
Loss = 1.0935e-03, PNorm = 69.4380, GNorm = 0.7021, lr_0 = 2.3136e-04
Validation rmse = 0.932505
Epoch 19
Loss = 1.0168e-03, PNorm = 69.4491, GNorm = 0.4726, lr_0 = 2.2387e-04
Loss = 9.4354e-04, PNorm = 69.4639, GNorm = 1.4510, lr_0 = 2.1663e-04
Validation rmse = 0.938498
Epoch 20
Loss = 1.0224e-03, PNorm = 69.4784, GNorm = 0.7025, lr_0 = 2.0962e-04
Loss = 9.0948e-04, PNorm = 69.4911, GNorm = 0.7270, lr_0 = 2.0283e-04
Loss = 1.0857e-03, PNorm = 69.5035, GNorm = 1.1220, lr_0 = 1.9627e-04
Validation rmse = 0.930198
Epoch 21
Loss = 9.7853e-04, PNorm = 69.5151, GNorm = 0.5446, lr_0 = 1.8992e-04
Loss = 8.5064e-04, PNorm = 69.5281, GNorm = 1.2840, lr_0 = 1.8377e-04
Validation rmse = 0.922986
Epoch 22
Loss = 7.5657e-04, PNorm = 69.5372, GNorm = 0.6470, lr_0 = 1.7783e-04
Loss = 8.4508e-04, PNorm = 69.5493, GNorm = 0.7973, lr_0 = 1.7207e-04
Loss = 9.7241e-04, PNorm = 69.5597, GNorm = 1.3723, lr_0 = 1.6651e-04
Validation rmse = 0.924868
Epoch 23
Loss = 7.8320e-04, PNorm = 69.5693, GNorm = 0.9660, lr_0 = 1.6059e-04
Loss = 1.0298e-03, PNorm = 69.5786, GNorm = 0.6214, lr_0 = 1.5539e-04
Validation rmse = 0.937059
Epoch 24
Loss = 7.2757e-04, PNorm = 69.5894, GNorm = 0.6012, lr_0 = 1.5036e-04
Loss = 8.3092e-04, PNorm = 69.5989, GNorm = 0.5769, lr_0 = 1.4550e-04
Loss = 8.8266e-04, PNorm = 69.6081, GNorm = 0.9523, lr_0 = 1.4079e-04
Validation rmse = 0.917972
Epoch 25
Loss = 8.9452e-04, PNorm = 69.6162, GNorm = 0.4778, lr_0 = 1.3623e-04
Loss = 6.2130e-04, PNorm = 69.6241, GNorm = 0.4945, lr_0 = 1.3183e-04
Loss = 9.1119e-04, PNorm = 69.6315, GNorm = 1.0238, lr_0 = 1.2756e-04
Validation rmse = 0.921514
Epoch 26
Loss = 7.8606e-04, PNorm = 69.6398, GNorm = 1.0328, lr_0 = 1.2343e-04
Loss = 7.7993e-04, PNorm = 69.6487, GNorm = 0.4941, lr_0 = 1.1944e-04
Validation rmse = 0.923733
Epoch 27
Loss = 6.8092e-04, PNorm = 69.6562, GNorm = 0.3232, lr_0 = 1.1557e-04
Loss = 7.0024e-04, PNorm = 69.6648, GNorm = 0.8282, lr_0 = 1.1183e-04
Loss = 8.1784e-04, PNorm = 69.6723, GNorm = 1.3814, lr_0 = 1.0821e-04
Validation rmse = 0.929862
Epoch 28
Loss = 7.1440e-04, PNorm = 69.6778, GNorm = 0.5858, lr_0 = 1.0437e-04
Loss = 7.3943e-04, PNorm = 69.6848, GNorm = 1.5952, lr_0 = 1.0099e-04
Validation rmse = 0.916494
Epoch 29
Loss = 6.1446e-04, PNorm = 69.6901, GNorm = 0.3450, lr_0 = 1.0000e-04
Loss = 6.8021e-04, PNorm = 69.6963, GNorm = 0.9753, lr_0 = 1.0000e-04
Loss = 8.6982e-04, PNorm = 69.7035, GNorm = 0.5598, lr_0 = 1.0000e-04
Validation rmse = 0.923520
Model 0 best validation rmse = 0.916494 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.738725
Ensemble test rmse = 0.738725
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.05_ffn_num_layers_2_hidden_size_1400/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1400, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,276,201
Moving model to cuda
Epoch 0
Loss = 1.6746e-02, PNorm = 67.3330, GNorm = 5.6109, lr_0 = 2.9800e-04
Loss = 1.0640e-02, PNorm = 67.3887, GNorm = 18.0013, lr_0 = 4.7800e-04
Validation rmse = 1.753453
Epoch 1
Loss = 1.1244e-02, PNorm = 67.4714, GNorm = 5.3502, lr_0 = 6.7600e-04
Loss = 8.1121e-03, PNorm = 67.5834, GNorm = 0.7997, lr_0 = 8.5600e-04
Loss = 6.1303e-03, PNorm = 67.7042, GNorm = 2.1674, lr_0 = 9.9344e-04
Validation rmse = 1.455141
Epoch 2
Loss = 7.0806e-03, PNorm = 67.8323, GNorm = 2.9783, lr_0 = 9.6130e-04
Loss = 5.2681e-03, PNorm = 67.9456, GNorm = 2.4167, lr_0 = 9.3019e-04
Validation rmse = 1.259394
Epoch 3
Loss = 4.5705e-03, PNorm = 68.0362, GNorm = 2.5680, lr_0 = 9.0009e-04
Loss = 3.7131e-03, PNorm = 68.1136, GNorm = 1.8779, lr_0 = 8.7096e-04
Loss = 4.3625e-03, PNorm = 68.1877, GNorm = 5.2537, lr_0 = 8.4278e-04
Validation rmse = 1.032036
Epoch 4
Loss = 4.3832e-03, PNorm = 68.2540, GNorm = 4.3246, lr_0 = 8.1551e-04
Loss = 3.3570e-03, PNorm = 68.3075, GNorm = 1.7017, lr_0 = 7.8912e-04
Validation rmse = 0.831959
Epoch 5
Loss = 2.7840e-03, PNorm = 68.3587, GNorm = 0.7413, lr_0 = 7.6358e-04
Loss = 2.9371e-03, PNorm = 68.4162, GNorm = 4.2332, lr_0 = 7.3888e-04
Loss = 3.3663e-03, PNorm = 68.4586, GNorm = 1.0583, lr_0 = 7.1497e-04
Validation rmse = 0.836487
Epoch 6
Loss = 2.8463e-03, PNorm = 68.5096, GNorm = 1.2568, lr_0 = 6.8956e-04
Loss = 3.0482e-03, PNorm = 68.5555, GNorm = 5.7483, lr_0 = 6.6725e-04
Loss = 3.1841e-03, PNorm = 68.5996, GNorm = 2.2489, lr_0 = 6.4565e-04
Validation rmse = 0.886871
Epoch 7
Loss = 3.3008e-03, PNorm = 68.6503, GNorm = 0.7628, lr_0 = 6.2476e-04
Loss = 3.2237e-03, PNorm = 68.7000, GNorm = 2.6969, lr_0 = 6.0454e-04
Validation rmse = 0.981388
Epoch 8
Loss = 1.9326e-03, PNorm = 68.7518, GNorm = 0.9193, lr_0 = 5.8498e-04
Loss = 2.8334e-03, PNorm = 68.7912, GNorm = 1.9572, lr_0 = 5.6605e-04
Loss = 2.6079e-03, PNorm = 68.8327, GNorm = 1.8174, lr_0 = 5.4774e-04
Validation rmse = 0.832867
Epoch 9
Loss = 2.1147e-03, PNorm = 68.8761, GNorm = 3.5293, lr_0 = 5.3001e-04
Loss = 2.7543e-03, PNorm = 68.9182, GNorm = 1.9102, lr_0 = 5.1286e-04
Validation rmse = 0.841434
Epoch 10
Loss = 2.0685e-03, PNorm = 68.9547, GNorm = 2.3591, lr_0 = 4.9627e-04
Loss = 1.7272e-03, PNorm = 68.9911, GNorm = 0.4635, lr_0 = 4.8021e-04
Loss = 2.0353e-03, PNorm = 69.0176, GNorm = 2.5549, lr_0 = 4.6467e-04
Validation rmse = 0.795946
Epoch 11
Loss = 1.8792e-03, PNorm = 69.0500, GNorm = 1.1334, lr_0 = 4.4963e-04
Loss = 1.4059e-03, PNorm = 69.0783, GNorm = 1.1905, lr_0 = 4.3508e-04
Validation rmse = 0.745934
Epoch 12
Loss = 1.4940e-03, PNorm = 69.1034, GNorm = 1.3318, lr_0 = 4.1962e-04
Loss = 1.3685e-03, PNorm = 69.1272, GNorm = 0.5357, lr_0 = 4.0604e-04
Loss = 1.6965e-03, PNorm = 69.1508, GNorm = 1.0989, lr_0 = 3.9290e-04
Validation rmse = 0.860914
Epoch 13
Loss = 1.5410e-03, PNorm = 69.1696, GNorm = 0.9981, lr_0 = 3.8019e-04
Loss = 1.2502e-03, PNorm = 69.1889, GNorm = 0.7259, lr_0 = 3.6789e-04
Loss = 1.4851e-03, PNorm = 69.2119, GNorm = 1.9441, lr_0 = 3.5598e-04
Validation rmse = 0.722484
Epoch 14
Loss = 1.1418e-03, PNorm = 69.2323, GNorm = 0.5036, lr_0 = 3.4446e-04
Loss = 1.3041e-03, PNorm = 69.2561, GNorm = 0.7153, lr_0 = 3.3332e-04
Validation rmse = 0.733403
Epoch 15
Loss = 6.1521e-04, PNorm = 69.2772, GNorm = 0.6495, lr_0 = 3.2253e-04
Loss = 1.3775e-03, PNorm = 69.2983, GNorm = 1.0927, lr_0 = 3.1209e-04
Loss = 1.3405e-03, PNorm = 69.3183, GNorm = 1.0169, lr_0 = 3.0200e-04
Validation rmse = 0.818271
Epoch 16
Loss = 1.0619e-03, PNorm = 69.3375, GNorm = 0.7282, lr_0 = 2.9222e-04
Loss = 1.3043e-03, PNorm = 69.3542, GNorm = 1.7174, lr_0 = 2.8277e-04
Validation rmse = 0.807460
Epoch 17
Loss = 1.0857e-03, PNorm = 69.3702, GNorm = 2.3573, lr_0 = 2.7272e-04
Loss = 9.8740e-04, PNorm = 69.3850, GNorm = 0.7026, lr_0 = 2.6389e-04
Loss = 1.2374e-03, PNorm = 69.4034, GNorm = 1.8692, lr_0 = 2.5535e-04
Validation rmse = 0.750928
Epoch 18
Loss = 9.7196e-04, PNorm = 69.4191, GNorm = 0.4824, lr_0 = 2.4709e-04
Loss = 9.9497e-04, PNorm = 69.4337, GNorm = 0.4026, lr_0 = 2.3910e-04
Loss = 1.1678e-03, PNorm = 69.4491, GNorm = 2.7065, lr_0 = 2.3136e-04
Validation rmse = 0.782326
Epoch 19
Loss = 1.1370e-03, PNorm = 69.4637, GNorm = 2.2046, lr_0 = 2.2387e-04
Loss = 1.0649e-03, PNorm = 69.4783, GNorm = 0.3599, lr_0 = 2.1663e-04
Validation rmse = 0.716271
Epoch 20
Loss = 1.1669e-03, PNorm = 69.4916, GNorm = 0.7125, lr_0 = 2.0962e-04
Loss = 9.8092e-04, PNorm = 69.5049, GNorm = 2.7611, lr_0 = 2.0283e-04
Loss = 1.0084e-03, PNorm = 69.5188, GNorm = 0.3377, lr_0 = 1.9627e-04
Validation rmse = 0.721164
Epoch 21
Loss = 1.1039e-03, PNorm = 69.5328, GNorm = 2.2289, lr_0 = 1.8992e-04
Loss = 9.7264e-04, PNorm = 69.5440, GNorm = 0.5162, lr_0 = 1.8377e-04
Validation rmse = 0.723318
Epoch 22
Loss = 9.3375e-04, PNorm = 69.5539, GNorm = 0.6374, lr_0 = 1.7783e-04
Loss = 8.3953e-04, PNorm = 69.5642, GNorm = 0.5264, lr_0 = 1.7207e-04
Loss = 9.2223e-04, PNorm = 69.5756, GNorm = 0.5544, lr_0 = 1.6651e-04
Validation rmse = 0.782497
Epoch 23
Loss = 7.0919e-04, PNorm = 69.5876, GNorm = 0.5375, lr_0 = 1.6059e-04
Loss = 8.4705e-04, PNorm = 69.5977, GNorm = 0.4676, lr_0 = 1.5539e-04
Validation rmse = 0.785192
Epoch 24
Loss = 4.5848e-04, PNorm = 69.6057, GNorm = 0.7731, lr_0 = 1.5036e-04
Loss = 8.7839e-04, PNorm = 69.6146, GNorm = 0.6676, lr_0 = 1.4550e-04
Loss = 8.6020e-04, PNorm = 69.6245, GNorm = 0.4684, lr_0 = 1.4079e-04
Validation rmse = 0.736016
Epoch 25
Loss = 6.0138e-04, PNorm = 69.6344, GNorm = 0.5813, lr_0 = 1.3623e-04
Loss = 7.7187e-04, PNorm = 69.6431, GNorm = 0.7973, lr_0 = 1.3183e-04
Loss = 8.8818e-04, PNorm = 69.6516, GNorm = 0.8927, lr_0 = 1.2756e-04
Validation rmse = 0.745488
Epoch 26
Loss = 7.1606e-04, PNorm = 69.6581, GNorm = 0.4758, lr_0 = 1.2343e-04
Loss = 7.3411e-04, PNorm = 69.6660, GNorm = 0.4620, lr_0 = 1.1944e-04
Validation rmse = 0.711976
Epoch 27
Loss = 7.1251e-04, PNorm = 69.6729, GNorm = 0.9632, lr_0 = 1.1557e-04
Loss = 8.3552e-04, PNorm = 69.6815, GNorm = 0.6600, lr_0 = 1.1183e-04
Loss = 8.2876e-04, PNorm = 69.6894, GNorm = 0.4054, lr_0 = 1.0821e-04
Validation rmse = 0.743693
Epoch 28
Loss = 7.2915e-04, PNorm = 69.6965, GNorm = 0.9196, lr_0 = 1.0437e-04
Loss = 7.3212e-04, PNorm = 69.7028, GNorm = 0.4147, lr_0 = 1.0099e-04
Validation rmse = 0.741250
Epoch 29
Loss = 5.4666e-04, PNorm = 69.7108, GNorm = 0.8377, lr_0 = 1.0000e-04
Loss = 7.7116e-04, PNorm = 69.7176, GNorm = 2.0155, lr_0 = 1.0000e-04
Loss = 8.5448e-04, PNorm = 69.7247, GNorm = 1.0294, lr_0 = 1.0000e-04
Validation rmse = 0.752752
Model 0 best validation rmse = 0.711976 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.691098
Ensemble test rmse = 0.691098
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.05_ffn_num_layers_2_hidden_size_1400/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1400, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,276,201
Moving model to cuda
Epoch 0
Loss = 1.7812e-02, PNorm = 67.3326, GNorm = 1.7535, lr_0 = 2.9800e-04
Loss = 1.1922e-02, PNorm = 67.3837, GNorm = 4.7168, lr_0 = 4.7800e-04
Validation rmse = 2.218474
Epoch 1
Loss = 1.1168e-02, PNorm = 67.4715, GNorm = 3.8909, lr_0 = 6.7600e-04
Loss = 7.9276e-03, PNorm = 67.5800, GNorm = 1.0290, lr_0 = 8.5600e-04
Loss = 7.4457e-03, PNorm = 67.7004, GNorm = 4.1162, lr_0 = 9.9344e-04
Validation rmse = 1.443432
Epoch 2
Loss = 5.5776e-03, PNorm = 67.8342, GNorm = 1.9361, lr_0 = 9.6130e-04
Loss = 4.6341e-03, PNorm = 67.9529, GNorm = 6.3210, lr_0 = 9.3019e-04
Validation rmse = 1.414108
Epoch 3
Loss = 4.8998e-03, PNorm = 68.0554, GNorm = 1.4210, lr_0 = 9.0009e-04
Loss = 4.9145e-03, PNorm = 68.1434, GNorm = 1.6387, lr_0 = 8.7096e-04
Loss = 4.2856e-03, PNorm = 68.2270, GNorm = 3.1945, lr_0 = 8.4278e-04
Validation rmse = 1.075824
Epoch 4
Loss = 4.5276e-03, PNorm = 68.2950, GNorm = 5.2500, lr_0 = 8.1551e-04
Loss = 3.9310e-03, PNorm = 68.3679, GNorm = 0.9363, lr_0 = 7.8912e-04
Validation rmse = 1.122341
Epoch 5
Loss = 1.7453e-03, PNorm = 68.4196, GNorm = 0.7411, lr_0 = 7.6358e-04
Loss = 2.6311e-03, PNorm = 68.4640, GNorm = 1.6517, lr_0 = 7.3888e-04
Loss = 3.2868e-03, PNorm = 68.5093, GNorm = 2.0784, lr_0 = 7.1497e-04
Validation rmse = 1.159421
Epoch 6
Loss = 2.7926e-03, PNorm = 68.5660, GNorm = 1.9127, lr_0 = 6.8956e-04
Loss = 2.7303e-03, PNorm = 68.6190, GNorm = 1.1899, lr_0 = 6.6725e-04
Loss = 2.8470e-03, PNorm = 68.6518, GNorm = 0.8281, lr_0 = 6.4565e-04
Validation rmse = 0.956952
Epoch 7
Loss = 2.4442e-03, PNorm = 68.6967, GNorm = 2.7777, lr_0 = 6.2476e-04
Loss = 2.3018e-03, PNorm = 68.7359, GNorm = 2.3526, lr_0 = 6.0454e-04
Validation rmse = 0.989092
Epoch 8
Loss = 2.0187e-03, PNorm = 68.7710, GNorm = 2.1323, lr_0 = 5.8498e-04
Loss = 2.0929e-03, PNorm = 68.8059, GNorm = 1.0917, lr_0 = 5.6605e-04
Loss = 1.8415e-03, PNorm = 68.8389, GNorm = 0.7104, lr_0 = 5.4774e-04
Validation rmse = 1.006623
Epoch 9
Loss = 1.7773e-03, PNorm = 68.8695, GNorm = 0.6905, lr_0 = 5.3001e-04
Loss = 1.9739e-03, PNorm = 68.9065, GNorm = 0.7015, lr_0 = 5.1286e-04
Validation rmse = 0.922059
Epoch 10
Loss = 1.6081e-03, PNorm = 68.9381, GNorm = 2.5402, lr_0 = 4.9627e-04
Loss = 2.2503e-03, PNorm = 68.9695, GNorm = 2.0723, lr_0 = 4.8021e-04
Loss = 2.1872e-03, PNorm = 69.0032, GNorm = 0.8381, lr_0 = 4.6467e-04
Validation rmse = 1.001239
Epoch 11
Loss = 1.8811e-03, PNorm = 69.0357, GNorm = 1.8986, lr_0 = 4.4963e-04
Loss = 1.5715e-03, PNorm = 69.0653, GNorm = 0.8368, lr_0 = 4.3508e-04
Validation rmse = 0.958094
Epoch 12
Loss = 1.3997e-03, PNorm = 69.0949, GNorm = 1.2945, lr_0 = 4.1962e-04
Loss = 1.7231e-03, PNorm = 69.1169, GNorm = 3.4321, lr_0 = 4.0604e-04
Loss = 1.7041e-03, PNorm = 69.1474, GNorm = 3.4485, lr_0 = 3.9290e-04
Validation rmse = 0.912885
Epoch 13
Loss = 1.4886e-03, PNorm = 69.1727, GNorm = 1.8868, lr_0 = 3.8019e-04
Loss = 1.6320e-03, PNorm = 69.1999, GNorm = 0.6003, lr_0 = 3.6789e-04
Loss = 1.7453e-03, PNorm = 69.2277, GNorm = 0.5879, lr_0 = 3.5598e-04
Validation rmse = 0.919868
Epoch 14
Loss = 1.2900e-03, PNorm = 69.2503, GNorm = 1.1739, lr_0 = 3.4446e-04
Loss = 1.4018e-03, PNorm = 69.2732, GNorm = 0.5478, lr_0 = 3.3332e-04
Validation rmse = 0.938759
Epoch 15
Loss = 1.5111e-03, PNorm = 69.2942, GNorm = 0.7704, lr_0 = 3.2253e-04
Loss = 1.3015e-03, PNorm = 69.3174, GNorm = 1.6981, lr_0 = 3.1209e-04
Loss = 1.1925e-03, PNorm = 69.3381, GNorm = 0.9456, lr_0 = 3.0200e-04
Validation rmse = 0.954880
Epoch 16
Loss = 1.2107e-03, PNorm = 69.3535, GNorm = 0.6190, lr_0 = 2.9222e-04
Loss = 1.1599e-03, PNorm = 69.3731, GNorm = 0.5964, lr_0 = 2.8277e-04
Validation rmse = 0.941338
Epoch 17
Loss = 8.7020e-04, PNorm = 69.3967, GNorm = 0.7616, lr_0 = 2.7272e-04
Loss = 1.2073e-03, PNorm = 69.4193, GNorm = 0.6032, lr_0 = 2.6389e-04
Loss = 1.1816e-03, PNorm = 69.4363, GNorm = 1.0232, lr_0 = 2.5535e-04
Validation rmse = 0.932946
Epoch 18
Loss = 9.9628e-04, PNorm = 69.4516, GNorm = 2.1067, lr_0 = 2.4709e-04
Loss = 1.4318e-03, PNorm = 69.4653, GNorm = 1.5506, lr_0 = 2.3910e-04
Loss = 1.6971e-03, PNorm = 69.4850, GNorm = 1.4825, lr_0 = 2.3136e-04
Validation rmse = 0.930218
Epoch 19
Loss = 1.2565e-03, PNorm = 69.5078, GNorm = 1.2056, lr_0 = 2.2387e-04
Loss = 1.0368e-03, PNorm = 69.5259, GNorm = 1.1753, lr_0 = 2.1663e-04
Validation rmse = 0.951289
Epoch 20
Loss = 9.8871e-04, PNorm = 69.5387, GNorm = 0.8213, lr_0 = 2.0962e-04
Loss = 9.9784e-04, PNorm = 69.5544, GNorm = 0.4834, lr_0 = 2.0283e-04
Loss = 1.1597e-03, PNorm = 69.5695, GNorm = 2.1319, lr_0 = 1.9627e-04
Validation rmse = 0.945333
Epoch 21
Loss = 8.6971e-04, PNorm = 69.5823, GNorm = 0.8036, lr_0 = 1.8992e-04
Loss = 9.9013e-04, PNorm = 69.5951, GNorm = 0.6833, lr_0 = 1.8377e-04
Validation rmse = 0.944226
Epoch 22
Loss = 9.2340e-04, PNorm = 69.6082, GNorm = 1.0335, lr_0 = 1.7783e-04
Loss = 8.2646e-04, PNorm = 69.6221, GNorm = 0.4101, lr_0 = 1.7207e-04
Loss = 1.0380e-03, PNorm = 69.6346, GNorm = 0.9643, lr_0 = 1.6651e-04
Validation rmse = 0.947723
Epoch 23
Loss = 9.3302e-04, PNorm = 69.6469, GNorm = 0.4979, lr_0 = 1.6059e-04
Loss = 8.4781e-04, PNorm = 69.6587, GNorm = 0.5702, lr_0 = 1.5539e-04
Validation rmse = 0.943303
Epoch 24
Loss = 7.0801e-04, PNorm = 69.6712, GNorm = 0.5972, lr_0 = 1.5036e-04
Loss = 9.8462e-04, PNorm = 69.6834, GNorm = 1.6200, lr_0 = 1.4550e-04
Loss = 8.1714e-04, PNorm = 69.6921, GNorm = 0.7963, lr_0 = 1.4079e-04
Validation rmse = 0.949740
Epoch 25
Loss = 6.9365e-04, PNorm = 69.7008, GNorm = 0.3871, lr_0 = 1.3623e-04
Loss = 8.4966e-04, PNorm = 69.7094, GNorm = 1.0325, lr_0 = 1.3183e-04
Loss = 8.2806e-04, PNorm = 69.7192, GNorm = 0.8290, lr_0 = 1.2756e-04
Validation rmse = 0.955477
Epoch 26
Loss = 8.4842e-04, PNorm = 69.7286, GNorm = 0.9545, lr_0 = 1.2343e-04
Loss = 7.7279e-04, PNorm = 69.7385, GNorm = 1.1127, lr_0 = 1.1944e-04
Validation rmse = 0.964268
Epoch 27
Loss = 1.0124e-03, PNorm = 69.7477, GNorm = 1.9296, lr_0 = 1.1557e-04
Loss = 7.7431e-04, PNorm = 69.7554, GNorm = 0.9548, lr_0 = 1.1183e-04
Loss = 7.9646e-04, PNorm = 69.7629, GNorm = 0.9117, lr_0 = 1.0821e-04
Validation rmse = 0.940030
Epoch 28
Loss = 8.1091e-04, PNorm = 69.7735, GNorm = 1.2141, lr_0 = 1.0437e-04
Loss = 6.7732e-04, PNorm = 69.7809, GNorm = 0.5679, lr_0 = 1.0099e-04
Validation rmse = 0.946928
Epoch 29
Loss = 4.4587e-04, PNorm = 69.7872, GNorm = 1.2308, lr_0 = 1.0000e-04
Loss = 7.5567e-04, PNorm = 69.7946, GNorm = 0.3456, lr_0 = 1.0000e-04
Loss = 8.1772e-04, PNorm = 69.8021, GNorm = 2.5941, lr_0 = 1.0000e-04
Validation rmse = 0.998829
Model 0 best validation rmse = 0.912885 on epoch 12
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.737344
Ensemble test rmse = 0.737344
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.05_ffn_num_layers_2_hidden_size_1400/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1400, bias=False)
      (W_h): Linear(in_features=1400, out_features=1400, bias=False)
      (W_o): Linear(in_features=1533, out_features=1400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1400, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 6,276,201
Moving model to cuda
Epoch 0
Loss = 1.6536e-02, PNorm = 67.3350, GNorm = 4.2478, lr_0 = 2.9800e-04
Loss = 1.1765e-02, PNorm = 67.3878, GNorm = 13.6752, lr_0 = 4.7800e-04
Validation rmse = 1.532547
Epoch 1
Loss = 7.3913e-03, PNorm = 67.4674, GNorm = 1.7053, lr_0 = 6.7600e-04
Loss = 7.8768e-03, PNorm = 67.5646, GNorm = 3.3714, lr_0 = 8.5600e-04
Loss = 7.3666e-03, PNorm = 67.6884, GNorm = 2.5750, lr_0 = 9.9344e-04
Validation rmse = 1.272382
Epoch 2
Loss = 6.8601e-03, PNorm = 67.8099, GNorm = 3.5723, lr_0 = 9.6130e-04
Loss = 4.4072e-03, PNorm = 67.9243, GNorm = 2.4336, lr_0 = 9.3019e-04
Validation rmse = 1.142467
Epoch 3
Loss = 4.3264e-03, PNorm = 68.0082, GNorm = 5.5221, lr_0 = 9.0009e-04
Loss = 4.3252e-03, PNorm = 68.0832, GNorm = 3.1301, lr_0 = 8.7096e-04
Loss = 3.1542e-03, PNorm = 68.1512, GNorm = 1.0399, lr_0 = 8.4278e-04
Validation rmse = 1.251754
Epoch 4
Loss = 3.5308e-03, PNorm = 68.2074, GNorm = 1.5662, lr_0 = 8.1551e-04
Loss = 4.1138e-03, PNorm = 68.2670, GNorm = 2.1379, lr_0 = 7.8912e-04
Validation rmse = 1.014224
Epoch 5
Loss = 3.0940e-03, PNorm = 68.3258, GNorm = 2.3848, lr_0 = 7.6358e-04
Loss = 3.7380e-03, PNorm = 68.3807, GNorm = 1.5312, lr_0 = 7.3888e-04
Loss = 2.9355e-03, PNorm = 68.4310, GNorm = 3.2062, lr_0 = 7.1497e-04
Validation rmse = 1.128910
Epoch 6
Loss = 2.5626e-03, PNorm = 68.4891, GNorm = 1.5787, lr_0 = 6.8956e-04
Loss = 2.6671e-03, PNorm = 68.5336, GNorm = 2.8216, lr_0 = 6.6725e-04
Loss = 2.0420e-03, PNorm = 68.5691, GNorm = 4.3732, lr_0 = 6.4565e-04
Validation rmse = 0.883731
Epoch 7
Loss = 1.9427e-03, PNorm = 68.6132, GNorm = 0.9887, lr_0 = 6.2476e-04
Loss = 2.0486e-03, PNorm = 68.6463, GNorm = 1.8263, lr_0 = 6.0454e-04
Validation rmse = 0.899805
Epoch 8
Loss = 2.3479e-03, PNorm = 68.6859, GNorm = 0.5854, lr_0 = 5.8498e-04
Loss = 2.0384e-03, PNorm = 68.7302, GNorm = 1.5826, lr_0 = 5.6605e-04
Loss = 1.9208e-03, PNorm = 68.7623, GNorm = 1.4526, lr_0 = 5.4774e-04
Validation rmse = 0.856146
Epoch 9
Loss = 1.4730e-03, PNorm = 68.7942, GNorm = 1.0212, lr_0 = 5.3001e-04
Loss = 1.6923e-03, PNorm = 68.8248, GNorm = 1.5901, lr_0 = 5.1286e-04
Validation rmse = 0.836359
Epoch 10
Loss = 1.4817e-03, PNorm = 68.8634, GNorm = 1.1222, lr_0 = 4.9627e-04
Loss = 1.7661e-03, PNorm = 68.8911, GNorm = 1.3319, lr_0 = 4.8021e-04
Loss = 1.7619e-03, PNorm = 68.9164, GNorm = 0.9105, lr_0 = 4.6467e-04
Validation rmse = 0.909843
Epoch 11
Loss = 1.6355e-03, PNorm = 68.9525, GNorm = 1.7888, lr_0 = 4.4963e-04
Loss = 1.7139e-03, PNorm = 68.9828, GNorm = 2.1989, lr_0 = 4.3508e-04
Validation rmse = 0.811229
Epoch 12
Loss = 8.7861e-04, PNorm = 69.0102, GNorm = 0.4295, lr_0 = 4.1962e-04
Loss = 1.4752e-03, PNorm = 69.0357, GNorm = 2.1655, lr_0 = 4.0604e-04
Loss = 1.3532e-03, PNorm = 69.0556, GNorm = 1.3628, lr_0 = 3.9290e-04
Validation rmse = 0.811099
Epoch 13
Loss = 1.3437e-03, PNorm = 69.0780, GNorm = 2.3757, lr_0 = 3.8019e-04
Loss = 1.1694e-03, PNorm = 69.1084, GNorm = 1.3158, lr_0 = 3.6789e-04
Loss = 1.4637e-03, PNorm = 69.1300, GNorm = 1.7594, lr_0 = 3.5598e-04
Validation rmse = 0.796476
Epoch 14
Loss = 1.3577e-03, PNorm = 69.1548, GNorm = 1.7569, lr_0 = 3.4446e-04
Loss = 1.1150e-03, PNorm = 69.1788, GNorm = 0.3522, lr_0 = 3.3332e-04
Validation rmse = 0.931432
Epoch 15
Loss = 1.6300e-03, PNorm = 69.1963, GNorm = 0.4355, lr_0 = 3.2253e-04
Loss = 1.3868e-03, PNorm = 69.2192, GNorm = 0.4965, lr_0 = 3.1209e-04
Loss = 1.1534e-03, PNorm = 69.2393, GNorm = 0.5638, lr_0 = 3.0200e-04
Validation rmse = 0.856741
Epoch 16
Loss = 1.1100e-03, PNorm = 69.2542, GNorm = 0.8162, lr_0 = 2.9222e-04
Loss = 1.1276e-03, PNorm = 69.2708, GNorm = 0.4920, lr_0 = 2.8277e-04
Validation rmse = 0.764237
Epoch 17
Loss = 9.1755e-04, PNorm = 69.2946, GNorm = 0.7301, lr_0 = 2.7272e-04
Loss = 9.9345e-04, PNorm = 69.3105, GNorm = 0.4452, lr_0 = 2.6389e-04
Loss = 9.0354e-04, PNorm = 69.3250, GNorm = 0.6342, lr_0 = 2.5535e-04
Validation rmse = 0.749373
Epoch 18
Loss = 1.1042e-03, PNorm = 69.3426, GNorm = 0.8430, lr_0 = 2.4709e-04
Loss = 1.0958e-03, PNorm = 69.3574, GNorm = 1.6675, lr_0 = 2.3910e-04
Loss = 9.7363e-04, PNorm = 69.3727, GNorm = 0.8352, lr_0 = 2.3136e-04
Validation rmse = 0.754522
Epoch 19
Loss = 1.0820e-03, PNorm = 69.3876, GNorm = 0.7180, lr_0 = 2.2387e-04
Loss = 1.0512e-03, PNorm = 69.4012, GNorm = 0.5465, lr_0 = 2.1663e-04
Validation rmse = 0.733957
Epoch 20
Loss = 5.4764e-04, PNorm = 69.4150, GNorm = 0.4520, lr_0 = 2.0962e-04
Loss = 1.1005e-03, PNorm = 69.4265, GNorm = 1.2485, lr_0 = 2.0283e-04
Loss = 8.9362e-04, PNorm = 69.4385, GNorm = 0.7508, lr_0 = 1.9627e-04
Validation rmse = 0.809702
Epoch 21
Loss = 9.9998e-04, PNorm = 69.4503, GNorm = 1.1971, lr_0 = 1.8992e-04
Loss = 1.1118e-03, PNorm = 69.4662, GNorm = 1.1762, lr_0 = 1.8377e-04
Validation rmse = 0.759561
Epoch 22
Loss = 5.8030e-04, PNorm = 69.4796, GNorm = 0.3191, lr_0 = 1.7783e-04
Loss = 7.6881e-04, PNorm = 69.4925, GNorm = 1.3654, lr_0 = 1.7207e-04
Loss = 9.1211e-04, PNorm = 69.5018, GNorm = 0.6567, lr_0 = 1.6651e-04
Validation rmse = 0.752144
Epoch 23
Loss = 9.6623e-04, PNorm = 69.5104, GNorm = 0.9474, lr_0 = 1.6059e-04
Loss = 8.8214e-04, PNorm = 69.5222, GNorm = 1.7510, lr_0 = 1.5539e-04
Validation rmse = 0.769482
Epoch 24
Loss = 9.7028e-04, PNorm = 69.5342, GNorm = 1.7523, lr_0 = 1.5036e-04
Loss = 1.0529e-03, PNorm = 69.5445, GNorm = 2.7734, lr_0 = 1.4550e-04
Loss = 1.1356e-03, PNorm = 69.5546, GNorm = 2.7586, lr_0 = 1.4079e-04
Validation rmse = 0.778793
Epoch 25
Loss = 8.4094e-04, PNorm = 69.5646, GNorm = 1.8138, lr_0 = 1.3623e-04
Loss = 8.6499e-04, PNorm = 69.5735, GNorm = 1.9513, lr_0 = 1.3183e-04
Loss = 8.9406e-04, PNorm = 69.5820, GNorm = 1.8160, lr_0 = 1.2756e-04
Validation rmse = 0.730026
Epoch 26
Loss = 8.5200e-04, PNorm = 69.5919, GNorm = 1.3641, lr_0 = 1.2343e-04
Loss = 7.4060e-04, PNorm = 69.6001, GNorm = 1.0988, lr_0 = 1.1944e-04
Validation rmse = 0.749161
Epoch 27
Loss = 8.5824e-04, PNorm = 69.6064, GNorm = 1.7160, lr_0 = 1.1557e-04
Loss = 8.1496e-04, PNorm = 69.6132, GNorm = 1.0107, lr_0 = 1.1183e-04
Loss = 7.1001e-04, PNorm = 69.6208, GNorm = 0.9653, lr_0 = 1.0821e-04
Validation rmse = 0.764630
Epoch 28
Loss = 8.2015e-04, PNorm = 69.6277, GNorm = 1.0725, lr_0 = 1.0437e-04
Loss = 7.2354e-04, PNorm = 69.6338, GNorm = 0.7893, lr_0 = 1.0099e-04
Validation rmse = 0.752227
Epoch 29
Loss = 7.3018e-04, PNorm = 69.6406, GNorm = 0.9249, lr_0 = 1.0000e-04
Loss = 7.5755e-04, PNorm = 69.6471, GNorm = 0.6562, lr_0 = 1.0000e-04
Loss = 6.8818e-04, PNorm = 69.6521, GNorm = 1.2098, lr_0 = 1.0000e-04
Validation rmse = 0.749865
Model 0 best validation rmse = 0.730026 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.679503
Ensemble test rmse = 0.679503
10-fold cross validation
	Seed 0 ==> test rmse = 0.718065
	Seed 1 ==> test rmse = 0.644551
	Seed 2 ==> test rmse = 0.678781
	Seed 3 ==> test rmse = 0.851190
	Seed 4 ==> test rmse = 1.016475
	Seed 5 ==> test rmse = 0.685527
	Seed 6 ==> test rmse = 0.738725
	Seed 7 ==> test rmse = 0.691098
	Seed 8 ==> test rmse = 0.737344
	Seed 9 ==> test rmse = 0.679503
Overall test rmse = 0.744126 +/- 0.105356
Elapsed time = 0:08:16
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1500,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_1_hidden_size_1500/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1500, bias=False)
      (W_h): Linear(in_features=1500, out_features=1500, bias=False)
      (W_o): Linear(in_features=1633, out_features=1500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1, bias=True)
  )
)
Number of parameters = 4,923,001
Moving model to cuda
Epoch 0
Loss = 1.9659e-02, PNorm = 57.7403, GNorm = 2.5462, lr_0 = 2.9800e-04
Loss = 1.3572e-02, PNorm = 57.7790, GNorm = 2.2227, lr_0 = 4.7800e-04
Validation rmse = 1.290110
Epoch 1
Loss = 7.9355e-03, PNorm = 57.8441, GNorm = 1.6503, lr_0 = 6.7600e-04
Loss = 1.0839e-02, PNorm = 57.9131, GNorm = 4.8505, lr_0 = 8.5600e-04
Loss = 8.0889e-03, PNorm = 57.9994, GNorm = 1.5609, lr_0 = 9.9344e-04
Validation rmse = 1.623924
Epoch 2
Loss = 8.1025e-03, PNorm = 58.0845, GNorm = 3.3043, lr_0 = 9.6130e-04
Loss = 6.4028e-03, PNorm = 58.1577, GNorm = 2.1667, lr_0 = 9.3019e-04
Validation rmse = 1.284878
Epoch 3
Loss = 5.5923e-03, PNorm = 58.2221, GNorm = 2.2801, lr_0 = 9.0009e-04
Loss = 5.3158e-03, PNorm = 58.2816, GNorm = 2.0619, lr_0 = 8.7096e-04
Loss = 4.1884e-03, PNorm = 58.3304, GNorm = 1.0357, lr_0 = 8.4278e-04
Validation rmse = 1.070655
Epoch 4
Loss = 3.7418e-03, PNorm = 58.3795, GNorm = 0.5975, lr_0 = 8.1551e-04
Loss = 4.1662e-03, PNorm = 58.4228, GNorm = 3.1462, lr_0 = 7.8912e-04
Validation rmse = 1.372426
Epoch 5
Loss = 6.7821e-03, PNorm = 58.4665, GNorm = 5.4939, lr_0 = 7.6358e-04
Loss = 4.7157e-03, PNorm = 58.5258, GNorm = 2.2060, lr_0 = 7.3888e-04
Loss = 4.0016e-03, PNorm = 58.5755, GNorm = 1.0830, lr_0 = 7.1497e-04
Validation rmse = 1.050980
Epoch 6
Loss = 3.3995e-03, PNorm = 58.6226, GNorm = 1.0105, lr_0 = 6.8956e-04
Loss = 3.7662e-03, PNorm = 58.6625, GNorm = 0.5967, lr_0 = 6.6725e-04
Loss = 3.3542e-03, PNorm = 58.6974, GNorm = 0.9526, lr_0 = 6.4565e-04
Validation rmse = 0.980445
Epoch 7
Loss = 2.6856e-03, PNorm = 58.7310, GNorm = 1.8438, lr_0 = 6.2476e-04
Loss = 3.1776e-03, PNorm = 58.7642, GNorm = 0.7661, lr_0 = 6.0454e-04
Validation rmse = 0.963556
Epoch 8
Loss = 2.3783e-03, PNorm = 58.8000, GNorm = 0.7322, lr_0 = 5.8498e-04
Loss = 3.1160e-03, PNorm = 58.8223, GNorm = 3.4724, lr_0 = 5.6605e-04
Loss = 2.6421e-03, PNorm = 58.8564, GNorm = 0.7979, lr_0 = 5.4774e-04
Validation rmse = 0.938888
Epoch 9
Loss = 2.1924e-03, PNorm = 58.8884, GNorm = 0.9262, lr_0 = 5.3001e-04
Loss = 2.5180e-03, PNorm = 58.9139, GNorm = 2.7252, lr_0 = 5.1286e-04
Validation rmse = 0.901902
Epoch 10
Loss = 2.3564e-03, PNorm = 58.9403, GNorm = 0.7170, lr_0 = 4.9627e-04
Loss = 2.2719e-03, PNorm = 58.9721, GNorm = 1.6214, lr_0 = 4.8021e-04
Loss = 2.5397e-03, PNorm = 58.9964, GNorm = 1.1643, lr_0 = 4.6467e-04
Validation rmse = 0.913381
Epoch 11
Loss = 2.1326e-03, PNorm = 59.0174, GNorm = 0.7985, lr_0 = 4.4963e-04
Loss = 1.9413e-03, PNorm = 59.0406, GNorm = 0.4495, lr_0 = 4.3508e-04
Validation rmse = 0.930155
Epoch 12
Loss = 2.1311e-03, PNorm = 59.0682, GNorm = 0.5321, lr_0 = 4.1962e-04
Loss = 2.0257e-03, PNorm = 59.0880, GNorm = 0.8259, lr_0 = 4.0604e-04
Loss = 2.0487e-03, PNorm = 59.1101, GNorm = 1.9666, lr_0 = 3.9290e-04
Validation rmse = 0.868495
Epoch 13
Loss = 1.8174e-03, PNorm = 59.1322, GNorm = 1.0308, lr_0 = 3.8019e-04
Loss = 2.4098e-03, PNorm = 59.1537, GNorm = 2.0987, lr_0 = 3.6789e-04
Loss = 2.3493e-03, PNorm = 59.1765, GNorm = 2.9988, lr_0 = 3.5598e-04
Validation rmse = 0.912211
Epoch 14
Loss = 1.8719e-03, PNorm = 59.1933, GNorm = 0.5851, lr_0 = 3.4446e-04
Loss = 1.5769e-03, PNorm = 59.2130, GNorm = 1.2929, lr_0 = 3.3332e-04
Validation rmse = 0.879650
Epoch 15
Loss = 1.6878e-03, PNorm = 59.2280, GNorm = 1.6618, lr_0 = 3.2253e-04
Loss = 2.0860e-03, PNorm = 59.2415, GNorm = 1.8442, lr_0 = 3.1209e-04
Loss = 1.5624e-03, PNorm = 59.2619, GNorm = 0.8123, lr_0 = 3.0200e-04
Validation rmse = 0.910395
Epoch 16
Loss = 1.6473e-03, PNorm = 59.2783, GNorm = 0.7277, lr_0 = 2.9222e-04
Loss = 1.8775e-03, PNorm = 59.2982, GNorm = 1.4851, lr_0 = 2.8277e-04
Validation rmse = 0.865579
Epoch 17
Loss = 1.6971e-03, PNorm = 59.3118, GNorm = 2.1632, lr_0 = 2.7272e-04
Loss = 1.4412e-03, PNorm = 59.3259, GNorm = 0.9029, lr_0 = 2.6389e-04
Loss = 1.6123e-03, PNorm = 59.3400, GNorm = 0.6229, lr_0 = 2.5535e-04
Validation rmse = 0.863836
Epoch 18
Loss = 1.9314e-03, PNorm = 59.3507, GNorm = 1.5362, lr_0 = 2.4709e-04
Loss = 1.4366e-03, PNorm = 59.3633, GNorm = 0.7999, lr_0 = 2.3910e-04
Loss = 1.5307e-03, PNorm = 59.3741, GNorm = 1.6284, lr_0 = 2.3136e-04
Validation rmse = 0.832586
Epoch 19
Loss = 1.5388e-03, PNorm = 59.3886, GNorm = 1.0062, lr_0 = 2.2387e-04
Loss = 1.6156e-03, PNorm = 59.4004, GNorm = 1.0104, lr_0 = 2.1663e-04
Validation rmse = 0.905427
Epoch 20
Loss = 1.2487e-03, PNorm = 59.4113, GNorm = 1.2153, lr_0 = 2.0962e-04
Loss = 1.6124e-03, PNorm = 59.4194, GNorm = 0.4306, lr_0 = 2.0283e-04
Loss = 1.6400e-03, PNorm = 59.4302, GNorm = 0.7842, lr_0 = 1.9627e-04
Validation rmse = 0.876159
Epoch 21
Loss = 1.4066e-03, PNorm = 59.4420, GNorm = 0.7367, lr_0 = 1.8992e-04
Loss = 1.4806e-03, PNorm = 59.4490, GNorm = 1.7967, lr_0 = 1.8377e-04
Validation rmse = 0.871580
Epoch 22
Loss = 1.3942e-03, PNorm = 59.4597, GNorm = 1.6498, lr_0 = 1.7783e-04
Loss = 1.2400e-03, PNorm = 59.4707, GNorm = 0.6523, lr_0 = 1.7207e-04
Loss = 1.3131e-03, PNorm = 59.4783, GNorm = 0.7801, lr_0 = 1.6651e-04
Validation rmse = 0.871203
Epoch 23
Loss = 1.3482e-03, PNorm = 59.4870, GNorm = 0.7616, lr_0 = 1.6059e-04
Loss = 1.3260e-03, PNorm = 59.4937, GNorm = 1.2977, lr_0 = 1.5539e-04
Validation rmse = 0.841385
Epoch 24
Loss = 1.3143e-03, PNorm = 59.5011, GNorm = 1.8298, lr_0 = 1.5036e-04
Loss = 1.2420e-03, PNorm = 59.5099, GNorm = 0.6523, lr_0 = 1.4550e-04
Loss = 1.3178e-03, PNorm = 59.5177, GNorm = 1.2414, lr_0 = 1.4079e-04
Validation rmse = 0.881638
Epoch 25
Loss = 1.3482e-03, PNorm = 59.5237, GNorm = 1.2019, lr_0 = 1.3623e-04
Loss = 1.3388e-03, PNorm = 59.5310, GNorm = 0.9607, lr_0 = 1.3183e-04
Loss = 1.3498e-03, PNorm = 59.5365, GNorm = 0.7830, lr_0 = 1.2756e-04
Validation rmse = 0.842071
Epoch 26
Loss = 1.0256e-03, PNorm = 59.5431, GNorm = 0.3964, lr_0 = 1.2343e-04
Loss = 1.2839e-03, PNorm = 59.5487, GNorm = 0.7824, lr_0 = 1.1944e-04
Validation rmse = 0.826302
Epoch 27
Loss = 1.1642e-03, PNorm = 59.5545, GNorm = 1.3069, lr_0 = 1.1557e-04
Loss = 1.2294e-03, PNorm = 59.5614, GNorm = 0.8106, lr_0 = 1.1183e-04
Loss = 1.2372e-03, PNorm = 59.5664, GNorm = 0.5824, lr_0 = 1.0821e-04
Validation rmse = 0.844048
Epoch 28
Loss = 1.3673e-03, PNorm = 59.5718, GNorm = 1.7425, lr_0 = 1.0437e-04
Loss = 1.0414e-03, PNorm = 59.5771, GNorm = 1.4847, lr_0 = 1.0099e-04
Validation rmse = 0.827269
Epoch 29
Loss = 1.4043e-03, PNorm = 59.5812, GNorm = 0.4978, lr_0 = 1.0000e-04
Loss = 1.1992e-03, PNorm = 59.5854, GNorm = 1.2638, lr_0 = 1.0000e-04
Loss = 1.4394e-03, PNorm = 59.5904, GNorm = 1.8183, lr_0 = 1.0000e-04
Validation rmse = 0.829878
Model 0 best validation rmse = 0.826302 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.765903
Ensemble test rmse = 0.765903
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1500,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_1_hidden_size_1500/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1500, bias=False)
      (W_h): Linear(in_features=1500, out_features=1500, bias=False)
      (W_o): Linear(in_features=1633, out_features=1500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1, bias=True)
  )
)
Number of parameters = 4,923,001
Moving model to cuda
Epoch 0
Loss = 1.8955e-02, PNorm = 57.7423, GNorm = 26.2797, lr_0 = 2.9800e-04
Loss = 1.3679e-02, PNorm = 57.7775, GNorm = 4.2499, lr_0 = 4.7800e-04
Validation rmse = 1.956268
Epoch 1
Loss = 1.1824e-02, PNorm = 57.8452, GNorm = 7.2216, lr_0 = 6.7600e-04
Loss = 9.3336e-03, PNorm = 57.9267, GNorm = 1.3346, lr_0 = 8.5600e-04
Loss = 6.8139e-03, PNorm = 58.0025, GNorm = 1.3838, lr_0 = 9.9344e-04
Validation rmse = 1.337757
Epoch 2
Loss = 5.8552e-03, PNorm = 58.0692, GNorm = 2.7181, lr_0 = 9.6130e-04
Loss = 6.0158e-03, PNorm = 58.1333, GNorm = 1.1005, lr_0 = 9.3019e-04
Validation rmse = 1.272970
Epoch 3
Loss = 5.4303e-03, PNorm = 58.1942, GNorm = 2.8846, lr_0 = 9.0009e-04
Loss = 5.3970e-03, PNorm = 58.2567, GNorm = 2.4358, lr_0 = 8.7096e-04
Loss = 4.2709e-03, PNorm = 58.3182, GNorm = 3.2141, lr_0 = 8.4278e-04
Validation rmse = 1.024915
Epoch 4
Loss = 4.8277e-03, PNorm = 58.3653, GNorm = 3.2894, lr_0 = 8.1551e-04
Loss = 3.1862e-03, PNorm = 58.4167, GNorm = 0.6927, lr_0 = 7.8912e-04
Validation rmse = 0.914853
Epoch 5
Loss = 2.5957e-03, PNorm = 58.4631, GNorm = 1.2337, lr_0 = 7.6358e-04
Loss = 4.4644e-03, PNorm = 58.5049, GNorm = 4.7856, lr_0 = 7.3888e-04
Loss = 3.7930e-03, PNorm = 58.5518, GNorm = 2.7759, lr_0 = 7.1497e-04
Validation rmse = 0.958261
Epoch 6
Loss = 3.6711e-03, PNorm = 58.5958, GNorm = 0.5648, lr_0 = 6.8956e-04
Loss = 3.1644e-03, PNorm = 58.6405, GNorm = 0.7589, lr_0 = 6.6725e-04
Loss = 3.0533e-03, PNorm = 58.6745, GNorm = 1.8106, lr_0 = 6.4565e-04
Validation rmse = 0.889201
Epoch 7
Loss = 3.0801e-03, PNorm = 58.7135, GNorm = 2.3729, lr_0 = 6.2476e-04
Loss = 3.0068e-03, PNorm = 58.7444, GNorm = 3.0908, lr_0 = 6.0454e-04
Validation rmse = 0.960911
Epoch 8
Loss = 3.4779e-03, PNorm = 58.7838, GNorm = 3.3433, lr_0 = 5.8498e-04
Loss = 2.8393e-03, PNorm = 58.8170, GNorm = 1.9617, lr_0 = 5.6605e-04
Loss = 2.2915e-03, PNorm = 58.8471, GNorm = 0.6857, lr_0 = 5.4774e-04
Validation rmse = 0.824292
Epoch 9
Loss = 2.3701e-03, PNorm = 58.8766, GNorm = 2.6176, lr_0 = 5.3001e-04
Loss = 2.4246e-03, PNorm = 58.9121, GNorm = 1.2817, lr_0 = 5.1286e-04
Validation rmse = 0.861825
Epoch 10
Loss = 2.7679e-03, PNorm = 58.9360, GNorm = 3.0042, lr_0 = 4.9627e-04
Loss = 3.3979e-03, PNorm = 58.9626, GNorm = 3.0437, lr_0 = 4.8021e-04
Loss = 2.5446e-03, PNorm = 58.9930, GNorm = 2.3544, lr_0 = 4.6467e-04
Validation rmse = 0.931948
Epoch 11
Loss = 2.7794e-03, PNorm = 59.0227, GNorm = 1.1347, lr_0 = 4.4963e-04
Loss = 2.5692e-03, PNorm = 59.0470, GNorm = 0.8416, lr_0 = 4.3508e-04
Validation rmse = 0.812219
Epoch 12
Loss = 2.4752e-03, PNorm = 59.0747, GNorm = 1.2352, lr_0 = 4.1962e-04
Loss = 2.2858e-03, PNorm = 59.1005, GNorm = 1.5778, lr_0 = 4.0604e-04
Loss = 2.7800e-03, PNorm = 59.1241, GNorm = 1.1664, lr_0 = 3.9290e-04
Validation rmse = 0.982284
Epoch 13
Loss = 2.2904e-03, PNorm = 59.1472, GNorm = 0.7634, lr_0 = 3.8019e-04
Loss = 2.7942e-03, PNorm = 59.1704, GNorm = 2.9466, lr_0 = 3.6789e-04
Loss = 2.2867e-03, PNorm = 59.1892, GNorm = 0.7190, lr_0 = 3.5598e-04
Validation rmse = 0.787112
Epoch 14
Loss = 2.0280e-03, PNorm = 59.2105, GNorm = 1.0328, lr_0 = 3.4446e-04
Loss = 1.6921e-03, PNorm = 59.2280, GNorm = 1.8602, lr_0 = 3.3332e-04
Validation rmse = 0.788619
Epoch 15
Loss = 1.7060e-03, PNorm = 59.2438, GNorm = 1.0623, lr_0 = 3.2253e-04
Loss = 1.8830e-03, PNorm = 59.2578, GNorm = 2.4908, lr_0 = 3.1209e-04
Loss = 2.3342e-03, PNorm = 59.2736, GNorm = 2.4920, lr_0 = 3.0200e-04
Validation rmse = 0.856510
Epoch 16
Loss = 2.4868e-03, PNorm = 59.2938, GNorm = 2.0441, lr_0 = 2.9222e-04
Loss = 1.5089e-03, PNorm = 59.3092, GNorm = 1.1246, lr_0 = 2.8277e-04
Validation rmse = 0.784365
Epoch 17
Loss = 1.4878e-03, PNorm = 59.3242, GNorm = 0.5724, lr_0 = 2.7272e-04
Loss = 1.8596e-03, PNorm = 59.3360, GNorm = 0.6943, lr_0 = 2.6389e-04
Loss = 1.7829e-03, PNorm = 59.3503, GNorm = 1.4921, lr_0 = 2.5535e-04
Validation rmse = 0.758854
Epoch 18
Loss = 1.5613e-03, PNorm = 59.3629, GNorm = 1.9148, lr_0 = 2.4709e-04
Loss = 1.6830e-03, PNorm = 59.3741, GNorm = 1.1699, lr_0 = 2.3910e-04
Loss = 1.6332e-03, PNorm = 59.3879, GNorm = 1.7751, lr_0 = 2.3136e-04
Validation rmse = 0.747215
Epoch 19
Loss = 1.7384e-03, PNorm = 59.3988, GNorm = 0.6979, lr_0 = 2.2387e-04
Loss = 1.5182e-03, PNorm = 59.4106, GNorm = 0.6340, lr_0 = 2.1663e-04
Validation rmse = 0.721065
Epoch 20
Loss = 1.2555e-03, PNorm = 59.4213, GNorm = 0.5454, lr_0 = 2.0962e-04
Loss = 1.8024e-03, PNorm = 59.4320, GNorm = 0.6369, lr_0 = 2.0283e-04
Loss = 1.5351e-03, PNorm = 59.4402, GNorm = 0.7342, lr_0 = 1.9627e-04
Validation rmse = 0.768366
Epoch 21
Loss = 1.4693e-03, PNorm = 59.4501, GNorm = 0.8177, lr_0 = 1.8992e-04
Loss = 1.6568e-03, PNorm = 59.4596, GNorm = 1.3671, lr_0 = 1.8377e-04
Validation rmse = 0.710116
Epoch 22
Loss = 1.1517e-03, PNorm = 59.4712, GNorm = 0.9919, lr_0 = 1.7783e-04
Loss = 1.5671e-03, PNorm = 59.4787, GNorm = 1.5009, lr_0 = 1.7207e-04
Loss = 1.4527e-03, PNorm = 59.4870, GNorm = 1.4043, lr_0 = 1.6651e-04
Validation rmse = 0.739880
Epoch 23
Loss = 1.3282e-03, PNorm = 59.4963, GNorm = 0.9572, lr_0 = 1.6059e-04
Loss = 1.4559e-03, PNorm = 59.5057, GNorm = 0.9311, lr_0 = 1.5539e-04
Validation rmse = 0.823914
Epoch 24
Loss = 1.3887e-03, PNorm = 59.5140, GNorm = 1.6960, lr_0 = 1.5036e-04
Loss = 1.7943e-03, PNorm = 59.5220, GNorm = 2.2736, lr_0 = 1.4550e-04
Loss = 1.5809e-03, PNorm = 59.5303, GNorm = 0.8682, lr_0 = 1.4079e-04
Validation rmse = 0.714327
Epoch 25
Loss = 1.2840e-03, PNorm = 59.5370, GNorm = 0.6919, lr_0 = 1.3623e-04
Loss = 1.4749e-03, PNorm = 59.5433, GNorm = 1.0295, lr_0 = 1.3183e-04
Loss = 1.5047e-03, PNorm = 59.5516, GNorm = 0.4582, lr_0 = 1.2756e-04
Validation rmse = 0.707008
Epoch 26
Loss = 1.4272e-03, PNorm = 59.5578, GNorm = 0.7413, lr_0 = 1.2343e-04
Loss = 1.4283e-03, PNorm = 59.5646, GNorm = 1.0667, lr_0 = 1.1944e-04
Validation rmse = 0.708623
Epoch 27
Loss = 1.5625e-03, PNorm = 59.5701, GNorm = 0.5243, lr_0 = 1.1557e-04
Loss = 1.3555e-03, PNorm = 59.5774, GNorm = 1.9263, lr_0 = 1.1183e-04
Loss = 1.3705e-03, PNorm = 59.5833, GNorm = 0.3784, lr_0 = 1.0821e-04
Validation rmse = 0.729980
Epoch 28
Loss = 1.5375e-03, PNorm = 59.5891, GNorm = 1.0473, lr_0 = 1.0437e-04
Loss = 1.1628e-03, PNorm = 59.5921, GNorm = 0.4359, lr_0 = 1.0099e-04
Validation rmse = 0.754123
Epoch 29
Loss = 1.3578e-03, PNorm = 59.5950, GNorm = 2.0400, lr_0 = 1.0000e-04
Loss = 1.4115e-03, PNorm = 59.6013, GNorm = 1.5170, lr_0 = 1.0000e-04
Loss = 1.4538e-03, PNorm = 59.6063, GNorm = 0.4197, lr_0 = 1.0000e-04
Validation rmse = 0.734663
Model 0 best validation rmse = 0.707008 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.666604
Ensemble test rmse = 0.666604
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1500,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_1_hidden_size_1500/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1500, bias=False)
      (W_h): Linear(in_features=1500, out_features=1500, bias=False)
      (W_o): Linear(in_features=1633, out_features=1500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1, bias=True)
  )
)
Number of parameters = 4,923,001
Moving model to cuda
Epoch 0
Loss = 1.9499e-02, PNorm = 57.7414, GNorm = 5.1403, lr_0 = 2.9800e-04
Loss = 1.1917e-02, PNorm = 57.7789, GNorm = 7.3217, lr_0 = 4.7800e-04
Validation rmse = 1.294303
Epoch 1
Loss = 8.5160e-03, PNorm = 57.8448, GNorm = 8.6577, lr_0 = 6.7600e-04
Loss = 7.2407e-03, PNorm = 57.9084, GNorm = 2.1157, lr_0 = 8.5600e-04
Loss = 8.5460e-03, PNorm = 57.9874, GNorm = 1.3576, lr_0 = 9.9344e-04
Validation rmse = 1.234190
Epoch 2
Loss = 7.5704e-03, PNorm = 58.0756, GNorm = 3.9595, lr_0 = 9.6130e-04
Loss = 6.6941e-03, PNorm = 58.1496, GNorm = 1.2692, lr_0 = 9.3019e-04
Validation rmse = 1.020882
Epoch 3
Loss = 4.9858e-03, PNorm = 58.2173, GNorm = 3.5577, lr_0 = 9.0009e-04
Loss = 4.8059e-03, PNorm = 58.2766, GNorm = 2.2143, lr_0 = 8.7096e-04
Loss = 4.5474e-03, PNorm = 58.3336, GNorm = 1.3802, lr_0 = 8.4278e-04
Validation rmse = 0.969642
Epoch 4
Loss = 4.5493e-03, PNorm = 58.3879, GNorm = 2.9097, lr_0 = 8.1551e-04
Loss = 5.3042e-03, PNorm = 58.4440, GNorm = 5.8054, lr_0 = 7.8912e-04
Validation rmse = 0.957969
Epoch 5
Loss = 3.4832e-03, PNorm = 58.5009, GNorm = 0.6769, lr_0 = 7.6358e-04
Loss = 4.4260e-03, PNorm = 58.5566, GNorm = 2.5533, lr_0 = 7.3888e-04
Loss = 3.6510e-03, PNorm = 58.6034, GNorm = 1.6235, lr_0 = 7.1497e-04
Validation rmse = 0.808422
Epoch 6
Loss = 3.4433e-03, PNorm = 58.6460, GNorm = 1.6628, lr_0 = 6.8956e-04
Loss = 3.1760e-03, PNorm = 58.6863, GNorm = 2.1871, lr_0 = 6.6725e-04
Loss = 3.5616e-03, PNorm = 58.7245, GNorm = 1.3379, lr_0 = 6.4565e-04
Validation rmse = 0.825561
Epoch 7
Loss = 2.7899e-03, PNorm = 58.7619, GNorm = 1.5363, lr_0 = 6.2476e-04
Loss = 2.8933e-03, PNorm = 58.7983, GNorm = 1.3552, lr_0 = 6.0454e-04
Validation rmse = 0.724718
Epoch 8
Loss = 2.9556e-03, PNorm = 58.8371, GNorm = 0.4554, lr_0 = 5.8498e-04
Loss = 2.4340e-03, PNorm = 58.8666, GNorm = 1.6616, lr_0 = 5.6605e-04
Loss = 2.5010e-03, PNorm = 58.8954, GNorm = 2.2943, lr_0 = 5.4774e-04
Validation rmse = 0.727812
Epoch 9
Loss = 2.5551e-03, PNorm = 58.9261, GNorm = 1.6958, lr_0 = 5.3001e-04
Loss = 2.6046e-03, PNorm = 58.9559, GNorm = 1.8659, lr_0 = 5.1286e-04
Validation rmse = 0.702786
Epoch 10
Loss = 2.4022e-03, PNorm = 58.9807, GNorm = 1.7223, lr_0 = 4.9627e-04
Loss = 2.1462e-03, PNorm = 59.0033, GNorm = 0.8962, lr_0 = 4.8021e-04
Loss = 2.6458e-03, PNorm = 59.0372, GNorm = 1.7946, lr_0 = 4.6467e-04
Validation rmse = 0.718420
Epoch 11
Loss = 2.3528e-03, PNorm = 59.0617, GNorm = 1.9866, lr_0 = 4.4963e-04
Loss = 2.2866e-03, PNorm = 59.0853, GNorm = 1.3579, lr_0 = 4.3508e-04
Validation rmse = 0.669755
Epoch 12
Loss = 1.5568e-03, PNorm = 59.1117, GNorm = 0.5311, lr_0 = 4.1962e-04
Loss = 2.1749e-03, PNorm = 59.1303, GNorm = 3.3293, lr_0 = 4.0604e-04
Loss = 1.9462e-03, PNorm = 59.1498, GNorm = 1.2052, lr_0 = 3.9290e-04
Validation rmse = 0.656878
Epoch 13
Loss = 1.9884e-03, PNorm = 59.1709, GNorm = 0.7902, lr_0 = 3.8019e-04
Loss = 2.3579e-03, PNorm = 59.1923, GNorm = 4.4052, lr_0 = 3.6789e-04
Loss = 2.8443e-03, PNorm = 59.2154, GNorm = 1.4694, lr_0 = 3.5598e-04
Validation rmse = 0.757402
Epoch 14
Loss = 2.0432e-03, PNorm = 59.2346, GNorm = 0.5965, lr_0 = 3.4446e-04
Loss = 2.1921e-03, PNorm = 59.2569, GNorm = 1.0728, lr_0 = 3.3332e-04
Validation rmse = 0.829705
Epoch 15
Loss = 2.2547e-03, PNorm = 59.2792, GNorm = 1.8635, lr_0 = 3.2253e-04
Loss = 1.9763e-03, PNorm = 59.2986, GNorm = 1.7901, lr_0 = 3.1209e-04
Loss = 2.3868e-03, PNorm = 59.3179, GNorm = 0.8727, lr_0 = 3.0200e-04
Validation rmse = 0.697530
Epoch 16
Loss = 1.9147e-03, PNorm = 59.3359, GNorm = 0.5824, lr_0 = 2.9222e-04
Loss = 1.7944e-03, PNorm = 59.3506, GNorm = 0.7425, lr_0 = 2.8277e-04
Validation rmse = 0.675217
Epoch 17
Loss = 1.3264e-03, PNorm = 59.3662, GNorm = 1.3038, lr_0 = 2.7272e-04
Loss = 1.5773e-03, PNorm = 59.3773, GNorm = 1.5228, lr_0 = 2.6389e-04
Loss = 1.9849e-03, PNorm = 59.3898, GNorm = 1.1785, lr_0 = 2.5535e-04
Validation rmse = 0.672105
Epoch 18
Loss = 1.7965e-03, PNorm = 59.4044, GNorm = 0.8078, lr_0 = 2.4709e-04
Loss = 1.8459e-03, PNorm = 59.4172, GNorm = 0.9498, lr_0 = 2.3910e-04
Loss = 1.5634e-03, PNorm = 59.4279, GNorm = 0.8351, lr_0 = 2.3136e-04
Validation rmse = 0.677085
Epoch 19
Loss = 1.8877e-03, PNorm = 59.4382, GNorm = 1.1594, lr_0 = 2.2387e-04
Loss = 1.5854e-03, PNorm = 59.4487, GNorm = 1.0499, lr_0 = 2.1663e-04
Validation rmse = 0.663018
Epoch 20
Loss = 1.5043e-03, PNorm = 59.4596, GNorm = 1.0454, lr_0 = 2.0962e-04
Loss = 1.4699e-03, PNorm = 59.4696, GNorm = 0.8468, lr_0 = 2.0283e-04
Loss = 1.3018e-03, PNorm = 59.4778, GNorm = 0.7420, lr_0 = 1.9627e-04
Validation rmse = 0.645046
Epoch 21
Loss = 1.4802e-03, PNorm = 59.4866, GNorm = 0.9885, lr_0 = 1.8992e-04
Loss = 1.6446e-03, PNorm = 59.4977, GNorm = 2.6959, lr_0 = 1.8377e-04
Validation rmse = 0.662717
Epoch 22
Loss = 1.5314e-03, PNorm = 59.5060, GNorm = 1.7260, lr_0 = 1.7783e-04
Loss = 1.6327e-03, PNorm = 59.5142, GNorm = 0.4250, lr_0 = 1.7207e-04
Loss = 1.3359e-03, PNorm = 59.5225, GNorm = 0.9287, lr_0 = 1.6651e-04
Validation rmse = 0.636764
Epoch 23
Loss = 1.4809e-03, PNorm = 59.5306, GNorm = 0.8260, lr_0 = 1.6059e-04
Loss = 1.5758e-03, PNorm = 59.5374, GNorm = 1.0907, lr_0 = 1.5539e-04
Validation rmse = 0.650572
Epoch 24
Loss = 1.3075e-03, PNorm = 59.5435, GNorm = 1.3738, lr_0 = 1.5036e-04
Loss = 1.2216e-03, PNorm = 59.5508, GNorm = 1.0396, lr_0 = 1.4550e-04
Loss = 1.2064e-03, PNorm = 59.5581, GNorm = 1.4590, lr_0 = 1.4079e-04
Validation rmse = 0.642296
Epoch 25
Loss = 1.4525e-03, PNorm = 59.5644, GNorm = 2.3025, lr_0 = 1.3623e-04
Loss = 1.3704e-03, PNorm = 59.5726, GNorm = 0.5953, lr_0 = 1.3183e-04
Loss = 1.3199e-03, PNorm = 59.5774, GNorm = 1.5106, lr_0 = 1.2756e-04
Validation rmse = 0.636418
Epoch 26
Loss = 1.2432e-03, PNorm = 59.5832, GNorm = 2.1846, lr_0 = 1.2343e-04
Loss = 1.3699e-03, PNorm = 59.5885, GNorm = 1.3953, lr_0 = 1.1944e-04
Validation rmse = 0.639073
Epoch 27
Loss = 1.5584e-03, PNorm = 59.5942, GNorm = 0.9306, lr_0 = 1.1557e-04
Loss = 1.3930e-03, PNorm = 59.6002, GNorm = 0.5682, lr_0 = 1.1183e-04
Loss = 1.1741e-03, PNorm = 59.6066, GNorm = 0.7920, lr_0 = 1.0821e-04
Validation rmse = 0.635964
Epoch 28
Loss = 1.2934e-03, PNorm = 59.6120, GNorm = 0.7848, lr_0 = 1.0437e-04
Loss = 1.4886e-03, PNorm = 59.6158, GNorm = 0.9459, lr_0 = 1.0099e-04
Validation rmse = 0.631932
Epoch 29
Loss = 1.4487e-03, PNorm = 59.6207, GNorm = 0.8017, lr_0 = 1.0000e-04
Loss = 1.2822e-03, PNorm = 59.6260, GNorm = 0.9763, lr_0 = 1.0000e-04
Loss = 1.1019e-03, PNorm = 59.6290, GNorm = 0.5206, lr_0 = 1.0000e-04
Validation rmse = 0.629996
Model 0 best validation rmse = 0.629996 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.676900
Ensemble test rmse = 0.676900
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1500,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_1_hidden_size_1500/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1500, bias=False)
      (W_h): Linear(in_features=1500, out_features=1500, bias=False)
      (W_o): Linear(in_features=1633, out_features=1500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1, bias=True)
  )
)
Number of parameters = 4,923,001
Moving model to cuda
Epoch 0
Loss = 1.6931e-02, PNorm = 57.7427, GNorm = 6.8396, lr_0 = 2.9800e-04
Loss = 1.2144e-02, PNorm = 57.7802, GNorm = 2.2433, lr_0 = 4.7800e-04
Validation rmse = 1.458143
Epoch 1
Loss = 8.5983e-03, PNorm = 57.8459, GNorm = 1.7222, lr_0 = 6.7600e-04
Loss = 8.8627e-03, PNorm = 57.9208, GNorm = 0.8818, lr_0 = 8.5600e-04
Loss = 7.3182e-03, PNorm = 58.0063, GNorm = 2.8009, lr_0 = 9.9344e-04
Validation rmse = 1.258065
Epoch 2
Loss = 6.3292e-03, PNorm = 58.0901, GNorm = 1.4401, lr_0 = 9.6130e-04
Loss = 5.4444e-03, PNorm = 58.1564, GNorm = 1.1525, lr_0 = 9.3019e-04
Validation rmse = 1.266433
Epoch 3
Loss = 5.9041e-03, PNorm = 58.2183, GNorm = 1.5335, lr_0 = 9.0009e-04
Loss = 4.7649e-03, PNorm = 58.2857, GNorm = 2.6599, lr_0 = 8.7096e-04
Loss = 4.2708e-03, PNorm = 58.3416, GNorm = 3.3132, lr_0 = 8.4278e-04
Validation rmse = 0.987498
Epoch 4
Loss = 4.9920e-03, PNorm = 58.3963, GNorm = 6.6981, lr_0 = 8.1551e-04
Loss = 4.6914e-03, PNorm = 58.4607, GNorm = 1.7934, lr_0 = 7.8912e-04
Validation rmse = 1.018551
Epoch 5
Loss = 3.9611e-03, PNorm = 58.5204, GNorm = 1.3389, lr_0 = 7.6358e-04
Loss = 3.5328e-03, PNorm = 58.5720, GNorm = 0.8751, lr_0 = 7.3888e-04
Loss = 3.6419e-03, PNorm = 58.6146, GNorm = 1.9018, lr_0 = 7.1497e-04
Validation rmse = 0.894325
Epoch 6
Loss = 3.1868e-03, PNorm = 58.6619, GNorm = 1.7883, lr_0 = 6.8956e-04
Loss = 3.3033e-03, PNorm = 58.6974, GNorm = 2.0061, lr_0 = 6.6725e-04
Loss = 2.8693e-03, PNorm = 58.7306, GNorm = 0.6708, lr_0 = 6.4565e-04
Validation rmse = 0.830742
Epoch 7
Loss = 2.7604e-03, PNorm = 58.7639, GNorm = 2.3785, lr_0 = 6.2476e-04
Loss = 3.1939e-03, PNorm = 58.7972, GNorm = 2.0219, lr_0 = 6.0454e-04
Validation rmse = 0.812435
Epoch 8
Loss = 2.5398e-03, PNorm = 58.8279, GNorm = 1.3744, lr_0 = 5.8498e-04
Loss = 2.7057e-03, PNorm = 58.8561, GNorm = 2.0472, lr_0 = 5.6605e-04
Loss = 2.5615e-03, PNorm = 58.8898, GNorm = 0.8563, lr_0 = 5.4774e-04
Validation rmse = 0.746274
Epoch 9
Loss = 2.5349e-03, PNorm = 58.9164, GNorm = 0.8250, lr_0 = 5.3001e-04
Loss = 2.6794e-03, PNorm = 58.9428, GNorm = 0.7731, lr_0 = 5.1286e-04
Validation rmse = 0.783637
Epoch 10
Loss = 1.2261e-03, PNorm = 58.9681, GNorm = 0.6567, lr_0 = 4.9627e-04
Loss = 2.3232e-03, PNorm = 58.9912, GNorm = 1.4417, lr_0 = 4.8021e-04
Loss = 2.4928e-03, PNorm = 59.0169, GNorm = 2.1109, lr_0 = 4.6467e-04
Validation rmse = 0.709922
Epoch 11
Loss = 1.8569e-03, PNorm = 59.0393, GNorm = 0.8124, lr_0 = 4.4963e-04
Loss = 2.4018e-03, PNorm = 59.0646, GNorm = 1.4771, lr_0 = 4.3508e-04
Validation rmse = 0.754572
Epoch 12
Loss = 2.4128e-03, PNorm = 59.0895, GNorm = 1.9049, lr_0 = 4.1962e-04
Loss = 2.3785e-03, PNorm = 59.1080, GNorm = 2.0543, lr_0 = 4.0604e-04
Loss = 2.2127e-03, PNorm = 59.1318, GNorm = 2.7669, lr_0 = 3.9290e-04
Validation rmse = 0.718478
Epoch 13
Loss = 2.2172e-03, PNorm = 59.1567, GNorm = 1.2967, lr_0 = 3.8019e-04
Loss = 2.1124e-03, PNorm = 59.1765, GNorm = 1.5890, lr_0 = 3.6789e-04
Loss = 1.8967e-03, PNorm = 59.1970, GNorm = 0.8271, lr_0 = 3.5598e-04
Validation rmse = 0.700157
Epoch 14
Loss = 1.8849e-03, PNorm = 59.2145, GNorm = 0.6381, lr_0 = 3.4446e-04
Loss = 1.8032e-03, PNorm = 59.2305, GNorm = 1.0801, lr_0 = 3.3332e-04
Validation rmse = 0.741144
Epoch 15
Loss = 1.6093e-03, PNorm = 59.2479, GNorm = 1.6175, lr_0 = 3.2253e-04
Loss = 1.8745e-03, PNorm = 59.2641, GNorm = 0.9751, lr_0 = 3.1209e-04
Loss = 1.8636e-03, PNorm = 59.2762, GNorm = 0.9132, lr_0 = 3.0200e-04
Validation rmse = 0.671758
Epoch 16
Loss = 1.7863e-03, PNorm = 59.2918, GNorm = 0.7523, lr_0 = 2.9222e-04
Loss = 1.8414e-03, PNorm = 59.3062, GNorm = 0.6258, lr_0 = 2.8277e-04
Validation rmse = 0.673510
Epoch 17
Loss = 1.6263e-03, PNorm = 59.3230, GNorm = 0.4896, lr_0 = 2.7272e-04
Loss = 1.4824e-03, PNorm = 59.3361, GNorm = 2.7168, lr_0 = 2.6389e-04
Loss = 1.8530e-03, PNorm = 59.3492, GNorm = 0.5478, lr_0 = 2.5535e-04
Validation rmse = 0.692137
Epoch 18
Loss = 1.4862e-03, PNorm = 59.3652, GNorm = 1.6340, lr_0 = 2.4709e-04
Loss = 1.8907e-03, PNorm = 59.3788, GNorm = 1.5613, lr_0 = 2.3910e-04
Loss = 1.5110e-03, PNorm = 59.3919, GNorm = 0.8660, lr_0 = 2.3136e-04
Validation rmse = 0.676086
Epoch 19
Loss = 1.7468e-03, PNorm = 59.4023, GNorm = 1.0730, lr_0 = 2.2387e-04
Loss = 1.5544e-03, PNorm = 59.4136, GNorm = 0.6238, lr_0 = 2.1663e-04
Validation rmse = 0.653628
Epoch 20
Loss = 1.5310e-03, PNorm = 59.4243, GNorm = 0.6569, lr_0 = 2.0962e-04
Loss = 1.5789e-03, PNorm = 59.4361, GNorm = 1.0931, lr_0 = 2.0283e-04
Loss = 1.8115e-03, PNorm = 59.4468, GNorm = 0.7277, lr_0 = 1.9627e-04
Validation rmse = 0.673247
Epoch 21
Loss = 1.6298e-03, PNorm = 59.4599, GNorm = 0.8322, lr_0 = 1.8992e-04
Loss = 1.9576e-03, PNorm = 59.4720, GNorm = 1.4375, lr_0 = 1.8377e-04
Validation rmse = 0.674325
Epoch 22
Loss = 2.2584e-03, PNorm = 59.4819, GNorm = 3.3339, lr_0 = 1.7783e-04
Loss = 1.6867e-03, PNorm = 59.4926, GNorm = 1.9039, lr_0 = 1.7207e-04
Loss = 1.2550e-03, PNorm = 59.5004, GNorm = 1.3734, lr_0 = 1.6651e-04
Validation rmse = 0.696030
Epoch 23
Loss = 1.7606e-03, PNorm = 59.5109, GNorm = 1.2181, lr_0 = 1.6059e-04
Loss = 1.3481e-03, PNorm = 59.5171, GNorm = 0.7240, lr_0 = 1.5539e-04
Validation rmse = 0.673437
Epoch 24
Loss = 1.4261e-03, PNorm = 59.5253, GNorm = 1.2178, lr_0 = 1.5036e-04
Loss = 1.3200e-03, PNorm = 59.5335, GNorm = 0.6796, lr_0 = 1.4550e-04
Loss = 1.3306e-03, PNorm = 59.5397, GNorm = 0.4298, lr_0 = 1.4079e-04
Validation rmse = 0.680782
Epoch 25
Loss = 1.6165e-03, PNorm = 59.5464, GNorm = 0.4220, lr_0 = 1.3623e-04
Loss = 1.4542e-03, PNorm = 59.5530, GNorm = 0.7010, lr_0 = 1.3183e-04
Loss = 1.4155e-03, PNorm = 59.5590, GNorm = 0.4101, lr_0 = 1.2756e-04
Validation rmse = 0.645200
Epoch 26
Loss = 1.4586e-03, PNorm = 59.5654, GNorm = 0.7116, lr_0 = 1.2343e-04
Loss = 1.2118e-03, PNorm = 59.5718, GNorm = 0.7834, lr_0 = 1.1944e-04
Validation rmse = 0.657933
Epoch 27
Loss = 9.7199e-04, PNorm = 59.5784, GNorm = 0.7396, lr_0 = 1.1557e-04
Loss = 1.3490e-03, PNorm = 59.5855, GNorm = 0.6830, lr_0 = 1.1183e-04
Loss = 1.2491e-03, PNorm = 59.5906, GNorm = 0.6509, lr_0 = 1.0821e-04
Validation rmse = 0.652900
Epoch 28
Loss = 1.2407e-03, PNorm = 59.5970, GNorm = 0.5099, lr_0 = 1.0437e-04
Loss = 1.3542e-03, PNorm = 59.6026, GNorm = 1.7119, lr_0 = 1.0099e-04
Validation rmse = 0.657831
Epoch 29
Loss = 1.0249e-03, PNorm = 59.6079, GNorm = 0.5571, lr_0 = 1.0000e-04
Loss = 1.1559e-03, PNorm = 59.6130, GNorm = 0.8123, lr_0 = 1.0000e-04
Loss = 1.5249e-03, PNorm = 59.6173, GNorm = 0.6004, lr_0 = 1.0000e-04
Validation rmse = 0.661188
Model 0 best validation rmse = 0.645200 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.891277
Ensemble test rmse = 0.891277
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1500,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_1_hidden_size_1500/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1500, bias=False)
      (W_h): Linear(in_features=1500, out_features=1500, bias=False)
      (W_o): Linear(in_features=1633, out_features=1500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1, bias=True)
  )
)
Number of parameters = 4,923,001
Moving model to cuda
Epoch 0
Loss = 1.9007e-02, PNorm = 57.7417, GNorm = 14.8827, lr_0 = 2.9800e-04
Loss = 1.6171e-02, PNorm = 57.7782, GNorm = 5.3651, lr_0 = 4.7800e-04
Validation rmse = 1.688909
Epoch 1
Loss = 1.1481e-02, PNorm = 57.8520, GNorm = 3.0738, lr_0 = 6.7600e-04
Loss = 9.3192e-03, PNorm = 57.9349, GNorm = 4.0436, lr_0 = 8.5600e-04
Loss = 6.8707e-03, PNorm = 58.0165, GNorm = 4.6155, lr_0 = 9.9344e-04
Validation rmse = 1.498509
Epoch 2
Loss = 6.5126e-03, PNorm = 58.1009, GNorm = 2.0655, lr_0 = 9.6130e-04
Loss = 5.6658e-03, PNorm = 58.1672, GNorm = 5.7139, lr_0 = 9.3019e-04
Validation rmse = 1.382955
Epoch 3
Loss = 6.1003e-03, PNorm = 58.2384, GNorm = 1.7248, lr_0 = 9.0009e-04
Loss = 5.6750e-03, PNorm = 58.3118, GNorm = 2.2783, lr_0 = 8.7096e-04
Loss = 3.7774e-03, PNorm = 58.3772, GNorm = 0.9739, lr_0 = 8.4278e-04
Validation rmse = 1.048800
Epoch 4
Loss = 3.3376e-03, PNorm = 58.4305, GNorm = 1.0610, lr_0 = 8.1551e-04
Loss = 3.4161e-03, PNorm = 58.4857, GNorm = 2.1513, lr_0 = 7.8912e-04
Validation rmse = 0.956323
Epoch 5
Loss = 3.3302e-03, PNorm = 58.5389, GNorm = 1.3623, lr_0 = 7.6358e-04
Loss = 3.3723e-03, PNorm = 58.5844, GNorm = 1.4480, lr_0 = 7.3888e-04
Loss = 4.4145e-03, PNorm = 58.6302, GNorm = 2.4448, lr_0 = 7.1497e-04
Validation rmse = 1.074973
Epoch 6
Loss = 3.5839e-03, PNorm = 58.6809, GNorm = 3.4784, lr_0 = 6.8956e-04
Loss = 3.5210e-03, PNorm = 58.7302, GNorm = 1.0786, lr_0 = 6.6725e-04
Loss = 3.1102e-03, PNorm = 58.7717, GNorm = 4.7310, lr_0 = 6.4565e-04
Validation rmse = 0.977602
Epoch 7
Loss = 3.1142e-03, PNorm = 58.8106, GNorm = 0.8130, lr_0 = 6.2476e-04
Loss = 2.8750e-03, PNorm = 58.8448, GNorm = 4.3577, lr_0 = 6.0454e-04
Validation rmse = 0.984138
Epoch 8
Loss = 3.9915e-03, PNorm = 58.8746, GNorm = 4.9050, lr_0 = 5.8498e-04
Loss = 3.3477e-03, PNorm = 58.9179, GNorm = 2.7322, lr_0 = 5.6605e-04
Loss = 2.4560e-03, PNorm = 58.9528, GNorm = 0.6891, lr_0 = 5.4774e-04
Validation rmse = 0.875071
Epoch 9
Loss = 2.5236e-03, PNorm = 58.9824, GNorm = 1.6238, lr_0 = 5.3001e-04
Loss = 2.5764e-03, PNorm = 59.0118, GNorm = 1.3309, lr_0 = 5.1286e-04
Validation rmse = 0.818095
Epoch 10
Loss = 2.2186e-03, PNorm = 59.0352, GNorm = 0.5459, lr_0 = 4.9627e-04
Loss = 2.3635e-03, PNorm = 59.0602, GNorm = 1.1732, lr_0 = 4.8021e-04
Loss = 1.8690e-03, PNorm = 59.0847, GNorm = 1.1062, lr_0 = 4.6467e-04
Validation rmse = 0.821490
Epoch 11
Loss = 2.2636e-03, PNorm = 59.1034, GNorm = 3.1476, lr_0 = 4.4963e-04
Loss = 2.9240e-03, PNorm = 59.1304, GNorm = 1.3406, lr_0 = 4.3508e-04
Validation rmse = 0.858766
Epoch 12
Loss = 2.0049e-03, PNorm = 59.1596, GNorm = 1.2646, lr_0 = 4.1962e-04
Loss = 1.8245e-03, PNorm = 59.1823, GNorm = 0.8766, lr_0 = 4.0604e-04
Loss = 2.0422e-03, PNorm = 59.2018, GNorm = 0.5972, lr_0 = 3.9290e-04
Validation rmse = 0.838413
Epoch 13
Loss = 2.0313e-03, PNorm = 59.2215, GNorm = 1.6796, lr_0 = 3.8019e-04
Loss = 2.0575e-03, PNorm = 59.2408, GNorm = 0.5475, lr_0 = 3.6789e-04
Loss = 1.7931e-03, PNorm = 59.2569, GNorm = 0.6636, lr_0 = 3.5598e-04
Validation rmse = 0.900244
Epoch 14
Loss = 1.9150e-03, PNorm = 59.2749, GNorm = 2.1812, lr_0 = 3.4446e-04
Loss = 1.7599e-03, PNorm = 59.2927, GNorm = 1.2370, lr_0 = 3.3332e-04
Validation rmse = 0.820063
Epoch 15
Loss = 1.4807e-03, PNorm = 59.3110, GNorm = 1.5279, lr_0 = 3.2253e-04
Loss = 1.7680e-03, PNorm = 59.3265, GNorm = 0.8318, lr_0 = 3.1209e-04
Loss = 1.6195e-03, PNorm = 59.3408, GNorm = 0.8830, lr_0 = 3.0200e-04
Validation rmse = 0.830005
Epoch 16
Loss = 1.7777e-03, PNorm = 59.3573, GNorm = 1.2257, lr_0 = 2.9222e-04
Loss = 1.9625e-03, PNorm = 59.3719, GNorm = 1.5709, lr_0 = 2.8277e-04
Validation rmse = 0.783807
Epoch 17
Loss = 1.8083e-03, PNorm = 59.3855, GNorm = 1.4222, lr_0 = 2.7272e-04
Loss = 1.7753e-03, PNorm = 59.4019, GNorm = 1.6693, lr_0 = 2.6389e-04
Loss = 1.6490e-03, PNorm = 59.4165, GNorm = 0.8322, lr_0 = 2.5535e-04
Validation rmse = 0.808604
Epoch 18
Loss = 1.4885e-03, PNorm = 59.4310, GNorm = 0.9878, lr_0 = 2.4709e-04
Loss = 1.5773e-03, PNorm = 59.4432, GNorm = 1.0508, lr_0 = 2.3910e-04
Loss = 1.5304e-03, PNorm = 59.4542, GNorm = 1.0828, lr_0 = 2.3136e-04
Validation rmse = 0.781768
Epoch 19
Loss = 1.7040e-03, PNorm = 59.4637, GNorm = 1.2622, lr_0 = 2.2387e-04
Loss = 1.7328e-03, PNorm = 59.4753, GNorm = 1.3204, lr_0 = 2.1663e-04
Validation rmse = 0.796855
Epoch 20
Loss = 1.1073e-03, PNorm = 59.4875, GNorm = 0.5474, lr_0 = 2.0962e-04
Loss = 1.6600e-03, PNorm = 59.4990, GNorm = 0.8717, lr_0 = 2.0283e-04
Loss = 1.5040e-03, PNorm = 59.5078, GNorm = 1.4683, lr_0 = 1.9627e-04
Validation rmse = 0.828091
Epoch 21
Loss = 1.3748e-03, PNorm = 59.5186, GNorm = 0.6253, lr_0 = 1.8992e-04
Loss = 1.4523e-03, PNorm = 59.5286, GNorm = 0.8463, lr_0 = 1.8377e-04
Validation rmse = 0.783142
Epoch 22
Loss = 1.1388e-03, PNorm = 59.5382, GNorm = 0.4289, lr_0 = 1.7783e-04
Loss = 1.3105e-03, PNorm = 59.5467, GNorm = 1.5896, lr_0 = 1.7207e-04
Loss = 1.4443e-03, PNorm = 59.5554, GNorm = 0.9102, lr_0 = 1.6651e-04
Validation rmse = 0.753181
Epoch 23
Loss = 1.4293e-03, PNorm = 59.5656, GNorm = 1.1502, lr_0 = 1.6059e-04
Loss = 1.2086e-03, PNorm = 59.5735, GNorm = 1.3785, lr_0 = 1.5539e-04
Validation rmse = 0.750487
Epoch 24
Loss = 1.0395e-03, PNorm = 59.5808, GNorm = 0.6646, lr_0 = 1.5036e-04
Loss = 1.4659e-03, PNorm = 59.5869, GNorm = 1.6288, lr_0 = 1.4550e-04
Loss = 1.5014e-03, PNorm = 59.5941, GNorm = 0.7691, lr_0 = 1.4079e-04
Validation rmse = 0.754392
Epoch 25
Loss = 1.3986e-03, PNorm = 59.6026, GNorm = 1.5162, lr_0 = 1.3623e-04
Loss = 1.3339e-03, PNorm = 59.6111, GNorm = 1.8363, lr_0 = 1.3183e-04
Loss = 1.3196e-03, PNorm = 59.6167, GNorm = 1.5795, lr_0 = 1.2756e-04
Validation rmse = 0.747741
Epoch 26
Loss = 1.3177e-03, PNorm = 59.6212, GNorm = 0.6525, lr_0 = 1.2343e-04
Loss = 1.3899e-03, PNorm = 59.6269, GNorm = 1.0222, lr_0 = 1.1944e-04
Validation rmse = 0.752375
Epoch 27
Loss = 1.2573e-03, PNorm = 59.6325, GNorm = 0.6858, lr_0 = 1.1557e-04
Loss = 1.1645e-03, PNorm = 59.6373, GNorm = 0.8016, lr_0 = 1.1183e-04
Loss = 1.2261e-03, PNorm = 59.6424, GNorm = 1.2208, lr_0 = 1.0821e-04
Validation rmse = 0.745056
Epoch 28
Loss = 1.1587e-03, PNorm = 59.6488, GNorm = 1.8274, lr_0 = 1.0437e-04
Loss = 1.3336e-03, PNorm = 59.6541, GNorm = 0.5894, lr_0 = 1.0099e-04
Validation rmse = 0.755115
Epoch 29
Loss = 1.8857e-03, PNorm = 59.6582, GNorm = 0.8065, lr_0 = 1.0000e-04
Loss = 1.2452e-03, PNorm = 59.6632, GNorm = 1.4437, lr_0 = 1.0000e-04
Loss = 9.5439e-04, PNorm = 59.6674, GNorm = 0.8493, lr_0 = 1.0000e-04
Validation rmse = 0.734664
Model 0 best validation rmse = 0.734664 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.056082
Ensemble test rmse = 1.056082
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1500,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_1_hidden_size_1500/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1500, bias=False)
      (W_h): Linear(in_features=1500, out_features=1500, bias=False)
      (W_o): Linear(in_features=1633, out_features=1500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1, bias=True)
  )
)
Number of parameters = 4,923,001
Moving model to cuda
Epoch 0
Loss = 1.7372e-02, PNorm = 57.7414, GNorm = 4.9487, lr_0 = 2.9800e-04
Loss = 1.3880e-02, PNorm = 57.7763, GNorm = 12.7270, lr_0 = 4.7800e-04
Validation rmse = 1.830628
Epoch 1
Loss = 1.0085e-02, PNorm = 57.8415, GNorm = 6.8503, lr_0 = 6.7600e-04
Loss = 8.4688e-03, PNorm = 57.9168, GNorm = 5.0116, lr_0 = 8.5600e-04
Loss = 7.8565e-03, PNorm = 57.9952, GNorm = 2.2143, lr_0 = 9.9344e-04
Validation rmse = 1.543708
Epoch 2
Loss = 6.3280e-03, PNorm = 58.0727, GNorm = 2.8825, lr_0 = 9.6130e-04
Loss = 6.4858e-03, PNorm = 58.1520, GNorm = 5.0172, lr_0 = 9.3019e-04
Validation rmse = 1.345860
Epoch 3
Loss = 5.3203e-03, PNorm = 58.2225, GNorm = 3.7046, lr_0 = 9.0009e-04
Loss = 5.3921e-03, PNorm = 58.2923, GNorm = 4.0251, lr_0 = 8.7096e-04
Loss = 5.0568e-03, PNorm = 58.3496, GNorm = 4.7048, lr_0 = 8.4278e-04
Validation rmse = 1.197375
Epoch 4
Loss = 4.3704e-03, PNorm = 58.4189, GNorm = 1.8023, lr_0 = 8.1551e-04
Loss = 3.9170e-03, PNorm = 58.4720, GNorm = 2.6135, lr_0 = 7.8912e-04
Validation rmse = 1.011703
Epoch 5
Loss = 2.7838e-03, PNorm = 58.5203, GNorm = 1.2385, lr_0 = 7.6358e-04
Loss = 3.8065e-03, PNorm = 58.5632, GNorm = 4.0748, lr_0 = 7.3888e-04
Loss = 4.0534e-03, PNorm = 58.6064, GNorm = 2.7285, lr_0 = 7.1497e-04
Validation rmse = 1.030599
Epoch 6
Loss = 3.0495e-03, PNorm = 58.6558, GNorm = 1.2888, lr_0 = 6.8956e-04
Loss = 3.3714e-03, PNorm = 58.6967, GNorm = 1.4681, lr_0 = 6.6725e-04
Loss = 2.8494e-03, PNorm = 58.7313, GNorm = 3.1128, lr_0 = 6.4565e-04
Validation rmse = 0.981481
Epoch 7
Loss = 2.3363e-03, PNorm = 58.7651, GNorm = 1.0061, lr_0 = 6.2476e-04
Loss = 3.0174e-03, PNorm = 58.8016, GNorm = 2.3910, lr_0 = 6.0454e-04
Validation rmse = 1.045076
Epoch 8
Loss = 2.2724e-03, PNorm = 58.8360, GNorm = 1.4188, lr_0 = 5.8498e-04
Loss = 2.8875e-03, PNorm = 58.8727, GNorm = 4.3007, lr_0 = 5.6605e-04
Loss = 3.1214e-03, PNorm = 58.9096, GNorm = 0.7612, lr_0 = 5.4774e-04
Validation rmse = 1.027794
Epoch 9
Loss = 2.3850e-03, PNorm = 58.9371, GNorm = 1.9766, lr_0 = 5.3001e-04
Loss = 2.6350e-03, PNorm = 58.9677, GNorm = 1.4878, lr_0 = 5.1286e-04
Validation rmse = 0.921753
Epoch 10
Loss = 1.4005e-03, PNorm = 58.9985, GNorm = 0.8619, lr_0 = 4.9627e-04
Loss = 1.9715e-03, PNorm = 59.0257, GNorm = 0.7796, lr_0 = 4.8021e-04
Loss = 2.7803e-03, PNorm = 59.0537, GNorm = 1.0213, lr_0 = 4.6467e-04
Validation rmse = 0.951733
Epoch 11
Loss = 2.1527e-03, PNorm = 59.0828, GNorm = 2.3197, lr_0 = 4.4963e-04
Loss = 2.5241e-03, PNorm = 59.1121, GNorm = 1.3966, lr_0 = 4.3508e-04
Validation rmse = 1.036253
Epoch 12
Loss = 2.5346e-03, PNorm = 59.1392, GNorm = 2.1161, lr_0 = 4.1962e-04
Loss = 2.1556e-03, PNorm = 59.1618, GNorm = 1.2133, lr_0 = 4.0604e-04
Loss = 1.9723e-03, PNorm = 59.1811, GNorm = 1.1668, lr_0 = 3.9290e-04
Validation rmse = 1.079604
Epoch 13
Loss = 2.4082e-03, PNorm = 59.2041, GNorm = 4.2928, lr_0 = 3.8019e-04
Loss = 2.1676e-03, PNorm = 59.2243, GNorm = 1.0661, lr_0 = 3.6789e-04
Loss = 2.5995e-03, PNorm = 59.2461, GNorm = 2.7680, lr_0 = 3.5598e-04
Validation rmse = 0.996841
Epoch 14
Loss = 2.2756e-03, PNorm = 59.2691, GNorm = 0.6443, lr_0 = 3.4446e-04
Loss = 1.6565e-03, PNorm = 59.2882, GNorm = 0.8160, lr_0 = 3.3332e-04
Validation rmse = 0.984711
Epoch 15
Loss = 2.0009e-03, PNorm = 59.3050, GNorm = 0.9606, lr_0 = 3.2253e-04
Loss = 1.6459e-03, PNorm = 59.3192, GNorm = 0.7378, lr_0 = 3.1209e-04
Loss = 1.7699e-03, PNorm = 59.3363, GNorm = 0.9964, lr_0 = 3.0200e-04
Validation rmse = 0.888286
Epoch 16
Loss = 1.9551e-03, PNorm = 59.3499, GNorm = 1.0293, lr_0 = 2.9222e-04
Loss = 1.6073e-03, PNorm = 59.3655, GNorm = 2.8397, lr_0 = 2.8277e-04
Validation rmse = 0.912754
Epoch 17
Loss = 1.8837e-03, PNorm = 59.3815, GNorm = 0.8855, lr_0 = 2.7272e-04
Loss = 1.6736e-03, PNorm = 59.3980, GNorm = 0.8141, lr_0 = 2.6389e-04
Loss = 1.5709e-03, PNorm = 59.4130, GNorm = 1.5431, lr_0 = 2.5535e-04
Validation rmse = 0.897184
Epoch 18
Loss = 1.6330e-03, PNorm = 59.4241, GNorm = 1.2024, lr_0 = 2.4709e-04
Loss = 1.5635e-03, PNorm = 59.4366, GNorm = 0.9236, lr_0 = 2.3910e-04
Loss = 1.6422e-03, PNorm = 59.4485, GNorm = 0.5840, lr_0 = 2.3136e-04
Validation rmse = 0.888574
Epoch 19
Loss = 1.5986e-03, PNorm = 59.4601, GNorm = 0.7966, lr_0 = 2.2387e-04
Loss = 1.6764e-03, PNorm = 59.4726, GNorm = 0.6883, lr_0 = 2.1663e-04
Validation rmse = 0.918020
Epoch 20
Loss = 1.2558e-03, PNorm = 59.4814, GNorm = 0.8133, lr_0 = 2.0962e-04
Loss = 1.5896e-03, PNorm = 59.4932, GNorm = 2.0367, lr_0 = 2.0283e-04
Loss = 1.3839e-03, PNorm = 59.5038, GNorm = 0.7154, lr_0 = 1.9627e-04
Validation rmse = 0.939243
Epoch 21
Loss = 1.4949e-03, PNorm = 59.5119, GNorm = 1.5053, lr_0 = 1.8992e-04
Loss = 1.4169e-03, PNorm = 59.5202, GNorm = 1.0511, lr_0 = 1.8377e-04
Validation rmse = 0.851576
Epoch 22
Loss = 1.2870e-03, PNorm = 59.5292, GNorm = 0.9135, lr_0 = 1.7783e-04
Loss = 1.0530e-03, PNorm = 59.5371, GNorm = 0.8493, lr_0 = 1.7207e-04
Loss = 1.5801e-03, PNorm = 59.5458, GNorm = 2.2155, lr_0 = 1.6651e-04
Validation rmse = 0.865151
Epoch 23
Loss = 1.1871e-03, PNorm = 59.5543, GNorm = 0.6485, lr_0 = 1.6059e-04
Loss = 1.2769e-03, PNorm = 59.5624, GNorm = 0.6638, lr_0 = 1.5539e-04
Validation rmse = 0.860328
Epoch 24
Loss = 1.3607e-03, PNorm = 59.5697, GNorm = 1.3261, lr_0 = 1.5036e-04
Loss = 1.5321e-03, PNorm = 59.5792, GNorm = 0.6464, lr_0 = 1.4550e-04
Loss = 1.2925e-03, PNorm = 59.5877, GNorm = 0.5651, lr_0 = 1.4079e-04
Validation rmse = 0.866381
Epoch 25
Loss = 1.2756e-03, PNorm = 59.5929, GNorm = 0.9130, lr_0 = 1.3623e-04
Loss = 1.3018e-03, PNorm = 59.6004, GNorm = 0.6483, lr_0 = 1.3183e-04
Loss = 1.2013e-03, PNorm = 59.6073, GNorm = 0.3884, lr_0 = 1.2756e-04
Validation rmse = 0.872246
Epoch 26
Loss = 1.3100e-03, PNorm = 59.6149, GNorm = 2.4538, lr_0 = 1.2343e-04
Loss = 1.2153e-03, PNorm = 59.6204, GNorm = 1.3895, lr_0 = 1.1944e-04
Validation rmse = 0.893648
Epoch 27
Loss = 1.1555e-03, PNorm = 59.6234, GNorm = 1.1000, lr_0 = 1.1557e-04
Loss = 1.3036e-03, PNorm = 59.6304, GNorm = 0.5248, lr_0 = 1.1183e-04
Loss = 1.2895e-03, PNorm = 59.6352, GNorm = 1.7275, lr_0 = 1.0821e-04
Validation rmse = 0.834869
Epoch 28
Loss = 1.4027e-03, PNorm = 59.6412, GNorm = 1.7604, lr_0 = 1.0437e-04
Loss = 1.2112e-03, PNorm = 59.6459, GNorm = 0.9781, lr_0 = 1.0099e-04
Validation rmse = 0.839087
Epoch 29
Loss = 7.0768e-04, PNorm = 59.6514, GNorm = 1.0428, lr_0 = 1.0000e-04
Loss = 1.2751e-03, PNorm = 59.6576, GNorm = 0.5193, lr_0 = 1.0000e-04
Loss = 1.1977e-03, PNorm = 59.6632, GNorm = 0.8025, lr_0 = 1.0000e-04
Validation rmse = 0.849278
Model 0 best validation rmse = 0.834869 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.704035
Ensemble test rmse = 0.704035
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1500,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_1_hidden_size_1500/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1500, bias=False)
      (W_h): Linear(in_features=1500, out_features=1500, bias=False)
      (W_o): Linear(in_features=1633, out_features=1500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1, bias=True)
  )
)
Number of parameters = 4,923,001
Moving model to cuda
Epoch 0
Loss = 2.2930e-02, PNorm = 57.7395, GNorm = 6.2572, lr_0 = 2.9800e-04
Loss = 1.2301e-02, PNorm = 57.7806, GNorm = 4.8635, lr_0 = 4.7800e-04
Validation rmse = 1.700160
Epoch 1
Loss = 8.9719e-03, PNorm = 57.8402, GNorm = 2.0195, lr_0 = 6.7600e-04
Loss = 7.7931e-03, PNorm = 57.9062, GNorm = 5.2084, lr_0 = 8.5600e-04
Loss = 9.0785e-03, PNorm = 57.9783, GNorm = 3.0072, lr_0 = 9.9344e-04
Validation rmse = 1.869282
Epoch 2
Loss = 7.5723e-03, PNorm = 58.0598, GNorm = 1.4511, lr_0 = 9.6130e-04
Loss = 6.5842e-03, PNorm = 58.1196, GNorm = 3.3959, lr_0 = 9.3019e-04
Validation rmse = 1.326036
Epoch 3
Loss = 5.8718e-03, PNorm = 58.1826, GNorm = 2.3842, lr_0 = 9.0009e-04
Loss = 4.9800e-03, PNorm = 58.2361, GNorm = 1.7100, lr_0 = 8.7096e-04
Loss = 4.2181e-03, PNorm = 58.2874, GNorm = 1.6093, lr_0 = 8.4278e-04
Validation rmse = 1.217159
Epoch 4
Loss = 4.3822e-03, PNorm = 58.3337, GNorm = 1.7500, lr_0 = 8.1551e-04
Loss = 4.7416e-03, PNorm = 58.3804, GNorm = 4.3520, lr_0 = 7.8912e-04
Validation rmse = 1.117396
Epoch 5
Loss = 2.3219e-03, PNorm = 58.4286, GNorm = 0.6643, lr_0 = 7.6358e-04
Loss = 3.9035e-03, PNorm = 58.4709, GNorm = 1.1074, lr_0 = 7.3888e-04
Loss = 4.6464e-03, PNorm = 58.5110, GNorm = 2.9921, lr_0 = 7.1497e-04
Validation rmse = 1.085754
Epoch 6
Loss = 3.3024e-03, PNorm = 58.5563, GNorm = 2.3196, lr_0 = 6.8956e-04
Loss = 3.7557e-03, PNorm = 58.5940, GNorm = 3.4571, lr_0 = 6.6725e-04
Loss = 4.5679e-03, PNorm = 58.6324, GNorm = 0.7128, lr_0 = 6.4565e-04
Validation rmse = 1.214628
Epoch 7
Loss = 4.2101e-03, PNorm = 58.6729, GNorm = 2.8311, lr_0 = 6.2476e-04
Loss = 3.1893e-03, PNorm = 58.7053, GNorm = 2.9034, lr_0 = 6.0454e-04
Validation rmse = 1.080044
Epoch 8
Loss = 2.5804e-03, PNorm = 58.7385, GNorm = 0.8075, lr_0 = 5.8498e-04
Loss = 2.5469e-03, PNorm = 58.7680, GNorm = 0.6528, lr_0 = 5.6605e-04
Loss = 2.7457e-03, PNorm = 58.7953, GNorm = 0.6311, lr_0 = 5.4774e-04
Validation rmse = 1.046888
Epoch 9
Loss = 3.2558e-03, PNorm = 58.8238, GNorm = 4.7110, lr_0 = 5.3001e-04
Loss = 2.7696e-03, PNorm = 58.8576, GNorm = 0.7750, lr_0 = 5.1286e-04
Validation rmse = 1.046996
Epoch 10
Loss = 2.9481e-03, PNorm = 58.8901, GNorm = 2.5364, lr_0 = 4.9627e-04
Loss = 2.9600e-03, PNorm = 58.9201, GNorm = 1.2901, lr_0 = 4.8021e-04
Loss = 2.2381e-03, PNorm = 58.9482, GNorm = 2.2194, lr_0 = 4.6467e-04
Validation rmse = 1.014325
Epoch 11
Loss = 2.4580e-03, PNorm = 58.9724, GNorm = 1.2893, lr_0 = 4.4963e-04
Loss = 2.2960e-03, PNorm = 58.9918, GNorm = 0.9343, lr_0 = 4.3508e-04
Validation rmse = 1.013908
Epoch 12
Loss = 2.1279e-03, PNorm = 59.0181, GNorm = 0.8510, lr_0 = 4.1962e-04
Loss = 1.9758e-03, PNorm = 59.0376, GNorm = 1.5812, lr_0 = 4.0604e-04
Loss = 2.2598e-03, PNorm = 59.0553, GNorm = 1.3222, lr_0 = 3.9290e-04
Validation rmse = 1.013557
Epoch 13
Loss = 2.1176e-03, PNorm = 59.0751, GNorm = 2.3351, lr_0 = 3.8019e-04
Loss = 2.0861e-03, PNorm = 59.0898, GNorm = 1.7645, lr_0 = 3.6789e-04
Loss = 1.9619e-03, PNorm = 59.1075, GNorm = 0.4934, lr_0 = 3.5598e-04
Validation rmse = 0.974800
Epoch 14
Loss = 1.7808e-03, PNorm = 59.1255, GNorm = 0.7540, lr_0 = 3.4446e-04
Loss = 1.7768e-03, PNorm = 59.1386, GNorm = 2.4483, lr_0 = 3.3332e-04
Validation rmse = 0.984237
Epoch 15
Loss = 1.2515e-03, PNorm = 59.1581, GNorm = 0.8499, lr_0 = 3.2253e-04
Loss = 1.7882e-03, PNorm = 59.1776, GNorm = 1.2904, lr_0 = 3.1209e-04
Loss = 1.8344e-03, PNorm = 59.1949, GNorm = 2.1952, lr_0 = 3.0200e-04
Validation rmse = 1.073264
Epoch 16
Loss = 1.5845e-03, PNorm = 59.2093, GNorm = 1.7709, lr_0 = 2.9222e-04
Loss = 1.9288e-03, PNorm = 59.2245, GNorm = 0.6063, lr_0 = 2.8277e-04
Validation rmse = 0.984801
Epoch 17
Loss = 1.7441e-03, PNorm = 59.2431, GNorm = 1.9706, lr_0 = 2.7272e-04
Loss = 1.6562e-03, PNorm = 59.2577, GNorm = 1.3695, lr_0 = 2.6389e-04
Loss = 1.5958e-03, PNorm = 59.2720, GNorm = 0.6658, lr_0 = 2.5535e-04
Validation rmse = 1.025882
Epoch 18
Loss = 1.9448e-03, PNorm = 59.2850, GNorm = 3.0667, lr_0 = 2.4709e-04
Loss = 1.5555e-03, PNorm = 59.2980, GNorm = 3.0169, lr_0 = 2.3910e-04
Loss = 1.6814e-03, PNorm = 59.3103, GNorm = 1.4978, lr_0 = 2.3136e-04
Validation rmse = 1.014440
Epoch 19
Loss = 1.6557e-03, PNorm = 59.3200, GNorm = 1.1906, lr_0 = 2.2387e-04
Loss = 1.4604e-03, PNorm = 59.3317, GNorm = 0.9165, lr_0 = 2.1663e-04
Validation rmse = 0.969336
Epoch 20
Loss = 1.4012e-03, PNorm = 59.3441, GNorm = 0.4830, lr_0 = 2.0962e-04
Loss = 1.4986e-03, PNorm = 59.3555, GNorm = 0.7340, lr_0 = 2.0283e-04
Loss = 1.5580e-03, PNorm = 59.3657, GNorm = 0.7589, lr_0 = 1.9627e-04
Validation rmse = 0.974499
Epoch 21
Loss = 1.3319e-03, PNorm = 59.3744, GNorm = 0.6057, lr_0 = 1.8992e-04
Loss = 1.3758e-03, PNorm = 59.3838, GNorm = 1.0927, lr_0 = 1.8377e-04
Validation rmse = 0.960548
Epoch 22
Loss = 1.1186e-03, PNorm = 59.3912, GNorm = 0.7268, lr_0 = 1.7783e-04
Loss = 1.2977e-03, PNorm = 59.3997, GNorm = 1.4620, lr_0 = 1.7207e-04
Loss = 1.4960e-03, PNorm = 59.4075, GNorm = 1.5419, lr_0 = 1.6651e-04
Validation rmse = 0.972106
Epoch 23
Loss = 1.2829e-03, PNorm = 59.4164, GNorm = 2.2692, lr_0 = 1.6059e-04
Loss = 1.5615e-03, PNorm = 59.4233, GNorm = 0.6585, lr_0 = 1.5539e-04
Validation rmse = 0.979045
Epoch 24
Loss = 9.5097e-04, PNorm = 59.4321, GNorm = 1.2603, lr_0 = 1.5036e-04
Loss = 1.3981e-03, PNorm = 59.4400, GNorm = 0.9832, lr_0 = 1.4550e-04
Loss = 1.3761e-03, PNorm = 59.4476, GNorm = 0.8627, lr_0 = 1.4079e-04
Validation rmse = 0.953316
Epoch 25
Loss = 1.5797e-03, PNorm = 59.4547, GNorm = 0.6150, lr_0 = 1.3623e-04
Loss = 1.0081e-03, PNorm = 59.4609, GNorm = 0.6656, lr_0 = 1.3183e-04
Loss = 1.5853e-03, PNorm = 59.4664, GNorm = 0.6157, lr_0 = 1.2756e-04
Validation rmse = 0.971190
Epoch 26
Loss = 1.2104e-03, PNorm = 59.4734, GNorm = 0.6791, lr_0 = 1.2343e-04
Loss = 1.2294e-03, PNorm = 59.4791, GNorm = 0.6044, lr_0 = 1.1944e-04
Validation rmse = 0.955300
Epoch 27
Loss = 1.1096e-03, PNorm = 59.4855, GNorm = 0.9830, lr_0 = 1.1557e-04
Loss = 1.1963e-03, PNorm = 59.4916, GNorm = 0.6229, lr_0 = 1.1183e-04
Loss = 1.3450e-03, PNorm = 59.4973, GNorm = 0.4458, lr_0 = 1.0821e-04
Validation rmse = 0.954760
Epoch 28
Loss = 1.2565e-03, PNorm = 59.5021, GNorm = 0.5100, lr_0 = 1.0437e-04
Loss = 1.1250e-03, PNorm = 59.5070, GNorm = 1.4872, lr_0 = 1.0099e-04
Validation rmse = 0.954547
Epoch 29
Loss = 1.1453e-03, PNorm = 59.5114, GNorm = 0.4570, lr_0 = 1.0000e-04
Loss = 1.1416e-03, PNorm = 59.5165, GNorm = 0.6250, lr_0 = 1.0000e-04
Loss = 1.2911e-03, PNorm = 59.5222, GNorm = 0.5390, lr_0 = 1.0000e-04
Validation rmse = 0.958681
Model 0 best validation rmse = 0.953316 on epoch 24
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.765224
Ensemble test rmse = 0.765224
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1500,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_1_hidden_size_1500/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1500, bias=False)
      (W_h): Linear(in_features=1500, out_features=1500, bias=False)
      (W_o): Linear(in_features=1633, out_features=1500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1, bias=True)
  )
)
Number of parameters = 4,923,001
Moving model to cuda
Epoch 0
Loss = 2.1315e-02, PNorm = 57.7388, GNorm = 5.5988, lr_0 = 2.9800e-04
Loss = 1.2950e-02, PNorm = 57.7762, GNorm = 3.7134, lr_0 = 4.7800e-04
Validation rmse = 1.377174
Epoch 1
Loss = 7.7572e-03, PNorm = 57.8401, GNorm = 8.8827, lr_0 = 6.7600e-04
Loss = 8.4901e-03, PNorm = 57.9064, GNorm = 1.6655, lr_0 = 8.5600e-04
Loss = 8.0216e-03, PNorm = 57.9935, GNorm = 4.4908, lr_0 = 9.9344e-04
Validation rmse = 1.373101
Epoch 2
Loss = 8.6478e-03, PNorm = 58.0780, GNorm = 5.1269, lr_0 = 9.6130e-04
Loss = 7.2580e-03, PNorm = 58.1719, GNorm = 6.0649, lr_0 = 9.3019e-04
Validation rmse = 1.061131
Epoch 3
Loss = 4.5555e-03, PNorm = 58.2411, GNorm = 1.9112, lr_0 = 9.0009e-04
Loss = 5.2634e-03, PNorm = 58.2969, GNorm = 2.0345, lr_0 = 8.7096e-04
Loss = 5.6989e-03, PNorm = 58.3613, GNorm = 4.2103, lr_0 = 8.4278e-04
Validation rmse = 0.978818
Epoch 4
Loss = 4.5521e-03, PNorm = 58.4230, GNorm = 1.9810, lr_0 = 8.1551e-04
Loss = 5.5196e-03, PNorm = 58.4869, GNorm = 2.1802, lr_0 = 7.8912e-04
Validation rmse = 1.161758
Epoch 5
Loss = 4.4327e-03, PNorm = 58.5395, GNorm = 2.3726, lr_0 = 7.6358e-04
Loss = 4.0781e-03, PNorm = 58.5980, GNorm = 1.6037, lr_0 = 7.3888e-04
Loss = 3.6910e-03, PNorm = 58.6433, GNorm = 2.4344, lr_0 = 7.1497e-04
Validation rmse = 0.862116
Epoch 6
Loss = 4.5439e-03, PNorm = 58.6872, GNorm = 6.3320, lr_0 = 6.8956e-04
Loss = 3.7862e-03, PNorm = 58.7273, GNorm = 1.6459, lr_0 = 6.6725e-04
Loss = 3.8161e-03, PNorm = 58.7696, GNorm = 2.3190, lr_0 = 6.4565e-04
Validation rmse = 0.805502
Epoch 7
Loss = 3.0980e-03, PNorm = 58.8116, GNorm = 2.3909, lr_0 = 6.2476e-04
Loss = 3.3640e-03, PNorm = 58.8525, GNorm = 0.6263, lr_0 = 6.0454e-04
Validation rmse = 0.782022
Epoch 8
Loss = 2.5136e-03, PNorm = 58.8923, GNorm = 3.6667, lr_0 = 5.8498e-04
Loss = 3.0770e-03, PNorm = 58.9297, GNorm = 1.3517, lr_0 = 5.6605e-04
Loss = 2.5080e-03, PNorm = 58.9664, GNorm = 0.8868, lr_0 = 5.4774e-04
Validation rmse = 0.876363
Epoch 9
Loss = 2.5797e-03, PNorm = 59.0013, GNorm = 1.6276, lr_0 = 5.3001e-04
Loss = 2.9846e-03, PNorm = 59.0395, GNorm = 1.5560, lr_0 = 5.1286e-04
Validation rmse = 0.846084
Epoch 10
Loss = 2.7385e-03, PNorm = 59.0704, GNorm = 1.9344, lr_0 = 4.9627e-04
Loss = 2.2297e-03, PNorm = 59.1036, GNorm = 1.3479, lr_0 = 4.8021e-04
Loss = 2.6909e-03, PNorm = 59.1348, GNorm = 1.4817, lr_0 = 4.6467e-04
Validation rmse = 0.863980
Epoch 11
Loss = 2.9070e-03, PNorm = 59.1649, GNorm = 2.7679, lr_0 = 4.4963e-04
Loss = 1.9671e-03, PNorm = 59.1929, GNorm = 0.4873, lr_0 = 4.3508e-04
Validation rmse = 0.796900
Epoch 12
Loss = 2.1062e-03, PNorm = 59.2199, GNorm = 1.0182, lr_0 = 4.1962e-04
Loss = 2.0240e-03, PNorm = 59.2466, GNorm = 0.6859, lr_0 = 4.0604e-04
Loss = 2.2207e-03, PNorm = 59.2716, GNorm = 0.7737, lr_0 = 3.9290e-04
Validation rmse = 0.953206
Epoch 13
Loss = 2.0601e-03, PNorm = 59.2927, GNorm = 1.4774, lr_0 = 3.8019e-04
Loss = 1.8500e-03, PNorm = 59.3119, GNorm = 1.1237, lr_0 = 3.6789e-04
Loss = 1.9881e-03, PNorm = 59.3315, GNorm = 0.9906, lr_0 = 3.5598e-04
Validation rmse = 0.812432
Epoch 14
Loss = 1.7877e-03, PNorm = 59.3526, GNorm = 0.5915, lr_0 = 3.4446e-04
Loss = 1.8649e-03, PNorm = 59.3708, GNorm = 1.1308, lr_0 = 3.3332e-04
Validation rmse = 0.767144
Epoch 15
Loss = 9.4148e-04, PNorm = 59.3899, GNorm = 0.9222, lr_0 = 3.2253e-04
Loss = 1.9361e-03, PNorm = 59.4105, GNorm = 0.8650, lr_0 = 3.1209e-04
Loss = 1.6878e-03, PNorm = 59.4290, GNorm = 1.2833, lr_0 = 3.0200e-04
Validation rmse = 0.809495
Epoch 16
Loss = 1.5793e-03, PNorm = 59.4483, GNorm = 1.3038, lr_0 = 2.9222e-04
Loss = 2.0076e-03, PNorm = 59.4645, GNorm = 2.9601, lr_0 = 2.8277e-04
Validation rmse = 0.751567
Epoch 17
Loss = 1.1231e-03, PNorm = 59.4799, GNorm = 0.7677, lr_0 = 2.7272e-04
Loss = 1.5853e-03, PNorm = 59.4945, GNorm = 0.9610, lr_0 = 2.6389e-04
Loss = 1.9304e-03, PNorm = 59.5097, GNorm = 1.9013, lr_0 = 2.5535e-04
Validation rmse = 0.786115
Epoch 18
Loss = 1.4144e-03, PNorm = 59.5241, GNorm = 1.1330, lr_0 = 2.4709e-04
Loss = 1.5246e-03, PNorm = 59.5388, GNorm = 0.7210, lr_0 = 2.3910e-04
Loss = 1.7597e-03, PNorm = 59.5481, GNorm = 1.8364, lr_0 = 2.3136e-04
Validation rmse = 0.781543
Epoch 19
Loss = 1.5897e-03, PNorm = 59.5589, GNorm = 0.5090, lr_0 = 2.2387e-04
Loss = 1.6456e-03, PNorm = 59.5739, GNorm = 0.5483, lr_0 = 2.1663e-04
Validation rmse = 0.754950
Epoch 20
Loss = 2.1060e-03, PNorm = 59.5867, GNorm = 1.0963, lr_0 = 2.0962e-04
Loss = 1.5163e-03, PNorm = 59.5981, GNorm = 1.3154, lr_0 = 2.0283e-04
Loss = 1.4899e-03, PNorm = 59.6091, GNorm = 0.5312, lr_0 = 1.9627e-04
Validation rmse = 0.759309
Epoch 21
Loss = 1.4555e-03, PNorm = 59.6212, GNorm = 1.5936, lr_0 = 1.8992e-04
Loss = 1.4048e-03, PNorm = 59.6315, GNorm = 0.7371, lr_0 = 1.8377e-04
Validation rmse = 0.759797
Epoch 22
Loss = 1.4170e-03, PNorm = 59.6399, GNorm = 0.7087, lr_0 = 1.7783e-04
Loss = 1.2094e-03, PNorm = 59.6479, GNorm = 0.9646, lr_0 = 1.7207e-04
Loss = 1.4992e-03, PNorm = 59.6563, GNorm = 0.7398, lr_0 = 1.6651e-04
Validation rmse = 0.807920
Epoch 23
Loss = 1.1240e-03, PNorm = 59.6642, GNorm = 0.6246, lr_0 = 1.6059e-04
Loss = 1.3490e-03, PNorm = 59.6709, GNorm = 0.4628, lr_0 = 1.5539e-04
Validation rmse = 0.841919
Epoch 24
Loss = 8.0098e-04, PNorm = 59.6778, GNorm = 0.8178, lr_0 = 1.5036e-04
Loss = 1.4488e-03, PNorm = 59.6853, GNorm = 0.6498, lr_0 = 1.4550e-04
Loss = 1.4195e-03, PNorm = 59.6918, GNorm = 0.5069, lr_0 = 1.4079e-04
Validation rmse = 0.791577
Epoch 25
Loss = 1.0214e-03, PNorm = 59.6983, GNorm = 0.8068, lr_0 = 1.3623e-04
Loss = 1.2012e-03, PNorm = 59.7041, GNorm = 0.8442, lr_0 = 1.3183e-04
Loss = 1.4151e-03, PNorm = 59.7093, GNorm = 0.5718, lr_0 = 1.2756e-04
Validation rmse = 0.760669
Epoch 26
Loss = 1.2126e-03, PNorm = 59.7129, GNorm = 0.4640, lr_0 = 1.2343e-04
Loss = 1.2780e-03, PNorm = 59.7194, GNorm = 0.7709, lr_0 = 1.1944e-04
Validation rmse = 0.778035
Epoch 27
Loss = 1.0983e-03, PNorm = 59.7247, GNorm = 0.9241, lr_0 = 1.1557e-04
Loss = 1.3355e-03, PNorm = 59.7310, GNorm = 0.5601, lr_0 = 1.1183e-04
Loss = 1.1804e-03, PNorm = 59.7369, GNorm = 0.4801, lr_0 = 1.0821e-04
Validation rmse = 0.764345
Epoch 28
Loss = 1.2021e-03, PNorm = 59.7419, GNorm = 1.4281, lr_0 = 1.0437e-04
Loss = 1.1187e-03, PNorm = 59.7460, GNorm = 0.5559, lr_0 = 1.0099e-04
Validation rmse = 0.748880
Epoch 29
Loss = 9.2828e-04, PNorm = 59.7511, GNorm = 1.0866, lr_0 = 1.0000e-04
Loss = 1.3208e-03, PNorm = 59.7560, GNorm = 1.8746, lr_0 = 1.0000e-04
Loss = 1.1627e-03, PNorm = 59.7621, GNorm = 0.8392, lr_0 = 1.0000e-04
Validation rmse = 0.790735
Model 0 best validation rmse = 0.748880 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.671508
Ensemble test rmse = 0.671508
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1500,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_1_hidden_size_1500/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1500, bias=False)
      (W_h): Linear(in_features=1500, out_features=1500, bias=False)
      (W_o): Linear(in_features=1633, out_features=1500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1, bias=True)
  )
)
Number of parameters = 4,923,001
Moving model to cuda
Epoch 0
Loss = 1.5653e-02, PNorm = 57.7437, GNorm = 3.7893, lr_0 = 2.9800e-04
Loss = 1.0955e-02, PNorm = 57.7818, GNorm = 4.5575, lr_0 = 4.7800e-04
Validation rmse = 1.829521
Epoch 1
Loss = 1.0604e-02, PNorm = 57.8502, GNorm = 2.8681, lr_0 = 6.7600e-04
Loss = 7.9636e-03, PNorm = 57.9267, GNorm = 3.4306, lr_0 = 8.5600e-04
Loss = 7.5943e-03, PNorm = 58.0074, GNorm = 6.0901, lr_0 = 9.9344e-04
Validation rmse = 1.447602
Epoch 2
Loss = 6.0016e-03, PNorm = 58.0906, GNorm = 4.4608, lr_0 = 9.6130e-04
Loss = 5.2343e-03, PNorm = 58.1565, GNorm = 5.6117, lr_0 = 9.3019e-04
Validation rmse = 1.330588
Epoch 3
Loss = 7.1210e-03, PNorm = 58.2268, GNorm = 4.2700, lr_0 = 9.0009e-04
Loss = 5.5879e-03, PNorm = 58.2974, GNorm = 1.2290, lr_0 = 8.7096e-04
Loss = 4.6113e-03, PNorm = 58.3580, GNorm = 1.3128, lr_0 = 8.4278e-04
Validation rmse = 1.147942
Epoch 4
Loss = 4.2907e-03, PNorm = 58.4128, GNorm = 1.5571, lr_0 = 8.1551e-04
Loss = 4.3047e-03, PNorm = 58.4709, GNorm = 1.0103, lr_0 = 7.8912e-04
Validation rmse = 1.125400
Epoch 5
Loss = 1.8123e-03, PNorm = 58.5165, GNorm = 0.6350, lr_0 = 7.6358e-04
Loss = 3.1285e-03, PNorm = 58.5563, GNorm = 1.0979, lr_0 = 7.3888e-04
Loss = 3.7283e-03, PNorm = 58.5940, GNorm = 1.8080, lr_0 = 7.1497e-04
Validation rmse = 1.168319
Epoch 6
Loss = 3.8562e-03, PNorm = 58.6454, GNorm = 3.6032, lr_0 = 6.8956e-04
Loss = 3.4898e-03, PNorm = 58.6910, GNorm = 1.6315, lr_0 = 6.6725e-04
Loss = 3.3043e-03, PNorm = 58.7245, GNorm = 1.4087, lr_0 = 6.4565e-04
Validation rmse = 1.025568
Epoch 7
Loss = 3.0398e-03, PNorm = 58.7593, GNorm = 2.0877, lr_0 = 6.2476e-04
Loss = 2.7989e-03, PNorm = 58.7903, GNorm = 0.8239, lr_0 = 6.0454e-04
Validation rmse = 1.027104
Epoch 8
Loss = 3.0777e-03, PNorm = 58.8194, GNorm = 1.6126, lr_0 = 5.8498e-04
Loss = 2.7955e-03, PNorm = 58.8542, GNorm = 0.7389, lr_0 = 5.6605e-04
Loss = 2.4197e-03, PNorm = 58.8875, GNorm = 0.8979, lr_0 = 5.4774e-04
Validation rmse = 1.067063
Epoch 9
Loss = 2.2595e-03, PNorm = 58.9113, GNorm = 0.8517, lr_0 = 5.3001e-04
Loss = 2.4727e-03, PNorm = 58.9358, GNorm = 0.9380, lr_0 = 5.1286e-04
Validation rmse = 1.090955
Epoch 10
Loss = 2.8839e-03, PNorm = 58.9617, GNorm = 1.1379, lr_0 = 4.9627e-04
Loss = 3.0567e-03, PNorm = 58.9860, GNorm = 1.4318, lr_0 = 4.8021e-04
Loss = 2.8538e-03, PNorm = 59.0078, GNorm = 0.8111, lr_0 = 4.6467e-04
Validation rmse = 1.008260
Epoch 11
Loss = 2.4215e-03, PNorm = 59.0370, GNorm = 0.8654, lr_0 = 4.4963e-04
Loss = 2.1342e-03, PNorm = 59.0587, GNorm = 1.9689, lr_0 = 4.3508e-04
Validation rmse = 0.974280
Epoch 12
Loss = 1.8104e-03, PNorm = 59.0823, GNorm = 0.8996, lr_0 = 4.1962e-04
Loss = 2.0875e-03, PNorm = 59.1002, GNorm = 3.7660, lr_0 = 4.0604e-04
Loss = 2.3864e-03, PNorm = 59.1217, GNorm = 3.0605, lr_0 = 3.9290e-04
Validation rmse = 1.014163
Epoch 13
Loss = 2.1897e-03, PNorm = 59.1438, GNorm = 0.8478, lr_0 = 3.8019e-04
Loss = 2.3523e-03, PNorm = 59.1650, GNorm = 2.2244, lr_0 = 3.6789e-04
Loss = 2.2270e-03, PNorm = 59.1832, GNorm = 1.0037, lr_0 = 3.5598e-04
Validation rmse = 0.963837
Epoch 14
Loss = 1.6957e-03, PNorm = 59.2001, GNorm = 0.9640, lr_0 = 3.4446e-04
Loss = 1.9641e-03, PNorm = 59.2148, GNorm = 0.5922, lr_0 = 3.3332e-04
Validation rmse = 0.986886
Epoch 15
Loss = 2.1911e-03, PNorm = 59.2287, GNorm = 0.8826, lr_0 = 3.2253e-04
Loss = 1.8588e-03, PNorm = 59.2426, GNorm = 0.7687, lr_0 = 3.1209e-04
Loss = 1.9995e-03, PNorm = 59.2587, GNorm = 0.7363, lr_0 = 3.0200e-04
Validation rmse = 0.969666
Epoch 16
Loss = 1.7564e-03, PNorm = 59.2709, GNorm = 0.9033, lr_0 = 2.9222e-04
Loss = 1.9179e-03, PNorm = 59.2874, GNorm = 1.1822, lr_0 = 2.8277e-04
Validation rmse = 1.028327
Epoch 17
Loss = 1.5090e-03, PNorm = 59.3031, GNorm = 2.8669, lr_0 = 2.7272e-04
Loss = 2.1788e-03, PNorm = 59.3214, GNorm = 0.6472, lr_0 = 2.6389e-04
Loss = 1.6654e-03, PNorm = 59.3331, GNorm = 1.5532, lr_0 = 2.5535e-04
Validation rmse = 0.957066
Epoch 18
Loss = 1.6049e-03, PNorm = 59.3428, GNorm = 0.9577, lr_0 = 2.4709e-04
Loss = 1.8748e-03, PNorm = 59.3527, GNorm = 1.9419, lr_0 = 2.3910e-04
Loss = 1.6938e-03, PNorm = 59.3659, GNorm = 1.2269, lr_0 = 2.3136e-04
Validation rmse = 0.969031
Epoch 19
Loss = 1.5729e-03, PNorm = 59.3771, GNorm = 1.7829, lr_0 = 2.2387e-04
Loss = 1.4951e-03, PNorm = 59.3856, GNorm = 1.3000, lr_0 = 2.1663e-04
Validation rmse = 0.991286
Epoch 20
Loss = 1.6657e-03, PNorm = 59.3950, GNorm = 1.4516, lr_0 = 2.0962e-04
Loss = 1.7944e-03, PNorm = 59.4043, GNorm = 0.4856, lr_0 = 2.0283e-04
Loss = 1.7471e-03, PNorm = 59.4162, GNorm = 1.4862, lr_0 = 1.9627e-04
Validation rmse = 0.967203
Epoch 21
Loss = 1.3685e-03, PNorm = 59.4249, GNorm = 0.7535, lr_0 = 1.8992e-04
Loss = 1.6313e-03, PNorm = 59.4340, GNorm = 0.6350, lr_0 = 1.8377e-04
Validation rmse = 0.965385
Epoch 22
Loss = 1.2352e-03, PNorm = 59.4434, GNorm = 1.0950, lr_0 = 1.7783e-04
Loss = 1.4727e-03, PNorm = 59.4526, GNorm = 0.9798, lr_0 = 1.7207e-04
Loss = 1.3884e-03, PNorm = 59.4608, GNorm = 0.8496, lr_0 = 1.6651e-04
Validation rmse = 0.969200
Epoch 23
Loss = 1.5495e-03, PNorm = 59.4668, GNorm = 0.6662, lr_0 = 1.6059e-04
Loss = 1.3955e-03, PNorm = 59.4737, GNorm = 0.7034, lr_0 = 1.5539e-04
Validation rmse = 0.965559
Epoch 24
Loss = 1.0294e-03, PNorm = 59.4805, GNorm = 1.5752, lr_0 = 1.5036e-04
Loss = 1.6282e-03, PNorm = 59.4883, GNorm = 1.0891, lr_0 = 1.4550e-04
Loss = 1.2511e-03, PNorm = 59.4946, GNorm = 0.7814, lr_0 = 1.4079e-04
Validation rmse = 0.967710
Epoch 25
Loss = 1.1095e-03, PNorm = 59.5016, GNorm = 0.6586, lr_0 = 1.3623e-04
Loss = 1.3764e-03, PNorm = 59.5080, GNorm = 0.8479, lr_0 = 1.3183e-04
Loss = 1.4356e-03, PNorm = 59.5132, GNorm = 1.1871, lr_0 = 1.2756e-04
Validation rmse = 0.998207
Epoch 26
Loss = 1.5769e-03, PNorm = 59.5174, GNorm = 0.7528, lr_0 = 1.2343e-04
Loss = 1.3608e-03, PNorm = 59.5232, GNorm = 0.5407, lr_0 = 1.1944e-04
Validation rmse = 0.959252
Epoch 27
Loss = 1.7591e-03, PNorm = 59.5287, GNorm = 1.0426, lr_0 = 1.1557e-04
Loss = 1.4559e-03, PNorm = 59.5346, GNorm = 0.4767, lr_0 = 1.1183e-04
Loss = 1.3474e-03, PNorm = 59.5392, GNorm = 1.0229, lr_0 = 1.0821e-04
Validation rmse = 0.955957
Epoch 28
Loss = 1.4469e-03, PNorm = 59.5455, GNorm = 0.8126, lr_0 = 1.0437e-04
Loss = 1.3006e-03, PNorm = 59.5505, GNorm = 0.5260, lr_0 = 1.0099e-04
Validation rmse = 0.962660
Epoch 29
Loss = 7.5037e-04, PNorm = 59.5554, GNorm = 0.5156, lr_0 = 1.0000e-04
Loss = 1.3668e-03, PNorm = 59.5599, GNorm = 1.1535, lr_0 = 1.0000e-04
Loss = 1.1164e-03, PNorm = 59.5643, GNorm = 0.6466, lr_0 = 1.0000e-04
Validation rmse = 0.968776
Model 0 best validation rmse = 0.955957 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.735066
Ensemble test rmse = 0.735066
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1500,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_1_hidden_size_1500/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1500, bias=False)
      (W_h): Linear(in_features=1500, out_features=1500, bias=False)
      (W_o): Linear(in_features=1633, out_features=1500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1, bias=True)
  )
)
Number of parameters = 4,923,001
Moving model to cuda
Epoch 0
Loss = 1.6905e-02, PNorm = 57.7425, GNorm = 7.9725, lr_0 = 2.9800e-04
Loss = 1.1774e-02, PNorm = 57.7816, GNorm = 1.6130, lr_0 = 4.7800e-04
Validation rmse = 1.749014
Epoch 1
Loss = 7.8214e-03, PNorm = 57.8405, GNorm = 2.1824, lr_0 = 6.7600e-04
Loss = 7.8140e-03, PNorm = 57.9083, GNorm = 6.3054, lr_0 = 8.5600e-04
Loss = 7.5494e-03, PNorm = 57.9868, GNorm = 2.0622, lr_0 = 9.9344e-04
Validation rmse = 1.401276
Epoch 2
Loss = 7.8748e-03, PNorm = 58.0732, GNorm = 1.7513, lr_0 = 9.6130e-04
Loss = 4.8992e-03, PNorm = 58.1471, GNorm = 2.7294, lr_0 = 9.3019e-04
Validation rmse = 1.103513
Epoch 3
Loss = 3.7309e-03, PNorm = 58.2059, GNorm = 1.3827, lr_0 = 9.0009e-04
Loss = 4.9040e-03, PNorm = 58.2627, GNorm = 3.2388, lr_0 = 8.7096e-04
Loss = 4.2688e-03, PNorm = 58.3221, GNorm = 1.2892, lr_0 = 8.4278e-04
Validation rmse = 1.090178
Epoch 4
Loss = 3.9013e-03, PNorm = 58.3736, GNorm = 1.1966, lr_0 = 8.1551e-04
Loss = 3.8737e-03, PNorm = 58.4194, GNorm = 2.3627, lr_0 = 7.8912e-04
Validation rmse = 1.038295
Epoch 5
Loss = 3.2119e-03, PNorm = 58.4695, GNorm = 1.1044, lr_0 = 7.6358e-04
Loss = 4.1657e-03, PNorm = 58.5142, GNorm = 2.1350, lr_0 = 7.3888e-04
Loss = 4.1437e-03, PNorm = 58.5574, GNorm = 5.1130, lr_0 = 7.1497e-04
Validation rmse = 1.086790
Epoch 6
Loss = 3.4134e-03, PNorm = 58.6061, GNorm = 1.1779, lr_0 = 6.8956e-04
Loss = 3.4563e-03, PNorm = 58.6438, GNorm = 1.2129, lr_0 = 6.6725e-04
Loss = 2.9066e-03, PNorm = 58.6768, GNorm = 3.0806, lr_0 = 6.4565e-04
Validation rmse = 0.967975
Epoch 7
Loss = 2.4348e-03, PNorm = 58.7117, GNorm = 0.6820, lr_0 = 6.2476e-04
Loss = 2.5772e-03, PNorm = 58.7439, GNorm = 1.0774, lr_0 = 6.0454e-04
Validation rmse = 1.023310
Epoch 8
Loss = 3.1116e-03, PNorm = 58.7761, GNorm = 1.8771, lr_0 = 5.8498e-04
Loss = 2.7459e-03, PNorm = 58.8132, GNorm = 0.5646, lr_0 = 5.6605e-04
Loss = 2.3787e-03, PNorm = 58.8425, GNorm = 1.1748, lr_0 = 5.4774e-04
Validation rmse = 0.894092
Epoch 9
Loss = 1.8120e-03, PNorm = 58.8683, GNorm = 0.4066, lr_0 = 5.3001e-04
Loss = 2.5630e-03, PNorm = 58.8951, GNorm = 0.7011, lr_0 = 5.1286e-04
Validation rmse = 0.922791
Epoch 10
Loss = 2.4812e-03, PNorm = 58.9282, GNorm = 3.2724, lr_0 = 4.9627e-04
Loss = 2.4535e-03, PNorm = 58.9590, GNorm = 2.2872, lr_0 = 4.8021e-04
Loss = 2.0274e-03, PNorm = 58.9864, GNorm = 2.5699, lr_0 = 4.6467e-04
Validation rmse = 0.867171
Epoch 11
Loss = 1.9693e-03, PNorm = 59.0137, GNorm = 1.1607, lr_0 = 4.4963e-04
Loss = 2.1206e-03, PNorm = 59.0384, GNorm = 0.9430, lr_0 = 4.3508e-04
Validation rmse = 0.873398
Epoch 12
Loss = 1.6162e-03, PNorm = 59.0613, GNorm = 1.7988, lr_0 = 4.1962e-04
Loss = 2.0516e-03, PNorm = 59.0860, GNorm = 0.8036, lr_0 = 4.0604e-04
Loss = 1.7209e-03, PNorm = 59.1111, GNorm = 0.7457, lr_0 = 3.9290e-04
Validation rmse = 0.860150
Epoch 13
Loss = 1.6836e-03, PNorm = 59.1261, GNorm = 1.7680, lr_0 = 3.8019e-04
Loss = 1.6905e-03, PNorm = 59.1486, GNorm = 0.7307, lr_0 = 3.6789e-04
Loss = 2.0184e-03, PNorm = 59.1680, GNorm = 1.2464, lr_0 = 3.5598e-04
Validation rmse = 0.835056
Epoch 14
Loss = 1.7666e-03, PNorm = 59.1911, GNorm = 1.1525, lr_0 = 3.4446e-04
Loss = 1.7187e-03, PNorm = 59.2121, GNorm = 0.8757, lr_0 = 3.3332e-04
Validation rmse = 0.948630
Epoch 15
Loss = 2.5257e-03, PNorm = 59.2294, GNorm = 1.8258, lr_0 = 3.2253e-04
Loss = 1.8414e-03, PNorm = 59.2500, GNorm = 0.6723, lr_0 = 3.1209e-04
Loss = 1.5596e-03, PNorm = 59.2694, GNorm = 0.9418, lr_0 = 3.0200e-04
Validation rmse = 0.841600
Epoch 16
Loss = 1.7701e-03, PNorm = 59.2887, GNorm = 0.5317, lr_0 = 2.9222e-04
Loss = 1.5613e-03, PNorm = 59.3025, GNorm = 1.1504, lr_0 = 2.8277e-04
Validation rmse = 0.797082
Epoch 17
Loss = 1.3512e-03, PNorm = 59.3208, GNorm = 0.9522, lr_0 = 2.7272e-04
Loss = 1.6349e-03, PNorm = 59.3358, GNorm = 0.7418, lr_0 = 2.6389e-04
Loss = 1.6461e-03, PNorm = 59.3462, GNorm = 0.7716, lr_0 = 2.5535e-04
Validation rmse = 0.817488
Epoch 18
Loss = 1.6012e-03, PNorm = 59.3601, GNorm = 1.0697, lr_0 = 2.4709e-04
Loss = 1.7196e-03, PNorm = 59.3731, GNorm = 2.7803, lr_0 = 2.3910e-04
Loss = 1.4824e-03, PNorm = 59.3859, GNorm = 0.7263, lr_0 = 2.3136e-04
Validation rmse = 0.839177
Epoch 19
Loss = 1.5880e-03, PNorm = 59.3988, GNorm = 0.6493, lr_0 = 2.2387e-04
Loss = 1.5669e-03, PNorm = 59.4081, GNorm = 1.2249, lr_0 = 2.1663e-04
Validation rmse = 0.779194
Epoch 20
Loss = 1.3720e-03, PNorm = 59.4191, GNorm = 1.7666, lr_0 = 2.0962e-04
Loss = 1.7308e-03, PNorm = 59.4296, GNorm = 0.6790, lr_0 = 2.0283e-04
Loss = 1.4888e-03, PNorm = 59.4391, GNorm = 0.7686, lr_0 = 1.9627e-04
Validation rmse = 0.914881
Epoch 21
Loss = 1.6004e-03, PNorm = 59.4486, GNorm = 1.2394, lr_0 = 1.8992e-04
Loss = 1.4646e-03, PNorm = 59.4592, GNorm = 0.5242, lr_0 = 1.8377e-04
Validation rmse = 0.787803
Epoch 22
Loss = 1.1120e-03, PNorm = 59.4699, GNorm = 0.5448, lr_0 = 1.7783e-04
Loss = 1.3990e-03, PNorm = 59.4800, GNorm = 0.7153, lr_0 = 1.7207e-04
Loss = 1.4010e-03, PNorm = 59.4876, GNorm = 0.6989, lr_0 = 1.6651e-04
Validation rmse = 0.790053
Epoch 23
Loss = 1.4318e-03, PNorm = 59.4956, GNorm = 0.3583, lr_0 = 1.6059e-04
Loss = 1.3165e-03, PNorm = 59.5046, GNorm = 1.3482, lr_0 = 1.5539e-04
Validation rmse = 0.769624
Epoch 24
Loss = 1.5057e-03, PNorm = 59.5139, GNorm = 0.7309, lr_0 = 1.5036e-04
Loss = 1.2880e-03, PNorm = 59.5219, GNorm = 1.1304, lr_0 = 1.4550e-04
Loss = 1.4766e-03, PNorm = 59.5286, GNorm = 1.8262, lr_0 = 1.4079e-04
Validation rmse = 0.806410
Epoch 25
Loss = 1.1686e-03, PNorm = 59.5350, GNorm = 0.5912, lr_0 = 1.3623e-04
Loss = 1.3165e-03, PNorm = 59.5411, GNorm = 1.5755, lr_0 = 1.3183e-04
Loss = 1.4334e-03, PNorm = 59.5479, GNorm = 0.9007, lr_0 = 1.2756e-04
Validation rmse = 0.759788
Epoch 26
Loss = 1.3408e-03, PNorm = 59.5564, GNorm = 1.1785, lr_0 = 1.2343e-04
Loss = 1.1850e-03, PNorm = 59.5623, GNorm = 1.2569, lr_0 = 1.1944e-04
Validation rmse = 0.793788
Epoch 27
Loss = 1.2236e-03, PNorm = 59.5681, GNorm = 1.3784, lr_0 = 1.1557e-04
Loss = 1.3068e-03, PNorm = 59.5735, GNorm = 0.6336, lr_0 = 1.1183e-04
Loss = 1.2122e-03, PNorm = 59.5786, GNorm = 0.7225, lr_0 = 1.0821e-04
Validation rmse = 0.766861
Epoch 28
Loss = 1.2491e-03, PNorm = 59.5832, GNorm = 1.0897, lr_0 = 1.0437e-04
Loss = 1.1533e-03, PNorm = 59.5881, GNorm = 0.9290, lr_0 = 1.0099e-04
Validation rmse = 0.774197
Epoch 29
Loss = 1.2638e-03, PNorm = 59.5937, GNorm = 1.8129, lr_0 = 1.0000e-04
Loss = 1.2576e-03, PNorm = 59.5995, GNorm = 1.2906, lr_0 = 1.0000e-04
Loss = 1.0832e-03, PNorm = 59.6032, GNorm = 1.2922, lr_0 = 1.0000e-04
Validation rmse = 0.760768
Model 0 best validation rmse = 0.759788 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.731550
Ensemble test rmse = 0.731550
10-fold cross validation
	Seed 0 ==> test rmse = 0.765903
	Seed 1 ==> test rmse = 0.666604
	Seed 2 ==> test rmse = 0.676900
	Seed 3 ==> test rmse = 0.891277
	Seed 4 ==> test rmse = 1.056082
	Seed 5 ==> test rmse = 0.704035
	Seed 6 ==> test rmse = 0.765224
	Seed 7 ==> test rmse = 0.671508
	Seed 8 ==> test rmse = 0.735066
	Seed 9 ==> test rmse = 0.731550
Overall test rmse = 0.766415 +/- 0.115140
Elapsed time = 0:08:26
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.35000000000000003_ffn_num_layers_1_hidden_size_1100/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 2,730,201
Moving model to cuda
Epoch 0
Loss = 1.7188e-02, PNorm = 50.2704, GNorm = 6.8984, lr_0 = 2.9800e-04
Loss = 1.2655e-02, PNorm = 50.2936, GNorm = 2.4557, lr_0 = 4.7800e-04
Validation rmse = 1.424036
Epoch 1
Loss = 1.0046e-02, PNorm = 50.3364, GNorm = 10.3142, lr_0 = 6.7600e-04
Loss = 7.9208e-03, PNorm = 50.3806, GNorm = 5.2430, lr_0 = 8.5600e-04
Loss = 8.8660e-03, PNorm = 50.4278, GNorm = 1.3303, lr_0 = 9.9344e-04
Validation rmse = 1.263217
Epoch 2
Loss = 7.5859e-03, PNorm = 50.4801, GNorm = 7.4860, lr_0 = 9.6130e-04
Loss = 5.6818e-03, PNorm = 50.5191, GNorm = 4.5503, lr_0 = 9.3019e-04
Validation rmse = 1.210434
Epoch 3
Loss = 4.8597e-03, PNorm = 50.5501, GNorm = 2.9028, lr_0 = 9.0009e-04
Loss = 5.4157e-03, PNorm = 50.5767, GNorm = 2.7944, lr_0 = 8.7096e-04
Loss = 5.6577e-03, PNorm = 50.6085, GNorm = 3.5533, lr_0 = 8.4278e-04
Validation rmse = 1.181792
Epoch 4
Loss = 4.3250e-03, PNorm = 50.6339, GNorm = 1.2289, lr_0 = 8.1551e-04
Loss = 4.9922e-03, PNorm = 50.6530, GNorm = 4.9248, lr_0 = 7.8912e-04
Validation rmse = 1.376411
Epoch 5
Loss = 5.5664e-03, PNorm = 50.6755, GNorm = 6.2774, lr_0 = 7.6358e-04
Loss = 5.2382e-03, PNorm = 50.7027, GNorm = 2.3329, lr_0 = 7.3888e-04
Loss = 4.4370e-03, PNorm = 50.7265, GNorm = 2.4468, lr_0 = 7.1497e-04
Validation rmse = 1.086051
Epoch 6
Loss = 3.5094e-03, PNorm = 50.7470, GNorm = 1.1227, lr_0 = 6.8956e-04
Loss = 3.8604e-03, PNorm = 50.7645, GNorm = 0.8572, lr_0 = 6.6725e-04
Loss = 3.2574e-03, PNorm = 50.7804, GNorm = 2.3269, lr_0 = 6.4565e-04
Validation rmse = 0.977332
Epoch 7
Loss = 2.6632e-03, PNorm = 50.7939, GNorm = 1.0229, lr_0 = 6.2476e-04
Loss = 3.3430e-03, PNorm = 50.8080, GNorm = 2.3440, lr_0 = 6.0454e-04
Validation rmse = 1.048411
Epoch 8
Loss = 2.7824e-03, PNorm = 50.8225, GNorm = 3.9297, lr_0 = 5.8498e-04
Loss = 3.3307e-03, PNorm = 50.8340, GNorm = 3.8442, lr_0 = 5.6605e-04
Loss = 2.9475e-03, PNorm = 50.8490, GNorm = 1.7258, lr_0 = 5.4774e-04
Validation rmse = 0.962597
Epoch 9
Loss = 2.6446e-03, PNorm = 50.8646, GNorm = 2.1638, lr_0 = 5.3001e-04
Loss = 2.8428e-03, PNorm = 50.8764, GNorm = 4.4723, lr_0 = 5.1286e-04
Validation rmse = 0.903861
Epoch 10
Loss = 2.6627e-03, PNorm = 50.8893, GNorm = 1.0095, lr_0 = 4.9627e-04
Loss = 2.5969e-03, PNorm = 50.9050, GNorm = 1.9317, lr_0 = 4.8021e-04
Loss = 2.9948e-03, PNorm = 50.9163, GNorm = 2.1543, lr_0 = 4.6467e-04
Validation rmse = 0.890393
Epoch 11
Loss = 2.4935e-03, PNorm = 50.9287, GNorm = 1.7659, lr_0 = 4.4963e-04
Loss = 2.4648e-03, PNorm = 50.9408, GNorm = 1.2910, lr_0 = 4.3508e-04
Validation rmse = 0.896980
Epoch 12
Loss = 2.3570e-03, PNorm = 50.9531, GNorm = 0.9902, lr_0 = 4.1962e-04
Loss = 2.6526e-03, PNorm = 50.9640, GNorm = 3.0146, lr_0 = 4.0604e-04
Loss = 2.9699e-03, PNorm = 50.9761, GNorm = 4.2212, lr_0 = 3.9290e-04
Validation rmse = 0.899109
Epoch 13
Loss = 2.4388e-03, PNorm = 50.9866, GNorm = 1.2560, lr_0 = 3.8019e-04
Loss = 2.6660e-03, PNorm = 50.9982, GNorm = 1.3380, lr_0 = 3.6789e-04
Loss = 2.4050e-03, PNorm = 51.0080, GNorm = 1.7762, lr_0 = 3.5598e-04
Validation rmse = 0.972176
Epoch 14
Loss = 2.3389e-03, PNorm = 51.0169, GNorm = 1.4211, lr_0 = 3.4446e-04
Loss = 2.3160e-03, PNorm = 51.0251, GNorm = 2.5678, lr_0 = 3.3332e-04
Validation rmse = 0.898165
Epoch 15
Loss = 2.0613e-03, PNorm = 51.0336, GNorm = 1.5731, lr_0 = 3.2253e-04
Loss = 2.2368e-03, PNorm = 51.0393, GNorm = 2.1559, lr_0 = 3.1209e-04
Loss = 1.8573e-03, PNorm = 51.0479, GNorm = 1.0735, lr_0 = 3.0200e-04
Validation rmse = 0.937417
Epoch 16
Loss = 1.9639e-03, PNorm = 51.0557, GNorm = 0.8084, lr_0 = 2.9222e-04
Loss = 2.1835e-03, PNorm = 51.0651, GNorm = 2.6530, lr_0 = 2.8277e-04
Validation rmse = 0.897872
Epoch 17
Loss = 2.0361e-03, PNorm = 51.0719, GNorm = 2.1579, lr_0 = 2.7272e-04
Loss = 1.7369e-03, PNorm = 51.0792, GNorm = 0.6759, lr_0 = 2.6389e-04
Loss = 1.7295e-03, PNorm = 51.0866, GNorm = 0.7221, lr_0 = 2.5535e-04
Validation rmse = 0.875537
Epoch 18
Loss = 1.8413e-03, PNorm = 51.0928, GNorm = 1.4857, lr_0 = 2.4709e-04
Loss = 2.0182e-03, PNorm = 51.0985, GNorm = 1.6287, lr_0 = 2.3910e-04
Loss = 1.6548e-03, PNorm = 51.1044, GNorm = 2.3941, lr_0 = 2.3136e-04
Validation rmse = 0.857253
Epoch 19
Loss = 1.8565e-03, PNorm = 51.1107, GNorm = 2.0120, lr_0 = 2.2387e-04
Loss = 1.9484e-03, PNorm = 51.1155, GNorm = 0.8901, lr_0 = 2.1663e-04
Validation rmse = 0.864257
Epoch 20
Loss = 1.2971e-03, PNorm = 51.1204, GNorm = 1.1326, lr_0 = 2.0962e-04
Loss = 1.7424e-03, PNorm = 51.1246, GNorm = 1.1141, lr_0 = 2.0283e-04
Loss = 1.6020e-03, PNorm = 51.1282, GNorm = 0.8861, lr_0 = 1.9627e-04
Validation rmse = 0.871011
Epoch 21
Loss = 1.5835e-03, PNorm = 51.1335, GNorm = 1.5757, lr_0 = 1.8992e-04
Loss = 1.5647e-03, PNorm = 51.1372, GNorm = 1.2701, lr_0 = 1.8377e-04
Validation rmse = 0.842858
Epoch 22
Loss = 1.6079e-03, PNorm = 51.1418, GNorm = 1.4419, lr_0 = 1.7783e-04
Loss = 1.5492e-03, PNorm = 51.1465, GNorm = 1.1239, lr_0 = 1.7207e-04
Loss = 1.6843e-03, PNorm = 51.1501, GNorm = 0.8578, lr_0 = 1.6651e-04
Validation rmse = 0.838198
Epoch 23
Loss = 1.6129e-03, PNorm = 51.1538, GNorm = 1.1339, lr_0 = 1.6059e-04
Loss = 1.6771e-03, PNorm = 51.1579, GNorm = 0.7497, lr_0 = 1.5539e-04
Validation rmse = 0.866323
Epoch 24
Loss = 1.1183e-03, PNorm = 51.1619, GNorm = 0.9430, lr_0 = 1.5036e-04
Loss = 1.5159e-03, PNorm = 51.1659, GNorm = 1.2983, lr_0 = 1.4550e-04
Loss = 1.5777e-03, PNorm = 51.1697, GNorm = 2.0659, lr_0 = 1.4079e-04
Validation rmse = 0.950472
Epoch 25
Loss = 1.6792e-03, PNorm = 51.1727, GNorm = 1.5486, lr_0 = 1.3623e-04
Loss = 1.5097e-03, PNorm = 51.1755, GNorm = 1.4802, lr_0 = 1.3183e-04
Loss = 1.5887e-03, PNorm = 51.1782, GNorm = 0.8179, lr_0 = 1.2756e-04
Validation rmse = 0.836539
Epoch 26
Loss = 1.2940e-03, PNorm = 51.1818, GNorm = 1.3010, lr_0 = 1.2343e-04
Loss = 1.4512e-03, PNorm = 51.1840, GNorm = 1.0592, lr_0 = 1.1944e-04
Validation rmse = 0.843124
Epoch 27
Loss = 1.5684e-03, PNorm = 51.1871, GNorm = 1.7281, lr_0 = 1.1557e-04
Loss = 1.6238e-03, PNorm = 51.1904, GNorm = 1.0718, lr_0 = 1.1183e-04
Loss = 1.4137e-03, PNorm = 51.1926, GNorm = 0.9492, lr_0 = 1.0821e-04
Validation rmse = 0.880045
Epoch 28
Loss = 1.6582e-03, PNorm = 51.1954, GNorm = 2.6467, lr_0 = 1.0437e-04
Loss = 1.4156e-03, PNorm = 51.1977, GNorm = 1.0986, lr_0 = 1.0099e-04
Validation rmse = 0.837215
Epoch 29
Loss = 1.7842e-03, PNorm = 51.1994, GNorm = 1.1441, lr_0 = 1.0000e-04
Loss = 1.2808e-03, PNorm = 51.2014, GNorm = 0.9177, lr_0 = 1.0000e-04
Loss = 1.5628e-03, PNorm = 51.2034, GNorm = 2.4483, lr_0 = 1.0000e-04
Validation rmse = 0.820157
Model 0 best validation rmse = 0.820157 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.785946
Ensemble test rmse = 0.785946
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.35000000000000003_ffn_num_layers_1_hidden_size_1100/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 2,730,201
Moving model to cuda
Epoch 0
Loss = 2.0199e-02, PNorm = 50.2689, GNorm = 4.2596, lr_0 = 2.9800e-04
Loss = 1.4034e-02, PNorm = 50.2903, GNorm = 6.0338, lr_0 = 4.7800e-04
Validation rmse = 1.614242
Epoch 1
Loss = 8.9603e-03, PNorm = 50.3298, GNorm = 2.4458, lr_0 = 6.7600e-04
Loss = 1.2467e-02, PNorm = 50.3711, GNorm = 2.8102, lr_0 = 8.5600e-04
Loss = 7.4773e-03, PNorm = 50.4222, GNorm = 3.6811, lr_0 = 9.9344e-04
Validation rmse = 1.570150
Epoch 2
Loss = 8.6686e-03, PNorm = 50.4712, GNorm = 8.7090, lr_0 = 9.6130e-04
Loss = 9.1741e-03, PNorm = 50.5124, GNorm = 3.4583, lr_0 = 9.3019e-04
Validation rmse = 1.273885
Epoch 3
Loss = 6.4746e-03, PNorm = 50.5542, GNorm = 2.7968, lr_0 = 9.0009e-04
Loss = 6.5773e-03, PNorm = 50.5807, GNorm = 1.5589, lr_0 = 8.7096e-04
Loss = 6.0355e-03, PNorm = 50.6035, GNorm = 4.7938, lr_0 = 8.4278e-04
Validation rmse = 1.346748
Epoch 4
Loss = 5.5737e-03, PNorm = 50.6266, GNorm = 1.5562, lr_0 = 8.1551e-04
Loss = 3.7382e-03, PNorm = 50.6463, GNorm = 2.6992, lr_0 = 7.8912e-04
Validation rmse = 1.055015
Epoch 5
Loss = 2.8132e-03, PNorm = 50.6663, GNorm = 1.2407, lr_0 = 7.6358e-04
Loss = 4.2685e-03, PNorm = 50.6872, GNorm = 4.9883, lr_0 = 7.3888e-04
Loss = 4.0569e-03, PNorm = 50.7098, GNorm = 3.6343, lr_0 = 7.1497e-04
Validation rmse = 1.011867
Epoch 6
Loss = 4.1877e-03, PNorm = 50.7330, GNorm = 1.9202, lr_0 = 6.8956e-04
Loss = 3.4713e-03, PNorm = 50.7540, GNorm = 1.8122, lr_0 = 6.6725e-04
Loss = 3.3113e-03, PNorm = 50.7698, GNorm = 1.4188, lr_0 = 6.4565e-04
Validation rmse = 0.869658
Epoch 7
Loss = 3.4024e-03, PNorm = 50.7867, GNorm = 3.2964, lr_0 = 6.2476e-04
Loss = 3.7765e-03, PNorm = 50.8014, GNorm = 6.5970, lr_0 = 6.0454e-04
Validation rmse = 1.130654
Epoch 8
Loss = 5.0202e-03, PNorm = 50.8207, GNorm = 3.5875, lr_0 = 5.8498e-04
Loss = 4.3511e-03, PNorm = 50.8416, GNorm = 4.9903, lr_0 = 5.6605e-04
Loss = 3.3481e-03, PNorm = 50.8603, GNorm = 1.1274, lr_0 = 5.4774e-04
Validation rmse = 0.862284
Epoch 9
Loss = 3.4337e-03, PNorm = 50.8765, GNorm = 2.9789, lr_0 = 5.3001e-04
Loss = 3.6904e-03, PNorm = 50.8950, GNorm = 2.4377, lr_0 = 5.1286e-04
Validation rmse = 0.785107
Epoch 10
Loss = 2.4856e-03, PNorm = 50.9095, GNorm = 2.4659, lr_0 = 4.9627e-04
Loss = 2.9329e-03, PNorm = 50.9215, GNorm = 0.9831, lr_0 = 4.8021e-04
Loss = 2.3833e-03, PNorm = 50.9338, GNorm = 1.6399, lr_0 = 4.6467e-04
Validation rmse = 0.788859
Epoch 11
Loss = 2.5222e-03, PNorm = 50.9455, GNorm = 1.9590, lr_0 = 4.4963e-04
Loss = 2.5440e-03, PNorm = 50.9549, GNorm = 1.2071, lr_0 = 4.3508e-04
Validation rmse = 0.771652
Epoch 12
Loss = 2.9310e-03, PNorm = 50.9665, GNorm = 1.5223, lr_0 = 4.1962e-04
Loss = 2.8117e-03, PNorm = 50.9793, GNorm = 1.6426, lr_0 = 4.0604e-04
Loss = 2.8267e-03, PNorm = 50.9913, GNorm = 0.6349, lr_0 = 3.9290e-04
Validation rmse = 0.810405
Epoch 13
Loss = 2.3715e-03, PNorm = 51.0021, GNorm = 1.3724, lr_0 = 3.8019e-04
Loss = 2.6169e-03, PNorm = 51.0133, GNorm = 2.4986, lr_0 = 3.6789e-04
Loss = 2.6295e-03, PNorm = 51.0225, GNorm = 1.6171, lr_0 = 3.5598e-04
Validation rmse = 0.800522
Epoch 14
Loss = 2.3934e-03, PNorm = 51.0321, GNorm = 0.9439, lr_0 = 3.4446e-04
Loss = 1.9672e-03, PNorm = 51.0410, GNorm = 1.6665, lr_0 = 3.3332e-04
Validation rmse = 0.779547
Epoch 15
Loss = 1.9821e-03, PNorm = 51.0486, GNorm = 2.2426, lr_0 = 3.2253e-04
Loss = 2.3894e-03, PNorm = 51.0560, GNorm = 4.1926, lr_0 = 3.1209e-04
Loss = 2.3511e-03, PNorm = 51.0641, GNorm = 1.1813, lr_0 = 3.0200e-04
Validation rmse = 0.882073
Epoch 16
Loss = 2.8454e-03, PNorm = 51.0721, GNorm = 3.5964, lr_0 = 2.9222e-04
Loss = 1.5688e-03, PNorm = 51.0783, GNorm = 1.6077, lr_0 = 2.8277e-04
Validation rmse = 0.709926
Epoch 17
Loss = 1.7870e-03, PNorm = 51.0857, GNorm = 0.5537, lr_0 = 2.7272e-04
Loss = 2.0268e-03, PNorm = 51.0920, GNorm = 0.9565, lr_0 = 2.6389e-04
Loss = 2.0271e-03, PNorm = 51.0988, GNorm = 2.7262, lr_0 = 2.5535e-04
Validation rmse = 0.814152
Epoch 18
Loss = 1.8017e-03, PNorm = 51.1046, GNorm = 1.8107, lr_0 = 2.4709e-04
Loss = 2.0588e-03, PNorm = 51.1104, GNorm = 1.2429, lr_0 = 2.3910e-04
Loss = 1.8747e-03, PNorm = 51.1158, GNorm = 1.4191, lr_0 = 2.3136e-04
Validation rmse = 0.779665
Epoch 19
Loss = 1.8655e-03, PNorm = 51.1201, GNorm = 1.8506, lr_0 = 2.2387e-04
Loss = 1.8721e-03, PNorm = 51.1261, GNorm = 1.2744, lr_0 = 2.1663e-04
Validation rmse = 0.712623
Epoch 20
Loss = 1.9397e-03, PNorm = 51.1317, GNorm = 2.3298, lr_0 = 2.0962e-04
Loss = 2.0396e-03, PNorm = 51.1377, GNorm = 0.9156, lr_0 = 2.0283e-04
Loss = 1.6804e-03, PNorm = 51.1416, GNorm = 1.4244, lr_0 = 1.9627e-04
Validation rmse = 0.699594
Epoch 21
Loss = 1.7974e-03, PNorm = 51.1450, GNorm = 1.9296, lr_0 = 1.8992e-04
Loss = 1.8357e-03, PNorm = 51.1488, GNorm = 2.2900, lr_0 = 1.8377e-04
Validation rmse = 0.738351
Epoch 22
Loss = 1.4694e-03, PNorm = 51.1530, GNorm = 1.0476, lr_0 = 1.7783e-04
Loss = 1.7239e-03, PNorm = 51.1571, GNorm = 1.7578, lr_0 = 1.7207e-04
Loss = 1.6832e-03, PNorm = 51.1614, GNorm = 1.1137, lr_0 = 1.6651e-04
Validation rmse = 0.691469
Epoch 23
Loss = 1.7924e-03, PNorm = 51.1669, GNorm = 2.9107, lr_0 = 1.6059e-04
Loss = 1.7269e-03, PNorm = 51.1708, GNorm = 1.7991, lr_0 = 1.5539e-04
Validation rmse = 0.865935
Epoch 24
Loss = 1.7371e-03, PNorm = 51.1741, GNorm = 2.5306, lr_0 = 1.5036e-04
Loss = 2.0102e-03, PNorm = 51.1777, GNorm = 1.4414, lr_0 = 1.4550e-04
Loss = 1.7769e-03, PNorm = 51.1817, GNorm = 0.9476, lr_0 = 1.4079e-04
Validation rmse = 0.717714
Epoch 25
Loss = 1.4374e-03, PNorm = 51.1844, GNorm = 1.3080, lr_0 = 1.3623e-04
Loss = 1.6798e-03, PNorm = 51.1867, GNorm = 1.3547, lr_0 = 1.3183e-04
Loss = 1.9213e-03, PNorm = 51.1900, GNorm = 1.0317, lr_0 = 1.2756e-04
Validation rmse = 0.726872
Epoch 26
Loss = 1.7657e-03, PNorm = 51.1927, GNorm = 0.9448, lr_0 = 1.2343e-04
Loss = 1.7179e-03, PNorm = 51.1961, GNorm = 1.3242, lr_0 = 1.1944e-04
Validation rmse = 0.712833
Epoch 27
Loss = 1.6402e-03, PNorm = 51.1981, GNorm = 0.6759, lr_0 = 1.1557e-04
Loss = 1.4981e-03, PNorm = 51.2005, GNorm = 3.0838, lr_0 = 1.1183e-04
Loss = 1.7848e-03, PNorm = 51.2033, GNorm = 0.5510, lr_0 = 1.0821e-04
Validation rmse = 0.772789
Epoch 28
Loss = 1.6732e-03, PNorm = 51.2066, GNorm = 1.1941, lr_0 = 1.0437e-04
Loss = 1.4784e-03, PNorm = 51.2083, GNorm = 0.7854, lr_0 = 1.0099e-04
Validation rmse = 0.856773
Epoch 29
Loss = 2.3226e-03, PNorm = 51.2102, GNorm = 3.7140, lr_0 = 1.0000e-04
Loss = 1.6455e-03, PNorm = 51.2133, GNorm = 1.3618, lr_0 = 1.0000e-04
Loss = 1.6021e-03, PNorm = 51.2157, GNorm = 1.0036, lr_0 = 1.0000e-04
Validation rmse = 0.768396
Model 0 best validation rmse = 0.691469 on epoch 22
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.691085
Ensemble test rmse = 0.691085
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.35000000000000003_ffn_num_layers_1_hidden_size_1100/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 2,730,201
Moving model to cuda
Epoch 0
Loss = 2.1270e-02, PNorm = 50.2692, GNorm = 3.6907, lr_0 = 2.9800e-04
Loss = 1.4121e-02, PNorm = 50.2896, GNorm = 3.1158, lr_0 = 4.7800e-04
Validation rmse = 1.301115
Epoch 1
Loss = 1.0387e-02, PNorm = 50.3295, GNorm = 13.8567, lr_0 = 6.7600e-04
Loss = 9.0776e-03, PNorm = 50.3692, GNorm = 6.8171, lr_0 = 8.5600e-04
Loss = 9.7423e-03, PNorm = 50.4204, GNorm = 2.9454, lr_0 = 9.9344e-04
Validation rmse = 1.462365
Epoch 2
Loss = 7.0738e-03, PNorm = 50.4723, GNorm = 3.3757, lr_0 = 9.6130e-04
Loss = 7.3296e-03, PNorm = 50.5059, GNorm = 2.9802, lr_0 = 9.3019e-04
Validation rmse = 1.143989
Epoch 3
Loss = 6.0214e-03, PNorm = 50.5414, GNorm = 3.4907, lr_0 = 9.0009e-04
Loss = 4.9874e-03, PNorm = 50.5696, GNorm = 3.3307, lr_0 = 8.7096e-04
Loss = 4.8720e-03, PNorm = 50.5970, GNorm = 4.9790, lr_0 = 8.4278e-04
Validation rmse = 1.038839
Epoch 4
Loss = 4.9491e-03, PNorm = 50.6205, GNorm = 2.1868, lr_0 = 8.1551e-04
Loss = 5.0153e-03, PNorm = 50.6450, GNorm = 0.9328, lr_0 = 7.8912e-04
Validation rmse = 0.910920
Epoch 5
Loss = 5.4812e-03, PNorm = 50.6685, GNorm = 3.3509, lr_0 = 7.6358e-04
Loss = 3.9516e-03, PNorm = 50.6913, GNorm = 3.1347, lr_0 = 7.3888e-04
Loss = 3.8749e-03, PNorm = 50.7129, GNorm = 3.7536, lr_0 = 7.1497e-04
Validation rmse = 0.871359
Epoch 6
Loss = 3.9273e-03, PNorm = 50.7307, GNorm = 4.4167, lr_0 = 6.8956e-04
Loss = 3.0734e-03, PNorm = 50.7465, GNorm = 1.6113, lr_0 = 6.6725e-04
Loss = 3.7599e-03, PNorm = 50.7631, GNorm = 2.3362, lr_0 = 6.4565e-04
Validation rmse = 0.830433
Epoch 7
Loss = 3.5646e-03, PNorm = 50.7804, GNorm = 3.6531, lr_0 = 6.2476e-04
Loss = 3.3746e-03, PNorm = 50.8009, GNorm = 2.5829, lr_0 = 6.0454e-04
Validation rmse = 0.777055
Epoch 8
Loss = 3.4612e-03, PNorm = 50.8189, GNorm = 1.4326, lr_0 = 5.8498e-04
Loss = 2.7364e-03, PNorm = 50.8354, GNorm = 1.2740, lr_0 = 5.6605e-04
Loss = 2.7861e-03, PNorm = 50.8501, GNorm = 3.3632, lr_0 = 5.4774e-04
Validation rmse = 0.723024
Epoch 9
Loss = 3.1073e-03, PNorm = 50.8641, GNorm = 2.6471, lr_0 = 5.3001e-04
Loss = 2.8765e-03, PNorm = 50.8783, GNorm = 3.9522, lr_0 = 5.1286e-04
Validation rmse = 0.754855
Epoch 10
Loss = 2.7039e-03, PNorm = 50.8924, GNorm = 1.4618, lr_0 = 4.9627e-04
Loss = 2.9441e-03, PNorm = 50.9033, GNorm = 3.3820, lr_0 = 4.8021e-04
Loss = 3.0641e-03, PNorm = 50.9190, GNorm = 2.9471, lr_0 = 4.6467e-04
Validation rmse = 0.711966
Epoch 11
Loss = 2.6359e-03, PNorm = 50.9310, GNorm = 1.2070, lr_0 = 4.4963e-04
Loss = 2.6261e-03, PNorm = 50.9401, GNorm = 1.6225, lr_0 = 4.3508e-04
Validation rmse = 0.741920
Epoch 12
Loss = 1.3547e-03, PNorm = 50.9532, GNorm = 1.1566, lr_0 = 4.1962e-04
Loss = 2.6423e-03, PNorm = 50.9633, GNorm = 2.3212, lr_0 = 4.0604e-04
Loss = 2.0473e-03, PNorm = 50.9720, GNorm = 1.1522, lr_0 = 3.9290e-04
Validation rmse = 0.684933
Epoch 13
Loss = 1.8852e-03, PNorm = 50.9818, GNorm = 0.9277, lr_0 = 3.8019e-04
Loss = 2.3051e-03, PNorm = 50.9895, GNorm = 3.8529, lr_0 = 3.6789e-04
Loss = 2.3477e-03, PNorm = 50.9979, GNorm = 1.4708, lr_0 = 3.5598e-04
Validation rmse = 0.842623
Epoch 14
Loss = 2.0735e-03, PNorm = 51.0049, GNorm = 1.6112, lr_0 = 3.4446e-04
Loss = 2.3843e-03, PNorm = 51.0143, GNorm = 0.9852, lr_0 = 3.3332e-04
Validation rmse = 0.937483
Epoch 15
Loss = 2.8468e-03, PNorm = 51.0229, GNorm = 3.1012, lr_0 = 3.2253e-04
Loss = 2.4257e-03, PNorm = 51.0342, GNorm = 3.3404, lr_0 = 3.1209e-04
Loss = 2.9732e-03, PNorm = 51.0443, GNorm = 1.6744, lr_0 = 3.0200e-04
Validation rmse = 0.681583
Epoch 16
Loss = 2.3007e-03, PNorm = 51.0534, GNorm = 1.0615, lr_0 = 2.9222e-04
Loss = 1.9821e-03, PNorm = 51.0610, GNorm = 0.7423, lr_0 = 2.8277e-04
Validation rmse = 0.686245
Epoch 17
Loss = 1.3567e-03, PNorm = 51.0682, GNorm = 1.4188, lr_0 = 2.7272e-04
Loss = 2.0025e-03, PNorm = 51.0734, GNorm = 1.3372, lr_0 = 2.6389e-04
Loss = 2.2473e-03, PNorm = 51.0798, GNorm = 3.1204, lr_0 = 2.5535e-04
Validation rmse = 0.712868
Epoch 18
Loss = 1.8548e-03, PNorm = 51.0865, GNorm = 1.3405, lr_0 = 2.4709e-04
Loss = 2.1521e-03, PNorm = 51.0924, GNorm = 2.9811, lr_0 = 2.3910e-04
Loss = 1.8335e-03, PNorm = 51.0989, GNorm = 1.4786, lr_0 = 2.3136e-04
Validation rmse = 0.697171
Epoch 19
Loss = 2.3967e-03, PNorm = 51.1051, GNorm = 1.1088, lr_0 = 2.2387e-04
Loss = 1.7371e-03, PNorm = 51.1104, GNorm = 1.1448, lr_0 = 2.1663e-04
Validation rmse = 0.732238
Epoch 20
Loss = 2.0262e-03, PNorm = 51.1152, GNorm = 3.2356, lr_0 = 2.0962e-04
Loss = 1.8848e-03, PNorm = 51.1205, GNorm = 1.7973, lr_0 = 2.0283e-04
Loss = 1.6403e-03, PNorm = 51.1256, GNorm = 1.8615, lr_0 = 1.9627e-04
Validation rmse = 0.795176
Epoch 21
Loss = 1.8941e-03, PNorm = 51.1294, GNorm = 1.0230, lr_0 = 1.8992e-04
Loss = 2.2201e-03, PNorm = 51.1352, GNorm = 3.7772, lr_0 = 1.8377e-04
Validation rmse = 0.737325
Epoch 22
Loss = 1.9385e-03, PNorm = 51.1396, GNorm = 2.6568, lr_0 = 1.7783e-04
Loss = 2.0065e-03, PNorm = 51.1445, GNorm = 0.5965, lr_0 = 1.7207e-04
Loss = 1.7512e-03, PNorm = 51.1480, GNorm = 0.7261, lr_0 = 1.6651e-04
Validation rmse = 0.701477
Epoch 23
Loss = 1.8116e-03, PNorm = 51.1517, GNorm = 0.8503, lr_0 = 1.6059e-04
Loss = 1.7179e-03, PNorm = 51.1546, GNorm = 0.8574, lr_0 = 1.5539e-04
Validation rmse = 0.682126
Epoch 24
Loss = 1.4501e-03, PNorm = 51.1579, GNorm = 0.6273, lr_0 = 1.5036e-04
Loss = 1.5531e-03, PNorm = 51.1610, GNorm = 1.3738, lr_0 = 1.4550e-04
Loss = 1.5495e-03, PNorm = 51.1644, GNorm = 2.2805, lr_0 = 1.4079e-04
Validation rmse = 0.660259
Epoch 25
Loss = 1.8863e-03, PNorm = 51.1680, GNorm = 4.0024, lr_0 = 1.3623e-04
Loss = 1.6572e-03, PNorm = 51.1729, GNorm = 1.2625, lr_0 = 1.3183e-04
Loss = 1.5043e-03, PNorm = 51.1747, GNorm = 1.0704, lr_0 = 1.2756e-04
Validation rmse = 0.686813
Epoch 26
Loss = 1.6073e-03, PNorm = 51.1769, GNorm = 2.5638, lr_0 = 1.2343e-04
Loss = 1.6145e-03, PNorm = 51.1797, GNorm = 0.9771, lr_0 = 1.1944e-04
Validation rmse = 0.706234
Epoch 27
Loss = 1.8401e-03, PNorm = 51.1822, GNorm = 1.5966, lr_0 = 1.1557e-04
Loss = 1.6740e-03, PNorm = 51.1850, GNorm = 0.8270, lr_0 = 1.1183e-04
Loss = 1.4024e-03, PNorm = 51.1872, GNorm = 1.3002, lr_0 = 1.0821e-04
Validation rmse = 0.697519
Epoch 28
Loss = 1.4733e-03, PNorm = 51.1900, GNorm = 1.1603, lr_0 = 1.0437e-04
Loss = 1.7231e-03, PNorm = 51.1923, GNorm = 0.7790, lr_0 = 1.0099e-04
Validation rmse = 0.656929
Epoch 29
Loss = 1.6372e-03, PNorm = 51.1945, GNorm = 0.9041, lr_0 = 1.0000e-04
Loss = 1.5623e-03, PNorm = 51.1974, GNorm = 2.0695, lr_0 = 1.0000e-04
Loss = 1.4119e-03, PNorm = 51.1991, GNorm = 0.7889, lr_0 = 1.0000e-04
Validation rmse = 0.663876
Model 0 best validation rmse = 0.656929 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.703005
Ensemble test rmse = 0.703005
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.35000000000000003_ffn_num_layers_1_hidden_size_1100/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 2,730,201
Moving model to cuda
Epoch 0
Loss = 2.0676e-02, PNorm = 50.2682, GNorm = 7.0616, lr_0 = 2.9800e-04
Loss = 1.4172e-02, PNorm = 50.2896, GNorm = 7.0539, lr_0 = 4.7800e-04
Validation rmse = 1.394844
Epoch 1
Loss = 6.9408e-03, PNorm = 50.3310, GNorm = 4.1427, lr_0 = 6.7600e-04
Loss = 7.6460e-03, PNorm = 50.3723, GNorm = 6.1651, lr_0 = 8.5600e-04
Loss = 7.2051e-03, PNorm = 50.4161, GNorm = 1.8472, lr_0 = 9.9344e-04
Validation rmse = 1.247080
Epoch 2
Loss = 8.9892e-03, PNorm = 50.4608, GNorm = 2.9395, lr_0 = 9.6130e-04
Loss = 6.3209e-03, PNorm = 50.5047, GNorm = 2.2922, lr_0 = 9.3019e-04
Validation rmse = 0.988129
Epoch 3
Loss = 4.1667e-03, PNorm = 50.5353, GNorm = 3.7513, lr_0 = 9.0009e-04
Loss = 5.3585e-03, PNorm = 50.5633, GNorm = 1.3592, lr_0 = 8.7096e-04
Loss = 5.8565e-03, PNorm = 50.5969, GNorm = 5.3172, lr_0 = 8.4278e-04
Validation rmse = 1.277289
Epoch 4
Loss = 5.7149e-03, PNorm = 50.6211, GNorm = 7.4001, lr_0 = 8.1551e-04
Loss = 4.3833e-03, PNorm = 50.6518, GNorm = 5.4344, lr_0 = 7.8912e-04
Validation rmse = 1.043133
Epoch 5
Loss = 4.7568e-03, PNorm = 50.6757, GNorm = 2.5508, lr_0 = 7.6358e-04
Loss = 3.8267e-03, PNorm = 50.6973, GNorm = 2.4377, lr_0 = 7.3888e-04
Loss = 4.8737e-03, PNorm = 50.7204, GNorm = 1.5128, lr_0 = 7.1497e-04
Validation rmse = 1.080751
Epoch 6
Loss = 3.9127e-03, PNorm = 50.7452, GNorm = 2.3005, lr_0 = 6.8956e-04
Loss = 3.0802e-03, PNorm = 50.7625, GNorm = 1.2147, lr_0 = 6.6725e-04
Loss = 2.9207e-03, PNorm = 50.7755, GNorm = 2.1328, lr_0 = 6.4565e-04
Validation rmse = 0.820217
Epoch 7
Loss = 2.8667e-03, PNorm = 50.7877, GNorm = 2.9084, lr_0 = 6.2476e-04
Loss = 3.4924e-03, PNorm = 50.8000, GNorm = 1.3074, lr_0 = 6.0454e-04
Validation rmse = 0.969923
Epoch 8
Loss = 2.8694e-03, PNorm = 50.8145, GNorm = 1.2986, lr_0 = 5.8498e-04
Loss = 2.8212e-03, PNorm = 50.8270, GNorm = 1.0270, lr_0 = 5.6605e-04
Loss = 3.0503e-03, PNorm = 50.8422, GNorm = 1.3913, lr_0 = 5.4774e-04
Validation rmse = 0.758645
Epoch 9
Loss = 2.8710e-03, PNorm = 50.8573, GNorm = 0.9651, lr_0 = 5.3001e-04
Loss = 2.5227e-03, PNorm = 50.8695, GNorm = 0.8728, lr_0 = 5.1286e-04
Validation rmse = 0.742415
Epoch 10
Loss = 1.4780e-03, PNorm = 50.8822, GNorm = 0.8892, lr_0 = 4.9627e-04
Loss = 2.4807e-03, PNorm = 50.8918, GNorm = 3.5051, lr_0 = 4.8021e-04
Loss = 2.8357e-03, PNorm = 50.9039, GNorm = 4.4558, lr_0 = 4.6467e-04
Validation rmse = 0.789312
Epoch 11
Loss = 2.0961e-03, PNorm = 50.9141, GNorm = 2.0755, lr_0 = 4.4963e-04
Loss = 2.8098e-03, PNorm = 50.9244, GNorm = 2.5462, lr_0 = 4.3508e-04
Validation rmse = 0.872733
Epoch 12
Loss = 2.3335e-03, PNorm = 50.9365, GNorm = 2.3501, lr_0 = 4.1962e-04
Loss = 2.7765e-03, PNorm = 50.9469, GNorm = 1.0732, lr_0 = 4.0604e-04
Loss = 2.6763e-03, PNorm = 50.9577, GNorm = 3.2286, lr_0 = 3.9290e-04
Validation rmse = 0.748696
Epoch 13
Loss = 2.4827e-03, PNorm = 50.9688, GNorm = 1.3105, lr_0 = 3.8019e-04
Loss = 2.3540e-03, PNorm = 50.9760, GNorm = 2.0624, lr_0 = 3.6789e-04
Loss = 2.0746e-03, PNorm = 50.9856, GNorm = 1.1200, lr_0 = 3.5598e-04
Validation rmse = 0.740871
Epoch 14
Loss = 1.9588e-03, PNorm = 50.9929, GNorm = 0.9556, lr_0 = 3.4446e-04
Loss = 2.0799e-03, PNorm = 51.0002, GNorm = 0.9039, lr_0 = 3.3332e-04
Validation rmse = 0.704961
Epoch 15
Loss = 1.8415e-03, PNorm = 51.0081, GNorm = 2.8141, lr_0 = 3.2253e-04
Loss = 2.1475e-03, PNorm = 51.0168, GNorm = 1.5938, lr_0 = 3.1209e-04
Loss = 2.1657e-03, PNorm = 51.0231, GNorm = 0.8628, lr_0 = 3.0200e-04
Validation rmse = 0.682140
Epoch 16
Loss = 1.8840e-03, PNorm = 51.0296, GNorm = 0.7067, lr_0 = 2.9222e-04
Loss = 2.0340e-03, PNorm = 51.0359, GNorm = 0.9027, lr_0 = 2.8277e-04
Validation rmse = 0.670833
Epoch 17
Loss = 1.9168e-03, PNorm = 51.0434, GNorm = 1.1147, lr_0 = 2.7272e-04
Loss = 1.8170e-03, PNorm = 51.0495, GNorm = 1.7074, lr_0 = 2.6389e-04
Loss = 1.8938e-03, PNorm = 51.0542, GNorm = 0.7419, lr_0 = 2.5535e-04
Validation rmse = 0.665933
Epoch 18
Loss = 1.9518e-03, PNorm = 51.0611, GNorm = 4.9390, lr_0 = 2.4709e-04
Loss = 2.1142e-03, PNorm = 51.0672, GNorm = 1.5525, lr_0 = 2.3910e-04
Loss = 1.8716e-03, PNorm = 51.0732, GNorm = 0.9931, lr_0 = 2.3136e-04
Validation rmse = 0.662040
Epoch 19
Loss = 2.1400e-03, PNorm = 51.0783, GNorm = 1.7705, lr_0 = 2.2387e-04
Loss = 1.7469e-03, PNorm = 51.0836, GNorm = 0.7899, lr_0 = 2.1663e-04
Validation rmse = 0.658965
Epoch 20
Loss = 2.0467e-03, PNorm = 51.0890, GNorm = 1.3225, lr_0 = 2.0962e-04
Loss = 1.9640e-03, PNorm = 51.0934, GNorm = 1.5301, lr_0 = 2.0283e-04
Loss = 2.1704e-03, PNorm = 51.0982, GNorm = 0.5784, lr_0 = 1.9627e-04
Validation rmse = 0.798028
Epoch 21
Loss = 1.7908e-03, PNorm = 51.1033, GNorm = 0.8004, lr_0 = 1.8992e-04
Loss = 2.1718e-03, PNorm = 51.1082, GNorm = 1.9710, lr_0 = 1.8377e-04
Validation rmse = 0.726218
Epoch 22
Loss = 2.3947e-03, PNorm = 51.1123, GNorm = 2.6062, lr_0 = 1.7783e-04
Loss = 1.7758e-03, PNorm = 51.1169, GNorm = 2.3624, lr_0 = 1.7207e-04
Loss = 1.7160e-03, PNorm = 51.1204, GNorm = 3.3650, lr_0 = 1.6651e-04
Validation rmse = 0.679833
Epoch 23
Loss = 1.8778e-03, PNorm = 51.1256, GNorm = 2.1411, lr_0 = 1.6059e-04
Loss = 1.6981e-03, PNorm = 51.1281, GNorm = 2.4131, lr_0 = 1.5539e-04
Validation rmse = 0.688444
Epoch 24
Loss = 1.5304e-03, PNorm = 51.1315, GNorm = 0.9859, lr_0 = 1.5036e-04
Loss = 1.5418e-03, PNorm = 51.1344, GNorm = 1.0374, lr_0 = 1.4550e-04
Loss = 1.5638e-03, PNorm = 51.1368, GNorm = 0.8288, lr_0 = 1.4079e-04
Validation rmse = 0.706600
Epoch 25
Loss = 1.7586e-03, PNorm = 51.1395, GNorm = 0.6761, lr_0 = 1.3623e-04
Loss = 1.7512e-03, PNorm = 51.1417, GNorm = 1.5056, lr_0 = 1.3183e-04
Loss = 1.7848e-03, PNorm = 51.1452, GNorm = 0.6960, lr_0 = 1.2756e-04
Validation rmse = 0.672979
Epoch 26
Loss = 1.6981e-03, PNorm = 51.1490, GNorm = 1.0440, lr_0 = 1.2343e-04
Loss = 1.6460e-03, PNorm = 51.1511, GNorm = 0.9031, lr_0 = 1.1944e-04
Validation rmse = 0.664553
Epoch 27
Loss = 1.2934e-03, PNorm = 51.1535, GNorm = 0.9056, lr_0 = 1.1557e-04
Loss = 1.7095e-03, PNorm = 51.1560, GNorm = 1.0028, lr_0 = 1.1183e-04
Loss = 1.5499e-03, PNorm = 51.1581, GNorm = 2.1498, lr_0 = 1.0821e-04
Validation rmse = 0.636202
Epoch 28
Loss = 1.6422e-03, PNorm = 51.1606, GNorm = 0.6769, lr_0 = 1.0437e-04
Loss = 1.8279e-03, PNorm = 51.1624, GNorm = 3.0521, lr_0 = 1.0099e-04
Validation rmse = 0.625542
Epoch 29
Loss = 1.4583e-03, PNorm = 51.1647, GNorm = 1.8224, lr_0 = 1.0000e-04
Loss = 1.3670e-03, PNorm = 51.1668, GNorm = 1.4843, lr_0 = 1.0000e-04
Loss = 1.7772e-03, PNorm = 51.1688, GNorm = 0.9980, lr_0 = 1.0000e-04
Validation rmse = 0.630458
Model 0 best validation rmse = 0.625542 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.906265
Ensemble test rmse = 0.906265
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.35000000000000003_ffn_num_layers_1_hidden_size_1100/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 2,730,201
Moving model to cuda
Epoch 0
Loss = 2.0817e-02, PNorm = 50.2680, GNorm = 6.0419, lr_0 = 2.9800e-04
Loss = 1.5084e-02, PNorm = 50.2894, GNorm = 10.6673, lr_0 = 4.7800e-04
Validation rmse = 1.511967
Epoch 1
Loss = 8.4060e-03, PNorm = 50.3318, GNorm = 3.6690, lr_0 = 6.7600e-04
Loss = 8.8166e-03, PNorm = 50.3725, GNorm = 2.6956, lr_0 = 8.5600e-04
Loss = 7.1736e-03, PNorm = 50.4199, GNorm = 3.1877, lr_0 = 9.9344e-04
Validation rmse = 1.437224
Epoch 2
Loss = 7.2485e-03, PNorm = 50.4601, GNorm = 7.0572, lr_0 = 9.6130e-04
Loss = 5.6970e-03, PNorm = 50.4980, GNorm = 3.2845, lr_0 = 9.3019e-04
Validation rmse = 1.343921
Epoch 3
Loss = 5.5874e-03, PNorm = 50.5304, GNorm = 10.3735, lr_0 = 9.0009e-04
Loss = 4.8755e-03, PNorm = 50.5551, GNorm = 2.3176, lr_0 = 8.7096e-04
Loss = 5.2652e-03, PNorm = 50.5888, GNorm = 1.5658, lr_0 = 8.4278e-04
Validation rmse = 1.137013
Epoch 4
Loss = 3.8201e-03, PNorm = 50.6135, GNorm = 0.9982, lr_0 = 8.1551e-04
Loss = 3.8321e-03, PNorm = 50.6338, GNorm = 3.7385, lr_0 = 7.8912e-04
Validation rmse = 1.034826
Epoch 5
Loss = 3.3785e-03, PNorm = 50.6540, GNorm = 1.5576, lr_0 = 7.6358e-04
Loss = 3.9895e-03, PNorm = 50.6736, GNorm = 1.9831, lr_0 = 7.3888e-04
Loss = 5.3939e-03, PNorm = 50.7005, GNorm = 3.0409, lr_0 = 7.1497e-04
Validation rmse = 1.297400
Epoch 6
Loss = 3.5554e-03, PNorm = 50.7259, GNorm = 3.0375, lr_0 = 6.8956e-04
Loss = 3.9462e-03, PNorm = 50.7446, GNorm = 3.1433, lr_0 = 6.6725e-04
Loss = 3.4473e-03, PNorm = 50.7659, GNorm = 5.1478, lr_0 = 6.4565e-04
Validation rmse = 1.170284
Epoch 7
Loss = 3.0322e-03, PNorm = 50.7811, GNorm = 1.0418, lr_0 = 6.2476e-04
Loss = 3.3542e-03, PNorm = 50.7968, GNorm = 7.7514, lr_0 = 6.0454e-04
Validation rmse = 1.054222
Epoch 8
Loss = 4.7948e-03, PNorm = 50.8108, GNorm = 7.7038, lr_0 = 5.8498e-04
Loss = 3.9382e-03, PNorm = 50.8316, GNorm = 3.8536, lr_0 = 5.6605e-04
Loss = 3.0204e-03, PNorm = 50.8476, GNorm = 2.1356, lr_0 = 5.4774e-04
Validation rmse = 1.022247
Epoch 9
Loss = 2.6506e-03, PNorm = 50.8619, GNorm = 3.2236, lr_0 = 5.3001e-04
Loss = 2.5046e-03, PNorm = 50.8746, GNorm = 1.0274, lr_0 = 5.1286e-04
Validation rmse = 0.934921
Epoch 10
Loss = 2.3104e-03, PNorm = 50.8859, GNorm = 1.3506, lr_0 = 4.9627e-04
Loss = 2.4143e-03, PNorm = 50.8948, GNorm = 0.9361, lr_0 = 4.8021e-04
Loss = 2.1086e-03, PNorm = 50.9050, GNorm = 1.6341, lr_0 = 4.6467e-04
Validation rmse = 0.905168
Epoch 11
Loss = 2.4931e-03, PNorm = 50.9130, GNorm = 5.1903, lr_0 = 4.4963e-04
Loss = 3.4343e-03, PNorm = 50.9259, GNorm = 1.3466, lr_0 = 4.3508e-04
Validation rmse = 0.995051
Epoch 12
Loss = 2.3760e-03, PNorm = 50.9390, GNorm = 1.4217, lr_0 = 4.1962e-04
Loss = 2.2609e-03, PNorm = 50.9526, GNorm = 1.0668, lr_0 = 4.0604e-04
Loss = 2.2659e-03, PNorm = 50.9595, GNorm = 1.2925, lr_0 = 3.9290e-04
Validation rmse = 0.878983
Epoch 13
Loss = 2.2323e-03, PNorm = 50.9681, GNorm = 4.4290, lr_0 = 3.8019e-04
Loss = 2.2030e-03, PNorm = 50.9768, GNorm = 0.7335, lr_0 = 3.6789e-04
Loss = 1.9113e-03, PNorm = 50.9831, GNorm = 1.1226, lr_0 = 3.5598e-04
Validation rmse = 0.997453
Epoch 14
Loss = 2.2014e-03, PNorm = 50.9907, GNorm = 2.6227, lr_0 = 3.4446e-04
Loss = 2.0150e-03, PNorm = 50.9982, GNorm = 3.2190, lr_0 = 3.3332e-04
Validation rmse = 0.852471
Epoch 15
Loss = 1.4336e-03, PNorm = 51.0060, GNorm = 0.6320, lr_0 = 3.2253e-04
Loss = 2.1797e-03, PNorm = 51.0123, GNorm = 2.4957, lr_0 = 3.1209e-04
Loss = 1.8923e-03, PNorm = 51.0186, GNorm = 1.4683, lr_0 = 3.0200e-04
Validation rmse = 0.825469
Epoch 16
Loss = 1.9354e-03, PNorm = 51.0261, GNorm = 1.4035, lr_0 = 2.9222e-04
Loss = 2.2458e-03, PNorm = 51.0344, GNorm = 4.1512, lr_0 = 2.8277e-04
Validation rmse = 0.813522
Epoch 17
Loss = 1.9844e-03, PNorm = 51.0409, GNorm = 1.8774, lr_0 = 2.7272e-04
Loss = 1.9493e-03, PNorm = 51.0480, GNorm = 1.4018, lr_0 = 2.6389e-04
Loss = 1.6215e-03, PNorm = 51.0540, GNorm = 0.4990, lr_0 = 2.5535e-04
Validation rmse = 0.807716
Epoch 18
Loss = 1.5992e-03, PNorm = 51.0598, GNorm = 1.3132, lr_0 = 2.4709e-04
Loss = 1.8750e-03, PNorm = 51.0651, GNorm = 2.1475, lr_0 = 2.3910e-04
Loss = 1.7630e-03, PNorm = 51.0709, GNorm = 1.4427, lr_0 = 2.3136e-04
Validation rmse = 0.771873
Epoch 19
Loss = 1.8595e-03, PNorm = 51.0748, GNorm = 3.3819, lr_0 = 2.2387e-04
Loss = 1.8748e-03, PNorm = 51.0808, GNorm = 2.5947, lr_0 = 2.1663e-04
Validation rmse = 0.851469
Epoch 20
Loss = 1.2524e-03, PNorm = 51.0863, GNorm = 0.4587, lr_0 = 2.0962e-04
Loss = 1.7354e-03, PNorm = 51.0921, GNorm = 1.9279, lr_0 = 2.0283e-04
Loss = 1.7646e-03, PNorm = 51.0943, GNorm = 2.4522, lr_0 = 1.9627e-04
Validation rmse = 0.910330
Epoch 21
Loss = 1.6694e-03, PNorm = 51.0988, GNorm = 0.8175, lr_0 = 1.8992e-04
Loss = 1.7223e-03, PNorm = 51.1028, GNorm = 2.0014, lr_0 = 1.8377e-04
Validation rmse = 0.814733
Epoch 22
Loss = 1.5256e-03, PNorm = 51.1072, GNorm = 1.3529, lr_0 = 1.7783e-04
Loss = 1.7225e-03, PNorm = 51.1111, GNorm = 2.0706, lr_0 = 1.7207e-04
Loss = 1.7222e-03, PNorm = 51.1156, GNorm = 1.1414, lr_0 = 1.6651e-04
Validation rmse = 0.772445
Epoch 23
Loss = 1.6789e-03, PNorm = 51.1200, GNorm = 2.4556, lr_0 = 1.6059e-04
Loss = 1.4109e-03, PNorm = 51.1230, GNorm = 1.2380, lr_0 = 1.5539e-04
Validation rmse = 0.827303
Epoch 24
Loss = 1.2523e-03, PNorm = 51.1269, GNorm = 1.3288, lr_0 = 1.5036e-04
Loss = 1.7375e-03, PNorm = 51.1287, GNorm = 3.0022, lr_0 = 1.4550e-04
Loss = 1.7985e-03, PNorm = 51.1324, GNorm = 1.5525, lr_0 = 1.4079e-04
Validation rmse = 0.808248
Epoch 25
Loss = 1.6255e-03, PNorm = 51.1365, GNorm = 1.5296, lr_0 = 1.3623e-04
Loss = 1.4412e-03, PNorm = 51.1403, GNorm = 1.6944, lr_0 = 1.3183e-04
Loss = 1.4650e-03, PNorm = 51.1427, GNorm = 1.8838, lr_0 = 1.2756e-04
Validation rmse = 0.807451
Epoch 26
Loss = 1.4764e-03, PNorm = 51.1445, GNorm = 1.0992, lr_0 = 1.2343e-04
Loss = 1.4555e-03, PNorm = 51.1468, GNorm = 1.9753, lr_0 = 1.1944e-04
Validation rmse = 0.813548
Epoch 27
Loss = 1.6297e-03, PNorm = 51.1489, GNorm = 1.2343, lr_0 = 1.1557e-04
Loss = 1.5357e-03, PNorm = 51.1512, GNorm = 0.9637, lr_0 = 1.1183e-04
Loss = 1.6450e-03, PNorm = 51.1533, GNorm = 1.5802, lr_0 = 1.0821e-04
Validation rmse = 0.802544
Epoch 28
Loss = 1.3105e-03, PNorm = 51.1562, GNorm = 1.8672, lr_0 = 1.0437e-04
Loss = 1.5529e-03, PNorm = 51.1584, GNorm = 0.6201, lr_0 = 1.0099e-04
Validation rmse = 0.804361
Epoch 29
Loss = 2.1359e-03, PNorm = 51.1603, GNorm = 1.8482, lr_0 = 1.0000e-04
Loss = 1.4367e-03, PNorm = 51.1625, GNorm = 1.0467, lr_0 = 1.0000e-04
Loss = 1.2963e-03, PNorm = 51.1643, GNorm = 1.3445, lr_0 = 1.0000e-04
Validation rmse = 0.806206
Model 0 best validation rmse = 0.771873 on epoch 18
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.114936
Ensemble test rmse = 1.114936
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.35000000000000003_ffn_num_layers_1_hidden_size_1100/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 2,730,201
Moving model to cuda
Epoch 0
Loss = 2.1348e-02, PNorm = 50.2682, GNorm = 5.4207, lr_0 = 2.9800e-04
Loss = 1.3783e-02, PNorm = 50.2896, GNorm = 3.6084, lr_0 = 4.7800e-04
Validation rmse = 1.606672
Epoch 1
Loss = 7.6249e-03, PNorm = 50.3304, GNorm = 3.3746, lr_0 = 6.7600e-04
Loss = 8.4198e-03, PNorm = 50.3694, GNorm = 10.5490, lr_0 = 8.5600e-04
Loss = 9.7460e-03, PNorm = 50.4173, GNorm = 9.7377, lr_0 = 9.9344e-04
Validation rmse = 2.137099
Epoch 2
Loss = 9.2361e-03, PNorm = 50.4718, GNorm = 5.1649, lr_0 = 9.6130e-04
Loss = 8.8321e-03, PNorm = 50.5218, GNorm = 3.0726, lr_0 = 9.3019e-04
Validation rmse = 1.302117
Epoch 3
Loss = 5.4162e-03, PNorm = 50.5589, GNorm = 2.6101, lr_0 = 9.0009e-04
Loss = 5.6252e-03, PNorm = 50.5958, GNorm = 2.5558, lr_0 = 8.7096e-04
Loss = 6.3771e-03, PNorm = 50.6204, GNorm = 1.0938, lr_0 = 8.4278e-04
Validation rmse = 1.140459
Epoch 4
Loss = 4.2325e-03, PNorm = 50.6533, GNorm = 3.3603, lr_0 = 8.1551e-04
Loss = 4.7775e-03, PNorm = 50.6778, GNorm = 1.7091, lr_0 = 7.8912e-04
Validation rmse = 1.213466
Epoch 5
Loss = 3.6978e-03, PNorm = 50.7002, GNorm = 3.4529, lr_0 = 7.6358e-04
Loss = 4.0784e-03, PNorm = 50.7168, GNorm = 5.2513, lr_0 = 7.3888e-04
Loss = 3.7647e-03, PNorm = 50.7388, GNorm = 1.1856, lr_0 = 7.1497e-04
Validation rmse = 1.193203
Epoch 6
Loss = 3.6178e-03, PNorm = 50.7611, GNorm = 2.5409, lr_0 = 6.8956e-04
Loss = 3.7174e-03, PNorm = 50.7800, GNorm = 2.6784, lr_0 = 6.6725e-04
Loss = 3.0227e-03, PNorm = 50.7968, GNorm = 3.7410, lr_0 = 6.4565e-04
Validation rmse = 1.082220
Epoch 7
Loss = 2.8924e-03, PNorm = 50.8127, GNorm = 1.2011, lr_0 = 6.2476e-04
Loss = 3.5077e-03, PNorm = 50.8254, GNorm = 5.4997, lr_0 = 6.0454e-04
Validation rmse = 1.279940
Epoch 8
Loss = 3.0620e-03, PNorm = 50.8413, GNorm = 0.9989, lr_0 = 5.8498e-04
Loss = 3.0783e-03, PNorm = 50.8573, GNorm = 3.4426, lr_0 = 5.6605e-04
Loss = 2.6523e-03, PNorm = 50.8699, GNorm = 1.1573, lr_0 = 5.4774e-04
Validation rmse = 0.960531
Epoch 9
Loss = 2.6805e-03, PNorm = 50.8793, GNorm = 4.8086, lr_0 = 5.3001e-04
Loss = 2.9329e-03, PNorm = 50.8939, GNorm = 1.4832, lr_0 = 5.1286e-04
Validation rmse = 0.951247
Epoch 10
Loss = 1.8435e-03, PNorm = 50.9076, GNorm = 1.8363, lr_0 = 4.9627e-04
Loss = 2.2815e-03, PNorm = 50.9179, GNorm = 1.4874, lr_0 = 4.8021e-04
Loss = 3.0647e-03, PNorm = 50.9302, GNorm = 2.0653, lr_0 = 4.6467e-04
Validation rmse = 0.989254
Epoch 11
Loss = 2.7447e-03, PNorm = 50.9412, GNorm = 2.8116, lr_0 = 4.4963e-04
Loss = 2.8779e-03, PNorm = 50.9528, GNorm = 2.3338, lr_0 = 4.3508e-04
Validation rmse = 1.147061
Epoch 12
Loss = 3.2497e-03, PNorm = 50.9643, GNorm = 2.4043, lr_0 = 4.1962e-04
Loss = 2.5619e-03, PNorm = 50.9769, GNorm = 0.5843, lr_0 = 4.0604e-04
Loss = 2.3612e-03, PNorm = 50.9863, GNorm = 2.8393, lr_0 = 3.9290e-04
Validation rmse = 1.330628
Epoch 13
Loss = 3.0855e-03, PNorm = 50.9977, GNorm = 8.7257, lr_0 = 3.8019e-04
Loss = 2.5011e-03, PNorm = 51.0074, GNorm = 1.4345, lr_0 = 3.6789e-04
Loss = 3.4391e-03, PNorm = 51.0198, GNorm = 4.3223, lr_0 = 3.5598e-04
Validation rmse = 1.192410
Epoch 14
Loss = 2.8759e-03, PNorm = 51.0308, GNorm = 1.8000, lr_0 = 3.4446e-04
Loss = 2.3009e-03, PNorm = 51.0402, GNorm = 1.1135, lr_0 = 3.3332e-04
Validation rmse = 1.120598
Epoch 15
Loss = 2.9737e-03, PNorm = 51.0488, GNorm = 1.5759, lr_0 = 3.2253e-04
Loss = 2.0067e-03, PNorm = 51.0549, GNorm = 0.6103, lr_0 = 3.1209e-04
Loss = 2.2176e-03, PNorm = 51.0629, GNorm = 1.9249, lr_0 = 3.0200e-04
Validation rmse = 0.989391
Epoch 16
Loss = 2.2732e-03, PNorm = 51.0693, GNorm = 1.5352, lr_0 = 2.9222e-04
Loss = 1.9055e-03, PNorm = 51.0769, GNorm = 3.9583, lr_0 = 2.8277e-04
Validation rmse = 0.986051
Epoch 17
Loss = 2.2354e-03, PNorm = 51.0843, GNorm = 0.9044, lr_0 = 2.7272e-04
Loss = 2.0157e-03, PNorm = 51.0918, GNorm = 1.0110, lr_0 = 2.6389e-04
Loss = 1.8894e-03, PNorm = 51.0988, GNorm = 2.0158, lr_0 = 2.5535e-04
Validation rmse = 0.874769
Epoch 18
Loss = 2.0603e-03, PNorm = 51.1047, GNorm = 0.9971, lr_0 = 2.4709e-04
Loss = 1.8706e-03, PNorm = 51.1109, GNorm = 1.8331, lr_0 = 2.3910e-04
Loss = 1.8818e-03, PNorm = 51.1165, GNorm = 1.4921, lr_0 = 2.3136e-04
Validation rmse = 0.963064
Epoch 19
Loss = 1.8937e-03, PNorm = 51.1218, GNorm = 1.0323, lr_0 = 2.2387e-04
Loss = 1.9732e-03, PNorm = 51.1272, GNorm = 0.7850, lr_0 = 2.1663e-04
Validation rmse = 0.946110
Epoch 20
Loss = 1.6825e-03, PNorm = 51.1323, GNorm = 0.9619, lr_0 = 2.0962e-04
Loss = 2.1415e-03, PNorm = 51.1373, GNorm = 2.0310, lr_0 = 2.0283e-04
Loss = 1.9353e-03, PNorm = 51.1425, GNorm = 1.4969, lr_0 = 1.9627e-04
Validation rmse = 0.982047
Epoch 21
Loss = 1.9852e-03, PNorm = 51.1481, GNorm = 1.7452, lr_0 = 1.8992e-04
Loss = 1.6703e-03, PNorm = 51.1517, GNorm = 1.2136, lr_0 = 1.8377e-04
Validation rmse = 0.932065
Epoch 22
Loss = 2.3301e-03, PNorm = 51.1565, GNorm = 1.2424, lr_0 = 1.7783e-04
Loss = 1.3570e-03, PNorm = 51.1603, GNorm = 2.0224, lr_0 = 1.7207e-04
Loss = 1.9489e-03, PNorm = 51.1650, GNorm = 2.6406, lr_0 = 1.6651e-04
Validation rmse = 0.986104
Epoch 23
Loss = 1.6844e-03, PNorm = 51.1697, GNorm = 0.7385, lr_0 = 1.6059e-04
Loss = 1.4986e-03, PNorm = 51.1738, GNorm = 1.1575, lr_0 = 1.5539e-04
Validation rmse = 0.857404
Epoch 24
Loss = 1.5510e-03, PNorm = 51.1770, GNorm = 1.4771, lr_0 = 1.5036e-04
Loss = 1.7998e-03, PNorm = 51.1803, GNorm = 0.7146, lr_0 = 1.4550e-04
Loss = 1.5643e-03, PNorm = 51.1846, GNorm = 0.6113, lr_0 = 1.4079e-04
Validation rmse = 0.865708
Epoch 25
Loss = 1.3719e-03, PNorm = 51.1876, GNorm = 1.1350, lr_0 = 1.3623e-04
Loss = 1.7559e-03, PNorm = 51.1910, GNorm = 0.5393, lr_0 = 1.3183e-04
Loss = 1.4472e-03, PNorm = 51.1942, GNorm = 0.5482, lr_0 = 1.2756e-04
Validation rmse = 0.927258
Epoch 26
Loss = 1.5809e-03, PNorm = 51.1970, GNorm = 2.7318, lr_0 = 1.2343e-04
Loss = 1.4446e-03, PNorm = 51.2001, GNorm = 1.5932, lr_0 = 1.1944e-04
Validation rmse = 1.107078
Epoch 27
Loss = 2.0064e-03, PNorm = 51.2024, GNorm = 3.0763, lr_0 = 1.1557e-04
Loss = 1.7180e-03, PNorm = 51.2055, GNorm = 1.0372, lr_0 = 1.1183e-04
Loss = 1.7824e-03, PNorm = 51.2076, GNorm = 2.5215, lr_0 = 1.0821e-04
Validation rmse = 0.888411
Epoch 28
Loss = 1.6964e-03, PNorm = 51.2103, GNorm = 1.5266, lr_0 = 1.0437e-04
Loss = 1.5424e-03, PNorm = 51.2132, GNorm = 2.1796, lr_0 = 1.0099e-04
Validation rmse = 0.864207
Epoch 29
Loss = 1.0402e-03, PNorm = 51.2152, GNorm = 1.6075, lr_0 = 1.0000e-04
Loss = 1.6331e-03, PNorm = 51.2182, GNorm = 1.4573, lr_0 = 1.0000e-04
Loss = 1.5279e-03, PNorm = 51.2207, GNorm = 0.5500, lr_0 = 1.0000e-04
Validation rmse = 0.871502
Model 0 best validation rmse = 0.857404 on epoch 23
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.667993
Ensemble test rmse = 0.667993
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.35000000000000003_ffn_num_layers_1_hidden_size_1100/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 2,730,201
Moving model to cuda
Epoch 0
Loss = 2.1994e-02, PNorm = 50.2673, GNorm = 4.4016, lr_0 = 2.9800e-04
Loss = 1.3954e-02, PNorm = 50.2872, GNorm = 6.6714, lr_0 = 4.7800e-04
Validation rmse = 1.702008
Epoch 1
Loss = 8.5907e-03, PNorm = 50.3250, GNorm = 6.3961, lr_0 = 6.7600e-04
Loss = 1.0545e-02, PNorm = 50.3634, GNorm = 1.8331, lr_0 = 8.5600e-04
Loss = 9.0560e-03, PNorm = 50.4086, GNorm = 2.8622, lr_0 = 9.9344e-04
Validation rmse = 2.056060
Epoch 2
Loss = 7.9469e-03, PNorm = 50.4553, GNorm = 1.8056, lr_0 = 9.6130e-04
Loss = 6.8576e-03, PNorm = 50.4917, GNorm = 3.9755, lr_0 = 9.3019e-04
Validation rmse = 1.403516
Epoch 3
Loss = 6.4424e-03, PNorm = 50.5232, GNorm = 1.1510, lr_0 = 9.0009e-04
Loss = 5.8005e-03, PNorm = 50.5457, GNorm = 3.7100, lr_0 = 8.7096e-04
Loss = 5.9134e-03, PNorm = 50.5726, GNorm = 6.1944, lr_0 = 8.4278e-04
Validation rmse = 1.278279
Epoch 4
Loss = 5.2637e-03, PNorm = 50.6007, GNorm = 5.0844, lr_0 = 8.1551e-04
Loss = 6.0167e-03, PNorm = 50.6254, GNorm = 3.0106, lr_0 = 7.8912e-04
Validation rmse = 1.467717
Epoch 5
Loss = 5.6538e-03, PNorm = 50.6498, GNorm = 3.7659, lr_0 = 7.6358e-04
Loss = 4.8288e-03, PNorm = 50.6752, GNorm = 0.7430, lr_0 = 7.3888e-04
Loss = 4.2131e-03, PNorm = 50.6961, GNorm = 2.0996, lr_0 = 7.1497e-04
Validation rmse = 1.120243
Epoch 6
Loss = 3.1727e-03, PNorm = 50.7141, GNorm = 1.7193, lr_0 = 6.8956e-04
Loss = 3.9929e-03, PNorm = 50.7321, GNorm = 4.4232, lr_0 = 6.6725e-04
Loss = 5.6840e-03, PNorm = 50.7530, GNorm = 4.1255, lr_0 = 6.4565e-04
Validation rmse = 1.182817
Epoch 7
Loss = 4.6847e-03, PNorm = 50.7762, GNorm = 1.9359, lr_0 = 6.2476e-04
Loss = 4.2015e-03, PNorm = 50.7935, GNorm = 4.4612, lr_0 = 6.0454e-04
Validation rmse = 1.082207
Epoch 8
Loss = 3.3694e-03, PNorm = 50.8104, GNorm = 3.7203, lr_0 = 5.8498e-04
Loss = 3.1848e-03, PNorm = 50.8249, GNorm = 2.3739, lr_0 = 5.6605e-04
Loss = 3.2019e-03, PNorm = 50.8390, GNorm = 1.4202, lr_0 = 5.4774e-04
Validation rmse = 1.055587
Epoch 9
Loss = 3.4320e-03, PNorm = 50.8511, GNorm = 4.5945, lr_0 = 5.3001e-04
Loss = 3.0257e-03, PNorm = 50.8668, GNorm = 1.6789, lr_0 = 5.1286e-04
Validation rmse = 1.040599
Epoch 10
Loss = 2.6944e-03, PNorm = 50.8820, GNorm = 1.8572, lr_0 = 4.9627e-04
Loss = 3.1725e-03, PNorm = 50.8954, GNorm = 2.4799, lr_0 = 4.8021e-04
Loss = 2.5443e-03, PNorm = 50.9079, GNorm = 2.7949, lr_0 = 4.6467e-04
Validation rmse = 1.026107
Epoch 11
Loss = 2.9020e-03, PNorm = 50.9193, GNorm = 2.2502, lr_0 = 4.4963e-04
Loss = 2.5126e-03, PNorm = 50.9302, GNorm = 0.6904, lr_0 = 4.3508e-04
Validation rmse = 1.022648
Epoch 12
Loss = 2.4900e-03, PNorm = 50.9437, GNorm = 1.3586, lr_0 = 4.1962e-04
Loss = 2.1944e-03, PNorm = 50.9550, GNorm = 1.6548, lr_0 = 4.0604e-04
Loss = 2.3699e-03, PNorm = 50.9644, GNorm = 1.6861, lr_0 = 3.9290e-04
Validation rmse = 1.069115
Epoch 13
Loss = 2.3075e-03, PNorm = 50.9759, GNorm = 4.4996, lr_0 = 3.8019e-04
Loss = 2.3967e-03, PNorm = 50.9830, GNorm = 2.9958, lr_0 = 3.6789e-04
Loss = 2.2645e-03, PNorm = 50.9912, GNorm = 2.0596, lr_0 = 3.5598e-04
Validation rmse = 1.009574
Epoch 14
Loss = 2.2855e-03, PNorm = 50.9989, GNorm = 0.6045, lr_0 = 3.4446e-04
Loss = 1.9257e-03, PNorm = 51.0055, GNorm = 3.6986, lr_0 = 3.3332e-04
Validation rmse = 1.038554
Epoch 15
Loss = 1.4237e-03, PNorm = 51.0144, GNorm = 0.5898, lr_0 = 3.2253e-04
Loss = 2.2107e-03, PNorm = 51.0231, GNorm = 1.8028, lr_0 = 3.1209e-04
Loss = 2.0696e-03, PNorm = 51.0317, GNorm = 2.4451, lr_0 = 3.0200e-04
Validation rmse = 1.015451
Epoch 16
Loss = 1.7304e-03, PNorm = 51.0382, GNorm = 1.7471, lr_0 = 2.9222e-04
Loss = 1.9307e-03, PNorm = 51.0458, GNorm = 2.1103, lr_0 = 2.8277e-04
Validation rmse = 0.992655
Epoch 17
Loss = 1.6465e-03, PNorm = 51.0537, GNorm = 1.7505, lr_0 = 2.7272e-04
Loss = 1.9750e-03, PNorm = 51.0598, GNorm = 1.2874, lr_0 = 2.6389e-04
Loss = 1.9451e-03, PNorm = 51.0670, GNorm = 1.8825, lr_0 = 2.5535e-04
Validation rmse = 1.043864
Epoch 18
Loss = 2.2302e-03, PNorm = 51.0736, GNorm = 2.3598, lr_0 = 2.4709e-04
Loss = 1.7436e-03, PNorm = 51.0795, GNorm = 3.3201, lr_0 = 2.3910e-04
Loss = 1.9650e-03, PNorm = 51.0853, GNorm = 1.8018, lr_0 = 2.3136e-04
Validation rmse = 1.017241
Epoch 19
Loss = 2.0251e-03, PNorm = 51.0893, GNorm = 2.2948, lr_0 = 2.2387e-04
Loss = 2.0033e-03, PNorm = 51.0957, GNorm = 1.0340, lr_0 = 2.1663e-04
Validation rmse = 1.025295
Epoch 20
Loss = 1.8240e-03, PNorm = 51.1008, GNorm = 0.9692, lr_0 = 2.0962e-04
Loss = 1.8209e-03, PNorm = 51.1062, GNorm = 1.4054, lr_0 = 2.0283e-04
Loss = 1.7190e-03, PNorm = 51.1107, GNorm = 1.2716, lr_0 = 1.9627e-04
Validation rmse = 1.001384
Epoch 21
Loss = 1.4972e-03, PNorm = 51.1152, GNorm = 0.7605, lr_0 = 1.8992e-04
Loss = 1.7317e-03, PNorm = 51.1192, GNorm = 1.1920, lr_0 = 1.8377e-04
Validation rmse = 0.990607
Epoch 22
Loss = 1.5495e-03, PNorm = 51.1224, GNorm = 0.7508, lr_0 = 1.7783e-04
Loss = 1.6111e-03, PNorm = 51.1273, GNorm = 1.8219, lr_0 = 1.7207e-04
Loss = 1.6981e-03, PNorm = 51.1314, GNorm = 1.8422, lr_0 = 1.6651e-04
Validation rmse = 1.010995
Epoch 23
Loss = 1.5888e-03, PNorm = 51.1347, GNorm = 2.5228, lr_0 = 1.6059e-04
Loss = 1.7915e-03, PNorm = 51.1374, GNorm = 0.8062, lr_0 = 1.5539e-04
Validation rmse = 0.982287
Epoch 24
Loss = 1.5417e-03, PNorm = 51.1415, GNorm = 1.6056, lr_0 = 1.5036e-04
Loss = 1.5962e-03, PNorm = 51.1435, GNorm = 0.9034, lr_0 = 1.4550e-04
Loss = 1.7533e-03, PNorm = 51.1467, GNorm = 0.6349, lr_0 = 1.4079e-04
Validation rmse = 0.985907
Epoch 25
Loss = 1.7793e-03, PNorm = 51.1496, GNorm = 1.5082, lr_0 = 1.3623e-04
Loss = 1.2985e-03, PNorm = 51.1532, GNorm = 0.8644, lr_0 = 1.3183e-04
Loss = 1.7057e-03, PNorm = 51.1556, GNorm = 0.8509, lr_0 = 1.2756e-04
Validation rmse = 0.988617
Epoch 26
Loss = 1.5001e-03, PNorm = 51.1581, GNorm = 0.7692, lr_0 = 1.2343e-04
Loss = 1.5860e-03, PNorm = 51.1608, GNorm = 0.9165, lr_0 = 1.1944e-04
Validation rmse = 0.979421
Epoch 27
Loss = 1.6794e-03, PNorm = 51.1636, GNorm = 2.0641, lr_0 = 1.1557e-04
Loss = 1.4643e-03, PNorm = 51.1664, GNorm = 0.7605, lr_0 = 1.1183e-04
Loss = 1.6419e-03, PNorm = 51.1686, GNorm = 1.1679, lr_0 = 1.0821e-04
Validation rmse = 0.981683
Epoch 28
Loss = 1.4559e-03, PNorm = 51.1707, GNorm = 0.7111, lr_0 = 1.0437e-04
Loss = 1.7010e-03, PNorm = 51.1730, GNorm = 2.3496, lr_0 = 1.0099e-04
Validation rmse = 0.986752
Epoch 29
Loss = 1.4475e-03, PNorm = 51.1758, GNorm = 1.2399, lr_0 = 1.0000e-04
Loss = 1.4083e-03, PNorm = 51.1786, GNorm = 1.1239, lr_0 = 1.0000e-04
Loss = 1.6800e-03, PNorm = 51.1806, GNorm = 0.8233, lr_0 = 1.0000e-04
Validation rmse = 1.000186
Model 0 best validation rmse = 0.979421 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.782810
Ensemble test rmse = 0.782810
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.35000000000000003_ffn_num_layers_1_hidden_size_1100/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 2,730,201
Moving model to cuda
Epoch 0
Loss = 1.7765e-02, PNorm = 50.2707, GNorm = 4.8157, lr_0 = 2.9800e-04
Loss = 1.3914e-02, PNorm = 50.2963, GNorm = 15.0154, lr_0 = 4.7800e-04
Validation rmse = 1.412575
Epoch 1
Loss = 8.2146e-03, PNorm = 50.3396, GNorm = 11.8919, lr_0 = 6.7600e-04
Loss = 8.3297e-03, PNorm = 50.3854, GNorm = 2.1049, lr_0 = 8.5600e-04
Loss = 8.5441e-03, PNorm = 50.4384, GNorm = 4.4329, lr_0 = 9.9344e-04
Validation rmse = 1.593575
Epoch 2
Loss = 1.0338e-02, PNorm = 50.4894, GNorm = 4.3282, lr_0 = 9.6130e-04
Loss = 7.7829e-03, PNorm = 50.5442, GNorm = 6.2907, lr_0 = 9.3019e-04
Validation rmse = 1.115893
Epoch 3
Loss = 4.8062e-03, PNorm = 50.5809, GNorm = 2.3967, lr_0 = 9.0009e-04
Loss = 5.6148e-03, PNorm = 50.6060, GNorm = 2.8358, lr_0 = 8.7096e-04
Loss = 6.2460e-03, PNorm = 50.6334, GNorm = 6.3478, lr_0 = 8.4278e-04
Validation rmse = 1.080828
Epoch 4
Loss = 4.9352e-03, PNorm = 50.6622, GNorm = 2.0444, lr_0 = 8.1551e-04
Loss = 5.6530e-03, PNorm = 50.6930, GNorm = 1.8791, lr_0 = 7.8912e-04
Validation rmse = 1.280549
Epoch 5
Loss = 5.6098e-03, PNorm = 50.7176, GNorm = 4.1160, lr_0 = 7.6358e-04
Loss = 4.8920e-03, PNorm = 50.7463, GNorm = 2.2976, lr_0 = 7.3888e-04
Loss = 3.8518e-03, PNorm = 50.7678, GNorm = 2.7087, lr_0 = 7.1497e-04
Validation rmse = 0.940564
Epoch 6
Loss = 4.8911e-03, PNorm = 50.7891, GNorm = 8.5002, lr_0 = 6.8956e-04
Loss = 4.2679e-03, PNorm = 50.8097, GNorm = 2.8239, lr_0 = 6.6725e-04
Loss = 4.0351e-03, PNorm = 50.8321, GNorm = 2.6966, lr_0 = 6.4565e-04
Validation rmse = 0.839980
Epoch 7
Loss = 3.2978e-03, PNorm = 50.8516, GNorm = 3.5231, lr_0 = 6.2476e-04
Loss = 3.8262e-03, PNorm = 50.8702, GNorm = 1.0974, lr_0 = 6.0454e-04
Validation rmse = 0.844752
Epoch 8
Loss = 2.4315e-03, PNorm = 50.8908, GNorm = 3.7273, lr_0 = 5.8498e-04
Loss = 3.1302e-03, PNorm = 50.9069, GNorm = 2.0766, lr_0 = 5.6605e-04
Loss = 2.9290e-03, PNorm = 50.9234, GNorm = 1.6112, lr_0 = 5.4774e-04
Validation rmse = 0.812769
Epoch 9
Loss = 2.6948e-03, PNorm = 50.9365, GNorm = 1.9202, lr_0 = 5.3001e-04
Loss = 3.2789e-03, PNorm = 50.9532, GNorm = 2.4268, lr_0 = 5.1286e-04
Validation rmse = 0.882448
Epoch 10
Loss = 2.6912e-03, PNorm = 50.9728, GNorm = 1.1049, lr_0 = 4.9627e-04
Loss = 2.8946e-03, PNorm = 50.9894, GNorm = 1.3181, lr_0 = 4.8021e-04
Loss = 2.5832e-03, PNorm = 51.0037, GNorm = 1.6869, lr_0 = 4.6467e-04
Validation rmse = 0.841733
Epoch 11
Loss = 3.1984e-03, PNorm = 51.0183, GNorm = 3.6127, lr_0 = 4.4963e-04
Loss = 2.1114e-03, PNorm = 51.0303, GNorm = 0.5948, lr_0 = 4.3508e-04
Validation rmse = 0.766966
Epoch 12
Loss = 2.2086e-03, PNorm = 51.0415, GNorm = 1.2017, lr_0 = 4.1962e-04
Loss = 2.2088e-03, PNorm = 51.0532, GNorm = 1.1526, lr_0 = 4.0604e-04
Loss = 2.5055e-03, PNorm = 51.0618, GNorm = 1.5225, lr_0 = 3.9290e-04
Validation rmse = 0.828101
Epoch 13
Loss = 2.3279e-03, PNorm = 51.0713, GNorm = 1.4107, lr_0 = 3.8019e-04
Loss = 2.2191e-03, PNorm = 51.0816, GNorm = 3.0218, lr_0 = 3.6789e-04
Loss = 2.3852e-03, PNorm = 51.0912, GNorm = 3.2839, lr_0 = 3.5598e-04
Validation rmse = 0.755631
Epoch 14
Loss = 2.1397e-03, PNorm = 51.1023, GNorm = 0.9087, lr_0 = 3.4446e-04
Loss = 2.1914e-03, PNorm = 51.1125, GNorm = 2.1132, lr_0 = 3.3332e-04
Validation rmse = 0.775132
Epoch 15
Loss = 1.2149e-03, PNorm = 51.1225, GNorm = 1.4312, lr_0 = 3.2253e-04
Loss = 2.5132e-03, PNorm = 51.1328, GNorm = 0.9235, lr_0 = 3.1209e-04
Loss = 1.8318e-03, PNorm = 51.1412, GNorm = 2.0808, lr_0 = 3.0200e-04
Validation rmse = 0.812593
Epoch 16
Loss = 1.9202e-03, PNorm = 51.1512, GNorm = 1.4668, lr_0 = 2.9222e-04
Loss = 2.0390e-03, PNorm = 51.1589, GNorm = 2.5366, lr_0 = 2.8277e-04
Validation rmse = 0.776193
Epoch 17
Loss = 1.4587e-03, PNorm = 51.1687, GNorm = 1.9718, lr_0 = 2.7272e-04
Loss = 1.7037e-03, PNorm = 51.1736, GNorm = 1.0060, lr_0 = 2.6389e-04
Loss = 2.1863e-03, PNorm = 51.1811, GNorm = 0.9812, lr_0 = 2.5535e-04
Validation rmse = 0.853176
Epoch 18
Loss = 1.4557e-03, PNorm = 51.1886, GNorm = 1.1691, lr_0 = 2.4709e-04
Loss = 1.9970e-03, PNorm = 51.1954, GNorm = 1.2264, lr_0 = 2.3910e-04
Loss = 1.8858e-03, PNorm = 51.2004, GNorm = 2.3558, lr_0 = 2.3136e-04
Validation rmse = 0.766894
Epoch 19
Loss = 1.8591e-03, PNorm = 51.2055, GNorm = 0.5480, lr_0 = 2.2387e-04
Loss = 1.7210e-03, PNorm = 51.2113, GNorm = 1.0555, lr_0 = 2.1663e-04
Validation rmse = 0.803822
Epoch 20
Loss = 2.2791e-03, PNorm = 51.2175, GNorm = 1.0828, lr_0 = 2.0962e-04
Loss = 1.7026e-03, PNorm = 51.2239, GNorm = 1.3238, lr_0 = 2.0283e-04
Loss = 1.6336e-03, PNorm = 51.2299, GNorm = 1.0444, lr_0 = 1.9627e-04
Validation rmse = 0.745904
Epoch 21
Loss = 1.8136e-03, PNorm = 51.2363, GNorm = 1.5696, lr_0 = 1.8992e-04
Loss = 1.5584e-03, PNorm = 51.2411, GNorm = 1.8148, lr_0 = 1.8377e-04
Validation rmse = 0.746097
Epoch 22
Loss = 1.8309e-03, PNorm = 51.2451, GNorm = 1.4168, lr_0 = 1.7783e-04
Loss = 1.4409e-03, PNorm = 51.2484, GNorm = 0.8260, lr_0 = 1.7207e-04
Loss = 1.5798e-03, PNorm = 51.2530, GNorm = 1.3317, lr_0 = 1.6651e-04
Validation rmse = 0.797454
Epoch 23
Loss = 1.3865e-03, PNorm = 51.2575, GNorm = 0.9398, lr_0 = 1.6059e-04
Loss = 1.4293e-03, PNorm = 51.2619, GNorm = 0.8254, lr_0 = 1.5539e-04
Validation rmse = 0.775639
Epoch 24
Loss = 1.2154e-03, PNorm = 51.2647, GNorm = 1.3242, lr_0 = 1.5036e-04
Loss = 1.5575e-03, PNorm = 51.2675, GNorm = 1.1840, lr_0 = 1.4550e-04
Loss = 1.5660e-03, PNorm = 51.2707, GNorm = 0.8513, lr_0 = 1.4079e-04
Validation rmse = 0.776208
Epoch 25
Loss = 1.2520e-03, PNorm = 51.2746, GNorm = 0.7372, lr_0 = 1.3623e-04
Loss = 1.5227e-03, PNorm = 51.2785, GNorm = 0.6805, lr_0 = 1.3183e-04
Loss = 1.6321e-03, PNorm = 51.2816, GNorm = 1.0223, lr_0 = 1.2756e-04
Validation rmse = 0.802731
Epoch 26
Loss = 1.5746e-03, PNorm = 51.2840, GNorm = 1.4553, lr_0 = 1.2343e-04
Loss = 1.5228e-03, PNorm = 51.2876, GNorm = 1.1362, lr_0 = 1.1944e-04
Validation rmse = 0.746116
Epoch 27
Loss = 1.2402e-03, PNorm = 51.2898, GNorm = 1.0050, lr_0 = 1.1557e-04
Loss = 1.5524e-03, PNorm = 51.2934, GNorm = 0.6412, lr_0 = 1.1183e-04
Loss = 1.4294e-03, PNorm = 51.2957, GNorm = 0.7688, lr_0 = 1.0821e-04
Validation rmse = 0.754875
Epoch 28
Loss = 1.3206e-03, PNorm = 51.2975, GNorm = 1.2432, lr_0 = 1.0437e-04
Loss = 1.3102e-03, PNorm = 51.3002, GNorm = 0.9260, lr_0 = 1.0099e-04
Validation rmse = 0.794503
Epoch 29
Loss = 1.1399e-03, PNorm = 51.3019, GNorm = 1.7702, lr_0 = 1.0000e-04
Loss = 1.4996e-03, PNorm = 51.3038, GNorm = 1.7972, lr_0 = 1.0000e-04
Loss = 1.4727e-03, PNorm = 51.3062, GNorm = 1.2466, lr_0 = 1.0000e-04
Validation rmse = 0.768541
Model 0 best validation rmse = 0.745904 on epoch 20
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.675908
Ensemble test rmse = 0.675908
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.35000000000000003_ffn_num_layers_1_hidden_size_1100/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 2,730,201
Moving model to cuda
Epoch 0
Loss = 2.3370e-02, PNorm = 50.2675, GNorm = 12.1856, lr_0 = 2.9800e-04
Loss = 1.5351e-02, PNorm = 50.2893, GNorm = 4.5554, lr_0 = 4.7800e-04
Validation rmse = 1.833257
Epoch 1
Loss = 1.2153e-02, PNorm = 50.3303, GNorm = 1.9035, lr_0 = 6.7600e-04
Loss = 9.2299e-03, PNorm = 50.3773, GNorm = 4.2827, lr_0 = 8.5600e-04
Loss = 7.7174e-03, PNorm = 50.4220, GNorm = 4.2241, lr_0 = 9.9344e-04
Validation rmse = 1.470260
Epoch 2
Loss = 6.1753e-03, PNorm = 50.4649, GNorm = 6.0238, lr_0 = 9.6130e-04
Loss = 5.7533e-03, PNorm = 50.4966, GNorm = 2.6313, lr_0 = 9.3019e-04
Validation rmse = 1.486842
Epoch 3
Loss = 5.1762e-03, PNorm = 50.5325, GNorm = 4.2626, lr_0 = 9.0009e-04
Loss = 5.3857e-03, PNorm = 50.5631, GNorm = 2.9286, lr_0 = 8.7096e-04
Loss = 4.8259e-03, PNorm = 50.5923, GNorm = 3.9782, lr_0 = 8.4278e-04
Validation rmse = 1.221402
Epoch 4
Loss = 5.0520e-03, PNorm = 50.6182, GNorm = 5.9943, lr_0 = 8.1551e-04
Loss = 5.3311e-03, PNorm = 50.6461, GNorm = 5.3402, lr_0 = 7.8912e-04
Validation rmse = 1.253521
Epoch 5
Loss = 2.6401e-03, PNorm = 50.6652, GNorm = 1.6254, lr_0 = 7.6358e-04
Loss = 3.3978e-03, PNorm = 50.6876, GNorm = 3.2182, lr_0 = 7.3888e-04
Loss = 4.0655e-03, PNorm = 50.7010, GNorm = 2.7182, lr_0 = 7.1497e-04
Validation rmse = 1.574395
Epoch 6
Loss = 5.0826e-03, PNorm = 50.7186, GNorm = 4.6892, lr_0 = 6.8956e-04
Loss = 4.4333e-03, PNorm = 50.7423, GNorm = 3.2246, lr_0 = 6.6725e-04
Loss = 3.6260e-03, PNorm = 50.7597, GNorm = 1.7750, lr_0 = 6.4565e-04
Validation rmse = 0.974314
Epoch 7
Loss = 3.4036e-03, PNorm = 50.7756, GNorm = 4.1738, lr_0 = 6.2476e-04
Loss = 3.5402e-03, PNorm = 50.7898, GNorm = 5.2060, lr_0 = 6.0454e-04
Validation rmse = 0.959949
Epoch 8
Loss = 3.0315e-03, PNorm = 50.8031, GNorm = 1.0662, lr_0 = 5.8498e-04
Loss = 3.3200e-03, PNorm = 50.8178, GNorm = 0.9943, lr_0 = 5.6605e-04
Loss = 2.4369e-03, PNorm = 50.8316, GNorm = 2.7460, lr_0 = 5.4774e-04
Validation rmse = 1.078023
Epoch 9
Loss = 2.5330e-03, PNorm = 50.8407, GNorm = 1.2893, lr_0 = 5.3001e-04
Loss = 2.6676e-03, PNorm = 50.8527, GNorm = 1.6602, lr_0 = 5.1286e-04
Validation rmse = 0.940602
Epoch 10
Loss = 3.3636e-03, PNorm = 50.8614, GNorm = 0.9737, lr_0 = 4.9627e-04
Loss = 3.5515e-03, PNorm = 50.8738, GNorm = 1.6799, lr_0 = 4.8021e-04
Loss = 2.7274e-03, PNorm = 50.8849, GNorm = 2.0373, lr_0 = 4.6467e-04
Validation rmse = 0.931811
Epoch 11
Loss = 2.3963e-03, PNorm = 50.8983, GNorm = 0.8260, lr_0 = 4.4963e-04
Loss = 2.2311e-03, PNorm = 50.9079, GNorm = 3.3964, lr_0 = 4.3508e-04
Validation rmse = 0.962639
Epoch 12
Loss = 1.7849e-03, PNorm = 50.9168, GNorm = 1.1633, lr_0 = 4.1962e-04
Loss = 2.6442e-03, PNorm = 50.9237, GNorm = 4.4217, lr_0 = 4.0604e-04
Loss = 2.7557e-03, PNorm = 50.9349, GNorm = 3.9995, lr_0 = 3.9290e-04
Validation rmse = 1.104957
Epoch 13
Loss = 2.9175e-03, PNorm = 50.9439, GNorm = 1.3467, lr_0 = 3.8019e-04
Loss = 2.7261e-03, PNorm = 50.9520, GNorm = 2.8749, lr_0 = 3.6789e-04
Loss = 2.5373e-03, PNorm = 50.9631, GNorm = 2.4781, lr_0 = 3.5598e-04
Validation rmse = 0.955499
Epoch 14
Loss = 1.9471e-03, PNorm = 50.9692, GNorm = 1.3643, lr_0 = 3.4446e-04
Loss = 2.3212e-03, PNorm = 50.9767, GNorm = 3.1043, lr_0 = 3.3332e-04
Validation rmse = 0.897667
Epoch 15
Loss = 2.7056e-03, PNorm = 50.9847, GNorm = 2.8685, lr_0 = 3.2253e-04
Loss = 2.3242e-03, PNorm = 50.9919, GNorm = 1.1942, lr_0 = 3.1209e-04
Loss = 2.5368e-03, PNorm = 51.0002, GNorm = 1.2482, lr_0 = 3.0200e-04
Validation rmse = 1.022075
Epoch 16
Loss = 1.9542e-03, PNorm = 51.0060, GNorm = 1.5272, lr_0 = 2.9222e-04
Loss = 2.3483e-03, PNorm = 51.0129, GNorm = 2.8357, lr_0 = 2.8277e-04
Validation rmse = 0.942764
Epoch 17
Loss = 1.6691e-03, PNorm = 51.0202, GNorm = 1.9846, lr_0 = 2.7272e-04
Loss = 2.2285e-03, PNorm = 51.0281, GNorm = 0.8325, lr_0 = 2.6389e-04
Loss = 2.0133e-03, PNorm = 51.0317, GNorm = 3.2339, lr_0 = 2.5535e-04
Validation rmse = 0.966766
Epoch 18
Loss = 2.0773e-03, PNorm = 51.0360, GNorm = 0.6831, lr_0 = 2.4709e-04
Loss = 1.9672e-03, PNorm = 51.0408, GNorm = 1.9835, lr_0 = 2.3910e-04
Loss = 2.0912e-03, PNorm = 51.0470, GNorm = 1.6602, lr_0 = 2.3136e-04
Validation rmse = 0.949315
Epoch 19
Loss = 1.8806e-03, PNorm = 51.0518, GNorm = 3.2480, lr_0 = 2.2387e-04
Loss = 1.7206e-03, PNorm = 51.0548, GNorm = 1.2040, lr_0 = 2.1663e-04
Validation rmse = 0.938313
Epoch 20
Loss = 1.7519e-03, PNorm = 51.0588, GNorm = 1.0518, lr_0 = 2.0962e-04
Loss = 1.8493e-03, PNorm = 51.0623, GNorm = 0.7234, lr_0 = 2.0283e-04
Loss = 1.9990e-03, PNorm = 51.0679, GNorm = 1.7877, lr_0 = 1.9627e-04
Validation rmse = 0.987943
Epoch 21
Loss = 1.6982e-03, PNorm = 51.0714, GNorm = 0.8204, lr_0 = 1.8992e-04
Loss = 1.9538e-03, PNorm = 51.0757, GNorm = 0.9716, lr_0 = 1.8377e-04
Validation rmse = 0.947641
Epoch 22
Loss = 1.7592e-03, PNorm = 51.0799, GNorm = 1.2251, lr_0 = 1.7783e-04
Loss = 1.7378e-03, PNorm = 51.0836, GNorm = 1.1327, lr_0 = 1.7207e-04
Loss = 1.8282e-03, PNorm = 51.0866, GNorm = 1.1379, lr_0 = 1.6651e-04
Validation rmse = 0.924418
Epoch 23
Loss = 1.6937e-03, PNorm = 51.0883, GNorm = 1.1014, lr_0 = 1.6059e-04
Loss = 1.5660e-03, PNorm = 51.0917, GNorm = 0.7499, lr_0 = 1.5539e-04
Validation rmse = 0.983621
Epoch 24
Loss = 1.4200e-03, PNorm = 51.0941, GNorm = 1.1573, lr_0 = 1.5036e-04
Loss = 1.8537e-03, PNorm = 51.0968, GNorm = 1.6447, lr_0 = 1.4550e-04
Loss = 1.6171e-03, PNorm = 51.0987, GNorm = 1.6062, lr_0 = 1.4079e-04
Validation rmse = 0.970068
Epoch 25
Loss = 1.4374e-03, PNorm = 51.1009, GNorm = 1.4516, lr_0 = 1.3623e-04
Loss = 1.7428e-03, PNorm = 51.1037, GNorm = 2.0677, lr_0 = 1.3183e-04
Loss = 1.6937e-03, PNorm = 51.1063, GNorm = 1.1354, lr_0 = 1.2756e-04
Validation rmse = 0.989291
Epoch 26
Loss = 1.6197e-03, PNorm = 51.1084, GNorm = 0.6568, lr_0 = 1.2343e-04
Loss = 1.6518e-03, PNorm = 51.1104, GNorm = 1.0825, lr_0 = 1.1944e-04
Validation rmse = 0.949592
Epoch 27
Loss = 1.8353e-03, PNorm = 51.1132, GNorm = 2.1497, lr_0 = 1.1557e-04
Loss = 1.4679e-03, PNorm = 51.1152, GNorm = 0.5448, lr_0 = 1.1183e-04
Loss = 1.6220e-03, PNorm = 51.1173, GNorm = 1.3304, lr_0 = 1.0821e-04
Validation rmse = 0.940581
Epoch 28
Loss = 1.7152e-03, PNorm = 51.1196, GNorm = 0.8664, lr_0 = 1.0437e-04
Loss = 1.4865e-03, PNorm = 51.1218, GNorm = 0.9948, lr_0 = 1.0099e-04
Validation rmse = 0.967643
Epoch 29
Loss = 1.1321e-03, PNorm = 51.1233, GNorm = 1.0653, lr_0 = 1.0000e-04
Loss = 1.5866e-03, PNorm = 51.1253, GNorm = 1.1327, lr_0 = 1.0000e-04
Loss = 1.3903e-03, PNorm = 51.1262, GNorm = 1.5300, lr_0 = 1.0000e-04
Validation rmse = 1.028007
Model 0 best validation rmse = 0.897667 on epoch 14
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.763366
Ensemble test rmse = 0.763366
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.35000000000000003,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1100,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1100,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.35000000000000003_ffn_num_layers_1_hidden_size_1100/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.35000000000000003, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1100, bias=False)
      (W_h): Linear(in_features=1100, out_features=1100, bias=False)
      (W_o): Linear(in_features=1233, out_features=1100, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35000000000000003, inplace=False)
    (1): Linear(in_features=1100, out_features=1, bias=True)
  )
)
Number of parameters = 2,730,201
Moving model to cuda
Epoch 0
Loss = 2.1792e-02, PNorm = 50.2676, GNorm = 7.9051, lr_0 = 2.9800e-04
Loss = 1.6869e-02, PNorm = 50.2890, GNorm = 9.9823, lr_0 = 4.7800e-04
Validation rmse = 1.526492
Epoch 1
Loss = 8.9355e-03, PNorm = 50.3299, GNorm = 6.7069, lr_0 = 6.7600e-04
Loss = 9.3792e-03, PNorm = 50.3727, GNorm = 3.0422, lr_0 = 8.5600e-04
Loss = 7.3800e-03, PNorm = 50.4232, GNorm = 1.1737, lr_0 = 9.9344e-04
Validation rmse = 1.238004
Epoch 2
Loss = 6.0679e-03, PNorm = 50.4625, GNorm = 1.5882, lr_0 = 9.6130e-04
Loss = 5.4884e-03, PNorm = 50.5012, GNorm = 2.8403, lr_0 = 9.3019e-04
Validation rmse = 1.318617
Epoch 3
Loss = 6.0849e-03, PNorm = 50.5347, GNorm = 8.6444, lr_0 = 9.0009e-04
Loss = 5.2494e-03, PNorm = 50.5634, GNorm = 4.6053, lr_0 = 8.7096e-04
Loss = 5.5896e-03, PNorm = 50.5881, GNorm = 4.1170, lr_0 = 8.4278e-04
Validation rmse = 1.086920
Epoch 4
Loss = 4.8335e-03, PNorm = 50.6154, GNorm = 2.1404, lr_0 = 8.1551e-04
Loss = 5.4718e-03, PNorm = 50.6376, GNorm = 2.3740, lr_0 = 7.8912e-04
Validation rmse = 1.430507
Epoch 5
Loss = 3.6511e-03, PNorm = 50.6689, GNorm = 2.5579, lr_0 = 7.6358e-04
Loss = 5.1746e-03, PNorm = 50.6919, GNorm = 1.3091, lr_0 = 7.3888e-04
Loss = 3.4522e-03, PNorm = 50.7106, GNorm = 2.2505, lr_0 = 7.1497e-04
Validation rmse = 0.991430
Epoch 6
Loss = 3.5169e-03, PNorm = 50.7285, GNorm = 1.0651, lr_0 = 6.8956e-04
Loss = 3.9677e-03, PNorm = 50.7435, GNorm = 2.8825, lr_0 = 6.6725e-04
Loss = 3.2639e-03, PNorm = 50.7615, GNorm = 3.9022, lr_0 = 6.4565e-04
Validation rmse = 0.963195
Epoch 7
Loss = 2.8214e-03, PNorm = 50.7788, GNorm = 1.4563, lr_0 = 6.2476e-04
Loss = 3.1294e-03, PNorm = 50.7943, GNorm = 1.3842, lr_0 = 6.0454e-04
Validation rmse = 1.091478
Epoch 8
Loss = 3.2722e-03, PNorm = 50.8112, GNorm = 1.0628, lr_0 = 5.8498e-04
Loss = 3.7179e-03, PNorm = 50.8294, GNorm = 2.3023, lr_0 = 5.6605e-04
Loss = 3.1511e-03, PNorm = 50.8461, GNorm = 1.8590, lr_0 = 5.4774e-04
Validation rmse = 0.898685
Epoch 9
Loss = 2.5016e-03, PNorm = 50.8584, GNorm = 0.5497, lr_0 = 5.3001e-04
Loss = 2.6294e-03, PNorm = 50.8702, GNorm = 1.7756, lr_0 = 5.1286e-04
Validation rmse = 0.904427
Epoch 10
Loss = 2.9906e-03, PNorm = 50.8858, GNorm = 3.9968, lr_0 = 4.9627e-04
Loss = 2.6118e-03, PNorm = 50.8992, GNorm = 1.4968, lr_0 = 4.8021e-04
Loss = 2.4281e-03, PNorm = 50.9122, GNorm = 2.4257, lr_0 = 4.6467e-04
Validation rmse = 0.875597
Epoch 11
Loss = 2.4996e-03, PNorm = 50.9245, GNorm = 1.1662, lr_0 = 4.4963e-04
Loss = 2.6547e-03, PNorm = 50.9359, GNorm = 2.1920, lr_0 = 4.3508e-04
Validation rmse = 0.971778
Epoch 12
Loss = 1.9479e-03, PNorm = 50.9478, GNorm = 2.6220, lr_0 = 4.1962e-04
Loss = 2.4593e-03, PNorm = 50.9614, GNorm = 1.3536, lr_0 = 4.0604e-04
Loss = 2.1735e-03, PNorm = 50.9754, GNorm = 2.1825, lr_0 = 3.9290e-04
Validation rmse = 0.846632
Epoch 13
Loss = 2.4795e-03, PNorm = 50.9825, GNorm = 4.2293, lr_0 = 3.8019e-04
Loss = 1.8653e-03, PNorm = 50.9944, GNorm = 0.9914, lr_0 = 3.6789e-04
Loss = 2.3967e-03, PNorm = 51.0029, GNorm = 0.9898, lr_0 = 3.5598e-04
Validation rmse = 0.876103
Epoch 14
Loss = 2.0554e-03, PNorm = 51.0119, GNorm = 1.4423, lr_0 = 3.4446e-04
Loss = 1.7470e-03, PNorm = 51.0200, GNorm = 0.8478, lr_0 = 3.3332e-04
Validation rmse = 0.922533
Epoch 15
Loss = 2.1221e-03, PNorm = 51.0274, GNorm = 1.0728, lr_0 = 3.2253e-04
Loss = 1.9836e-03, PNorm = 51.0347, GNorm = 0.9473, lr_0 = 3.1209e-04
Loss = 1.9603e-03, PNorm = 51.0434, GNorm = 1.0489, lr_0 = 3.0200e-04
Validation rmse = 0.972446
Epoch 16
Loss = 1.8166e-03, PNorm = 51.0508, GNorm = 0.9420, lr_0 = 2.9222e-04
Loss = 1.7262e-03, PNorm = 51.0569, GNorm = 2.0916, lr_0 = 2.8277e-04
Validation rmse = 0.875589
Epoch 17
Loss = 1.9991e-03, PNorm = 51.0650, GNorm = 1.3938, lr_0 = 2.7272e-04
Loss = 1.7453e-03, PNorm = 51.0729, GNorm = 1.0464, lr_0 = 2.6389e-04
Loss = 1.8783e-03, PNorm = 51.0782, GNorm = 1.1696, lr_0 = 2.5535e-04
Validation rmse = 0.872044
Epoch 18
Loss = 1.9453e-03, PNorm = 51.0844, GNorm = 0.5905, lr_0 = 2.4709e-04
Loss = 2.1680e-03, PNorm = 51.0912, GNorm = 5.5371, lr_0 = 2.3910e-04
Loss = 1.6181e-03, PNorm = 51.0978, GNorm = 1.8811, lr_0 = 2.3136e-04
Validation rmse = 0.877076
Epoch 19
Loss = 1.8666e-03, PNorm = 51.1040, GNorm = 0.9175, lr_0 = 2.2387e-04
Loss = 2.0291e-03, PNorm = 51.1097, GNorm = 1.9733, lr_0 = 2.1663e-04
Validation rmse = 0.796649
Epoch 20
Loss = 1.4605e-03, PNorm = 51.1164, GNorm = 2.2483, lr_0 = 2.0962e-04
Loss = 1.8340e-03, PNorm = 51.1216, GNorm = 1.1178, lr_0 = 2.0283e-04
Loss = 1.7569e-03, PNorm = 51.1260, GNorm = 1.1552, lr_0 = 1.9627e-04
Validation rmse = 0.813950
Epoch 21
Loss = 1.8398e-03, PNorm = 51.1308, GNorm = 2.2743, lr_0 = 1.8992e-04
Loss = 2.0263e-03, PNorm = 51.1369, GNorm = 1.9074, lr_0 = 1.8377e-04
Validation rmse = 0.840911
Epoch 22
Loss = 1.4609e-03, PNorm = 51.1423, GNorm = 0.7980, lr_0 = 1.7783e-04
Loss = 1.5224e-03, PNorm = 51.1466, GNorm = 1.2437, lr_0 = 1.7207e-04
Loss = 1.6886e-03, PNorm = 51.1502, GNorm = 1.0552, lr_0 = 1.6651e-04
Validation rmse = 0.853205
Epoch 23
Loss = 1.7559e-03, PNorm = 51.1535, GNorm = 1.2250, lr_0 = 1.6059e-04
Loss = 1.6276e-03, PNorm = 51.1566, GNorm = 3.1192, lr_0 = 1.5539e-04
Validation rmse = 0.823801
Epoch 24
Loss = 1.6694e-03, PNorm = 51.1601, GNorm = 0.8262, lr_0 = 1.5036e-04
Loss = 1.7000e-03, PNorm = 51.1638, GNorm = 2.8715, lr_0 = 1.4550e-04
Loss = 1.7848e-03, PNorm = 51.1673, GNorm = 2.5217, lr_0 = 1.4079e-04
Validation rmse = 0.764379
Epoch 25
Loss = 1.6443e-03, PNorm = 51.1711, GNorm = 0.9071, lr_0 = 1.3623e-04
Loss = 1.5754e-03, PNorm = 51.1747, GNorm = 1.7249, lr_0 = 1.3183e-04
Loss = 1.7308e-03, PNorm = 51.1776, GNorm = 1.1828, lr_0 = 1.2756e-04
Validation rmse = 0.807497
Epoch 26
Loss = 1.5213e-03, PNorm = 51.1808, GNorm = 1.6435, lr_0 = 1.2343e-04
Loss = 1.3259e-03, PNorm = 51.1846, GNorm = 0.8682, lr_0 = 1.1944e-04
Validation rmse = 0.775733
Epoch 27
Loss = 1.5405e-03, PNorm = 51.1873, GNorm = 2.1657, lr_0 = 1.1557e-04
Loss = 1.5682e-03, PNorm = 51.1909, GNorm = 0.8535, lr_0 = 1.1183e-04
Loss = 1.4235e-03, PNorm = 51.1936, GNorm = 0.6024, lr_0 = 1.0821e-04
Validation rmse = 0.777790
Epoch 28
Loss = 1.6374e-03, PNorm = 51.1959, GNorm = 2.2777, lr_0 = 1.0437e-04
Loss = 1.5286e-03, PNorm = 51.1983, GNorm = 1.2517, lr_0 = 1.0099e-04
Validation rmse = 0.768807
Epoch 29
Loss = 1.6427e-03, PNorm = 51.2011, GNorm = 3.2548, lr_0 = 1.0000e-04
Loss = 1.5810e-03, PNorm = 51.2033, GNorm = 0.8192, lr_0 = 1.0000e-04
Loss = 1.3680e-03, PNorm = 51.2058, GNorm = 1.8357, lr_0 = 1.0000e-04
Validation rmse = 0.831581
Model 0 best validation rmse = 0.764379 on epoch 24
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.730450
Ensemble test rmse = 0.730450
10-fold cross validation
	Seed 0 ==> test rmse = 0.785946
	Seed 1 ==> test rmse = 0.691085
	Seed 2 ==> test rmse = 0.703005
	Seed 3 ==> test rmse = 0.906265
	Seed 4 ==> test rmse = 1.114936
	Seed 5 ==> test rmse = 0.667993
	Seed 6 ==> test rmse = 0.782810
	Seed 7 ==> test rmse = 0.675908
	Seed 8 ==> test rmse = 0.763366
	Seed 9 ==> test rmse = 0.730450
Overall test rmse = 0.782176 +/- 0.129641
Elapsed time = 0:08:29
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1700, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,401
Moving model to cuda
Epoch 0
Loss = 1.4707e-02, PNorm = 61.1263, GNorm = 2.6797, lr_0 = 2.9800e-04
Loss = 1.1028e-02, PNorm = 61.1749, GNorm = 27.2226, lr_0 = 4.7800e-04
Validation rmse = 1.561682
Epoch 1
Loss = 8.1370e-03, PNorm = 61.2460, GNorm = 2.0510, lr_0 = 6.7600e-04
Loss = 8.0665e-03, PNorm = 61.3276, GNorm = 5.3350, lr_0 = 8.5600e-04
Loss = 7.5026e-03, PNorm = 61.4042, GNorm = 4.5627, lr_0 = 9.9344e-04
Validation rmse = 1.302840
Epoch 2
Loss = 6.0098e-03, PNorm = 61.4882, GNorm = 2.9863, lr_0 = 9.6130e-04
Loss = 4.6083e-03, PNorm = 61.5541, GNorm = 4.2581, lr_0 = 9.3019e-04
Validation rmse = 1.085628
Epoch 3
Loss = 3.5675e-03, PNorm = 61.6134, GNorm = 1.0257, lr_0 = 9.0009e-04
Loss = 3.9273e-03, PNorm = 61.6668, GNorm = 2.1230, lr_0 = 8.7096e-04
Loss = 5.3345e-03, PNorm = 61.7221, GNorm = 5.8837, lr_0 = 8.4278e-04
Validation rmse = 1.270788
Epoch 4
Loss = 4.0751e-03, PNorm = 61.7802, GNorm = 1.5013, lr_0 = 8.1551e-04
Loss = 3.7465e-03, PNorm = 61.8245, GNorm = 1.4367, lr_0 = 7.8912e-04
Validation rmse = 1.180530
Epoch 5
Loss = 4.1971e-03, PNorm = 61.8615, GNorm = 5.0717, lr_0 = 7.6358e-04
Loss = 3.5026e-03, PNorm = 61.9081, GNorm = 2.6870, lr_0 = 7.3888e-04
Loss = 3.1944e-03, PNorm = 61.9419, GNorm = 3.4622, lr_0 = 7.1497e-04
Validation rmse = 1.044463
Epoch 6
Loss = 2.7379e-03, PNorm = 61.9857, GNorm = 3.2083, lr_0 = 6.8956e-04
Loss = 2.9335e-03, PNorm = 62.0223, GNorm = 1.1372, lr_0 = 6.6725e-04
Loss = 2.9078e-03, PNorm = 62.0446, GNorm = 2.2793, lr_0 = 6.4565e-04
Validation rmse = 0.952632
Epoch 7
Loss = 2.4023e-03, PNorm = 62.0767, GNorm = 1.8742, lr_0 = 6.2476e-04
Loss = 2.9709e-03, PNorm = 62.1066, GNorm = 3.2106, lr_0 = 6.0454e-04
Validation rmse = 0.906526
Epoch 8
Loss = 2.0346e-03, PNorm = 62.1346, GNorm = 1.0938, lr_0 = 5.8498e-04
Loss = 2.8284e-03, PNorm = 62.1587, GNorm = 4.0124, lr_0 = 5.6605e-04
Loss = 2.4648e-03, PNorm = 62.1907, GNorm = 3.4543, lr_0 = 5.4774e-04
Validation rmse = 0.962373
Epoch 9
Loss = 2.2343e-03, PNorm = 62.2194, GNorm = 1.5273, lr_0 = 5.3001e-04
Loss = 2.0407e-03, PNorm = 62.2421, GNorm = 1.2511, lr_0 = 5.1286e-04
Validation rmse = 0.905048
Epoch 10
Loss = 2.0096e-03, PNorm = 62.2685, GNorm = 1.2202, lr_0 = 4.9627e-04
Loss = 1.9561e-03, PNorm = 62.2988, GNorm = 2.6197, lr_0 = 4.8021e-04
Loss = 2.1540e-03, PNorm = 62.3200, GNorm = 2.1989, lr_0 = 4.6467e-04
Validation rmse = 0.883917
Epoch 11
Loss = 1.7656e-03, PNorm = 62.3374, GNorm = 1.0582, lr_0 = 4.4963e-04
Loss = 1.6499e-03, PNorm = 62.3563, GNorm = 0.7965, lr_0 = 4.3508e-04
Validation rmse = 0.929055
Epoch 12
Loss = 1.8608e-03, PNorm = 62.3780, GNorm = 1.2002, lr_0 = 4.1962e-04
Loss = 2.3247e-03, PNorm = 62.3966, GNorm = 1.4576, lr_0 = 4.0604e-04
Loss = 1.8056e-03, PNorm = 62.4163, GNorm = 2.0387, lr_0 = 3.9290e-04
Validation rmse = 0.861937
Epoch 13
Loss = 1.8057e-03, PNorm = 62.4359, GNorm = 1.7680, lr_0 = 3.8019e-04
Loss = 2.2143e-03, PNorm = 62.4555, GNorm = 2.3810, lr_0 = 3.6789e-04
Loss = 2.2461e-03, PNorm = 62.4760, GNorm = 3.3677, lr_0 = 3.5598e-04
Validation rmse = 0.920588
Epoch 14
Loss = 1.9121e-03, PNorm = 62.4917, GNorm = 1.2693, lr_0 = 3.4446e-04
Loss = 1.5530e-03, PNorm = 62.5120, GNorm = 1.3522, lr_0 = 3.3332e-04
Validation rmse = 0.864111
Epoch 15
Loss = 1.5654e-03, PNorm = 62.5264, GNorm = 2.1580, lr_0 = 3.2253e-04
Loss = 1.9752e-03, PNorm = 62.5399, GNorm = 2.2307, lr_0 = 3.1209e-04
Loss = 1.5166e-03, PNorm = 62.5592, GNorm = 1.2083, lr_0 = 3.0200e-04
Validation rmse = 0.890111
Epoch 16
Loss = 1.5638e-03, PNorm = 62.5736, GNorm = 0.4012, lr_0 = 2.9222e-04
Loss = 1.6728e-03, PNorm = 62.5867, GNorm = 2.0394, lr_0 = 2.8277e-04
Validation rmse = 0.840358
Epoch 17
Loss = 1.4933e-03, PNorm = 62.5973, GNorm = 1.0910, lr_0 = 2.7272e-04
Loss = 1.3272e-03, PNorm = 62.6099, GNorm = 2.3145, lr_0 = 2.6389e-04
Loss = 1.5157e-03, PNorm = 62.6229, GNorm = 0.7052, lr_0 = 2.5535e-04
Validation rmse = 0.847382
Epoch 18
Loss = 1.4277e-03, PNorm = 62.6317, GNorm = 0.5910, lr_0 = 2.4709e-04
Loss = 1.3375e-03, PNorm = 62.6401, GNorm = 0.8681, lr_0 = 2.3910e-04
Loss = 1.3995e-03, PNorm = 62.6508, GNorm = 1.3800, lr_0 = 2.3136e-04
Validation rmse = 0.813436
Epoch 19
Loss = 1.3053e-03, PNorm = 62.6626, GNorm = 0.6807, lr_0 = 2.2387e-04
Loss = 1.5062e-03, PNorm = 62.6729, GNorm = 1.5133, lr_0 = 2.1663e-04
Validation rmse = 0.839857
Epoch 20
Loss = 9.5377e-04, PNorm = 62.6817, GNorm = 1.0424, lr_0 = 2.0962e-04
Loss = 1.2831e-03, PNorm = 62.6894, GNorm = 0.6568, lr_0 = 2.0283e-04
Loss = 1.1756e-03, PNorm = 62.6979, GNorm = 0.4711, lr_0 = 1.9627e-04
Validation rmse = 0.839013
Epoch 21
Loss = 1.1520e-03, PNorm = 62.7075, GNorm = 1.2289, lr_0 = 1.8992e-04
Loss = 1.1680e-03, PNorm = 62.7137, GNorm = 1.3184, lr_0 = 1.8377e-04
Validation rmse = 0.827798
Epoch 22
Loss = 1.1351e-03, PNorm = 62.7237, GNorm = 0.9164, lr_0 = 1.7783e-04
Loss = 1.1955e-03, PNorm = 62.7336, GNorm = 1.1495, lr_0 = 1.7207e-04
Loss = 1.2173e-03, PNorm = 62.7405, GNorm = 0.5714, lr_0 = 1.6651e-04
Validation rmse = 0.837499
Epoch 23
Loss = 1.0397e-03, PNorm = 62.7485, GNorm = 0.9888, lr_0 = 1.6059e-04
Loss = 1.1637e-03, PNorm = 62.7553, GNorm = 1.5218, lr_0 = 1.5539e-04
Validation rmse = 0.824813
Epoch 24
Loss = 9.3223e-04, PNorm = 62.7610, GNorm = 1.0935, lr_0 = 1.5036e-04
Loss = 1.1265e-03, PNorm = 62.7662, GNorm = 0.4542, lr_0 = 1.4550e-04
Loss = 1.1193e-03, PNorm = 62.7721, GNorm = 1.3651, lr_0 = 1.4079e-04
Validation rmse = 0.880089
Epoch 25
Loss = 1.0770e-03, PNorm = 62.7782, GNorm = 0.9950, lr_0 = 1.3623e-04
Loss = 1.1048e-03, PNorm = 62.7842, GNorm = 0.7727, lr_0 = 1.3183e-04
Loss = 1.1457e-03, PNorm = 62.7906, GNorm = 0.9715, lr_0 = 1.2756e-04
Validation rmse = 0.820108
Epoch 26
Loss = 8.9827e-04, PNorm = 62.7963, GNorm = 1.3833, lr_0 = 1.2343e-04
Loss = 1.1173e-03, PNorm = 62.8015, GNorm = 0.7009, lr_0 = 1.1944e-04
Validation rmse = 0.827949
Epoch 27
Loss = 1.1999e-03, PNorm = 62.8070, GNorm = 0.9672, lr_0 = 1.1557e-04
Loss = 1.1429e-03, PNorm = 62.8120, GNorm = 1.3432, lr_0 = 1.1183e-04
Loss = 1.0990e-03, PNorm = 62.8162, GNorm = 0.5056, lr_0 = 1.0821e-04
Validation rmse = 0.856520
Epoch 28
Loss = 1.1843e-03, PNorm = 62.8206, GNorm = 1.4010, lr_0 = 1.0437e-04
Loss = 9.6844e-04, PNorm = 62.8247, GNorm = 1.5477, lr_0 = 1.0099e-04
Validation rmse = 0.827654
Epoch 29
Loss = 1.2078e-03, PNorm = 62.8289, GNorm = 0.7415, lr_0 = 1.0000e-04
Loss = 9.7267e-04, PNorm = 62.8326, GNorm = 0.9116, lr_0 = 1.0000e-04
Loss = 1.2420e-03, PNorm = 62.8378, GNorm = 2.4560, lr_0 = 1.0000e-04
Validation rmse = 0.829077
Model 0 best validation rmse = 0.813436 on epoch 18
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.802926
Ensemble test rmse = 0.802926
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1700, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,401
Moving model to cuda
Epoch 0
Loss = 2.2550e-02, PNorm = 61.1225, GNorm = 3.1030, lr_0 = 2.9800e-04
Loss = 1.0787e-02, PNorm = 61.1673, GNorm = 1.2650, lr_0 = 4.7800e-04
Validation rmse = 1.827992
Epoch 1
Loss = 7.9253e-03, PNorm = 61.2302, GNorm = 4.5373, lr_0 = 6.7600e-04
Loss = 9.2343e-03, PNorm = 61.3022, GNorm = 1.5445, lr_0 = 8.5600e-04
Loss = 7.8844e-03, PNorm = 61.3809, GNorm = 2.1422, lr_0 = 9.9344e-04
Validation rmse = 1.485170
Epoch 2
Loss = 6.7095e-03, PNorm = 61.4561, GNorm = 6.6416, lr_0 = 9.6130e-04
Loss = 5.9709e-03, PNorm = 61.5159, GNorm = 1.3429, lr_0 = 9.3019e-04
Validation rmse = 1.335322
Epoch 3
Loss = 5.5458e-03, PNorm = 61.5693, GNorm = 2.5877, lr_0 = 9.0009e-04
Loss = 4.8633e-03, PNorm = 61.6239, GNorm = 0.9914, lr_0 = 8.7096e-04
Loss = 4.0812e-03, PNorm = 61.6749, GNorm = 1.0699, lr_0 = 8.4278e-04
Validation rmse = 0.992464
Epoch 4
Loss = 4.0181e-03, PNorm = 61.7137, GNorm = 1.8897, lr_0 = 8.1551e-04
Loss = 3.2484e-03, PNorm = 61.7576, GNorm = 3.4541, lr_0 = 7.8912e-04
Validation rmse = 0.897626
Epoch 5
Loss = 3.4488e-03, PNorm = 61.8028, GNorm = 3.0764, lr_0 = 7.6358e-04
Loss = 4.2722e-03, PNorm = 61.8445, GNorm = 5.3843, lr_0 = 7.3888e-04
Loss = 3.1883e-03, PNorm = 61.8871, GNorm = 3.3229, lr_0 = 7.1497e-04
Validation rmse = 0.903596
Epoch 6
Loss = 3.4375e-03, PNorm = 61.9294, GNorm = 1.1125, lr_0 = 6.8956e-04
Loss = 2.8906e-03, PNorm = 61.9651, GNorm = 3.4573, lr_0 = 6.6725e-04
Loss = 2.7135e-03, PNorm = 61.9956, GNorm = 2.4801, lr_0 = 6.4565e-04
Validation rmse = 0.781317
Epoch 7
Loss = 2.6852e-03, PNorm = 62.0291, GNorm = 2.2196, lr_0 = 6.2476e-04
Loss = 2.5913e-03, PNorm = 62.0561, GNorm = 3.6236, lr_0 = 6.0454e-04
Validation rmse = 0.825173
Epoch 8
Loss = 3.5948e-03, PNorm = 62.0916, GNorm = 3.7816, lr_0 = 5.8498e-04
Loss = 2.6340e-03, PNorm = 62.1224, GNorm = 1.8394, lr_0 = 5.6605e-04
Loss = 2.3077e-03, PNorm = 62.1484, GNorm = 1.0745, lr_0 = 5.4774e-04
Validation rmse = 0.795485
Epoch 9
Loss = 2.2937e-03, PNorm = 62.1745, GNorm = 2.7148, lr_0 = 5.3001e-04
Loss = 2.3477e-03, PNorm = 62.2033, GNorm = 0.7952, lr_0 = 5.1286e-04
Validation rmse = 0.896401
Epoch 10
Loss = 2.6279e-03, PNorm = 62.2244, GNorm = 3.3743, lr_0 = 4.9627e-04
Loss = 3.0487e-03, PNorm = 62.2536, GNorm = 3.2721, lr_0 = 4.8021e-04
Loss = 2.3131e-03, PNorm = 62.2809, GNorm = 2.8818, lr_0 = 4.6467e-04
Validation rmse = 0.848623
Epoch 11
Loss = 2.3924e-03, PNorm = 62.3073, GNorm = 1.3944, lr_0 = 4.4963e-04
Loss = 2.1647e-03, PNorm = 62.3282, GNorm = 0.9496, lr_0 = 4.3508e-04
Validation rmse = 0.730857
Epoch 12
Loss = 2.1447e-03, PNorm = 62.3526, GNorm = 1.0055, lr_0 = 4.1962e-04
Loss = 2.0319e-03, PNorm = 62.3723, GNorm = 2.2782, lr_0 = 4.0604e-04
Loss = 2.4391e-03, PNorm = 62.3944, GNorm = 1.8413, lr_0 = 3.9290e-04
Validation rmse = 0.984195
Epoch 13
Loss = 2.1128e-03, PNorm = 62.4180, GNorm = 0.9728, lr_0 = 3.8019e-04
Loss = 2.6172e-03, PNorm = 62.4385, GNorm = 2.5083, lr_0 = 3.6789e-04
Loss = 2.1683e-03, PNorm = 62.4579, GNorm = 0.6852, lr_0 = 3.5598e-04
Validation rmse = 0.727482
Epoch 14
Loss = 1.7583e-03, PNorm = 62.4772, GNorm = 0.8822, lr_0 = 3.4446e-04
Loss = 1.6544e-03, PNorm = 62.4923, GNorm = 1.2677, lr_0 = 3.3332e-04
Validation rmse = 0.784486
Epoch 15
Loss = 1.4703e-03, PNorm = 62.5078, GNorm = 0.9432, lr_0 = 3.2253e-04
Loss = 1.9323e-03, PNorm = 62.5245, GNorm = 2.9933, lr_0 = 3.1209e-04
Loss = 1.9441e-03, PNorm = 62.5436, GNorm = 1.0553, lr_0 = 3.0200e-04
Validation rmse = 0.825727
Epoch 16
Loss = 2.2470e-03, PNorm = 62.5591, GNorm = 3.1592, lr_0 = 2.9222e-04
Loss = 1.2837e-03, PNorm = 62.5709, GNorm = 1.0977, lr_0 = 2.8277e-04
Validation rmse = 0.709522
Epoch 17
Loss = 1.4967e-03, PNorm = 62.5815, GNorm = 0.4535, lr_0 = 2.7272e-04
Loss = 1.6516e-03, PNorm = 62.5909, GNorm = 0.7224, lr_0 = 2.6389e-04
Loss = 1.4907e-03, PNorm = 62.6042, GNorm = 1.7544, lr_0 = 2.5535e-04
Validation rmse = 0.721299
Epoch 18
Loss = 1.4017e-03, PNorm = 62.6154, GNorm = 1.3223, lr_0 = 2.4709e-04
Loss = 1.5841e-03, PNorm = 62.6262, GNorm = 0.7197, lr_0 = 2.3910e-04
Loss = 1.4492e-03, PNorm = 62.6379, GNorm = 1.1195, lr_0 = 2.3136e-04
Validation rmse = 0.724665
Epoch 19
Loss = 1.4433e-03, PNorm = 62.6467, GNorm = 1.3847, lr_0 = 2.2387e-04
Loss = 1.4753e-03, PNorm = 62.6567, GNorm = 1.1715, lr_0 = 2.1663e-04
Validation rmse = 0.693674
Epoch 20
Loss = 1.0720e-03, PNorm = 62.6664, GNorm = 0.6768, lr_0 = 2.0962e-04
Loss = 1.5690e-03, PNorm = 62.6750, GNorm = 0.7063, lr_0 = 2.0283e-04
Loss = 1.3500e-03, PNorm = 62.6818, GNorm = 0.8375, lr_0 = 1.9627e-04
Validation rmse = 0.703422
Epoch 21
Loss = 1.3939e-03, PNorm = 62.6889, GNorm = 0.5197, lr_0 = 1.8992e-04
Loss = 1.3801e-03, PNorm = 62.6969, GNorm = 1.5065, lr_0 = 1.8377e-04
Validation rmse = 0.690507
Epoch 22
Loss = 1.1980e-03, PNorm = 62.7059, GNorm = 0.9190, lr_0 = 1.7783e-04
Loss = 1.4057e-03, PNorm = 62.7137, GNorm = 0.9728, lr_0 = 1.7207e-04
Loss = 1.2884e-03, PNorm = 62.7215, GNorm = 0.4842, lr_0 = 1.6651e-04
Validation rmse = 0.688828
Epoch 23
Loss = 1.2953e-03, PNorm = 62.7305, GNorm = 1.7783, lr_0 = 1.6059e-04
Loss = 1.3716e-03, PNorm = 62.7399, GNorm = 1.7304, lr_0 = 1.5539e-04
Validation rmse = 0.805429
Epoch 24
Loss = 1.5244e-03, PNorm = 62.7474, GNorm = 2.1490, lr_0 = 1.5036e-04
Loss = 1.5760e-03, PNorm = 62.7535, GNorm = 1.5887, lr_0 = 1.4550e-04
Loss = 1.3699e-03, PNorm = 62.7613, GNorm = 1.0432, lr_0 = 1.4079e-04
Validation rmse = 0.671218
Epoch 25
Loss = 9.7432e-04, PNorm = 62.7680, GNorm = 0.4024, lr_0 = 1.3623e-04
Loss = 1.3439e-03, PNorm = 62.7739, GNorm = 1.1260, lr_0 = 1.3183e-04
Loss = 1.3826e-03, PNorm = 62.7805, GNorm = 1.3513, lr_0 = 1.2756e-04
Validation rmse = 0.683073
Epoch 26
Loss = 1.3840e-03, PNorm = 62.7866, GNorm = 0.9473, lr_0 = 1.2343e-04
Loss = 1.3111e-03, PNorm = 62.7917, GNorm = 1.3943, lr_0 = 1.1944e-04
Validation rmse = 0.696621
Epoch 27
Loss = 1.4899e-03, PNorm = 62.7957, GNorm = 0.5551, lr_0 = 1.1557e-04
Loss = 1.2360e-03, PNorm = 62.8017, GNorm = 2.1740, lr_0 = 1.1183e-04
Loss = 1.3827e-03, PNorm = 62.8083, GNorm = 0.3727, lr_0 = 1.0821e-04
Validation rmse = 0.706646
Epoch 28
Loss = 1.4181e-03, PNorm = 62.8143, GNorm = 0.6398, lr_0 = 1.0437e-04
Loss = 1.0683e-03, PNorm = 62.8181, GNorm = 1.0391, lr_0 = 1.0099e-04
Validation rmse = 0.742958
Epoch 29
Loss = 1.4039e-03, PNorm = 62.8226, GNorm = 2.1162, lr_0 = 1.0000e-04
Loss = 1.2811e-03, PNorm = 62.8280, GNorm = 1.4741, lr_0 = 1.0000e-04
Loss = 1.2164e-03, PNorm = 62.8320, GNorm = 0.6836, lr_0 = 1.0000e-04
Validation rmse = 0.682474
Model 0 best validation rmse = 0.671218 on epoch 24
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.748333
Ensemble test rmse = 0.748333
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1700, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,401
Moving model to cuda
Epoch 0
Loss = 2.0900e-02, PNorm = 61.1236, GNorm = 12.6717, lr_0 = 2.9800e-04
Loss = 1.3828e-02, PNorm = 61.1679, GNorm = 4.1525, lr_0 = 4.7800e-04
Validation rmse = 1.276237
Epoch 1
Loss = 9.9270e-03, PNorm = 61.2496, GNorm = 13.3358, lr_0 = 6.7600e-04
Loss = 7.8885e-03, PNorm = 61.3215, GNorm = 5.3650, lr_0 = 8.5600e-04
Loss = 8.4826e-03, PNorm = 61.4118, GNorm = 6.9468, lr_0 = 9.9344e-04
Validation rmse = 1.261371
Epoch 2
Loss = 7.3262e-03, PNorm = 61.5029, GNorm = 1.8974, lr_0 = 9.6130e-04
Loss = 6.4671e-03, PNorm = 61.5692, GNorm = 2.4159, lr_0 = 9.3019e-04
Validation rmse = 0.972897
Epoch 3
Loss = 4.8217e-03, PNorm = 61.6362, GNorm = 2.1587, lr_0 = 9.0009e-04
Loss = 4.4253e-03, PNorm = 61.6940, GNorm = 1.1683, lr_0 = 8.7096e-04
Loss = 4.3160e-03, PNorm = 61.7490, GNorm = 1.4451, lr_0 = 8.4278e-04
Validation rmse = 0.878723
Epoch 4
Loss = 4.8433e-03, PNorm = 61.8067, GNorm = 1.6707, lr_0 = 8.1551e-04
Loss = 5.1067e-03, PNorm = 61.8678, GNorm = 1.8514, lr_0 = 7.8912e-04
Validation rmse = 0.800457
Epoch 5
Loss = 3.6973e-03, PNorm = 61.9180, GNorm = 1.0723, lr_0 = 7.6358e-04
Loss = 3.3359e-03, PNorm = 61.9670, GNorm = 2.9426, lr_0 = 7.3888e-04
Loss = 3.5945e-03, PNorm = 62.0134, GNorm = 3.2029, lr_0 = 7.1497e-04
Validation rmse = 0.910155
Epoch 6
Loss = 3.6249e-03, PNorm = 62.0546, GNorm = 1.2725, lr_0 = 6.8956e-04
Loss = 2.7603e-03, PNorm = 62.0912, GNorm = 1.7902, lr_0 = 6.6725e-04
Loss = 3.2217e-03, PNorm = 62.1241, GNorm = 1.6951, lr_0 = 6.4565e-04
Validation rmse = 0.781029
Epoch 7
Loss = 3.0431e-03, PNorm = 62.1581, GNorm = 3.5468, lr_0 = 6.2476e-04
Loss = 2.8697e-03, PNorm = 62.2014, GNorm = 2.1420, lr_0 = 6.0454e-04
Validation rmse = 0.839818
Epoch 8
Loss = 3.1401e-03, PNorm = 62.2393, GNorm = 0.5890, lr_0 = 5.8498e-04
Loss = 2.3385e-03, PNorm = 62.2695, GNorm = 1.2920, lr_0 = 5.6605e-04
Loss = 2.4988e-03, PNorm = 62.2984, GNorm = 1.6702, lr_0 = 5.4774e-04
Validation rmse = 0.760962
Epoch 9
Loss = 2.5562e-03, PNorm = 62.3301, GNorm = 1.1373, lr_0 = 5.3001e-04
Loss = 2.4740e-03, PNorm = 62.3622, GNorm = 2.7157, lr_0 = 5.1286e-04
Validation rmse = 0.691802
Epoch 10
Loss = 2.1542e-03, PNorm = 62.3887, GNorm = 1.8002, lr_0 = 4.9627e-04
Loss = 2.2643e-03, PNorm = 62.4105, GNorm = 0.9539, lr_0 = 4.8021e-04
Loss = 2.6244e-03, PNorm = 62.4436, GNorm = 2.7390, lr_0 = 4.6467e-04
Validation rmse = 0.713033
Epoch 11
Loss = 2.3733e-03, PNorm = 62.4686, GNorm = 1.6779, lr_0 = 4.4963e-04
Loss = 2.3416e-03, PNorm = 62.4929, GNorm = 0.7398, lr_0 = 4.3508e-04
Validation rmse = 0.737275
Epoch 12
Loss = 1.2845e-03, PNorm = 62.5196, GNorm = 0.9469, lr_0 = 4.1962e-04
Loss = 2.2664e-03, PNorm = 62.5411, GNorm = 1.8272, lr_0 = 4.0604e-04
Loss = 1.8221e-03, PNorm = 62.5617, GNorm = 0.7349, lr_0 = 3.9290e-04
Validation rmse = 0.722319
Epoch 13
Loss = 1.8056e-03, PNorm = 62.5840, GNorm = 1.3442, lr_0 = 3.8019e-04
Loss = 1.9105e-03, PNorm = 62.6054, GNorm = 1.9955, lr_0 = 3.6789e-04
Loss = 2.2407e-03, PNorm = 62.6282, GNorm = 0.7915, lr_0 = 3.5598e-04
Validation rmse = 0.692822
Epoch 14
Loss = 1.6283e-03, PNorm = 62.6458, GNorm = 1.0286, lr_0 = 3.4446e-04
Loss = 1.8776e-03, PNorm = 62.6651, GNorm = 1.3013, lr_0 = 3.3332e-04
Validation rmse = 0.834210
Epoch 15
Loss = 2.2866e-03, PNorm = 62.6837, GNorm = 1.3418, lr_0 = 3.2253e-04
Loss = 1.7524e-03, PNorm = 62.7024, GNorm = 1.4453, lr_0 = 3.1209e-04
Loss = 2.0732e-03, PNorm = 62.7206, GNorm = 1.0765, lr_0 = 3.0200e-04
Validation rmse = 0.663559
Epoch 16
Loss = 1.6763e-03, PNorm = 62.7376, GNorm = 0.9740, lr_0 = 2.9222e-04
Loss = 1.5243e-03, PNorm = 62.7522, GNorm = 1.0209, lr_0 = 2.8277e-04
Validation rmse = 0.673240
Epoch 17
Loss = 1.3690e-03, PNorm = 62.7675, GNorm = 2.0368, lr_0 = 2.7272e-04
Loss = 1.4140e-03, PNorm = 62.7787, GNorm = 0.6792, lr_0 = 2.6389e-04
Loss = 1.7107e-03, PNorm = 62.7906, GNorm = 2.6770, lr_0 = 2.5535e-04
Validation rmse = 0.679884
Epoch 18
Loss = 1.6262e-03, PNorm = 62.8078, GNorm = 0.5895, lr_0 = 2.4709e-04
Loss = 1.6850e-03, PNorm = 62.8229, GNorm = 0.9579, lr_0 = 2.3910e-04
Loss = 1.3274e-03, PNorm = 62.8349, GNorm = 0.4478, lr_0 = 2.3136e-04
Validation rmse = 0.708060
Epoch 19
Loss = 1.7210e-03, PNorm = 62.8471, GNorm = 0.9743, lr_0 = 2.2387e-04
Loss = 1.4310e-03, PNorm = 62.8586, GNorm = 1.3052, lr_0 = 2.1663e-04
Validation rmse = 0.669446
Epoch 20
Loss = 1.5706e-03, PNorm = 62.8695, GNorm = 3.1932, lr_0 = 2.0962e-04
Loss = 1.3347e-03, PNorm = 62.8811, GNorm = 1.6292, lr_0 = 2.0283e-04
Loss = 1.3066e-03, PNorm = 62.8902, GNorm = 1.4071, lr_0 = 1.9627e-04
Validation rmse = 0.699966
Epoch 21
Loss = 1.4220e-03, PNorm = 62.8991, GNorm = 1.0902, lr_0 = 1.8992e-04
Loss = 1.5040e-03, PNorm = 62.9108, GNorm = 1.3856, lr_0 = 1.8377e-04
Validation rmse = 0.695424
Epoch 22
Loss = 1.4787e-03, PNorm = 62.9197, GNorm = 1.1507, lr_0 = 1.7783e-04
Loss = 1.4681e-03, PNorm = 62.9288, GNorm = 0.3962, lr_0 = 1.7207e-04
Loss = 1.2627e-03, PNorm = 62.9370, GNorm = 0.8400, lr_0 = 1.6651e-04
Validation rmse = 0.653329
Epoch 23
Loss = 1.3279e-03, PNorm = 62.9463, GNorm = 0.8818, lr_0 = 1.6059e-04
Loss = 1.3079e-03, PNorm = 62.9525, GNorm = 0.6167, lr_0 = 1.5539e-04
Validation rmse = 0.649668
Epoch 24
Loss = 1.2840e-03, PNorm = 62.9600, GNorm = 1.0068, lr_0 = 1.5036e-04
Loss = 1.1242e-03, PNorm = 62.9666, GNorm = 0.4882, lr_0 = 1.4550e-04
Loss = 1.1098e-03, PNorm = 62.9731, GNorm = 1.4782, lr_0 = 1.4079e-04
Validation rmse = 0.663175
Epoch 25
Loss = 1.3597e-03, PNorm = 62.9794, GNorm = 2.1196, lr_0 = 1.3623e-04
Loss = 1.2226e-03, PNorm = 62.9876, GNorm = 0.6398, lr_0 = 1.3183e-04
Loss = 1.1295e-03, PNorm = 62.9927, GNorm = 1.1312, lr_0 = 1.2756e-04
Validation rmse = 0.656356
Epoch 26
Loss = 1.1271e-03, PNorm = 62.9980, GNorm = 2.1286, lr_0 = 1.2343e-04
Loss = 1.2110e-03, PNorm = 63.0046, GNorm = 0.4934, lr_0 = 1.1944e-04
Validation rmse = 0.657980
Epoch 27
Loss = 1.3621e-03, PNorm = 63.0099, GNorm = 1.0159, lr_0 = 1.1557e-04
Loss = 1.2969e-03, PNorm = 63.0166, GNorm = 0.6643, lr_0 = 1.1183e-04
Loss = 1.0514e-03, PNorm = 63.0226, GNorm = 0.7425, lr_0 = 1.0821e-04
Validation rmse = 0.675017
Epoch 28
Loss = 1.1605e-03, PNorm = 63.0281, GNorm = 0.5297, lr_0 = 1.0437e-04
Loss = 1.2946e-03, PNorm = 63.0333, GNorm = 1.5823, lr_0 = 1.0099e-04
Validation rmse = 0.660367
Epoch 29
Loss = 1.3552e-03, PNorm = 63.0386, GNorm = 1.3130, lr_0 = 1.0000e-04
Loss = 1.1980e-03, PNorm = 63.0447, GNorm = 0.8831, lr_0 = 1.0000e-04
Loss = 1.0261e-03, PNorm = 63.0492, GNorm = 0.4651, lr_0 = 1.0000e-04
Validation rmse = 0.657089
Model 0 best validation rmse = 0.649668 on epoch 23
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.674730
Ensemble test rmse = 0.674730
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1700, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,401
Moving model to cuda
Epoch 0
Loss = 2.1649e-02, PNorm = 61.1220, GNorm = 3.4584, lr_0 = 2.9800e-04
Loss = 1.2982e-02, PNorm = 61.1654, GNorm = 2.3069, lr_0 = 4.7800e-04
Validation rmse = 1.443420
Epoch 1
Loss = 8.1593e-03, PNorm = 61.2398, GNorm = 3.3745, lr_0 = 6.7600e-04
Loss = 8.8446e-03, PNorm = 61.3196, GNorm = 2.6881, lr_0 = 8.5600e-04
Loss = 7.3303e-03, PNorm = 61.4069, GNorm = 2.9927, lr_0 = 9.9344e-04
Validation rmse = 1.364484
Epoch 2
Loss = 7.9249e-03, PNorm = 61.4930, GNorm = 1.5299, lr_0 = 9.6130e-04
Loss = 5.9829e-03, PNorm = 61.5664, GNorm = 3.3805, lr_0 = 9.3019e-04
Validation rmse = 1.199077
Epoch 3
Loss = 5.9660e-03, PNorm = 61.6262, GNorm = 2.2861, lr_0 = 9.0009e-04
Loss = 4.8484e-03, PNorm = 61.6908, GNorm = 1.2283, lr_0 = 8.7096e-04
Loss = 4.8086e-03, PNorm = 61.7519, GNorm = 1.2670, lr_0 = 8.4278e-04
Validation rmse = 1.092492
Epoch 4
Loss = 5.3190e-03, PNorm = 61.8078, GNorm = 5.6132, lr_0 = 8.1551e-04
Loss = 3.6644e-03, PNorm = 61.8720, GNorm = 0.9449, lr_0 = 7.8912e-04
Validation rmse = 0.855242
Epoch 5
Loss = 2.5937e-03, PNorm = 61.9169, GNorm = 1.1937, lr_0 = 7.6358e-04
Loss = 2.7622e-03, PNorm = 61.9547, GNorm = 1.4884, lr_0 = 7.3888e-04
Loss = 3.3638e-03, PNorm = 61.9909, GNorm = 3.6275, lr_0 = 7.1497e-04
Validation rmse = 0.865048
Epoch 6
Loss = 2.9635e-03, PNorm = 62.0359, GNorm = 2.1781, lr_0 = 6.8956e-04
Loss = 3.3666e-03, PNorm = 62.0735, GNorm = 1.9556, lr_0 = 6.6725e-04
Loss = 2.9822e-03, PNorm = 62.1130, GNorm = 1.1831, lr_0 = 6.4565e-04
Validation rmse = 0.821140
Epoch 7
Loss = 2.7990e-03, PNorm = 62.1505, GNorm = 1.7024, lr_0 = 6.2476e-04
Loss = 2.8031e-03, PNorm = 62.1886, GNorm = 1.3349, lr_0 = 6.0454e-04
Validation rmse = 0.763613
Epoch 8
Loss = 2.1319e-03, PNorm = 62.2192, GNorm = 1.2384, lr_0 = 5.8498e-04
Loss = 2.3566e-03, PNorm = 62.2482, GNorm = 1.6405, lr_0 = 5.6605e-04
Loss = 2.3212e-03, PNorm = 62.2765, GNorm = 0.8423, lr_0 = 5.4774e-04
Validation rmse = 0.717231
Epoch 9
Loss = 2.3841e-03, PNorm = 62.3046, GNorm = 1.6929, lr_0 = 5.3001e-04
Loss = 2.4666e-03, PNorm = 62.3331, GNorm = 1.2627, lr_0 = 5.1286e-04
Validation rmse = 0.727701
Epoch 10
Loss = 1.1513e-03, PNorm = 62.3608, GNorm = 0.5732, lr_0 = 4.9627e-04
Loss = 2.0634e-03, PNorm = 62.3837, GNorm = 2.5838, lr_0 = 4.8021e-04
Loss = 2.3815e-03, PNorm = 62.4087, GNorm = 3.6588, lr_0 = 4.6467e-04
Validation rmse = 0.755832
Epoch 11
Loss = 1.9809e-03, PNorm = 62.4340, GNorm = 0.6296, lr_0 = 4.4963e-04
Loss = 2.2375e-03, PNorm = 62.4602, GNorm = 2.2235, lr_0 = 4.3508e-04
Validation rmse = 0.732202
Epoch 12
Loss = 2.1524e-03, PNorm = 62.4840, GNorm = 1.7114, lr_0 = 4.1962e-04
Loss = 2.1793e-03, PNorm = 62.5055, GNorm = 0.9316, lr_0 = 4.0604e-04
Loss = 2.1041e-03, PNorm = 62.5276, GNorm = 2.0960, lr_0 = 3.9290e-04
Validation rmse = 0.706387
Epoch 13
Loss = 2.3190e-03, PNorm = 62.5509, GNorm = 1.4083, lr_0 = 3.8019e-04
Loss = 2.0881e-03, PNorm = 62.5698, GNorm = 2.4130, lr_0 = 3.6789e-04
Loss = 1.6446e-03, PNorm = 62.5906, GNorm = 0.7154, lr_0 = 3.5598e-04
Validation rmse = 0.674213
Epoch 14
Loss = 1.5036e-03, PNorm = 62.6076, GNorm = 0.5422, lr_0 = 3.4446e-04
Loss = 1.5115e-03, PNorm = 62.6244, GNorm = 0.9900, lr_0 = 3.3332e-04
Validation rmse = 0.664768
Epoch 15
Loss = 1.7471e-03, PNorm = 62.6384, GNorm = 2.4551, lr_0 = 3.2253e-04
Loss = 1.8363e-03, PNorm = 62.6550, GNorm = 0.8508, lr_0 = 3.1209e-04
Loss = 1.6710e-03, PNorm = 62.6703, GNorm = 1.1668, lr_0 = 3.0200e-04
Validation rmse = 0.642086
Epoch 16
Loss = 1.5058e-03, PNorm = 62.6861, GNorm = 0.4591, lr_0 = 2.9222e-04
Loss = 1.6282e-03, PNorm = 62.7017, GNorm = 0.7811, lr_0 = 2.8277e-04
Validation rmse = 0.637769
Epoch 17
Loss = 1.4553e-03, PNorm = 62.7169, GNorm = 1.3125, lr_0 = 2.7272e-04
Loss = 1.3971e-03, PNorm = 62.7294, GNorm = 1.8983, lr_0 = 2.6389e-04
Loss = 1.4747e-03, PNorm = 62.7412, GNorm = 0.4482, lr_0 = 2.5535e-04
Validation rmse = 0.654094
Epoch 18
Loss = 1.3638e-03, PNorm = 62.7548, GNorm = 2.5097, lr_0 = 2.4709e-04
Loss = 1.6851e-03, PNorm = 62.7663, GNorm = 1.3498, lr_0 = 2.3910e-04
Loss = 1.3483e-03, PNorm = 62.7806, GNorm = 1.1501, lr_0 = 2.3136e-04
Validation rmse = 0.655576
Epoch 19
Loss = 1.6968e-03, PNorm = 62.7927, GNorm = 1.6331, lr_0 = 2.2387e-04
Loss = 1.2952e-03, PNorm = 62.8039, GNorm = 0.6171, lr_0 = 2.1663e-04
Validation rmse = 0.629471
Epoch 20
Loss = 1.3739e-03, PNorm = 62.8143, GNorm = 0.6390, lr_0 = 2.0962e-04
Loss = 1.5658e-03, PNorm = 62.8253, GNorm = 0.8487, lr_0 = 2.0283e-04
Loss = 1.5189e-03, PNorm = 62.8367, GNorm = 0.6006, lr_0 = 1.9627e-04
Validation rmse = 0.656624
Epoch 21
Loss = 1.3151e-03, PNorm = 62.8479, GNorm = 0.5276, lr_0 = 1.8992e-04
Loss = 1.4901e-03, PNorm = 62.8580, GNorm = 1.0036, lr_0 = 1.8377e-04
Validation rmse = 0.658725
Epoch 22
Loss = 2.1374e-03, PNorm = 62.8670, GNorm = 2.8349, lr_0 = 1.7783e-04
Loss = 1.3870e-03, PNorm = 62.8780, GNorm = 1.3652, lr_0 = 1.7207e-04
Loss = 1.1370e-03, PNorm = 62.8861, GNorm = 1.2779, lr_0 = 1.6651e-04
Validation rmse = 0.634389
Epoch 23
Loss = 1.4509e-03, PNorm = 62.8959, GNorm = 1.3115, lr_0 = 1.6059e-04
Loss = 1.2061e-03, PNorm = 62.9022, GNorm = 0.6855, lr_0 = 1.5539e-04
Validation rmse = 0.628176
Epoch 24
Loss = 1.0875e-03, PNorm = 62.9099, GNorm = 1.1435, lr_0 = 1.5036e-04
Loss = 1.2186e-03, PNorm = 62.9179, GNorm = 0.5658, lr_0 = 1.4550e-04
Loss = 1.2232e-03, PNorm = 62.9251, GNorm = 0.6826, lr_0 = 1.4079e-04
Validation rmse = 0.673389
Epoch 25
Loss = 1.4592e-03, PNorm = 62.9321, GNorm = 0.9573, lr_0 = 1.3623e-04
Loss = 1.3027e-03, PNorm = 62.9384, GNorm = 0.6605, lr_0 = 1.3183e-04
Loss = 1.3410e-03, PNorm = 62.9462, GNorm = 0.6259, lr_0 = 1.2756e-04
Validation rmse = 0.617129
Epoch 26
Loss = 1.1806e-03, PNorm = 62.9532, GNorm = 0.7309, lr_0 = 1.2343e-04
Loss = 1.1485e-03, PNorm = 62.9594, GNorm = 0.6429, lr_0 = 1.1944e-04
Validation rmse = 0.617492
Epoch 27
Loss = 9.7332e-04, PNorm = 62.9646, GNorm = 0.7323, lr_0 = 1.1557e-04
Loss = 1.2468e-03, PNorm = 62.9703, GNorm = 1.0133, lr_0 = 1.1183e-04
Loss = 1.0965e-03, PNorm = 62.9748, GNorm = 1.0631, lr_0 = 1.0821e-04
Validation rmse = 0.615783
Epoch 28
Loss = 1.0863e-03, PNorm = 62.9804, GNorm = 0.4160, lr_0 = 1.0437e-04
Loss = 1.2327e-03, PNorm = 62.9856, GNorm = 2.0619, lr_0 = 1.0099e-04
Validation rmse = 0.614365
Epoch 29
Loss = 7.6179e-04, PNorm = 62.9909, GNorm = 0.7145, lr_0 = 1.0000e-04
Loss = 1.0514e-03, PNorm = 62.9949, GNorm = 1.1207, lr_0 = 1.0000e-04
Loss = 1.2418e-03, PNorm = 62.9988, GNorm = 0.7613, lr_0 = 1.0000e-04
Validation rmse = 0.629082
Model 0 best validation rmse = 0.614365 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.898263
Ensemble test rmse = 0.898263
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1700, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,401
Moving model to cuda
Epoch 0
Loss = 2.1421e-02, PNorm = 61.1225, GNorm = 7.6157, lr_0 = 2.9800e-04
Loss = 1.4259e-02, PNorm = 61.1644, GNorm = 6.9424, lr_0 = 4.7800e-04
Validation rmse = 1.473035
Epoch 1
Loss = 7.5549e-03, PNorm = 61.2401, GNorm = 2.1055, lr_0 = 6.7600e-04
Loss = 6.9667e-03, PNorm = 61.3106, GNorm = 3.2788, lr_0 = 8.5600e-04
Loss = 7.2688e-03, PNorm = 61.3901, GNorm = 2.3741, lr_0 = 9.9344e-04
Validation rmse = 1.376998
Epoch 2
Loss = 6.7679e-03, PNorm = 61.4774, GNorm = 1.5878, lr_0 = 9.6130e-04
Loss = 4.6540e-03, PNorm = 61.5385, GNorm = 3.2064, lr_0 = 9.3019e-04
Validation rmse = 1.422068
Epoch 3
Loss = 5.6051e-03, PNorm = 61.5975, GNorm = 6.8828, lr_0 = 9.0009e-04
Loss = 5.1546e-03, PNorm = 61.6556, GNorm = 3.6347, lr_0 = 8.7096e-04
Loss = 4.1961e-03, PNorm = 61.7169, GNorm = 0.8345, lr_0 = 8.4278e-04
Validation rmse = 1.096615
Epoch 4
Loss = 3.7609e-03, PNorm = 61.7718, GNorm = 4.1420, lr_0 = 8.1551e-04
Loss = 3.7761e-03, PNorm = 61.8196, GNorm = 1.8218, lr_0 = 7.8912e-04
Validation rmse = 0.916783
Epoch 5
Loss = 3.4930e-03, PNorm = 61.8636, GNorm = 1.3622, lr_0 = 7.6358e-04
Loss = 2.9872e-03, PNorm = 61.9037, GNorm = 1.1921, lr_0 = 7.3888e-04
Loss = 4.4810e-03, PNorm = 61.9494, GNorm = 1.3536, lr_0 = 7.1497e-04
Validation rmse = 1.062443
Epoch 6
Loss = 3.9619e-03, PNorm = 61.9979, GNorm = 4.3070, lr_0 = 6.8956e-04
Loss = 3.3291e-03, PNorm = 62.0443, GNorm = 1.2603, lr_0 = 6.6725e-04
Loss = 2.7806e-03, PNorm = 62.0810, GNorm = 4.7229, lr_0 = 6.4565e-04
Validation rmse = 1.047611
Epoch 7
Loss = 2.6840e-03, PNorm = 62.1178, GNorm = 0.6667, lr_0 = 6.2476e-04
Loss = 2.6937e-03, PNorm = 62.1460, GNorm = 2.8510, lr_0 = 6.0454e-04
Validation rmse = 0.932559
Epoch 8
Loss = 2.9661e-03, PNorm = 62.1753, GNorm = 4.1389, lr_0 = 5.8498e-04
Loss = 2.6261e-03, PNorm = 62.2112, GNorm = 1.6355, lr_0 = 5.6605e-04
Loss = 2.1625e-03, PNorm = 62.2386, GNorm = 0.8428, lr_0 = 5.4774e-04
Validation rmse = 0.827937
Epoch 9
Loss = 2.3689e-03, PNorm = 62.2692, GNorm = 0.9406, lr_0 = 5.3001e-04
Loss = 2.4221e-03, PNorm = 62.2972, GNorm = 2.1092, lr_0 = 5.1286e-04
Validation rmse = 0.834431
Epoch 10
Loss = 2.1993e-03, PNorm = 62.3223, GNorm = 1.8898, lr_0 = 4.9627e-04
Loss = 2.1063e-03, PNorm = 62.3446, GNorm = 1.0720, lr_0 = 4.8021e-04
Loss = 1.8704e-03, PNorm = 62.3670, GNorm = 1.6138, lr_0 = 4.6467e-04
Validation rmse = 0.818700
Epoch 11
Loss = 2.1112e-03, PNorm = 62.3887, GNorm = 2.8418, lr_0 = 4.4963e-04
Loss = 2.8877e-03, PNorm = 62.4132, GNorm = 1.1605, lr_0 = 4.3508e-04
Validation rmse = 0.848926
Epoch 12
Loss = 1.7631e-03, PNorm = 62.4419, GNorm = 0.6732, lr_0 = 4.1962e-04
Loss = 1.7234e-03, PNorm = 62.4645, GNorm = 1.3088, lr_0 = 4.0604e-04
Loss = 1.8759e-03, PNorm = 62.4826, GNorm = 0.7356, lr_0 = 3.9290e-04
Validation rmse = 0.808911
Epoch 13
Loss = 1.7589e-03, PNorm = 62.5033, GNorm = 2.5516, lr_0 = 3.8019e-04
Loss = 1.8036e-03, PNorm = 62.5220, GNorm = 0.9960, lr_0 = 3.6789e-04
Loss = 1.5552e-03, PNorm = 62.5371, GNorm = 0.7135, lr_0 = 3.5598e-04
Validation rmse = 0.931754
Epoch 14
Loss = 2.0482e-03, PNorm = 62.5569, GNorm = 1.9390, lr_0 = 3.4446e-04
Loss = 1.7277e-03, PNorm = 62.5746, GNorm = 1.3750, lr_0 = 3.3332e-04
Validation rmse = 0.801697
Epoch 15
Loss = 1.2284e-03, PNorm = 62.5930, GNorm = 1.5208, lr_0 = 3.2253e-04
Loss = 1.6573e-03, PNorm = 62.6084, GNorm = 1.2342, lr_0 = 3.1209e-04
Loss = 1.5127e-03, PNorm = 62.6239, GNorm = 1.2804, lr_0 = 3.0200e-04
Validation rmse = 0.796932
Epoch 16
Loss = 1.6512e-03, PNorm = 62.6423, GNorm = 1.3224, lr_0 = 2.9222e-04
Loss = 1.8093e-03, PNorm = 62.6593, GNorm = 1.9270, lr_0 = 2.8277e-04
Validation rmse = 0.727606
Epoch 17
Loss = 1.5762e-03, PNorm = 62.6764, GNorm = 1.0150, lr_0 = 2.7272e-04
Loss = 1.4973e-03, PNorm = 62.6915, GNorm = 1.1575, lr_0 = 2.6389e-04
Loss = 1.3111e-03, PNorm = 62.7067, GNorm = 0.5737, lr_0 = 2.5535e-04
Validation rmse = 0.778533
Epoch 18
Loss = 1.2437e-03, PNorm = 62.7206, GNorm = 0.7465, lr_0 = 2.4709e-04
Loss = 1.4535e-03, PNorm = 62.7320, GNorm = 1.1682, lr_0 = 2.3910e-04
Loss = 1.2934e-03, PNorm = 62.7438, GNorm = 1.0054, lr_0 = 2.3136e-04
Validation rmse = 0.756192
Epoch 19
Loss = 1.3357e-03, PNorm = 62.7538, GNorm = 0.7116, lr_0 = 2.2387e-04
Loss = 1.4848e-03, PNorm = 62.7653, GNorm = 1.2973, lr_0 = 2.1663e-04
Validation rmse = 0.758489
Epoch 20
Loss = 8.9594e-04, PNorm = 62.7771, GNorm = 0.4136, lr_0 = 2.0962e-04
Loss = 1.3453e-03, PNorm = 62.7876, GNorm = 0.6477, lr_0 = 2.0283e-04
Loss = 1.2798e-03, PNorm = 62.7961, GNorm = 1.7873, lr_0 = 1.9627e-04
Validation rmse = 0.789163
Epoch 21
Loss = 1.1655e-03, PNorm = 62.8064, GNorm = 0.5151, lr_0 = 1.8992e-04
Loss = 1.4315e-03, PNorm = 62.8165, GNorm = 0.9409, lr_0 = 1.8377e-04
Validation rmse = 0.756364
Epoch 22
Loss = 1.0839e-03, PNorm = 62.8269, GNorm = 0.4892, lr_0 = 1.7783e-04
Loss = 1.2696e-03, PNorm = 62.8351, GNorm = 1.8948, lr_0 = 1.7207e-04
Loss = 1.3619e-03, PNorm = 62.8449, GNorm = 1.0345, lr_0 = 1.6651e-04
Validation rmse = 0.753998
Epoch 23
Loss = 1.1938e-03, PNorm = 62.8545, GNorm = 1.4339, lr_0 = 1.6059e-04
Loss = 1.0488e-03, PNorm = 62.8625, GNorm = 0.5523, lr_0 = 1.5539e-04
Validation rmse = 0.738612
Epoch 24
Loss = 8.8468e-04, PNorm = 62.8705, GNorm = 0.8133, lr_0 = 1.5036e-04
Loss = 1.3055e-03, PNorm = 62.8763, GNorm = 1.8680, lr_0 = 1.4550e-04
Loss = 1.2639e-03, PNorm = 62.8849, GNorm = 1.0031, lr_0 = 1.4079e-04
Validation rmse = 0.749958
Epoch 25
Loss = 1.1586e-03, PNorm = 62.8937, GNorm = 0.9790, lr_0 = 1.3623e-04
Loss = 1.1185e-03, PNorm = 62.9019, GNorm = 1.6405, lr_0 = 1.3183e-04
Loss = 1.1233e-03, PNorm = 62.9068, GNorm = 1.5253, lr_0 = 1.2756e-04
Validation rmse = 0.760442
Epoch 26
Loss = 1.1106e-03, PNorm = 62.9121, GNorm = 0.6611, lr_0 = 1.2343e-04
Loss = 1.2203e-03, PNorm = 62.9184, GNorm = 1.0475, lr_0 = 1.1944e-04
Validation rmse = 0.739590
Epoch 27
Loss = 1.0272e-03, PNorm = 62.9250, GNorm = 0.9104, lr_0 = 1.1557e-04
Loss = 1.0593e-03, PNorm = 62.9302, GNorm = 0.5483, lr_0 = 1.1183e-04
Loss = 1.1167e-03, PNorm = 62.9358, GNorm = 0.5481, lr_0 = 1.0821e-04
Validation rmse = 0.742857
Epoch 28
Loss = 8.5835e-04, PNorm = 62.9420, GNorm = 1.2272, lr_0 = 1.0437e-04
Loss = 1.1345e-03, PNorm = 62.9463, GNorm = 0.4522, lr_0 = 1.0099e-04
Validation rmse = 0.776976
Epoch 29
Loss = 1.5531e-03, PNorm = 62.9515, GNorm = 0.4350, lr_0 = 1.0000e-04
Loss = 9.6753e-04, PNorm = 62.9572, GNorm = 1.2562, lr_0 = 1.0000e-04
Loss = 9.1311e-04, PNorm = 62.9623, GNorm = 0.9069, lr_0 = 1.0000e-04
Validation rmse = 0.738619
Model 0 best validation rmse = 0.727606 on epoch 16
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.072794
Ensemble test rmse = 1.072794
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1700, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,401
Moving model to cuda
Epoch 0
Loss = 2.2173e-02, PNorm = 61.1217, GNorm = 7.4834, lr_0 = 2.9800e-04
Loss = 1.3736e-02, PNorm = 61.1658, GNorm = 1.9812, lr_0 = 4.7800e-04
Validation rmse = 1.545689
Epoch 1
Loss = 8.2003e-03, PNorm = 61.2408, GNorm = 3.5222, lr_0 = 6.7600e-04
Loss = 7.6689e-03, PNorm = 61.3193, GNorm = 1.4713, lr_0 = 8.5600e-04
Loss = 7.1268e-03, PNorm = 61.4010, GNorm = 1.1563, lr_0 = 9.9344e-04
Validation rmse = 1.599782
Epoch 2
Loss = 6.6551e-03, PNorm = 61.4801, GNorm = 2.0425, lr_0 = 9.6130e-04
Loss = 6.1823e-03, PNorm = 61.5607, GNorm = 5.9302, lr_0 = 9.3019e-04
Validation rmse = 1.229323
Epoch 3
Loss = 5.0892e-03, PNorm = 61.6343, GNorm = 3.4747, lr_0 = 9.0009e-04
Loss = 5.5220e-03, PNorm = 61.7017, GNorm = 1.9596, lr_0 = 8.7096e-04
Loss = 4.5680e-03, PNorm = 61.7599, GNorm = 2.2672, lr_0 = 8.4278e-04
Validation rmse = 1.039746
Epoch 4
Loss = 3.6298e-03, PNorm = 61.8154, GNorm = 5.2246, lr_0 = 8.1551e-04
Loss = 3.7777e-03, PNorm = 61.8638, GNorm = 2.6939, lr_0 = 7.8912e-04
Validation rmse = 1.151900
Epoch 5
Loss = 4.1710e-03, PNorm = 61.9078, GNorm = 2.2931, lr_0 = 7.6358e-04
Loss = 3.6410e-03, PNorm = 61.9537, GNorm = 4.7954, lr_0 = 7.3888e-04
Loss = 4.3847e-03, PNorm = 62.0000, GNorm = 4.6769, lr_0 = 7.1497e-04
Validation rmse = 0.985301
Epoch 6
Loss = 2.8459e-03, PNorm = 62.0524, GNorm = 2.8205, lr_0 = 6.8956e-04
Loss = 3.0139e-03, PNorm = 62.0902, GNorm = 1.5513, lr_0 = 6.6725e-04
Loss = 2.6511e-03, PNorm = 62.1223, GNorm = 3.4461, lr_0 = 6.4565e-04
Validation rmse = 0.964784
Epoch 7
Loss = 2.4945e-03, PNorm = 62.1555, GNorm = 1.6477, lr_0 = 6.2476e-04
Loss = 2.7851e-03, PNorm = 62.1887, GNorm = 2.3871, lr_0 = 6.0454e-04
Validation rmse = 1.183299
Epoch 8
Loss = 2.5119e-03, PNorm = 62.2224, GNorm = 0.5391, lr_0 = 5.8498e-04
Loss = 2.4434e-03, PNorm = 62.2567, GNorm = 2.3853, lr_0 = 5.6605e-04
Loss = 2.0995e-03, PNorm = 62.2859, GNorm = 0.6252, lr_0 = 5.4774e-04
Validation rmse = 0.947850
Epoch 9
Loss = 2.1027e-03, PNorm = 62.3106, GNorm = 2.5766, lr_0 = 5.3001e-04
Loss = 2.4027e-03, PNorm = 62.3421, GNorm = 0.7948, lr_0 = 5.1286e-04
Validation rmse = 0.927084
Epoch 10
Loss = 1.6798e-03, PNorm = 62.3692, GNorm = 0.5367, lr_0 = 4.9627e-04
Loss = 1.7212e-03, PNorm = 62.3931, GNorm = 0.7826, lr_0 = 4.8021e-04
Loss = 2.4185e-03, PNorm = 62.4192, GNorm = 2.2103, lr_0 = 4.6467e-04
Validation rmse = 0.991815
Epoch 11
Loss = 1.9392e-03, PNorm = 62.4442, GNorm = 0.9207, lr_0 = 4.4963e-04
Loss = 2.1374e-03, PNorm = 62.4728, GNorm = 0.8561, lr_0 = 4.3508e-04
Validation rmse = 0.952582
Epoch 12
Loss = 2.2085e-03, PNorm = 62.4971, GNorm = 0.8328, lr_0 = 4.1962e-04
Loss = 2.2922e-03, PNorm = 62.5185, GNorm = 0.4980, lr_0 = 4.0604e-04
Loss = 1.9420e-03, PNorm = 62.5417, GNorm = 1.3975, lr_0 = 3.9290e-04
Validation rmse = 1.135476
Epoch 13
Loss = 2.2797e-03, PNorm = 62.5708, GNorm = 5.8599, lr_0 = 3.8019e-04
Loss = 1.7780e-03, PNorm = 62.5928, GNorm = 1.5250, lr_0 = 3.6789e-04
Loss = 2.2033e-03, PNorm = 62.6173, GNorm = 2.7112, lr_0 = 3.5598e-04
Validation rmse = 0.899081
Epoch 14
Loss = 2.2675e-03, PNorm = 62.6406, GNorm = 0.8671, lr_0 = 3.4446e-04
Loss = 1.7021e-03, PNorm = 62.6617, GNorm = 0.6873, lr_0 = 3.3332e-04
Validation rmse = 0.935228
Epoch 15
Loss = 1.7760e-03, PNorm = 62.6790, GNorm = 0.9661, lr_0 = 3.2253e-04
Loss = 1.3662e-03, PNorm = 62.6928, GNorm = 0.7431, lr_0 = 3.1209e-04
Loss = 1.4184e-03, PNorm = 62.7087, GNorm = 0.6972, lr_0 = 3.0200e-04
Validation rmse = 0.870921
Epoch 16
Loss = 1.7091e-03, PNorm = 62.7246, GNorm = 0.5642, lr_0 = 2.9222e-04
Loss = 1.3714e-03, PNorm = 62.7409, GNorm = 0.7593, lr_0 = 2.8277e-04
Validation rmse = 0.918614
Epoch 17
Loss = 1.8279e-03, PNorm = 62.7584, GNorm = 1.5606, lr_0 = 2.7272e-04
Loss = 1.5136e-03, PNorm = 62.7727, GNorm = 0.9833, lr_0 = 2.6389e-04
Loss = 1.4085e-03, PNorm = 62.7874, GNorm = 1.1244, lr_0 = 2.5535e-04
Validation rmse = 0.857165
Epoch 18
Loss = 1.5258e-03, PNorm = 62.7992, GNorm = 1.8805, lr_0 = 2.4709e-04
Loss = 1.4858e-03, PNorm = 62.8132, GNorm = 0.5440, lr_0 = 2.3910e-04
Loss = 1.4622e-03, PNorm = 62.8264, GNorm = 0.6701, lr_0 = 2.3136e-04
Validation rmse = 0.938189
Epoch 19
Loss = 1.4948e-03, PNorm = 62.8398, GNorm = 1.1685, lr_0 = 2.2387e-04
Loss = 1.3908e-03, PNorm = 62.8523, GNorm = 0.5323, lr_0 = 2.1663e-04
Validation rmse = 0.952075
Epoch 20
Loss = 1.1715e-03, PNorm = 62.8617, GNorm = 0.7105, lr_0 = 2.0962e-04
Loss = 1.4446e-03, PNorm = 62.8727, GNorm = 2.0803, lr_0 = 2.0283e-04
Loss = 1.3093e-03, PNorm = 62.8818, GNorm = 1.1170, lr_0 = 1.9627e-04
Validation rmse = 0.923111
Epoch 21
Loss = 1.2336e-03, PNorm = 62.8905, GNorm = 0.9443, lr_0 = 1.8992e-04
Loss = 1.1705e-03, PNorm = 62.8991, GNorm = 0.8351, lr_0 = 1.8377e-04
Validation rmse = 0.886367
Epoch 22
Loss = 1.2124e-03, PNorm = 62.9083, GNorm = 0.5945, lr_0 = 1.7783e-04
Loss = 9.3656e-04, PNorm = 62.9170, GNorm = 0.9892, lr_0 = 1.7207e-04
Loss = 1.3769e-03, PNorm = 62.9255, GNorm = 1.4286, lr_0 = 1.6651e-04
Validation rmse = 0.910436
Epoch 23
Loss = 1.0852e-03, PNorm = 62.9357, GNorm = 0.8053, lr_0 = 1.6059e-04
Loss = 1.0535e-03, PNorm = 62.9445, GNorm = 0.5655, lr_0 = 1.5539e-04
Validation rmse = 0.852992
Epoch 24
Loss = 1.1463e-03, PNorm = 62.9520, GNorm = 1.5838, lr_0 = 1.5036e-04
Loss = 1.2986e-03, PNorm = 62.9621, GNorm = 0.9592, lr_0 = 1.4550e-04
Loss = 1.0967e-03, PNorm = 62.9689, GNorm = 0.6067, lr_0 = 1.4079e-04
Validation rmse = 0.866877
Epoch 25
Loss = 1.1194e-03, PNorm = 62.9741, GNorm = 0.6910, lr_0 = 1.3623e-04
Loss = 1.1196e-03, PNorm = 62.9795, GNorm = 0.5263, lr_0 = 1.3183e-04
Loss = 1.0637e-03, PNorm = 62.9856, GNorm = 0.7530, lr_0 = 1.2756e-04
Validation rmse = 0.880341
Epoch 26
Loss = 1.1564e-03, PNorm = 62.9925, GNorm = 2.6435, lr_0 = 1.2343e-04
Loss = 1.0863e-03, PNorm = 62.9982, GNorm = 1.1463, lr_0 = 1.1944e-04
Validation rmse = 0.933446
Epoch 27
Loss = 1.0114e-03, PNorm = 63.0003, GNorm = 0.8840, lr_0 = 1.1557e-04
Loss = 1.1631e-03, PNorm = 63.0066, GNorm = 0.8019, lr_0 = 1.1183e-04
Loss = 1.1535e-03, PNorm = 63.0108, GNorm = 2.2505, lr_0 = 1.0821e-04
Validation rmse = 0.838462
Epoch 28
Loss = 1.1755e-03, PNorm = 63.0170, GNorm = 2.0918, lr_0 = 1.0437e-04
Loss = 1.0062e-03, PNorm = 63.0220, GNorm = 1.2430, lr_0 = 1.0099e-04
Validation rmse = 0.843994
Epoch 29
Loss = 6.5876e-04, PNorm = 63.0271, GNorm = 1.2161, lr_0 = 1.0000e-04
Loss = 1.1214e-03, PNorm = 63.0326, GNorm = 0.8979, lr_0 = 1.0000e-04
Loss = 1.0950e-03, PNorm = 63.0383, GNorm = 0.6809, lr_0 = 1.0000e-04
Validation rmse = 0.840925
Model 0 best validation rmse = 0.838462 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.671765
Ensemble test rmse = 0.671765
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1700, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,401
Moving model to cuda
Epoch 0
Loss = 2.2208e-02, PNorm = 61.1214, GNorm = 3.3657, lr_0 = 2.9800e-04
Loss = 1.1709e-02, PNorm = 61.1660, GNorm = 8.0645, lr_0 = 4.7800e-04
Validation rmse = 1.621136
Epoch 1
Loss = 9.0752e-03, PNorm = 61.2316, GNorm = 5.9107, lr_0 = 6.7600e-04
Loss = 9.6479e-03, PNorm = 61.3047, GNorm = 1.2144, lr_0 = 8.5600e-04
Loss = 8.5044e-03, PNorm = 61.3862, GNorm = 4.1926, lr_0 = 9.9344e-04
Validation rmse = 1.902529
Epoch 2
Loss = 7.1424e-03, PNorm = 61.4724, GNorm = 2.1408, lr_0 = 9.6130e-04
Loss = 6.5287e-03, PNorm = 61.5274, GNorm = 3.1444, lr_0 = 9.3019e-04
Validation rmse = 1.335872
Epoch 3
Loss = 5.9595e-03, PNorm = 61.5866, GNorm = 3.7877, lr_0 = 9.0009e-04
Loss = 4.6949e-03, PNorm = 61.6378, GNorm = 1.8398, lr_0 = 8.7096e-04
Loss = 3.8482e-03, PNorm = 61.6902, GNorm = 1.3813, lr_0 = 8.4278e-04
Validation rmse = 1.234435
Epoch 4
Loss = 3.6526e-03, PNorm = 61.7383, GNorm = 1.3664, lr_0 = 8.1551e-04
Loss = 4.6853e-03, PNorm = 61.7850, GNorm = 2.9842, lr_0 = 7.8912e-04
Validation rmse = 1.095539
Epoch 5
Loss = 2.2729e-03, PNorm = 61.8352, GNorm = 2.6773, lr_0 = 7.6358e-04
Loss = 3.5290e-03, PNorm = 61.8769, GNorm = 1.0655, lr_0 = 7.3888e-04
Loss = 4.1711e-03, PNorm = 61.9202, GNorm = 1.5380, lr_0 = 7.1497e-04
Validation rmse = 1.214711
Epoch 6
Loss = 3.7019e-03, PNorm = 61.9723, GNorm = 1.7118, lr_0 = 6.8956e-04
Loss = 3.5355e-03, PNorm = 62.0109, GNorm = 5.3670, lr_0 = 6.6725e-04
Loss = 3.6997e-03, PNorm = 62.0503, GNorm = 1.2904, lr_0 = 6.4565e-04
Validation rmse = 1.249525
Epoch 7
Loss = 3.5743e-03, PNorm = 62.0887, GNorm = 3.4154, lr_0 = 6.2476e-04
Loss = 2.6067e-03, PNorm = 62.1222, GNorm = 2.8970, lr_0 = 6.0454e-04
Validation rmse = 1.058447
Epoch 8
Loss = 2.8106e-03, PNorm = 62.1499, GNorm = 2.6765, lr_0 = 5.8498e-04
Loss = 2.3132e-03, PNorm = 62.1832, GNorm = 0.9776, lr_0 = 5.6605e-04
Loss = 2.9764e-03, PNorm = 62.2094, GNorm = 0.8924, lr_0 = 5.4774e-04
Validation rmse = 1.117786
Epoch 9
Loss = 3.5246e-03, PNorm = 62.2416, GNorm = 6.1714, lr_0 = 5.3001e-04
Loss = 2.9099e-03, PNorm = 62.2831, GNorm = 1.1601, lr_0 = 5.1286e-04
Validation rmse = 1.033186
Epoch 10
Loss = 2.5104e-03, PNorm = 62.3202, GNorm = 1.7422, lr_0 = 4.9627e-04
Loss = 2.6179e-03, PNorm = 62.3519, GNorm = 2.3080, lr_0 = 4.8021e-04
Loss = 1.8569e-03, PNorm = 62.3800, GNorm = 1.7032, lr_0 = 4.6467e-04
Validation rmse = 1.021537
Epoch 11
Loss = 2.2936e-03, PNorm = 62.4034, GNorm = 2.2714, lr_0 = 4.4963e-04
Loss = 1.8133e-03, PNorm = 62.4195, GNorm = 0.8217, lr_0 = 4.3508e-04
Validation rmse = 1.007815
Epoch 12
Loss = 1.3618e-03, PNorm = 62.4440, GNorm = 0.5015, lr_0 = 4.1962e-04
Loss = 1.6893e-03, PNorm = 62.4640, GNorm = 1.9651, lr_0 = 4.0604e-04
Loss = 1.8713e-03, PNorm = 62.4799, GNorm = 0.7923, lr_0 = 3.9290e-04
Validation rmse = 1.016699
Epoch 13
Loss = 1.9112e-03, PNorm = 62.5010, GNorm = 2.4233, lr_0 = 3.8019e-04
Loss = 1.8662e-03, PNorm = 62.5135, GNorm = 1.7544, lr_0 = 3.6789e-04
Loss = 1.8294e-03, PNorm = 62.5328, GNorm = 0.4805, lr_0 = 3.5598e-04
Validation rmse = 1.012330
Epoch 14
Loss = 1.7177e-03, PNorm = 62.5521, GNorm = 0.9569, lr_0 = 3.4446e-04
Loss = 1.3749e-03, PNorm = 62.5665, GNorm = 0.5455, lr_0 = 3.3332e-04
Validation rmse = 0.989157
Epoch 15
Loss = 1.0060e-03, PNorm = 62.5830, GNorm = 0.6961, lr_0 = 3.2253e-04
Loss = 1.6959e-03, PNorm = 62.5968, GNorm = 0.7121, lr_0 = 3.1209e-04
Loss = 1.5697e-03, PNorm = 62.6110, GNorm = 1.8965, lr_0 = 3.0200e-04
Validation rmse = 1.020197
Epoch 16
Loss = 1.3267e-03, PNorm = 62.6236, GNorm = 2.1259, lr_0 = 2.9222e-04
Loss = 1.5325e-03, PNorm = 62.6363, GNorm = 1.1702, lr_0 = 2.8277e-04
Validation rmse = 0.988491
Epoch 17
Loss = 1.5166e-03, PNorm = 62.6509, GNorm = 2.0788, lr_0 = 2.7272e-04
Loss = 1.3372e-03, PNorm = 62.6631, GNorm = 1.2374, lr_0 = 2.6389e-04
Loss = 1.4133e-03, PNorm = 62.6763, GNorm = 0.6361, lr_0 = 2.5535e-04
Validation rmse = 1.021532
Epoch 18
Loss = 1.7669e-03, PNorm = 62.6864, GNorm = 2.1199, lr_0 = 2.4709e-04
Loss = 1.2951e-03, PNorm = 62.6993, GNorm = 1.7595, lr_0 = 2.3910e-04
Loss = 1.3633e-03, PNorm = 62.7104, GNorm = 0.9939, lr_0 = 2.3136e-04
Validation rmse = 0.990758
Epoch 19
Loss = 1.3934e-03, PNorm = 62.7211, GNorm = 0.5695, lr_0 = 2.2387e-04
Loss = 1.2383e-03, PNorm = 62.7322, GNorm = 0.8404, lr_0 = 2.1663e-04
Validation rmse = 0.979323
Epoch 20
Loss = 1.2296e-03, PNorm = 62.7426, GNorm = 0.3400, lr_0 = 2.0962e-04
Loss = 1.3233e-03, PNorm = 62.7529, GNorm = 0.5886, lr_0 = 2.0283e-04
Loss = 1.3382e-03, PNorm = 62.7638, GNorm = 0.9129, lr_0 = 1.9627e-04
Validation rmse = 0.975994
Epoch 21
Loss = 1.1966e-03, PNorm = 62.7725, GNorm = 1.2283, lr_0 = 1.8992e-04
Loss = 1.2374e-03, PNorm = 62.7804, GNorm = 1.1560, lr_0 = 1.8377e-04
Validation rmse = 0.961822
Epoch 22
Loss = 1.0089e-03, PNorm = 62.7878, GNorm = 0.8424, lr_0 = 1.7783e-04
Loss = 1.2872e-03, PNorm = 62.7960, GNorm = 1.4099, lr_0 = 1.7207e-04
Loss = 1.2644e-03, PNorm = 62.8034, GNorm = 1.6102, lr_0 = 1.6651e-04
Validation rmse = 0.990320
Epoch 23
Loss = 1.2119e-03, PNorm = 62.8126, GNorm = 2.6144, lr_0 = 1.6059e-04
Loss = 1.4049e-03, PNorm = 62.8198, GNorm = 0.7948, lr_0 = 1.5539e-04
Validation rmse = 0.975676
Epoch 24
Loss = 9.3198e-04, PNorm = 62.8282, GNorm = 1.0295, lr_0 = 1.5036e-04
Loss = 1.1620e-03, PNorm = 62.8350, GNorm = 1.1630, lr_0 = 1.4550e-04
Loss = 1.2343e-03, PNorm = 62.8425, GNorm = 0.7662, lr_0 = 1.4079e-04
Validation rmse = 0.973459
Epoch 25
Loss = 1.1954e-03, PNorm = 62.8492, GNorm = 0.9189, lr_0 = 1.3623e-04
Loss = 9.3816e-04, PNorm = 62.8562, GNorm = 0.7282, lr_0 = 1.3183e-04
Loss = 1.2152e-03, PNorm = 62.8620, GNorm = 0.4489, lr_0 = 1.2756e-04
Validation rmse = 0.966307
Epoch 26
Loss = 1.0314e-03, PNorm = 62.8681, GNorm = 0.7636, lr_0 = 1.2343e-04
Loss = 1.0273e-03, PNorm = 62.8743, GNorm = 0.4523, lr_0 = 1.1944e-04
Validation rmse = 0.967701
Epoch 27
Loss = 1.0594e-03, PNorm = 62.8804, GNorm = 0.8339, lr_0 = 1.1557e-04
Loss = 9.9303e-04, PNorm = 62.8863, GNorm = 0.4808, lr_0 = 1.1183e-04
Loss = 1.0797e-03, PNorm = 62.8923, GNorm = 0.6109, lr_0 = 1.0821e-04
Validation rmse = 0.983652
Epoch 28
Loss = 1.0575e-03, PNorm = 62.8973, GNorm = 0.5228, lr_0 = 1.0437e-04
Loss = 1.0073e-03, PNorm = 62.9023, GNorm = 1.7640, lr_0 = 1.0099e-04
Validation rmse = 0.971058
Epoch 29
Loss = 8.5440e-04, PNorm = 62.9067, GNorm = 0.7026, lr_0 = 1.0000e-04
Loss = 9.3344e-04, PNorm = 62.9120, GNorm = 0.8283, lr_0 = 1.0000e-04
Loss = 1.1768e-03, PNorm = 62.9170, GNorm = 0.4499, lr_0 = 1.0000e-04
Validation rmse = 0.973887
Model 0 best validation rmse = 0.961822 on epoch 21
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.767829
Ensemble test rmse = 0.767829
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1700, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,401
Moving model to cuda
Epoch 0
Loss = 1.6003e-02, PNorm = 61.1243, GNorm = 3.5409, lr_0 = 2.9800e-04
Loss = 1.3542e-02, PNorm = 61.1678, GNorm = 13.8457, lr_0 = 4.7800e-04
Validation rmse = 1.560904
Epoch 1
Loss = 9.1279e-03, PNorm = 61.2468, GNorm = 9.4762, lr_0 = 6.7600e-04
Loss = 9.0184e-03, PNorm = 61.3377, GNorm = 4.1446, lr_0 = 8.5600e-04
Loss = 7.1344e-03, PNorm = 61.4303, GNorm = 6.0530, lr_0 = 9.9344e-04
Validation rmse = 1.307266
Epoch 2
Loss = 6.2998e-03, PNorm = 61.5134, GNorm = 2.5349, lr_0 = 9.6130e-04
Loss = 5.9360e-03, PNorm = 61.5945, GNorm = 5.8972, lr_0 = 9.3019e-04
Validation rmse = 1.321297
Epoch 3
Loss = 5.8438e-03, PNorm = 61.6780, GNorm = 0.7590, lr_0 = 9.0009e-04
Loss = 4.6324e-03, PNorm = 61.7473, GNorm = 2.0028, lr_0 = 8.7096e-04
Loss = 5.0976e-03, PNorm = 61.8129, GNorm = 2.3964, lr_0 = 8.4278e-04
Validation rmse = 0.907836
Epoch 4
Loss = 3.6589e-03, PNorm = 61.8776, GNorm = 2.0327, lr_0 = 8.1551e-04
Loss = 4.0077e-03, PNorm = 61.9332, GNorm = 2.9144, lr_0 = 7.8912e-04
Validation rmse = 1.004856
Epoch 5
Loss = 4.3268e-03, PNorm = 61.9882, GNorm = 2.9567, lr_0 = 7.6358e-04
Loss = 3.6924e-03, PNorm = 62.0476, GNorm = 1.5417, lr_0 = 7.3888e-04
Loss = 3.9205e-03, PNorm = 62.0965, GNorm = 1.1839, lr_0 = 7.1497e-04
Validation rmse = 0.911695
Epoch 6
Loss = 3.7990e-03, PNorm = 62.1479, GNorm = 5.3434, lr_0 = 6.8956e-04
Loss = 3.2467e-03, PNorm = 62.1879, GNorm = 0.6370, lr_0 = 6.6725e-04
Loss = 2.9561e-03, PNorm = 62.2269, GNorm = 2.6843, lr_0 = 6.4565e-04
Validation rmse = 0.843256
Epoch 7
Loss = 2.7897e-03, PNorm = 62.2700, GNorm = 1.0742, lr_0 = 6.2476e-04
Loss = 2.7910e-03, PNorm = 62.3031, GNorm = 1.5897, lr_0 = 6.0454e-04
Validation rmse = 0.854996
Epoch 8
Loss = 1.8717e-03, PNorm = 62.3319, GNorm = 1.1923, lr_0 = 5.8498e-04
Loss = 2.5258e-03, PNorm = 62.3656, GNorm = 2.1819, lr_0 = 5.6605e-04
Loss = 2.3447e-03, PNorm = 62.4004, GNorm = 1.3815, lr_0 = 5.4774e-04
Validation rmse = 0.844299
Epoch 9
Loss = 2.2296e-03, PNorm = 62.4321, GNorm = 2.9406, lr_0 = 5.3001e-04
Loss = 3.0551e-03, PNorm = 62.4684, GNorm = 2.7351, lr_0 = 5.1286e-04
Validation rmse = 0.858680
Epoch 10
Loss = 2.2157e-03, PNorm = 62.5018, GNorm = 0.9514, lr_0 = 4.9627e-04
Loss = 1.8617e-03, PNorm = 62.5354, GNorm = 0.7665, lr_0 = 4.8021e-04
Loss = 2.1905e-03, PNorm = 62.5619, GNorm = 2.3959, lr_0 = 4.6467e-04
Validation rmse = 0.911572
Epoch 11
Loss = 2.4446e-03, PNorm = 62.5891, GNorm = 2.4853, lr_0 = 4.4963e-04
Loss = 1.8740e-03, PNorm = 62.6135, GNorm = 1.0192, lr_0 = 4.3508e-04
Validation rmse = 0.772196
Epoch 12
Loss = 1.9681e-03, PNorm = 62.6361, GNorm = 0.8132, lr_0 = 4.1962e-04
Loss = 1.8209e-03, PNorm = 62.6586, GNorm = 1.4642, lr_0 = 4.0604e-04
Loss = 1.8350e-03, PNorm = 62.6750, GNorm = 1.6715, lr_0 = 3.9290e-04
Validation rmse = 0.875990
Epoch 13
Loss = 1.6956e-03, PNorm = 62.6911, GNorm = 0.9664, lr_0 = 3.8019e-04
Loss = 1.6566e-03, PNorm = 62.7112, GNorm = 1.3864, lr_0 = 3.6789e-04
Loss = 1.8612e-03, PNorm = 62.7307, GNorm = 1.5026, lr_0 = 3.5598e-04
Validation rmse = 0.770801
Epoch 14
Loss = 1.4618e-03, PNorm = 62.7523, GNorm = 0.7456, lr_0 = 3.4446e-04
Loss = 1.6541e-03, PNorm = 62.7724, GNorm = 1.3702, lr_0 = 3.3332e-04
Validation rmse = 0.815567
Epoch 15
Loss = 8.7589e-04, PNorm = 62.7898, GNorm = 0.6812, lr_0 = 3.2253e-04
Loss = 1.8268e-03, PNorm = 62.8088, GNorm = 0.4361, lr_0 = 3.1209e-04
Loss = 1.5034e-03, PNorm = 62.8250, GNorm = 0.6132, lr_0 = 3.0200e-04
Validation rmse = 0.783030
Epoch 16
Loss = 1.3537e-03, PNorm = 62.8435, GNorm = 0.9455, lr_0 = 2.9222e-04
Loss = 1.5095e-03, PNorm = 62.8573, GNorm = 2.1436, lr_0 = 2.8277e-04
Validation rmse = 0.771526
Epoch 17
Loss = 9.0331e-04, PNorm = 62.8710, GNorm = 0.6112, lr_0 = 2.7272e-04
Loss = 1.3244e-03, PNorm = 62.8832, GNorm = 0.5135, lr_0 = 2.6389e-04
Loss = 1.7427e-03, PNorm = 62.8990, GNorm = 2.4428, lr_0 = 2.5535e-04
Validation rmse = 0.762984
Epoch 18
Loss = 1.2383e-03, PNorm = 62.9128, GNorm = 1.3103, lr_0 = 2.4709e-04
Loss = 1.2586e-03, PNorm = 62.9243, GNorm = 1.0776, lr_0 = 2.3910e-04
Loss = 1.5196e-03, PNorm = 62.9348, GNorm = 2.0934, lr_0 = 2.3136e-04
Validation rmse = 0.764341
Epoch 19
Loss = 1.3045e-03, PNorm = 62.9468, GNorm = 0.8610, lr_0 = 2.2387e-04
Loss = 1.2747e-03, PNorm = 62.9584, GNorm = 0.5353, lr_0 = 2.1663e-04
Validation rmse = 0.753682
Epoch 20
Loss = 1.4802e-03, PNorm = 62.9688, GNorm = 0.6503, lr_0 = 2.0962e-04
Loss = 1.1890e-03, PNorm = 62.9778, GNorm = 1.6789, lr_0 = 2.0283e-04
Loss = 1.2171e-03, PNorm = 62.9874, GNorm = 0.6335, lr_0 = 1.9627e-04
Validation rmse = 0.765981
Epoch 21
Loss = 1.2309e-03, PNorm = 62.9981, GNorm = 1.3302, lr_0 = 1.8992e-04
Loss = 1.1987e-03, PNorm = 63.0066, GNorm = 1.1882, lr_0 = 1.8377e-04
Validation rmse = 0.762919
Epoch 22
Loss = 1.1137e-03, PNorm = 63.0141, GNorm = 0.7109, lr_0 = 1.7783e-04
Loss = 1.1498e-03, PNorm = 63.0213, GNorm = 0.8923, lr_0 = 1.7207e-04
Loss = 1.1926e-03, PNorm = 63.0284, GNorm = 0.7724, lr_0 = 1.6651e-04
Validation rmse = 0.776345
Epoch 23
Loss = 1.0662e-03, PNorm = 63.0374, GNorm = 0.8801, lr_0 = 1.6059e-04
Loss = 1.1707e-03, PNorm = 63.0456, GNorm = 0.8864, lr_0 = 1.5539e-04
Validation rmse = 0.828086
Epoch 24
Loss = 6.3760e-04, PNorm = 63.0531, GNorm = 0.4240, lr_0 = 1.5036e-04
Loss = 1.1754e-03, PNorm = 63.0615, GNorm = 0.6382, lr_0 = 1.4550e-04
Loss = 1.1682e-03, PNorm = 63.0689, GNorm = 0.5318, lr_0 = 1.4079e-04
Validation rmse = 0.772971
Epoch 25
Loss = 8.8239e-04, PNorm = 63.0743, GNorm = 0.5435, lr_0 = 1.3623e-04
Loss = 1.0306e-03, PNorm = 63.0807, GNorm = 0.5508, lr_0 = 1.3183e-04
Loss = 1.1780e-03, PNorm = 63.0873, GNorm = 0.5779, lr_0 = 1.2756e-04
Validation rmse = 0.783505
Epoch 26
Loss = 9.1535e-04, PNorm = 63.0924, GNorm = 0.6482, lr_0 = 1.2343e-04
Loss = 9.4807e-04, PNorm = 63.0989, GNorm = 0.5214, lr_0 = 1.1944e-04
Validation rmse = 0.757376
Epoch 27
Loss = 9.3532e-04, PNorm = 63.1032, GNorm = 0.5510, lr_0 = 1.1557e-04
Loss = 1.0660e-03, PNorm = 63.1084, GNorm = 0.6864, lr_0 = 1.1183e-04
Loss = 1.0635e-03, PNorm = 63.1131, GNorm = 0.6444, lr_0 = 1.0821e-04
Validation rmse = 0.764419
Epoch 28
Loss = 1.0020e-03, PNorm = 63.1178, GNorm = 1.2029, lr_0 = 1.0437e-04
Loss = 8.6589e-04, PNorm = 63.1225, GNorm = 0.4729, lr_0 = 1.0099e-04
Validation rmse = 0.761189
Epoch 29
Loss = 6.5692e-04, PNorm = 63.1266, GNorm = 0.4487, lr_0 = 1.0000e-04
Loss = 9.8979e-04, PNorm = 63.1317, GNorm = 1.5249, lr_0 = 1.0000e-04
Loss = 1.0052e-03, PNorm = 63.1371, GNorm = 0.8035, lr_0 = 1.0000e-04
Validation rmse = 0.775094
Model 0 best validation rmse = 0.753682 on epoch 19
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.677775
Ensemble test rmse = 0.677775
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1700, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,401
Moving model to cuda
Epoch 0
Loss = 2.5615e-02, PNorm = 61.1231, GNorm = 10.9648, lr_0 = 2.9800e-04
Loss = 1.5826e-02, PNorm = 61.1684, GNorm = 5.7250, lr_0 = 4.7800e-04
Validation rmse = 1.669444
Epoch 1
Loss = 1.0625e-02, PNorm = 61.2477, GNorm = 3.2939, lr_0 = 6.7600e-04
Loss = 6.6573e-03, PNorm = 61.3242, GNorm = 2.5040, lr_0 = 8.5600e-04
Loss = 6.3533e-03, PNorm = 61.3913, GNorm = 2.0459, lr_0 = 9.9344e-04
Validation rmse = 1.404154
Epoch 2
Loss = 6.4650e-03, PNorm = 61.4653, GNorm = 4.3836, lr_0 = 9.6130e-04
Loss = 7.0894e-03, PNorm = 61.5349, GNorm = 7.4313, lr_0 = 9.3019e-04
Validation rmse = 1.392604
Epoch 3
Loss = 8.5343e-03, PNorm = 61.6076, GNorm = 5.4103, lr_0 = 9.0009e-04
Loss = 6.7224e-03, PNorm = 61.6757, GNorm = 2.5696, lr_0 = 8.7096e-04
Loss = 5.5681e-03, PNorm = 61.7273, GNorm = 0.6686, lr_0 = 8.4278e-04
Validation rmse = 1.209418
Epoch 4
Loss = 4.2847e-03, PNorm = 61.7733, GNorm = 2.8340, lr_0 = 8.1551e-04
Loss = 4.4212e-03, PNorm = 61.8183, GNorm = 2.2803, lr_0 = 7.8912e-04
Validation rmse = 1.221626
Epoch 5
Loss = 2.4340e-03, PNorm = 61.8580, GNorm = 1.7993, lr_0 = 7.6358e-04
Loss = 3.1881e-03, PNorm = 61.8957, GNorm = 2.7773, lr_0 = 7.3888e-04
Loss = 3.6871e-03, PNorm = 61.9296, GNorm = 0.8775, lr_0 = 7.1497e-04
Validation rmse = 1.132087
Epoch 6
Loss = 3.4192e-03, PNorm = 61.9718, GNorm = 2.9620, lr_0 = 6.8956e-04
Loss = 3.4684e-03, PNorm = 62.0136, GNorm = 1.6152, lr_0 = 6.6725e-04
Loss = 2.8805e-03, PNorm = 62.0439, GNorm = 0.9909, lr_0 = 6.4565e-04
Validation rmse = 0.962099
Epoch 7
Loss = 2.6858e-03, PNorm = 62.0759, GNorm = 0.8684, lr_0 = 6.2476e-04
Loss = 2.5126e-03, PNorm = 62.1075, GNorm = 2.0295, lr_0 = 6.0454e-04
Validation rmse = 0.987453
Epoch 8
Loss = 2.7416e-03, PNorm = 62.1334, GNorm = 1.8075, lr_0 = 5.8498e-04
Loss = 2.9369e-03, PNorm = 62.1669, GNorm = 1.3368, lr_0 = 5.6605e-04
Loss = 2.3130e-03, PNorm = 62.1998, GNorm = 1.4926, lr_0 = 5.4774e-04
Validation rmse = 1.073779
Epoch 9
Loss = 2.2746e-03, PNorm = 62.2256, GNorm = 0.7772, lr_0 = 5.3001e-04
Loss = 2.4016e-03, PNorm = 62.2534, GNorm = 1.6628, lr_0 = 5.1286e-04
Validation rmse = 1.060247
Epoch 10
Loss = 3.2188e-03, PNorm = 62.2778, GNorm = 1.8377, lr_0 = 4.9627e-04
Loss = 3.0423e-03, PNorm = 62.3045, GNorm = 1.0214, lr_0 = 4.8021e-04
Loss = 2.2588e-03, PNorm = 62.3271, GNorm = 1.0678, lr_0 = 4.6467e-04
Validation rmse = 0.947021
Epoch 11
Loss = 1.8942e-03, PNorm = 62.3522, GNorm = 1.3367, lr_0 = 4.4963e-04
Loss = 1.8452e-03, PNorm = 62.3741, GNorm = 1.4372, lr_0 = 4.3508e-04
Validation rmse = 0.922249
Epoch 12
Loss = 1.4240e-03, PNorm = 62.3913, GNorm = 1.3297, lr_0 = 4.1962e-04
Loss = 2.2783e-03, PNorm = 62.4056, GNorm = 3.0000, lr_0 = 4.0604e-04
Loss = 2.3448e-03, PNorm = 62.4285, GNorm = 2.7066, lr_0 = 3.9290e-04
Validation rmse = 1.009903
Epoch 13
Loss = 2.0954e-03, PNorm = 62.4485, GNorm = 1.1604, lr_0 = 3.8019e-04
Loss = 2.1127e-03, PNorm = 62.4677, GNorm = 1.7855, lr_0 = 3.6789e-04
Loss = 2.0992e-03, PNorm = 62.4876, GNorm = 1.6002, lr_0 = 3.5598e-04
Validation rmse = 0.916643
Epoch 14
Loss = 1.4408e-03, PNorm = 62.5034, GNorm = 0.7094, lr_0 = 3.4446e-04
Loss = 1.8802e-03, PNorm = 62.5201, GNorm = 1.8037, lr_0 = 3.3332e-04
Validation rmse = 0.935980
Epoch 15
Loss = 2.0828e-03, PNorm = 62.5348, GNorm = 1.5060, lr_0 = 3.2253e-04
Loss = 1.7389e-03, PNorm = 62.5509, GNorm = 0.7505, lr_0 = 3.1209e-04
Loss = 1.7662e-03, PNorm = 62.5657, GNorm = 0.6899, lr_0 = 3.0200e-04
Validation rmse = 0.953905
Epoch 16
Loss = 1.5821e-03, PNorm = 62.5767, GNorm = 0.7313, lr_0 = 2.9222e-04
Loss = 1.7419e-03, PNorm = 62.5888, GNorm = 0.6441, lr_0 = 2.8277e-04
Validation rmse = 0.946909
Epoch 17
Loss = 1.3900e-03, PNorm = 62.6007, GNorm = 1.8848, lr_0 = 2.7272e-04
Loss = 1.8128e-03, PNorm = 62.6172, GNorm = 0.7950, lr_0 = 2.6389e-04
Loss = 1.5792e-03, PNorm = 62.6289, GNorm = 1.6071, lr_0 = 2.5535e-04
Validation rmse = 0.928736
Epoch 18
Loss = 1.6024e-03, PNorm = 62.6395, GNorm = 0.6565, lr_0 = 2.4709e-04
Loss = 1.5815e-03, PNorm = 62.6478, GNorm = 1.4179, lr_0 = 2.3910e-04
Loss = 1.6677e-03, PNorm = 62.6597, GNorm = 0.5507, lr_0 = 2.3136e-04
Validation rmse = 0.936010
Epoch 19
Loss = 1.3829e-03, PNorm = 62.6706, GNorm = 1.4342, lr_0 = 2.2387e-04
Loss = 1.4763e-03, PNorm = 62.6786, GNorm = 0.9308, lr_0 = 2.1663e-04
Validation rmse = 0.935971
Epoch 20
Loss = 1.4519e-03, PNorm = 62.6858, GNorm = 0.7146, lr_0 = 2.0962e-04
Loss = 1.3966e-03, PNorm = 62.6947, GNorm = 0.5374, lr_0 = 2.0283e-04
Loss = 1.6039e-03, PNorm = 62.7054, GNorm = 1.0689, lr_0 = 1.9627e-04
Validation rmse = 0.949728
Epoch 21
Loss = 1.2289e-03, PNorm = 62.7130, GNorm = 0.5004, lr_0 = 1.8992e-04
Loss = 1.5204e-03, PNorm = 62.7203, GNorm = 0.5748, lr_0 = 1.8377e-04
Validation rmse = 0.921748
Epoch 22
Loss = 1.3301e-03, PNorm = 62.7290, GNorm = 0.9312, lr_0 = 1.7783e-04
Loss = 1.1887e-03, PNorm = 62.7384, GNorm = 0.6257, lr_0 = 1.7207e-04
Loss = 1.4343e-03, PNorm = 62.7454, GNorm = 0.6110, lr_0 = 1.6651e-04
Validation rmse = 0.911528
Epoch 23
Loss = 1.3540e-03, PNorm = 62.7516, GNorm = 0.8675, lr_0 = 1.6059e-04
Loss = 1.3262e-03, PNorm = 62.7585, GNorm = 0.9672, lr_0 = 1.5539e-04
Validation rmse = 0.949813
Epoch 24
Loss = 1.4789e-03, PNorm = 62.7668, GNorm = 1.5786, lr_0 = 1.5036e-04
Loss = 1.4683e-03, PNorm = 62.7745, GNorm = 0.8278, lr_0 = 1.4550e-04
Loss = 1.3317e-03, PNorm = 62.7789, GNorm = 1.2265, lr_0 = 1.4079e-04
Validation rmse = 0.931239
Epoch 25
Loss = 1.1396e-03, PNorm = 62.7856, GNorm = 0.5775, lr_0 = 1.3623e-04
Loss = 1.2945e-03, PNorm = 62.7922, GNorm = 1.1976, lr_0 = 1.3183e-04
Loss = 1.3334e-03, PNorm = 62.7986, GNorm = 0.4827, lr_0 = 1.2756e-04
Validation rmse = 0.968546
Epoch 26
Loss = 1.3580e-03, PNorm = 62.8034, GNorm = 0.4907, lr_0 = 1.2343e-04
Loss = 1.2283e-03, PNorm = 62.8086, GNorm = 0.7142, lr_0 = 1.1944e-04
Validation rmse = 0.913603
Epoch 27
Loss = 1.4648e-03, PNorm = 62.8142, GNorm = 0.4650, lr_0 = 1.1557e-04
Loss = 1.2283e-03, PNorm = 62.8192, GNorm = 0.8697, lr_0 = 1.1183e-04
Loss = 1.1825e-03, PNorm = 62.8231, GNorm = 0.8396, lr_0 = 1.0821e-04
Validation rmse = 0.919287
Epoch 28
Loss = 1.3716e-03, PNorm = 62.8299, GNorm = 1.4030, lr_0 = 1.0437e-04
Loss = 1.0049e-03, PNorm = 62.8350, GNorm = 0.4178, lr_0 = 1.0099e-04
Validation rmse = 0.916285
Epoch 29
Loss = 7.0197e-04, PNorm = 62.8387, GNorm = 0.9691, lr_0 = 1.0000e-04
Loss = 1.2778e-03, PNorm = 62.8422, GNorm = 0.7401, lr_0 = 1.0000e-04
Loss = 1.1089e-03, PNorm = 62.8465, GNorm = 0.8218, lr_0 = 1.0000e-04
Validation rmse = 0.963733
Model 0 best validation rmse = 0.911528 on epoch 22
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.723170
Ensemble test rmse = 0.723170
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1700,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1700,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.25_ffn_num_layers_1_hidden_size_1700/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1700, bias=False)
      (W_h): Linear(in_features=1700, out_features=1700, bias=False)
      (W_o): Linear(in_features=1833, out_features=1700, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1700, out_features=1, bias=True)
  )
)
Number of parameters = 6,259,401
Moving model to cuda
Epoch 0
Loss = 2.2043e-02, PNorm = 61.1232, GNorm = 5.6398, lr_0 = 2.9800e-04
Loss = 1.4721e-02, PNorm = 61.1688, GNorm = 10.1246, lr_0 = 4.7800e-04
Validation rmse = 1.660067
Epoch 1
Loss = 8.6270e-03, PNorm = 61.2425, GNorm = 3.6465, lr_0 = 6.7600e-04
Loss = 8.6548e-03, PNorm = 61.3184, GNorm = 0.9031, lr_0 = 8.5600e-04
Loss = 6.5633e-03, PNorm = 61.3993, GNorm = 1.5194, lr_0 = 9.9344e-04
Validation rmse = 1.216183
Epoch 2
Loss = 6.2841e-03, PNorm = 61.4666, GNorm = 5.2906, lr_0 = 9.6130e-04
Loss = 6.5421e-03, PNorm = 61.5422, GNorm = 7.6166, lr_0 = 9.3019e-04
Validation rmse = 1.409386
Epoch 3
Loss = 6.0598e-03, PNorm = 61.6103, GNorm = 5.0207, lr_0 = 9.0009e-04
Loss = 6.2612e-03, PNorm = 61.6792, GNorm = 2.7218, lr_0 = 8.7096e-04
Loss = 4.2964e-03, PNorm = 61.7428, GNorm = 1.3429, lr_0 = 8.4278e-04
Validation rmse = 1.091927
Epoch 4
Loss = 4.4403e-03, PNorm = 61.7988, GNorm = 2.1759, lr_0 = 8.1551e-04
Loss = 4.3614e-03, PNorm = 61.8482, GNorm = 2.0199, lr_0 = 7.8912e-04
Validation rmse = 1.220273
Epoch 5
Loss = 3.3546e-03, PNorm = 61.8985, GNorm = 2.0676, lr_0 = 7.6358e-04
Loss = 3.9304e-03, PNorm = 61.9401, GNorm = 1.3955, lr_0 = 7.3888e-04
Loss = 3.1042e-03, PNorm = 61.9767, GNorm = 3.5507, lr_0 = 7.1497e-04
Validation rmse = 1.093621
Epoch 6
Loss = 2.8978e-03, PNorm = 62.0245, GNorm = 0.7718, lr_0 = 6.8956e-04
Loss = 3.1343e-03, PNorm = 62.0598, GNorm = 0.8627, lr_0 = 6.6725e-04
Loss = 2.7022e-03, PNorm = 62.0924, GNorm = 4.3571, lr_0 = 6.4565e-04
Validation rmse = 0.922741
Epoch 7
Loss = 2.1781e-03, PNorm = 62.1291, GNorm = 1.2298, lr_0 = 6.2476e-04
Loss = 2.5403e-03, PNorm = 62.1639, GNorm = 0.4740, lr_0 = 6.0454e-04
Validation rmse = 0.957519
Epoch 8
Loss = 2.7730e-03, PNorm = 62.2005, GNorm = 1.9476, lr_0 = 5.8498e-04
Loss = 2.4933e-03, PNorm = 62.2369, GNorm = 0.8252, lr_0 = 5.6605e-04
Loss = 2.2170e-03, PNorm = 62.2660, GNorm = 1.4743, lr_0 = 5.4774e-04
Validation rmse = 0.872756
Epoch 9
Loss = 1.8350e-03, PNorm = 62.2954, GNorm = 0.6720, lr_0 = 5.3001e-04
Loss = 2.2528e-03, PNorm = 62.3242, GNorm = 1.5208, lr_0 = 5.1286e-04
Validation rmse = 0.867542
Epoch 10
Loss = 1.8464e-03, PNorm = 62.3573, GNorm = 2.3627, lr_0 = 4.9627e-04
Loss = 2.2613e-03, PNorm = 62.3871, GNorm = 1.4835, lr_0 = 4.8021e-04
Loss = 1.8265e-03, PNorm = 62.4153, GNorm = 1.8548, lr_0 = 4.6467e-04
Validation rmse = 0.833537
Epoch 11
Loss = 1.6667e-03, PNorm = 62.4422, GNorm = 1.0658, lr_0 = 4.4963e-04
Loss = 1.9486e-03, PNorm = 62.4682, GNorm = 1.7242, lr_0 = 4.3508e-04
Validation rmse = 0.863308
Epoch 12
Loss = 1.6330e-03, PNorm = 62.4948, GNorm = 1.9397, lr_0 = 4.1962e-04
Loss = 1.8579e-03, PNorm = 62.5214, GNorm = 1.2526, lr_0 = 4.0604e-04
Loss = 1.5772e-03, PNorm = 62.5450, GNorm = 1.0504, lr_0 = 3.9290e-04
Validation rmse = 0.850673
Epoch 13
Loss = 1.6858e-03, PNorm = 62.5616, GNorm = 1.2531, lr_0 = 3.8019e-04
Loss = 1.4789e-03, PNorm = 62.5873, GNorm = 0.7425, lr_0 = 3.6789e-04
Loss = 1.7529e-03, PNorm = 62.6073, GNorm = 0.7289, lr_0 = 3.5598e-04
Validation rmse = 0.815208
Epoch 14
Loss = 1.4989e-03, PNorm = 62.6299, GNorm = 1.4086, lr_0 = 3.4446e-04
Loss = 1.4748e-03, PNorm = 62.6494, GNorm = 1.1217, lr_0 = 3.3332e-04
Validation rmse = 0.976525
Epoch 15
Loss = 2.3513e-03, PNorm = 62.6666, GNorm = 1.4686, lr_0 = 3.2253e-04
Loss = 1.7520e-03, PNorm = 62.6861, GNorm = 0.7241, lr_0 = 3.1209e-04
Loss = 1.4107e-03, PNorm = 62.7052, GNorm = 0.7749, lr_0 = 3.0200e-04
Validation rmse = 0.883590
Epoch 16
Loss = 1.5162e-03, PNorm = 62.7220, GNorm = 0.8184, lr_0 = 2.9222e-04
Loss = 1.3405e-03, PNorm = 62.7380, GNorm = 1.2293, lr_0 = 2.8277e-04
Validation rmse = 0.792371
Epoch 17
Loss = 1.2649e-03, PNorm = 62.7569, GNorm = 1.2017, lr_0 = 2.7272e-04
Loss = 1.3316e-03, PNorm = 62.7718, GNorm = 1.0990, lr_0 = 2.6389e-04
Loss = 1.3598e-03, PNorm = 62.7841, GNorm = 0.6353, lr_0 = 2.5535e-04
Validation rmse = 0.775239
Epoch 18
Loss = 1.5877e-03, PNorm = 62.7965, GNorm = 0.4960, lr_0 = 2.4709e-04
Loss = 1.4808e-03, PNorm = 62.8105, GNorm = 2.7370, lr_0 = 2.3910e-04
Loss = 1.1618e-03, PNorm = 62.8226, GNorm = 1.0427, lr_0 = 2.3136e-04
Validation rmse = 0.755236
Epoch 19
Loss = 1.3811e-03, PNorm = 62.8338, GNorm = 0.6272, lr_0 = 2.2387e-04
Loss = 1.4097e-03, PNorm = 62.8448, GNorm = 1.2391, lr_0 = 2.1663e-04
Validation rmse = 0.726081
Epoch 20
Loss = 1.0376e-03, PNorm = 62.8559, GNorm = 1.2700, lr_0 = 2.0962e-04
Loss = 1.3823e-03, PNorm = 62.8656, GNorm = 0.6698, lr_0 = 2.0283e-04
Loss = 1.2865e-03, PNorm = 62.8775, GNorm = 0.6318, lr_0 = 1.9627e-04
Validation rmse = 0.804921
Epoch 21
Loss = 1.3509e-03, PNorm = 62.8887, GNorm = 0.8166, lr_0 = 1.8992e-04
Loss = 1.2839e-03, PNorm = 62.9004, GNorm = 1.1263, lr_0 = 1.8377e-04
Validation rmse = 0.753850
Epoch 22
Loss = 1.0192e-03, PNorm = 62.9114, GNorm = 0.5641, lr_0 = 1.7783e-04
Loss = 1.1939e-03, PNorm = 62.9202, GNorm = 0.5828, lr_0 = 1.7207e-04
Loss = 1.0784e-03, PNorm = 62.9275, GNorm = 0.7285, lr_0 = 1.6651e-04
Validation rmse = 0.772863
Epoch 23
Loss = 1.3389e-03, PNorm = 62.9341, GNorm = 1.0855, lr_0 = 1.6059e-04
Loss = 1.0914e-03, PNorm = 62.9423, GNorm = 1.4975, lr_0 = 1.5539e-04
Validation rmse = 0.754734
Epoch 24
Loss = 1.2513e-03, PNorm = 62.9507, GNorm = 0.7411, lr_0 = 1.5036e-04
Loss = 1.1952e-03, PNorm = 62.9577, GNorm = 1.1392, lr_0 = 1.4550e-04
Loss = 1.1304e-03, PNorm = 62.9644, GNorm = 1.6955, lr_0 = 1.4079e-04
Validation rmse = 0.726383
Epoch 25
Loss = 9.9236e-04, PNorm = 62.9707, GNorm = 0.4147, lr_0 = 1.3623e-04
Loss = 1.0454e-03, PNorm = 62.9768, GNorm = 1.1667, lr_0 = 1.3183e-04
Loss = 1.2696e-03, PNorm = 62.9828, GNorm = 0.6776, lr_0 = 1.2756e-04
Validation rmse = 0.745571
Epoch 26
Loss = 1.1264e-03, PNorm = 62.9895, GNorm = 0.9590, lr_0 = 1.2343e-04
Loss = 9.5344e-04, PNorm = 62.9955, GNorm = 0.4873, lr_0 = 1.1944e-04
Validation rmse = 0.735766
Epoch 27
Loss = 1.0784e-03, PNorm = 63.0010, GNorm = 0.8137, lr_0 = 1.1557e-04
Loss = 1.1093e-03, PNorm = 63.0083, GNorm = 0.7268, lr_0 = 1.1183e-04
Loss = 9.9531e-04, PNorm = 63.0138, GNorm = 0.5199, lr_0 = 1.0821e-04
Validation rmse = 0.730156
Epoch 28
Loss = 1.0862e-03, PNorm = 63.0188, GNorm = 1.6760, lr_0 = 1.0437e-04
Loss = 1.0780e-03, PNorm = 63.0243, GNorm = 0.7180, lr_0 = 1.0099e-04
Validation rmse = 0.769852
Epoch 29
Loss = 1.3531e-03, PNorm = 63.0299, GNorm = 3.0276, lr_0 = 1.0000e-04
Loss = 1.1593e-03, PNorm = 63.0355, GNorm = 0.7273, lr_0 = 1.0000e-04
Loss = 9.9808e-04, PNorm = 63.0405, GNorm = 1.4319, lr_0 = 1.0000e-04
Validation rmse = 0.737204
Model 0 best validation rmse = 0.726081 on epoch 19
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.727063
Ensemble test rmse = 0.727063
10-fold cross validation
	Seed 0 ==> test rmse = 0.802926
	Seed 1 ==> test rmse = 0.748333
	Seed 2 ==> test rmse = 0.674730
	Seed 3 ==> test rmse = 0.898263
	Seed 4 ==> test rmse = 1.072794
	Seed 5 ==> test rmse = 0.671765
	Seed 6 ==> test rmse = 0.767829
	Seed 7 ==> test rmse = 0.677775
	Seed 8 ==> test rmse = 0.723170
	Seed 9 ==> test rmse = 0.727063
Overall test rmse = 0.776465 +/- 0.118552
Elapsed time = 0:09:16
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 891,501
Moving model to cuda
Epoch 0
Loss = 1.6864e-02, PNorm = 42.2775, GNorm = 4.8147, lr_0 = 2.9800e-04
Loss = 1.6678e-02, PNorm = 42.2907, GNorm = 2.9418, lr_0 = 4.7800e-04
Validation rmse = 1.461073
Epoch 1
Loss = 1.1780e-02, PNorm = 42.3217, GNorm = 5.2118, lr_0 = 6.7600e-04
Loss = 1.1311e-02, PNorm = 42.3581, GNorm = 6.2262, lr_0 = 8.5600e-04
Loss = 9.3270e-03, PNorm = 42.4014, GNorm = 6.4822, lr_0 = 9.9344e-04
Validation rmse = 1.459333
Epoch 2
Loss = 8.4216e-03, PNorm = 42.4420, GNorm = 3.3743, lr_0 = 9.6130e-04
Loss = 7.0101e-03, PNorm = 42.4778, GNorm = 2.9430, lr_0 = 9.3019e-04
Validation rmse = 1.222109
Epoch 3
Loss = 6.5019e-03, PNorm = 42.5052, GNorm = 3.5736, lr_0 = 9.0009e-04
Loss = 6.5455e-03, PNorm = 42.5409, GNorm = 1.8019, lr_0 = 8.7096e-04
Loss = 5.2196e-03, PNorm = 42.5657, GNorm = 2.2739, lr_0 = 8.4278e-04
Validation rmse = 1.135032
Epoch 4
Loss = 4.6834e-03, PNorm = 42.5961, GNorm = 2.3696, lr_0 = 8.1551e-04
Loss = 4.8957e-03, PNorm = 42.6182, GNorm = 0.9934, lr_0 = 7.8912e-04
Validation rmse = 1.286950
Epoch 5
Loss = 5.2427e-03, PNorm = 42.6439, GNorm = 6.0134, lr_0 = 7.6358e-04
Loss = 4.9338e-03, PNorm = 42.6712, GNorm = 2.3566, lr_0 = 7.3888e-04
Loss = 4.2422e-03, PNorm = 42.6946, GNorm = 2.3810, lr_0 = 7.1497e-04
Validation rmse = 1.106570
Epoch 6
Loss = 3.7091e-03, PNorm = 42.7181, GNorm = 1.0582, lr_0 = 6.8956e-04
Loss = 3.6603e-03, PNorm = 42.7374, GNorm = 2.0972, lr_0 = 6.6725e-04
Loss = 3.4745e-03, PNorm = 42.7536, GNorm = 2.1020, lr_0 = 6.4565e-04
Validation rmse = 1.020099
Epoch 7
Loss = 3.0130e-03, PNorm = 42.7701, GNorm = 1.2926, lr_0 = 6.2476e-04
Loss = 3.4640e-03, PNorm = 42.7865, GNorm = 1.7074, lr_0 = 6.0454e-04
Validation rmse = 0.989772
Epoch 8
Loss = 2.1759e-03, PNorm = 42.7996, GNorm = 1.2858, lr_0 = 5.8498e-04
Loss = 3.6215e-03, PNorm = 42.8105, GNorm = 4.0155, lr_0 = 5.6605e-04
Loss = 2.9726e-03, PNorm = 42.8264, GNorm = 1.9676, lr_0 = 5.4774e-04
Validation rmse = 0.993919
Epoch 9
Loss = 2.7308e-03, PNorm = 42.8423, GNorm = 0.9829, lr_0 = 5.3001e-04
Loss = 2.9653e-03, PNorm = 42.8537, GNorm = 1.5545, lr_0 = 5.1286e-04
Validation rmse = 0.949467
Epoch 10
Loss = 3.3360e-03, PNorm = 42.8630, GNorm = 0.7436, lr_0 = 4.9627e-04
Loss = 3.2305e-03, PNorm = 42.8778, GNorm = 4.1755, lr_0 = 4.8021e-04
Loss = 3.5882e-03, PNorm = 42.8903, GNorm = 1.2068, lr_0 = 4.6467e-04
Validation rmse = 0.924033
Epoch 11
Loss = 3.1634e-03, PNorm = 42.9012, GNorm = 1.4072, lr_0 = 4.4963e-04
Loss = 2.6729e-03, PNorm = 42.9126, GNorm = 1.0900, lr_0 = 4.3508e-04
Validation rmse = 0.956220
Epoch 12
Loss = 2.4359e-03, PNorm = 42.9249, GNorm = 1.1753, lr_0 = 4.1962e-04
Loss = 2.4491e-03, PNorm = 42.9315, GNorm = 1.7166, lr_0 = 4.0604e-04
Loss = 2.7739e-03, PNorm = 42.9419, GNorm = 4.6063, lr_0 = 3.9290e-04
Validation rmse = 0.897196
Epoch 13
Loss = 2.5319e-03, PNorm = 42.9505, GNorm = 0.6975, lr_0 = 3.8019e-04
Loss = 2.8613e-03, PNorm = 42.9587, GNorm = 0.9724, lr_0 = 3.6789e-04
Loss = 2.1790e-03, PNorm = 42.9663, GNorm = 1.2533, lr_0 = 3.5598e-04
Validation rmse = 0.925942
Epoch 14
Loss = 2.3246e-03, PNorm = 42.9732, GNorm = 0.6886, lr_0 = 3.4446e-04
Loss = 2.4686e-03, PNorm = 42.9803, GNorm = 1.9352, lr_0 = 3.3332e-04
Validation rmse = 0.897374
Epoch 15
Loss = 2.3615e-03, PNorm = 42.9900, GNorm = 0.9731, lr_0 = 3.2253e-04
Loss = 2.3507e-03, PNorm = 42.9961, GNorm = 1.1209, lr_0 = 3.1209e-04
Loss = 2.2128e-03, PNorm = 43.0036, GNorm = 1.3012, lr_0 = 3.0200e-04
Validation rmse = 0.934543
Epoch 16
Loss = 2.5078e-03, PNorm = 43.0083, GNorm = 0.8165, lr_0 = 2.9222e-04
Loss = 2.6319e-03, PNorm = 43.0174, GNorm = 1.4778, lr_0 = 2.8277e-04
Validation rmse = 0.877116
Epoch 17
Loss = 2.4555e-03, PNorm = 43.0235, GNorm = 2.5665, lr_0 = 2.7272e-04
Loss = 2.0987e-03, PNorm = 43.0295, GNorm = 1.2352, lr_0 = 2.6389e-04
Loss = 2.1290e-03, PNorm = 43.0349, GNorm = 1.9483, lr_0 = 2.5535e-04
Validation rmse = 0.874017
Epoch 18
Loss = 2.2227e-03, PNorm = 43.0407, GNorm = 1.5061, lr_0 = 2.4709e-04
Loss = 2.2482e-03, PNorm = 43.0474, GNorm = 0.8193, lr_0 = 2.3910e-04
Loss = 1.8525e-03, PNorm = 43.0530, GNorm = 1.9026, lr_0 = 2.3136e-04
Validation rmse = 0.848092
Epoch 19
Loss = 2.1933e-03, PNorm = 43.0580, GNorm = 1.2456, lr_0 = 2.2387e-04
Loss = 1.9144e-03, PNorm = 43.0624, GNorm = 1.3737, lr_0 = 2.1663e-04
Validation rmse = 0.889607
Epoch 20
Loss = 1.7157e-03, PNorm = 43.0664, GNorm = 1.6750, lr_0 = 2.0962e-04
Loss = 2.2464e-03, PNorm = 43.0701, GNorm = 1.1532, lr_0 = 2.0283e-04
Loss = 1.8286e-03, PNorm = 43.0732, GNorm = 1.2072, lr_0 = 1.9627e-04
Validation rmse = 0.870458
Epoch 21
Loss = 1.8310e-03, PNorm = 43.0779, GNorm = 1.5630, lr_0 = 1.8992e-04
Loss = 1.8989e-03, PNorm = 43.0812, GNorm = 3.0906, lr_0 = 1.8377e-04
Validation rmse = 0.857383
Epoch 22
Loss = 1.9804e-03, PNorm = 43.0858, GNorm = 1.8470, lr_0 = 1.7783e-04
Loss = 1.8683e-03, PNorm = 43.0904, GNorm = 0.8861, lr_0 = 1.7207e-04
Loss = 2.2784e-03, PNorm = 43.0929, GNorm = 0.8034, lr_0 = 1.6651e-04
Validation rmse = 0.891342
Epoch 23
Loss = 1.9135e-03, PNorm = 43.0972, GNorm = 2.2137, lr_0 = 1.6059e-04
Loss = 1.9424e-03, PNorm = 43.1014, GNorm = 1.0084, lr_0 = 1.5539e-04
Validation rmse = 0.850892
Epoch 24
Loss = 1.7287e-03, PNorm = 43.1043, GNorm = 1.7786, lr_0 = 1.5036e-04
Loss = 1.9478e-03, PNorm = 43.1073, GNorm = 1.8268, lr_0 = 1.4550e-04
Loss = 1.8622e-03, PNorm = 43.1105, GNorm = 1.5417, lr_0 = 1.4079e-04
Validation rmse = 0.862471
Epoch 25
Loss = 1.7775e-03, PNorm = 43.1131, GNorm = 3.0036, lr_0 = 1.3623e-04
Loss = 1.8588e-03, PNorm = 43.1146, GNorm = 1.3825, lr_0 = 1.3183e-04
Loss = 2.0491e-03, PNorm = 43.1174, GNorm = 2.1706, lr_0 = 1.2756e-04
Validation rmse = 0.878273
Epoch 26
Loss = 1.6008e-03, PNorm = 43.1209, GNorm = 0.7903, lr_0 = 1.2343e-04
Loss = 1.7691e-03, PNorm = 43.1228, GNorm = 1.0748, lr_0 = 1.1944e-04
Validation rmse = 0.845259
Epoch 27
Loss = 1.8550e-03, PNorm = 43.1251, GNorm = 1.3956, lr_0 = 1.1557e-04
Loss = 1.8888e-03, PNorm = 43.1283, GNorm = 1.1503, lr_0 = 1.1183e-04
Loss = 1.7995e-03, PNorm = 43.1302, GNorm = 0.5747, lr_0 = 1.0821e-04
Validation rmse = 0.843170
Epoch 28
Loss = 1.9977e-03, PNorm = 43.1328, GNorm = 0.9442, lr_0 = 1.0437e-04
Loss = 1.5240e-03, PNorm = 43.1356, GNorm = 1.0883, lr_0 = 1.0099e-04
Validation rmse = 0.835428
Epoch 29
Loss = 2.1921e-03, PNorm = 43.1379, GNorm = 0.7860, lr_0 = 1.0000e-04
Loss = 1.7577e-03, PNorm = 43.1394, GNorm = 0.9388, lr_0 = 1.0000e-04
Loss = 1.8816e-03, PNorm = 43.1409, GNorm = 3.3234, lr_0 = 1.0000e-04
Validation rmse = 0.843537
Model 0 best validation rmse = 0.835428 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.822238
Ensemble test rmse = 0.822238
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 891,501
Moving model to cuda
Epoch 0
Loss = 1.9863e-02, PNorm = 42.2758, GNorm = 4.0020, lr_0 = 2.9800e-04
Loss = 1.4829e-02, PNorm = 42.2905, GNorm = 6.2732, lr_0 = 4.7800e-04
Validation rmse = 2.140322
Epoch 1
Loss = 1.3786e-02, PNorm = 42.3168, GNorm = 10.2639, lr_0 = 6.7600e-04
Loss = 1.1479e-02, PNorm = 42.3525, GNorm = 2.4349, lr_0 = 8.5600e-04
Loss = 8.6088e-03, PNorm = 42.3923, GNorm = 3.0989, lr_0 = 9.9344e-04
Validation rmse = 1.597232
Epoch 2
Loss = 7.4929e-03, PNorm = 42.4373, GNorm = 5.8646, lr_0 = 9.6130e-04
Loss = 7.3965e-03, PNorm = 42.4723, GNorm = 1.8030, lr_0 = 9.3019e-04
Validation rmse = 1.372057
Epoch 3
Loss = 6.3038e-03, PNorm = 42.5049, GNorm = 3.8289, lr_0 = 9.0009e-04
Loss = 6.6233e-03, PNorm = 42.5354, GNorm = 4.4150, lr_0 = 8.7096e-04
Loss = 6.2471e-03, PNorm = 42.5670, GNorm = 5.3069, lr_0 = 8.4278e-04
Validation rmse = 1.225687
Epoch 4
Loss = 5.5606e-03, PNorm = 42.5892, GNorm = 5.1204, lr_0 = 8.1551e-04
Loss = 4.3782e-03, PNorm = 42.6119, GNorm = 1.2343, lr_0 = 7.8912e-04
Validation rmse = 0.993836
Epoch 5
Loss = 3.3301e-03, PNorm = 42.6338, GNorm = 2.8754, lr_0 = 7.6358e-04
Loss = 4.3511e-03, PNorm = 42.6547, GNorm = 1.8541, lr_0 = 7.3888e-04
Loss = 4.1016e-03, PNorm = 42.6748, GNorm = 3.5224, lr_0 = 7.1497e-04
Validation rmse = 1.014896
Epoch 6
Loss = 4.5706e-03, PNorm = 42.6934, GNorm = 1.0779, lr_0 = 6.8956e-04
Loss = 3.8838e-03, PNorm = 42.7155, GNorm = 0.9844, lr_0 = 6.6725e-04
Loss = 3.8129e-03, PNorm = 42.7318, GNorm = 1.1286, lr_0 = 6.4565e-04
Validation rmse = 0.925892
Epoch 7
Loss = 3.4769e-03, PNorm = 42.7474, GNorm = 0.8480, lr_0 = 6.2476e-04
Loss = 3.4072e-03, PNorm = 42.7605, GNorm = 0.9417, lr_0 = 6.0454e-04
Validation rmse = 0.881093
Epoch 8
Loss = 3.7019e-03, PNorm = 42.7772, GNorm = 1.6834, lr_0 = 5.8498e-04
Loss = 3.6390e-03, PNorm = 42.7930, GNorm = 1.9829, lr_0 = 5.6605e-04
Loss = 3.5114e-03, PNorm = 42.8053, GNorm = 5.7505, lr_0 = 5.4774e-04
Validation rmse = 0.893459
Epoch 9
Loss = 3.2630e-03, PNorm = 42.8180, GNorm = 2.5388, lr_0 = 5.3001e-04
Loss = 3.3684e-03, PNorm = 42.8344, GNorm = 1.2017, lr_0 = 5.1286e-04
Validation rmse = 0.873738
Epoch 10
Loss = 2.9066e-03, PNorm = 42.8455, GNorm = 1.2167, lr_0 = 4.9627e-04
Loss = 3.2510e-03, PNorm = 42.8559, GNorm = 1.7879, lr_0 = 4.8021e-04
Loss = 2.7141e-03, PNorm = 42.8640, GNorm = 2.0810, lr_0 = 4.6467e-04
Validation rmse = 0.871474
Epoch 11
Loss = 2.9517e-03, PNorm = 42.8758, GNorm = 1.2403, lr_0 = 4.4963e-04
Loss = 3.0337e-03, PNorm = 42.8832, GNorm = 1.0384, lr_0 = 4.3508e-04
Validation rmse = 0.827982
Epoch 12
Loss = 3.4509e-03, PNorm = 42.8951, GNorm = 2.0023, lr_0 = 4.1962e-04
Loss = 3.0757e-03, PNorm = 42.9072, GNorm = 3.4232, lr_0 = 4.0604e-04
Loss = 3.1797e-03, PNorm = 42.9177, GNorm = 1.3553, lr_0 = 3.9290e-04
Validation rmse = 1.017961
Epoch 13
Loss = 3.1166e-03, PNorm = 42.9271, GNorm = 1.1391, lr_0 = 3.8019e-04
Loss = 3.4337e-03, PNorm = 42.9387, GNorm = 2.6971, lr_0 = 3.6789e-04
Loss = 2.8815e-03, PNorm = 42.9450, GNorm = 0.8619, lr_0 = 3.5598e-04
Validation rmse = 0.807458
Epoch 14
Loss = 2.6714e-03, PNorm = 42.9538, GNorm = 1.2965, lr_0 = 3.4446e-04
Loss = 2.2133e-03, PNorm = 42.9615, GNorm = 2.5175, lr_0 = 3.3332e-04
Validation rmse = 0.783385
Epoch 15
Loss = 2.4889e-03, PNorm = 42.9687, GNorm = 2.1522, lr_0 = 3.2253e-04
Loss = 2.4462e-03, PNorm = 42.9743, GNorm = 2.0601, lr_0 = 3.1209e-04
Loss = 2.6316e-03, PNorm = 42.9812, GNorm = 1.5157, lr_0 = 3.0200e-04
Validation rmse = 0.806011
Epoch 16
Loss = 3.2438e-03, PNorm = 42.9881, GNorm = 4.5419, lr_0 = 2.9222e-04
Loss = 2.1020e-03, PNorm = 42.9936, GNorm = 2.9530, lr_0 = 2.8277e-04
Validation rmse = 0.803997
Epoch 17
Loss = 2.2003e-03, PNorm = 43.0007, GNorm = 1.1737, lr_0 = 2.7272e-04
Loss = 2.5147e-03, PNorm = 43.0072, GNorm = 1.5765, lr_0 = 2.6389e-04
Loss = 2.2649e-03, PNorm = 43.0148, GNorm = 1.1663, lr_0 = 2.5535e-04
Validation rmse = 0.765734
Epoch 18
Loss = 2.4516e-03, PNorm = 43.0196, GNorm = 1.5573, lr_0 = 2.4709e-04
Loss = 2.6108e-03, PNorm = 43.0245, GNorm = 1.2467, lr_0 = 2.3910e-04
Loss = 2.2680e-03, PNorm = 43.0293, GNorm = 1.4449, lr_0 = 2.3136e-04
Validation rmse = 0.755607
Epoch 19
Loss = 2.2625e-03, PNorm = 43.0324, GNorm = 1.8143, lr_0 = 2.2387e-04
Loss = 2.1975e-03, PNorm = 43.0379, GNorm = 1.8233, lr_0 = 2.1663e-04
Validation rmse = 0.734012
Epoch 20
Loss = 2.2734e-03, PNorm = 43.0425, GNorm = 2.3920, lr_0 = 2.0962e-04
Loss = 2.3651e-03, PNorm = 43.0478, GNorm = 0.8537, lr_0 = 2.0283e-04
Loss = 1.9620e-03, PNorm = 43.0524, GNorm = 2.2248, lr_0 = 1.9627e-04
Validation rmse = 0.762525
Epoch 21
Loss = 2.3585e-03, PNorm = 43.0553, GNorm = 1.7314, lr_0 = 1.8992e-04
Loss = 2.1166e-03, PNorm = 43.0590, GNorm = 1.4214, lr_0 = 1.8377e-04
Validation rmse = 0.743365
Epoch 22
Loss = 1.7934e-03, PNorm = 43.0632, GNorm = 1.5217, lr_0 = 1.7783e-04
Loss = 2.1329e-03, PNorm = 43.0655, GNorm = 1.1620, lr_0 = 1.7207e-04
Loss = 2.0538e-03, PNorm = 43.0691, GNorm = 0.9408, lr_0 = 1.6651e-04
Validation rmse = 0.736480
Epoch 23
Loss = 1.8325e-03, PNorm = 43.0747, GNorm = 1.5145, lr_0 = 1.6059e-04
Loss = 1.8828e-03, PNorm = 43.0782, GNorm = 1.0175, lr_0 = 1.5539e-04
Validation rmse = 0.788315
Epoch 24
Loss = 1.7261e-03, PNorm = 43.0807, GNorm = 1.4645, lr_0 = 1.5036e-04
Loss = 2.1788e-03, PNorm = 43.0834, GNorm = 2.0221, lr_0 = 1.4550e-04
Loss = 1.9870e-03, PNorm = 43.0872, GNorm = 1.2766, lr_0 = 1.4079e-04
Validation rmse = 0.727875
Epoch 25
Loss = 1.4550e-03, PNorm = 43.0898, GNorm = 0.8875, lr_0 = 1.3623e-04
Loss = 1.9283e-03, PNorm = 43.0916, GNorm = 1.5578, lr_0 = 1.3183e-04
Loss = 2.0926e-03, PNorm = 43.0941, GNorm = 0.9551, lr_0 = 1.2756e-04
Validation rmse = 0.731688
Epoch 26
Loss = 1.9323e-03, PNorm = 43.0967, GNorm = 1.2502, lr_0 = 1.2343e-04
Loss = 2.0383e-03, PNorm = 43.1003, GNorm = 0.9332, lr_0 = 1.1944e-04
Validation rmse = 0.723245
Epoch 27
Loss = 2.2590e-03, PNorm = 43.1018, GNorm = 1.6621, lr_0 = 1.1557e-04
Loss = 1.8332e-03, PNorm = 43.1037, GNorm = 3.4834, lr_0 = 1.1183e-04
Loss = 2.0819e-03, PNorm = 43.1061, GNorm = 1.4519, lr_0 = 1.0821e-04
Validation rmse = 0.743460
Epoch 28
Loss = 2.0053e-03, PNorm = 43.1088, GNorm = 1.1539, lr_0 = 1.0437e-04
Loss = 1.7631e-03, PNorm = 43.1103, GNorm = 0.9425, lr_0 = 1.0099e-04
Validation rmse = 0.762190
Epoch 29
Loss = 2.1570e-03, PNorm = 43.1119, GNorm = 3.4374, lr_0 = 1.0000e-04
Loss = 2.0452e-03, PNorm = 43.1146, GNorm = 0.9904, lr_0 = 1.0000e-04
Loss = 1.8065e-03, PNorm = 43.1170, GNorm = 2.4209, lr_0 = 1.0000e-04
Validation rmse = 0.740883
Model 0 best validation rmse = 0.723245 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.711647
Ensemble test rmse = 0.711647
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 891,501
Moving model to cuda
Epoch 0
Loss = 1.9823e-02, PNorm = 42.2759, GNorm = 8.5922, lr_0 = 2.9800e-04
Loss = 1.4855e-02, PNorm = 42.2903, GNorm = 3.1417, lr_0 = 4.7800e-04
Validation rmse = 1.687632
Epoch 1
Loss = 1.3303e-02, PNorm = 42.3206, GNorm = 8.5685, lr_0 = 6.7600e-04
Loss = 1.1486e-02, PNorm = 42.3555, GNorm = 2.2863, lr_0 = 8.5600e-04
Loss = 9.2264e-03, PNorm = 42.4050, GNorm = 8.6021, lr_0 = 9.9344e-04
Validation rmse = 1.503375
Epoch 2
Loss = 8.4905e-03, PNorm = 42.4497, GNorm = 6.5364, lr_0 = 9.6130e-04
Loss = 8.1369e-03, PNorm = 42.4850, GNorm = 1.9539, lr_0 = 9.3019e-04
Validation rmse = 1.156177
Epoch 3
Loss = 6.8739e-03, PNorm = 42.5187, GNorm = 6.9707, lr_0 = 9.0009e-04
Loss = 6.5397e-03, PNorm = 42.5502, GNorm = 2.3514, lr_0 = 8.7096e-04
Loss = 6.7731e-03, PNorm = 42.5816, GNorm = 6.7780, lr_0 = 8.4278e-04
Validation rmse = 1.230881
Epoch 4
Loss = 6.9707e-03, PNorm = 42.6099, GNorm = 3.6108, lr_0 = 8.1551e-04
Loss = 5.7612e-03, PNorm = 42.6367, GNorm = 4.0260, lr_0 = 7.8912e-04
Validation rmse = 1.142784
Epoch 5
Loss = 5.2583e-03, PNorm = 42.6648, GNorm = 2.8640, lr_0 = 7.6358e-04
Loss = 5.2747e-03, PNorm = 42.6947, GNorm = 1.9180, lr_0 = 7.3888e-04
Loss = 4.5499e-03, PNorm = 42.7196, GNorm = 2.5856, lr_0 = 7.1497e-04
Validation rmse = 1.161161
Epoch 6
Loss = 6.3794e-03, PNorm = 42.7400, GNorm = 7.3602, lr_0 = 6.8956e-04
Loss = 3.8714e-03, PNorm = 42.7607, GNorm = 3.0392, lr_0 = 6.6725e-04
Loss = 4.6824e-03, PNorm = 42.7828, GNorm = 2.9234, lr_0 = 6.4565e-04
Validation rmse = 0.911525
Epoch 7
Loss = 3.9237e-03, PNorm = 42.8008, GNorm = 3.1588, lr_0 = 6.2476e-04
Loss = 3.7917e-03, PNorm = 42.8183, GNorm = 1.6441, lr_0 = 6.0454e-04
Validation rmse = 0.867790
Epoch 8
Loss = 3.8325e-03, PNorm = 42.8365, GNorm = 1.4399, lr_0 = 5.8498e-04
Loss = 3.2022e-03, PNorm = 42.8543, GNorm = 0.8623, lr_0 = 5.6605e-04
Loss = 3.7144e-03, PNorm = 42.8708, GNorm = 3.1169, lr_0 = 5.4774e-04
Validation rmse = 0.787976
Epoch 9
Loss = 3.0752e-03, PNorm = 42.8848, GNorm = 1.5728, lr_0 = 5.3001e-04
Loss = 3.2496e-03, PNorm = 42.9011, GNorm = 0.9906, lr_0 = 5.1286e-04
Validation rmse = 0.772746
Epoch 10
Loss = 2.7883e-03, PNorm = 42.9121, GNorm = 2.1793, lr_0 = 4.9627e-04
Loss = 3.0969e-03, PNorm = 42.9235, GNorm = 3.7186, lr_0 = 4.8021e-04
Loss = 3.2933e-03, PNorm = 42.9366, GNorm = 2.5927, lr_0 = 4.6467e-04
Validation rmse = 0.757830
Epoch 11
Loss = 2.7312e-03, PNorm = 42.9496, GNorm = 1.2326, lr_0 = 4.4963e-04
Loss = 2.9227e-03, PNorm = 42.9588, GNorm = 0.6765, lr_0 = 4.3508e-04
Validation rmse = 0.755018
Epoch 12
Loss = 2.1865e-03, PNorm = 42.9716, GNorm = 1.9848, lr_0 = 4.1962e-04
Loss = 3.1717e-03, PNorm = 42.9823, GNorm = 1.7215, lr_0 = 4.0604e-04
Loss = 2.3324e-03, PNorm = 42.9922, GNorm = 1.2133, lr_0 = 3.9290e-04
Validation rmse = 0.758970
Epoch 13
Loss = 2.1223e-03, PNorm = 43.0021, GNorm = 0.7144, lr_0 = 3.8019e-04
Loss = 2.8070e-03, PNorm = 43.0110, GNorm = 2.4458, lr_0 = 3.6789e-04
Loss = 2.6123e-03, PNorm = 43.0200, GNorm = 0.8894, lr_0 = 3.5598e-04
Validation rmse = 0.738005
Epoch 14
Loss = 2.5371e-03, PNorm = 43.0257, GNorm = 1.8789, lr_0 = 3.4446e-04
Loss = 3.0959e-03, PNorm = 43.0343, GNorm = 1.2637, lr_0 = 3.3332e-04
Validation rmse = 0.758779
Epoch 15
Loss = 2.4447e-03, PNorm = 43.0430, GNorm = 3.7877, lr_0 = 3.2253e-04
Loss = 2.6894e-03, PNorm = 43.0514, GNorm = 2.5193, lr_0 = 3.1209e-04
Loss = 3.0059e-03, PNorm = 43.0603, GNorm = 1.3001, lr_0 = 3.0200e-04
Validation rmse = 0.733058
Epoch 16
Loss = 2.3037e-03, PNorm = 43.0681, GNorm = 1.1283, lr_0 = 2.9222e-04
Loss = 2.2644e-03, PNorm = 43.0739, GNorm = 2.5556, lr_0 = 2.8277e-04
Validation rmse = 0.697651
Epoch 17
Loss = 2.1697e-03, PNorm = 43.0801, GNorm = 3.5166, lr_0 = 2.7272e-04
Loss = 2.2011e-03, PNorm = 43.0850, GNorm = 1.1569, lr_0 = 2.6389e-04
Loss = 2.5645e-03, PNorm = 43.0913, GNorm = 1.7158, lr_0 = 2.5535e-04
Validation rmse = 0.701140
Epoch 18
Loss = 2.5702e-03, PNorm = 43.0981, GNorm = 0.9139, lr_0 = 2.4709e-04
Loss = 2.3610e-03, PNorm = 43.1035, GNorm = 3.2192, lr_0 = 2.3910e-04
Loss = 2.3656e-03, PNorm = 43.1090, GNorm = 1.9483, lr_0 = 2.3136e-04
Validation rmse = 0.731968
Epoch 19
Loss = 2.7157e-03, PNorm = 43.1135, GNorm = 1.0288, lr_0 = 2.2387e-04
Loss = 2.1003e-03, PNorm = 43.1184, GNorm = 1.0124, lr_0 = 2.1663e-04
Validation rmse = 0.703606
Epoch 20
Loss = 2.4134e-03, PNorm = 43.1233, GNorm = 3.9119, lr_0 = 2.0962e-04
Loss = 2.3475e-03, PNorm = 43.1279, GNorm = 1.3253, lr_0 = 2.0283e-04
Loss = 1.9314e-03, PNorm = 43.1327, GNorm = 1.1552, lr_0 = 1.9627e-04
Validation rmse = 0.682503
Epoch 21
Loss = 1.9571e-03, PNorm = 43.1352, GNorm = 2.1829, lr_0 = 1.8992e-04
Loss = 2.4640e-03, PNorm = 43.1382, GNorm = 2.9075, lr_0 = 1.8377e-04
Validation rmse = 0.743829
Epoch 22
Loss = 2.3366e-03, PNorm = 43.1412, GNorm = 1.2665, lr_0 = 1.7783e-04
Loss = 2.4308e-03, PNorm = 43.1454, GNorm = 2.1243, lr_0 = 1.7207e-04
Loss = 2.1503e-03, PNorm = 43.1504, GNorm = 1.0460, lr_0 = 1.6651e-04
Validation rmse = 0.680529
Epoch 23
Loss = 2.1134e-03, PNorm = 43.1539, GNorm = 1.2724, lr_0 = 1.6059e-04
Loss = 2.1820e-03, PNorm = 43.1572, GNorm = 1.5249, lr_0 = 1.5539e-04
Validation rmse = 0.705118
Epoch 24
Loss = 2.2539e-03, PNorm = 43.1600, GNorm = 2.3053, lr_0 = 1.5036e-04
Loss = 1.8872e-03, PNorm = 43.1620, GNorm = 1.8566, lr_0 = 1.4550e-04
Loss = 1.9776e-03, PNorm = 43.1650, GNorm = 3.1014, lr_0 = 1.4079e-04
Validation rmse = 0.666101
Epoch 25
Loss = 2.1565e-03, PNorm = 43.1683, GNorm = 2.9734, lr_0 = 1.3623e-04
Loss = 1.9605e-03, PNorm = 43.1720, GNorm = 1.1178, lr_0 = 1.3183e-04
Loss = 1.8112e-03, PNorm = 43.1739, GNorm = 1.4034, lr_0 = 1.2756e-04
Validation rmse = 0.677015
Epoch 26
Loss = 2.0468e-03, PNorm = 43.1762, GNorm = 4.6234, lr_0 = 1.2343e-04
Loss = 1.8249e-03, PNorm = 43.1782, GNorm = 0.8536, lr_0 = 1.1944e-04
Validation rmse = 0.676030
Epoch 27
Loss = 2.3118e-03, PNorm = 43.1809, GNorm = 2.3635, lr_0 = 1.1557e-04
Loss = 2.1220e-03, PNorm = 43.1837, GNorm = 1.1487, lr_0 = 1.1183e-04
Loss = 1.8130e-03, PNorm = 43.1862, GNorm = 1.1296, lr_0 = 1.0821e-04
Validation rmse = 0.666206
Epoch 28
Loss = 1.8022e-03, PNorm = 43.1887, GNorm = 1.3268, lr_0 = 1.0437e-04
Loss = 2.0937e-03, PNorm = 43.1904, GNorm = 1.1607, lr_0 = 1.0099e-04
Validation rmse = 0.659855
Epoch 29
Loss = 1.8947e-03, PNorm = 43.1925, GNorm = 1.5573, lr_0 = 1.0000e-04
Loss = 1.9752e-03, PNorm = 43.1954, GNorm = 1.5771, lr_0 = 1.0000e-04
Loss = 1.7577e-03, PNorm = 43.1977, GNorm = 0.7917, lr_0 = 1.0000e-04
Validation rmse = 0.665930
Model 0 best validation rmse = 0.659855 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.711353
Ensemble test rmse = 0.711353
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 891,501
Moving model to cuda
Epoch 0
Loss = 1.8600e-02, PNorm = 42.2751, GNorm = 8.1555, lr_0 = 2.9800e-04
Loss = 1.4785e-02, PNorm = 42.2901, GNorm = 8.2681, lr_0 = 4.7800e-04
Validation rmse = 1.484357
Epoch 1
Loss = 8.8700e-03, PNorm = 42.3195, GNorm = 5.8548, lr_0 = 6.7600e-04
Loss = 9.5388e-03, PNorm = 42.3561, GNorm = 11.8220, lr_0 = 8.5600e-04
Loss = 9.3481e-03, PNorm = 42.3973, GNorm = 1.8684, lr_0 = 9.9344e-04
Validation rmse = 1.643738
Epoch 2
Loss = 1.0039e-02, PNorm = 42.4421, GNorm = 7.1269, lr_0 = 9.6130e-04
Loss = 7.8765e-03, PNorm = 42.4780, GNorm = 3.9724, lr_0 = 9.3019e-04
Validation rmse = 1.168571
Epoch 3
Loss = 5.8648e-03, PNorm = 42.5117, GNorm = 2.6837, lr_0 = 9.0009e-04
Loss = 5.9213e-03, PNorm = 42.5410, GNorm = 1.7599, lr_0 = 8.7096e-04
Loss = 5.1777e-03, PNorm = 42.5703, GNorm = 2.9851, lr_0 = 8.4278e-04
Validation rmse = 1.171114
Epoch 4
Loss = 6.0638e-03, PNorm = 42.5928, GNorm = 6.7808, lr_0 = 8.1551e-04
Loss = 4.7031e-03, PNorm = 42.6212, GNorm = 2.6264, lr_0 = 7.8912e-04
Validation rmse = 0.965435
Epoch 5
Loss = 5.1034e-03, PNorm = 42.6439, GNorm = 2.3863, lr_0 = 7.6358e-04
Loss = 3.5945e-03, PNorm = 42.6650, GNorm = 1.2587, lr_0 = 7.3888e-04
Loss = 4.5714e-03, PNorm = 42.6843, GNorm = 5.5599, lr_0 = 7.1497e-04
Validation rmse = 0.976889
Epoch 6
Loss = 4.8005e-03, PNorm = 42.7056, GNorm = 3.2736, lr_0 = 6.8956e-04
Loss = 4.2868e-03, PNorm = 42.7308, GNorm = 2.6788, lr_0 = 6.6725e-04
Loss = 3.5422e-03, PNorm = 42.7507, GNorm = 1.7329, lr_0 = 6.4565e-04
Validation rmse = 0.871841
Epoch 7
Loss = 3.2776e-03, PNorm = 42.7674, GNorm = 3.0498, lr_0 = 6.2476e-04
Loss = 4.0258e-03, PNorm = 42.7846, GNorm = 2.3542, lr_0 = 6.0454e-04
Validation rmse = 0.832525
Epoch 8
Loss = 3.0479e-03, PNorm = 42.8013, GNorm = 1.1757, lr_0 = 5.8498e-04
Loss = 3.0095e-03, PNorm = 42.8145, GNorm = 1.3510, lr_0 = 5.6605e-04
Loss = 3.0627e-03, PNorm = 42.8300, GNorm = 1.0624, lr_0 = 5.4774e-04
Validation rmse = 0.797721
Epoch 9
Loss = 3.3519e-03, PNorm = 42.8421, GNorm = 3.8017, lr_0 = 5.3001e-04
Loss = 3.3269e-03, PNorm = 42.8558, GNorm = 2.6464, lr_0 = 5.1286e-04
Validation rmse = 0.787371
Epoch 10
Loss = 1.7626e-03, PNorm = 42.8707, GNorm = 0.9999, lr_0 = 4.9627e-04
Loss = 2.7663e-03, PNorm = 42.8826, GNorm = 2.9911, lr_0 = 4.8021e-04
Loss = 3.2476e-03, PNorm = 42.8939, GNorm = 1.6342, lr_0 = 4.6467e-04
Validation rmse = 0.774336
Epoch 11
Loss = 2.3702e-03, PNorm = 42.9048, GNorm = 1.5997, lr_0 = 4.4963e-04
Loss = 2.9873e-03, PNorm = 42.9138, GNorm = 1.5761, lr_0 = 4.3508e-04
Validation rmse = 0.757896
Epoch 12
Loss = 2.5367e-03, PNorm = 42.9241, GNorm = 1.5765, lr_0 = 4.1962e-04
Loss = 2.5979e-03, PNorm = 42.9334, GNorm = 2.7093, lr_0 = 4.0604e-04
Loss = 2.8428e-03, PNorm = 42.9438, GNorm = 4.9112, lr_0 = 3.9290e-04
Validation rmse = 0.742671
Epoch 13
Loss = 3.0948e-03, PNorm = 42.9550, GNorm = 3.1859, lr_0 = 3.8019e-04
Loss = 2.7129e-03, PNorm = 42.9632, GNorm = 2.0536, lr_0 = 3.6789e-04
Loss = 2.3342e-03, PNorm = 42.9706, GNorm = 1.1209, lr_0 = 3.5598e-04
Validation rmse = 0.719204
Epoch 14
Loss = 2.2232e-03, PNorm = 42.9781, GNorm = 0.9135, lr_0 = 3.4446e-04
Loss = 2.1484e-03, PNorm = 42.9858, GNorm = 1.1886, lr_0 = 3.3332e-04
Validation rmse = 0.722917
Epoch 15
Loss = 2.5118e-03, PNorm = 42.9932, GNorm = 2.3663, lr_0 = 3.2253e-04
Loss = 2.7964e-03, PNorm = 43.0007, GNorm = 2.2618, lr_0 = 3.1209e-04
Loss = 2.5571e-03, PNorm = 43.0082, GNorm = 6.3436, lr_0 = 3.0200e-04
Validation rmse = 0.810177
Epoch 16
Loss = 2.7855e-03, PNorm = 43.0145, GNorm = 3.3364, lr_0 = 2.9222e-04
Loss = 2.6341e-03, PNorm = 43.0219, GNorm = 3.2248, lr_0 = 2.8277e-04
Validation rmse = 0.754287
Epoch 17
Loss = 2.3342e-03, PNorm = 43.0311, GNorm = 1.9811, lr_0 = 2.7272e-04
Loss = 2.0493e-03, PNorm = 43.0368, GNorm = 3.1378, lr_0 = 2.6389e-04
Loss = 2.2777e-03, PNorm = 43.0427, GNorm = 0.6728, lr_0 = 2.5535e-04
Validation rmse = 0.701069
Epoch 18
Loss = 1.9148e-03, PNorm = 43.0481, GNorm = 2.6808, lr_0 = 2.4709e-04
Loss = 2.5741e-03, PNorm = 43.0533, GNorm = 2.1631, lr_0 = 2.3910e-04
Loss = 1.9924e-03, PNorm = 43.0593, GNorm = 0.7804, lr_0 = 2.3136e-04
Validation rmse = 0.691848
Epoch 19
Loss = 2.4438e-03, PNorm = 43.0637, GNorm = 1.4057, lr_0 = 2.2387e-04
Loss = 1.8920e-03, PNorm = 43.0683, GNorm = 1.7740, lr_0 = 2.1663e-04
Validation rmse = 0.683579
Epoch 20
Loss = 2.3431e-03, PNorm = 43.0720, GNorm = 1.4655, lr_0 = 2.0962e-04
Loss = 2.2947e-03, PNorm = 43.0756, GNorm = 1.3223, lr_0 = 2.0283e-04
Loss = 2.3550e-03, PNorm = 43.0791, GNorm = 1.1954, lr_0 = 1.9627e-04
Validation rmse = 0.677756
Epoch 21
Loss = 2.2187e-03, PNorm = 43.0828, GNorm = 0.7068, lr_0 = 1.8992e-04
Loss = 2.4829e-03, PNorm = 43.0872, GNorm = 1.4221, lr_0 = 1.8377e-04
Validation rmse = 0.666418
Epoch 22
Loss = 3.0080e-03, PNorm = 43.0907, GNorm = 3.1717, lr_0 = 1.7783e-04
Loss = 2.1649e-03, PNorm = 43.0955, GNorm = 2.6747, lr_0 = 1.7207e-04
Loss = 1.7573e-03, PNorm = 43.0984, GNorm = 2.2647, lr_0 = 1.6651e-04
Validation rmse = 0.695021
Epoch 23
Loss = 2.2497e-03, PNorm = 43.1023, GNorm = 0.9090, lr_0 = 1.6059e-04
Loss = 2.0150e-03, PNorm = 43.1052, GNorm = 1.0240, lr_0 = 1.5539e-04
Validation rmse = 0.687657
Epoch 24
Loss = 2.0448e-03, PNorm = 43.1081, GNorm = 1.6835, lr_0 = 1.5036e-04
Loss = 2.0923e-03, PNorm = 43.1126, GNorm = 1.0798, lr_0 = 1.4550e-04
Loss = 1.8110e-03, PNorm = 43.1143, GNorm = 0.9489, lr_0 = 1.4079e-04
Validation rmse = 0.684683
Epoch 25
Loss = 2.1089e-03, PNorm = 43.1174, GNorm = 0.7806, lr_0 = 1.3623e-04
Loss = 2.0769e-03, PNorm = 43.1204, GNorm = 1.3548, lr_0 = 1.3183e-04
Loss = 2.0409e-03, PNorm = 43.1226, GNorm = 1.2150, lr_0 = 1.2756e-04
Validation rmse = 0.670734
Epoch 26
Loss = 2.1648e-03, PNorm = 43.1255, GNorm = 1.0025, lr_0 = 1.2343e-04
Loss = 1.9042e-03, PNorm = 43.1273, GNorm = 1.0322, lr_0 = 1.1944e-04
Validation rmse = 0.669061
Epoch 27
Loss = 1.4903e-03, PNorm = 43.1296, GNorm = 0.8932, lr_0 = 1.1557e-04
Loss = 2.0241e-03, PNorm = 43.1326, GNorm = 0.8432, lr_0 = 1.1183e-04
Loss = 1.8242e-03, PNorm = 43.1343, GNorm = 2.6993, lr_0 = 1.0821e-04
Validation rmse = 0.661421
Epoch 28
Loss = 2.0987e-03, PNorm = 43.1365, GNorm = 2.1664, lr_0 = 1.0437e-04
Loss = 2.1677e-03, PNorm = 43.1376, GNorm = 2.5436, lr_0 = 1.0099e-04
Validation rmse = 0.689598
Epoch 29
Loss = 1.2613e-03, PNorm = 43.1395, GNorm = 1.2087, lr_0 = 1.0000e-04
Loss = 1.6449e-03, PNorm = 43.1412, GNorm = 0.6487, lr_0 = 1.0000e-04
Loss = 2.1379e-03, PNorm = 43.1420, GNorm = 1.0404, lr_0 = 1.0000e-04
Validation rmse = 0.655907
Model 0 best validation rmse = 0.655907 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.873153
Ensemble test rmse = 0.873153
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 891,501
Moving model to cuda
Epoch 0
Loss = 1.8452e-02, PNorm = 42.2766, GNorm = 4.4680, lr_0 = 2.9800e-04
Loss = 1.6240e-02, PNorm = 42.2916, GNorm = 4.0182, lr_0 = 4.7800e-04
Validation rmse = 2.075140
Epoch 1
Loss = 1.0753e-02, PNorm = 42.3250, GNorm = 4.7471, lr_0 = 6.7600e-04
Loss = 1.0149e-02, PNorm = 42.3609, GNorm = 2.2614, lr_0 = 8.5600e-04
Loss = 9.1340e-03, PNorm = 42.4049, GNorm = 5.1791, lr_0 = 9.9344e-04
Validation rmse = 1.502890
Epoch 2
Loss = 7.8155e-03, PNorm = 42.4484, GNorm = 1.7580, lr_0 = 9.6130e-04
Loss = 6.6928e-03, PNorm = 42.4820, GNorm = 4.8420, lr_0 = 9.3019e-04
Validation rmse = 1.194388
Epoch 3
Loss = 5.0332e-03, PNorm = 42.5144, GNorm = 2.7757, lr_0 = 9.0009e-04
Loss = 6.0911e-03, PNorm = 42.5404, GNorm = 9.4058, lr_0 = 8.7096e-04
Loss = 4.5396e-03, PNorm = 42.5689, GNorm = 2.3973, lr_0 = 8.4278e-04
Validation rmse = 1.109206
Epoch 4
Loss = 4.3659e-03, PNorm = 42.5958, GNorm = 5.1312, lr_0 = 8.1551e-04
Loss = 5.0482e-03, PNorm = 42.6190, GNorm = 3.1869, lr_0 = 7.8912e-04
Validation rmse = 1.003680
Epoch 5
Loss = 5.0998e-03, PNorm = 42.6445, GNorm = 2.1581, lr_0 = 7.6358e-04
Loss = 4.4510e-03, PNorm = 42.6671, GNorm = 1.8314, lr_0 = 7.3888e-04
Loss = 3.8775e-03, PNorm = 42.6886, GNorm = 2.1798, lr_0 = 7.1497e-04
Validation rmse = 0.925700
Epoch 6
Loss = 3.5348e-03, PNorm = 42.7044, GNorm = 2.1491, lr_0 = 6.8956e-04
Loss = 3.7272e-03, PNorm = 42.7236, GNorm = 4.4472, lr_0 = 6.6725e-04
Loss = 3.8407e-03, PNorm = 42.7416, GNorm = 7.6711, lr_0 = 6.4565e-04
Validation rmse = 1.122908
Epoch 7
Loss = 3.7313e-03, PNorm = 42.7578, GNorm = 0.9131, lr_0 = 6.2476e-04
Loss = 3.6804e-03, PNorm = 42.7772, GNorm = 6.3019, lr_0 = 6.0454e-04
Validation rmse = 1.104284
Epoch 8
Loss = 3.9675e-03, PNorm = 42.7887, GNorm = 5.9423, lr_0 = 5.8498e-04
Loss = 3.6032e-03, PNorm = 42.8082, GNorm = 4.9542, lr_0 = 5.6605e-04
Loss = 3.2553e-03, PNorm = 42.8230, GNorm = 1.2171, lr_0 = 5.4774e-04
Validation rmse = 0.882097
Epoch 9
Loss = 3.1438e-03, PNorm = 42.8367, GNorm = 1.6641, lr_0 = 5.3001e-04
Loss = 3.0097e-03, PNorm = 42.8500, GNorm = 2.4319, lr_0 = 5.1286e-04
Validation rmse = 0.919207
Epoch 10
Loss = 2.7699e-03, PNorm = 42.8615, GNorm = 1.8088, lr_0 = 4.9627e-04
Loss = 2.9911e-03, PNorm = 42.8720, GNorm = 2.0584, lr_0 = 4.8021e-04
Loss = 2.7164e-03, PNorm = 42.8853, GNorm = 2.1778, lr_0 = 4.6467e-04
Validation rmse = 0.863280
Epoch 11
Loss = 2.4734e-03, PNorm = 42.8930, GNorm = 2.0215, lr_0 = 4.4963e-04
Loss = 3.2143e-03, PNorm = 42.9031, GNorm = 1.6892, lr_0 = 4.3508e-04
Validation rmse = 0.862738
Epoch 12
Loss = 3.0312e-03, PNorm = 42.9130, GNorm = 0.9718, lr_0 = 4.1962e-04
Loss = 2.3519e-03, PNorm = 42.9234, GNorm = 2.0519, lr_0 = 4.0604e-04
Loss = 2.4088e-03, PNorm = 42.9311, GNorm = 0.7309, lr_0 = 3.9290e-04
Validation rmse = 0.852700
Epoch 13
Loss = 2.4123e-03, PNorm = 42.9407, GNorm = 3.6852, lr_0 = 3.8019e-04
Loss = 2.7076e-03, PNorm = 42.9495, GNorm = 1.2511, lr_0 = 3.6789e-04
Loss = 2.3402e-03, PNorm = 42.9576, GNorm = 0.8174, lr_0 = 3.5598e-04
Validation rmse = 0.877930
Epoch 14
Loss = 2.3047e-03, PNorm = 42.9659, GNorm = 2.6916, lr_0 = 3.4446e-04
Loss = 2.4052e-03, PNorm = 42.9716, GNorm = 3.5803, lr_0 = 3.3332e-04
Validation rmse = 0.845171
Epoch 15
Loss = 1.8167e-03, PNorm = 42.9787, GNorm = 1.3412, lr_0 = 3.2253e-04
Loss = 2.4686e-03, PNorm = 42.9859, GNorm = 1.1989, lr_0 = 3.1209e-04
Loss = 2.1522e-03, PNorm = 42.9930, GNorm = 0.9122, lr_0 = 3.0200e-04
Validation rmse = 0.826690
Epoch 16
Loss = 2.3841e-03, PNorm = 42.9991, GNorm = 1.0888, lr_0 = 2.9222e-04
Loss = 2.4974e-03, PNorm = 43.0074, GNorm = 4.1846, lr_0 = 2.8277e-04
Validation rmse = 0.798593
Epoch 17
Loss = 2.4830e-03, PNorm = 43.0138, GNorm = 3.7922, lr_0 = 2.7272e-04
Loss = 2.4356e-03, PNorm = 43.0205, GNorm = 3.3197, lr_0 = 2.6389e-04
Loss = 2.2780e-03, PNorm = 43.0241, GNorm = 1.0659, lr_0 = 2.5535e-04
Validation rmse = 0.851533
Epoch 18
Loss = 2.1502e-03, PNorm = 43.0302, GNorm = 2.2215, lr_0 = 2.4709e-04
Loss = 2.2975e-03, PNorm = 43.0357, GNorm = 4.3400, lr_0 = 2.3910e-04
Loss = 2.2308e-03, PNorm = 43.0410, GNorm = 2.9253, lr_0 = 2.3136e-04
Validation rmse = 0.816381
Epoch 19
Loss = 2.2941e-03, PNorm = 43.0456, GNorm = 3.6352, lr_0 = 2.2387e-04
Loss = 2.1513e-03, PNorm = 43.0494, GNorm = 2.5248, lr_0 = 2.1663e-04
Validation rmse = 0.879892
Epoch 20
Loss = 1.6492e-03, PNorm = 43.0545, GNorm = 1.3832, lr_0 = 2.0962e-04
Loss = 2.3446e-03, PNorm = 43.0604, GNorm = 1.2298, lr_0 = 2.0283e-04
Loss = 2.1093e-03, PNorm = 43.0631, GNorm = 2.4303, lr_0 = 1.9627e-04
Validation rmse = 0.859469
Epoch 21
Loss = 2.1569e-03, PNorm = 43.0661, GNorm = 0.9891, lr_0 = 1.8992e-04
Loss = 2.0845e-03, PNorm = 43.0706, GNorm = 1.3579, lr_0 = 1.8377e-04
Validation rmse = 0.814806
Epoch 22
Loss = 2.0221e-03, PNorm = 43.0750, GNorm = 0.6368, lr_0 = 1.7783e-04
Loss = 1.5808e-03, PNorm = 43.0780, GNorm = 0.4886, lr_0 = 1.7207e-04
Loss = 2.2066e-03, PNorm = 43.0815, GNorm = 0.8603, lr_0 = 1.6651e-04
Validation rmse = 0.780459
Epoch 23
Loss = 2.0093e-03, PNorm = 43.0847, GNorm = 0.9514, lr_0 = 1.6059e-04
Loss = 1.4857e-03, PNorm = 43.0867, GNorm = 0.9366, lr_0 = 1.5539e-04
Validation rmse = 0.782306
Epoch 24
Loss = 2.0025e-03, PNorm = 43.0900, GNorm = 1.4977, lr_0 = 1.5036e-04
Loss = 2.0621e-03, PNorm = 43.0912, GNorm = 3.1950, lr_0 = 1.4550e-04
Loss = 2.1450e-03, PNorm = 43.0935, GNorm = 1.0995, lr_0 = 1.4079e-04
Validation rmse = 0.806781
Epoch 25
Loss = 2.0954e-03, PNorm = 43.0969, GNorm = 3.1257, lr_0 = 1.3623e-04
Loss = 2.0217e-03, PNorm = 43.1010, GNorm = 3.0162, lr_0 = 1.3183e-04
Loss = 1.7931e-03, PNorm = 43.1031, GNorm = 1.1724, lr_0 = 1.2756e-04
Validation rmse = 0.781075
Epoch 26
Loss = 1.6888e-03, PNorm = 43.1043, GNorm = 0.8098, lr_0 = 1.2343e-04
Loss = 1.9423e-03, PNorm = 43.1063, GNorm = 1.4400, lr_0 = 1.1944e-04
Validation rmse = 0.803413
Epoch 27
Loss = 1.6468e-03, PNorm = 43.1084, GNorm = 0.6448, lr_0 = 1.1557e-04
Loss = 1.6125e-03, PNorm = 43.1104, GNorm = 1.3122, lr_0 = 1.1183e-04
Loss = 1.8271e-03, PNorm = 43.1126, GNorm = 2.4269, lr_0 = 1.0821e-04
Validation rmse = 0.782430
Epoch 28
Loss = 1.7238e-03, PNorm = 43.1152, GNorm = 1.8358, lr_0 = 1.0437e-04
Loss = 1.9815e-03, PNorm = 43.1164, GNorm = 1.7875, lr_0 = 1.0099e-04
Validation rmse = 0.790724
Epoch 29
Loss = 2.5484e-03, PNorm = 43.1175, GNorm = 0.8426, lr_0 = 1.0000e-04
Loss = 1.9326e-03, PNorm = 43.1193, GNorm = 2.1012, lr_0 = 1.0000e-04
Loss = 1.6507e-03, PNorm = 43.1220, GNorm = 1.6918, lr_0 = 1.0000e-04
Validation rmse = 0.787177
Model 0 best validation rmse = 0.780459 on epoch 22
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.084035
Ensemble test rmse = 1.084035
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 891,501
Moving model to cuda
Epoch 0
Loss = 1.9850e-02, PNorm = 42.2763, GNorm = 3.5025, lr_0 = 2.9800e-04
Loss = 1.5134e-02, PNorm = 42.2909, GNorm = 4.4066, lr_0 = 4.7800e-04
Validation rmse = 1.684506
Epoch 1
Loss = 9.5199e-03, PNorm = 42.3190, GNorm = 4.0943, lr_0 = 6.7600e-04
Loss = 8.9464e-03, PNorm = 42.3588, GNorm = 1.9183, lr_0 = 8.5600e-04
Loss = 1.0996e-02, PNorm = 42.3975, GNorm = 9.1301, lr_0 = 9.9344e-04
Validation rmse = 1.713530
Epoch 2
Loss = 8.3327e-03, PNorm = 42.4406, GNorm = 4.1803, lr_0 = 9.6130e-04
Loss = 7.7917e-03, PNorm = 42.4780, GNorm = 2.1297, lr_0 = 9.3019e-04
Validation rmse = 1.354163
Epoch 3
Loss = 6.1307e-03, PNorm = 42.5087, GNorm = 2.4841, lr_0 = 9.0009e-04
Loss = 5.7269e-03, PNorm = 42.5397, GNorm = 2.9944, lr_0 = 8.7096e-04
Loss = 5.6392e-03, PNorm = 42.5632, GNorm = 5.3556, lr_0 = 8.4278e-04
Validation rmse = 1.102988
Epoch 4
Loss = 4.5018e-03, PNorm = 42.5951, GNorm = 3.2787, lr_0 = 8.1551e-04
Loss = 5.1010e-03, PNorm = 42.6136, GNorm = 7.2444, lr_0 = 7.8912e-04
Validation rmse = 1.064404
Epoch 5
Loss = 3.8227e-03, PNorm = 42.6381, GNorm = 1.8251, lr_0 = 7.6358e-04
Loss = 4.1488e-03, PNorm = 42.6543, GNorm = 3.8108, lr_0 = 7.3888e-04
Loss = 4.3498e-03, PNorm = 42.6738, GNorm = 1.6335, lr_0 = 7.1497e-04
Validation rmse = 1.067307
Epoch 6
Loss = 4.1663e-03, PNorm = 42.6972, GNorm = 2.2117, lr_0 = 6.8956e-04
Loss = 5.0559e-03, PNorm = 42.7166, GNorm = 2.3210, lr_0 = 6.6725e-04
Loss = 3.4569e-03, PNorm = 42.7338, GNorm = 1.2012, lr_0 = 6.4565e-04
Validation rmse = 1.046958
Epoch 7
Loss = 3.0811e-03, PNorm = 42.7485, GNorm = 2.3142, lr_0 = 6.2476e-04
Loss = 3.7855e-03, PNorm = 42.7621, GNorm = 2.8215, lr_0 = 6.0454e-04
Validation rmse = 1.141485
Epoch 8
Loss = 3.7436e-03, PNorm = 42.7759, GNorm = 2.7881, lr_0 = 5.8498e-04
Loss = 3.6341e-03, PNorm = 42.7934, GNorm = 2.7113, lr_0 = 5.6605e-04
Loss = 3.2735e-03, PNorm = 42.8072, GNorm = 1.1136, lr_0 = 5.4774e-04
Validation rmse = 1.060775
Epoch 9
Loss = 3.1146e-03, PNorm = 42.8189, GNorm = 2.0127, lr_0 = 5.3001e-04
Loss = 3.2855e-03, PNorm = 42.8304, GNorm = 3.5319, lr_0 = 5.1286e-04
Validation rmse = 0.974478
Epoch 10
Loss = 2.2949e-03, PNorm = 42.8439, GNorm = 1.6447, lr_0 = 4.9627e-04
Loss = 2.7252e-03, PNorm = 42.8543, GNorm = 1.7790, lr_0 = 4.8021e-04
Loss = 3.4650e-03, PNorm = 42.8687, GNorm = 4.4316, lr_0 = 4.6467e-04
Validation rmse = 1.049846
Epoch 11
Loss = 3.1260e-03, PNorm = 42.8803, GNorm = 2.3358, lr_0 = 4.4963e-04
Loss = 3.0580e-03, PNorm = 42.8916, GNorm = 1.0203, lr_0 = 4.3508e-04
Validation rmse = 0.991851
Epoch 12
Loss = 2.8085e-03, PNorm = 42.9010, GNorm = 1.7103, lr_0 = 4.1962e-04
Loss = 2.5042e-03, PNorm = 42.9085, GNorm = 0.7944, lr_0 = 4.0604e-04
Loss = 2.5113e-03, PNorm = 42.9175, GNorm = 0.7947, lr_0 = 3.9290e-04
Validation rmse = 1.159995
Epoch 13
Loss = 3.1880e-03, PNorm = 42.9267, GNorm = 9.0418, lr_0 = 3.8019e-04
Loss = 2.6406e-03, PNorm = 42.9343, GNorm = 1.3315, lr_0 = 3.6789e-04
Loss = 3.4373e-03, PNorm = 42.9435, GNorm = 3.0948, lr_0 = 3.5598e-04
Validation rmse = 1.142476
Epoch 14
Loss = 2.7936e-03, PNorm = 42.9514, GNorm = 1.1936, lr_0 = 3.4446e-04
Loss = 2.6858e-03, PNorm = 42.9597, GNorm = 2.6598, lr_0 = 3.3332e-04
Validation rmse = 1.033848
Epoch 15
Loss = 3.1266e-03, PNorm = 42.9683, GNorm = 1.8937, lr_0 = 3.2253e-04
Loss = 2.4025e-03, PNorm = 42.9741, GNorm = 0.9680, lr_0 = 3.1209e-04
Loss = 2.2693e-03, PNorm = 42.9820, GNorm = 1.4124, lr_0 = 3.0200e-04
Validation rmse = 0.959270
Epoch 16
Loss = 2.5706e-03, PNorm = 42.9892, GNorm = 1.1983, lr_0 = 2.9222e-04
Loss = 2.1402e-03, PNorm = 42.9952, GNorm = 4.1796, lr_0 = 2.8277e-04
Validation rmse = 1.011715
Epoch 17
Loss = 2.5080e-03, PNorm = 43.0010, GNorm = 0.7411, lr_0 = 2.7272e-04
Loss = 2.5152e-03, PNorm = 43.0082, GNorm = 1.2881, lr_0 = 2.6389e-04
Loss = 2.1134e-03, PNorm = 43.0136, GNorm = 1.6950, lr_0 = 2.5535e-04
Validation rmse = 0.941762
Epoch 18
Loss = 2.2211e-03, PNorm = 43.0185, GNorm = 0.9160, lr_0 = 2.4709e-04
Loss = 2.2156e-03, PNorm = 43.0239, GNorm = 1.5811, lr_0 = 2.3910e-04
Loss = 2.2267e-03, PNorm = 43.0285, GNorm = 1.6089, lr_0 = 2.3136e-04
Validation rmse = 0.924777
Epoch 19
Loss = 2.1833e-03, PNorm = 43.0341, GNorm = 1.5028, lr_0 = 2.2387e-04
Loss = 2.4838e-03, PNorm = 43.0383, GNorm = 1.8049, lr_0 = 2.1663e-04
Validation rmse = 0.974285
Epoch 20
Loss = 2.2727e-03, PNorm = 43.0431, GNorm = 4.5380, lr_0 = 2.0962e-04
Loss = 2.2586e-03, PNorm = 43.0486, GNorm = 2.0753, lr_0 = 2.0283e-04
Loss = 2.3147e-03, PNorm = 43.0535, GNorm = 1.9428, lr_0 = 1.9627e-04
Validation rmse = 0.934836
Epoch 21
Loss = 2.3151e-03, PNorm = 43.0565, GNorm = 1.0121, lr_0 = 1.8992e-04
Loss = 1.9865e-03, PNorm = 43.0593, GNorm = 1.5900, lr_0 = 1.8377e-04
Validation rmse = 0.946629
Epoch 22
Loss = 2.9589e-03, PNorm = 43.0633, GNorm = 1.0078, lr_0 = 1.7783e-04
Loss = 1.7438e-03, PNorm = 43.0665, GNorm = 1.7195, lr_0 = 1.7207e-04
Loss = 2.3794e-03, PNorm = 43.0695, GNorm = 2.1976, lr_0 = 1.6651e-04
Validation rmse = 0.960880
Epoch 23
Loss = 2.0905e-03, PNorm = 43.0743, GNorm = 1.4545, lr_0 = 1.6059e-04
Loss = 2.1513e-03, PNorm = 43.0774, GNorm = 0.8663, lr_0 = 1.5539e-04
Validation rmse = 0.947252
Epoch 24
Loss = 2.0654e-03, PNorm = 43.0803, GNorm = 1.2381, lr_0 = 1.5036e-04
Loss = 2.0816e-03, PNorm = 43.0841, GNorm = 0.6490, lr_0 = 1.4550e-04
Loss = 2.0922e-03, PNorm = 43.0878, GNorm = 1.7650, lr_0 = 1.4079e-04
Validation rmse = 0.956285
Epoch 25
Loss = 1.9382e-03, PNorm = 43.0901, GNorm = 1.8214, lr_0 = 1.3623e-04
Loss = 2.2483e-03, PNorm = 43.0939, GNorm = 0.7762, lr_0 = 1.3183e-04
Loss = 1.8943e-03, PNorm = 43.0959, GNorm = 1.0625, lr_0 = 1.2756e-04
Validation rmse = 0.934722
Epoch 26
Loss = 1.9647e-03, PNorm = 43.0987, GNorm = 1.8642, lr_0 = 1.2343e-04
Loss = 2.0004e-03, PNorm = 43.1022, GNorm = 2.3330, lr_0 = 1.1944e-04
Validation rmse = 0.942410
Epoch 27
Loss = 2.2869e-03, PNorm = 43.1046, GNorm = 3.6317, lr_0 = 1.1557e-04
Loss = 1.7372e-03, PNorm = 43.1071, GNorm = 1.1532, lr_0 = 1.1183e-04
Loss = 2.1050e-03, PNorm = 43.1091, GNorm = 2.8748, lr_0 = 1.0821e-04
Validation rmse = 0.940682
Epoch 28
Loss = 2.0664e-03, PNorm = 43.1114, GNorm = 1.2415, lr_0 = 1.0437e-04
Loss = 1.8253e-03, PNorm = 43.1140, GNorm = 0.7007, lr_0 = 1.0099e-04
Validation rmse = 0.922163
Epoch 29
Loss = 1.3803e-03, PNorm = 43.1156, GNorm = 1.2116, lr_0 = 1.0000e-04
Loss = 2.0257e-03, PNorm = 43.1174, GNorm = 1.2089, lr_0 = 1.0000e-04
Loss = 1.9467e-03, PNorm = 43.1199, GNorm = 2.8948, lr_0 = 1.0000e-04
Validation rmse = 0.907513
Model 0 best validation rmse = 0.907513 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.672589
Ensemble test rmse = 0.672589
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 891,501
Moving model to cuda
Epoch 0
Loss = 1.8671e-02, PNorm = 42.2755, GNorm = 3.5532, lr_0 = 2.9800e-04
Loss = 1.5629e-02, PNorm = 42.2892, GNorm = 12.2114, lr_0 = 4.7800e-04
Validation rmse = 2.022318
Epoch 1
Loss = 1.4111e-02, PNorm = 42.3179, GNorm = 7.3017, lr_0 = 6.7600e-04
Loss = 1.2337e-02, PNorm = 42.3552, GNorm = 6.4587, lr_0 = 8.5600e-04
Loss = 8.4801e-03, PNorm = 42.3986, GNorm = 1.5142, lr_0 = 9.9344e-04
Validation rmse = 1.755530
Epoch 2
Loss = 7.0466e-03, PNorm = 42.4458, GNorm = 1.8904, lr_0 = 9.6130e-04
Loss = 7.5333e-03, PNorm = 42.4721, GNorm = 4.3989, lr_0 = 9.3019e-04
Validation rmse = 1.399337
Epoch 3
Loss = 6.1455e-03, PNorm = 42.5129, GNorm = 3.1450, lr_0 = 9.0009e-04
Loss = 5.8112e-03, PNorm = 42.5406, GNorm = 4.2604, lr_0 = 8.7096e-04
Loss = 4.9601e-03, PNorm = 42.5682, GNorm = 4.3635, lr_0 = 8.4278e-04
Validation rmse = 1.265416
Epoch 4
Loss = 5.2337e-03, PNorm = 42.5955, GNorm = 4.7687, lr_0 = 8.1551e-04
Loss = 6.7091e-03, PNorm = 42.6220, GNorm = 4.2830, lr_0 = 7.8912e-04
Validation rmse = 1.315648
Epoch 5
Loss = 4.0861e-03, PNorm = 42.6521, GNorm = 2.3165, lr_0 = 7.6358e-04
Loss = 5.4186e-03, PNorm = 42.6746, GNorm = 2.6376, lr_0 = 7.3888e-04
Loss = 4.7641e-03, PNorm = 42.7001, GNorm = 1.3171, lr_0 = 7.1497e-04
Validation rmse = 1.128769
Epoch 6
Loss = 3.4196e-03, PNorm = 42.7223, GNorm = 1.2896, lr_0 = 6.8956e-04
Loss = 3.7084e-03, PNorm = 42.7410, GNorm = 3.0700, lr_0 = 6.6725e-04
Loss = 4.8696e-03, PNorm = 42.7550, GNorm = 0.8999, lr_0 = 6.4565e-04
Validation rmse = 1.272667
Epoch 7
Loss = 4.5613e-03, PNorm = 42.7748, GNorm = 4.1753, lr_0 = 6.2476e-04
Loss = 3.6807e-03, PNorm = 42.7926, GNorm = 4.1107, lr_0 = 6.0454e-04
Validation rmse = 1.140962
Epoch 8
Loss = 3.2901e-03, PNorm = 42.8098, GNorm = 1.5042, lr_0 = 5.8498e-04
Loss = 3.1111e-03, PNorm = 42.8251, GNorm = 1.5245, lr_0 = 5.6605e-04
Loss = 3.2767e-03, PNorm = 42.8374, GNorm = 0.8749, lr_0 = 5.4774e-04
Validation rmse = 1.051605
Epoch 9
Loss = 3.4433e-03, PNorm = 42.8503, GNorm = 4.1688, lr_0 = 5.3001e-04
Loss = 3.1473e-03, PNorm = 42.8645, GNorm = 1.6468, lr_0 = 5.1286e-04
Validation rmse = 1.051154
Epoch 10
Loss = 3.4547e-03, PNorm = 42.8774, GNorm = 2.4823, lr_0 = 4.9627e-04
Loss = 3.5710e-03, PNorm = 42.8907, GNorm = 1.5059, lr_0 = 4.8021e-04
Loss = 2.6319e-03, PNorm = 42.9044, GNorm = 2.7989, lr_0 = 4.6467e-04
Validation rmse = 1.016431
Epoch 11
Loss = 3.4199e-03, PNorm = 42.9156, GNorm = 1.5717, lr_0 = 4.4963e-04
Loss = 3.0333e-03, PNorm = 42.9239, GNorm = 3.3107, lr_0 = 4.3508e-04
Validation rmse = 1.018183
Epoch 12
Loss = 2.4472e-03, PNorm = 42.9372, GNorm = 1.0294, lr_0 = 4.1962e-04
Loss = 2.6657e-03, PNorm = 42.9491, GNorm = 3.3015, lr_0 = 4.0604e-04
Loss = 2.9645e-03, PNorm = 42.9594, GNorm = 2.6244, lr_0 = 3.9290e-04
Validation rmse = 1.004639
Epoch 13
Loss = 2.5380e-03, PNorm = 42.9725, GNorm = 2.4276, lr_0 = 3.8019e-04
Loss = 2.6738e-03, PNorm = 42.9819, GNorm = 2.9587, lr_0 = 3.6789e-04
Loss = 2.6306e-03, PNorm = 42.9888, GNorm = 2.5628, lr_0 = 3.5598e-04
Validation rmse = 0.989952
Epoch 14
Loss = 2.7530e-03, PNorm = 42.9965, GNorm = 1.1380, lr_0 = 3.4446e-04
Loss = 2.2028e-03, PNorm = 43.0035, GNorm = 2.8929, lr_0 = 3.3332e-04
Validation rmse = 1.011303
Epoch 15
Loss = 1.7959e-03, PNorm = 43.0114, GNorm = 0.9368, lr_0 = 3.2253e-04
Loss = 2.6058e-03, PNorm = 43.0198, GNorm = 1.1053, lr_0 = 3.1209e-04
Loss = 2.6999e-03, PNorm = 43.0268, GNorm = 3.6690, lr_0 = 3.0200e-04
Validation rmse = 1.045737
Epoch 16
Loss = 2.2469e-03, PNorm = 43.0332, GNorm = 2.0674, lr_0 = 2.9222e-04
Loss = 2.2679e-03, PNorm = 43.0393, GNorm = 1.1112, lr_0 = 2.8277e-04
Validation rmse = 0.969829
Epoch 17
Loss = 2.2094e-03, PNorm = 43.0468, GNorm = 0.8087, lr_0 = 2.7272e-04
Loss = 2.1328e-03, PNorm = 43.0538, GNorm = 1.6256, lr_0 = 2.6389e-04
Loss = 2.2130e-03, PNorm = 43.0585, GNorm = 3.8419, lr_0 = 2.5535e-04
Validation rmse = 0.975342
Epoch 18
Loss = 2.4911e-03, PNorm = 43.0643, GNorm = 0.8079, lr_0 = 2.4709e-04
Loss = 1.8387e-03, PNorm = 43.0699, GNorm = 1.5190, lr_0 = 2.3910e-04
Loss = 2.1903e-03, PNorm = 43.0757, GNorm = 0.9995, lr_0 = 2.3136e-04
Validation rmse = 1.029519
Epoch 19
Loss = 2.3137e-03, PNorm = 43.0792, GNorm = 0.8647, lr_0 = 2.2387e-04
Loss = 2.1462e-03, PNorm = 43.0837, GNorm = 1.4554, lr_0 = 2.1663e-04
Validation rmse = 0.968326
Epoch 20
Loss = 1.8214e-03, PNorm = 43.0895, GNorm = 0.7017, lr_0 = 2.0962e-04
Loss = 2.2195e-03, PNorm = 43.0949, GNorm = 1.4104, lr_0 = 2.0283e-04
Loss = 1.9847e-03, PNorm = 43.0987, GNorm = 1.1623, lr_0 = 1.9627e-04
Validation rmse = 0.969743
Epoch 21
Loss = 1.7847e-03, PNorm = 43.1025, GNorm = 2.2263, lr_0 = 1.8992e-04
Loss = 1.9793e-03, PNorm = 43.1050, GNorm = 1.5077, lr_0 = 1.8377e-04
Validation rmse = 0.959669
Epoch 22
Loss = 1.9321e-03, PNorm = 43.1074, GNorm = 1.6456, lr_0 = 1.7783e-04
Loss = 1.9647e-03, PNorm = 43.1121, GNorm = 2.3544, lr_0 = 1.7207e-04
Loss = 2.1345e-03, PNorm = 43.1162, GNorm = 1.4066, lr_0 = 1.6651e-04
Validation rmse = 0.976045
Epoch 23
Loss = 1.8276e-03, PNorm = 43.1203, GNorm = 1.7126, lr_0 = 1.6059e-04
Loss = 2.0611e-03, PNorm = 43.1226, GNorm = 1.5206, lr_0 = 1.5539e-04
Validation rmse = 0.963824
Epoch 24
Loss = 1.2069e-03, PNorm = 43.1273, GNorm = 0.8331, lr_0 = 1.5036e-04
Loss = 1.9337e-03, PNorm = 43.1303, GNorm = 1.2616, lr_0 = 1.4550e-04
Loss = 2.1143e-03, PNorm = 43.1335, GNorm = 1.0780, lr_0 = 1.4079e-04
Validation rmse = 0.970553
Epoch 25
Loss = 2.2031e-03, PNorm = 43.1354, GNorm = 0.9375, lr_0 = 1.3623e-04
Loss = 1.4881e-03, PNorm = 43.1376, GNorm = 0.5979, lr_0 = 1.3183e-04
Loss = 1.9704e-03, PNorm = 43.1401, GNorm = 1.4277, lr_0 = 1.2756e-04
Validation rmse = 0.971203
Epoch 26
Loss = 1.7393e-03, PNorm = 43.1428, GNorm = 0.7865, lr_0 = 1.2343e-04
Loss = 1.7732e-03, PNorm = 43.1450, GNorm = 1.7455, lr_0 = 1.1944e-04
Validation rmse = 0.968937
Epoch 27
Loss = 1.4791e-03, PNorm = 43.1473, GNorm = 2.5840, lr_0 = 1.1557e-04
Loss = 1.7972e-03, PNorm = 43.1495, GNorm = 1.4225, lr_0 = 1.1183e-04
Loss = 1.8168e-03, PNorm = 43.1511, GNorm = 0.9472, lr_0 = 1.0821e-04
Validation rmse = 0.959959
Epoch 28
Loss = 1.9162e-03, PNorm = 43.1531, GNorm = 0.9675, lr_0 = 1.0437e-04
Loss = 1.9244e-03, PNorm = 43.1547, GNorm = 3.2566, lr_0 = 1.0099e-04
Validation rmse = 0.954880
Epoch 29
Loss = 1.8156e-03, PNorm = 43.1572, GNorm = 1.5259, lr_0 = 1.0000e-04
Loss = 1.6158e-03, PNorm = 43.1590, GNorm = 1.0101, lr_0 = 1.0000e-04
Loss = 1.9795e-03, PNorm = 43.1603, GNorm = 0.8820, lr_0 = 1.0000e-04
Validation rmse = 0.947070
Model 0 best validation rmse = 0.947070 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.779354
Ensemble test rmse = 0.779354
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 891,501
Moving model to cuda
Epoch 0
Loss = 1.7901e-02, PNorm = 42.2762, GNorm = 4.8523, lr_0 = 2.9800e-04
Loss = 1.4738e-02, PNorm = 42.2909, GNorm = 11.0726, lr_0 = 4.7800e-04
Validation rmse = 1.481858
Epoch 1
Loss = 1.0596e-02, PNorm = 42.3184, GNorm = 5.5453, lr_0 = 6.7600e-04
Loss = 1.0178e-02, PNorm = 42.3557, GNorm = 8.8142, lr_0 = 8.5600e-04
Loss = 8.8127e-03, PNorm = 42.4019, GNorm = 10.3072, lr_0 = 9.9344e-04
Validation rmse = 1.358061
Epoch 2
Loss = 8.0835e-03, PNorm = 42.4447, GNorm = 1.8819, lr_0 = 9.6130e-04
Loss = 7.2845e-03, PNorm = 42.4835, GNorm = 8.7155, lr_0 = 9.3019e-04
Validation rmse = 1.417096
Epoch 3
Loss = 6.1403e-03, PNorm = 42.5155, GNorm = 4.6300, lr_0 = 9.0009e-04
Loss = 5.8997e-03, PNorm = 42.5459, GNorm = 4.6193, lr_0 = 8.7096e-04
Loss = 6.3194e-03, PNorm = 42.5741, GNorm = 8.1188, lr_0 = 8.4278e-04
Validation rmse = 1.060290
Epoch 4
Loss = 5.7895e-03, PNorm = 42.6024, GNorm = 1.9402, lr_0 = 8.1551e-04
Loss = 5.6070e-03, PNorm = 42.6320, GNorm = 1.9448, lr_0 = 7.8912e-04
Validation rmse = 1.176916
Epoch 5
Loss = 5.1663e-03, PNorm = 42.6549, GNorm = 3.6883, lr_0 = 7.6358e-04
Loss = 4.5841e-03, PNorm = 42.6818, GNorm = 0.8390, lr_0 = 7.3888e-04
Loss = 4.1241e-03, PNorm = 42.7026, GNorm = 2.5011, lr_0 = 7.1497e-04
Validation rmse = 0.902191
Epoch 6
Loss = 5.4768e-03, PNorm = 42.7210, GNorm = 7.0398, lr_0 = 6.8956e-04
Loss = 4.1246e-03, PNorm = 42.7387, GNorm = 2.1665, lr_0 = 6.6725e-04
Loss = 4.1461e-03, PNorm = 42.7572, GNorm = 3.2425, lr_0 = 6.4565e-04
Validation rmse = 0.827877
Epoch 7
Loss = 3.6513e-03, PNorm = 42.7733, GNorm = 3.2233, lr_0 = 6.2476e-04
Loss = 3.6487e-03, PNorm = 42.7886, GNorm = 1.4838, lr_0 = 6.0454e-04
Validation rmse = 0.839824
Epoch 8
Loss = 2.6318e-03, PNorm = 42.8059, GNorm = 4.7934, lr_0 = 5.8498e-04
Loss = 3.9335e-03, PNorm = 42.8233, GNorm = 2.8926, lr_0 = 5.6605e-04
Loss = 3.2853e-03, PNorm = 42.8389, GNorm = 1.3565, lr_0 = 5.4774e-04
Validation rmse = 0.869838
Epoch 9
Loss = 2.9837e-03, PNorm = 42.8499, GNorm = 1.5188, lr_0 = 5.3001e-04
Loss = 3.5896e-03, PNorm = 42.8650, GNorm = 1.9340, lr_0 = 5.1286e-04
Validation rmse = 0.909642
Epoch 10
Loss = 2.7424e-03, PNorm = 42.8782, GNorm = 1.3709, lr_0 = 4.9627e-04
Loss = 2.7586e-03, PNorm = 42.8913, GNorm = 1.9869, lr_0 = 4.8021e-04
Loss = 2.9904e-03, PNorm = 42.9004, GNorm = 2.9736, lr_0 = 4.6467e-04
Validation rmse = 0.904738
Epoch 11
Loss = 3.3805e-03, PNorm = 42.9123, GNorm = 3.8411, lr_0 = 4.4963e-04
Loss = 2.4450e-03, PNorm = 42.9252, GNorm = 0.9893, lr_0 = 4.3508e-04
Validation rmse = 0.803591
Epoch 12
Loss = 2.2708e-03, PNorm = 42.9357, GNorm = 1.3828, lr_0 = 4.1962e-04
Loss = 2.6488e-03, PNorm = 42.9461, GNorm = 1.1225, lr_0 = 4.0604e-04
Loss = 2.8626e-03, PNorm = 42.9539, GNorm = 1.2760, lr_0 = 3.9290e-04
Validation rmse = 0.881593
Epoch 13
Loss = 2.5973e-03, PNorm = 42.9625, GNorm = 1.5535, lr_0 = 3.8019e-04
Loss = 2.8284e-03, PNorm = 42.9689, GNorm = 4.0827, lr_0 = 3.6789e-04
Loss = 2.8670e-03, PNorm = 42.9783, GNorm = 3.2819, lr_0 = 3.5598e-04
Validation rmse = 0.833249
Epoch 14
Loss = 2.3893e-03, PNorm = 42.9876, GNorm = 1.3829, lr_0 = 3.4446e-04
Loss = 2.5537e-03, PNorm = 42.9969, GNorm = 2.8507, lr_0 = 3.3332e-04
Validation rmse = 0.810425
Epoch 15
Loss = 1.7878e-03, PNorm = 43.0050, GNorm = 2.4050, lr_0 = 3.2253e-04
Loss = 2.7833e-03, PNorm = 43.0149, GNorm = 3.2225, lr_0 = 3.1209e-04
Loss = 2.2921e-03, PNorm = 43.0224, GNorm = 1.1251, lr_0 = 3.0200e-04
Validation rmse = 0.791891
Epoch 16
Loss = 2.2952e-03, PNorm = 43.0302, GNorm = 2.2522, lr_0 = 2.9222e-04
Loss = 2.6047e-03, PNorm = 43.0369, GNorm = 3.9511, lr_0 = 2.8277e-04
Validation rmse = 0.780619
Epoch 17
Loss = 1.7218e-03, PNorm = 43.0425, GNorm = 1.5505, lr_0 = 2.7272e-04
Loss = 2.1371e-03, PNorm = 43.0477, GNorm = 1.8596, lr_0 = 2.6389e-04
Loss = 2.5249e-03, PNorm = 43.0558, GNorm = 2.0105, lr_0 = 2.5535e-04
Validation rmse = 0.825569
Epoch 18
Loss = 1.9199e-03, PNorm = 43.0616, GNorm = 0.8994, lr_0 = 2.4709e-04
Loss = 2.2789e-03, PNorm = 43.0685, GNorm = 2.0626, lr_0 = 2.3910e-04
Loss = 2.2492e-03, PNorm = 43.0717, GNorm = 2.4512, lr_0 = 2.3136e-04
Validation rmse = 0.774272
Epoch 19
Loss = 2.1281e-03, PNorm = 43.0764, GNorm = 2.0191, lr_0 = 2.2387e-04
Loss = 2.2650e-03, PNorm = 43.0816, GNorm = 1.8678, lr_0 = 2.1663e-04
Validation rmse = 0.750117
Epoch 20
Loss = 2.8305e-03, PNorm = 43.0862, GNorm = 2.3838, lr_0 = 2.0962e-04
Loss = 2.1901e-03, PNorm = 43.0907, GNorm = 1.0714, lr_0 = 2.0283e-04
Loss = 1.9795e-03, PNorm = 43.0950, GNorm = 2.0131, lr_0 = 1.9627e-04
Validation rmse = 0.748224
Epoch 21
Loss = 2.0902e-03, PNorm = 43.0997, GNorm = 1.1675, lr_0 = 1.8992e-04
Loss = 2.0039e-03, PNorm = 43.1040, GNorm = 2.3015, lr_0 = 1.8377e-04
Validation rmse = 0.771364
Epoch 22
Loss = 2.2236e-03, PNorm = 43.1084, GNorm = 1.5284, lr_0 = 1.7783e-04
Loss = 1.8916e-03, PNorm = 43.1125, GNorm = 1.3283, lr_0 = 1.7207e-04
Loss = 2.0544e-03, PNorm = 43.1166, GNorm = 1.9294, lr_0 = 1.6651e-04
Validation rmse = 0.767213
Epoch 23
Loss = 1.6903e-03, PNorm = 43.1206, GNorm = 1.3059, lr_0 = 1.6059e-04
Loss = 1.8258e-03, PNorm = 43.1237, GNorm = 1.3997, lr_0 = 1.5539e-04
Validation rmse = 0.864843
Epoch 24
Loss = 1.4797e-03, PNorm = 43.1265, GNorm = 1.4820, lr_0 = 1.5036e-04
Loss = 1.8404e-03, PNorm = 43.1290, GNorm = 1.5024, lr_0 = 1.4550e-04
Loss = 2.0224e-03, PNorm = 43.1318, GNorm = 0.7068, lr_0 = 1.4079e-04
Validation rmse = 0.759435
Epoch 25
Loss = 1.4961e-03, PNorm = 43.1354, GNorm = 1.0135, lr_0 = 1.3623e-04
Loss = 1.9769e-03, PNorm = 43.1382, GNorm = 1.1770, lr_0 = 1.3183e-04
Loss = 2.0025e-03, PNorm = 43.1412, GNorm = 2.1366, lr_0 = 1.2756e-04
Validation rmse = 0.773388
Epoch 26
Loss = 1.7647e-03, PNorm = 43.1433, GNorm = 0.6751, lr_0 = 1.2343e-04
Loss = 1.8950e-03, PNorm = 43.1457, GNorm = 1.6187, lr_0 = 1.1944e-04
Validation rmse = 0.793127
Epoch 27
Loss = 1.7825e-03, PNorm = 43.1468, GNorm = 1.0515, lr_0 = 1.1557e-04
Loss = 1.9028e-03, PNorm = 43.1495, GNorm = 0.6687, lr_0 = 1.1183e-04
Loss = 1.9918e-03, PNorm = 43.1519, GNorm = 1.3091, lr_0 = 1.0821e-04
Validation rmse = 0.766369
Epoch 28
Loss = 1.8097e-03, PNorm = 43.1536, GNorm = 1.1781, lr_0 = 1.0437e-04
Loss = 1.7325e-03, PNorm = 43.1559, GNorm = 1.6762, lr_0 = 1.0099e-04
Validation rmse = 0.766677
Epoch 29
Loss = 1.4583e-03, PNorm = 43.1585, GNorm = 1.1839, lr_0 = 1.0000e-04
Loss = 1.8996e-03, PNorm = 43.1593, GNorm = 1.3330, lr_0 = 1.0000e-04
Loss = 1.8352e-03, PNorm = 43.1605, GNorm = 1.1957, lr_0 = 1.0000e-04
Validation rmse = 0.808890
Model 0 best validation rmse = 0.748224 on epoch 20
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.685467
Ensemble test rmse = 0.685467
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 891,501
Moving model to cuda
Epoch 0
Loss = 2.0066e-02, PNorm = 42.2749, GNorm = 4.9331, lr_0 = 2.9800e-04
Loss = 1.5555e-02, PNorm = 42.2876, GNorm = 3.4950, lr_0 = 4.7800e-04
Validation rmse = 1.977067
Epoch 1
Loss = 1.2694e-02, PNorm = 42.3159, GNorm = 2.4834, lr_0 = 6.7600e-04
Loss = 1.0623e-02, PNorm = 42.3535, GNorm = 3.1493, lr_0 = 8.5600e-04
Loss = 8.1160e-03, PNorm = 42.3962, GNorm = 1.7651, lr_0 = 9.9344e-04
Validation rmse = 1.534213
Epoch 2
Loss = 7.2736e-03, PNorm = 42.4376, GNorm = 3.3825, lr_0 = 9.6130e-04
Loss = 6.4001e-03, PNorm = 42.4734, GNorm = 3.0473, lr_0 = 9.3019e-04
Validation rmse = 1.700947
Epoch 3
Loss = 7.5633e-03, PNorm = 42.5075, GNorm = 1.1991, lr_0 = 9.0009e-04
Loss = 6.7885e-03, PNorm = 42.5386, GNorm = 3.6479, lr_0 = 8.7096e-04
Loss = 5.5293e-03, PNorm = 42.5684, GNorm = 2.0775, lr_0 = 8.4278e-04
Validation rmse = 1.228393
Epoch 4
Loss = 5.6153e-03, PNorm = 42.5958, GNorm = 1.1701, lr_0 = 8.1551e-04
Loss = 5.0538e-03, PNorm = 42.6252, GNorm = 4.0643, lr_0 = 7.8912e-04
Validation rmse = 1.174127
Epoch 5
Loss = 2.6935e-03, PNorm = 42.6479, GNorm = 0.8693, lr_0 = 7.6358e-04
Loss = 4.0830e-03, PNorm = 42.6721, GNorm = 4.8458, lr_0 = 7.3888e-04
Loss = 4.6755e-03, PNorm = 42.6910, GNorm = 1.4399, lr_0 = 7.1497e-04
Validation rmse = 1.118641
Epoch 6
Loss = 3.8693e-03, PNorm = 42.7124, GNorm = 3.3736, lr_0 = 6.8956e-04
Loss = 3.7162e-03, PNorm = 42.7345, GNorm = 1.3981, lr_0 = 6.6725e-04
Loss = 3.5130e-03, PNorm = 42.7509, GNorm = 2.4714, lr_0 = 6.4565e-04
Validation rmse = 1.045298
Epoch 7
Loss = 3.3842e-03, PNorm = 42.7678, GNorm = 1.1893, lr_0 = 6.2476e-04
Loss = 3.2712e-03, PNorm = 42.7833, GNorm = 2.4882, lr_0 = 6.0454e-04
Validation rmse = 1.022064
Epoch 8
Loss = 3.6763e-03, PNorm = 42.8000, GNorm = 1.7227, lr_0 = 5.8498e-04
Loss = 3.1813e-03, PNorm = 42.8160, GNorm = 1.5149, lr_0 = 5.6605e-04
Loss = 2.9216e-03, PNorm = 42.8301, GNorm = 2.6296, lr_0 = 5.4774e-04
Validation rmse = 1.014806
Epoch 9
Loss = 2.9204e-03, PNorm = 42.8430, GNorm = 4.0787, lr_0 = 5.3001e-04
Loss = 3.0101e-03, PNorm = 42.8571, GNorm = 3.5700, lr_0 = 5.1286e-04
Validation rmse = 1.087192
Epoch 10
Loss = 3.1981e-03, PNorm = 42.8672, GNorm = 1.7722, lr_0 = 4.9627e-04
Loss = 3.4142e-03, PNorm = 42.8793, GNorm = 3.4427, lr_0 = 4.8021e-04
Loss = 3.0212e-03, PNorm = 42.8907, GNorm = 1.0547, lr_0 = 4.6467e-04
Validation rmse = 0.986172
Epoch 11
Loss = 2.7403e-03, PNorm = 42.9029, GNorm = 1.5322, lr_0 = 4.4963e-04
Loss = 2.5215e-03, PNorm = 42.9116, GNorm = 2.2485, lr_0 = 4.3508e-04
Validation rmse = 0.963927
Epoch 12
Loss = 3.4536e-03, PNorm = 42.9228, GNorm = 2.9569, lr_0 = 4.1962e-04
Loss = 2.9812e-03, PNorm = 42.9272, GNorm = 6.7817, lr_0 = 4.0604e-04
Loss = 3.1895e-03, PNorm = 42.9384, GNorm = 1.7526, lr_0 = 3.9290e-04
Validation rmse = 1.043941
Epoch 13
Loss = 2.7954e-03, PNorm = 42.9509, GNorm = 3.1783, lr_0 = 3.8019e-04
Loss = 2.4820e-03, PNorm = 42.9579, GNorm = 0.9571, lr_0 = 3.6789e-04
Loss = 2.5209e-03, PNorm = 42.9657, GNorm = 0.7334, lr_0 = 3.5598e-04
Validation rmse = 0.975971
Epoch 14
Loss = 2.3860e-03, PNorm = 42.9729, GNorm = 1.5775, lr_0 = 3.4446e-04
Loss = 2.5265e-03, PNorm = 42.9825, GNorm = 0.7679, lr_0 = 3.3332e-04
Validation rmse = 0.975226
Epoch 15
Loss = 2.2682e-03, PNorm = 42.9900, GNorm = 1.3969, lr_0 = 3.2253e-04
Loss = 2.2597e-03, PNorm = 42.9964, GNorm = 0.7954, lr_0 = 3.1209e-04
Loss = 2.3455e-03, PNorm = 43.0018, GNorm = 1.2153, lr_0 = 3.0200e-04
Validation rmse = 0.991335
Epoch 16
Loss = 2.0925e-03, PNorm = 43.0086, GNorm = 1.3661, lr_0 = 2.9222e-04
Loss = 2.2659e-03, PNorm = 43.0148, GNorm = 1.2723, lr_0 = 2.8277e-04
Validation rmse = 1.002324
Epoch 17
Loss = 2.0994e-03, PNorm = 43.0205, GNorm = 3.7993, lr_0 = 2.7272e-04
Loss = 2.7412e-03, PNorm = 43.0275, GNorm = 0.9759, lr_0 = 2.6389e-04
Loss = 2.3010e-03, PNorm = 43.0326, GNorm = 4.3916, lr_0 = 2.5535e-04
Validation rmse = 0.979213
Epoch 18
Loss = 2.4716e-03, PNorm = 43.0373, GNorm = 1.4669, lr_0 = 2.4709e-04
Loss = 2.3466e-03, PNorm = 43.0434, GNorm = 0.8729, lr_0 = 2.3910e-04
Loss = 2.3390e-03, PNorm = 43.0492, GNorm = 0.8697, lr_0 = 2.3136e-04
Validation rmse = 0.979494
Epoch 19
Loss = 2.1349e-03, PNorm = 43.0539, GNorm = 1.6771, lr_0 = 2.2387e-04
Loss = 2.0160e-03, PNorm = 43.0570, GNorm = 1.5320, lr_0 = 2.1663e-04
Validation rmse = 0.959736
Epoch 20
Loss = 2.0137e-03, PNorm = 43.0601, GNorm = 1.3716, lr_0 = 2.0962e-04
Loss = 2.0272e-03, PNorm = 43.0628, GNorm = 1.0037, lr_0 = 2.0283e-04
Loss = 2.2357e-03, PNorm = 43.0667, GNorm = 1.6859, lr_0 = 1.9627e-04
Validation rmse = 0.967346
Epoch 21
Loss = 2.0146e-03, PNorm = 43.0698, GNorm = 0.6943, lr_0 = 1.8992e-04
Loss = 2.4101e-03, PNorm = 43.0733, GNorm = 1.1549, lr_0 = 1.8377e-04
Validation rmse = 0.963145
Epoch 22
Loss = 2.1022e-03, PNorm = 43.0763, GNorm = 2.4789, lr_0 = 1.7783e-04
Loss = 1.9304e-03, PNorm = 43.0802, GNorm = 1.1931, lr_0 = 1.7207e-04
Loss = 2.2346e-03, PNorm = 43.0826, GNorm = 2.1584, lr_0 = 1.6651e-04
Validation rmse = 0.980215
Epoch 23
Loss = 2.2224e-03, PNorm = 43.0853, GNorm = 0.9864, lr_0 = 1.6059e-04
Loss = 1.8794e-03, PNorm = 43.0886, GNorm = 2.3000, lr_0 = 1.5539e-04
Validation rmse = 0.948180
Epoch 24
Loss = 1.9237e-03, PNorm = 43.0917, GNorm = 2.2511, lr_0 = 1.5036e-04
Loss = 2.2920e-03, PNorm = 43.0946, GNorm = 1.1228, lr_0 = 1.4550e-04
Loss = 1.8268e-03, PNorm = 43.0979, GNorm = 1.0925, lr_0 = 1.4079e-04
Validation rmse = 0.937120
Epoch 25
Loss = 1.7779e-03, PNorm = 43.1004, GNorm = 0.9528, lr_0 = 1.3623e-04
Loss = 2.0289e-03, PNorm = 43.1027, GNorm = 2.5875, lr_0 = 1.3183e-04
Loss = 2.1713e-03, PNorm = 43.1055, GNorm = 0.8766, lr_0 = 1.2756e-04
Validation rmse = 0.980194
Epoch 26
Loss = 2.2640e-03, PNorm = 43.1084, GNorm = 2.2982, lr_0 = 1.2343e-04
Loss = 1.9995e-03, PNorm = 43.1108, GNorm = 3.0158, lr_0 = 1.1944e-04
Validation rmse = 0.945784
Epoch 27
Loss = 1.9226e-03, PNorm = 43.1131, GNorm = 0.8577, lr_0 = 1.1557e-04
Loss = 1.9834e-03, PNorm = 43.1150, GNorm = 0.6614, lr_0 = 1.1183e-04
Loss = 2.0633e-03, PNorm = 43.1168, GNorm = 1.6259, lr_0 = 1.0821e-04
Validation rmse = 0.947774
Epoch 28
Loss = 2.1973e-03, PNorm = 43.1193, GNorm = 0.7431, lr_0 = 1.0437e-04
Loss = 1.7600e-03, PNorm = 43.1210, GNorm = 0.4853, lr_0 = 1.0099e-04
Validation rmse = 0.934510
Epoch 29
Loss = 1.2300e-03, PNorm = 43.1230, GNorm = 1.1224, lr_0 = 1.0000e-04
Loss = 2.0329e-03, PNorm = 43.1251, GNorm = 2.3474, lr_0 = 1.0000e-04
Loss = 1.8706e-03, PNorm = 43.1263, GNorm = 1.7952, lr_0 = 1.0000e-04
Validation rmse = 0.965834
Model 0 best validation rmse = 0.934510 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.737815
Ensemble test rmse = 0.737815
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 500,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 500,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_4_dropout_0.25_ffn_num_layers_2_hidden_size_500/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.25, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=500, bias=False)
      (W_h): Linear(in_features=500, out_features=500, bias=False)
      (W_o): Linear(in_features=633, out_features=500, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=500, out_features=500, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=500, out_features=1, bias=True)
  )
)
Number of parameters = 891,501
Moving model to cuda
Epoch 0
Loss = 1.9296e-02, PNorm = 42.2763, GNorm = 5.9396, lr_0 = 2.9800e-04
Loss = 1.7426e-02, PNorm = 42.2884, GNorm = 3.5779, lr_0 = 4.7800e-04
Validation rmse = 1.628955
Epoch 1
Loss = 9.5746e-03, PNorm = 42.3178, GNorm = 2.2941, lr_0 = 6.7600e-04
Loss = 1.0931e-02, PNorm = 42.3544, GNorm = 11.8978, lr_0 = 8.5600e-04
Loss = 1.0113e-02, PNorm = 42.3985, GNorm = 1.8895, lr_0 = 9.9344e-04
Validation rmse = 1.496056
Epoch 2
Loss = 7.8746e-03, PNorm = 42.4520, GNorm = 2.4252, lr_0 = 9.6130e-04
Loss = 5.7443e-03, PNorm = 42.4864, GNorm = 5.3723, lr_0 = 9.3019e-04
Validation rmse = 1.192125
Epoch 3
Loss = 5.2411e-03, PNorm = 42.5153, GNorm = 2.9626, lr_0 = 9.0009e-04
Loss = 5.0840e-03, PNorm = 42.5432, GNorm = 3.1474, lr_0 = 8.7096e-04
Loss = 5.0591e-03, PNorm = 42.5684, GNorm = 3.0542, lr_0 = 8.4278e-04
Validation rmse = 1.128185
Epoch 4
Loss = 5.0667e-03, PNorm = 42.5953, GNorm = 3.0441, lr_0 = 8.1551e-04
Loss = 5.4357e-03, PNorm = 42.6217, GNorm = 1.4037, lr_0 = 7.8912e-04
Validation rmse = 1.174550
Epoch 5
Loss = 3.9710e-03, PNorm = 42.6463, GNorm = 1.9298, lr_0 = 7.6358e-04
Loss = 4.5473e-03, PNorm = 42.6678, GNorm = 1.4169, lr_0 = 7.3888e-04
Loss = 4.1932e-03, PNorm = 42.6864, GNorm = 3.8035, lr_0 = 7.1497e-04
Validation rmse = 1.069818
Epoch 6
Loss = 4.0404e-03, PNorm = 42.7048, GNorm = 2.1251, lr_0 = 6.8956e-04
Loss = 4.4257e-03, PNorm = 42.7259, GNorm = 3.8799, lr_0 = 6.6725e-04
Loss = 3.9796e-03, PNorm = 42.7418, GNorm = 2.7123, lr_0 = 6.4565e-04
Validation rmse = 0.991057
Epoch 7
Loss = 3.5821e-03, PNorm = 42.7614, GNorm = 1.2652, lr_0 = 6.2476e-04
Loss = 3.4133e-03, PNorm = 42.7766, GNorm = 1.6909, lr_0 = 6.0454e-04
Validation rmse = 0.965429
Epoch 8
Loss = 3.3237e-03, PNorm = 42.7923, GNorm = 1.0321, lr_0 = 5.8498e-04
Loss = 3.4252e-03, PNorm = 42.8047, GNorm = 0.8967, lr_0 = 5.6605e-04
Loss = 3.1079e-03, PNorm = 42.8170, GNorm = 1.3325, lr_0 = 5.4774e-04
Validation rmse = 0.924182
Epoch 9
Loss = 2.5487e-03, PNorm = 42.8275, GNorm = 1.5349, lr_0 = 5.3001e-04
Loss = 2.7937e-03, PNorm = 42.8391, GNorm = 1.1005, lr_0 = 5.1286e-04
Validation rmse = 0.884934
Epoch 10
Loss = 3.3528e-03, PNorm = 42.8532, GNorm = 2.6645, lr_0 = 4.9627e-04
Loss = 2.8512e-03, PNorm = 42.8644, GNorm = 1.6250, lr_0 = 4.8021e-04
Loss = 2.8190e-03, PNorm = 42.8757, GNorm = 3.8252, lr_0 = 4.6467e-04
Validation rmse = 0.902004
Epoch 11
Loss = 2.6467e-03, PNorm = 42.8880, GNorm = 1.5757, lr_0 = 4.4963e-04
Loss = 2.6559e-03, PNorm = 42.8994, GNorm = 0.7091, lr_0 = 4.3508e-04
Validation rmse = 0.917059
Epoch 12
Loss = 2.6981e-03, PNorm = 42.9084, GNorm = 2.5632, lr_0 = 4.1962e-04
Loss = 2.7173e-03, PNorm = 42.9196, GNorm = 1.0672, lr_0 = 4.0604e-04
Loss = 2.5101e-03, PNorm = 42.9326, GNorm = 2.9392, lr_0 = 3.9290e-04
Validation rmse = 0.880084
Epoch 13
Loss = 2.5126e-03, PNorm = 42.9376, GNorm = 0.9351, lr_0 = 3.8019e-04
Loss = 2.3566e-03, PNorm = 42.9480, GNorm = 1.7084, lr_0 = 3.6789e-04
Loss = 2.8074e-03, PNorm = 42.9554, GNorm = 1.6117, lr_0 = 3.5598e-04
Validation rmse = 0.882839
Epoch 14
Loss = 2.5656e-03, PNorm = 42.9634, GNorm = 0.8560, lr_0 = 3.4446e-04
Loss = 2.2605e-03, PNorm = 42.9713, GNorm = 1.5958, lr_0 = 3.3332e-04
Validation rmse = 0.853369
Epoch 15
Loss = 2.6299e-03, PNorm = 42.9791, GNorm = 2.9825, lr_0 = 3.2253e-04
Loss = 2.5440e-03, PNorm = 42.9849, GNorm = 1.3069, lr_0 = 3.1209e-04
Loss = 2.4759e-03, PNorm = 42.9917, GNorm = 1.8002, lr_0 = 3.0200e-04
Validation rmse = 0.861494
Epoch 16
Loss = 2.1903e-03, PNorm = 42.9986, GNorm = 0.9406, lr_0 = 2.9222e-04
Loss = 2.0348e-03, PNorm = 43.0033, GNorm = 1.2747, lr_0 = 2.8277e-04
Validation rmse = 0.867089
Epoch 17
Loss = 2.2366e-03, PNorm = 43.0105, GNorm = 1.1370, lr_0 = 2.7272e-04
Loss = 2.2026e-03, PNorm = 43.0169, GNorm = 0.9561, lr_0 = 2.6389e-04
Loss = 2.1682e-03, PNorm = 43.0203, GNorm = 1.0900, lr_0 = 2.5535e-04
Validation rmse = 0.839969
Epoch 18
Loss = 2.3068e-03, PNorm = 43.0249, GNorm = 0.9033, lr_0 = 2.4709e-04
Loss = 2.5515e-03, PNorm = 43.0291, GNorm = 2.2293, lr_0 = 2.3910e-04
Loss = 1.9272e-03, PNorm = 43.0361, GNorm = 1.6182, lr_0 = 2.3136e-04
Validation rmse = 0.823776
Epoch 19
Loss = 2.1288e-03, PNorm = 43.0401, GNorm = 0.5539, lr_0 = 2.2387e-04
Loss = 2.1492e-03, PNorm = 43.0440, GNorm = 2.2426, lr_0 = 2.1663e-04
Validation rmse = 0.864825
Epoch 20
Loss = 1.8237e-03, PNorm = 43.0501, GNorm = 0.8150, lr_0 = 2.0962e-04
Loss = 2.1146e-03, PNorm = 43.0554, GNorm = 1.8397, lr_0 = 2.0283e-04
Loss = 2.1639e-03, PNorm = 43.0592, GNorm = 0.8241, lr_0 = 1.9627e-04
Validation rmse = 0.877354
Epoch 21
Loss = 2.0430e-03, PNorm = 43.0614, GNorm = 2.3450, lr_0 = 1.8992e-04
Loss = 2.3089e-03, PNorm = 43.0664, GNorm = 3.1241, lr_0 = 1.8377e-04
Validation rmse = 0.840903
Epoch 22
Loss = 1.9224e-03, PNorm = 43.0709, GNorm = 1.5311, lr_0 = 1.7783e-04
Loss = 1.9331e-03, PNorm = 43.0757, GNorm = 1.2389, lr_0 = 1.7207e-04
Loss = 1.9066e-03, PNorm = 43.0787, GNorm = 1.2813, lr_0 = 1.6651e-04
Validation rmse = 0.827287
Epoch 23
Loss = 1.9462e-03, PNorm = 43.0824, GNorm = 0.6894, lr_0 = 1.6059e-04
Loss = 2.0916e-03, PNorm = 43.0857, GNorm = 1.9671, lr_0 = 1.5539e-04
Validation rmse = 0.807472
Epoch 24
Loss = 1.6164e-03, PNorm = 43.0899, GNorm = 1.4664, lr_0 = 1.5036e-04
Loss = 1.9844e-03, PNorm = 43.0934, GNorm = 1.3911, lr_0 = 1.4550e-04
Loss = 1.8638e-03, PNorm = 43.0964, GNorm = 1.2925, lr_0 = 1.4079e-04
Validation rmse = 0.808834
Epoch 25
Loss = 2.1001e-03, PNorm = 43.0992, GNorm = 1.6042, lr_0 = 1.3623e-04
Loss = 1.8955e-03, PNorm = 43.1016, GNorm = 1.6657, lr_0 = 1.3183e-04
Loss = 2.0199e-03, PNorm = 43.1039, GNorm = 1.4230, lr_0 = 1.2756e-04
Validation rmse = 0.805372
Epoch 26
Loss = 1.7658e-03, PNorm = 43.1067, GNorm = 1.3893, lr_0 = 1.2343e-04
Loss = 1.7799e-03, PNorm = 43.1092, GNorm = 1.3700, lr_0 = 1.1944e-04
Validation rmse = 0.835985
Epoch 27
Loss = 1.9537e-03, PNorm = 43.1111, GNorm = 1.9426, lr_0 = 1.1557e-04
Loss = 1.8854e-03, PNorm = 43.1144, GNorm = 1.5857, lr_0 = 1.1183e-04
Loss = 1.8937e-03, PNorm = 43.1170, GNorm = 0.7509, lr_0 = 1.0821e-04
Validation rmse = 0.804079
Epoch 28
Loss = 2.1207e-03, PNorm = 43.1191, GNorm = 1.9064, lr_0 = 1.0437e-04
Loss = 1.9806e-03, PNorm = 43.1217, GNorm = 1.8104, lr_0 = 1.0099e-04
Validation rmse = 0.805738
Epoch 29
Loss = 1.6188e-03, PNorm = 43.1239, GNorm = 2.1090, lr_0 = 1.0000e-04
Loss = 2.0254e-03, PNorm = 43.1254, GNorm = 2.0341, lr_0 = 1.0000e-04
Loss = 1.9922e-03, PNorm = 43.1275, GNorm = 2.0211, lr_0 = 1.0000e-04
Validation rmse = 0.801048
Model 0 best validation rmse = 0.801048 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.762522
Ensemble test rmse = 0.762522
10-fold cross validation
	Seed 0 ==> test rmse = 0.822238
	Seed 1 ==> test rmse = 0.711647
	Seed 2 ==> test rmse = 0.711353
	Seed 3 ==> test rmse = 0.873153
	Seed 4 ==> test rmse = 1.084035
	Seed 5 ==> test rmse = 0.672589
	Seed 6 ==> test rmse = 0.779354
	Seed 7 ==> test rmse = 0.685467
	Seed 8 ==> test rmse = 0.737815
	Seed 9 ==> test rmse = 0.762522
Overall test rmse = 0.784017 +/- 0.116052
Elapsed time = 0:07:51
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2400, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,721,601
Moving model to cuda
Epoch 0
Loss = 1.6832e-02, PNorm = 99.7630, GNorm = 6.2472, lr_0 = 2.9800e-04
Loss = 1.3537e-02, PNorm = 99.8589, GNorm = 3.9231, lr_0 = 4.7800e-04
Validation rmse = 1.306054
Epoch 1
Loss = 7.6593e-03, PNorm = 100.0398, GNorm = 3.4404, lr_0 = 6.7600e-04
Loss = 9.6692e-03, PNorm = 100.2520, GNorm = 4.2460, lr_0 = 8.5600e-04
Loss = 7.4549e-03, PNorm = 100.5026, GNorm = 1.8101, lr_0 = 9.9344e-04
Validation rmse = 1.259096
Epoch 2
Loss = 7.5233e-03, PNorm = 100.7317, GNorm = 2.6017, lr_0 = 9.6130e-04
Loss = 5.6785e-03, PNorm = 100.9385, GNorm = 1.4530, lr_0 = 9.3019e-04
Validation rmse = 1.092182
Epoch 3
Loss = 4.0324e-03, PNorm = 101.0809, GNorm = 4.0168, lr_0 = 9.0009e-04
Loss = 4.1784e-03, PNorm = 101.1986, GNorm = 1.2022, lr_0 = 8.7096e-04
Loss = 4.2444e-03, PNorm = 101.2806, GNorm = 2.3646, lr_0 = 8.4278e-04
Validation rmse = 1.159323
Epoch 4
Loss = 4.6542e-03, PNorm = 101.3462, GNorm = 3.7662, lr_0 = 8.1551e-04
Loss = 4.0508e-03, PNorm = 101.4194, GNorm = 2.0245, lr_0 = 7.8912e-04
Validation rmse = 0.960002
Epoch 5
Loss = 2.7451e-03, PNorm = 101.4881, GNorm = 1.3906, lr_0 = 7.6358e-04
Loss = 2.7984e-03, PNorm = 101.5535, GNorm = 1.2673, lr_0 = 7.3888e-04
Loss = 3.2940e-03, PNorm = 101.6009, GNorm = 6.2191, lr_0 = 7.1497e-04
Validation rmse = 0.960677
Epoch 6
Loss = 2.9167e-03, PNorm = 101.6588, GNorm = 0.8678, lr_0 = 6.8956e-04
Loss = 2.7998e-03, PNorm = 101.7197, GNorm = 1.1833, lr_0 = 6.6725e-04
Loss = 2.4512e-03, PNorm = 101.7616, GNorm = 1.4675, lr_0 = 6.4565e-04
Validation rmse = 0.959373
Epoch 7
Loss = 2.5193e-03, PNorm = 101.8085, GNorm = 2.1819, lr_0 = 6.2476e-04
Loss = 3.1811e-03, PNorm = 101.8507, GNorm = 1.9886, lr_0 = 6.0454e-04
Validation rmse = 1.084199
Epoch 8
Loss = 2.4819e-03, PNorm = 101.8948, GNorm = 3.9120, lr_0 = 5.8498e-04
Loss = 3.4360e-03, PNorm = 101.9403, GNorm = 3.1145, lr_0 = 5.6605e-04
Loss = 2.9111e-03, PNorm = 101.9978, GNorm = 4.4476, lr_0 = 5.4774e-04
Validation rmse = 1.168104
Epoch 9
Loss = 2.9996e-03, PNorm = 102.0508, GNorm = 3.7545, lr_0 = 5.3001e-04
Loss = 2.4806e-03, PNorm = 102.0968, GNorm = 0.8585, lr_0 = 5.1286e-04
Validation rmse = 0.864576
Epoch 10
Loss = 2.1735e-03, PNorm = 102.1333, GNorm = 3.2097, lr_0 = 4.9627e-04
Loss = 2.5016e-03, PNorm = 102.1833, GNorm = 0.6825, lr_0 = 4.8021e-04
Loss = 2.1204e-03, PNorm = 102.2191, GNorm = 1.0555, lr_0 = 4.6467e-04
Validation rmse = 0.898407
Epoch 11
Loss = 1.8392e-03, PNorm = 102.2478, GNorm = 0.6369, lr_0 = 4.4963e-04
Loss = 1.5502e-03, PNorm = 102.2765, GNorm = 0.3825, lr_0 = 4.3508e-04
Validation rmse = 0.892048
Epoch 12
Loss = 1.5929e-03, PNorm = 102.3114, GNorm = 0.9640, lr_0 = 4.1962e-04
Loss = 1.6725e-03, PNorm = 102.3374, GNorm = 2.4443, lr_0 = 4.0604e-04
Loss = 1.7617e-03, PNorm = 102.3666, GNorm = 2.6476, lr_0 = 3.9290e-04
Validation rmse = 0.880435
Epoch 13
Loss = 1.6075e-03, PNorm = 102.3947, GNorm = 3.5788, lr_0 = 3.8019e-04
Loss = 1.6554e-03, PNorm = 102.4170, GNorm = 0.5325, lr_0 = 3.6789e-04
Loss = 1.4016e-03, PNorm = 102.4420, GNorm = 0.7719, lr_0 = 3.5598e-04
Validation rmse = 0.832177
Epoch 14
Loss = 1.4644e-03, PNorm = 102.4672, GNorm = 1.6938, lr_0 = 3.4446e-04
Loss = 1.0939e-03, PNorm = 102.4886, GNorm = 2.0315, lr_0 = 3.3332e-04
Validation rmse = 0.902590
Epoch 15
Loss = 1.3556e-03, PNorm = 102.5086, GNorm = 1.1746, lr_0 = 3.2253e-04
Loss = 1.4718e-03, PNorm = 102.5260, GNorm = 2.6288, lr_0 = 3.1209e-04
Loss = 1.4170e-03, PNorm = 102.5445, GNorm = 0.4797, lr_0 = 3.0200e-04
Validation rmse = 0.867865
Epoch 16
Loss = 1.3945e-03, PNorm = 102.5699, GNorm = 0.5619, lr_0 = 2.9222e-04
Loss = 1.3400e-03, PNorm = 102.5927, GNorm = 2.9586, lr_0 = 2.8277e-04
Validation rmse = 0.853767
Epoch 17
Loss = 1.1274e-03, PNorm = 102.6129, GNorm = 0.4566, lr_0 = 2.7272e-04
Loss = 1.1318e-03, PNorm = 102.6327, GNorm = 0.8243, lr_0 = 2.6389e-04
Loss = 1.2074e-03, PNorm = 102.6506, GNorm = 1.3463, lr_0 = 2.5535e-04
Validation rmse = 0.824734
Epoch 18
Loss = 1.1782e-03, PNorm = 102.6674, GNorm = 0.6657, lr_0 = 2.4709e-04
Loss = 9.9716e-04, PNorm = 102.6862, GNorm = 2.7618, lr_0 = 2.3910e-04
Loss = 9.6467e-04, PNorm = 102.7036, GNorm = 0.4130, lr_0 = 2.3136e-04
Validation rmse = 0.809740
Epoch 19
Loss = 9.9820e-04, PNorm = 102.7178, GNorm = 0.4239, lr_0 = 2.2387e-04
Loss = 9.6582e-04, PNorm = 102.7320, GNorm = 1.1845, lr_0 = 2.1663e-04
Validation rmse = 0.842403
Epoch 20
Loss = 8.1456e-04, PNorm = 102.7460, GNorm = 0.5820, lr_0 = 2.0962e-04
Loss = 9.7322e-04, PNorm = 102.7608, GNorm = 1.5304, lr_0 = 2.0283e-04
Loss = 9.2199e-04, PNorm = 102.7776, GNorm = 0.3540, lr_0 = 1.9627e-04
Validation rmse = 0.812194
Epoch 21
Loss = 8.5586e-04, PNorm = 102.7913, GNorm = 1.5917, lr_0 = 1.8992e-04
Loss = 8.3168e-04, PNorm = 102.8025, GNorm = 1.5369, lr_0 = 1.8377e-04
Validation rmse = 0.786488
Epoch 22
Loss = 7.9683e-04, PNorm = 102.8184, GNorm = 0.3612, lr_0 = 1.7783e-04
Loss = 7.7309e-04, PNorm = 102.8344, GNorm = 0.5772, lr_0 = 1.7207e-04
Loss = 8.5935e-04, PNorm = 102.8456, GNorm = 1.0327, lr_0 = 1.6651e-04
Validation rmse = 0.830247
Epoch 23
Loss = 7.6901e-04, PNorm = 102.8559, GNorm = 0.7334, lr_0 = 1.6059e-04
Loss = 8.6016e-04, PNorm = 102.8696, GNorm = 0.9287, lr_0 = 1.5539e-04
Validation rmse = 0.792804
Epoch 24
Loss = 7.3802e-04, PNorm = 102.8804, GNorm = 0.5334, lr_0 = 1.5036e-04
Loss = 6.8970e-04, PNorm = 102.8919, GNorm = 1.5293, lr_0 = 1.4550e-04
Loss = 7.6027e-04, PNorm = 102.9010, GNorm = 0.6134, lr_0 = 1.4079e-04
Validation rmse = 0.811618
Epoch 25
Loss = 6.0597e-04, PNorm = 102.9112, GNorm = 0.3664, lr_0 = 1.3623e-04
Loss = 7.7785e-04, PNorm = 102.9205, GNorm = 1.0452, lr_0 = 1.3183e-04
Loss = 7.6978e-04, PNorm = 102.9287, GNorm = 0.9471, lr_0 = 1.2756e-04
Validation rmse = 0.794841
Epoch 26
Loss = 5.8600e-04, PNorm = 102.9381, GNorm = 0.3176, lr_0 = 1.2343e-04
Loss = 7.0122e-04, PNorm = 102.9467, GNorm = 0.5117, lr_0 = 1.1944e-04
Validation rmse = 0.815575
Epoch 27
Loss = 7.8566e-04, PNorm = 102.9559, GNorm = 0.5568, lr_0 = 1.1557e-04
Loss = 7.4422e-04, PNorm = 102.9652, GNorm = 0.5548, lr_0 = 1.1183e-04
Loss = 6.5335e-04, PNorm = 102.9740, GNorm = 0.3685, lr_0 = 1.0821e-04
Validation rmse = 0.823961
Epoch 28
Loss = 6.5801e-04, PNorm = 102.9826, GNorm = 0.5399, lr_0 = 1.0437e-04
Loss = 5.5632e-04, PNorm = 102.9910, GNorm = 0.7101, lr_0 = 1.0099e-04
Validation rmse = 0.808840
Epoch 29
Loss = 7.9907e-04, PNorm = 102.9985, GNorm = 1.0507, lr_0 = 1.0000e-04
Loss = 6.4557e-04, PNorm = 103.0061, GNorm = 0.8783, lr_0 = 1.0000e-04
Loss = 7.6321e-04, PNorm = 103.0137, GNorm = 2.4776, lr_0 = 1.0000e-04
Validation rmse = 0.821800
Model 0 best validation rmse = 0.786488 on epoch 21
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.742750
Ensemble test rmse = 0.742750
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2400, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,721,601
Moving model to cuda
Epoch 0
Loss = 2.2203e-02, PNorm = 99.7618, GNorm = 1.1465, lr_0 = 2.9800e-04
Loss = 1.4315e-02, PNorm = 99.8579, GNorm = 4.0717, lr_0 = 4.7800e-04
Validation rmse = 1.717704
Epoch 1
Loss = 9.5569e-03, PNorm = 100.0328, GNorm = 2.0381, lr_0 = 6.7600e-04
Loss = 1.0198e-02, PNorm = 100.2428, GNorm = 2.6763, lr_0 = 8.5600e-04
Loss = 7.2130e-03, PNorm = 100.4558, GNorm = 2.9794, lr_0 = 9.9344e-04
Validation rmse = 1.306327
Epoch 2
Loss = 6.2358e-03, PNorm = 100.6546, GNorm = 3.8338, lr_0 = 9.6130e-04
Loss = 5.8179e-03, PNorm = 100.8278, GNorm = 2.0554, lr_0 = 9.3019e-04
Validation rmse = 1.152415
Epoch 3
Loss = 3.8695e-03, PNorm = 100.9559, GNorm = 1.4031, lr_0 = 9.0009e-04
Loss = 4.5291e-03, PNorm = 101.0693, GNorm = 0.6075, lr_0 = 8.7096e-04
Loss = 4.7806e-03, PNorm = 101.1647, GNorm = 4.1416, lr_0 = 8.4278e-04
Validation rmse = 0.946189
Epoch 4
Loss = 4.3687e-03, PNorm = 101.2458, GNorm = 2.2594, lr_0 = 8.1551e-04
Loss = 3.2753e-03, PNorm = 101.3262, GNorm = 2.4637, lr_0 = 7.8912e-04
Validation rmse = 0.994591
Epoch 5
Loss = 2.3499e-03, PNorm = 101.3949, GNorm = 1.6303, lr_0 = 7.6358e-04
Loss = 4.6684e-03, PNorm = 101.4631, GNorm = 3.6361, lr_0 = 7.3888e-04
Loss = 3.7089e-03, PNorm = 101.5355, GNorm = 1.0214, lr_0 = 7.1497e-04
Validation rmse = 1.202435
Epoch 6
Loss = 4.9204e-03, PNorm = 101.6128, GNorm = 1.3973, lr_0 = 6.8956e-04
Loss = 3.4392e-03, PNorm = 101.6898, GNorm = 2.6911, lr_0 = 6.6725e-04
Loss = 2.6671e-03, PNorm = 101.7556, GNorm = 1.8599, lr_0 = 6.4565e-04
Validation rmse = 0.900220
Epoch 7
Loss = 2.6261e-03, PNorm = 101.8064, GNorm = 1.6628, lr_0 = 6.2476e-04
Loss = 2.3610e-03, PNorm = 101.8558, GNorm = 1.6663, lr_0 = 6.0454e-04
Validation rmse = 0.873972
Epoch 8
Loss = 3.2594e-03, PNorm = 101.9084, GNorm = 1.2707, lr_0 = 5.8498e-04
Loss = 2.3718e-03, PNorm = 101.9710, GNorm = 1.6027, lr_0 = 5.6605e-04
Loss = 2.3442e-03, PNorm = 102.0177, GNorm = 0.5262, lr_0 = 5.4774e-04
Validation rmse = 0.839820
Epoch 9
Loss = 2.1860e-03, PNorm = 102.0573, GNorm = 0.9907, lr_0 = 5.3001e-04
Loss = 2.3537e-03, PNorm = 102.1008, GNorm = 1.3002, lr_0 = 5.1286e-04
Validation rmse = 0.870287
Epoch 10
Loss = 1.8630e-03, PNorm = 102.1399, GNorm = 0.8687, lr_0 = 4.9627e-04
Loss = 2.6550e-03, PNorm = 102.1682, GNorm = 0.9932, lr_0 = 4.8021e-04
Loss = 1.8275e-03, PNorm = 102.1951, GNorm = 1.2977, lr_0 = 4.6467e-04
Validation rmse = 0.837993
Epoch 11
Loss = 2.3716e-03, PNorm = 102.2318, GNorm = 4.0064, lr_0 = 4.4963e-04
Loss = 1.8901e-03, PNorm = 102.2658, GNorm = 0.5074, lr_0 = 4.3508e-04
Validation rmse = 0.758728
Epoch 12
Loss = 1.5795e-03, PNorm = 102.3051, GNorm = 0.6070, lr_0 = 4.1962e-04
Loss = 2.0331e-03, PNorm = 102.3417, GNorm = 3.8551, lr_0 = 4.0604e-04
Loss = 2.3391e-03, PNorm = 102.3793, GNorm = 2.5795, lr_0 = 3.9290e-04
Validation rmse = 0.831640
Epoch 13
Loss = 1.4734e-03, PNorm = 102.4120, GNorm = 0.9278, lr_0 = 3.8019e-04
Loss = 1.6816e-03, PNorm = 102.4386, GNorm = 0.7527, lr_0 = 3.6789e-04
Loss = 2.4723e-03, PNorm = 102.4607, GNorm = 0.8720, lr_0 = 3.5598e-04
Validation rmse = 0.927861
Epoch 14
Loss = 2.1711e-03, PNorm = 102.4942, GNorm = 2.7145, lr_0 = 3.4446e-04
Loss = 1.6300e-03, PNorm = 102.5179, GNorm = 1.0338, lr_0 = 3.3332e-04
Validation rmse = 0.751826
Epoch 15
Loss = 1.4867e-03, PNorm = 102.5427, GNorm = 1.9442, lr_0 = 3.2253e-04
Loss = 1.5160e-03, PNorm = 102.5615, GNorm = 1.4222, lr_0 = 3.1209e-04
Loss = 1.6536e-03, PNorm = 102.5843, GNorm = 1.3448, lr_0 = 3.0200e-04
Validation rmse = 0.751842
Epoch 16
Loss = 1.8995e-03, PNorm = 102.6037, GNorm = 0.6953, lr_0 = 2.9222e-04
Loss = 1.1272e-03, PNorm = 102.6230, GNorm = 0.8884, lr_0 = 2.8277e-04
Validation rmse = 0.742724
Epoch 17
Loss = 1.1944e-03, PNorm = 102.6433, GNorm = 0.2692, lr_0 = 2.7272e-04
Loss = 1.3682e-03, PNorm = 102.6612, GNorm = 0.7513, lr_0 = 2.6389e-04
Loss = 1.1720e-03, PNorm = 102.6806, GNorm = 0.5548, lr_0 = 2.5535e-04
Validation rmse = 0.710591
Epoch 18
Loss = 1.0628e-03, PNorm = 102.6958, GNorm = 0.9043, lr_0 = 2.4709e-04
Loss = 1.4246e-03, PNorm = 102.7131, GNorm = 1.3534, lr_0 = 2.3910e-04
Loss = 1.1589e-03, PNorm = 102.7327, GNorm = 0.9929, lr_0 = 2.3136e-04
Validation rmse = 0.717830
Epoch 19
Loss = 1.2013e-03, PNorm = 102.7465, GNorm = 1.8854, lr_0 = 2.2387e-04
Loss = 1.1158e-03, PNorm = 102.7638, GNorm = 1.1917, lr_0 = 2.1663e-04
Validation rmse = 0.718732
Epoch 20
Loss = 8.8122e-04, PNorm = 102.7833, GNorm = 1.1399, lr_0 = 2.0962e-04
Loss = 1.2464e-03, PNorm = 102.7989, GNorm = 0.7874, lr_0 = 2.0283e-04
Loss = 1.1573e-03, PNorm = 102.8147, GNorm = 0.5052, lr_0 = 1.9627e-04
Validation rmse = 0.715874
Epoch 21
Loss = 1.0009e-03, PNorm = 102.8310, GNorm = 0.8619, lr_0 = 1.8992e-04
Loss = 1.1279e-03, PNorm = 102.8451, GNorm = 1.9815, lr_0 = 1.8377e-04
Validation rmse = 0.710963
Epoch 22
Loss = 9.0700e-04, PNorm = 102.8585, GNorm = 1.1568, lr_0 = 1.7783e-04
Loss = 1.0160e-03, PNorm = 102.8714, GNorm = 1.2987, lr_0 = 1.7207e-04
Loss = 1.0534e-03, PNorm = 102.8845, GNorm = 0.9697, lr_0 = 1.6651e-04
Validation rmse = 0.690900
Epoch 23
Loss = 7.9452e-04, PNorm = 102.9007, GNorm = 0.9256, lr_0 = 1.6059e-04
Loss = 9.0944e-04, PNorm = 102.9148, GNorm = 0.6951, lr_0 = 1.5539e-04
Validation rmse = 0.743655
Epoch 24
Loss = 7.2916e-04, PNorm = 102.9244, GNorm = 1.1417, lr_0 = 1.5036e-04
Loss = 1.0797e-03, PNorm = 102.9356, GNorm = 0.3019, lr_0 = 1.4550e-04
Loss = 1.0356e-03, PNorm = 102.9489, GNorm = 0.5301, lr_0 = 1.4079e-04
Validation rmse = 0.697915
Epoch 25
Loss = 6.4433e-04, PNorm = 102.9602, GNorm = 0.4764, lr_0 = 1.3623e-04
Loss = 8.8845e-04, PNorm = 102.9708, GNorm = 0.6087, lr_0 = 1.3183e-04
Loss = 1.0005e-03, PNorm = 102.9833, GNorm = 1.0422, lr_0 = 1.2756e-04
Validation rmse = 0.695175
Epoch 26
Loss = 9.0240e-04, PNorm = 102.9931, GNorm = 0.9580, lr_0 = 1.2343e-04
Loss = 9.3170e-04, PNorm = 103.0025, GNorm = 0.8053, lr_0 = 1.1944e-04
Validation rmse = 0.687643
Epoch 27
Loss = 8.4262e-04, PNorm = 103.0117, GNorm = 0.3353, lr_0 = 1.1557e-04
Loss = 8.1117e-04, PNorm = 103.0224, GNorm = 1.6331, lr_0 = 1.1183e-04
Loss = 9.1251e-04, PNorm = 103.0327, GNorm = 0.4634, lr_0 = 1.0821e-04
Validation rmse = 0.716752
Epoch 28
Loss = 8.7346e-04, PNorm = 103.0429, GNorm = 0.4870, lr_0 = 1.0437e-04
Loss = 6.5445e-04, PNorm = 103.0513, GNorm = 0.4141, lr_0 = 1.0099e-04
Validation rmse = 0.684873
Epoch 29
Loss = 6.5984e-04, PNorm = 103.0591, GNorm = 0.5452, lr_0 = 1.0000e-04
Loss = 7.8996e-04, PNorm = 103.0683, GNorm = 0.8031, lr_0 = 1.0000e-04
Loss = 7.6882e-04, PNorm = 103.0775, GNorm = 0.6829, lr_0 = 1.0000e-04
Validation rmse = 0.681569
Model 0 best validation rmse = 0.681569 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.619086
Ensemble test rmse = 0.619086
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2400, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,721,601
Moving model to cuda
Epoch 0
Loss = 2.1236e-02, PNorm = 99.7597, GNorm = 7.0158, lr_0 = 2.9800e-04
Loss = 1.4773e-02, PNorm = 99.8581, GNorm = 4.1340, lr_0 = 4.7800e-04
Validation rmse = 1.469143
Epoch 1
Loss = 1.1953e-02, PNorm = 100.0250, GNorm = 3.1379, lr_0 = 6.7600e-04
Loss = 1.0670e-02, PNorm = 100.2399, GNorm = 2.3723, lr_0 = 8.5600e-04
Loss = 7.6172e-03, PNorm = 100.4768, GNorm = 1.8266, lr_0 = 9.9344e-04
Validation rmse = 1.372760
Epoch 2
Loss = 9.9892e-03, PNorm = 100.7167, GNorm = 2.3077, lr_0 = 9.6130e-04
Loss = 8.5137e-03, PNorm = 100.9299, GNorm = 1.5234, lr_0 = 9.3019e-04
Validation rmse = 1.034063
Epoch 3
Loss = 5.2756e-03, PNorm = 101.0905, GNorm = 3.8510, lr_0 = 9.0009e-04
Loss = 4.8895e-03, PNorm = 101.1964, GNorm = 2.4798, lr_0 = 8.7096e-04
Loss = 4.8199e-03, PNorm = 101.2937, GNorm = 0.9162, lr_0 = 8.4278e-04
Validation rmse = 0.955194
Epoch 4
Loss = 5.4022e-03, PNorm = 101.3876, GNorm = 2.4106, lr_0 = 8.1551e-04
Loss = 5.6414e-03, PNorm = 101.4734, GNorm = 2.0851, lr_0 = 7.8912e-04
Validation rmse = 0.941155
Epoch 5
Loss = 4.2805e-03, PNorm = 101.5539, GNorm = 2.5996, lr_0 = 7.6358e-04
Loss = 3.8065e-03, PNorm = 101.6325, GNorm = 2.8035, lr_0 = 7.3888e-04
Loss = 3.6828e-03, PNorm = 101.7005, GNorm = 3.9418, lr_0 = 7.1497e-04
Validation rmse = 1.028473
Epoch 6
Loss = 3.6416e-03, PNorm = 101.7561, GNorm = 1.2705, lr_0 = 6.8956e-04
Loss = 2.8149e-03, PNorm = 101.7983, GNorm = 1.8434, lr_0 = 6.6725e-04
Loss = 3.9316e-03, PNorm = 101.8466, GNorm = 0.9154, lr_0 = 6.4565e-04
Validation rmse = 0.943893
Epoch 7
Loss = 3.2141e-03, PNorm = 101.8965, GNorm = 2.4548, lr_0 = 6.2476e-04
Loss = 2.6581e-03, PNorm = 101.9537, GNorm = 1.5250, lr_0 = 6.0454e-04
Validation rmse = 0.875970
Epoch 8
Loss = 3.1413e-03, PNorm = 101.9913, GNorm = 1.9500, lr_0 = 5.8498e-04
Loss = 2.4341e-03, PNorm = 102.0379, GNorm = 0.4271, lr_0 = 5.6605e-04
Loss = 2.5292e-03, PNorm = 102.0805, GNorm = 0.7504, lr_0 = 5.4774e-04
Validation rmse = 0.774289
Epoch 9
Loss = 2.8930e-03, PNorm = 102.1208, GNorm = 2.0734, lr_0 = 5.3001e-04
Loss = 3.3419e-03, PNorm = 102.1622, GNorm = 3.1532, lr_0 = 5.1286e-04
Validation rmse = 0.777389
Epoch 10
Loss = 2.6820e-03, PNorm = 102.2004, GNorm = 1.5318, lr_0 = 4.9627e-04
Loss = 2.5476e-03, PNorm = 102.2386, GNorm = 1.7638, lr_0 = 4.8021e-04
Loss = 2.6337e-03, PNorm = 102.2809, GNorm = 2.6610, lr_0 = 4.6467e-04
Validation rmse = 0.780459
Epoch 11
Loss = 1.8854e-03, PNorm = 102.3015, GNorm = 1.3282, lr_0 = 4.4963e-04
Loss = 2.1389e-03, PNorm = 102.3329, GNorm = 1.1839, lr_0 = 4.3508e-04
Validation rmse = 0.715384
Epoch 12
Loss = 1.1675e-03, PNorm = 102.3688, GNorm = 0.6778, lr_0 = 4.1962e-04
Loss = 2.0477e-03, PNorm = 102.3946, GNorm = 3.4785, lr_0 = 4.0604e-04
Loss = 1.5829e-03, PNorm = 102.4277, GNorm = 0.9486, lr_0 = 3.9290e-04
Validation rmse = 0.711997
Epoch 13
Loss = 1.5546e-03, PNorm = 102.4505, GNorm = 0.5769, lr_0 = 3.8019e-04
Loss = 1.6947e-03, PNorm = 102.4697, GNorm = 2.8438, lr_0 = 3.6789e-04
Loss = 2.0949e-03, PNorm = 102.4949, GNorm = 3.2885, lr_0 = 3.5598e-04
Validation rmse = 0.714245
Epoch 14
Loss = 1.8010e-03, PNorm = 102.5160, GNorm = 2.2398, lr_0 = 3.4446e-04
Loss = 2.0652e-03, PNorm = 102.5506, GNorm = 1.4579, lr_0 = 3.3332e-04
Validation rmse = 0.934883
Epoch 15
Loss = 2.3907e-03, PNorm = 102.5765, GNorm = 1.0130, lr_0 = 3.2253e-04
Loss = 1.7341e-03, PNorm = 102.5992, GNorm = 0.6916, lr_0 = 3.1209e-04
Loss = 2.1594e-03, PNorm = 102.6267, GNorm = 2.7618, lr_0 = 3.0200e-04
Validation rmse = 0.735794
Epoch 16
Loss = 1.4253e-03, PNorm = 102.6473, GNorm = 0.6712, lr_0 = 2.9222e-04
Loss = 1.4463e-03, PNorm = 102.6648, GNorm = 0.4605, lr_0 = 2.8277e-04
Validation rmse = 0.698903
Epoch 17
Loss = 1.2063e-03, PNorm = 102.6817, GNorm = 2.5196, lr_0 = 2.7272e-04
Loss = 1.2153e-03, PNorm = 102.7004, GNorm = 1.4015, lr_0 = 2.6389e-04
Loss = 1.6321e-03, PNorm = 102.7221, GNorm = 3.4415, lr_0 = 2.5535e-04
Validation rmse = 0.711364
Epoch 18
Loss = 1.3694e-03, PNorm = 102.7398, GNorm = 0.5233, lr_0 = 2.4709e-04
Loss = 1.3741e-03, PNorm = 102.7605, GNorm = 0.4412, lr_0 = 2.3910e-04
Loss = 1.1567e-03, PNorm = 102.7724, GNorm = 0.5337, lr_0 = 2.3136e-04
Validation rmse = 0.696211
Epoch 19
Loss = 1.4229e-03, PNorm = 102.7897, GNorm = 1.3114, lr_0 = 2.2387e-04
Loss = 1.1310e-03, PNorm = 102.8056, GNorm = 0.5491, lr_0 = 2.1663e-04
Validation rmse = 0.694470
Epoch 20
Loss = 1.1583e-03, PNorm = 102.8224, GNorm = 2.9157, lr_0 = 2.0962e-04
Loss = 1.0232e-03, PNorm = 102.8395, GNorm = 0.6541, lr_0 = 2.0283e-04
Loss = 1.1021e-03, PNorm = 102.8500, GNorm = 0.6612, lr_0 = 1.9627e-04
Validation rmse = 0.668249
Epoch 21
Loss = 1.0182e-03, PNorm = 102.8625, GNorm = 0.7751, lr_0 = 1.8992e-04
Loss = 1.0845e-03, PNorm = 102.8766, GNorm = 1.2024, lr_0 = 1.8377e-04
Validation rmse = 0.689679
Epoch 22
Loss = 1.0209e-03, PNorm = 102.8914, GNorm = 0.5646, lr_0 = 1.7783e-04
Loss = 1.1431e-03, PNorm = 102.9069, GNorm = 0.7241, lr_0 = 1.7207e-04
Loss = 9.8735e-04, PNorm = 102.9214, GNorm = 0.5704, lr_0 = 1.6651e-04
Validation rmse = 0.682935
Epoch 23
Loss = 1.0378e-03, PNorm = 102.9371, GNorm = 0.6863, lr_0 = 1.6059e-04
Loss = 1.0097e-03, PNorm = 102.9484, GNorm = 0.7096, lr_0 = 1.5539e-04
Validation rmse = 0.686088
Epoch 24
Loss = 9.9870e-04, PNorm = 102.9587, GNorm = 0.2631, lr_0 = 1.5036e-04
Loss = 8.1605e-04, PNorm = 102.9704, GNorm = 1.1820, lr_0 = 1.4550e-04
Loss = 9.9115e-04, PNorm = 102.9819, GNorm = 2.2542, lr_0 = 1.4079e-04
Validation rmse = 0.689002
Epoch 25
Loss = 1.0494e-03, PNorm = 102.9941, GNorm = 2.1138, lr_0 = 1.3623e-04
Loss = 1.0056e-03, PNorm = 103.0069, GNorm = 0.8591, lr_0 = 1.3183e-04
Loss = 1.0261e-03, PNorm = 103.0159, GNorm = 1.7528, lr_0 = 1.2756e-04
Validation rmse = 0.677621
Epoch 26
Loss = 9.0066e-04, PNorm = 103.0268, GNorm = 1.8518, lr_0 = 1.2343e-04
Loss = 8.2746e-04, PNorm = 103.0353, GNorm = 0.4791, lr_0 = 1.1944e-04
Validation rmse = 0.700307
Epoch 27
Loss = 9.7244e-04, PNorm = 103.0447, GNorm = 0.4977, lr_0 = 1.1557e-04
Loss = 9.1623e-04, PNorm = 103.0548, GNorm = 0.5517, lr_0 = 1.1183e-04
Loss = 7.2517e-04, PNorm = 103.0633, GNorm = 0.9571, lr_0 = 1.0821e-04
Validation rmse = 0.697186
Epoch 28
Loss = 7.7817e-04, PNorm = 103.0713, GNorm = 0.8214, lr_0 = 1.0437e-04
Loss = 8.4370e-04, PNorm = 103.0801, GNorm = 0.2964, lr_0 = 1.0099e-04
Validation rmse = 0.694325
Epoch 29
Loss = 8.8430e-04, PNorm = 103.0874, GNorm = 0.2438, lr_0 = 1.0000e-04
Loss = 8.3024e-04, PNorm = 103.0957, GNorm = 1.7787, lr_0 = 1.0000e-04
Loss = 6.6188e-04, PNorm = 103.1026, GNorm = 0.9398, lr_0 = 1.0000e-04
Validation rmse = 0.693980
Model 0 best validation rmse = 0.668249 on epoch 20
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.717577
Ensemble test rmse = 0.717577
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2400, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,721,601
Moving model to cuda
Epoch 0
Loss = 1.8219e-02, PNorm = 99.7623, GNorm = 3.7967, lr_0 = 2.9800e-04
Loss = 1.4553e-02, PNorm = 99.8639, GNorm = 5.1766, lr_0 = 4.7800e-04
Validation rmse = 1.556913
Epoch 1
Loss = 9.8663e-03, PNorm = 100.0511, GNorm = 4.6699, lr_0 = 6.7600e-04
Loss = 9.0733e-03, PNorm = 100.2716, GNorm = 1.5385, lr_0 = 8.5600e-04
Loss = 7.1470e-03, PNorm = 100.4925, GNorm = 3.1158, lr_0 = 9.9344e-04
Validation rmse = 1.421346
Epoch 2
Loss = 9.3170e-03, PNorm = 100.7181, GNorm = 1.2043, lr_0 = 9.6130e-04
Loss = 7.1495e-03, PNorm = 100.9306, GNorm = 2.3987, lr_0 = 9.3019e-04
Validation rmse = 1.100608
Epoch 3
Loss = 4.4921e-03, PNorm = 101.0845, GNorm = 1.0469, lr_0 = 9.0009e-04
Loss = 4.9581e-03, PNorm = 101.2122, GNorm = 1.3698, lr_0 = 8.7096e-04
Loss = 5.0183e-03, PNorm = 101.3084, GNorm = 1.1010, lr_0 = 8.4278e-04
Validation rmse = 1.024846
Epoch 4
Loss = 4.0598e-03, PNorm = 101.3892, GNorm = 2.0408, lr_0 = 8.1551e-04
Loss = 3.5218e-03, PNorm = 101.4710, GNorm = 1.9857, lr_0 = 7.8912e-04
Validation rmse = 0.960901
Epoch 5
Loss = 2.9356e-03, PNorm = 101.5358, GNorm = 1.6383, lr_0 = 7.6358e-04
Loss = 3.5404e-03, PNorm = 101.5954, GNorm = 2.9945, lr_0 = 7.3888e-04
Loss = 3.7791e-03, PNorm = 101.6550, GNorm = 1.1047, lr_0 = 7.1497e-04
Validation rmse = 1.015023
Epoch 6
Loss = 3.1350e-03, PNorm = 101.7204, GNorm = 1.2736, lr_0 = 6.8956e-04
Loss = 3.3609e-03, PNorm = 101.7628, GNorm = 2.1235, lr_0 = 6.6725e-04
Loss = 3.4584e-03, PNorm = 101.8075, GNorm = 5.7101, lr_0 = 6.4565e-04
Validation rmse = 0.879062
Epoch 7
Loss = 2.7785e-03, PNorm = 101.8634, GNorm = 2.5654, lr_0 = 6.2476e-04
Loss = 3.0960e-03, PNorm = 101.9087, GNorm = 2.1148, lr_0 = 6.0454e-04
Validation rmse = 0.888906
Epoch 8
Loss = 2.5548e-03, PNorm = 101.9512, GNorm = 0.5190, lr_0 = 5.8498e-04
Loss = 2.2232e-03, PNorm = 101.9910, GNorm = 0.7820, lr_0 = 5.6605e-04
Loss = 2.1269e-03, PNorm = 102.0305, GNorm = 0.6362, lr_0 = 5.4774e-04
Validation rmse = 0.834373
Epoch 9
Loss = 2.1073e-03, PNorm = 102.0695, GNorm = 0.3851, lr_0 = 5.3001e-04
Loss = 1.9664e-03, PNorm = 102.1086, GNorm = 1.5029, lr_0 = 5.1286e-04
Validation rmse = 0.797119
Epoch 10
Loss = 1.2528e-03, PNorm = 102.1415, GNorm = 1.3494, lr_0 = 4.9627e-04
Loss = 1.8382e-03, PNorm = 102.1757, GNorm = 1.2237, lr_0 = 4.8021e-04
Loss = 1.9949e-03, PNorm = 102.2066, GNorm = 1.7510, lr_0 = 4.6467e-04
Validation rmse = 0.760974
Epoch 11
Loss = 1.3943e-03, PNorm = 102.2338, GNorm = 1.4510, lr_0 = 4.4963e-04
Loss = 1.9759e-03, PNorm = 102.2675, GNorm = 2.2172, lr_0 = 4.3508e-04
Validation rmse = 0.830239
Epoch 12
Loss = 2.8043e-03, PNorm = 102.3052, GNorm = 2.8223, lr_0 = 4.1962e-04
Loss = 1.8486e-03, PNorm = 102.3374, GNorm = 1.0081, lr_0 = 4.0604e-04
Loss = 1.7689e-03, PNorm = 102.3663, GNorm = 1.7163, lr_0 = 3.9290e-04
Validation rmse = 0.761740
Epoch 13
Loss = 1.9050e-03, PNorm = 102.3940, GNorm = 0.7903, lr_0 = 3.8019e-04
Loss = 1.7130e-03, PNorm = 102.4191, GNorm = 1.4676, lr_0 = 3.6789e-04
Loss = 1.6957e-03, PNorm = 102.4533, GNorm = 1.0235, lr_0 = 3.5598e-04
Validation rmse = 0.746744
Epoch 14
Loss = 1.4184e-03, PNorm = 102.4851, GNorm = 1.3480, lr_0 = 3.4446e-04
Loss = 1.4134e-03, PNorm = 102.5057, GNorm = 1.3382, lr_0 = 3.3332e-04
Validation rmse = 0.753019
Epoch 15
Loss = 1.2403e-03, PNorm = 102.5257, GNorm = 0.7634, lr_0 = 3.2253e-04
Loss = 1.3985e-03, PNorm = 102.5505, GNorm = 2.9820, lr_0 = 3.1209e-04
Loss = 1.2938e-03, PNorm = 102.5736, GNorm = 1.8551, lr_0 = 3.0200e-04
Validation rmse = 0.717515
Epoch 16
Loss = 1.5236e-03, PNorm = 102.6024, GNorm = 1.1695, lr_0 = 2.9222e-04
Loss = 1.5315e-03, PNorm = 102.6266, GNorm = 0.9288, lr_0 = 2.8277e-04
Validation rmse = 0.696797
Epoch 17
Loss = 1.2107e-03, PNorm = 102.6445, GNorm = 0.9269, lr_0 = 2.7272e-04
Loss = 1.0682e-03, PNorm = 102.6628, GNorm = 1.0928, lr_0 = 2.6389e-04
Loss = 1.1449e-03, PNorm = 102.6853, GNorm = 0.6409, lr_0 = 2.5535e-04
Validation rmse = 0.751848
Epoch 18
Loss = 1.1765e-03, PNorm = 102.7008, GNorm = 2.6451, lr_0 = 2.4709e-04
Loss = 1.5184e-03, PNorm = 102.7188, GNorm = 0.8820, lr_0 = 2.3910e-04
Loss = 1.0082e-03, PNorm = 102.7419, GNorm = 1.0239, lr_0 = 2.3136e-04
Validation rmse = 0.694750
Epoch 19
Loss = 1.1641e-03, PNorm = 102.7614, GNorm = 0.9397, lr_0 = 2.2387e-04
Loss = 9.6951e-04, PNorm = 102.7785, GNorm = 0.7464, lr_0 = 2.1663e-04
Validation rmse = 0.701228
Epoch 20
Loss = 1.0928e-03, PNorm = 102.7949, GNorm = 0.9303, lr_0 = 2.0962e-04
Loss = 1.1698e-03, PNorm = 102.8140, GNorm = 2.4861, lr_0 = 2.0283e-04
Loss = 1.3796e-03, PNorm = 102.8294, GNorm = 1.3899, lr_0 = 1.9627e-04
Validation rmse = 0.763687
Epoch 21
Loss = 1.0192e-03, PNorm = 102.8438, GNorm = 0.2592, lr_0 = 1.8992e-04
Loss = 1.1466e-03, PNorm = 102.8593, GNorm = 0.6373, lr_0 = 1.8377e-04
Validation rmse = 0.706881
Epoch 22
Loss = 1.2059e-03, PNorm = 102.8742, GNorm = 1.2653, lr_0 = 1.7783e-04
Loss = 1.0040e-03, PNorm = 102.8892, GNorm = 1.1784, lr_0 = 1.7207e-04
Loss = 7.8544e-04, PNorm = 102.9008, GNorm = 0.7831, lr_0 = 1.6651e-04
Validation rmse = 0.695567
Epoch 23
Loss = 9.7718e-04, PNorm = 102.9124, GNorm = 0.6683, lr_0 = 1.6059e-04
Loss = 7.5138e-04, PNorm = 102.9238, GNorm = 0.6724, lr_0 = 1.5539e-04
Validation rmse = 0.720823
Epoch 24
Loss = 6.2383e-04, PNorm = 102.9360, GNorm = 0.8608, lr_0 = 1.5036e-04
Loss = 8.3562e-04, PNorm = 102.9502, GNorm = 0.8887, lr_0 = 1.4550e-04
Loss = 8.4329e-04, PNorm = 102.9598, GNorm = 0.5082, lr_0 = 1.4079e-04
Validation rmse = 0.740034
Epoch 25
Loss = 8.1735e-04, PNorm = 102.9691, GNorm = 1.7133, lr_0 = 1.3623e-04
Loss = 8.3472e-04, PNorm = 102.9791, GNorm = 1.6580, lr_0 = 1.3183e-04
Loss = 9.3129e-04, PNorm = 102.9915, GNorm = 1.0262, lr_0 = 1.2756e-04
Validation rmse = 0.694895
Epoch 26
Loss = 7.8264e-04, PNorm = 103.0027, GNorm = 0.5142, lr_0 = 1.2343e-04
Loss = 7.9479e-04, PNorm = 103.0122, GNorm = 0.4659, lr_0 = 1.1944e-04
Validation rmse = 0.713064
Epoch 27
Loss = 6.8069e-04, PNorm = 103.0208, GNorm = 0.5923, lr_0 = 1.1557e-04
Loss = 7.9044e-04, PNorm = 103.0304, GNorm = 0.6700, lr_0 = 1.1183e-04
Loss = 7.1267e-04, PNorm = 103.0380, GNorm = 0.6191, lr_0 = 1.0821e-04
Validation rmse = 0.716316
Epoch 28
Loss = 6.4523e-04, PNorm = 103.0473, GNorm = 0.5321, lr_0 = 1.0437e-04
Loss = 8.3005e-04, PNorm = 103.0560, GNorm = 0.5937, lr_0 = 1.0099e-04
Validation rmse = 0.718076
Epoch 29
Loss = 4.9537e-04, PNorm = 103.0647, GNorm = 0.3460, lr_0 = 1.0000e-04
Loss = 6.3521e-04, PNorm = 103.0712, GNorm = 0.3740, lr_0 = 1.0000e-04
Loss = 7.8727e-04, PNorm = 103.0786, GNorm = 0.6124, lr_0 = 1.0000e-04
Validation rmse = 0.690732
Model 0 best validation rmse = 0.690732 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.815443
Ensemble test rmse = 0.815443
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2400, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,721,601
Moving model to cuda
Epoch 0
Loss = 2.0194e-02, PNorm = 99.7632, GNorm = 1.4490, lr_0 = 2.9800e-04
Loss = 1.6583e-02, PNorm = 99.8604, GNorm = 1.9829, lr_0 = 4.7800e-04
Validation rmse = 1.952227
Epoch 1
Loss = 1.0370e-02, PNorm = 100.0189, GNorm = 4.2000, lr_0 = 6.7600e-04
Loss = 8.7761e-03, PNorm = 100.1988, GNorm = 2.4566, lr_0 = 8.5600e-04
Loss = 8.2441e-03, PNorm = 100.4008, GNorm = 2.6520, lr_0 = 9.9344e-04
Validation rmse = 1.540745
Epoch 2
Loss = 7.4816e-03, PNorm = 100.6090, GNorm = 3.7819, lr_0 = 9.6130e-04
Loss = 5.3785e-03, PNorm = 100.7869, GNorm = 4.7269, lr_0 = 9.3019e-04
Validation rmse = 1.175368
Epoch 3
Loss = 4.3281e-03, PNorm = 100.9243, GNorm = 2.1678, lr_0 = 9.0009e-04
Loss = 4.3160e-03, PNorm = 101.0366, GNorm = 3.3919, lr_0 = 8.7096e-04
Loss = 4.4696e-03, PNorm = 101.1383, GNorm = 2.0362, lr_0 = 8.4278e-04
Validation rmse = 1.090455
Epoch 4
Loss = 3.6420e-03, PNorm = 101.2089, GNorm = 3.0036, lr_0 = 8.1551e-04
Loss = 3.1756e-03, PNorm = 101.2843, GNorm = 5.1940, lr_0 = 7.8912e-04
Validation rmse = 1.109006
Epoch 5
Loss = 3.8915e-03, PNorm = 101.3529, GNorm = 2.3721, lr_0 = 7.6358e-04
Loss = 2.8815e-03, PNorm = 101.4150, GNorm = 1.2233, lr_0 = 7.3888e-04
Loss = 4.1045e-03, PNorm = 101.4662, GNorm = 4.2239, lr_0 = 7.1497e-04
Validation rmse = 1.201846
Epoch 6
Loss = 4.2395e-03, PNorm = 101.5282, GNorm = 2.0960, lr_0 = 6.8956e-04
Loss = 4.5992e-03, PNorm = 101.6009, GNorm = 0.7681, lr_0 = 6.6725e-04
Loss = 3.5288e-03, PNorm = 101.6477, GNorm = 3.1301, lr_0 = 6.4565e-04
Validation rmse = 0.954391
Epoch 7
Loss = 2.4842e-03, PNorm = 101.6916, GNorm = 2.0933, lr_0 = 6.2476e-04
Loss = 2.5206e-03, PNorm = 101.7292, GNorm = 0.9157, lr_0 = 6.0454e-04
Validation rmse = 0.922000
Epoch 8
Loss = 2.0337e-03, PNorm = 101.7665, GNorm = 1.9444, lr_0 = 5.8498e-04
Loss = 2.4563e-03, PNorm = 101.8095, GNorm = 3.8454, lr_0 = 5.6605e-04
Loss = 2.8604e-03, PNorm = 101.8424, GNorm = 0.5794, lr_0 = 5.4774e-04
Validation rmse = 0.876307
Epoch 9
Loss = 2.3510e-03, PNorm = 101.8823, GNorm = 3.4109, lr_0 = 5.3001e-04
Loss = 2.4117e-03, PNorm = 101.9207, GNorm = 1.0169, lr_0 = 5.1286e-04
Validation rmse = 0.830060
Epoch 10
Loss = 1.6218e-03, PNorm = 101.9528, GNorm = 0.7037, lr_0 = 4.9627e-04
Loss = 2.0395e-03, PNorm = 101.9849, GNorm = 0.9519, lr_0 = 4.8021e-04
Loss = 1.6594e-03, PNorm = 102.0163, GNorm = 1.3281, lr_0 = 4.6467e-04
Validation rmse = 0.876866
Epoch 11
Loss = 1.7349e-03, PNorm = 102.0426, GNorm = 3.1620, lr_0 = 4.4963e-04
Loss = 2.9419e-03, PNorm = 102.0779, GNorm = 2.6108, lr_0 = 4.3508e-04
Validation rmse = 0.865967
Epoch 12
Loss = 1.7005e-03, PNorm = 102.1181, GNorm = 0.7769, lr_0 = 4.1962e-04
Loss = 1.6380e-03, PNorm = 102.1491, GNorm = 3.3231, lr_0 = 4.0604e-04
Loss = 1.6365e-03, PNorm = 102.1776, GNorm = 0.4146, lr_0 = 3.9290e-04
Validation rmse = 0.910638
Epoch 13
Loss = 2.0739e-03, PNorm = 102.2004, GNorm = 4.5960, lr_0 = 3.8019e-04
Loss = 1.8501e-03, PNorm = 102.2290, GNorm = 3.2998, lr_0 = 3.6789e-04
Loss = 1.5304e-03, PNorm = 102.2583, GNorm = 1.7412, lr_0 = 3.5598e-04
Validation rmse = 0.787635
Epoch 14
Loss = 1.3296e-03, PNorm = 102.2832, GNorm = 1.3711, lr_0 = 3.4446e-04
Loss = 1.3819e-03, PNorm = 102.3069, GNorm = 2.5903, lr_0 = 3.3332e-04
Validation rmse = 0.775006
Epoch 15
Loss = 1.2866e-03, PNorm = 102.3320, GNorm = 1.9319, lr_0 = 3.2253e-04
Loss = 1.6339e-03, PNorm = 102.3523, GNorm = 2.1983, lr_0 = 3.1209e-04
Loss = 1.3822e-03, PNorm = 102.3781, GNorm = 1.8682, lr_0 = 3.0200e-04
Validation rmse = 0.881411
Epoch 16
Loss = 1.4173e-03, PNorm = 102.4055, GNorm = 1.2648, lr_0 = 2.9222e-04
Loss = 1.3610e-03, PNorm = 102.4306, GNorm = 0.6675, lr_0 = 2.8277e-04
Validation rmse = 0.780371
Epoch 17
Loss = 1.5286e-03, PNorm = 102.4474, GNorm = 1.9521, lr_0 = 2.7272e-04
Loss = 1.4225e-03, PNorm = 102.4671, GNorm = 3.2503, lr_0 = 2.6389e-04
Loss = 1.4136e-03, PNorm = 102.4904, GNorm = 1.7742, lr_0 = 2.5535e-04
Validation rmse = 0.816335
Epoch 18
Loss = 1.0747e-03, PNorm = 102.5095, GNorm = 0.8109, lr_0 = 2.4709e-04
Loss = 1.2850e-03, PNorm = 102.5259, GNorm = 2.0855, lr_0 = 2.3910e-04
Loss = 1.1602e-03, PNorm = 102.5443, GNorm = 1.5958, lr_0 = 2.3136e-04
Validation rmse = 0.879118
Epoch 19
Loss = 1.1368e-03, PNorm = 102.5601, GNorm = 0.5787, lr_0 = 2.2387e-04
Loss = 1.1281e-03, PNorm = 102.5782, GNorm = 0.6696, lr_0 = 2.1663e-04
Validation rmse = 0.777223
Epoch 20
Loss = 6.9456e-04, PNorm = 102.5960, GNorm = 1.3670, lr_0 = 2.0962e-04
Loss = 1.0219e-03, PNorm = 102.6120, GNorm = 0.4752, lr_0 = 2.0283e-04
Loss = 1.1392e-03, PNorm = 102.6265, GNorm = 2.4659, lr_0 = 1.9627e-04
Validation rmse = 0.830073
Epoch 21
Loss = 9.3583e-04, PNorm = 102.6432, GNorm = 0.3457, lr_0 = 1.8992e-04
Loss = 1.0426e-03, PNorm = 102.6595, GNorm = 1.4985, lr_0 = 1.8377e-04
Validation rmse = 0.785868
Epoch 22
Loss = 7.3322e-04, PNorm = 102.6725, GNorm = 0.3659, lr_0 = 1.7783e-04
Loss = 8.4837e-04, PNorm = 102.6836, GNorm = 0.5907, lr_0 = 1.7207e-04
Loss = 1.0677e-03, PNorm = 102.6969, GNorm = 0.6663, lr_0 = 1.6651e-04
Validation rmse = 0.776364
Epoch 23
Loss = 9.3613e-04, PNorm = 102.7165, GNorm = 1.6918, lr_0 = 1.6059e-04
Loss = 8.6200e-04, PNorm = 102.7312, GNorm = 1.9322, lr_0 = 1.5539e-04
Validation rmse = 0.765548
Epoch 24
Loss = 5.3967e-04, PNorm = 102.7412, GNorm = 0.5054, lr_0 = 1.5036e-04
Loss = 8.9454e-04, PNorm = 102.7507, GNorm = 1.1052, lr_0 = 1.4550e-04
Loss = 1.0462e-03, PNorm = 102.7637, GNorm = 1.7450, lr_0 = 1.4079e-04
Validation rmse = 0.792135
Epoch 25
Loss = 9.4957e-04, PNorm = 102.7757, GNorm = 1.2232, lr_0 = 1.3623e-04
Loss = 8.6375e-04, PNorm = 102.7871, GNorm = 1.4242, lr_0 = 1.3183e-04
Loss = 7.6391e-04, PNorm = 102.7963, GNorm = 1.5455, lr_0 = 1.2756e-04
Validation rmse = 0.795308
Epoch 26
Loss = 7.4487e-04, PNorm = 102.8053, GNorm = 0.8389, lr_0 = 1.2343e-04
Loss = 8.4125e-04, PNorm = 102.8153, GNorm = 0.8362, lr_0 = 1.1944e-04
Validation rmse = 0.773500
Epoch 27
Loss = 7.0217e-04, PNorm = 102.8257, GNorm = 0.6865, lr_0 = 1.1557e-04
Loss = 7.0046e-04, PNorm = 102.8342, GNorm = 0.2610, lr_0 = 1.1183e-04
Loss = 8.3303e-04, PNorm = 102.8424, GNorm = 0.7188, lr_0 = 1.0821e-04
Validation rmse = 0.781073
Epoch 28
Loss = 6.1840e-04, PNorm = 102.8527, GNorm = 0.7583, lr_0 = 1.0437e-04
Loss = 7.4665e-04, PNorm = 102.8607, GNorm = 0.3669, lr_0 = 1.0099e-04
Validation rmse = 0.808223
Epoch 29
Loss = 1.0557e-03, PNorm = 102.8701, GNorm = 0.3800, lr_0 = 1.0000e-04
Loss = 6.9404e-04, PNorm = 102.8793, GNorm = 0.3807, lr_0 = 1.0000e-04
Loss = 6.2633e-04, PNorm = 102.8855, GNorm = 0.5429, lr_0 = 1.0000e-04
Validation rmse = 0.773746
Model 0 best validation rmse = 0.765548 on epoch 23
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.948297
Ensemble test rmse = 0.948297
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2400, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,721,601
Moving model to cuda
Epoch 0
Loss = 1.7960e-02, PNorm = 99.7659, GNorm = 5.5194, lr_0 = 2.9800e-04
Loss = 1.4055e-02, PNorm = 99.8566, GNorm = 9.5239, lr_0 = 4.7800e-04
Validation rmse = 1.653183
Epoch 1
Loss = 8.1339e-03, PNorm = 100.0181, GNorm = 1.8967, lr_0 = 6.7600e-04
Loss = 7.7191e-03, PNorm = 100.2028, GNorm = 6.1978, lr_0 = 8.5600e-04
Loss = 9.0789e-03, PNorm = 100.4179, GNorm = 1.7333, lr_0 = 9.9344e-04
Validation rmse = 1.870223
Epoch 2
Loss = 8.2604e-03, PNorm = 100.6552, GNorm = 0.8647, lr_0 = 9.6130e-04
Loss = 6.6654e-03, PNorm = 100.8643, GNorm = 4.9947, lr_0 = 9.3019e-04
Validation rmse = 1.300923
Epoch 3
Loss = 5.1582e-03, PNorm = 101.0270, GNorm = 3.3662, lr_0 = 9.0009e-04
Loss = 4.5576e-03, PNorm = 101.1352, GNorm = 3.0627, lr_0 = 8.7096e-04
Loss = 4.6286e-03, PNorm = 101.2282, GNorm = 0.7777, lr_0 = 8.4278e-04
Validation rmse = 1.170836
Epoch 4
Loss = 4.3715e-03, PNorm = 101.3184, GNorm = 1.7147, lr_0 = 8.1551e-04
Loss = 3.9335e-03, PNorm = 101.3947, GNorm = 6.6648, lr_0 = 7.8912e-04
Validation rmse = 1.069462
Epoch 5
Loss = 3.3071e-03, PNorm = 101.4643, GNorm = 1.6722, lr_0 = 7.6358e-04
Loss = 2.9359e-03, PNorm = 101.5335, GNorm = 0.9728, lr_0 = 7.3888e-04
Loss = 3.5677e-03, PNorm = 101.6064, GNorm = 5.6236, lr_0 = 7.1497e-04
Validation rmse = 1.261461
Epoch 6
Loss = 3.9516e-03, PNorm = 101.6879, GNorm = 5.3982, lr_0 = 6.8956e-04
Loss = 3.3495e-03, PNorm = 101.7455, GNorm = 0.9313, lr_0 = 6.6725e-04
Loss = 2.7239e-03, PNorm = 101.7978, GNorm = 2.7713, lr_0 = 6.4565e-04
Validation rmse = 1.069814
Epoch 7
Loss = 2.2582e-03, PNorm = 101.8523, GNorm = 0.9218, lr_0 = 6.2476e-04
Loss = 2.8900e-03, PNorm = 101.9000, GNorm = 2.5394, lr_0 = 6.0454e-04
Validation rmse = 0.989408
Epoch 8
Loss = 2.4449e-03, PNorm = 101.9493, GNorm = 2.9756, lr_0 = 5.8498e-04
Loss = 2.4303e-03, PNorm = 101.9975, GNorm = 6.7118, lr_0 = 5.6605e-04
Loss = 3.0665e-03, PNorm = 102.0374, GNorm = 2.3838, lr_0 = 5.4774e-04
Validation rmse = 1.185304
Epoch 9
Loss = 2.9112e-03, PNorm = 102.0846, GNorm = 1.5577, lr_0 = 5.3001e-04
Loss = 2.5076e-03, PNorm = 102.1420, GNorm = 1.8696, lr_0 = 5.1286e-04
Validation rmse = 0.965663
Epoch 10
Loss = 1.9062e-03, PNorm = 102.1814, GNorm = 2.3028, lr_0 = 4.9627e-04
Loss = 1.7744e-03, PNorm = 102.2180, GNorm = 0.3242, lr_0 = 4.8021e-04
Loss = 2.3623e-03, PNorm = 102.2583, GNorm = 2.1600, lr_0 = 4.6467e-04
Validation rmse = 0.916231
Epoch 11
Loss = 1.5021e-03, PNorm = 102.2929, GNorm = 0.7338, lr_0 = 4.4963e-04
Loss = 2.0403e-03, PNorm = 102.3211, GNorm = 1.1533, lr_0 = 4.3508e-04
Validation rmse = 0.820937
Epoch 12
Loss = 1.6920e-03, PNorm = 102.3475, GNorm = 0.6223, lr_0 = 4.1962e-04
Loss = 1.9505e-03, PNorm = 102.3727, GNorm = 1.8253, lr_0 = 4.0604e-04
Loss = 1.8658e-03, PNorm = 102.4005, GNorm = 2.0322, lr_0 = 3.9290e-04
Validation rmse = 0.999666
Epoch 13
Loss = 1.8552e-03, PNorm = 102.4310, GNorm = 2.2618, lr_0 = 3.8019e-04
Loss = 1.5951e-03, PNorm = 102.4522, GNorm = 0.6171, lr_0 = 3.6789e-04
Loss = 1.5145e-03, PNorm = 102.4789, GNorm = 0.3779, lr_0 = 3.5598e-04
Validation rmse = 0.843252
Epoch 14
Loss = 1.8083e-03, PNorm = 102.5094, GNorm = 1.5739, lr_0 = 3.4446e-04
Loss = 2.1000e-03, PNorm = 102.5375, GNorm = 1.4061, lr_0 = 3.3332e-04
Validation rmse = 0.951185
Epoch 15
Loss = 2.1565e-03, PNorm = 102.5663, GNorm = 2.0169, lr_0 = 3.2253e-04
Loss = 1.7449e-03, PNorm = 102.5908, GNorm = 0.7359, lr_0 = 3.1209e-04
Loss = 1.3136e-03, PNorm = 102.6085, GNorm = 1.1492, lr_0 = 3.0200e-04
Validation rmse = 0.811331
Epoch 16
Loss = 1.5486e-03, PNorm = 102.6322, GNorm = 1.0112, lr_0 = 2.9222e-04
Loss = 1.1425e-03, PNorm = 102.6507, GNorm = 0.3420, lr_0 = 2.8277e-04
Validation rmse = 0.794584
Epoch 17
Loss = 1.2952e-03, PNorm = 102.6731, GNorm = 0.6772, lr_0 = 2.7272e-04
Loss = 1.4080e-03, PNorm = 102.6925, GNorm = 2.2581, lr_0 = 2.6389e-04
Loss = 1.3484e-03, PNorm = 102.7160, GNorm = 0.6045, lr_0 = 2.5535e-04
Validation rmse = 0.853004
Epoch 18
Loss = 1.2467e-03, PNorm = 102.7347, GNorm = 2.8713, lr_0 = 2.4709e-04
Loss = 1.1831e-03, PNorm = 102.7542, GNorm = 1.2173, lr_0 = 2.3910e-04
Loss = 1.3291e-03, PNorm = 102.7664, GNorm = 0.9204, lr_0 = 2.3136e-04
Validation rmse = 0.866473
Epoch 19
Loss = 1.1585e-03, PNorm = 102.7820, GNorm = 0.5201, lr_0 = 2.2387e-04
Loss = 1.4347e-03, PNorm = 102.8008, GNorm = 2.6504, lr_0 = 2.1663e-04
Validation rmse = 0.839130
Epoch 20
Loss = 1.3023e-03, PNorm = 102.8174, GNorm = 1.9452, lr_0 = 2.0962e-04
Loss = 1.5683e-03, PNorm = 102.8355, GNorm = 2.2096, lr_0 = 2.0283e-04
Loss = 1.1728e-03, PNorm = 102.8496, GNorm = 0.8589, lr_0 = 1.9627e-04
Validation rmse = 0.807372
Epoch 21
Loss = 9.8954e-04, PNorm = 102.8639, GNorm = 0.3646, lr_0 = 1.8992e-04
Loss = 1.0635e-03, PNorm = 102.8764, GNorm = 0.8613, lr_0 = 1.8377e-04
Validation rmse = 0.785828
Epoch 22
Loss = 1.0690e-03, PNorm = 102.8888, GNorm = 0.3984, lr_0 = 1.7783e-04
Loss = 7.2201e-04, PNorm = 102.9017, GNorm = 1.9242, lr_0 = 1.7207e-04
Loss = 1.1992e-03, PNorm = 102.9142, GNorm = 1.2466, lr_0 = 1.6651e-04
Validation rmse = 0.883561
Epoch 23
Loss = 9.7082e-04, PNorm = 102.9277, GNorm = 0.7737, lr_0 = 1.6059e-04
Loss = 8.9697e-04, PNorm = 102.9412, GNorm = 1.0843, lr_0 = 1.5539e-04
Validation rmse = 0.764960
Epoch 24
Loss = 7.5114e-04, PNorm = 102.9508, GNorm = 0.8205, lr_0 = 1.5036e-04
Loss = 9.9877e-04, PNorm = 102.9645, GNorm = 0.3323, lr_0 = 1.4550e-04
Loss = 8.9588e-04, PNorm = 102.9754, GNorm = 0.6558, lr_0 = 1.4079e-04
Validation rmse = 0.771832
Epoch 25
Loss = 8.3743e-04, PNorm = 102.9847, GNorm = 0.7208, lr_0 = 1.3623e-04
Loss = 8.5710e-04, PNorm = 102.9952, GNorm = 0.3163, lr_0 = 1.3183e-04
Loss = 9.0389e-04, PNorm = 103.0059, GNorm = 1.4367, lr_0 = 1.2756e-04
Validation rmse = 0.781471
Epoch 26
Loss = 9.4668e-04, PNorm = 103.0160, GNorm = 1.7661, lr_0 = 1.2343e-04
Loss = 7.5628e-04, PNorm = 103.0242, GNorm = 0.8254, lr_0 = 1.1944e-04
Validation rmse = 0.777956
Epoch 27
Loss = 6.5702e-04, PNorm = 103.0312, GNorm = 0.4710, lr_0 = 1.1557e-04
Loss = 8.2981e-04, PNorm = 103.0408, GNorm = 1.8625, lr_0 = 1.1183e-04
Loss = 8.0268e-04, PNorm = 103.0478, GNorm = 0.6663, lr_0 = 1.0821e-04
Validation rmse = 0.761338
Epoch 28
Loss = 9.5610e-04, PNorm = 103.0580, GNorm = 2.1988, lr_0 = 1.0437e-04
Loss = 6.7936e-04, PNorm = 103.0661, GNorm = 0.4328, lr_0 = 1.0099e-04
Validation rmse = 0.761764
Epoch 29
Loss = 4.3070e-04, PNorm = 103.0738, GNorm = 0.7636, lr_0 = 1.0000e-04
Loss = 7.6306e-04, PNorm = 103.0828, GNorm = 0.7904, lr_0 = 1.0000e-04
Loss = 7.2843e-04, PNorm = 103.0914, GNorm = 0.3456, lr_0 = 1.0000e-04
Validation rmse = 0.770412
Model 0 best validation rmse = 0.761338 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.668297
Ensemble test rmse = 0.668297
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2400, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,721,601
Moving model to cuda
Epoch 0
Loss = 1.9433e-02, PNorm = 99.7620, GNorm = 1.4044, lr_0 = 2.9800e-04
Loss = 1.7304e-02, PNorm = 99.8505, GNorm = 9.3143, lr_0 = 4.7800e-04
Validation rmse = 2.114775
Epoch 1
Loss = 1.1979e-02, PNorm = 100.0331, GNorm = 4.4724, lr_0 = 6.7600e-04
Loss = 9.9885e-03, PNorm = 100.2487, GNorm = 7.3068, lr_0 = 8.5600e-04
Loss = 9.3615e-03, PNorm = 100.4894, GNorm = 4.1513, lr_0 = 9.9344e-04
Validation rmse = 1.848473
Epoch 2
Loss = 7.5444e-03, PNorm = 100.7249, GNorm = 2.5700, lr_0 = 9.6130e-04
Loss = 6.3565e-03, PNorm = 100.8773, GNorm = 0.9982, lr_0 = 9.3019e-04
Validation rmse = 1.409461
Epoch 3
Loss = 6.0284e-03, PNorm = 101.0061, GNorm = 1.3352, lr_0 = 9.0009e-04
Loss = 4.5016e-03, PNorm = 101.1308, GNorm = 7.6805, lr_0 = 8.7096e-04
Loss = 3.7020e-03, PNorm = 101.2177, GNorm = 1.3371, lr_0 = 8.4278e-04
Validation rmse = 1.097232
Epoch 4
Loss = 3.2677e-03, PNorm = 101.2927, GNorm = 2.5843, lr_0 = 8.1551e-04
Loss = 4.3455e-03, PNorm = 101.3377, GNorm = 3.7537, lr_0 = 7.8912e-04
Validation rmse = 1.118250
Epoch 5
Loss = 2.6162e-03, PNorm = 101.4015, GNorm = 2.8362, lr_0 = 7.6358e-04
Loss = 3.2156e-03, PNorm = 101.4602, GNorm = 3.4418, lr_0 = 7.3888e-04
Loss = 3.0783e-03, PNorm = 101.5142, GNorm = 2.1682, lr_0 = 7.1497e-04
Validation rmse = 1.048678
Epoch 6
Loss = 2.7797e-03, PNorm = 101.5735, GNorm = 1.5552, lr_0 = 6.8956e-04
Loss = 3.2877e-03, PNorm = 101.6263, GNorm = 6.6992, lr_0 = 6.6725e-04
Loss = 3.9500e-03, PNorm = 101.6774, GNorm = 2.4224, lr_0 = 6.4565e-04
Validation rmse = 1.071660
Epoch 7
Loss = 3.1641e-03, PNorm = 101.7330, GNorm = 2.6316, lr_0 = 6.2476e-04
Loss = 2.4050e-03, PNorm = 101.7789, GNorm = 0.9852, lr_0 = 6.0454e-04
Validation rmse = 1.019502
Epoch 8
Loss = 2.3656e-03, PNorm = 101.8113, GNorm = 2.6303, lr_0 = 5.8498e-04
Loss = 2.3600e-03, PNorm = 101.8495, GNorm = 1.2968, lr_0 = 5.6605e-04
Loss = 3.8235e-03, PNorm = 101.8894, GNorm = 3.8073, lr_0 = 5.4774e-04
Validation rmse = 1.127827
Epoch 9
Loss = 4.5647e-03, PNorm = 101.9462, GNorm = 9.0923, lr_0 = 5.3001e-04
Loss = 3.1312e-03, PNorm = 102.0055, GNorm = 1.2761, lr_0 = 5.1286e-04
Validation rmse = 1.051700
Epoch 10
Loss = 3.1671e-03, PNorm = 102.0544, GNorm = 3.4567, lr_0 = 4.9627e-04
Loss = 2.4948e-03, PNorm = 102.0938, GNorm = 0.7312, lr_0 = 4.8021e-04
Loss = 1.7598e-03, PNorm = 102.1213, GNorm = 0.7233, lr_0 = 4.6467e-04
Validation rmse = 1.061712
Epoch 11
Loss = 2.0918e-03, PNorm = 102.1510, GNorm = 0.8194, lr_0 = 4.4963e-04
Loss = 1.7527e-03, PNorm = 102.1763, GNorm = 0.6833, lr_0 = 4.3508e-04
Validation rmse = 0.981827
Epoch 12
Loss = 1.6594e-03, PNorm = 102.2086, GNorm = 1.1246, lr_0 = 4.1962e-04
Loss = 1.4292e-03, PNorm = 102.2318, GNorm = 0.7979, lr_0 = 4.0604e-04
Loss = 1.8177e-03, PNorm = 102.2505, GNorm = 1.9665, lr_0 = 3.9290e-04
Validation rmse = 1.035435
Epoch 13
Loss = 2.1110e-03, PNorm = 102.2821, GNorm = 2.3795, lr_0 = 3.8019e-04
Loss = 1.8652e-03, PNorm = 102.3066, GNorm = 0.7088, lr_0 = 3.6789e-04
Loss = 1.8229e-03, PNorm = 102.3326, GNorm = 0.5611, lr_0 = 3.5598e-04
Validation rmse = 0.994796
Epoch 14
Loss = 1.7051e-03, PNorm = 102.3593, GNorm = 0.3153, lr_0 = 3.4446e-04
Loss = 1.3325e-03, PNorm = 102.3784, GNorm = 0.6637, lr_0 = 3.3332e-04
Validation rmse = 0.999336
Epoch 15
Loss = 1.0485e-03, PNorm = 102.4003, GNorm = 1.0119, lr_0 = 3.2253e-04
Loss = 2.0175e-03, PNorm = 102.4248, GNorm = 0.3966, lr_0 = 3.1209e-04
Loss = 1.5709e-03, PNorm = 102.4507, GNorm = 2.6205, lr_0 = 3.0200e-04
Validation rmse = 1.017295
Epoch 16
Loss = 1.2815e-03, PNorm = 102.4710, GNorm = 1.0972, lr_0 = 2.9222e-04
Loss = 1.4857e-03, PNorm = 102.4908, GNorm = 0.9477, lr_0 = 2.8277e-04
Validation rmse = 0.959461
Epoch 17
Loss = 1.2118e-03, PNorm = 102.5146, GNorm = 1.1786, lr_0 = 2.7272e-04
Loss = 1.3727e-03, PNorm = 102.5311, GNorm = 0.4257, lr_0 = 2.6389e-04
Loss = 1.1654e-03, PNorm = 102.5468, GNorm = 0.3351, lr_0 = 2.5535e-04
Validation rmse = 1.013173
Epoch 18
Loss = 1.5109e-03, PNorm = 102.5657, GNorm = 1.6237, lr_0 = 2.4709e-04
Loss = 1.0682e-03, PNorm = 102.5837, GNorm = 0.9257, lr_0 = 2.3910e-04
Loss = 1.1430e-03, PNorm = 102.5976, GNorm = 0.4326, lr_0 = 2.3136e-04
Validation rmse = 0.948529
Epoch 19
Loss = 1.0658e-03, PNorm = 102.6105, GNorm = 0.6355, lr_0 = 2.2387e-04
Loss = 1.0615e-03, PNorm = 102.6272, GNorm = 1.9811, lr_0 = 2.1663e-04
Validation rmse = 0.973158
Epoch 20
Loss = 1.0458e-03, PNorm = 102.6416, GNorm = 0.9477, lr_0 = 2.0962e-04
Loss = 1.0447e-03, PNorm = 102.6560, GNorm = 1.1551, lr_0 = 2.0283e-04
Loss = 1.1961e-03, PNorm = 102.6728, GNorm = 1.3232, lr_0 = 1.9627e-04
Validation rmse = 0.959264
Epoch 21
Loss = 1.0075e-03, PNorm = 102.6877, GNorm = 0.4611, lr_0 = 1.8992e-04
Loss = 9.5125e-04, PNorm = 102.7012, GNorm = 1.0390, lr_0 = 1.8377e-04
Validation rmse = 0.953682
Epoch 22
Loss = 8.6367e-04, PNorm = 102.7107, GNorm = 1.0346, lr_0 = 1.7783e-04
Loss = 8.8180e-04, PNorm = 102.7247, GNorm = 1.1809, lr_0 = 1.7207e-04
Loss = 1.1292e-03, PNorm = 102.7392, GNorm = 1.2954, lr_0 = 1.6651e-04
Validation rmse = 0.950463
Epoch 23
Loss = 8.7983e-04, PNorm = 102.7504, GNorm = 0.7215, lr_0 = 1.6059e-04
Loss = 1.0598e-03, PNorm = 102.7609, GNorm = 1.5828, lr_0 = 1.5539e-04
Validation rmse = 0.963613
Epoch 24
Loss = 6.9353e-04, PNorm = 102.7725, GNorm = 0.5834, lr_0 = 1.5036e-04
Loss = 8.5357e-04, PNorm = 102.7845, GNorm = 0.7973, lr_0 = 1.4550e-04
Loss = 9.9764e-04, PNorm = 102.7958, GNorm = 1.2928, lr_0 = 1.4079e-04
Validation rmse = 0.946667
Epoch 25
Loss = 9.9237e-04, PNorm = 102.8050, GNorm = 0.7254, lr_0 = 1.3623e-04
Loss = 6.2568e-04, PNorm = 102.8143, GNorm = 0.3996, lr_0 = 1.3183e-04
Loss = 9.7919e-04, PNorm = 102.8238, GNorm = 0.5807, lr_0 = 1.2756e-04
Validation rmse = 0.948851
Epoch 26
Loss = 7.9702e-04, PNorm = 102.8332, GNorm = 1.6182, lr_0 = 1.2343e-04
Loss = 8.7035e-04, PNorm = 102.8438, GNorm = 0.7104, lr_0 = 1.1944e-04
Validation rmse = 0.934267
Epoch 27
Loss = 8.1095e-04, PNorm = 102.8535, GNorm = 0.4755, lr_0 = 1.1557e-04
Loss = 7.3165e-04, PNorm = 102.8628, GNorm = 1.1888, lr_0 = 1.1183e-04
Loss = 8.2199e-04, PNorm = 102.8719, GNorm = 1.1051, lr_0 = 1.0821e-04
Validation rmse = 0.970696
Epoch 28
Loss = 8.4780e-04, PNorm = 102.8800, GNorm = 0.3751, lr_0 = 1.0437e-04
Loss = 7.5173e-04, PNorm = 102.8882, GNorm = 1.2288, lr_0 = 1.0099e-04
Validation rmse = 0.940873
Epoch 29
Loss = 6.1416e-04, PNorm = 102.8959, GNorm = 0.3094, lr_0 = 1.0000e-04
Loss = 7.2339e-04, PNorm = 102.9024, GNorm = 1.0263, lr_0 = 1.0000e-04
Loss = 9.1362e-04, PNorm = 102.9115, GNorm = 0.6561, lr_0 = 1.0000e-04
Validation rmse = 0.946030
Model 0 best validation rmse = 0.934267 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.743440
Ensemble test rmse = 0.743440
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2400, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,721,601
Moving model to cuda
Epoch 0
Loss = 1.7986e-02, PNorm = 99.7601, GNorm = 2.8145, lr_0 = 2.9800e-04
Loss = 1.2178e-02, PNorm = 99.8530, GNorm = 6.7343, lr_0 = 4.7800e-04
Validation rmse = 1.556492
Epoch 1
Loss = 1.0431e-02, PNorm = 100.0186, GNorm = 4.0998, lr_0 = 6.7600e-04
Loss = 8.3430e-03, PNorm = 100.2207, GNorm = 0.8040, lr_0 = 8.5600e-04
Loss = 7.2869e-03, PNorm = 100.4637, GNorm = 3.7598, lr_0 = 9.9344e-04
Validation rmse = 1.399686
Epoch 2
Loss = 7.6133e-03, PNorm = 100.6867, GNorm = 9.4999, lr_0 = 9.6130e-04
Loss = 6.6417e-03, PNorm = 100.8537, GNorm = 1.7548, lr_0 = 9.3019e-04
Validation rmse = 1.052511
Epoch 3
Loss = 4.9146e-03, PNorm = 100.9964, GNorm = 5.2621, lr_0 = 9.0009e-04
Loss = 4.2290e-03, PNorm = 101.1135, GNorm = 1.6323, lr_0 = 8.7096e-04
Loss = 5.9007e-03, PNorm = 101.2206, GNorm = 1.1323, lr_0 = 8.4278e-04
Validation rmse = 1.078889
Epoch 4
Loss = 3.7845e-03, PNorm = 101.3081, GNorm = 1.3162, lr_0 = 8.1551e-04
Loss = 4.1844e-03, PNorm = 101.3750, GNorm = 1.9421, lr_0 = 7.8912e-04
Validation rmse = 0.870935
Epoch 5
Loss = 3.7337e-03, PNorm = 101.4555, GNorm = 0.9357, lr_0 = 7.6358e-04
Loss = 3.5358e-03, PNorm = 101.5403, GNorm = 2.1995, lr_0 = 7.3888e-04
Loss = 3.5738e-03, PNorm = 101.5984, GNorm = 2.6308, lr_0 = 7.1497e-04
Validation rmse = 0.898491
Epoch 6
Loss = 3.1661e-03, PNorm = 101.6658, GNorm = 0.8216, lr_0 = 6.8956e-04
Loss = 2.5785e-03, PNorm = 101.7253, GNorm = 1.5637, lr_0 = 6.6725e-04
Loss = 2.7980e-03, PNorm = 101.7817, GNorm = 0.7035, lr_0 = 6.4565e-04
Validation rmse = 0.791624
Epoch 7
Loss = 2.7179e-03, PNorm = 101.8449, GNorm = 4.8570, lr_0 = 6.2476e-04
Loss = 2.6906e-03, PNorm = 101.8766, GNorm = 0.5266, lr_0 = 6.0454e-04
Validation rmse = 0.826205
Epoch 8
Loss = 2.4287e-03, PNorm = 101.9193, GNorm = 4.8156, lr_0 = 5.8498e-04
Loss = 2.4694e-03, PNorm = 101.9654, GNorm = 3.0284, lr_0 = 5.6605e-04
Loss = 2.4768e-03, PNorm = 102.0126, GNorm = 2.6053, lr_0 = 5.4774e-04
Validation rmse = 1.034964
Epoch 9
Loss = 2.4668e-03, PNorm = 102.0580, GNorm = 0.4666, lr_0 = 5.3001e-04
Loss = 2.2726e-03, PNorm = 102.0996, GNorm = 2.9071, lr_0 = 5.1286e-04
Validation rmse = 0.813521
Epoch 10
Loss = 2.0960e-03, PNorm = 102.1321, GNorm = 3.4806, lr_0 = 4.9627e-04
Loss = 1.4121e-03, PNorm = 102.1709, GNorm = 1.1856, lr_0 = 4.8021e-04
Loss = 1.9116e-03, PNorm = 102.2005, GNorm = 1.8333, lr_0 = 4.6467e-04
Validation rmse = 0.799463
Epoch 11
Loss = 2.3089e-03, PNorm = 102.2329, GNorm = 3.4585, lr_0 = 4.4963e-04
Loss = 1.6765e-03, PNorm = 102.2697, GNorm = 0.4938, lr_0 = 4.3508e-04
Validation rmse = 0.748854
Epoch 12
Loss = 2.1009e-03, PNorm = 102.3007, GNorm = 2.3467, lr_0 = 4.1962e-04
Loss = 1.5303e-03, PNorm = 102.3345, GNorm = 1.7540, lr_0 = 4.0604e-04
Loss = 1.8606e-03, PNorm = 102.3591, GNorm = 0.8031, lr_0 = 3.9290e-04
Validation rmse = 0.799850
Epoch 13
Loss = 1.6979e-03, PNorm = 102.3855, GNorm = 1.6982, lr_0 = 3.8019e-04
Loss = 1.4990e-03, PNorm = 102.4106, GNorm = 2.5546, lr_0 = 3.6789e-04
Loss = 2.0516e-03, PNorm = 102.4337, GNorm = 4.8352, lr_0 = 3.5598e-04
Validation rmse = 0.784594
Epoch 14
Loss = 1.4256e-03, PNorm = 102.4593, GNorm = 0.8520, lr_0 = 3.4446e-04
Loss = 1.4152e-03, PNorm = 102.4877, GNorm = 0.4275, lr_0 = 3.3332e-04
Validation rmse = 0.726978
Epoch 15
Loss = 6.7861e-04, PNorm = 102.5091, GNorm = 0.6634, lr_0 = 3.2253e-04
Loss = 1.4059e-03, PNorm = 102.5290, GNorm = 1.3333, lr_0 = 3.1209e-04
Loss = 1.4214e-03, PNorm = 102.5481, GNorm = 1.5173, lr_0 = 3.0200e-04
Validation rmse = 0.939940
Epoch 16
Loss = 1.3277e-03, PNorm = 102.5661, GNorm = 3.3669, lr_0 = 2.9222e-04
Loss = 1.6621e-03, PNorm = 102.5942, GNorm = 3.5365, lr_0 = 2.8277e-04
Validation rmse = 0.899311
Epoch 17
Loss = 1.5836e-03, PNorm = 102.6201, GNorm = 3.6547, lr_0 = 2.7272e-04
Loss = 1.2709e-03, PNorm = 102.6376, GNorm = 2.4415, lr_0 = 2.6389e-04
Loss = 1.5112e-03, PNorm = 102.6557, GNorm = 2.9275, lr_0 = 2.5535e-04
Validation rmse = 0.758421
Epoch 18
Loss = 9.9787e-04, PNorm = 102.6738, GNorm = 0.7173, lr_0 = 2.4709e-04
Loss = 1.1339e-03, PNorm = 102.6886, GNorm = 1.1859, lr_0 = 2.3910e-04
Loss = 1.2362e-03, PNorm = 102.7001, GNorm = 2.3904, lr_0 = 2.3136e-04
Validation rmse = 0.774990
Epoch 19
Loss = 1.1664e-03, PNorm = 102.7156, GNorm = 3.5138, lr_0 = 2.2387e-04
Loss = 1.1211e-03, PNorm = 102.7313, GNorm = 0.9657, lr_0 = 2.1663e-04
Validation rmse = 0.724331
Epoch 20
Loss = 1.1246e-03, PNorm = 102.7446, GNorm = 0.4694, lr_0 = 2.0962e-04
Loss = 9.9924e-04, PNorm = 102.7584, GNorm = 2.6405, lr_0 = 2.0283e-04
Loss = 9.7708e-04, PNorm = 102.7715, GNorm = 0.4198, lr_0 = 1.9627e-04
Validation rmse = 0.708442
Epoch 21
Loss = 1.0522e-03, PNorm = 102.7827, GNorm = 2.2151, lr_0 = 1.8992e-04
Loss = 9.5413e-04, PNorm = 102.7937, GNorm = 0.9600, lr_0 = 1.8377e-04
Validation rmse = 0.735592
Epoch 22
Loss = 1.0076e-03, PNorm = 102.8063, GNorm = 0.8466, lr_0 = 1.7783e-04
Loss = 8.4898e-04, PNorm = 102.8183, GNorm = 0.8467, lr_0 = 1.7207e-04
Loss = 8.9483e-04, PNorm = 102.8294, GNorm = 0.9122, lr_0 = 1.6651e-04
Validation rmse = 0.746711
Epoch 23
Loss = 7.1761e-04, PNorm = 102.8401, GNorm = 0.7975, lr_0 = 1.6059e-04
Loss = 8.4091e-04, PNorm = 102.8504, GNorm = 0.5134, lr_0 = 1.5539e-04
Validation rmse = 0.743820
Epoch 24
Loss = 5.1698e-04, PNorm = 102.8592, GNorm = 0.7851, lr_0 = 1.5036e-04
Loss = 8.2952e-04, PNorm = 102.8684, GNorm = 0.7579, lr_0 = 1.4550e-04
Loss = 8.9770e-04, PNorm = 102.8777, GNorm = 1.0675, lr_0 = 1.4079e-04
Validation rmse = 0.712500
Epoch 25
Loss = 5.6305e-04, PNorm = 102.8881, GNorm = 0.5048, lr_0 = 1.3623e-04
Loss = 7.3921e-04, PNorm = 102.8967, GNorm = 0.5333, lr_0 = 1.3183e-04
Loss = 9.0500e-04, PNorm = 102.9054, GNorm = 0.7440, lr_0 = 1.2756e-04
Validation rmse = 0.717319
Epoch 26
Loss = 6.9780e-04, PNorm = 102.9123, GNorm = 0.5544, lr_0 = 1.2343e-04
Loss = 7.8340e-04, PNorm = 102.9205, GNorm = 0.9412, lr_0 = 1.1944e-04
Validation rmse = 0.694543
Epoch 27
Loss = 6.6925e-04, PNorm = 102.9285, GNorm = 1.0173, lr_0 = 1.1557e-04
Loss = 8.4201e-04, PNorm = 102.9389, GNorm = 0.3960, lr_0 = 1.1183e-04
Loss = 7.6537e-04, PNorm = 102.9481, GNorm = 0.4119, lr_0 = 1.0821e-04
Validation rmse = 0.718353
Epoch 28
Loss = 6.6734e-04, PNorm = 102.9545, GNorm = 0.3417, lr_0 = 1.0437e-04
Loss = 7.3649e-04, PNorm = 102.9617, GNorm = 0.6307, lr_0 = 1.0099e-04
Validation rmse = 0.705761
Epoch 29
Loss = 6.0152e-04, PNorm = 102.9692, GNorm = 0.5603, lr_0 = 1.0000e-04
Loss = 6.7944e-04, PNorm = 102.9759, GNorm = 1.3014, lr_0 = 1.0000e-04
Loss = 8.2718e-04, PNorm = 102.9838, GNorm = 1.6433, lr_0 = 1.0000e-04
Validation rmse = 0.682693
Model 0 best validation rmse = 0.682693 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.696389
Ensemble test rmse = 0.696389
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2400, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,721,601
Moving model to cuda
Epoch 0
Loss = 2.0396e-02, PNorm = 99.7669, GNorm = 1.0725, lr_0 = 2.9800e-04
Loss = 1.2207e-02, PNorm = 99.8708, GNorm = 1.4959, lr_0 = 4.7800e-04
Validation rmse = 2.279708
Epoch 1
Loss = 1.4497e-02, PNorm = 100.0341, GNorm = 4.0579, lr_0 = 6.7600e-04
Loss = 1.0671e-02, PNorm = 100.2429, GNorm = 4.4169, lr_0 = 8.5600e-04
Loss = 1.0464e-02, PNorm = 100.4735, GNorm = 1.0547, lr_0 = 9.9344e-04
Validation rmse = 1.828813
Epoch 2
Loss = 7.2772e-03, PNorm = 100.7081, GNorm = 2.9003, lr_0 = 9.6130e-04
Loss = 5.8382e-03, PNorm = 100.8800, GNorm = 2.1576, lr_0 = 9.3019e-04
Validation rmse = 1.259079
Epoch 3
Loss = 4.1722e-03, PNorm = 101.0203, GNorm = 1.2561, lr_0 = 9.0009e-04
Loss = 4.7407e-03, PNorm = 101.1315, GNorm = 2.7454, lr_0 = 8.7096e-04
Loss = 4.8863e-03, PNorm = 101.2235, GNorm = 3.5569, lr_0 = 8.4278e-04
Validation rmse = 1.101464
Epoch 4
Loss = 5.3428e-03, PNorm = 101.2982, GNorm = 5.1065, lr_0 = 8.1551e-04
Loss = 4.6476e-03, PNorm = 101.3849, GNorm = 0.4523, lr_0 = 7.8912e-04
Validation rmse = 1.076915
Epoch 5
Loss = 1.5092e-03, PNorm = 101.4485, GNorm = 0.6488, lr_0 = 7.6358e-04
Loss = 3.0854e-03, PNorm = 101.4937, GNorm = 4.4728, lr_0 = 7.3888e-04
Loss = 4.2538e-03, PNorm = 101.5412, GNorm = 1.1549, lr_0 = 7.1497e-04
Validation rmse = 1.079869
Epoch 6
Loss = 2.8788e-03, PNorm = 101.6080, GNorm = 1.3417, lr_0 = 6.8956e-04
Loss = 2.9683e-03, PNorm = 101.6652, GNorm = 0.9171, lr_0 = 6.6725e-04
Loss = 3.1562e-03, PNorm = 101.7005, GNorm = 1.6200, lr_0 = 6.4565e-04
Validation rmse = 0.978355
Epoch 7
Loss = 2.9344e-03, PNorm = 101.7458, GNorm = 1.5915, lr_0 = 6.2476e-04
Loss = 2.5635e-03, PNorm = 101.7887, GNorm = 0.4202, lr_0 = 6.0454e-04
Validation rmse = 0.933487
Epoch 8
Loss = 2.1135e-03, PNorm = 101.8266, GNorm = 0.7261, lr_0 = 5.8498e-04
Loss = 2.7092e-03, PNorm = 101.8676, GNorm = 1.1184, lr_0 = 5.6605e-04
Loss = 2.1636e-03, PNorm = 101.9020, GNorm = 1.5669, lr_0 = 5.4774e-04
Validation rmse = 0.974395
Epoch 9
Loss = 2.3608e-03, PNorm = 101.9326, GNorm = 0.9732, lr_0 = 5.3001e-04
Loss = 2.6660e-03, PNorm = 101.9786, GNorm = 1.5050, lr_0 = 5.1286e-04
Validation rmse = 0.918145
Epoch 10
Loss = 2.0095e-03, PNorm = 102.0132, GNorm = 2.2872, lr_0 = 4.9627e-04
Loss = 2.5691e-03, PNorm = 102.0520, GNorm = 1.9745, lr_0 = 4.8021e-04
Loss = 2.6926e-03, PNorm = 102.0844, GNorm = 0.6539, lr_0 = 4.6467e-04
Validation rmse = 0.939042
Epoch 11
Loss = 2.0370e-03, PNorm = 102.1175, GNorm = 1.3604, lr_0 = 4.4963e-04
Loss = 1.7680e-03, PNorm = 102.1548, GNorm = 1.4506, lr_0 = 4.3508e-04
Validation rmse = 0.852752
Epoch 12
Loss = 1.5340e-03, PNorm = 102.1860, GNorm = 1.0364, lr_0 = 4.1962e-04
Loss = 1.7528e-03, PNorm = 102.2088, GNorm = 3.6362, lr_0 = 4.0604e-04
Loss = 1.8810e-03, PNorm = 102.2422, GNorm = 2.7752, lr_0 = 3.9290e-04
Validation rmse = 0.866665
Epoch 13
Loss = 1.4188e-03, PNorm = 102.2662, GNorm = 0.8231, lr_0 = 3.8019e-04
Loss = 1.5869e-03, PNorm = 102.2941, GNorm = 0.5167, lr_0 = 3.6789e-04
Loss = 1.7915e-03, PNorm = 102.3197, GNorm = 0.9887, lr_0 = 3.5598e-04
Validation rmse = 0.855546
Epoch 14
Loss = 1.5341e-03, PNorm = 102.3467, GNorm = 1.2535, lr_0 = 3.4446e-04
Loss = 1.4980e-03, PNorm = 102.3746, GNorm = 1.2989, lr_0 = 3.3332e-04
Validation rmse = 0.857665
Epoch 15
Loss = 1.7006e-03, PNorm = 102.3941, GNorm = 1.1821, lr_0 = 3.2253e-04
Loss = 1.6761e-03, PNorm = 102.4155, GNorm = 1.9699, lr_0 = 3.1209e-04
Loss = 1.3600e-03, PNorm = 102.4380, GNorm = 1.8827, lr_0 = 3.0200e-04
Validation rmse = 0.886874
Epoch 16
Loss = 1.5444e-03, PNorm = 102.4623, GNorm = 1.1945, lr_0 = 2.9222e-04
Loss = 1.4087e-03, PNorm = 102.4867, GNorm = 0.6196, lr_0 = 2.8277e-04
Validation rmse = 0.875462
Epoch 17
Loss = 1.0673e-03, PNorm = 102.5095, GNorm = 0.9507, lr_0 = 2.7272e-04
Loss = 1.3216e-03, PNorm = 102.5313, GNorm = 1.0708, lr_0 = 2.6389e-04
Loss = 1.2741e-03, PNorm = 102.5502, GNorm = 0.5477, lr_0 = 2.5535e-04
Validation rmse = 0.868831
Epoch 18
Loss = 1.1726e-03, PNorm = 102.5666, GNorm = 1.6219, lr_0 = 2.4709e-04
Loss = 1.4756e-03, PNorm = 102.5816, GNorm = 2.5636, lr_0 = 2.3910e-04
Loss = 1.9373e-03, PNorm = 102.6031, GNorm = 0.9369, lr_0 = 2.3136e-04
Validation rmse = 0.902407
Epoch 19
Loss = 1.3942e-03, PNorm = 102.6227, GNorm = 0.6365, lr_0 = 2.2387e-04
Loss = 1.1875e-03, PNorm = 102.6378, GNorm = 3.6562, lr_0 = 2.1663e-04
Validation rmse = 0.892097
Epoch 20
Loss = 1.3172e-03, PNorm = 102.6551, GNorm = 0.5125, lr_0 = 2.0962e-04
Loss = 1.1750e-03, PNorm = 102.6725, GNorm = 1.7280, lr_0 = 2.0283e-04
Loss = 1.2545e-03, PNorm = 102.6885, GNorm = 1.6981, lr_0 = 1.9627e-04
Validation rmse = 0.871260
Epoch 21
Loss = 8.9841e-04, PNorm = 102.7024, GNorm = 0.4851, lr_0 = 1.8992e-04
Loss = 1.0558e-03, PNorm = 102.7159, GNorm = 0.5546, lr_0 = 1.8377e-04
Validation rmse = 0.876173
Epoch 22
Loss = 1.1155e-03, PNorm = 102.7303, GNorm = 1.9386, lr_0 = 1.7783e-04
Loss = 9.2755e-04, PNorm = 102.7448, GNorm = 0.6377, lr_0 = 1.7207e-04
Loss = 1.1224e-03, PNorm = 102.7579, GNorm = 1.9513, lr_0 = 1.6651e-04
Validation rmse = 0.867459
Epoch 23
Loss = 1.1177e-03, PNorm = 102.7708, GNorm = 1.4660, lr_0 = 1.6059e-04
Loss = 1.0197e-03, PNorm = 102.7838, GNorm = 1.1438, lr_0 = 1.5539e-04
Validation rmse = 0.869528
Epoch 24
Loss = 7.9940e-04, PNorm = 102.7976, GNorm = 1.3433, lr_0 = 1.5036e-04
Loss = 1.0847e-03, PNorm = 102.8090, GNorm = 0.9840, lr_0 = 1.4550e-04
Loss = 8.5472e-04, PNorm = 102.8193, GNorm = 0.5502, lr_0 = 1.4079e-04
Validation rmse = 0.861058
Epoch 25
Loss = 8.1970e-04, PNorm = 102.8285, GNorm = 0.3718, lr_0 = 1.3623e-04
Loss = 9.3559e-04, PNorm = 102.8366, GNorm = 2.3870, lr_0 = 1.3183e-04
Loss = 9.7066e-04, PNorm = 102.8476, GNorm = 1.0590, lr_0 = 1.2756e-04
Validation rmse = 0.906686
Epoch 26
Loss = 1.0514e-03, PNorm = 102.8596, GNorm = 1.1554, lr_0 = 1.2343e-04
Loss = 8.7777e-04, PNorm = 102.8695, GNorm = 0.6605, lr_0 = 1.1944e-04
Validation rmse = 0.911459
Epoch 27
Loss = 1.0275e-03, PNorm = 102.8785, GNorm = 1.4838, lr_0 = 1.1557e-04
Loss = 8.2047e-04, PNorm = 102.8858, GNorm = 0.5258, lr_0 = 1.1183e-04
Loss = 8.7233e-04, PNorm = 102.8929, GNorm = 0.9601, lr_0 = 1.0821e-04
Validation rmse = 0.855606
Epoch 28
Loss = 9.5569e-04, PNorm = 102.9030, GNorm = 1.5722, lr_0 = 1.0437e-04
Loss = 8.3634e-04, PNorm = 102.9108, GNorm = 0.9228, lr_0 = 1.0099e-04
Validation rmse = 0.874495
Epoch 29
Loss = 6.0536e-04, PNorm = 102.9188, GNorm = 1.0815, lr_0 = 1.0000e-04
Loss = 9.0643e-04, PNorm = 102.9262, GNorm = 0.7225, lr_0 = 1.0000e-04
Loss = 7.6714e-04, PNorm = 102.9328, GNorm = 0.6535, lr_0 = 1.0000e-04
Validation rmse = 0.894814
Model 0 best validation rmse = 0.852752 on epoch 11
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.790276
Ensemble test rmse = 0.790276
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 2,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 2400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 2400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_2_dropout_0.0_ffn_num_layers_3_hidden_size_2400/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=2400, bias=False)
      (W_h): Linear(in_features=2400, out_features=2400, bias=False)
      (W_o): Linear(in_features=2533, out_features=2400, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=2400, out_features=2400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2400, out_features=2400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=2400, out_features=1, bias=True)
  )
)
Number of parameters = 23,721,601
Moving model to cuda
Epoch 0
Loss = 1.8706e-02, PNorm = 99.7673, GNorm = 1.9934, lr_0 = 2.9800e-04
Loss = 1.4585e-02, PNorm = 99.8590, GNorm = 4.1217, lr_0 = 4.7800e-04
Validation rmse = 1.517024
Epoch 1
Loss = 8.2509e-03, PNorm = 100.0096, GNorm = 4.2853, lr_0 = 6.7600e-04
Loss = 8.2040e-03, PNorm = 100.1888, GNorm = 3.9800, lr_0 = 8.5600e-04
Loss = 7.8886e-03, PNorm = 100.4116, GNorm = 1.2314, lr_0 = 9.9344e-04
Validation rmse = 1.270320
Epoch 2
Loss = 6.1628e-03, PNorm = 100.6136, GNorm = 6.3697, lr_0 = 9.6130e-04
Loss = 6.3141e-03, PNorm = 100.8012, GNorm = 2.5500, lr_0 = 9.3019e-04
Validation rmse = 1.189688
Epoch 3
Loss = 4.2795e-03, PNorm = 100.9506, GNorm = 1.1762, lr_0 = 9.0009e-04
Loss = 5.0101e-03, PNorm = 101.0482, GNorm = 1.1629, lr_0 = 8.7096e-04
Loss = 4.8518e-03, PNorm = 101.1403, GNorm = 4.3312, lr_0 = 8.4278e-04
Validation rmse = 1.251417
Epoch 4
Loss = 4.3412e-03, PNorm = 101.2286, GNorm = 2.1685, lr_0 = 8.1551e-04
Loss = 4.5447e-03, PNorm = 101.3160, GNorm = 1.2964, lr_0 = 7.8912e-04
Validation rmse = 1.057358
Epoch 5
Loss = 2.8323e-03, PNorm = 101.3893, GNorm = 1.1243, lr_0 = 7.6358e-04
Loss = 3.8081e-03, PNorm = 101.4471, GNorm = 1.0120, lr_0 = 7.3888e-04
Loss = 2.6079e-03, PNorm = 101.4998, GNorm = 0.6620, lr_0 = 7.1497e-04
Validation rmse = 0.938822
Epoch 6
Loss = 2.8536e-03, PNorm = 101.5588, GNorm = 4.1741, lr_0 = 6.8956e-04
Loss = 3.9752e-03, PNorm = 101.6153, GNorm = 4.8059, lr_0 = 6.6725e-04
Loss = 2.8221e-03, PNorm = 101.6799, GNorm = 2.4936, lr_0 = 6.4565e-04
Validation rmse = 0.997840
Epoch 7
Loss = 2.3036e-03, PNorm = 101.7367, GNorm = 0.5042, lr_0 = 6.2476e-04
Loss = 2.4724e-03, PNorm = 101.7756, GNorm = 1.6180, lr_0 = 6.0454e-04
Validation rmse = 0.927157
Epoch 8
Loss = 2.4355e-03, PNorm = 101.8223, GNorm = 0.3785, lr_0 = 5.8498e-04
Loss = 2.3531e-03, PNorm = 101.8746, GNorm = 2.4661, lr_0 = 5.6605e-04
Loss = 2.1594e-03, PNorm = 101.9138, GNorm = 1.7767, lr_0 = 5.4774e-04
Validation rmse = 0.919372
Epoch 9
Loss = 1.6877e-03, PNorm = 101.9405, GNorm = 0.3226, lr_0 = 5.3001e-04
Loss = 1.7929e-03, PNorm = 101.9806, GNorm = 0.8052, lr_0 = 5.1286e-04
Validation rmse = 0.938424
Epoch 10
Loss = 1.9910e-03, PNorm = 102.0203, GNorm = 0.7561, lr_0 = 4.9627e-04
Loss = 1.9109e-03, PNorm = 102.0485, GNorm = 2.1831, lr_0 = 4.8021e-04
Loss = 2.0456e-03, PNorm = 102.0858, GNorm = 2.1716, lr_0 = 4.6467e-04
Validation rmse = 1.045646
Epoch 11
Loss = 2.0014e-03, PNorm = 102.1283, GNorm = 1.7025, lr_0 = 4.4963e-04
Loss = 1.7464e-03, PNorm = 102.1627, GNorm = 2.2413, lr_0 = 4.3508e-04
Validation rmse = 0.888979
Epoch 12
Loss = 1.3409e-03, PNorm = 102.1912, GNorm = 2.2331, lr_0 = 4.1962e-04
Loss = 1.7736e-03, PNorm = 102.2247, GNorm = 3.2688, lr_0 = 4.0604e-04
Loss = 1.6273e-03, PNorm = 102.2537, GNorm = 1.8149, lr_0 = 3.9290e-04
Validation rmse = 0.926592
Epoch 13
Loss = 1.9051e-03, PNorm = 102.2792, GNorm = 2.9196, lr_0 = 3.8019e-04
Loss = 1.4811e-03, PNorm = 102.3087, GNorm = 3.2365, lr_0 = 3.6789e-04
Loss = 1.7652e-03, PNorm = 102.3337, GNorm = 0.8888, lr_0 = 3.5598e-04
Validation rmse = 0.830643
Epoch 14
Loss = 1.5417e-03, PNorm = 102.3572, GNorm = 1.8350, lr_0 = 3.4446e-04
Loss = 1.2855e-03, PNorm = 102.3866, GNorm = 0.4885, lr_0 = 3.3332e-04
Validation rmse = 0.947550
Epoch 15
Loss = 1.5166e-03, PNorm = 102.4103, GNorm = 0.7287, lr_0 = 3.2253e-04
Loss = 1.4535e-03, PNorm = 102.4356, GNorm = 0.9424, lr_0 = 3.1209e-04
Loss = 1.2655e-03, PNorm = 102.4522, GNorm = 1.1402, lr_0 = 3.0200e-04
Validation rmse = 0.899305
Epoch 16
Loss = 1.2500e-03, PNorm = 102.4693, GNorm = 1.3973, lr_0 = 2.9222e-04
Loss = 1.2242e-03, PNorm = 102.4869, GNorm = 0.4728, lr_0 = 2.8277e-04
Validation rmse = 0.843813
Epoch 17
Loss = 1.1505e-03, PNorm = 102.5117, GNorm = 1.4753, lr_0 = 2.7272e-04
Loss = 1.1635e-03, PNorm = 102.5283, GNorm = 0.3820, lr_0 = 2.6389e-04
Loss = 1.0826e-03, PNorm = 102.5446, GNorm = 0.7858, lr_0 = 2.5535e-04
Validation rmse = 0.798998
Epoch 18
Loss = 1.1859e-03, PNorm = 102.5638, GNorm = 0.3468, lr_0 = 2.4709e-04
Loss = 1.2706e-03, PNorm = 102.5820, GNorm = 1.5640, lr_0 = 2.3910e-04
Loss = 1.0546e-03, PNorm = 102.5971, GNorm = 0.9335, lr_0 = 2.3136e-04
Validation rmse = 0.795805
Epoch 19
Loss = 1.2937e-03, PNorm = 102.6154, GNorm = 0.7799, lr_0 = 2.2387e-04
Loss = 1.1987e-03, PNorm = 102.6299, GNorm = 0.5814, lr_0 = 2.1663e-04
Validation rmse = 0.798520
Epoch 20
Loss = 7.7702e-04, PNorm = 102.6468, GNorm = 0.3523, lr_0 = 2.0962e-04
Loss = 1.1998e-03, PNorm = 102.6629, GNorm = 1.7220, lr_0 = 2.0283e-04
Loss = 9.8547e-04, PNorm = 102.6758, GNorm = 0.9673, lr_0 = 1.9627e-04
Validation rmse = 0.827636
Epoch 21
Loss = 1.1529e-03, PNorm = 102.6902, GNorm = 0.5453, lr_0 = 1.8992e-04
Loss = 1.2315e-03, PNorm = 102.7078, GNorm = 1.8116, lr_0 = 1.8377e-04
Validation rmse = 0.788665
Epoch 22
Loss = 7.2511e-04, PNorm = 102.7201, GNorm = 0.3947, lr_0 = 1.7783e-04
Loss = 9.1074e-04, PNorm = 102.7342, GNorm = 1.4934, lr_0 = 1.7207e-04
Loss = 9.9481e-04, PNorm = 102.7437, GNorm = 0.5574, lr_0 = 1.6651e-04
Validation rmse = 0.781165
Epoch 23
Loss = 1.1014e-03, PNorm = 102.7536, GNorm = 0.9739, lr_0 = 1.6059e-04
Loss = 9.3556e-04, PNorm = 102.7665, GNorm = 0.5426, lr_0 = 1.5539e-04
Validation rmse = 0.837247
Epoch 24
Loss = 1.0958e-03, PNorm = 102.7806, GNorm = 1.9320, lr_0 = 1.5036e-04
Loss = 1.0004e-03, PNorm = 102.7919, GNorm = 2.4167, lr_0 = 1.4550e-04
Loss = 1.0803e-03, PNorm = 102.8011, GNorm = 2.2850, lr_0 = 1.4079e-04
Validation rmse = 0.796732
Epoch 25
Loss = 8.8261e-04, PNorm = 102.8092, GNorm = 0.7618, lr_0 = 1.3623e-04
Loss = 8.0349e-04, PNorm = 102.8177, GNorm = 1.4799, lr_0 = 1.3183e-04
Loss = 9.1302e-04, PNorm = 102.8271, GNorm = 1.7165, lr_0 = 1.2756e-04
Validation rmse = 0.777641
Epoch 26
Loss = 8.6184e-04, PNorm = 102.8373, GNorm = 0.5644, lr_0 = 1.2343e-04
Loss = 7.9284e-04, PNorm = 102.8464, GNorm = 0.3307, lr_0 = 1.1944e-04
Validation rmse = 0.808347
Epoch 27
Loss = 7.8994e-04, PNorm = 102.8551, GNorm = 1.7577, lr_0 = 1.1557e-04
Loss = 8.7438e-04, PNorm = 102.8636, GNorm = 0.7081, lr_0 = 1.1183e-04
Loss = 7.9076e-04, PNorm = 102.8704, GNorm = 0.4339, lr_0 = 1.0821e-04
Validation rmse = 0.770419
Epoch 28
Loss = 7.3935e-04, PNorm = 102.8793, GNorm = 0.4141, lr_0 = 1.0437e-04
Loss = 7.8535e-04, PNorm = 102.8861, GNorm = 0.7893, lr_0 = 1.0099e-04
Validation rmse = 0.774874
Epoch 29
Loss = 6.8413e-04, PNorm = 102.8943, GNorm = 1.1563, lr_0 = 1.0000e-04
Loss = 7.7494e-04, PNorm = 102.9008, GNorm = 0.5699, lr_0 = 1.0000e-04
Loss = 6.8249e-04, PNorm = 102.9075, GNorm = 1.5987, lr_0 = 1.0000e-04
Validation rmse = 0.778768
Model 0 best validation rmse = 0.770419 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.692150
Ensemble test rmse = 0.692150
10-fold cross validation
	Seed 0 ==> test rmse = 0.742750
	Seed 1 ==> test rmse = 0.619086
	Seed 2 ==> test rmse = 0.717577
	Seed 3 ==> test rmse = 0.815443
	Seed 4 ==> test rmse = 0.948297
	Seed 5 ==> test rmse = 0.668297
	Seed 6 ==> test rmse = 0.743440
	Seed 7 ==> test rmse = 0.696389
	Seed 8 ==> test rmse = 0.790276
	Seed 9 ==> test rmse = 0.692150
Overall test rmse = 0.743371 +/- 0.087160
Elapsed time = 0:10:49
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 1.6106e-02, PNorm = 75.7834, GNorm = 7.2294, lr_0 = 2.9800e-04
Loss = 1.1742e-02, PNorm = 75.8394, GNorm = 7.2244, lr_0 = 4.7800e-04
Validation rmse = 1.314188
Epoch 1
Loss = 8.2911e-03, PNorm = 75.9249, GNorm = 4.9557, lr_0 = 6.7600e-04
Loss = 6.0000e-03, PNorm = 76.0146, GNorm = 6.1743, lr_0 = 8.5600e-04
Loss = 7.4457e-03, PNorm = 76.1254, GNorm = 0.6025, lr_0 = 9.9344e-04
Validation rmse = 1.259831
Epoch 2
Loss = 4.9060e-03, PNorm = 76.2348, GNorm = 2.5507, lr_0 = 9.6130e-04
Loss = 5.8014e-03, PNorm = 76.3361, GNorm = 9.4117, lr_0 = 9.3019e-04
Validation rmse = 1.089552
Epoch 3
Loss = 4.5982e-03, PNorm = 76.4269, GNorm = 5.6252, lr_0 = 9.0009e-04
Loss = 6.1034e-03, PNorm = 76.5164, GNorm = 1.5026, lr_0 = 8.7096e-04
Loss = 7.2259e-03, PNorm = 76.6153, GNorm = 4.8315, lr_0 = 8.4278e-04
Validation rmse = 1.342935
Epoch 4
Loss = 4.5018e-03, PNorm = 76.6963, GNorm = 0.9764, lr_0 = 8.1551e-04
Loss = 3.7193e-03, PNorm = 76.7587, GNorm = 1.7284, lr_0 = 7.8912e-04
Validation rmse = 1.153597
Epoch 5
Loss = 4.1452e-03, PNorm = 76.8085, GNorm = 3.4639, lr_0 = 7.6358e-04
Loss = 3.1665e-03, PNorm = 76.8635, GNorm = 0.9283, lr_0 = 7.3888e-04
Loss = 2.8942e-03, PNorm = 76.9060, GNorm = 3.5513, lr_0 = 7.1497e-04
Validation rmse = 0.984495
Epoch 6
Loss = 2.5076e-03, PNorm = 76.9576, GNorm = 1.1992, lr_0 = 6.8956e-04
Loss = 2.5134e-03, PNorm = 76.9960, GNorm = 0.9314, lr_0 = 6.6725e-04
Loss = 2.6364e-03, PNorm = 77.0322, GNorm = 1.4891, lr_0 = 6.4565e-04
Validation rmse = 0.972181
Epoch 7
Loss = 2.0601e-03, PNorm = 77.0678, GNorm = 1.5712, lr_0 = 6.2476e-04
Loss = 2.2013e-03, PNorm = 77.0983, GNorm = 2.6626, lr_0 = 6.0454e-04
Validation rmse = 0.871139
Epoch 8
Loss = 1.8661e-03, PNorm = 77.1306, GNorm = 1.7132, lr_0 = 5.8498e-04
Loss = 2.2419e-03, PNorm = 77.1588, GNorm = 2.5004, lr_0 = 5.6605e-04
Loss = 1.7038e-03, PNorm = 77.1933, GNorm = 1.6434, lr_0 = 5.4774e-04
Validation rmse = 0.960224
Epoch 9
Loss = 1.8702e-03, PNorm = 77.2257, GNorm = 1.6426, lr_0 = 5.3001e-04
Loss = 1.5592e-03, PNorm = 77.2552, GNorm = 0.6004, lr_0 = 5.1286e-04
Validation rmse = 0.881618
Epoch 10
Loss = 1.7503e-03, PNorm = 77.2828, GNorm = 1.5479, lr_0 = 4.9627e-04
Loss = 1.6177e-03, PNorm = 77.3153, GNorm = 2.0977, lr_0 = 4.8021e-04
Loss = 1.6864e-03, PNorm = 77.3376, GNorm = 1.6850, lr_0 = 4.6467e-04
Validation rmse = 0.910866
Epoch 11
Loss = 1.3676e-03, PNorm = 77.3576, GNorm = 0.8313, lr_0 = 4.4963e-04
Loss = 1.2983e-03, PNorm = 77.3834, GNorm = 0.4894, lr_0 = 4.3508e-04
Validation rmse = 0.883623
Epoch 12
Loss = 1.2268e-03, PNorm = 77.4082, GNorm = 0.4278, lr_0 = 4.1962e-04
Loss = 1.4424e-03, PNorm = 77.4290, GNorm = 0.9341, lr_0 = 4.0604e-04
Loss = 1.3407e-03, PNorm = 77.4511, GNorm = 1.4237, lr_0 = 3.9290e-04
Validation rmse = 0.836436
Epoch 13
Loss = 1.0857e-03, PNorm = 77.4725, GNorm = 1.0936, lr_0 = 3.8019e-04
Loss = 1.1952e-03, PNorm = 77.4888, GNorm = 1.6628, lr_0 = 3.6789e-04
Loss = 1.1825e-03, PNorm = 77.5050, GNorm = 0.7729, lr_0 = 3.5598e-04
Validation rmse = 0.866042
Epoch 14
Loss = 1.1313e-03, PNorm = 77.5272, GNorm = 1.9066, lr_0 = 3.4446e-04
Loss = 8.9061e-04, PNorm = 77.5468, GNorm = 1.5468, lr_0 = 3.3332e-04
Validation rmse = 0.832247
Epoch 15
Loss = 1.0006e-03, PNorm = 77.5625, GNorm = 0.9447, lr_0 = 3.2253e-04
Loss = 1.1849e-03, PNorm = 77.5822, GNorm = 0.7807, lr_0 = 3.1209e-04
Loss = 1.0281e-03, PNorm = 77.6049, GNorm = 1.3341, lr_0 = 3.0200e-04
Validation rmse = 0.808706
Epoch 16
Loss = 8.9901e-04, PNorm = 77.6208, GNorm = 0.3982, lr_0 = 2.9222e-04
Loss = 9.5313e-04, PNorm = 77.6312, GNorm = 1.4434, lr_0 = 2.8277e-04
Validation rmse = 0.807453
Epoch 17
Loss = 8.6815e-04, PNorm = 77.6457, GNorm = 0.8553, lr_0 = 2.7272e-04
Loss = 8.7260e-04, PNorm = 77.6613, GNorm = 1.1511, lr_0 = 2.6389e-04
Loss = 8.9559e-04, PNorm = 77.6776, GNorm = 1.0891, lr_0 = 2.5535e-04
Validation rmse = 0.815597
Epoch 18
Loss = 8.0033e-04, PNorm = 77.6906, GNorm = 0.3894, lr_0 = 2.4709e-04
Loss = 7.1393e-04, PNorm = 77.7029, GNorm = 1.0802, lr_0 = 2.3910e-04
Loss = 7.0807e-04, PNorm = 77.7169, GNorm = 0.6415, lr_0 = 2.3136e-04
Validation rmse = 0.784100
Epoch 19
Loss = 7.3684e-04, PNorm = 77.7313, GNorm = 0.6810, lr_0 = 2.2387e-04
Loss = 7.9788e-04, PNorm = 77.7449, GNorm = 1.5028, lr_0 = 2.1663e-04
Validation rmse = 0.803090
Epoch 20
Loss = 7.3475e-04, PNorm = 77.7567, GNorm = 0.4728, lr_0 = 2.0962e-04
Loss = 7.9882e-04, PNorm = 77.7697, GNorm = 1.1649, lr_0 = 2.0283e-04
Loss = 7.6462e-04, PNorm = 77.7839, GNorm = 0.5040, lr_0 = 1.9627e-04
Validation rmse = 0.788941
Epoch 21
Loss = 5.8872e-04, PNorm = 77.7965, GNorm = 1.1452, lr_0 = 1.8992e-04
Loss = 5.6499e-04, PNorm = 77.8067, GNorm = 0.4095, lr_0 = 1.8377e-04
Validation rmse = 0.775865
Epoch 22
Loss = 6.2874e-04, PNorm = 77.8189, GNorm = 0.4398, lr_0 = 1.7783e-04
Loss = 6.2784e-04, PNorm = 77.8303, GNorm = 1.1449, lr_0 = 1.7207e-04
Loss = 6.1484e-04, PNorm = 77.8396, GNorm = 0.5553, lr_0 = 1.6651e-04
Validation rmse = 0.791220
Epoch 23
Loss = 5.4813e-04, PNorm = 77.8500, GNorm = 0.4337, lr_0 = 1.6059e-04
Loss = 6.3084e-04, PNorm = 77.8605, GNorm = 0.8105, lr_0 = 1.5539e-04
Validation rmse = 0.793240
Epoch 24
Loss = 6.4525e-04, PNorm = 77.8677, GNorm = 0.7312, lr_0 = 1.5036e-04
Loss = 5.2657e-04, PNorm = 77.8782, GNorm = 0.3907, lr_0 = 1.4550e-04
Loss = 5.5034e-04, PNorm = 77.8864, GNorm = 0.2841, lr_0 = 1.4079e-04
Validation rmse = 0.793761
Epoch 25
Loss = 4.2761e-04, PNorm = 77.8947, GNorm = 0.4674, lr_0 = 1.3623e-04
Loss = 5.1827e-04, PNorm = 77.9029, GNorm = 0.5043, lr_0 = 1.3183e-04
Loss = 4.9902e-04, PNorm = 77.9117, GNorm = 0.4873, lr_0 = 1.2756e-04
Validation rmse = 0.771298
Epoch 26
Loss = 4.2197e-04, PNorm = 77.9179, GNorm = 0.4589, lr_0 = 1.2343e-04
Loss = 5.1548e-04, PNorm = 77.9241, GNorm = 0.4607, lr_0 = 1.1944e-04
Validation rmse = 0.784671
Epoch 27
Loss = 4.6078e-04, PNorm = 77.9315, GNorm = 0.4452, lr_0 = 1.1557e-04
Loss = 4.7088e-04, PNorm = 77.9396, GNorm = 0.6567, lr_0 = 1.1183e-04
Loss = 4.8899e-04, PNorm = 77.9463, GNorm = 0.5516, lr_0 = 1.0821e-04
Validation rmse = 0.805184
Epoch 28
Loss = 4.5688e-04, PNorm = 77.9519, GNorm = 0.4752, lr_0 = 1.0437e-04
Loss = 4.1013e-04, PNorm = 77.9573, GNorm = 0.3715, lr_0 = 1.0099e-04
Validation rmse = 0.801218
Epoch 29
Loss = 4.9488e-04, PNorm = 77.9632, GNorm = 0.4140, lr_0 = 1.0000e-04
Loss = 4.8630e-04, PNorm = 77.9692, GNorm = 0.5620, lr_0 = 1.0000e-04
Loss = 4.9418e-04, PNorm = 77.9756, GNorm = 1.6637, lr_0 = 1.0000e-04
Validation rmse = 0.799414
Model 0 best validation rmse = 0.771298 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.757741
Ensemble test rmse = 0.757741
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 2.0927e-02, PNorm = 75.7839, GNorm = 3.0505, lr_0 = 2.9800e-04
Loss = 1.2491e-02, PNorm = 75.8377, GNorm = 3.5975, lr_0 = 4.7800e-04
Validation rmse = 1.548972
Epoch 1
Loss = 8.9260e-03, PNorm = 75.9242, GNorm = 3.1464, lr_0 = 6.7600e-04
Loss = 9.3664e-03, PNorm = 76.0183, GNorm = 6.2113, lr_0 = 8.5600e-04
Loss = 5.0514e-03, PNorm = 76.1087, GNorm = 1.2834, lr_0 = 9.9344e-04
Validation rmse = 1.324175
Epoch 2
Loss = 5.1366e-03, PNorm = 76.1983, GNorm = 0.8110, lr_0 = 9.6130e-04
Loss = 5.0451e-03, PNorm = 76.2824, GNorm = 2.3770, lr_0 = 9.3019e-04
Validation rmse = 1.137850
Epoch 3
Loss = 3.7864e-03, PNorm = 76.3517, GNorm = 2.8934, lr_0 = 9.0009e-04
Loss = 3.9454e-03, PNorm = 76.4163, GNorm = 0.5038, lr_0 = 8.7096e-04
Loss = 3.7202e-03, PNorm = 76.4745, GNorm = 3.5897, lr_0 = 8.4278e-04
Validation rmse = 0.876522
Epoch 4
Loss = 3.7567e-03, PNorm = 76.5209, GNorm = 2.0715, lr_0 = 8.1551e-04
Loss = 2.9370e-03, PNorm = 76.5696, GNorm = 4.5233, lr_0 = 7.8912e-04
Validation rmse = 0.952752
Epoch 5
Loss = 2.8459e-03, PNorm = 76.6194, GNorm = 3.2715, lr_0 = 7.6358e-04
Loss = 3.7928e-03, PNorm = 76.6647, GNorm = 2.5945, lr_0 = 7.3888e-04
Loss = 3.8875e-03, PNorm = 76.7180, GNorm = 3.3513, lr_0 = 7.1497e-04
Validation rmse = 0.981531
Epoch 6
Loss = 3.5534e-03, PNorm = 76.7746, GNorm = 0.5797, lr_0 = 6.8956e-04
Loss = 2.6764e-03, PNorm = 76.8310, GNorm = 1.1104, lr_0 = 6.6725e-04
Loss = 2.2462e-03, PNorm = 76.8704, GNorm = 2.8299, lr_0 = 6.4565e-04
Validation rmse = 0.777729
Epoch 7
Loss = 2.3151e-03, PNorm = 76.9048, GNorm = 2.2436, lr_0 = 6.2476e-04
Loss = 2.2841e-03, PNorm = 76.9352, GNorm = 2.5152, lr_0 = 6.0454e-04
Validation rmse = 0.738855
Epoch 8
Loss = 3.1992e-03, PNorm = 76.9737, GNorm = 3.0228, lr_0 = 5.8498e-04
Loss = 2.3575e-03, PNorm = 77.0167, GNorm = 1.8332, lr_0 = 5.6605e-04
Loss = 1.7990e-03, PNorm = 77.0496, GNorm = 1.4884, lr_0 = 5.4774e-04
Validation rmse = 0.813754
Epoch 9
Loss = 1.6270e-03, PNorm = 77.0827, GNorm = 1.8564, lr_0 = 5.3001e-04
Loss = 1.8144e-03, PNorm = 77.1149, GNorm = 0.9922, lr_0 = 5.1286e-04
Validation rmse = 0.744582
Epoch 10
Loss = 1.3360e-03, PNorm = 77.1352, GNorm = 0.7808, lr_0 = 4.9627e-04
Loss = 1.8519e-03, PNorm = 77.1628, GNorm = 1.0426, lr_0 = 4.8021e-04
Loss = 1.5627e-03, PNorm = 77.1852, GNorm = 1.4080, lr_0 = 4.6467e-04
Validation rmse = 0.759031
Epoch 11
Loss = 2.0617e-03, PNorm = 77.2126, GNorm = 4.5606, lr_0 = 4.4963e-04
Loss = 1.7884e-03, PNorm = 77.2395, GNorm = 1.1135, lr_0 = 4.3508e-04
Validation rmse = 0.762466
Epoch 12
Loss = 1.8275e-03, PNorm = 77.2699, GNorm = 2.6867, lr_0 = 4.1962e-04
Loss = 1.8381e-03, PNorm = 77.2964, GNorm = 0.7247, lr_0 = 4.0604e-04
Loss = 1.4849e-03, PNorm = 77.3197, GNorm = 1.0439, lr_0 = 3.9290e-04
Validation rmse = 0.731393
Epoch 13
Loss = 1.0773e-03, PNorm = 77.3397, GNorm = 0.5454, lr_0 = 3.8019e-04
Loss = 1.1583e-03, PNorm = 77.3590, GNorm = 0.6000, lr_0 = 3.6789e-04
Loss = 1.6591e-03, PNorm = 77.3733, GNorm = 0.8944, lr_0 = 3.5598e-04
Validation rmse = 0.767081
Epoch 14
Loss = 1.4716e-03, PNorm = 77.3923, GNorm = 2.0036, lr_0 = 3.4446e-04
Loss = 1.0296e-03, PNorm = 77.4095, GNorm = 0.3543, lr_0 = 3.3332e-04
Validation rmse = 0.676247
Epoch 15
Loss = 1.2634e-03, PNorm = 77.4268, GNorm = 1.1373, lr_0 = 3.2253e-04
Loss = 1.0933e-03, PNorm = 77.4440, GNorm = 1.0001, lr_0 = 3.1209e-04
Loss = 1.3227e-03, PNorm = 77.4665, GNorm = 1.3443, lr_0 = 3.0200e-04
Validation rmse = 0.679718
Epoch 16
Loss = 1.2804e-03, PNorm = 77.4845, GNorm = 0.7010, lr_0 = 2.9222e-04
Loss = 7.0790e-04, PNorm = 77.4992, GNorm = 0.6841, lr_0 = 2.8277e-04
Validation rmse = 0.657288
Epoch 17
Loss = 8.8435e-04, PNorm = 77.5148, GNorm = 0.6285, lr_0 = 2.7272e-04
Loss = 1.0802e-03, PNorm = 77.5319, GNorm = 0.6889, lr_0 = 2.6389e-04
Loss = 9.8718e-04, PNorm = 77.5473, GNorm = 0.7370, lr_0 = 2.5535e-04
Validation rmse = 0.673400
Epoch 18
Loss = 9.2502e-04, PNorm = 77.5627, GNorm = 1.1399, lr_0 = 2.4709e-04
Loss = 1.0510e-03, PNorm = 77.5772, GNorm = 0.6956, lr_0 = 2.3910e-04
Loss = 9.2425e-04, PNorm = 77.5929, GNorm = 1.1219, lr_0 = 2.3136e-04
Validation rmse = 0.680217
Epoch 19
Loss = 8.6634e-04, PNorm = 77.6050, GNorm = 1.4780, lr_0 = 2.2387e-04
Loss = 9.5879e-04, PNorm = 77.6194, GNorm = 1.3588, lr_0 = 2.1663e-04
Validation rmse = 0.656262
Epoch 20
Loss = 6.3452e-04, PNorm = 77.6358, GNorm = 0.9585, lr_0 = 2.0962e-04
Loss = 8.9709e-04, PNorm = 77.6477, GNorm = 0.6739, lr_0 = 2.0283e-04
Loss = 8.0100e-04, PNorm = 77.6595, GNorm = 0.7973, lr_0 = 1.9627e-04
Validation rmse = 0.660024
Epoch 21
Loss = 7.3195e-04, PNorm = 77.6712, GNorm = 0.7288, lr_0 = 1.8992e-04
Loss = 8.4002e-04, PNorm = 77.6813, GNorm = 1.0111, lr_0 = 1.8377e-04
Validation rmse = 0.660835
Epoch 22
Loss = 6.6347e-04, PNorm = 77.6940, GNorm = 0.4125, lr_0 = 1.7783e-04
Loss = 7.8521e-04, PNorm = 77.7038, GNorm = 1.1279, lr_0 = 1.7207e-04
Loss = 7.9254e-04, PNorm = 77.7155, GNorm = 0.5276, lr_0 = 1.6651e-04
Validation rmse = 0.653254
Epoch 23
Loss = 6.4395e-04, PNorm = 77.7294, GNorm = 0.5124, lr_0 = 1.6059e-04
Loss = 6.7482e-04, PNorm = 77.7395, GNorm = 0.4415, lr_0 = 1.5539e-04
Validation rmse = 0.672456
Epoch 24
Loss = 4.5909e-04, PNorm = 77.7497, GNorm = 0.5479, lr_0 = 1.5036e-04
Loss = 7.2472e-04, PNorm = 77.7598, GNorm = 0.4491, lr_0 = 1.4550e-04
Loss = 6.5164e-04, PNorm = 77.7707, GNorm = 0.4125, lr_0 = 1.4079e-04
Validation rmse = 0.632985
Epoch 25
Loss = 4.6102e-04, PNorm = 77.7798, GNorm = 0.3447, lr_0 = 1.3623e-04
Loss = 6.0649e-04, PNorm = 77.7883, GNorm = 0.5376, lr_0 = 1.3183e-04
Loss = 6.8713e-04, PNorm = 77.7986, GNorm = 0.7341, lr_0 = 1.2756e-04
Validation rmse = 0.694295
Epoch 26
Loss = 7.1018e-04, PNorm = 77.8064, GNorm = 1.4038, lr_0 = 1.2343e-04
Loss = 6.3909e-04, PNorm = 77.8152, GNorm = 0.4509, lr_0 = 1.1944e-04
Validation rmse = 0.647046
Epoch 27
Loss = 6.7641e-04, PNorm = 77.8221, GNorm = 0.3843, lr_0 = 1.1557e-04
Loss = 5.6945e-04, PNorm = 77.8303, GNorm = 0.8782, lr_0 = 1.1183e-04
Loss = 6.6126e-04, PNorm = 77.8395, GNorm = 0.6224, lr_0 = 1.0821e-04
Validation rmse = 0.669199
Epoch 28
Loss = 6.1674e-04, PNorm = 77.8463, GNorm = 0.3843, lr_0 = 1.0437e-04
Loss = 4.6716e-04, PNorm = 77.8529, GNorm = 0.6177, lr_0 = 1.0099e-04
Validation rmse = 0.659265
Epoch 29
Loss = 5.5510e-04, PNorm = 77.8592, GNorm = 1.1090, lr_0 = 1.0000e-04
Loss = 5.5039e-04, PNorm = 77.8676, GNorm = 0.8000, lr_0 = 1.0000e-04
Loss = 5.2428e-04, PNorm = 77.8747, GNorm = 1.1157, lr_0 = 1.0000e-04
Validation rmse = 0.642803
Model 0 best validation rmse = 0.632985 on epoch 24
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.606592
Ensemble test rmse = 0.606592
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 2.1318e-02, PNorm = 75.7827, GNorm = 11.5258, lr_0 = 2.9800e-04
Loss = 1.2628e-02, PNorm = 75.8448, GNorm = 2.6401, lr_0 = 4.7800e-04
Validation rmse = 1.355551
Epoch 1
Loss = 8.8233e-03, PNorm = 75.9402, GNorm = 5.9553, lr_0 = 6.7600e-04
Loss = 7.4861e-03, PNorm = 76.0350, GNorm = 2.2264, lr_0 = 8.5600e-04
Loss = 8.7938e-03, PNorm = 76.1484, GNorm = 4.8403, lr_0 = 9.9344e-04
Validation rmse = 1.427053
Epoch 2
Loss = 6.7418e-03, PNorm = 76.2578, GNorm = 3.8788, lr_0 = 9.6130e-04
Loss = 6.0044e-03, PNorm = 76.3557, GNorm = 3.2971, lr_0 = 9.3019e-04
Validation rmse = 1.006832
Epoch 3
Loss = 4.5072e-03, PNorm = 76.4316, GNorm = 0.7591, lr_0 = 9.0009e-04
Loss = 3.5533e-03, PNorm = 76.5001, GNorm = 1.8788, lr_0 = 8.7096e-04
Loss = 4.0565e-03, PNorm = 76.5573, GNorm = 1.3059, lr_0 = 8.4278e-04
Validation rmse = 0.945976
Epoch 4
Loss = 4.7145e-03, PNorm = 76.6215, GNorm = 1.4185, lr_0 = 8.1551e-04
Loss = 4.8366e-03, PNorm = 76.6891, GNorm = 0.6763, lr_0 = 7.8912e-04
Validation rmse = 0.841521
Epoch 5
Loss = 3.4473e-03, PNorm = 76.7461, GNorm = 1.2924, lr_0 = 7.6358e-04
Loss = 2.7531e-03, PNorm = 76.8042, GNorm = 1.4315, lr_0 = 7.3888e-04
Loss = 3.1486e-03, PNorm = 76.8525, GNorm = 2.0932, lr_0 = 7.1497e-04
Validation rmse = 0.730249
Epoch 6
Loss = 2.6840e-03, PNorm = 76.8950, GNorm = 1.8273, lr_0 = 6.8956e-04
Loss = 2.4555e-03, PNorm = 76.9324, GNorm = 1.8471, lr_0 = 6.6725e-04
Loss = 2.5655e-03, PNorm = 76.9705, GNorm = 1.2888, lr_0 = 6.4565e-04
Validation rmse = 0.919972
Epoch 7
Loss = 2.3742e-03, PNorm = 77.0108, GNorm = 1.1204, lr_0 = 6.2476e-04
Loss = 1.9112e-03, PNorm = 77.0522, GNorm = 0.7228, lr_0 = 6.0454e-04
Validation rmse = 0.705231
Epoch 8
Loss = 1.9719e-03, PNorm = 77.0885, GNorm = 0.7242, lr_0 = 5.8498e-04
Loss = 1.5835e-03, PNorm = 77.1156, GNorm = 0.9930, lr_0 = 5.6605e-04
Loss = 1.9085e-03, PNorm = 77.1405, GNorm = 1.5475, lr_0 = 5.4774e-04
Validation rmse = 0.658996
Epoch 9
Loss = 1.8315e-03, PNorm = 77.1734, GNorm = 2.8920, lr_0 = 5.3001e-04
Loss = 2.0022e-03, PNorm = 77.2084, GNorm = 0.9260, lr_0 = 5.1286e-04
Validation rmse = 0.650790
Epoch 10
Loss = 1.3942e-03, PNorm = 77.2365, GNorm = 0.3819, lr_0 = 4.9627e-04
Loss = 1.4431e-03, PNorm = 77.2622, GNorm = 0.8469, lr_0 = 4.8021e-04
Loss = 2.0313e-03, PNorm = 77.2978, GNorm = 1.0909, lr_0 = 4.6467e-04
Validation rmse = 0.672920
Epoch 11
Loss = 1.6665e-03, PNorm = 77.3188, GNorm = 1.1236, lr_0 = 4.4963e-04
Loss = 1.6209e-03, PNorm = 77.3477, GNorm = 0.9272, lr_0 = 4.3508e-04
Validation rmse = 0.652174
Epoch 12
Loss = 8.9981e-04, PNorm = 77.3695, GNorm = 0.9237, lr_0 = 4.1962e-04
Loss = 1.6163e-03, PNorm = 77.3907, GNorm = 3.2042, lr_0 = 4.0604e-04
Loss = 1.3420e-03, PNorm = 77.4143, GNorm = 1.6621, lr_0 = 3.9290e-04
Validation rmse = 0.625095
Epoch 13
Loss = 1.3319e-03, PNorm = 77.4372, GNorm = 0.7375, lr_0 = 3.8019e-04
Loss = 1.2857e-03, PNorm = 77.4574, GNorm = 2.5768, lr_0 = 3.6789e-04
Loss = 1.5802e-03, PNorm = 77.4775, GNorm = 2.7723, lr_0 = 3.5598e-04
Validation rmse = 0.628256
Epoch 14
Loss = 1.2608e-03, PNorm = 77.4940, GNorm = 2.2074, lr_0 = 3.4446e-04
Loss = 1.4806e-03, PNorm = 77.5192, GNorm = 1.4847, lr_0 = 3.3332e-04
Validation rmse = 0.826980
Epoch 15
Loss = 1.6880e-03, PNorm = 77.5399, GNorm = 0.9894, lr_0 = 3.2253e-04
Loss = 1.3272e-03, PNorm = 77.5575, GNorm = 0.9798, lr_0 = 3.1209e-04
Loss = 1.4096e-03, PNorm = 77.5787, GNorm = 2.5059, lr_0 = 3.0200e-04
Validation rmse = 0.638217
Epoch 16
Loss = 1.0160e-03, PNorm = 77.5928, GNorm = 0.4444, lr_0 = 2.9222e-04
Loss = 9.9352e-04, PNorm = 77.6095, GNorm = 1.0754, lr_0 = 2.8277e-04
Validation rmse = 0.611372
Epoch 17
Loss = 7.1604e-04, PNorm = 77.6271, GNorm = 1.1132, lr_0 = 2.7272e-04
Loss = 8.2306e-04, PNorm = 77.6426, GNorm = 0.5211, lr_0 = 2.6389e-04
Loss = 1.1344e-03, PNorm = 77.6585, GNorm = 2.8000, lr_0 = 2.5535e-04
Validation rmse = 0.606260
Epoch 18
Loss = 9.5953e-04, PNorm = 77.6732, GNorm = 1.1712, lr_0 = 2.4709e-04
Loss = 1.0556e-03, PNorm = 77.6912, GNorm = 1.1774, lr_0 = 2.3910e-04
Loss = 8.4293e-04, PNorm = 77.7008, GNorm = 0.7553, lr_0 = 2.3136e-04
Validation rmse = 0.615602
Epoch 19
Loss = 1.0407e-03, PNorm = 77.7158, GNorm = 1.7260, lr_0 = 2.2387e-04
Loss = 7.9020e-04, PNorm = 77.7282, GNorm = 0.8242, lr_0 = 2.1663e-04
Validation rmse = 0.605981
Epoch 20
Loss = 7.6189e-04, PNorm = 77.7384, GNorm = 1.7316, lr_0 = 2.0962e-04
Loss = 7.2417e-04, PNorm = 77.7510, GNorm = 0.7905, lr_0 = 2.0283e-04
Loss = 7.4640e-04, PNorm = 77.7602, GNorm = 0.5687, lr_0 = 1.9627e-04
Validation rmse = 0.599582
Epoch 21
Loss = 6.8903e-04, PNorm = 77.7706, GNorm = 0.5336, lr_0 = 1.8992e-04
Loss = 7.0783e-04, PNorm = 77.7824, GNorm = 1.0804, lr_0 = 1.8377e-04
Validation rmse = 0.620409
Epoch 22
Loss = 7.0413e-04, PNorm = 77.7930, GNorm = 0.4665, lr_0 = 1.7783e-04
Loss = 8.5040e-04, PNorm = 77.8045, GNorm = 0.9347, lr_0 = 1.7207e-04
Loss = 6.8916e-04, PNorm = 77.8155, GNorm = 1.4715, lr_0 = 1.6651e-04
Validation rmse = 0.608373
Epoch 23
Loss = 6.8461e-04, PNorm = 77.8244, GNorm = 0.7497, lr_0 = 1.6059e-04
Loss = 7.3328e-04, PNorm = 77.8344, GNorm = 0.7244, lr_0 = 1.5539e-04
Validation rmse = 0.586218
Epoch 24
Loss = 6.0488e-04, PNorm = 77.8440, GNorm = 0.2825, lr_0 = 1.5036e-04
Loss = 5.7814e-04, PNorm = 77.8538, GNorm = 1.0846, lr_0 = 1.4550e-04
Loss = 5.4262e-04, PNorm = 77.8622, GNorm = 0.8375, lr_0 = 1.4079e-04
Validation rmse = 0.598886
Epoch 25
Loss = 6.2748e-04, PNorm = 77.8716, GNorm = 1.4602, lr_0 = 1.3623e-04
Loss = 6.3332e-04, PNorm = 77.8817, GNorm = 0.9006, lr_0 = 1.3183e-04
Loss = 5.9645e-04, PNorm = 77.8886, GNorm = 0.7978, lr_0 = 1.2756e-04
Validation rmse = 0.592180
Epoch 26
Loss = 5.0767e-04, PNorm = 77.8956, GNorm = 1.1487, lr_0 = 1.2343e-04
Loss = 5.7384e-04, PNorm = 77.9047, GNorm = 0.3051, lr_0 = 1.1944e-04
Validation rmse = 0.611474
Epoch 27
Loss = 7.1037e-04, PNorm = 77.9116, GNorm = 0.9467, lr_0 = 1.1557e-04
Loss = 6.3599e-04, PNorm = 77.9190, GNorm = 0.5806, lr_0 = 1.1183e-04
Loss = 4.8784e-04, PNorm = 77.9246, GNorm = 0.9918, lr_0 = 1.0821e-04
Validation rmse = 0.619888
Epoch 28
Loss = 6.0492e-04, PNorm = 77.9313, GNorm = 0.3959, lr_0 = 1.0437e-04
Loss = 5.5544e-04, PNorm = 77.9383, GNorm = 0.3982, lr_0 = 1.0099e-04
Validation rmse = 0.605548
Epoch 29
Loss = 6.2957e-04, PNorm = 77.9449, GNorm = 0.3264, lr_0 = 1.0000e-04
Loss = 4.7735e-04, PNorm = 77.9522, GNorm = 1.4977, lr_0 = 1.0000e-04
Loss = 4.4770e-04, PNorm = 77.9580, GNorm = 0.7577, lr_0 = 1.0000e-04
Validation rmse = 0.605484
Model 0 best validation rmse = 0.586218 on epoch 23
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.637968
Ensemble test rmse = 0.637968
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 2.0461e-02, PNorm = 75.7817, GNorm = 9.5453, lr_0 = 2.9800e-04
Loss = 1.1190e-02, PNorm = 75.8414, GNorm = 1.7019, lr_0 = 4.7800e-04
Validation rmse = 1.248214
Epoch 1
Loss = 5.3406e-03, PNorm = 75.9320, GNorm = 2.0125, lr_0 = 6.7600e-04
Loss = 7.1934e-03, PNorm = 76.0187, GNorm = 14.3222, lr_0 = 8.5600e-04
Loss = 9.3319e-03, PNorm = 76.1300, GNorm = 3.6782, lr_0 = 9.9344e-04
Validation rmse = 1.090971
Epoch 2
Loss = 6.3016e-03, PNorm = 76.2400, GNorm = 3.7327, lr_0 = 9.6130e-04
Loss = 5.0837e-03, PNorm = 76.3277, GNorm = 2.6311, lr_0 = 9.3019e-04
Validation rmse = 0.948045
Epoch 3
Loss = 3.3237e-03, PNorm = 76.4110, GNorm = 1.4663, lr_0 = 9.0009e-04
Loss = 4.3061e-03, PNorm = 76.4800, GNorm = 5.8133, lr_0 = 8.7096e-04
Loss = 4.4534e-03, PNorm = 76.5420, GNorm = 2.8178, lr_0 = 8.4278e-04
Validation rmse = 0.841540
Epoch 4
Loss = 3.1373e-03, PNorm = 76.5880, GNorm = 3.3460, lr_0 = 8.1551e-04
Loss = 3.9124e-03, PNorm = 76.6332, GNorm = 4.3181, lr_0 = 7.8912e-04
Validation rmse = 0.844346
Epoch 5
Loss = 2.8504e-03, PNorm = 76.6812, GNorm = 2.8903, lr_0 = 7.6358e-04
Loss = 2.3380e-03, PNorm = 76.7198, GNorm = 0.7274, lr_0 = 7.3888e-04
Loss = 3.0507e-03, PNorm = 76.7589, GNorm = 2.9427, lr_0 = 7.1497e-04
Validation rmse = 0.799322
Epoch 6
Loss = 2.4457e-03, PNorm = 76.8076, GNorm = 1.2634, lr_0 = 6.8956e-04
Loss = 2.4816e-03, PNorm = 76.8379, GNorm = 2.0030, lr_0 = 6.6725e-04
Loss = 2.6072e-03, PNorm = 76.8739, GNorm = 4.0595, lr_0 = 6.4565e-04
Validation rmse = 0.703852
Epoch 7
Loss = 2.0566e-03, PNorm = 76.9107, GNorm = 1.8667, lr_0 = 6.2476e-04
Loss = 2.3515e-03, PNorm = 76.9447, GNorm = 1.4408, lr_0 = 6.0454e-04
Validation rmse = 0.755795
Epoch 8
Loss = 1.6961e-03, PNorm = 76.9760, GNorm = 0.8209, lr_0 = 5.8498e-04
Loss = 1.8209e-03, PNorm = 77.0079, GNorm = 1.1142, lr_0 = 5.6605e-04
Loss = 1.7425e-03, PNorm = 77.0387, GNorm = 1.2412, lr_0 = 5.4774e-04
Validation rmse = 0.706025
Epoch 9
Loss = 1.7699e-03, PNorm = 77.0705, GNorm = 0.5770, lr_0 = 5.3001e-04
Loss = 1.7154e-03, PNorm = 77.1038, GNorm = 1.0367, lr_0 = 5.1286e-04
Validation rmse = 0.645046
Epoch 10
Loss = 1.0268e-03, PNorm = 77.1336, GNorm = 0.9258, lr_0 = 4.9627e-04
Loss = 1.4274e-03, PNorm = 77.1620, GNorm = 0.9387, lr_0 = 4.8021e-04
Loss = 1.4646e-03, PNorm = 77.1848, GNorm = 1.4332, lr_0 = 4.6467e-04
Validation rmse = 0.645093
Epoch 11
Loss = 1.2394e-03, PNorm = 77.2110, GNorm = 1.2158, lr_0 = 4.4963e-04
Loss = 1.6406e-03, PNorm = 77.2399, GNorm = 1.3972, lr_0 = 4.3508e-04
Validation rmse = 0.710585
Epoch 12
Loss = 1.7810e-03, PNorm = 77.2700, GNorm = 1.6272, lr_0 = 4.1962e-04
Loss = 1.5094e-03, PNorm = 77.2969, GNorm = 0.9191, lr_0 = 4.0604e-04
Loss = 1.2961e-03, PNorm = 77.3257, GNorm = 0.6568, lr_0 = 3.9290e-04
Validation rmse = 0.642301
Epoch 13
Loss = 1.4075e-03, PNorm = 77.3465, GNorm = 1.1980, lr_0 = 3.8019e-04
Loss = 1.2483e-03, PNorm = 77.3665, GNorm = 0.6286, lr_0 = 3.6789e-04
Loss = 1.2671e-03, PNorm = 77.3936, GNorm = 1.2736, lr_0 = 3.5598e-04
Validation rmse = 0.633127
Epoch 14
Loss = 1.1566e-03, PNorm = 77.4191, GNorm = 1.9508, lr_0 = 3.4446e-04
Loss = 1.1977e-03, PNorm = 77.4402, GNorm = 2.1694, lr_0 = 3.3332e-04
Validation rmse = 0.644442
Epoch 15
Loss = 1.0273e-03, PNorm = 77.4590, GNorm = 1.0676, lr_0 = 3.2253e-04
Loss = 1.0719e-03, PNorm = 77.4823, GNorm = 1.6523, lr_0 = 3.1209e-04
Loss = 1.0258e-03, PNorm = 77.5032, GNorm = 0.9703, lr_0 = 3.0200e-04
Validation rmse = 0.645665
Epoch 16
Loss = 1.1198e-03, PNorm = 77.5220, GNorm = 0.7815, lr_0 = 2.9222e-04
Loss = 1.1131e-03, PNorm = 77.5453, GNorm = 0.3847, lr_0 = 2.8277e-04
Validation rmse = 0.618899
Epoch 17
Loss = 9.4353e-04, PNorm = 77.5648, GNorm = 1.7144, lr_0 = 2.7272e-04
Loss = 8.6286e-04, PNorm = 77.5804, GNorm = 1.1187, lr_0 = 2.6389e-04
Loss = 9.0148e-04, PNorm = 77.5974, GNorm = 1.3893, lr_0 = 2.5535e-04
Validation rmse = 0.613262
Epoch 18
Loss = 7.6508e-04, PNorm = 77.6142, GNorm = 1.2958, lr_0 = 2.4709e-04
Loss = 1.0038e-03, PNorm = 77.6300, GNorm = 0.5074, lr_0 = 2.3910e-04
Loss = 8.2241e-04, PNorm = 77.6479, GNorm = 0.8798, lr_0 = 2.3136e-04
Validation rmse = 0.613350
Epoch 19
Loss = 8.3582e-04, PNorm = 77.6659, GNorm = 0.6945, lr_0 = 2.2387e-04
Loss = 6.8644e-04, PNorm = 77.6815, GNorm = 1.3470, lr_0 = 2.1663e-04
Validation rmse = 0.584126
Epoch 20
Loss = 6.7024e-04, PNorm = 77.6946, GNorm = 0.4360, lr_0 = 2.0962e-04
Loss = 7.4280e-04, PNorm = 77.7086, GNorm = 0.6575, lr_0 = 2.0283e-04
Loss = 1.1326e-03, PNorm = 77.7220, GNorm = 1.8640, lr_0 = 1.9627e-04
Validation rmse = 0.649582
Epoch 21
Loss = 7.1215e-04, PNorm = 77.7353, GNorm = 0.3843, lr_0 = 1.8992e-04
Loss = 7.9255e-04, PNorm = 77.7500, GNorm = 0.4684, lr_0 = 1.8377e-04
Validation rmse = 0.612741
Epoch 22
Loss = 8.7527e-04, PNorm = 77.7609, GNorm = 0.6918, lr_0 = 1.7783e-04
Loss = 7.5601e-04, PNorm = 77.7718, GNorm = 1.1291, lr_0 = 1.7207e-04
Loss = 5.9008e-04, PNorm = 77.7815, GNorm = 0.5567, lr_0 = 1.6651e-04
Validation rmse = 0.606105
Epoch 23
Loss = 6.8475e-04, PNorm = 77.7942, GNorm = 0.8448, lr_0 = 1.6059e-04
Loss = 5.6315e-04, PNorm = 77.8033, GNorm = 0.3059, lr_0 = 1.5539e-04
Validation rmse = 0.617439
Epoch 24
Loss = 5.7575e-04, PNorm = 77.8137, GNorm = 1.1029, lr_0 = 1.5036e-04
Loss = 5.4121e-04, PNorm = 77.8240, GNorm = 0.3149, lr_0 = 1.4550e-04
Loss = 5.1839e-04, PNorm = 77.8327, GNorm = 0.9981, lr_0 = 1.4079e-04
Validation rmse = 0.663610
Epoch 25
Loss = 6.4106e-04, PNorm = 77.8411, GNorm = 2.0679, lr_0 = 1.3623e-04
Loss = 6.4311e-04, PNorm = 77.8488, GNorm = 2.1723, lr_0 = 1.3183e-04
Loss = 7.0840e-04, PNorm = 77.8569, GNorm = 0.8047, lr_0 = 1.2756e-04
Validation rmse = 0.622212
Epoch 26
Loss = 6.2602e-04, PNorm = 77.8657, GNorm = 0.5684, lr_0 = 1.2343e-04
Loss = 5.2269e-04, PNorm = 77.8753, GNorm = 0.4051, lr_0 = 1.1944e-04
Validation rmse = 0.596516
Epoch 27
Loss = 4.6115e-04, PNorm = 77.8831, GNorm = 0.4482, lr_0 = 1.1557e-04
Loss = 4.8316e-04, PNorm = 77.8910, GNorm = 0.4296, lr_0 = 1.1183e-04
Loss = 4.9649e-04, PNorm = 77.8973, GNorm = 0.5052, lr_0 = 1.0821e-04
Validation rmse = 0.602753
Epoch 28
Loss = 4.3180e-04, PNorm = 77.9037, GNorm = 0.2703, lr_0 = 1.0437e-04
Loss = 5.2035e-04, PNorm = 77.9104, GNorm = 0.3138, lr_0 = 1.0099e-04
Validation rmse = 0.587192
Epoch 29
Loss = 3.5781e-04, PNorm = 77.9170, GNorm = 0.6353, lr_0 = 1.0000e-04
Loss = 3.8682e-04, PNorm = 77.9230, GNorm = 0.5896, lr_0 = 1.0000e-04
Loss = 5.5749e-04, PNorm = 77.9285, GNorm = 0.4005, lr_0 = 1.0000e-04
Validation rmse = 0.597845
Model 0 best validation rmse = 0.584126 on epoch 19
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.866818
Ensemble test rmse = 0.866818
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 2.1273e-02, PNorm = 75.7827, GNorm = 5.7596, lr_0 = 2.9800e-04
Loss = 1.3319e-02, PNorm = 75.8422, GNorm = 13.4306, lr_0 = 4.7800e-04
Validation rmse = 1.931354
Epoch 1
Loss = 9.8342e-03, PNorm = 75.9349, GNorm = 2.4603, lr_0 = 6.7600e-04
Loss = 7.7812e-03, PNorm = 76.0308, GNorm = 2.3092, lr_0 = 8.5600e-04
Loss = 6.5326e-03, PNorm = 76.1324, GNorm = 1.2248, lr_0 = 9.9344e-04
Validation rmse = 1.249191
Epoch 2
Loss = 5.6022e-03, PNorm = 76.2338, GNorm = 1.4607, lr_0 = 9.6130e-04
Loss = 5.1348e-03, PNorm = 76.3269, GNorm = 2.7437, lr_0 = 9.3019e-04
Validation rmse = 0.955304
Epoch 3
Loss = 3.5176e-03, PNorm = 76.4077, GNorm = 1.4371, lr_0 = 9.0009e-04
Loss = 4.7149e-03, PNorm = 76.4721, GNorm = 2.4768, lr_0 = 8.7096e-04
Loss = 4.0771e-03, PNorm = 76.5366, GNorm = 2.6946, lr_0 = 8.4278e-04
Validation rmse = 0.947118
Epoch 4
Loss = 2.9216e-03, PNorm = 76.5915, GNorm = 3.8357, lr_0 = 8.1551e-04
Loss = 2.9683e-03, PNorm = 76.6422, GNorm = 3.8027, lr_0 = 7.8912e-04
Validation rmse = 0.970993
Epoch 5
Loss = 2.7944e-03, PNorm = 76.6898, GNorm = 2.6320, lr_0 = 7.6358e-04
Loss = 2.3369e-03, PNorm = 76.7313, GNorm = 3.7506, lr_0 = 7.3888e-04
Loss = 3.1803e-03, PNorm = 76.7744, GNorm = 1.8772, lr_0 = 7.1497e-04
Validation rmse = 0.986723
Epoch 6
Loss = 2.1794e-03, PNorm = 76.8172, GNorm = 0.6506, lr_0 = 6.8956e-04
Loss = 3.4844e-03, PNorm = 76.8616, GNorm = 2.9574, lr_0 = 6.6725e-04
Loss = 2.7798e-03, PNorm = 76.9060, GNorm = 3.7940, lr_0 = 6.4565e-04
Validation rmse = 0.917271
Epoch 7
Loss = 2.0243e-03, PNorm = 76.9412, GNorm = 0.5662, lr_0 = 6.2476e-04
Loss = 2.3082e-03, PNorm = 76.9672, GNorm = 3.1373, lr_0 = 6.0454e-04
Validation rmse = 0.813269
Epoch 8
Loss = 2.3263e-03, PNorm = 77.0036, GNorm = 4.2674, lr_0 = 5.8498e-04
Loss = 2.7038e-03, PNorm = 77.0411, GNorm = 0.7181, lr_0 = 5.6605e-04
Loss = 1.8044e-03, PNorm = 77.0702, GNorm = 0.6157, lr_0 = 5.4774e-04
Validation rmse = 0.799577
Epoch 9
Loss = 1.6939e-03, PNorm = 77.0968, GNorm = 3.5280, lr_0 = 5.3001e-04
Loss = 1.8448e-03, PNorm = 77.1235, GNorm = 1.1531, lr_0 = 5.1286e-04
Validation rmse = 0.801955
Epoch 10
Loss = 1.5339e-03, PNorm = 77.1475, GNorm = 0.6542, lr_0 = 4.9627e-04
Loss = 1.7616e-03, PNorm = 77.1725, GNorm = 0.9622, lr_0 = 4.8021e-04
Loss = 1.4248e-03, PNorm = 77.1966, GNorm = 1.9163, lr_0 = 4.6467e-04
Validation rmse = 0.820732
Epoch 11
Loss = 1.6758e-03, PNorm = 77.2176, GNorm = 4.4884, lr_0 = 4.4963e-04
Loss = 2.7722e-03, PNorm = 77.2462, GNorm = 3.1431, lr_0 = 4.3508e-04
Validation rmse = 0.912601
Epoch 12
Loss = 1.5452e-03, PNorm = 77.2783, GNorm = 1.3449, lr_0 = 4.1962e-04
Loss = 1.6249e-03, PNorm = 77.3115, GNorm = 0.8921, lr_0 = 4.0604e-04
Loss = 1.4157e-03, PNorm = 77.3355, GNorm = 0.7858, lr_0 = 3.9290e-04
Validation rmse = 0.777391
Epoch 13
Loss = 1.4268e-03, PNorm = 77.3540, GNorm = 1.8641, lr_0 = 3.8019e-04
Loss = 1.3865e-03, PNorm = 77.3730, GNorm = 1.2599, lr_0 = 3.6789e-04
Loss = 1.3247e-03, PNorm = 77.3906, GNorm = 1.6089, lr_0 = 3.5598e-04
Validation rmse = 0.880673
Epoch 14
Loss = 1.6439e-03, PNorm = 77.4127, GNorm = 1.8960, lr_0 = 3.4446e-04
Loss = 1.3349e-03, PNorm = 77.4335, GNorm = 1.7871, lr_0 = 3.3332e-04
Validation rmse = 0.752397
Epoch 15
Loss = 1.0021e-03, PNorm = 77.4540, GNorm = 2.6864, lr_0 = 3.2253e-04
Loss = 1.1443e-03, PNorm = 77.4697, GNorm = 0.6738, lr_0 = 3.1209e-04
Loss = 9.7935e-04, PNorm = 77.4857, GNorm = 1.1312, lr_0 = 3.0200e-04
Validation rmse = 0.784162
Epoch 16
Loss = 1.0613e-03, PNorm = 77.5037, GNorm = 0.6181, lr_0 = 2.9222e-04
Loss = 1.1369e-03, PNorm = 77.5192, GNorm = 0.9448, lr_0 = 2.8277e-04
Validation rmse = 0.748574
Epoch 17
Loss = 1.4098e-03, PNorm = 77.5370, GNorm = 1.3808, lr_0 = 2.7272e-04
Loss = 1.0567e-03, PNorm = 77.5545, GNorm = 0.5738, lr_0 = 2.6389e-04
Loss = 8.9360e-04, PNorm = 77.5692, GNorm = 0.3932, lr_0 = 2.5535e-04
Validation rmse = 0.743804
Epoch 18
Loss = 7.3016e-04, PNorm = 77.5839, GNorm = 0.7909, lr_0 = 2.4709e-04
Loss = 1.0106e-03, PNorm = 77.5991, GNorm = 1.1431, lr_0 = 2.3910e-04
Loss = 9.4339e-04, PNorm = 77.6152, GNorm = 0.3810, lr_0 = 2.3136e-04
Validation rmse = 0.763576
Epoch 19
Loss = 8.5802e-04, PNorm = 77.6286, GNorm = 0.8501, lr_0 = 2.2387e-04
Loss = 8.8931e-04, PNorm = 77.6438, GNorm = 0.5787, lr_0 = 2.1663e-04
Validation rmse = 0.753948
Epoch 20
Loss = 5.7648e-04, PNorm = 77.6574, GNorm = 0.3936, lr_0 = 2.0962e-04
Loss = 8.2680e-04, PNorm = 77.6688, GNorm = 0.6076, lr_0 = 2.0283e-04
Loss = 8.0539e-04, PNorm = 77.6802, GNorm = 1.6599, lr_0 = 1.9627e-04
Validation rmse = 0.757264
Epoch 21
Loss = 7.0108e-04, PNorm = 77.6925, GNorm = 0.4205, lr_0 = 1.8992e-04
Loss = 7.4757e-04, PNorm = 77.7052, GNorm = 1.0247, lr_0 = 1.8377e-04
Validation rmse = 0.740734
Epoch 22
Loss = 7.1704e-04, PNorm = 77.7167, GNorm = 0.5875, lr_0 = 1.7783e-04
Loss = 7.3620e-04, PNorm = 77.7244, GNorm = 1.3962, lr_0 = 1.7207e-04
Loss = 8.7140e-04, PNorm = 77.7360, GNorm = 1.0340, lr_0 = 1.6651e-04
Validation rmse = 0.747031
Epoch 23
Loss = 7.0883e-04, PNorm = 77.7501, GNorm = 0.8959, lr_0 = 1.6059e-04
Loss = 6.3646e-04, PNorm = 77.7601, GNorm = 0.8620, lr_0 = 1.5539e-04
Validation rmse = 0.754880
Epoch 24
Loss = 4.9390e-04, PNorm = 77.7696, GNorm = 0.4350, lr_0 = 1.5036e-04
Loss = 7.7371e-04, PNorm = 77.7782, GNorm = 2.0960, lr_0 = 1.4550e-04
Loss = 7.6338e-04, PNorm = 77.7888, GNorm = 0.6780, lr_0 = 1.4079e-04
Validation rmse = 0.734766
Epoch 25
Loss = 5.8996e-04, PNorm = 77.7985, GNorm = 0.6804, lr_0 = 1.3623e-04
Loss = 6.2424e-04, PNorm = 77.8071, GNorm = 0.8127, lr_0 = 1.3183e-04
Loss = 6.2379e-04, PNorm = 77.8150, GNorm = 0.6218, lr_0 = 1.2756e-04
Validation rmse = 0.753294
Epoch 26
Loss = 5.6991e-04, PNorm = 77.8233, GNorm = 0.8384, lr_0 = 1.2343e-04
Loss = 6.0060e-04, PNorm = 77.8306, GNorm = 0.9436, lr_0 = 1.1944e-04
Validation rmse = 0.729727
Epoch 27
Loss = 6.2612e-04, PNorm = 77.8393, GNorm = 0.7380, lr_0 = 1.1557e-04
Loss = 5.0357e-04, PNorm = 77.8464, GNorm = 0.4545, lr_0 = 1.1183e-04
Loss = 5.5795e-04, PNorm = 77.8528, GNorm = 0.3566, lr_0 = 1.0821e-04
Validation rmse = 0.725057
Epoch 28
Loss = 4.2940e-04, PNorm = 77.8616, GNorm = 0.3692, lr_0 = 1.0437e-04
Loss = 6.3387e-04, PNorm = 77.8685, GNorm = 0.2435, lr_0 = 1.0099e-04
Validation rmse = 0.790422
Epoch 29
Loss = 9.6672e-04, PNorm = 77.8762, GNorm = 0.4857, lr_0 = 1.0000e-04
Loss = 5.0445e-04, PNorm = 77.8834, GNorm = 0.7680, lr_0 = 1.0000e-04
Loss = 4.0512e-04, PNorm = 77.8900, GNorm = 0.4669, lr_0 = 1.0000e-04
Validation rmse = 0.725693
Model 0 best validation rmse = 0.725057 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.030011
Ensemble test rmse = 1.030011
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 1.9851e-02, PNorm = 75.7838, GNorm = 2.1212, lr_0 = 2.9800e-04
Loss = 1.3735e-02, PNorm = 75.8412, GNorm = 10.6059, lr_0 = 4.7800e-04
Validation rmse = 1.755342
Epoch 1
Loss = 9.1657e-03, PNorm = 75.9366, GNorm = 2.7332, lr_0 = 6.7600e-04
Loss = 8.0930e-03, PNorm = 76.0390, GNorm = 2.3145, lr_0 = 8.5600e-04
Loss = 1.0814e-02, PNorm = 76.1582, GNorm = 6.1058, lr_0 = 9.9344e-04
Validation rmse = 2.195776
Epoch 2
Loss = 8.0416e-03, PNorm = 76.3058, GNorm = 4.7247, lr_0 = 9.6130e-04
Loss = 7.1854e-03, PNorm = 76.4224, GNorm = 2.3022, lr_0 = 9.3019e-04
Validation rmse = 1.243735
Epoch 3
Loss = 4.9242e-03, PNorm = 76.5081, GNorm = 3.1966, lr_0 = 9.0009e-04
Loss = 4.7999e-03, PNorm = 76.5834, GNorm = 1.5152, lr_0 = 8.7096e-04
Loss = 4.5989e-03, PNorm = 76.6478, GNorm = 3.6787, lr_0 = 8.4278e-04
Validation rmse = 1.006472
Epoch 4
Loss = 3.3301e-03, PNorm = 76.7111, GNorm = 3.7734, lr_0 = 8.1551e-04
Loss = 3.4105e-03, PNorm = 76.7559, GNorm = 1.3774, lr_0 = 7.8912e-04
Validation rmse = 1.224555
Epoch 5
Loss = 3.9804e-03, PNorm = 76.8030, GNorm = 4.2213, lr_0 = 7.6358e-04
Loss = 3.2911e-03, PNorm = 76.8529, GNorm = 2.0025, lr_0 = 7.3888e-04
Loss = 3.6266e-03, PNorm = 76.9046, GNorm = 1.4444, lr_0 = 7.1497e-04
Validation rmse = 0.968597
Epoch 6
Loss = 2.4563e-03, PNorm = 76.9619, GNorm = 1.5794, lr_0 = 6.8956e-04
Loss = 2.9575e-03, PNorm = 77.0064, GNorm = 0.9320, lr_0 = 6.6725e-04
Loss = 2.1785e-03, PNorm = 77.0442, GNorm = 2.0196, lr_0 = 6.4565e-04
Validation rmse = 0.922622
Epoch 7
Loss = 2.0022e-03, PNorm = 77.0809, GNorm = 0.8005, lr_0 = 6.2476e-04
Loss = 2.1823e-03, PNorm = 77.1171, GNorm = 2.7463, lr_0 = 6.0454e-04
Validation rmse = 1.093092
Epoch 8
Loss = 1.9885e-03, PNorm = 77.1498, GNorm = 0.6998, lr_0 = 5.8498e-04
Loss = 2.0635e-03, PNorm = 77.1860, GNorm = 2.4073, lr_0 = 5.6605e-04
Loss = 2.1007e-03, PNorm = 77.2171, GNorm = 0.6201, lr_0 = 5.4774e-04
Validation rmse = 0.985526
Epoch 9
Loss = 1.8103e-03, PNorm = 77.2419, GNorm = 1.7425, lr_0 = 5.3001e-04
Loss = 2.0253e-03, PNorm = 77.2741, GNorm = 1.6272, lr_0 = 5.1286e-04
Validation rmse = 0.927040
Epoch 10
Loss = 1.4051e-03, PNorm = 77.3091, GNorm = 1.9155, lr_0 = 4.9627e-04
Loss = 1.5571e-03, PNorm = 77.3383, GNorm = 0.5196, lr_0 = 4.8021e-04
Loss = 2.0030e-03, PNorm = 77.3661, GNorm = 1.1698, lr_0 = 4.6467e-04
Validation rmse = 0.877272
Epoch 11
Loss = 1.3946e-03, PNorm = 77.4000, GNorm = 1.9386, lr_0 = 4.4963e-04
Loss = 2.0056e-03, PNorm = 77.4310, GNorm = 2.9587, lr_0 = 4.3508e-04
Validation rmse = 0.992915
Epoch 12
Loss = 1.8774e-03, PNorm = 77.4603, GNorm = 1.6500, lr_0 = 4.1962e-04
Loss = 1.4587e-03, PNorm = 77.4848, GNorm = 1.1136, lr_0 = 4.0604e-04
Loss = 1.2959e-03, PNorm = 77.5060, GNorm = 1.5591, lr_0 = 3.9290e-04
Validation rmse = 0.983118
Epoch 13
Loss = 1.5703e-03, PNorm = 77.5340, GNorm = 3.8687, lr_0 = 3.8019e-04
Loss = 1.2598e-03, PNorm = 77.5544, GNorm = 1.1658, lr_0 = 3.6789e-04
Loss = 1.3156e-03, PNorm = 77.5725, GNorm = 2.1192, lr_0 = 3.5598e-04
Validation rmse = 0.824434
Epoch 14
Loss = 1.7321e-03, PNorm = 77.6017, GNorm = 3.9705, lr_0 = 3.4446e-04
Loss = 1.3361e-03, PNorm = 77.6249, GNorm = 0.5561, lr_0 = 3.3332e-04
Validation rmse = 0.928173
Epoch 15
Loss = 1.5663e-03, PNorm = 77.6429, GNorm = 1.6258, lr_0 = 3.2253e-04
Loss = 1.0977e-03, PNorm = 77.6628, GNorm = 0.8156, lr_0 = 3.1209e-04
Loss = 1.0388e-03, PNorm = 77.6825, GNorm = 0.7704, lr_0 = 3.0200e-04
Validation rmse = 0.867516
Epoch 16
Loss = 1.1788e-03, PNorm = 77.7003, GNorm = 1.1243, lr_0 = 2.9222e-04
Loss = 1.0338e-03, PNorm = 77.7185, GNorm = 2.2661, lr_0 = 2.8277e-04
Validation rmse = 0.870008
Epoch 17
Loss = 1.2381e-03, PNorm = 77.7385, GNorm = 1.0821, lr_0 = 2.7272e-04
Loss = 1.0663e-03, PNorm = 77.7585, GNorm = 0.6446, lr_0 = 2.6389e-04
Loss = 8.8775e-04, PNorm = 77.7804, GNorm = 0.9549, lr_0 = 2.5535e-04
Validation rmse = 0.821158
Epoch 18
Loss = 9.7463e-04, PNorm = 77.7892, GNorm = 1.0496, lr_0 = 2.4709e-04
Loss = 8.7323e-04, PNorm = 77.8021, GNorm = 0.4748, lr_0 = 2.3910e-04
Loss = 9.0089e-04, PNorm = 77.8173, GNorm = 0.8248, lr_0 = 2.3136e-04
Validation rmse = 0.873072
Epoch 19
Loss = 9.2424e-04, PNorm = 77.8313, GNorm = 1.2863, lr_0 = 2.2387e-04
Loss = 9.9004e-04, PNorm = 77.8443, GNorm = 1.0147, lr_0 = 2.1663e-04
Validation rmse = 0.830142
Epoch 20
Loss = 7.8762e-04, PNorm = 77.8571, GNorm = 0.4868, lr_0 = 2.0962e-04
Loss = 8.5652e-04, PNorm = 77.8734, GNorm = 1.1527, lr_0 = 2.0283e-04
Loss = 7.9542e-04, PNorm = 77.8854, GNorm = 0.6170, lr_0 = 1.9627e-04
Validation rmse = 0.842479
Epoch 21
Loss = 7.7819e-04, PNorm = 77.8975, GNorm = 1.0818, lr_0 = 1.8992e-04
Loss = 7.3886e-04, PNorm = 77.9089, GNorm = 0.7112, lr_0 = 1.8377e-04
Validation rmse = 0.814791
Epoch 22
Loss = 6.1038e-04, PNorm = 77.9202, GNorm = 0.3957, lr_0 = 1.7783e-04
Loss = 5.2999e-04, PNorm = 77.9312, GNorm = 0.9049, lr_0 = 1.7207e-04
Loss = 7.7382e-04, PNorm = 77.9408, GNorm = 0.8319, lr_0 = 1.6651e-04
Validation rmse = 0.884976
Epoch 23
Loss = 6.6726e-04, PNorm = 77.9521, GNorm = 0.3579, lr_0 = 1.6059e-04
Loss = 6.0738e-04, PNorm = 77.9628, GNorm = 0.9619, lr_0 = 1.5539e-04
Validation rmse = 0.811968
Epoch 24
Loss = 6.2746e-04, PNorm = 77.9724, GNorm = 0.9939, lr_0 = 1.5036e-04
Loss = 7.5053e-04, PNorm = 77.9851, GNorm = 0.5330, lr_0 = 1.4550e-04
Loss = 6.4404e-04, PNorm = 77.9953, GNorm = 0.5664, lr_0 = 1.4079e-04
Validation rmse = 0.782449
Epoch 25
Loss = 6.1000e-04, PNorm = 78.0042, GNorm = 0.5031, lr_0 = 1.3623e-04
Loss = 5.6381e-04, PNorm = 78.0137, GNorm = 0.5963, lr_0 = 1.3183e-04
Loss = 6.0369e-04, PNorm = 78.0218, GNorm = 0.4516, lr_0 = 1.2756e-04
Validation rmse = 0.791711
Epoch 26
Loss = 5.9165e-04, PNorm = 78.0294, GNorm = 1.0532, lr_0 = 1.2343e-04
Loss = 5.4294e-04, PNorm = 78.0374, GNorm = 1.6447, lr_0 = 1.1944e-04
Validation rmse = 0.820926
Epoch 27
Loss = 4.8250e-04, PNorm = 78.0438, GNorm = 0.6212, lr_0 = 1.1557e-04
Loss = 5.9629e-04, PNorm = 78.0525, GNorm = 1.7214, lr_0 = 1.1183e-04
Loss = 6.2598e-04, PNorm = 78.0595, GNorm = 0.6273, lr_0 = 1.0821e-04
Validation rmse = 0.789097
Epoch 28
Loss = 6.0996e-04, PNorm = 78.0686, GNorm = 0.3587, lr_0 = 1.0437e-04
Loss = 5.0208e-04, PNorm = 78.0740, GNorm = 1.0414, lr_0 = 1.0099e-04
Validation rmse = 0.780912
Epoch 29
Loss = 3.6266e-04, PNorm = 78.0801, GNorm = 1.0533, lr_0 = 1.0000e-04
Loss = 5.5526e-04, PNorm = 78.0864, GNorm = 1.0163, lr_0 = 1.0000e-04
Loss = 5.1681e-04, PNorm = 78.0931, GNorm = 0.8159, lr_0 = 1.0000e-04
Validation rmse = 0.793743
Model 0 best validation rmse = 0.780912 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.672819
Ensemble test rmse = 0.672819
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 2.1084e-02, PNorm = 75.7813, GNorm = 5.3755, lr_0 = 2.9800e-04
Loss = 1.3358e-02, PNorm = 75.8440, GNorm = 7.5289, lr_0 = 4.7800e-04
Validation rmse = 1.672724
Epoch 1
Loss = 7.9857e-03, PNorm = 75.9464, GNorm = 4.7157, lr_0 = 6.7600e-04
Loss = 8.1691e-03, PNorm = 76.0408, GNorm = 5.3821, lr_0 = 8.5600e-04
Loss = 6.5282e-03, PNorm = 76.1513, GNorm = 0.9386, lr_0 = 9.9344e-04
Validation rmse = 1.461707
Epoch 2
Loss = 7.5279e-03, PNorm = 76.2572, GNorm = 2.4318, lr_0 = 9.6130e-04
Loss = 5.6514e-03, PNorm = 76.3438, GNorm = 2.6224, lr_0 = 9.3019e-04
Validation rmse = 1.346432
Epoch 3
Loss = 5.9752e-03, PNorm = 76.4345, GNorm = 2.2031, lr_0 = 9.0009e-04
Loss = 5.1268e-03, PNorm = 76.5203, GNorm = 1.2827, lr_0 = 8.7096e-04
Loss = 3.5355e-03, PNorm = 76.5834, GNorm = 1.4317, lr_0 = 8.4278e-04
Validation rmse = 1.188904
Epoch 4
Loss = 2.9726e-03, PNorm = 76.6427, GNorm = 0.9467, lr_0 = 8.1551e-04
Loss = 3.4852e-03, PNorm = 76.6890, GNorm = 1.2995, lr_0 = 7.8912e-04
Validation rmse = 1.248562
Epoch 5
Loss = 3.9653e-03, PNorm = 76.7359, GNorm = 4.9797, lr_0 = 7.6358e-04
Loss = 2.9271e-03, PNorm = 76.7816, GNorm = 1.0452, lr_0 = 7.3888e-04
Loss = 2.7825e-03, PNorm = 76.8258, GNorm = 0.8524, lr_0 = 7.1497e-04
Validation rmse = 1.192090
Epoch 6
Loss = 2.3088e-03, PNorm = 76.8804, GNorm = 2.3177, lr_0 = 6.8956e-04
Loss = 2.2870e-03, PNorm = 76.9251, GNorm = 4.4715, lr_0 = 6.6725e-04
Loss = 2.8262e-03, PNorm = 76.9622, GNorm = 1.8146, lr_0 = 6.4565e-04
Validation rmse = 1.054853
Epoch 7
Loss = 2.3319e-03, PNorm = 77.0023, GNorm = 1.3574, lr_0 = 6.2476e-04
Loss = 1.7862e-03, PNorm = 77.0426, GNorm = 1.0106, lr_0 = 6.0454e-04
Validation rmse = 0.963235
Epoch 8
Loss = 2.0453e-03, PNorm = 77.0731, GNorm = 3.2096, lr_0 = 5.8498e-04
Loss = 1.6736e-03, PNorm = 77.1074, GNorm = 1.5325, lr_0 = 5.6605e-04
Loss = 1.8243e-03, PNorm = 77.1368, GNorm = 1.4398, lr_0 = 5.4774e-04
Validation rmse = 1.033555
Epoch 9
Loss = 1.8557e-03, PNorm = 77.1739, GNorm = 1.4359, lr_0 = 5.3001e-04
Loss = 1.3070e-03, PNorm = 77.2060, GNorm = 0.7261, lr_0 = 5.1286e-04
Validation rmse = 0.965369
Epoch 10
Loss = 1.6303e-03, PNorm = 77.2386, GNorm = 1.8392, lr_0 = 4.9627e-04
Loss = 1.9235e-03, PNorm = 77.2715, GNorm = 0.8994, lr_0 = 4.8021e-04
Loss = 1.8152e-03, PNorm = 77.2988, GNorm = 1.3139, lr_0 = 4.6467e-04
Validation rmse = 1.121954
Epoch 11
Loss = 1.9786e-03, PNorm = 77.3308, GNorm = 1.4227, lr_0 = 4.4963e-04
Loss = 1.3357e-03, PNorm = 77.3581, GNorm = 0.7893, lr_0 = 4.3508e-04
Validation rmse = 0.999607
Epoch 12
Loss = 1.1806e-03, PNorm = 77.3887, GNorm = 0.6773, lr_0 = 4.1962e-04
Loss = 1.1835e-03, PNorm = 77.4129, GNorm = 0.7833, lr_0 = 4.0604e-04
Loss = 1.3799e-03, PNorm = 77.4309, GNorm = 1.4706, lr_0 = 3.9290e-04
Validation rmse = 1.030719
Epoch 13
Loss = 1.3331e-03, PNorm = 77.4592, GNorm = 2.0728, lr_0 = 3.8019e-04
Loss = 1.2267e-03, PNorm = 77.4812, GNorm = 1.2444, lr_0 = 3.6789e-04
Loss = 1.1629e-03, PNorm = 77.5033, GNorm = 0.4067, lr_0 = 3.5598e-04
Validation rmse = 0.960963
Epoch 14
Loss = 1.0705e-03, PNorm = 77.5236, GNorm = 1.0791, lr_0 = 3.4446e-04
Loss = 9.6436e-04, PNorm = 77.5421, GNorm = 0.6992, lr_0 = 3.3332e-04
Validation rmse = 0.949664
Epoch 15
Loss = 6.2379e-04, PNorm = 77.5640, GNorm = 0.3375, lr_0 = 3.2253e-04
Loss = 1.1868e-03, PNorm = 77.5827, GNorm = 2.3168, lr_0 = 3.1209e-04
Loss = 9.5850e-04, PNorm = 77.6014, GNorm = 1.3395, lr_0 = 3.0200e-04
Validation rmse = 0.966402
Epoch 16
Loss = 1.0682e-03, PNorm = 77.6179, GNorm = 0.8816, lr_0 = 2.9222e-04
Loss = 1.0326e-03, PNorm = 77.6373, GNorm = 0.7394, lr_0 = 2.8277e-04
Validation rmse = 0.949398
Epoch 17
Loss = 8.3610e-04, PNorm = 77.6613, GNorm = 0.6770, lr_0 = 2.7272e-04
Loss = 9.3340e-04, PNorm = 77.6780, GNorm = 0.6563, lr_0 = 2.6389e-04
Loss = 9.5056e-04, PNorm = 77.6957, GNorm = 1.5004, lr_0 = 2.5535e-04
Validation rmse = 1.015093
Epoch 18
Loss = 1.2545e-03, PNorm = 77.7109, GNorm = 0.5426, lr_0 = 2.4709e-04
Loss = 9.8067e-04, PNorm = 77.7277, GNorm = 0.8039, lr_0 = 2.3910e-04
Loss = 9.3638e-04, PNorm = 77.7416, GNorm = 0.9667, lr_0 = 2.3136e-04
Validation rmse = 0.958469
Epoch 19
Loss = 8.0750e-04, PNorm = 77.7546, GNorm = 0.5984, lr_0 = 2.2387e-04
Loss = 7.6416e-04, PNorm = 77.7696, GNorm = 0.9872, lr_0 = 2.1663e-04
Validation rmse = 0.936879
Epoch 20
Loss = 8.1426e-04, PNorm = 77.7818, GNorm = 1.1265, lr_0 = 2.0962e-04
Loss = 6.4898e-04, PNorm = 77.7963, GNorm = 0.4756, lr_0 = 2.0283e-04
Loss = 7.8752e-04, PNorm = 77.8097, GNorm = 0.4123, lr_0 = 1.9627e-04
Validation rmse = 0.939398
Epoch 21
Loss = 6.2711e-04, PNorm = 77.8209, GNorm = 0.4273, lr_0 = 1.8992e-04
Loss = 6.6536e-04, PNorm = 77.8325, GNorm = 1.4076, lr_0 = 1.8377e-04
Validation rmse = 0.935479
Epoch 22
Loss = 6.2053e-04, PNorm = 77.8418, GNorm = 0.6166, lr_0 = 1.7783e-04
Loss = 6.1995e-04, PNorm = 77.8522, GNorm = 0.4251, lr_0 = 1.7207e-04
Loss = 7.0291e-04, PNorm = 77.8631, GNorm = 1.1323, lr_0 = 1.6651e-04
Validation rmse = 0.930000
Epoch 23
Loss = 5.7182e-04, PNorm = 77.8744, GNorm = 1.3157, lr_0 = 1.6059e-04
Loss = 7.5759e-04, PNorm = 77.8838, GNorm = 1.1197, lr_0 = 1.5539e-04
Validation rmse = 0.948140
Epoch 24
Loss = 6.6851e-04, PNorm = 77.8941, GNorm = 1.0704, lr_0 = 1.5036e-04
Loss = 5.9732e-04, PNorm = 77.9038, GNorm = 0.5111, lr_0 = 1.4550e-04
Loss = 6.5345e-04, PNorm = 77.9139, GNorm = 0.4597, lr_0 = 1.4079e-04
Validation rmse = 0.923550
Epoch 25
Loss = 5.9674e-04, PNorm = 77.9225, GNorm = 0.5208, lr_0 = 1.3623e-04
Loss = 4.8185e-04, PNorm = 77.9297, GNorm = 0.5788, lr_0 = 1.3183e-04
Loss = 6.2896e-04, PNorm = 77.9381, GNorm = 0.4293, lr_0 = 1.2756e-04
Validation rmse = 0.929427
Epoch 26
Loss = 5.3135e-04, PNorm = 77.9452, GNorm = 1.3029, lr_0 = 1.2343e-04
Loss = 5.8340e-04, PNorm = 77.9534, GNorm = 0.7252, lr_0 = 1.1944e-04
Validation rmse = 0.928112
Epoch 27
Loss = 5.4348e-04, PNorm = 77.9616, GNorm = 0.7352, lr_0 = 1.1557e-04
Loss = 4.7726e-04, PNorm = 77.9686, GNorm = 1.2346, lr_0 = 1.1183e-04
Loss = 5.8659e-04, PNorm = 77.9765, GNorm = 0.9089, lr_0 = 1.0821e-04
Validation rmse = 0.954492
Epoch 28
Loss = 4.9094e-04, PNorm = 77.9835, GNorm = 0.3224, lr_0 = 1.0437e-04
Loss = 4.9730e-04, PNorm = 77.9905, GNorm = 1.4850, lr_0 = 1.0099e-04
Validation rmse = 0.922104
Epoch 29
Loss = 4.3098e-04, PNorm = 77.9966, GNorm = 0.6974, lr_0 = 1.0000e-04
Loss = 3.9609e-04, PNorm = 78.0018, GNorm = 0.3412, lr_0 = 1.0000e-04
Loss = 5.6524e-04, PNorm = 78.0078, GNorm = 0.3102, lr_0 = 1.0000e-04
Validation rmse = 0.923840
Model 0 best validation rmse = 0.922104 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.752020
Ensemble test rmse = 0.752020
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 1.5681e-02, PNorm = 75.7839, GNorm = 2.7702, lr_0 = 2.9800e-04
Loss = 1.0953e-02, PNorm = 75.8381, GNorm = 3.8422, lr_0 = 4.7800e-04
Validation rmse = 1.300758
Epoch 1
Loss = 9.0399e-03, PNorm = 75.9305, GNorm = 3.5541, lr_0 = 6.7600e-04
Loss = 8.5297e-03, PNorm = 76.0368, GNorm = 4.8235, lr_0 = 8.5600e-04
Loss = 6.2227e-03, PNorm = 76.1626, GNorm = 1.0130, lr_0 = 9.9344e-04
Validation rmse = 1.654987
Epoch 2
Loss = 6.3802e-03, PNorm = 76.2886, GNorm = 3.3133, lr_0 = 9.6130e-04
Loss = 5.9280e-03, PNorm = 76.3937, GNorm = 6.0222, lr_0 = 9.3019e-04
Validation rmse = 1.162245
Epoch 3
Loss = 4.4018e-03, PNorm = 76.4953, GNorm = 3.6005, lr_0 = 9.0009e-04
Loss = 3.8771e-03, PNorm = 76.5765, GNorm = 1.5884, lr_0 = 8.7096e-04
Loss = 4.3147e-03, PNorm = 76.6511, GNorm = 6.9617, lr_0 = 8.4278e-04
Validation rmse = 1.056633
Epoch 4
Loss = 4.0000e-03, PNorm = 76.7131, GNorm = 2.9410, lr_0 = 8.1551e-04
Loss = 3.4204e-03, PNorm = 76.7700, GNorm = 2.8409, lr_0 = 7.8912e-04
Validation rmse = 0.919412
Epoch 5
Loss = 2.7994e-03, PNorm = 76.8238, GNorm = 2.3208, lr_0 = 7.6358e-04
Loss = 3.0390e-03, PNorm = 76.8831, GNorm = 5.6798, lr_0 = 7.3888e-04
Loss = 2.9683e-03, PNorm = 76.9313, GNorm = 0.7654, lr_0 = 7.1497e-04
Validation rmse = 0.847467
Epoch 6
Loss = 2.4546e-03, PNorm = 76.9746, GNorm = 1.8490, lr_0 = 6.8956e-04
Loss = 2.7656e-03, PNorm = 77.0151, GNorm = 5.0108, lr_0 = 6.6725e-04
Loss = 2.9573e-03, PNorm = 77.0587, GNorm = 4.9065, lr_0 = 6.4565e-04
Validation rmse = 0.911755
Epoch 7
Loss = 3.0711e-03, PNorm = 77.1112, GNorm = 2.1031, lr_0 = 6.2476e-04
Loss = 2.1980e-03, PNorm = 77.1504, GNorm = 0.6517, lr_0 = 6.0454e-04
Validation rmse = 0.812524
Epoch 8
Loss = 1.2582e-03, PNorm = 77.1833, GNorm = 1.2804, lr_0 = 5.8498e-04
Loss = 1.7972e-03, PNorm = 77.2129, GNorm = 3.0843, lr_0 = 5.6605e-04
Loss = 1.6846e-03, PNorm = 77.2459, GNorm = 1.4032, lr_0 = 5.4774e-04
Validation rmse = 0.836338
Epoch 9
Loss = 1.5470e-03, PNorm = 77.2790, GNorm = 0.7251, lr_0 = 5.3001e-04
Loss = 1.9844e-03, PNorm = 77.3066, GNorm = 1.0281, lr_0 = 5.1286e-04
Validation rmse = 0.877995
Epoch 10
Loss = 2.0730e-03, PNorm = 77.3351, GNorm = 3.1003, lr_0 = 4.9627e-04
Loss = 1.4017e-03, PNorm = 77.3665, GNorm = 1.0062, lr_0 = 4.8021e-04
Loss = 1.5712e-03, PNorm = 77.3895, GNorm = 1.4156, lr_0 = 4.6467e-04
Validation rmse = 0.827503
Epoch 11
Loss = 1.4264e-03, PNorm = 77.4093, GNorm = 0.6921, lr_0 = 4.4963e-04
Loss = 1.1663e-03, PNorm = 77.4291, GNorm = 0.4236, lr_0 = 4.3508e-04
Validation rmse = 0.750808
Epoch 12
Loss = 1.2916e-03, PNorm = 77.4502, GNorm = 1.4928, lr_0 = 4.1962e-04
Loss = 1.0777e-03, PNorm = 77.4706, GNorm = 0.7499, lr_0 = 4.0604e-04
Loss = 1.3430e-03, PNorm = 77.4886, GNorm = 0.8939, lr_0 = 3.9290e-04
Validation rmse = 0.776085
Epoch 13
Loss = 1.3321e-03, PNorm = 77.5073, GNorm = 1.1279, lr_0 = 3.8019e-04
Loss = 1.0443e-03, PNorm = 77.5272, GNorm = 0.5937, lr_0 = 3.6789e-04
Loss = 1.2740e-03, PNorm = 77.5466, GNorm = 1.4956, lr_0 = 3.5598e-04
Validation rmse = 0.743735
Epoch 14
Loss = 9.3407e-04, PNorm = 77.5650, GNorm = 0.6877, lr_0 = 3.4446e-04
Loss = 1.1869e-03, PNorm = 77.5880, GNorm = 1.1746, lr_0 = 3.3332e-04
Validation rmse = 0.765236
Epoch 15
Loss = 5.2481e-04, PNorm = 77.6066, GNorm = 0.6279, lr_0 = 3.2253e-04
Loss = 1.0765e-03, PNorm = 77.6242, GNorm = 1.5363, lr_0 = 3.1209e-04
Loss = 1.0103e-03, PNorm = 77.6444, GNorm = 0.5828, lr_0 = 3.0200e-04
Validation rmse = 0.765146
Epoch 16
Loss = 7.7173e-04, PNorm = 77.6600, GNorm = 1.1428, lr_0 = 2.9222e-04
Loss = 9.5182e-04, PNorm = 77.6733, GNorm = 1.1933, lr_0 = 2.8277e-04
Validation rmse = 0.813291
Epoch 17
Loss = 7.9236e-04, PNorm = 77.6909, GNorm = 0.8552, lr_0 = 2.7272e-04
Loss = 7.4487e-04, PNorm = 77.7051, GNorm = 0.5618, lr_0 = 2.6389e-04
Loss = 9.4749e-04, PNorm = 77.7194, GNorm = 1.8354, lr_0 = 2.5535e-04
Validation rmse = 0.765154
Epoch 18
Loss = 8.2271e-04, PNorm = 77.7354, GNorm = 0.7297, lr_0 = 2.4709e-04
Loss = 7.7844e-04, PNorm = 77.7463, GNorm = 0.4184, lr_0 = 2.3910e-04
Loss = 8.1990e-04, PNorm = 77.7604, GNorm = 1.2688, lr_0 = 2.3136e-04
Validation rmse = 0.778858
Epoch 19
Loss = 8.0094e-04, PNorm = 77.7733, GNorm = 2.4525, lr_0 = 2.2387e-04
Loss = 7.8270e-04, PNorm = 77.7854, GNorm = 0.7241, lr_0 = 2.1663e-04
Validation rmse = 0.753629
Epoch 20
Loss = 9.4081e-04, PNorm = 77.7977, GNorm = 0.7235, lr_0 = 2.0962e-04
Loss = 7.2190e-04, PNorm = 77.8099, GNorm = 1.8426, lr_0 = 2.0283e-04
Loss = 7.0036e-04, PNorm = 77.8217, GNorm = 0.4954, lr_0 = 1.9627e-04
Validation rmse = 0.731104
Epoch 21
Loss = 6.8737e-04, PNorm = 77.8325, GNorm = 1.7705, lr_0 = 1.8992e-04
Loss = 6.5737e-04, PNorm = 77.8432, GNorm = 0.5254, lr_0 = 1.8377e-04
Validation rmse = 0.744026
Epoch 22
Loss = 5.8223e-04, PNorm = 77.8515, GNorm = 0.3309, lr_0 = 1.7783e-04
Loss = 5.7769e-04, PNorm = 77.8615, GNorm = 0.8495, lr_0 = 1.7207e-04
Loss = 6.3713e-04, PNorm = 77.8720, GNorm = 0.5316, lr_0 = 1.6651e-04
Validation rmse = 0.753631
Epoch 23
Loss = 4.6745e-04, PNorm = 77.8822, GNorm = 0.4636, lr_0 = 1.6059e-04
Loss = 5.9673e-04, PNorm = 77.8902, GNorm = 0.3221, lr_0 = 1.5539e-04
Validation rmse = 0.749823
Epoch 24
Loss = 3.0316e-04, PNorm = 77.8981, GNorm = 0.2723, lr_0 = 1.5036e-04
Loss = 5.5427e-04, PNorm = 77.9061, GNorm = 0.6088, lr_0 = 1.4550e-04
Loss = 5.6722e-04, PNorm = 77.9158, GNorm = 0.7490, lr_0 = 1.4079e-04
Validation rmse = 0.733855
Epoch 25
Loss = 4.5440e-04, PNorm = 77.9249, GNorm = 0.3674, lr_0 = 1.3623e-04
Loss = 5.5155e-04, PNorm = 77.9326, GNorm = 0.4297, lr_0 = 1.3183e-04
Loss = 5.8101e-04, PNorm = 77.9415, GNorm = 0.4506, lr_0 = 1.2756e-04
Validation rmse = 0.729347
Epoch 26
Loss = 4.0119e-04, PNorm = 77.9493, GNorm = 0.3100, lr_0 = 1.2343e-04
Loss = 4.9581e-04, PNorm = 77.9567, GNorm = 0.5109, lr_0 = 1.1944e-04
Validation rmse = 0.730748
Epoch 27
Loss = 4.4483e-04, PNorm = 77.9637, GNorm = 1.3980, lr_0 = 1.1557e-04
Loss = 5.8980e-04, PNorm = 77.9703, GNorm = 0.3053, lr_0 = 1.1183e-04
Loss = 5.6789e-04, PNorm = 77.9771, GNorm = 0.6821, lr_0 = 1.0821e-04
Validation rmse = 0.716827
Epoch 28
Loss = 5.0494e-04, PNorm = 77.9828, GNorm = 0.3723, lr_0 = 1.0437e-04
Loss = 4.6850e-04, PNorm = 77.9892, GNorm = 0.4171, lr_0 = 1.0099e-04
Validation rmse = 0.720497
Epoch 29
Loss = 3.1986e-04, PNorm = 77.9958, GNorm = 0.5035, lr_0 = 1.0000e-04
Loss = 4.9012e-04, PNorm = 78.0025, GNorm = 1.0804, lr_0 = 1.0000e-04
Loss = 5.6965e-04, PNorm = 78.0092, GNorm = 1.4871, lr_0 = 1.0000e-04
Validation rmse = 0.715603
Model 0 best validation rmse = 0.715603 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.707304
Ensemble test rmse = 0.707304
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 2.3349e-02, PNorm = 75.7834, GNorm = 7.5468, lr_0 = 2.9800e-04
Loss = 1.3759e-02, PNorm = 75.8491, GNorm = 2.2462, lr_0 = 4.7800e-04
Validation rmse = 1.847796
Epoch 1
Loss = 1.0606e-02, PNorm = 75.9527, GNorm = 5.2483, lr_0 = 6.7600e-04
Loss = 8.8139e-03, PNorm = 76.0571, GNorm = 2.4218, lr_0 = 8.5600e-04
Loss = 6.7912e-03, PNorm = 76.1540, GNorm = 2.0051, lr_0 = 9.9344e-04
Validation rmse = 1.394384
Epoch 2
Loss = 6.2784e-03, PNorm = 76.2541, GNorm = 3.6372, lr_0 = 9.6130e-04
Loss = 4.9815e-03, PNorm = 76.3407, GNorm = 5.6320, lr_0 = 9.3019e-04
Validation rmse = 1.321677
Epoch 3
Loss = 5.3053e-03, PNorm = 76.4263, GNorm = 3.9702, lr_0 = 9.0009e-04
Loss = 4.8070e-03, PNorm = 76.4976, GNorm = 2.6231, lr_0 = 8.7096e-04
Loss = 4.3285e-03, PNorm = 76.5630, GNorm = 5.4156, lr_0 = 8.4278e-04
Validation rmse = 1.125107
Epoch 4
Loss = 4.5026e-03, PNorm = 76.6181, GNorm = 1.0674, lr_0 = 8.1551e-04
Loss = 4.1224e-03, PNorm = 76.6722, GNorm = 3.6388, lr_0 = 7.8912e-04
Validation rmse = 1.124417
Epoch 5
Loss = 2.0640e-03, PNorm = 76.7174, GNorm = 1.7986, lr_0 = 7.6358e-04
Loss = 2.7548e-03, PNorm = 76.7604, GNorm = 1.0109, lr_0 = 7.3888e-04
Loss = 3.6488e-03, PNorm = 76.8012, GNorm = 0.7001, lr_0 = 7.1497e-04
Validation rmse = 1.104025
Epoch 6
Loss = 2.7984e-03, PNorm = 76.8524, GNorm = 0.8712, lr_0 = 6.8956e-04
Loss = 2.4808e-03, PNorm = 76.8963, GNorm = 1.2233, lr_0 = 6.6725e-04
Loss = 2.4885e-03, PNorm = 76.9241, GNorm = 1.9834, lr_0 = 6.4565e-04
Validation rmse = 0.943339
Epoch 7
Loss = 2.1224e-03, PNorm = 76.9605, GNorm = 0.7042, lr_0 = 6.2476e-04
Loss = 2.0601e-03, PNorm = 76.9908, GNorm = 1.5521, lr_0 = 6.0454e-04
Validation rmse = 0.944691
Epoch 8
Loss = 1.8483e-03, PNorm = 77.0217, GNorm = 2.1713, lr_0 = 5.8498e-04
Loss = 1.9585e-03, PNorm = 77.0533, GNorm = 0.9191, lr_0 = 5.6605e-04
Loss = 1.6151e-03, PNorm = 77.0783, GNorm = 1.0245, lr_0 = 5.4774e-04
Validation rmse = 0.961750
Epoch 9
Loss = 1.6113e-03, PNorm = 77.1011, GNorm = 0.8038, lr_0 = 5.3001e-04
Loss = 1.6191e-03, PNorm = 77.1324, GNorm = 1.4596, lr_0 = 5.1286e-04
Validation rmse = 0.914776
Epoch 10
Loss = 1.7349e-03, PNorm = 77.1566, GNorm = 3.1748, lr_0 = 4.9627e-04
Loss = 2.7285e-03, PNorm = 77.1840, GNorm = 4.2980, lr_0 = 4.8021e-04
Loss = 2.3829e-03, PNorm = 77.2156, GNorm = 2.6401, lr_0 = 4.6467e-04
Validation rmse = 0.944141
Epoch 11
Loss = 2.0761e-03, PNorm = 77.2463, GNorm = 1.2324, lr_0 = 4.4963e-04
Loss = 1.7497e-03, PNorm = 77.2763, GNorm = 2.2934, lr_0 = 4.3508e-04
Validation rmse = 0.902512
Epoch 12
Loss = 1.6308e-03, PNorm = 77.3047, GNorm = 1.0080, lr_0 = 4.1962e-04
Loss = 1.4392e-03, PNorm = 77.3249, GNorm = 2.5039, lr_0 = 4.0604e-04
Loss = 1.4828e-03, PNorm = 77.3482, GNorm = 2.1580, lr_0 = 3.9290e-04
Validation rmse = 0.897043
Epoch 13
Loss = 1.5115e-03, PNorm = 77.3701, GNorm = 1.4446, lr_0 = 3.8019e-04
Loss = 1.3800e-03, PNorm = 77.3898, GNorm = 1.8591, lr_0 = 3.6789e-04
Loss = 1.3098e-03, PNorm = 77.4100, GNorm = 0.4916, lr_0 = 3.5598e-04
Validation rmse = 0.866445
Epoch 14
Loss = 9.7732e-04, PNorm = 77.4286, GNorm = 0.4569, lr_0 = 3.4446e-04
Loss = 1.2333e-03, PNorm = 77.4478, GNorm = 0.5672, lr_0 = 3.3332e-04
Validation rmse = 0.876357
Epoch 15
Loss = 1.3367e-03, PNorm = 77.4640, GNorm = 1.4467, lr_0 = 3.2253e-04
Loss = 1.2305e-03, PNorm = 77.4841, GNorm = 1.6590, lr_0 = 3.1209e-04
Loss = 1.1545e-03, PNorm = 77.5018, GNorm = 0.7930, lr_0 = 3.0200e-04
Validation rmse = 0.922755
Epoch 16
Loss = 1.0510e-03, PNorm = 77.5148, GNorm = 0.7954, lr_0 = 2.9222e-04
Loss = 1.0509e-03, PNorm = 77.5317, GNorm = 0.7345, lr_0 = 2.8277e-04
Validation rmse = 0.932172
Epoch 17
Loss = 6.6814e-04, PNorm = 77.5511, GNorm = 1.1846, lr_0 = 2.7272e-04
Loss = 1.0808e-03, PNorm = 77.5693, GNorm = 0.6163, lr_0 = 2.6389e-04
Loss = 1.0086e-03, PNorm = 77.5867, GNorm = 1.2344, lr_0 = 2.5535e-04
Validation rmse = 0.881106
Epoch 18
Loss = 8.2287e-04, PNorm = 77.6011, GNorm = 1.5781, lr_0 = 2.4709e-04
Loss = 1.0820e-03, PNorm = 77.6133, GNorm = 0.6558, lr_0 = 2.3910e-04
Loss = 1.2365e-03, PNorm = 77.6283, GNorm = 0.8879, lr_0 = 2.3136e-04
Validation rmse = 0.884533
Epoch 19
Loss = 9.8697e-04, PNorm = 77.6452, GNorm = 0.7391, lr_0 = 2.2387e-04
Loss = 8.3888e-04, PNorm = 77.6605, GNorm = 1.1404, lr_0 = 2.1663e-04
Validation rmse = 0.894475
Epoch 20
Loss = 8.2155e-04, PNorm = 77.6719, GNorm = 0.5403, lr_0 = 2.0962e-04
Loss = 8.1845e-04, PNorm = 77.6867, GNorm = 0.6632, lr_0 = 2.0283e-04
Loss = 9.4853e-04, PNorm = 77.7000, GNorm = 1.5226, lr_0 = 1.9627e-04
Validation rmse = 0.897541
Epoch 21
Loss = 7.2555e-04, PNorm = 77.7112, GNorm = 0.3401, lr_0 = 1.8992e-04
Loss = 8.2738e-04, PNorm = 77.7241, GNorm = 0.5657, lr_0 = 1.8377e-04
Validation rmse = 0.890273
Epoch 22
Loss = 6.5369e-04, PNorm = 77.7364, GNorm = 0.8269, lr_0 = 1.7783e-04
Loss = 6.6128e-04, PNorm = 77.7483, GNorm = 0.7223, lr_0 = 1.7207e-04
Loss = 7.7926e-04, PNorm = 77.7591, GNorm = 0.9967, lr_0 = 1.6651e-04
Validation rmse = 0.892094
Epoch 23
Loss = 6.7087e-04, PNorm = 77.7715, GNorm = 0.6074, lr_0 = 1.6059e-04
Loss = 7.3915e-04, PNorm = 77.7833, GNorm = 0.9089, lr_0 = 1.5539e-04
Validation rmse = 0.876811
Epoch 24
Loss = 4.6363e-04, PNorm = 77.7955, GNorm = 0.5255, lr_0 = 1.5036e-04
Loss = 7.5860e-04, PNorm = 77.8069, GNorm = 0.5160, lr_0 = 1.4550e-04
Loss = 5.9198e-04, PNorm = 77.8164, GNorm = 0.5971, lr_0 = 1.4079e-04
Validation rmse = 0.885076
Epoch 25
Loss = 5.4752e-04, PNorm = 77.8243, GNorm = 0.8894, lr_0 = 1.3623e-04
Loss = 6.7730e-04, PNorm = 77.8326, GNorm = 0.7249, lr_0 = 1.3183e-04
Loss = 6.2582e-04, PNorm = 77.8412, GNorm = 0.6951, lr_0 = 1.2756e-04
Validation rmse = 0.910229
Epoch 26
Loss = 6.4818e-04, PNorm = 77.8488, GNorm = 0.8937, lr_0 = 1.2343e-04
Loss = 5.9825e-04, PNorm = 77.8574, GNorm = 0.8042, lr_0 = 1.1944e-04
Validation rmse = 0.900097
Epoch 27
Loss = 7.3248e-04, PNorm = 77.8648, GNorm = 1.6212, lr_0 = 1.1557e-04
Loss = 5.5642e-04, PNorm = 77.8725, GNorm = 0.8323, lr_0 = 1.1183e-04
Loss = 6.4101e-04, PNorm = 77.8803, GNorm = 0.4749, lr_0 = 1.0821e-04
Validation rmse = 0.884569
Epoch 28
Loss = 6.2502e-04, PNorm = 77.8896, GNorm = 1.4179, lr_0 = 1.0437e-04
Loss = 5.2919e-04, PNorm = 77.8972, GNorm = 0.4083, lr_0 = 1.0099e-04
Validation rmse = 0.890666
Epoch 29
Loss = 3.3038e-04, PNorm = 77.9034, GNorm = 0.2479, lr_0 = 1.0000e-04
Loss = 5.5152e-04, PNorm = 77.9098, GNorm = 0.4998, lr_0 = 1.0000e-04
Loss = 5.9878e-04, PNorm = 77.9161, GNorm = 1.2104, lr_0 = 1.0000e-04
Validation rmse = 0.924773
Model 0 best validation rmse = 0.866445 on epoch 13
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.697140
Ensemble test rmse = 0.697140
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 1.9870e-02, PNorm = 75.7844, GNorm = 3.2316, lr_0 = 2.9800e-04
Loss = 1.2819e-02, PNorm = 75.8447, GNorm = 2.7859, lr_0 = 4.7800e-04
Validation rmse = 1.495126
Epoch 1
Loss = 8.6717e-03, PNorm = 75.9374, GNorm = 6.0541, lr_0 = 6.7600e-04
Loss = 7.4490e-03, PNorm = 76.0311, GNorm = 4.0641, lr_0 = 8.5600e-04
Loss = 7.0450e-03, PNorm = 76.1415, GNorm = 3.9551, lr_0 = 9.9344e-04
Validation rmse = 1.484081
Epoch 2
Loss = 5.3262e-03, PNorm = 76.2472, GNorm = 3.2052, lr_0 = 9.6130e-04
Loss = 4.8680e-03, PNorm = 76.3471, GNorm = 3.6298, lr_0 = 9.3019e-04
Validation rmse = 1.092536
Epoch 3
Loss = 3.8137e-03, PNorm = 76.4248, GNorm = 3.1522, lr_0 = 9.0009e-04
Loss = 4.8410e-03, PNorm = 76.4879, GNorm = 5.2843, lr_0 = 8.7096e-04
Loss = 3.7812e-03, PNorm = 76.5497, GNorm = 1.9150, lr_0 = 8.4278e-04
Validation rmse = 1.032870
Epoch 4
Loss = 3.2277e-03, PNorm = 76.5985, GNorm = 1.0576, lr_0 = 8.1551e-04
Loss = 3.3565e-03, PNorm = 76.6418, GNorm = 1.5734, lr_0 = 7.8912e-04
Validation rmse = 0.962974
Epoch 5
Loss = 2.6877e-03, PNorm = 76.6876, GNorm = 0.8643, lr_0 = 7.6358e-04
Loss = 3.2825e-03, PNorm = 76.7315, GNorm = 2.0658, lr_0 = 7.3888e-04
Loss = 2.3173e-03, PNorm = 76.7692, GNorm = 0.8912, lr_0 = 7.1497e-04
Validation rmse = 0.914283
Epoch 6
Loss = 2.3615e-03, PNorm = 76.8178, GNorm = 1.3550, lr_0 = 6.8956e-04
Loss = 2.7629e-03, PNorm = 76.8580, GNorm = 0.5997, lr_0 = 6.6725e-04
Loss = 2.0661e-03, PNorm = 76.8903, GNorm = 3.4750, lr_0 = 6.4565e-04
Validation rmse = 0.943213
Epoch 7
Loss = 2.0422e-03, PNorm = 76.9248, GNorm = 1.3236, lr_0 = 6.2476e-04
Loss = 1.8649e-03, PNorm = 76.9543, GNorm = 1.3130, lr_0 = 6.0454e-04
Validation rmse = 0.833661
Epoch 8
Loss = 2.2485e-03, PNorm = 76.9883, GNorm = 1.1157, lr_0 = 5.8498e-04
Loss = 1.9607e-03, PNorm = 77.0255, GNorm = 0.7092, lr_0 = 5.6605e-04
Loss = 1.7690e-03, PNorm = 77.0551, GNorm = 0.9145, lr_0 = 5.4774e-04
Validation rmse = 0.785163
Epoch 9
Loss = 1.4067e-03, PNorm = 77.0823, GNorm = 0.3865, lr_0 = 5.3001e-04
Loss = 1.7693e-03, PNorm = 77.1116, GNorm = 2.9192, lr_0 = 5.1286e-04
Validation rmse = 0.872797
Epoch 10
Loss = 1.5058e-03, PNorm = 77.1442, GNorm = 0.7480, lr_0 = 4.9627e-04
Loss = 1.5304e-03, PNorm = 77.1729, GNorm = 0.9005, lr_0 = 4.8021e-04
Loss = 1.5002e-03, PNorm = 77.1989, GNorm = 0.6518, lr_0 = 4.6467e-04
Validation rmse = 0.812760
Epoch 11
Loss = 1.3035e-03, PNorm = 77.2278, GNorm = 0.6355, lr_0 = 4.4963e-04
Loss = 1.5447e-03, PNorm = 77.2574, GNorm = 1.7577, lr_0 = 4.3508e-04
Validation rmse = 0.778771
Epoch 12
Loss = 6.8912e-04, PNorm = 77.2851, GNorm = 0.6145, lr_0 = 4.1962e-04
Loss = 1.2789e-03, PNorm = 77.3069, GNorm = 1.7001, lr_0 = 4.0604e-04
Loss = 1.0992e-03, PNorm = 77.3245, GNorm = 1.1909, lr_0 = 3.9290e-04
Validation rmse = 0.763284
Epoch 13
Loss = 1.2622e-03, PNorm = 77.3436, GNorm = 2.2535, lr_0 = 3.8019e-04
Loss = 1.0575e-03, PNorm = 77.3709, GNorm = 0.6658, lr_0 = 3.6789e-04
Loss = 1.4389e-03, PNorm = 77.3898, GNorm = 2.0462, lr_0 = 3.5598e-04
Validation rmse = 0.706003
Epoch 14
Loss = 1.3987e-03, PNorm = 77.4141, GNorm = 2.4415, lr_0 = 3.4446e-04
Loss = 1.1273e-03, PNorm = 77.4386, GNorm = 0.9907, lr_0 = 3.3332e-04
Validation rmse = 0.895758
Epoch 15
Loss = 1.8121e-03, PNorm = 77.4622, GNorm = 1.0962, lr_0 = 3.2253e-04
Loss = 1.2414e-03, PNorm = 77.4847, GNorm = 1.1697, lr_0 = 3.1209e-04
Loss = 9.3714e-04, PNorm = 77.5022, GNorm = 0.8139, lr_0 = 3.0200e-04
Validation rmse = 0.774749
Epoch 16
Loss = 9.2010e-04, PNorm = 77.5182, GNorm = 0.7057, lr_0 = 2.9222e-04
Loss = 8.9892e-04, PNorm = 77.5317, GNorm = 0.9188, lr_0 = 2.8277e-04
Validation rmse = 0.715536
Epoch 17
Loss = 9.7205e-04, PNorm = 77.5499, GNorm = 1.2748, lr_0 = 2.7272e-04
Loss = 9.3298e-04, PNorm = 77.5641, GNorm = 0.4782, lr_0 = 2.6389e-04
Loss = 8.5334e-04, PNorm = 77.5785, GNorm = 0.8984, lr_0 = 2.5535e-04
Validation rmse = 0.698475
Epoch 18
Loss = 9.8005e-04, PNorm = 77.5943, GNorm = 0.7813, lr_0 = 2.4709e-04
Loss = 9.6672e-04, PNorm = 77.6088, GNorm = 1.4923, lr_0 = 2.3910e-04
Loss = 7.9597e-04, PNorm = 77.6183, GNorm = 0.5355, lr_0 = 2.3136e-04
Validation rmse = 0.680488
Epoch 19
Loss = 9.0099e-04, PNorm = 77.6301, GNorm = 0.8194, lr_0 = 2.2387e-04
Loss = 7.8642e-04, PNorm = 77.6423, GNorm = 0.5547, lr_0 = 2.1663e-04
Validation rmse = 0.662157
Epoch 20
Loss = 5.4458e-04, PNorm = 77.6563, GNorm = 0.6922, lr_0 = 2.0962e-04
Loss = 9.0783e-04, PNorm = 77.6676, GNorm = 1.6505, lr_0 = 2.0283e-04
Loss = 7.4534e-04, PNorm = 77.6784, GNorm = 0.4616, lr_0 = 1.9627e-04
Validation rmse = 0.659547
Epoch 21
Loss = 6.6971e-04, PNorm = 77.6894, GNorm = 0.4682, lr_0 = 1.8992e-04
Loss = 7.4076e-04, PNorm = 77.7019, GNorm = 0.4791, lr_0 = 1.8377e-04
Validation rmse = 0.674588
Epoch 22
Loss = 5.3293e-04, PNorm = 77.7126, GNorm = 0.5832, lr_0 = 1.7783e-04
Loss = 5.4047e-04, PNorm = 77.7211, GNorm = 0.6503, lr_0 = 1.7207e-04
Loss = 7.2030e-04, PNorm = 77.7310, GNorm = 0.3399, lr_0 = 1.6651e-04
Validation rmse = 0.670657
Epoch 23
Loss = 7.1459e-04, PNorm = 77.7424, GNorm = 0.4719, lr_0 = 1.6059e-04
Loss = 6.5382e-04, PNorm = 77.7524, GNorm = 1.1458, lr_0 = 1.5539e-04
Validation rmse = 0.707632
Epoch 24
Loss = 8.8459e-04, PNorm = 77.7617, GNorm = 1.8586, lr_0 = 1.5036e-04
Loss = 6.9864e-04, PNorm = 77.7693, GNorm = 1.5294, lr_0 = 1.4550e-04
Loss = 7.5068e-04, PNorm = 77.7787, GNorm = 1.8798, lr_0 = 1.4079e-04
Validation rmse = 0.680234
Epoch 25
Loss = 5.6263e-04, PNorm = 77.7875, GNorm = 0.9104, lr_0 = 1.3623e-04
Loss = 6.2009e-04, PNorm = 77.7937, GNorm = 1.2822, lr_0 = 1.3183e-04
Loss = 6.3045e-04, PNorm = 77.8011, GNorm = 1.2563, lr_0 = 1.2756e-04
Validation rmse = 0.658083
Epoch 26
Loss = 6.4326e-04, PNorm = 77.8107, GNorm = 0.6959, lr_0 = 1.2343e-04
Loss = 5.4159e-04, PNorm = 77.8173, GNorm = 0.8968, lr_0 = 1.1944e-04
Validation rmse = 0.663516
Epoch 27
Loss = 7.2487e-04, PNorm = 77.8248, GNorm = 1.7538, lr_0 = 1.1557e-04
Loss = 5.5752e-04, PNorm = 77.8318, GNorm = 0.6478, lr_0 = 1.1183e-04
Loss = 5.2101e-04, PNorm = 77.8377, GNorm = 0.7704, lr_0 = 1.0821e-04
Validation rmse = 0.662031
Epoch 28
Loss = 5.8643e-04, PNorm = 77.8453, GNorm = 1.4522, lr_0 = 1.0437e-04
Loss = 5.2526e-04, PNorm = 77.8506, GNorm = 0.5389, lr_0 = 1.0099e-04
Validation rmse = 0.649040
Epoch 29
Loss = 5.1223e-04, PNorm = 77.8568, GNorm = 0.9924, lr_0 = 1.0000e-04
Loss = 4.7906e-04, PNorm = 77.8626, GNorm = 0.6200, lr_0 = 1.0000e-04
Loss = 4.9955e-04, PNorm = 77.8677, GNorm = 0.9211, lr_0 = 1.0000e-04
Validation rmse = 0.636512
Model 0 best validation rmse = 0.636512 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.709886
Ensemble test rmse = 0.709886
10-fold cross validation
	Seed 0 ==> test rmse = 0.757741
	Seed 1 ==> test rmse = 0.606592
	Seed 2 ==> test rmse = 0.637968
	Seed 3 ==> test rmse = 0.866818
	Seed 4 ==> test rmse = 1.030011
	Seed 5 ==> test rmse = 0.672819
	Seed 6 ==> test rmse = 0.752020
	Seed 7 ==> test rmse = 0.707304
	Seed 8 ==> test rmse = 0.697140
	Seed 9 ==> test rmse = 0.709886
Overall test rmse = 0.743830 +/- 0.117063
Elapsed time = 0:10:31
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.4675e-02, PNorm = 46.0261, GNorm = 16.3336, lr_0 = 2.9800e-04
Loss = 1.2820e-02, PNorm = 46.0488, GNorm = 6.0382, lr_0 = 4.7800e-04
Validation rmse = 1.485666
Epoch 1
Loss = 6.9008e-03, PNorm = 46.0952, GNorm = 3.8002, lr_0 = 6.7600e-04
Loss = 7.3880e-03, PNorm = 46.1410, GNorm = 1.5269, lr_0 = 8.5600e-04
Loss = 6.3303e-03, PNorm = 46.1964, GNorm = 0.9288, lr_0 = 9.9344e-04
Validation rmse = 1.184097
Epoch 2
Loss = 6.5032e-03, PNorm = 46.2556, GNorm = 3.4702, lr_0 = 9.6130e-04
Loss = 5.3720e-03, PNorm = 46.3157, GNorm = 5.4733, lr_0 = 9.3019e-04
Validation rmse = 1.161319
Epoch 3
Loss = 5.0474e-03, PNorm = 46.3675, GNorm = 4.6816, lr_0 = 9.0009e-04
Loss = 4.6101e-03, PNorm = 46.4227, GNorm = 0.8936, lr_0 = 8.7096e-04
Loss = 5.0596e-03, PNorm = 46.4799, GNorm = 1.4482, lr_0 = 8.4278e-04
Validation rmse = 1.074079
Epoch 4
Loss = 3.6809e-03, PNorm = 46.5270, GNorm = 0.7476, lr_0 = 8.1551e-04
Loss = 3.6949e-03, PNorm = 46.5619, GNorm = 2.4311, lr_0 = 7.8912e-04
Validation rmse = 1.227840
Epoch 5
Loss = 4.2338e-03, PNorm = 46.5959, GNorm = 5.3459, lr_0 = 7.6358e-04
Loss = 3.8416e-03, PNorm = 46.6410, GNorm = 1.4153, lr_0 = 7.3888e-04
Loss = 3.5792e-03, PNorm = 46.6749, GNorm = 1.4395, lr_0 = 7.1497e-04
Validation rmse = 1.065364
Epoch 6
Loss = 2.5484e-03, PNorm = 46.7117, GNorm = 0.6881, lr_0 = 6.8956e-04
Loss = 2.5988e-03, PNorm = 46.7402, GNorm = 2.8104, lr_0 = 6.6725e-04
Loss = 2.4780e-03, PNorm = 46.7651, GNorm = 1.8275, lr_0 = 6.4565e-04
Validation rmse = 0.923696
Epoch 7
Loss = 1.9785e-03, PNorm = 46.7915, GNorm = 1.7345, lr_0 = 6.2476e-04
Loss = 2.9934e-03, PNorm = 46.8202, GNorm = 3.6221, lr_0 = 6.0454e-04
Validation rmse = 0.924736
Epoch 8
Loss = 1.9292e-03, PNorm = 46.8484, GNorm = 0.7163, lr_0 = 5.8498e-04
Loss = 2.6691e-03, PNorm = 46.8694, GNorm = 4.2588, lr_0 = 5.6605e-04
Loss = 2.2741e-03, PNorm = 46.8980, GNorm = 1.2783, lr_0 = 5.4774e-04
Validation rmse = 0.927410
Epoch 9
Loss = 1.6915e-03, PNorm = 46.9257, GNorm = 0.9759, lr_0 = 5.3001e-04
Loss = 1.9497e-03, PNorm = 46.9455, GNorm = 4.1100, lr_0 = 5.1286e-04
Validation rmse = 0.882403
Epoch 10
Loss = 1.6783e-03, PNorm = 46.9653, GNorm = 0.6654, lr_0 = 4.9627e-04
Loss = 1.8570e-03, PNorm = 46.9892, GNorm = 2.2088, lr_0 = 4.8021e-04
Loss = 1.8768e-03, PNorm = 47.0094, GNorm = 1.5989, lr_0 = 4.6467e-04
Validation rmse = 0.878531
Epoch 11
Loss = 1.6666e-03, PNorm = 47.0263, GNorm = 1.2098, lr_0 = 4.4963e-04
Loss = 1.5657e-03, PNorm = 47.0462, GNorm = 0.3191, lr_0 = 4.3508e-04
Validation rmse = 0.884713
Epoch 12
Loss = 1.5599e-03, PNorm = 47.0690, GNorm = 0.4808, lr_0 = 4.1962e-04
Loss = 1.5443e-03, PNorm = 47.0874, GNorm = 1.0943, lr_0 = 4.0604e-04
Loss = 1.6276e-03, PNorm = 47.1056, GNorm = 2.8972, lr_0 = 3.9290e-04
Validation rmse = 0.859924
Epoch 13
Loss = 1.4479e-03, PNorm = 47.1215, GNorm = 1.1680, lr_0 = 3.8019e-04
Loss = 1.7008e-03, PNorm = 47.1378, GNorm = 1.9507, lr_0 = 3.6789e-04
Loss = 1.5617e-03, PNorm = 47.1549, GNorm = 2.0378, lr_0 = 3.5598e-04
Validation rmse = 0.901662
Epoch 14
Loss = 1.4310e-03, PNorm = 47.1703, GNorm = 1.5553, lr_0 = 3.4446e-04
Loss = 1.2409e-03, PNorm = 47.1868, GNorm = 1.5956, lr_0 = 3.3332e-04
Validation rmse = 0.862250
Epoch 15
Loss = 1.1953e-03, PNorm = 47.2004, GNorm = 1.5706, lr_0 = 3.2253e-04
Loss = 1.5319e-03, PNorm = 47.2151, GNorm = 0.5934, lr_0 = 3.1209e-04
Loss = 1.3842e-03, PNorm = 47.2325, GNorm = 1.8658, lr_0 = 3.0200e-04
Validation rmse = 0.845073
Epoch 16
Loss = 1.3624e-03, PNorm = 47.2471, GNorm = 1.2947, lr_0 = 2.9222e-04
Loss = 1.3115e-03, PNorm = 47.2606, GNorm = 3.1157, lr_0 = 2.8277e-04
Validation rmse = 0.837631
Epoch 17
Loss = 1.2096e-03, PNorm = 47.2723, GNorm = 0.7818, lr_0 = 2.7272e-04
Loss = 1.1270e-03, PNorm = 47.2850, GNorm = 2.3774, lr_0 = 2.6389e-04
Loss = 1.2706e-03, PNorm = 47.2981, GNorm = 0.4834, lr_0 = 2.5535e-04
Validation rmse = 0.848234
Epoch 18
Loss = 1.2589e-03, PNorm = 47.3097, GNorm = 1.1342, lr_0 = 2.4709e-04
Loss = 1.0595e-03, PNorm = 47.3203, GNorm = 1.3217, lr_0 = 2.3910e-04
Loss = 1.0913e-03, PNorm = 47.3312, GNorm = 0.5937, lr_0 = 2.3136e-04
Validation rmse = 0.820719
Epoch 19
Loss = 1.1018e-03, PNorm = 47.3426, GNorm = 0.4425, lr_0 = 2.2387e-04
Loss = 1.2249e-03, PNorm = 47.3533, GNorm = 2.5597, lr_0 = 2.1663e-04
Validation rmse = 0.854129
Epoch 20
Loss = 8.9463e-04, PNorm = 47.3631, GNorm = 1.8132, lr_0 = 2.0962e-04
Loss = 1.1171e-03, PNorm = 47.3721, GNorm = 0.4947, lr_0 = 2.0283e-04
Loss = 1.0206e-03, PNorm = 47.3811, GNorm = 0.5921, lr_0 = 1.9627e-04
Validation rmse = 0.837549
Epoch 21
Loss = 9.5884e-04, PNorm = 47.3911, GNorm = 1.6042, lr_0 = 1.8992e-04
Loss = 9.3740e-04, PNorm = 47.3978, GNorm = 0.5840, lr_0 = 1.8377e-04
Validation rmse = 0.821650
Epoch 22
Loss = 1.0483e-03, PNorm = 47.4072, GNorm = 0.9466, lr_0 = 1.7783e-04
Loss = 9.9554e-04, PNorm = 47.4162, GNorm = 1.6166, lr_0 = 1.7207e-04
Loss = 9.7753e-04, PNorm = 47.4240, GNorm = 0.7845, lr_0 = 1.6651e-04
Validation rmse = 0.847549
Epoch 23
Loss = 7.8254e-04, PNorm = 47.4332, GNorm = 0.7100, lr_0 = 1.6059e-04
Loss = 9.1963e-04, PNorm = 47.4408, GNorm = 1.3059, lr_0 = 1.5539e-04
Validation rmse = 0.825262
Epoch 24
Loss = 8.3304e-04, PNorm = 47.4483, GNorm = 1.4831, lr_0 = 1.5036e-04
Loss = 8.3830e-04, PNorm = 47.4547, GNorm = 0.5828, lr_0 = 1.4550e-04
Loss = 8.9086e-04, PNorm = 47.4613, GNorm = 1.1820, lr_0 = 1.4079e-04
Validation rmse = 0.839412
Epoch 25
Loss = 8.0416e-04, PNorm = 47.4672, GNorm = 0.7472, lr_0 = 1.3623e-04
Loss = 9.2662e-04, PNorm = 47.4726, GNorm = 0.9171, lr_0 = 1.3183e-04
Loss = 8.9484e-04, PNorm = 47.4786, GNorm = 0.9659, lr_0 = 1.2756e-04
Validation rmse = 0.835772
Epoch 26
Loss = 7.0995e-04, PNorm = 47.4855, GNorm = 1.0652, lr_0 = 1.2343e-04
Loss = 7.9742e-04, PNorm = 47.4910, GNorm = 0.6829, lr_0 = 1.1944e-04
Validation rmse = 0.820557
Epoch 27
Loss = 7.9746e-04, PNorm = 47.4975, GNorm = 0.6196, lr_0 = 1.1557e-04
Loss = 8.9585e-04, PNorm = 47.5036, GNorm = 1.5875, lr_0 = 1.1183e-04
Loss = 7.6349e-04, PNorm = 47.5086, GNorm = 0.9209, lr_0 = 1.0821e-04
Validation rmse = 0.833208
Epoch 28
Loss = 8.5548e-04, PNorm = 47.5131, GNorm = 0.5805, lr_0 = 1.0437e-04
Loss = 7.5397e-04, PNorm = 47.5177, GNorm = 1.3586, lr_0 = 1.0099e-04
Validation rmse = 0.835071
Epoch 29
Loss = 1.0368e-03, PNorm = 47.5226, GNorm = 1.0488, lr_0 = 1.0000e-04
Loss = 7.5077e-04, PNorm = 47.5271, GNorm = 0.8476, lr_0 = 1.0000e-04
Loss = 9.4584e-04, PNorm = 47.5325, GNorm = 2.9986, lr_0 = 1.0000e-04
Validation rmse = 0.863216
Model 0 best validation rmse = 0.820557 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.768308
Ensemble test rmse = 0.768308
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.6381e-02, PNorm = 46.0265, GNorm = 5.4853, lr_0 = 2.9800e-04
Loss = 1.0270e-02, PNorm = 46.0510, GNorm = 6.9899, lr_0 = 4.7800e-04
Validation rmse = 1.769245
Epoch 1
Loss = 8.5416e-03, PNorm = 46.0869, GNorm = 1.6221, lr_0 = 6.7600e-04
Loss = 9.3951e-03, PNorm = 46.1335, GNorm = 5.3768, lr_0 = 8.5600e-04
Loss = 5.1915e-03, PNorm = 46.1838, GNorm = 1.7847, lr_0 = 9.9344e-04
Validation rmse = 1.268261
Epoch 2
Loss = 5.4321e-03, PNorm = 46.2333, GNorm = 2.5509, lr_0 = 9.6130e-04
Loss = 6.2431e-03, PNorm = 46.2835, GNorm = 3.9583, lr_0 = 9.3019e-04
Validation rmse = 1.256846
Epoch 3
Loss = 6.0160e-03, PNorm = 46.3345, GNorm = 6.4624, lr_0 = 9.0009e-04
Loss = 5.0496e-03, PNorm = 46.3855, GNorm = 3.0366, lr_0 = 8.7096e-04
Loss = 4.2430e-03, PNorm = 46.4349, GNorm = 2.1575, lr_0 = 8.4278e-04
Validation rmse = 1.027976
Epoch 4
Loss = 4.2210e-03, PNorm = 46.4753, GNorm = 3.1065, lr_0 = 8.1551e-04
Loss = 3.1171e-03, PNorm = 46.5178, GNorm = 1.5405, lr_0 = 7.8912e-04
Validation rmse = 0.895676
Epoch 5
Loss = 2.5042e-03, PNorm = 46.5598, GNorm = 1.3745, lr_0 = 7.6358e-04
Loss = 3.4166e-03, PNorm = 46.5968, GNorm = 4.6291, lr_0 = 7.3888e-04
Loss = 2.8568e-03, PNorm = 46.6328, GNorm = 3.3401, lr_0 = 7.1497e-04
Validation rmse = 0.932810
Epoch 6
Loss = 3.3279e-03, PNorm = 46.6693, GNorm = 0.8290, lr_0 = 6.8956e-04
Loss = 2.8566e-03, PNorm = 46.7074, GNorm = 2.9716, lr_0 = 6.6725e-04
Loss = 2.5285e-03, PNorm = 46.7391, GNorm = 1.9790, lr_0 = 6.4565e-04
Validation rmse = 0.853075
Epoch 7
Loss = 2.5668e-03, PNorm = 46.7698, GNorm = 2.8730, lr_0 = 6.2476e-04
Loss = 2.5661e-03, PNorm = 46.7980, GNorm = 4.2735, lr_0 = 6.0454e-04
Validation rmse = 1.022437
Epoch 8
Loss = 3.3071e-03, PNorm = 46.8306, GNorm = 4.0441, lr_0 = 5.8498e-04
Loss = 2.1834e-03, PNorm = 46.8579, GNorm = 1.0803, lr_0 = 5.6605e-04
Loss = 1.8994e-03, PNorm = 46.8849, GNorm = 0.5973, lr_0 = 5.4774e-04
Validation rmse = 0.795297
Epoch 9
Loss = 1.8079e-03, PNorm = 46.9111, GNorm = 1.7169, lr_0 = 5.3001e-04
Loss = 2.0982e-03, PNorm = 46.9432, GNorm = 0.6445, lr_0 = 5.1286e-04
Validation rmse = 0.806603
Epoch 10
Loss = 1.7672e-03, PNorm = 46.9643, GNorm = 2.1224, lr_0 = 4.9627e-04
Loss = 2.5338e-03, PNorm = 46.9892, GNorm = 2.3140, lr_0 = 4.8021e-04
Loss = 2.0779e-03, PNorm = 47.0135, GNorm = 3.3082, lr_0 = 4.6467e-04
Validation rmse = 0.844825
Epoch 11
Loss = 2.0482e-03, PNorm = 47.0383, GNorm = 1.5644, lr_0 = 4.4963e-04
Loss = 1.8388e-03, PNorm = 47.0579, GNorm = 1.3342, lr_0 = 4.3508e-04
Validation rmse = 0.747349
Epoch 12
Loss = 1.8200e-03, PNorm = 47.0810, GNorm = 1.3190, lr_0 = 4.1962e-04
Loss = 1.8807e-03, PNorm = 47.1015, GNorm = 1.9385, lr_0 = 4.0604e-04
Loss = 2.3714e-03, PNorm = 47.1242, GNorm = 1.8699, lr_0 = 3.9290e-04
Validation rmse = 1.035433
Epoch 13
Loss = 1.9684e-03, PNorm = 47.1462, GNorm = 1.5944, lr_0 = 3.8019e-04
Loss = 2.0652e-03, PNorm = 47.1647, GNorm = 2.6182, lr_0 = 3.6789e-04
Loss = 1.9243e-03, PNorm = 47.1822, GNorm = 1.1759, lr_0 = 3.5598e-04
Validation rmse = 0.718708
Epoch 14
Loss = 1.5605e-03, PNorm = 47.2022, GNorm = 0.6512, lr_0 = 3.4446e-04
Loss = 1.3710e-03, PNorm = 47.2162, GNorm = 1.6050, lr_0 = 3.3332e-04
Validation rmse = 0.739149
Epoch 15
Loss = 1.2010e-03, PNorm = 47.2315, GNorm = 1.2754, lr_0 = 3.2253e-04
Loss = 1.5993e-03, PNorm = 47.2472, GNorm = 2.8654, lr_0 = 3.1209e-04
Loss = 1.7307e-03, PNorm = 47.2637, GNorm = 0.8598, lr_0 = 3.0200e-04
Validation rmse = 0.745434
Epoch 16
Loss = 1.8475e-03, PNorm = 47.2797, GNorm = 2.1575, lr_0 = 2.9222e-04
Loss = 1.0257e-03, PNorm = 47.2936, GNorm = 0.7989, lr_0 = 2.8277e-04
Validation rmse = 0.684788
Epoch 17
Loss = 9.9421e-04, PNorm = 47.3059, GNorm = 0.5085, lr_0 = 2.7272e-04
Loss = 1.4231e-03, PNorm = 47.3176, GNorm = 0.7532, lr_0 = 2.6389e-04
Loss = 1.1711e-03, PNorm = 47.3312, GNorm = 1.0674, lr_0 = 2.5535e-04
Validation rmse = 0.686444
Epoch 18
Loss = 1.1901e-03, PNorm = 47.3431, GNorm = 0.9872, lr_0 = 2.4709e-04
Loss = 1.3169e-03, PNorm = 47.3539, GNorm = 0.7763, lr_0 = 2.3910e-04
Loss = 1.2093e-03, PNorm = 47.3652, GNorm = 1.2792, lr_0 = 2.3136e-04
Validation rmse = 0.690240
Epoch 19
Loss = 1.1604e-03, PNorm = 47.3751, GNorm = 1.1873, lr_0 = 2.2387e-04
Loss = 1.1576e-03, PNorm = 47.3858, GNorm = 1.2067, lr_0 = 2.1663e-04
Validation rmse = 0.668977
Epoch 20
Loss = 9.3432e-04, PNorm = 47.3970, GNorm = 0.9572, lr_0 = 2.0962e-04
Loss = 1.2759e-03, PNorm = 47.4063, GNorm = 0.7229, lr_0 = 2.0283e-04
Loss = 1.0574e-03, PNorm = 47.4152, GNorm = 0.5782, lr_0 = 1.9627e-04
Validation rmse = 0.668719
Epoch 21
Loss = 1.0819e-03, PNorm = 47.4235, GNorm = 0.3960, lr_0 = 1.8992e-04
Loss = 1.1738e-03, PNorm = 47.4318, GNorm = 1.5112, lr_0 = 1.8377e-04
Validation rmse = 0.663405
Epoch 22
Loss = 7.8130e-04, PNorm = 47.4411, GNorm = 0.9504, lr_0 = 1.7783e-04
Loss = 1.1522e-03, PNorm = 47.4480, GNorm = 1.1656, lr_0 = 1.7207e-04
Loss = 1.0860e-03, PNorm = 47.4567, GNorm = 1.0189, lr_0 = 1.6651e-04
Validation rmse = 0.679696
Epoch 23
Loss = 9.6203e-04, PNorm = 47.4678, GNorm = 1.5585, lr_0 = 1.6059e-04
Loss = 1.0715e-03, PNorm = 47.4766, GNorm = 1.2621, lr_0 = 1.5539e-04
Validation rmse = 0.752276
Epoch 24
Loss = 1.0978e-03, PNorm = 47.4847, GNorm = 1.9451, lr_0 = 1.5036e-04
Loss = 1.1942e-03, PNorm = 47.4924, GNorm = 1.8083, lr_0 = 1.4550e-04
Loss = 1.2018e-03, PNorm = 47.5007, GNorm = 2.0398, lr_0 = 1.4079e-04
Validation rmse = 0.725163
Epoch 25
Loss = 9.3406e-04, PNorm = 47.5070, GNorm = 1.5501, lr_0 = 1.3623e-04
Loss = 1.1453e-03, PNorm = 47.5133, GNorm = 0.8063, lr_0 = 1.3183e-04
Loss = 1.2063e-03, PNorm = 47.5207, GNorm = 0.5110, lr_0 = 1.2756e-04
Validation rmse = 0.673814
Epoch 26
Loss = 1.1419e-03, PNorm = 47.5270, GNorm = 0.9513, lr_0 = 1.2343e-04
Loss = 1.0690e-03, PNorm = 47.5331, GNorm = 1.7125, lr_0 = 1.1944e-04
Validation rmse = 0.658948
Epoch 27
Loss = 1.1771e-03, PNorm = 47.5380, GNorm = 1.0374, lr_0 = 1.1557e-04
Loss = 9.0353e-04, PNorm = 47.5446, GNorm = 1.3663, lr_0 = 1.1183e-04
Loss = 9.9707e-04, PNorm = 47.5518, GNorm = 0.5969, lr_0 = 1.0821e-04
Validation rmse = 0.658195
Epoch 28
Loss = 1.0588e-03, PNorm = 47.5581, GNorm = 0.7229, lr_0 = 1.0437e-04
Loss = 8.1662e-04, PNorm = 47.5628, GNorm = 0.4127, lr_0 = 1.0099e-04
Validation rmse = 0.659182
Epoch 29
Loss = 1.0106e-03, PNorm = 47.5671, GNorm = 1.5546, lr_0 = 1.0000e-04
Loss = 9.0851e-04, PNorm = 47.5725, GNorm = 1.1296, lr_0 = 1.0000e-04
Loss = 9.0394e-04, PNorm = 47.5772, GNorm = 0.8330, lr_0 = 1.0000e-04
Validation rmse = 0.643522
Model 0 best validation rmse = 0.643522 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.696907
Ensemble test rmse = 0.696907
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.9069e-02, PNorm = 46.0253, GNorm = 2.6761, lr_0 = 2.9800e-04
Loss = 1.2470e-02, PNorm = 46.0507, GNorm = 2.3642, lr_0 = 4.7800e-04
Validation rmse = 1.270823
Epoch 1
Loss = 7.0960e-03, PNorm = 46.0972, GNorm = 9.0694, lr_0 = 6.7600e-04
Loss = 7.1067e-03, PNorm = 46.1356, GNorm = 6.8574, lr_0 = 8.5600e-04
Loss = 8.0104e-03, PNorm = 46.1867, GNorm = 6.2447, lr_0 = 9.9344e-04
Validation rmse = 1.361817
Epoch 2
Loss = 6.3355e-03, PNorm = 46.2469, GNorm = 5.3251, lr_0 = 9.6130e-04
Loss = 6.1038e-03, PNorm = 46.2973, GNorm = 2.0690, lr_0 = 9.3019e-04
Validation rmse = 1.012333
Epoch 3
Loss = 4.8485e-03, PNorm = 46.3462, GNorm = 3.0534, lr_0 = 9.0009e-04
Loss = 4.0495e-03, PNorm = 46.3930, GNorm = 1.6161, lr_0 = 8.7096e-04
Loss = 4.3635e-03, PNorm = 46.4378, GNorm = 1.4662, lr_0 = 8.4278e-04
Validation rmse = 0.953612
Epoch 4
Loss = 4.6332e-03, PNorm = 46.4821, GNorm = 3.2847, lr_0 = 8.1551e-04
Loss = 4.9766e-03, PNorm = 46.5333, GNorm = 3.6094, lr_0 = 7.8912e-04
Validation rmse = 0.923494
Epoch 5
Loss = 3.3901e-03, PNorm = 46.5758, GNorm = 0.7137, lr_0 = 7.6358e-04
Loss = 3.0652e-03, PNorm = 46.6203, GNorm = 1.2056, lr_0 = 7.3888e-04
Loss = 3.0845e-03, PNorm = 46.6605, GNorm = 2.3195, lr_0 = 7.1497e-04
Validation rmse = 0.832264
Epoch 6
Loss = 3.0165e-03, PNorm = 46.6938, GNorm = 1.1101, lr_0 = 6.8956e-04
Loss = 2.3556e-03, PNorm = 46.7223, GNorm = 0.9666, lr_0 = 6.6725e-04
Loss = 2.7039e-03, PNorm = 46.7511, GNorm = 1.0260, lr_0 = 6.4565e-04
Validation rmse = 0.820645
Epoch 7
Loss = 2.6466e-03, PNorm = 46.7783, GNorm = 1.0173, lr_0 = 6.2476e-04
Loss = 2.2720e-03, PNorm = 46.8144, GNorm = 0.6014, lr_0 = 6.0454e-04
Validation rmse = 0.747814
Epoch 8
Loss = 2.5009e-03, PNorm = 46.8480, GNorm = 1.5542, lr_0 = 5.8498e-04
Loss = 1.8687e-03, PNorm = 46.8771, GNorm = 0.7219, lr_0 = 5.6605e-04
Loss = 2.3632e-03, PNorm = 46.9001, GNorm = 1.4960, lr_0 = 5.4774e-04
Validation rmse = 0.751820
Epoch 9
Loss = 2.4913e-03, PNorm = 46.9287, GNorm = 2.2236, lr_0 = 5.3001e-04
Loss = 2.5471e-03, PNorm = 46.9585, GNorm = 2.8139, lr_0 = 5.1286e-04
Validation rmse = 0.698983
Epoch 10
Loss = 2.0387e-03, PNorm = 46.9858, GNorm = 2.1400, lr_0 = 4.9627e-04
Loss = 1.9201e-03, PNorm = 47.0090, GNorm = 0.9575, lr_0 = 4.8021e-04
Loss = 2.2207e-03, PNorm = 47.0404, GNorm = 2.4731, lr_0 = 4.6467e-04
Validation rmse = 0.701196
Epoch 11
Loss = 2.0665e-03, PNorm = 47.0626, GNorm = 3.0597, lr_0 = 4.4963e-04
Loss = 1.9518e-03, PNorm = 47.0866, GNorm = 1.7496, lr_0 = 4.3508e-04
Validation rmse = 0.661812
Epoch 12
Loss = 1.1488e-03, PNorm = 47.1095, GNorm = 0.7646, lr_0 = 4.1962e-04
Loss = 1.7757e-03, PNorm = 47.1279, GNorm = 2.0234, lr_0 = 4.0604e-04
Loss = 1.4856e-03, PNorm = 47.1472, GNorm = 0.6746, lr_0 = 3.9290e-04
Validation rmse = 0.682246
Epoch 13
Loss = 1.5607e-03, PNorm = 47.1674, GNorm = 0.7859, lr_0 = 3.8019e-04
Loss = 1.6812e-03, PNorm = 47.1864, GNorm = 4.5029, lr_0 = 3.6789e-04
Loss = 2.1792e-03, PNorm = 47.2076, GNorm = 2.1017, lr_0 = 3.5598e-04
Validation rmse = 0.774577
Epoch 14
Loss = 1.6506e-03, PNorm = 47.2223, GNorm = 0.5288, lr_0 = 3.4446e-04
Loss = 1.6056e-03, PNorm = 47.2419, GNorm = 0.7168, lr_0 = 3.3332e-04
Validation rmse = 0.766368
Epoch 15
Loss = 1.7068e-03, PNorm = 47.2590, GNorm = 0.4383, lr_0 = 3.2253e-04
Loss = 1.4850e-03, PNorm = 47.2733, GNorm = 0.5406, lr_0 = 3.1209e-04
Loss = 1.8816e-03, PNorm = 47.2910, GNorm = 1.5710, lr_0 = 3.0200e-04
Validation rmse = 0.663280
Epoch 16
Loss = 1.3816e-03, PNorm = 47.3062, GNorm = 1.0378, lr_0 = 2.9222e-04
Loss = 1.2523e-03, PNorm = 47.3195, GNorm = 0.7313, lr_0 = 2.8277e-04
Validation rmse = 0.651028
Epoch 17
Loss = 1.0583e-03, PNorm = 47.3340, GNorm = 2.0345, lr_0 = 2.7272e-04
Loss = 1.1784e-03, PNorm = 47.3452, GNorm = 0.5787, lr_0 = 2.6389e-04
Loss = 1.5218e-03, PNorm = 47.3574, GNorm = 3.4399, lr_0 = 2.5535e-04
Validation rmse = 0.675440
Epoch 18
Loss = 1.2585e-03, PNorm = 47.3706, GNorm = 0.4750, lr_0 = 2.4709e-04
Loss = 1.3827e-03, PNorm = 47.3829, GNorm = 0.9575, lr_0 = 2.3910e-04
Loss = 1.1278e-03, PNorm = 47.3918, GNorm = 1.1184, lr_0 = 2.3136e-04
Validation rmse = 0.651296
Epoch 19
Loss = 1.4741e-03, PNorm = 47.4031, GNorm = 1.2647, lr_0 = 2.2387e-04
Loss = 1.1224e-03, PNorm = 47.4149, GNorm = 0.6307, lr_0 = 2.1663e-04
Validation rmse = 0.647109
Epoch 20
Loss = 1.1154e-03, PNorm = 47.4242, GNorm = 2.2273, lr_0 = 2.0962e-04
Loss = 1.0723e-03, PNorm = 47.4340, GNorm = 1.2583, lr_0 = 2.0283e-04
Loss = 1.0457e-03, PNorm = 47.4427, GNorm = 0.5162, lr_0 = 1.9627e-04
Validation rmse = 0.631697
Epoch 21
Loss = 1.0533e-03, PNorm = 47.4511, GNorm = 0.5028, lr_0 = 1.8992e-04
Loss = 1.1312e-03, PNorm = 47.4599, GNorm = 1.2715, lr_0 = 1.8377e-04
Validation rmse = 0.653755
Epoch 22
Loss = 9.9667e-04, PNorm = 47.4676, GNorm = 0.6508, lr_0 = 1.7783e-04
Loss = 1.1815e-03, PNorm = 47.4765, GNorm = 0.6173, lr_0 = 1.7207e-04
Loss = 9.7338e-04, PNorm = 47.4841, GNorm = 0.5190, lr_0 = 1.6651e-04
Validation rmse = 0.640327
Epoch 23
Loss = 1.0823e-03, PNorm = 47.4921, GNorm = 1.1291, lr_0 = 1.6059e-04
Loss = 1.1643e-03, PNorm = 47.4982, GNorm = 0.7634, lr_0 = 1.5539e-04
Validation rmse = 0.632745
Epoch 24
Loss = 1.0395e-03, PNorm = 47.5057, GNorm = 0.9258, lr_0 = 1.5036e-04
Loss = 9.0421e-04, PNorm = 47.5128, GNorm = 0.7281, lr_0 = 1.4550e-04
Loss = 8.1197e-04, PNorm = 47.5195, GNorm = 1.2312, lr_0 = 1.4079e-04
Validation rmse = 0.629219
Epoch 25
Loss = 1.0908e-03, PNorm = 47.5260, GNorm = 2.7267, lr_0 = 1.3623e-04
Loss = 1.0499e-03, PNorm = 47.5342, GNorm = 0.8761, lr_0 = 1.3183e-04
Loss = 1.0253e-03, PNorm = 47.5393, GNorm = 0.7027, lr_0 = 1.2756e-04
Validation rmse = 0.635388
Epoch 26
Loss = 9.4944e-04, PNorm = 47.5457, GNorm = 2.2732, lr_0 = 1.2343e-04
Loss = 9.6649e-04, PNorm = 47.5519, GNorm = 0.8226, lr_0 = 1.1944e-04
Validation rmse = 0.651908
Epoch 27
Loss = 1.0223e-03, PNorm = 47.5574, GNorm = 0.9607, lr_0 = 1.1557e-04
Loss = 1.1407e-03, PNorm = 47.5634, GNorm = 0.6702, lr_0 = 1.1183e-04
Loss = 7.9349e-04, PNorm = 47.5687, GNorm = 1.0363, lr_0 = 1.0821e-04
Validation rmse = 0.647322
Epoch 28
Loss = 8.8715e-04, PNorm = 47.5739, GNorm = 0.5747, lr_0 = 1.0437e-04
Loss = 1.0108e-03, PNorm = 47.5790, GNorm = 0.8748, lr_0 = 1.0099e-04
Validation rmse = 0.635893
Epoch 29
Loss = 1.1878e-03, PNorm = 47.5835, GNorm = 1.5167, lr_0 = 1.0000e-04
Loss = 9.8582e-04, PNorm = 47.5888, GNorm = 2.5295, lr_0 = 1.0000e-04
Loss = 8.0764e-04, PNorm = 47.5933, GNorm = 0.8674, lr_0 = 1.0000e-04
Validation rmse = 0.637176
Model 0 best validation rmse = 0.629219 on epoch 24
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.658745
Ensemble test rmse = 0.658745
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.6762e-02, PNorm = 46.0249, GNorm = 5.5817, lr_0 = 2.9800e-04
Loss = 9.0999e-03, PNorm = 46.0526, GNorm = 1.8092, lr_0 = 4.7800e-04
Validation rmse = 1.239116
Epoch 1
Loss = 8.3903e-03, PNorm = 46.0922, GNorm = 5.4040, lr_0 = 6.7600e-04
Loss = 9.0109e-03, PNorm = 46.1402, GNorm = 3.2282, lr_0 = 8.5600e-04
Loss = 7.3389e-03, PNorm = 46.2049, GNorm = 4.4620, lr_0 = 9.9344e-04
Validation rmse = 1.169742
Epoch 2
Loss = 5.6628e-03, PNorm = 46.2675, GNorm = 2.8730, lr_0 = 9.6130e-04
Loss = 4.8909e-03, PNorm = 46.3139, GNorm = 4.4466, lr_0 = 9.3019e-04
Validation rmse = 1.087504
Epoch 3
Loss = 4.9011e-03, PNorm = 46.3575, GNorm = 1.9014, lr_0 = 9.0009e-04
Loss = 4.3571e-03, PNorm = 46.4044, GNorm = 1.7183, lr_0 = 8.7096e-04
Loss = 4.2235e-03, PNorm = 46.4483, GNorm = 3.8459, lr_0 = 8.4278e-04
Validation rmse = 0.918332
Epoch 4
Loss = 4.0219e-03, PNorm = 46.4862, GNorm = 6.5918, lr_0 = 8.1551e-04
Loss = 4.1754e-03, PNorm = 46.5313, GNorm = 2.0675, lr_0 = 7.8912e-04
Validation rmse = 1.056850
Epoch 5
Loss = 4.2716e-03, PNorm = 46.5745, GNorm = 2.6151, lr_0 = 7.6358e-04
Loss = 3.0186e-03, PNorm = 46.6138, GNorm = 0.7486, lr_0 = 7.3888e-04
Loss = 3.2441e-03, PNorm = 46.6498, GNorm = 1.7118, lr_0 = 7.1497e-04
Validation rmse = 0.850773
Epoch 6
Loss = 2.5832e-03, PNorm = 46.6888, GNorm = 1.1902, lr_0 = 6.8956e-04
Loss = 2.6237e-03, PNorm = 46.7179, GNorm = 1.0312, lr_0 = 6.6725e-04
Loss = 2.4152e-03, PNorm = 46.7442, GNorm = 2.2469, lr_0 = 6.4565e-04
Validation rmse = 0.764185
Epoch 7
Loss = 2.0735e-03, PNorm = 46.7719, GNorm = 2.4873, lr_0 = 6.2476e-04
Loss = 2.6154e-03, PNorm = 46.8005, GNorm = 1.6556, lr_0 = 6.0454e-04
Validation rmse = 0.724942
Epoch 8
Loss = 1.7624e-03, PNorm = 46.8277, GNorm = 1.2406, lr_0 = 5.8498e-04
Loss = 2.0950e-03, PNorm = 46.8545, GNorm = 2.3550, lr_0 = 5.6605e-04
Loss = 2.1167e-03, PNorm = 46.8802, GNorm = 0.7719, lr_0 = 5.4774e-04
Validation rmse = 0.733603
Epoch 9
Loss = 2.2115e-03, PNorm = 46.9042, GNorm = 2.2540, lr_0 = 5.3001e-04
Loss = 2.4021e-03, PNorm = 46.9294, GNorm = 2.9427, lr_0 = 5.1286e-04
Validation rmse = 0.764865
Epoch 10
Loss = 1.0286e-03, PNorm = 46.9544, GNorm = 0.5484, lr_0 = 4.9627e-04
Loss = 1.8428e-03, PNorm = 46.9754, GNorm = 2.6176, lr_0 = 4.8021e-04
Loss = 2.1053e-03, PNorm = 46.9983, GNorm = 3.2105, lr_0 = 4.6467e-04
Validation rmse = 0.715610
Epoch 11
Loss = 1.5064e-03, PNorm = 47.0209, GNorm = 0.5990, lr_0 = 4.4963e-04
Loss = 1.9736e-03, PNorm = 47.0435, GNorm = 1.9100, lr_0 = 4.3508e-04
Validation rmse = 0.741413
Epoch 12
Loss = 2.0838e-03, PNorm = 47.0652, GNorm = 1.7688, lr_0 = 4.1962e-04
Loss = 1.9576e-03, PNorm = 47.0840, GNorm = 1.6831, lr_0 = 4.0604e-04
Loss = 1.8913e-03, PNorm = 47.1037, GNorm = 2.7432, lr_0 = 3.9290e-04
Validation rmse = 0.738987
Epoch 13
Loss = 2.0186e-03, PNorm = 47.1253, GNorm = 0.8802, lr_0 = 3.8019e-04
Loss = 1.7331e-03, PNorm = 47.1434, GNorm = 1.9932, lr_0 = 3.6789e-04
Loss = 1.3777e-03, PNorm = 47.1617, GNorm = 0.7191, lr_0 = 3.5598e-04
Validation rmse = 0.664412
Epoch 14
Loss = 1.2605e-03, PNorm = 47.1767, GNorm = 1.1398, lr_0 = 3.4446e-04
Loss = 1.3773e-03, PNorm = 47.1920, GNorm = 0.9052, lr_0 = 3.3332e-04
Validation rmse = 0.687029
Epoch 15
Loss = 1.2054e-03, PNorm = 47.2075, GNorm = 1.3786, lr_0 = 3.2253e-04
Loss = 1.3742e-03, PNorm = 47.2226, GNorm = 1.0177, lr_0 = 3.1209e-04
Loss = 1.3622e-03, PNorm = 47.2344, GNorm = 0.9854, lr_0 = 3.0200e-04
Validation rmse = 0.648192
Epoch 16
Loss = 1.3384e-03, PNorm = 47.2500, GNorm = 0.8592, lr_0 = 2.9222e-04
Loss = 1.4210e-03, PNorm = 47.2664, GNorm = 0.7001, lr_0 = 2.8277e-04
Validation rmse = 0.697399
Epoch 17
Loss = 1.2990e-03, PNorm = 47.2816, GNorm = 1.2074, lr_0 = 2.7272e-04
Loss = 1.2598e-03, PNorm = 47.2939, GNorm = 3.0916, lr_0 = 2.6389e-04
Loss = 1.3427e-03, PNorm = 47.3066, GNorm = 0.6618, lr_0 = 2.5535e-04
Validation rmse = 0.645485
Epoch 18
Loss = 1.1064e-03, PNorm = 47.3205, GNorm = 2.4234, lr_0 = 2.4709e-04
Loss = 1.3507e-03, PNorm = 47.3330, GNorm = 1.8689, lr_0 = 2.3910e-04
Loss = 1.0424e-03, PNorm = 47.3465, GNorm = 1.1172, lr_0 = 2.3136e-04
Validation rmse = 0.645009
Epoch 19
Loss = 1.3698e-03, PNorm = 47.3580, GNorm = 0.9062, lr_0 = 2.2387e-04
Loss = 1.1584e-03, PNorm = 47.3696, GNorm = 0.5609, lr_0 = 2.1663e-04
Validation rmse = 0.647001
Epoch 20
Loss = 1.1459e-03, PNorm = 47.3811, GNorm = 0.5012, lr_0 = 2.0962e-04
Loss = 1.3179e-03, PNorm = 47.3925, GNorm = 1.5636, lr_0 = 2.0283e-04
Loss = 1.2943e-03, PNorm = 47.4040, GNorm = 0.3977, lr_0 = 1.9627e-04
Validation rmse = 0.667372
Epoch 21
Loss = 1.0845e-03, PNorm = 47.4152, GNorm = 0.7449, lr_0 = 1.8992e-04
Loss = 1.4600e-03, PNorm = 47.4251, GNorm = 1.9448, lr_0 = 1.8377e-04
Validation rmse = 0.653919
Epoch 22
Loss = 1.5151e-03, PNorm = 47.4343, GNorm = 2.5868, lr_0 = 1.7783e-04
Loss = 1.0612e-03, PNorm = 47.4438, GNorm = 1.5244, lr_0 = 1.7207e-04
Loss = 9.4194e-04, PNorm = 47.4514, GNorm = 1.9551, lr_0 = 1.6651e-04
Validation rmse = 0.658481
Epoch 23
Loss = 1.1784e-03, PNorm = 47.4610, GNorm = 1.6472, lr_0 = 1.6059e-04
Loss = 9.5479e-04, PNorm = 47.4680, GNorm = 0.8562, lr_0 = 1.5539e-04
Validation rmse = 0.665133
Epoch 24
Loss = 9.8037e-04, PNorm = 47.4760, GNorm = 1.4193, lr_0 = 1.5036e-04
Loss = 9.0777e-04, PNorm = 47.4835, GNorm = 0.7147, lr_0 = 1.4550e-04
Loss = 8.5479e-04, PNorm = 47.4904, GNorm = 0.8433, lr_0 = 1.4079e-04
Validation rmse = 0.665293
Epoch 25
Loss = 1.0843e-03, PNorm = 47.4969, GNorm = 0.5491, lr_0 = 1.3623e-04
Loss = 9.8564e-04, PNorm = 47.5038, GNorm = 1.1188, lr_0 = 1.3183e-04
Loss = 1.0068e-03, PNorm = 47.5107, GNorm = 0.4305, lr_0 = 1.2756e-04
Validation rmse = 0.661791
Epoch 26
Loss = 9.7646e-04, PNorm = 47.5173, GNorm = 0.6069, lr_0 = 1.2343e-04
Loss = 8.4991e-04, PNorm = 47.5239, GNorm = 0.8130, lr_0 = 1.1944e-04
Validation rmse = 0.642504
Epoch 27
Loss = 7.2036e-04, PNorm = 47.5297, GNorm = 0.8058, lr_0 = 1.1557e-04
Loss = 9.7463e-04, PNorm = 47.5354, GNorm = 0.6484, lr_0 = 1.1183e-04
Loss = 8.0221e-04, PNorm = 47.5408, GNorm = 1.3696, lr_0 = 1.0821e-04
Validation rmse = 0.640875
Epoch 28
Loss = 8.5177e-04, PNorm = 47.5460, GNorm = 0.5976, lr_0 = 1.0437e-04
Loss = 9.7368e-04, PNorm = 47.5512, GNorm = 1.8224, lr_0 = 1.0099e-04
Validation rmse = 0.648797
Epoch 29
Loss = 6.7873e-04, PNorm = 47.5563, GNorm = 1.6454, lr_0 = 1.0000e-04
Loss = 7.5767e-04, PNorm = 47.5613, GNorm = 1.3798, lr_0 = 1.0000e-04
Loss = 9.8216e-04, PNorm = 47.5660, GNorm = 0.7731, lr_0 = 1.0000e-04
Validation rmse = 0.644248
Model 0 best validation rmse = 0.640875 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.894170
Ensemble test rmse = 0.894170
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.6799e-02, PNorm = 46.0250, GNorm = 7.4602, lr_0 = 2.9800e-04
Loss = 1.1350e-02, PNorm = 46.0502, GNorm = 15.2722, lr_0 = 4.7800e-04
Validation rmse = 1.509030
Epoch 1
Loss = 7.6028e-03, PNorm = 46.0887, GNorm = 6.0972, lr_0 = 6.7600e-04
Loss = 7.1042e-03, PNorm = 46.1339, GNorm = 7.3003, lr_0 = 8.5600e-04
Loss = 8.1161e-03, PNorm = 46.1915, GNorm = 4.7299, lr_0 = 9.9344e-04
Validation rmse = 1.406896
Epoch 2
Loss = 6.9580e-03, PNorm = 46.2662, GNorm = 3.6173, lr_0 = 9.6130e-04
Loss = 4.8887e-03, PNorm = 46.3235, GNorm = 2.8614, lr_0 = 9.3019e-04
Validation rmse = 1.046439
Epoch 3
Loss = 3.5426e-03, PNorm = 46.3788, GNorm = 2.2190, lr_0 = 9.0009e-04
Loss = 3.7624e-03, PNorm = 46.4272, GNorm = 2.9908, lr_0 = 8.7096e-04
Loss = 3.8956e-03, PNorm = 46.4822, GNorm = 0.8339, lr_0 = 8.4278e-04
Validation rmse = 1.006819
Epoch 4
Loss = 3.0944e-03, PNorm = 46.5251, GNorm = 0.7591, lr_0 = 8.1551e-04
Loss = 2.8912e-03, PNorm = 46.5646, GNorm = 0.9684, lr_0 = 7.8912e-04
Validation rmse = 0.934171
Epoch 5
Loss = 3.4378e-03, PNorm = 46.6057, GNorm = 2.5107, lr_0 = 7.6358e-04
Loss = 3.3425e-03, PNorm = 46.6441, GNorm = 1.2016, lr_0 = 7.3888e-04
Loss = 5.4049e-03, PNorm = 46.6893, GNorm = 4.4940, lr_0 = 7.1497e-04
Validation rmse = 1.130638
Epoch 6
Loss = 2.9636e-03, PNorm = 46.7368, GNorm = 2.0715, lr_0 = 6.8956e-04
Loss = 3.1827e-03, PNorm = 46.7766, GNorm = 1.1004, lr_0 = 6.6725e-04
Loss = 2.7165e-03, PNorm = 46.8108, GNorm = 4.7680, lr_0 = 6.4565e-04
Validation rmse = 0.904352
Epoch 7
Loss = 2.3538e-03, PNorm = 46.8432, GNorm = 0.5303, lr_0 = 6.2476e-04
Loss = 2.6802e-03, PNorm = 46.8698, GNorm = 5.1278, lr_0 = 6.0454e-04
Validation rmse = 0.987898
Epoch 8
Loss = 3.1567e-03, PNorm = 46.8957, GNorm = 5.0369, lr_0 = 5.8498e-04
Loss = 2.5319e-03, PNorm = 46.9265, GNorm = 2.9896, lr_0 = 5.6605e-04
Loss = 2.1476e-03, PNorm = 46.9510, GNorm = 1.0281, lr_0 = 5.4774e-04
Validation rmse = 0.852254
Epoch 9
Loss = 1.9645e-03, PNorm = 46.9787, GNorm = 0.7776, lr_0 = 5.3001e-04
Loss = 2.0195e-03, PNorm = 47.0027, GNorm = 1.6074, lr_0 = 5.1286e-04
Validation rmse = 0.806832
Epoch 10
Loss = 1.6140e-03, PNorm = 47.0215, GNorm = 0.9978, lr_0 = 4.9627e-04
Loss = 1.9301e-03, PNorm = 47.0387, GNorm = 0.9641, lr_0 = 4.8021e-04
Loss = 1.6428e-03, PNorm = 47.0594, GNorm = 1.9762, lr_0 = 4.6467e-04
Validation rmse = 0.789804
Epoch 11
Loss = 1.7332e-03, PNorm = 47.0760, GNorm = 4.1661, lr_0 = 4.4963e-04
Loss = 2.7148e-03, PNorm = 47.0990, GNorm = 2.4877, lr_0 = 4.3508e-04
Validation rmse = 0.860065
Epoch 12
Loss = 1.8045e-03, PNorm = 47.1260, GNorm = 0.8500, lr_0 = 4.1962e-04
Loss = 1.5365e-03, PNorm = 47.1493, GNorm = 1.3917, lr_0 = 4.0604e-04
Loss = 1.6051e-03, PNorm = 47.1687, GNorm = 0.6225, lr_0 = 3.9290e-04
Validation rmse = 0.773592
Epoch 13
Loss = 1.6239e-03, PNorm = 47.1886, GNorm = 3.1312, lr_0 = 3.8019e-04
Loss = 1.7225e-03, PNorm = 47.2072, GNorm = 0.9137, lr_0 = 3.6789e-04
Loss = 1.4289e-03, PNorm = 47.2215, GNorm = 0.7146, lr_0 = 3.5598e-04
Validation rmse = 0.839738
Epoch 14
Loss = 1.6024e-03, PNorm = 47.2398, GNorm = 2.0872, lr_0 = 3.4446e-04
Loss = 1.4747e-03, PNorm = 47.2568, GNorm = 1.6209, lr_0 = 3.3332e-04
Validation rmse = 0.758567
Epoch 15
Loss = 1.0855e-03, PNorm = 47.2734, GNorm = 2.3010, lr_0 = 3.2253e-04
Loss = 1.3679e-03, PNorm = 47.2883, GNorm = 1.2813, lr_0 = 3.1209e-04
Loss = 1.2566e-03, PNorm = 47.3019, GNorm = 1.3626, lr_0 = 3.0200e-04
Validation rmse = 0.779250
Epoch 16
Loss = 1.3864e-03, PNorm = 47.3184, GNorm = 1.6265, lr_0 = 2.9222e-04
Loss = 1.4697e-03, PNorm = 47.3340, GNorm = 2.3260, lr_0 = 2.8277e-04
Validation rmse = 0.736149
Epoch 17
Loss = 1.5048e-03, PNorm = 47.3482, GNorm = 1.6758, lr_0 = 2.7272e-04
Loss = 1.3243e-03, PNorm = 47.3613, GNorm = 1.3394, lr_0 = 2.6389e-04
Loss = 1.0689e-03, PNorm = 47.3741, GNorm = 0.4216, lr_0 = 2.5535e-04
Validation rmse = 0.741563
Epoch 18
Loss = 9.8378e-04, PNorm = 47.3869, GNorm = 0.4537, lr_0 = 2.4709e-04
Loss = 1.2791e-03, PNorm = 47.3984, GNorm = 1.6663, lr_0 = 2.3910e-04
Loss = 1.1664e-03, PNorm = 47.4109, GNorm = 0.8076, lr_0 = 2.3136e-04
Validation rmse = 0.763010
Epoch 19
Loss = 1.1802e-03, PNorm = 47.4215, GNorm = 0.6457, lr_0 = 2.2387e-04
Loss = 1.2508e-03, PNorm = 47.4334, GNorm = 0.5987, lr_0 = 2.1663e-04
Validation rmse = 0.728401
Epoch 20
Loss = 7.1820e-04, PNorm = 47.4441, GNorm = 0.2940, lr_0 = 2.0962e-04
Loss = 1.0593e-03, PNorm = 47.4546, GNorm = 0.6192, lr_0 = 2.0283e-04
Loss = 1.1028e-03, PNorm = 47.4636, GNorm = 1.6504, lr_0 = 1.9627e-04
Validation rmse = 0.764232
Epoch 21
Loss = 9.4817e-04, PNorm = 47.4739, GNorm = 0.4733, lr_0 = 1.8992e-04
Loss = 1.0949e-03, PNorm = 47.4832, GNorm = 1.1781, lr_0 = 1.8377e-04
Validation rmse = 0.732670
Epoch 22
Loss = 8.7647e-04, PNorm = 47.4939, GNorm = 1.0673, lr_0 = 1.7783e-04
Loss = 1.0626e-03, PNorm = 47.5020, GNorm = 2.0439, lr_0 = 1.7207e-04
Loss = 1.1760e-03, PNorm = 47.5113, GNorm = 1.5099, lr_0 = 1.6651e-04
Validation rmse = 0.725028
Epoch 23
Loss = 9.7282e-04, PNorm = 47.5207, GNorm = 1.0178, lr_0 = 1.6059e-04
Loss = 8.6852e-04, PNorm = 47.5286, GNorm = 0.8506, lr_0 = 1.5539e-04
Validation rmse = 0.720538
Epoch 24
Loss = 5.5615e-04, PNorm = 47.5361, GNorm = 0.4906, lr_0 = 1.5036e-04
Loss = 9.9010e-04, PNorm = 47.5427, GNorm = 1.9915, lr_0 = 1.4550e-04
Loss = 1.0256e-03, PNorm = 47.5505, GNorm = 0.7029, lr_0 = 1.4079e-04
Validation rmse = 0.721955
Epoch 25
Loss = 9.5047e-04, PNorm = 47.5584, GNorm = 1.2136, lr_0 = 1.3623e-04
Loss = 8.7180e-04, PNorm = 47.5658, GNorm = 1.3653, lr_0 = 1.3183e-04
Loss = 9.4801e-04, PNorm = 47.5722, GNorm = 1.5173, lr_0 = 1.2756e-04
Validation rmse = 0.727046
Epoch 26
Loss = 8.5991e-04, PNorm = 47.5784, GNorm = 0.8334, lr_0 = 1.2343e-04
Loss = 9.4796e-04, PNorm = 47.5841, GNorm = 1.2553, lr_0 = 1.1944e-04
Validation rmse = 0.714223
Epoch 27
Loss = 8.1007e-04, PNorm = 47.5899, GNorm = 0.9618, lr_0 = 1.1557e-04
Loss = 8.0669e-04, PNorm = 47.5952, GNorm = 0.5188, lr_0 = 1.1183e-04
Loss = 8.8066e-04, PNorm = 47.6009, GNorm = 0.9545, lr_0 = 1.0821e-04
Validation rmse = 0.712328
Epoch 28
Loss = 7.0964e-04, PNorm = 47.6071, GNorm = 1.3283, lr_0 = 1.0437e-04
Loss = 9.3253e-04, PNorm = 47.6123, GNorm = 0.5628, lr_0 = 1.0099e-04
Validation rmse = 0.726544
Epoch 29
Loss = 1.4973e-03, PNorm = 47.6177, GNorm = 0.8164, lr_0 = 1.0000e-04
Loss = 7.9172e-04, PNorm = 47.6231, GNorm = 1.1087, lr_0 = 1.0000e-04
Loss = 6.8065e-04, PNorm = 47.6282, GNorm = 0.6499, lr_0 = 1.0000e-04
Validation rmse = 0.697758
Model 0 best validation rmse = 0.697758 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.056610
Ensemble test rmse = 1.056610
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.7601e-02, PNorm = 46.0261, GNorm = 6.7725, lr_0 = 2.9800e-04
Loss = 1.1992e-02, PNorm = 46.0512, GNorm = 5.0880, lr_0 = 4.7800e-04
Validation rmse = 1.527313
Epoch 1
Loss = 7.5918e-03, PNorm = 46.0932, GNorm = 2.6081, lr_0 = 6.7600e-04
Loss = 6.4688e-03, PNorm = 46.1408, GNorm = 2.3365, lr_0 = 8.5600e-04
Loss = 6.4606e-03, PNorm = 46.1941, GNorm = 8.6075, lr_0 = 9.9344e-04
Validation rmse = 1.245187
Epoch 2
Loss = 5.5326e-03, PNorm = 46.2527, GNorm = 6.5929, lr_0 = 9.6130e-04
Loss = 5.0080e-03, PNorm = 46.3141, GNorm = 5.6921, lr_0 = 9.3019e-04
Validation rmse = 1.207299
Epoch 3
Loss = 3.3904e-03, PNorm = 46.3670, GNorm = 3.7327, lr_0 = 9.0009e-04
Loss = 4.0085e-03, PNorm = 46.4099, GNorm = 3.1627, lr_0 = 8.7096e-04
Loss = 4.3862e-03, PNorm = 46.4540, GNorm = 1.1723, lr_0 = 8.4278e-04
Validation rmse = 1.145929
Epoch 4
Loss = 3.4395e-03, PNorm = 46.5022, GNorm = 2.1675, lr_0 = 8.1551e-04
Loss = 3.7872e-03, PNorm = 46.5421, GNorm = 4.8004, lr_0 = 7.8912e-04
Validation rmse = 1.069631
Epoch 5
Loss = 2.4071e-03, PNorm = 46.5828, GNorm = 1.1459, lr_0 = 7.6358e-04
Loss = 2.9787e-03, PNorm = 46.6158, GNorm = 1.4116, lr_0 = 7.3888e-04
Loss = 4.3726e-03, PNorm = 46.6519, GNorm = 2.4161, lr_0 = 7.1497e-04
Validation rmse = 1.173216
Epoch 6
Loss = 3.6518e-03, PNorm = 46.7057, GNorm = 3.6773, lr_0 = 6.8956e-04
Loss = 3.6624e-03, PNorm = 46.7472, GNorm = 2.1457, lr_0 = 6.6725e-04
Loss = 2.5170e-03, PNorm = 46.7799, GNorm = 2.8800, lr_0 = 6.4565e-04
Validation rmse = 0.980850
Epoch 7
Loss = 2.2012e-03, PNorm = 46.8112, GNorm = 0.8243, lr_0 = 6.2476e-04
Loss = 2.6137e-03, PNorm = 46.8402, GNorm = 1.8281, lr_0 = 6.0454e-04
Validation rmse = 1.082054
Epoch 8
Loss = 2.2570e-03, PNorm = 46.8677, GNorm = 0.9890, lr_0 = 5.8498e-04
Loss = 2.2155e-03, PNorm = 46.8932, GNorm = 2.3344, lr_0 = 5.6605e-04
Loss = 1.9804e-03, PNorm = 46.9151, GNorm = 1.7192, lr_0 = 5.4774e-04
Validation rmse = 0.992751
Epoch 9
Loss = 1.9706e-03, PNorm = 46.9330, GNorm = 2.9315, lr_0 = 5.3001e-04
Loss = 1.9623e-03, PNorm = 46.9575, GNorm = 1.2087, lr_0 = 5.1286e-04
Validation rmse = 0.922189
Epoch 10
Loss = 1.5703e-03, PNorm = 46.9794, GNorm = 0.3998, lr_0 = 4.9627e-04
Loss = 1.5126e-03, PNorm = 46.9990, GNorm = 1.2394, lr_0 = 4.8021e-04
Loss = 2.0611e-03, PNorm = 47.0209, GNorm = 2.0477, lr_0 = 4.6467e-04
Validation rmse = 0.923778
Epoch 11
Loss = 1.5729e-03, PNorm = 47.0414, GNorm = 1.1325, lr_0 = 4.4963e-04
Loss = 1.9973e-03, PNorm = 47.0655, GNorm = 1.0453, lr_0 = 4.3508e-04
Validation rmse = 0.935630
Epoch 12
Loss = 1.5648e-03, PNorm = 47.0849, GNorm = 0.7790, lr_0 = 4.1962e-04
Loss = 1.9111e-03, PNorm = 47.1029, GNorm = 0.5225, lr_0 = 4.0604e-04
Loss = 1.6980e-03, PNorm = 47.1214, GNorm = 1.9687, lr_0 = 3.9290e-04
Validation rmse = 1.147764
Epoch 13
Loss = 2.0362e-03, PNorm = 47.1461, GNorm = 5.3247, lr_0 = 3.8019e-04
Loss = 1.6697e-03, PNorm = 47.1646, GNorm = 1.5854, lr_0 = 3.6789e-04
Loss = 1.9729e-03, PNorm = 47.1859, GNorm = 3.2929, lr_0 = 3.5598e-04
Validation rmse = 0.889954
Epoch 14
Loss = 2.1327e-03, PNorm = 47.2065, GNorm = 2.0836, lr_0 = 3.4446e-04
Loss = 1.5916e-03, PNorm = 47.2280, GNorm = 1.3229, lr_0 = 3.3332e-04
Validation rmse = 0.904725
Epoch 15
Loss = 1.5807e-03, PNorm = 47.2449, GNorm = 0.9714, lr_0 = 3.2253e-04
Loss = 1.2696e-03, PNorm = 47.2581, GNorm = 0.5807, lr_0 = 3.1209e-04
Loss = 1.1976e-03, PNorm = 47.2726, GNorm = 0.6187, lr_0 = 3.0200e-04
Validation rmse = 0.865871
Epoch 16
Loss = 1.5001e-03, PNorm = 47.2851, GNorm = 1.1417, lr_0 = 2.9222e-04
Loss = 1.2458e-03, PNorm = 47.2998, GNorm = 2.3555, lr_0 = 2.8277e-04
Validation rmse = 0.885946
Epoch 17
Loss = 1.6119e-03, PNorm = 47.3148, GNorm = 2.1140, lr_0 = 2.7272e-04
Loss = 1.2382e-03, PNorm = 47.3287, GNorm = 0.6421, lr_0 = 2.6389e-04
Loss = 1.2041e-03, PNorm = 47.3429, GNorm = 1.7016, lr_0 = 2.5535e-04
Validation rmse = 0.870879
Epoch 18
Loss = 1.3091e-03, PNorm = 47.3540, GNorm = 1.8882, lr_0 = 2.4709e-04
Loss = 1.2631e-03, PNorm = 47.3665, GNorm = 0.7974, lr_0 = 2.3910e-04
Loss = 1.2703e-03, PNorm = 47.3788, GNorm = 0.5966, lr_0 = 2.3136e-04
Validation rmse = 0.922856
Epoch 19
Loss = 1.2865e-03, PNorm = 47.3905, GNorm = 1.5032, lr_0 = 2.2387e-04
Loss = 1.2819e-03, PNorm = 47.4011, GNorm = 0.7580, lr_0 = 2.1663e-04
Validation rmse = 0.908336
Epoch 20
Loss = 9.5675e-04, PNorm = 47.4108, GNorm = 0.5925, lr_0 = 2.0962e-04
Loss = 1.2113e-03, PNorm = 47.4214, GNorm = 1.4705, lr_0 = 2.0283e-04
Loss = 1.1085e-03, PNorm = 47.4315, GNorm = 1.0060, lr_0 = 1.9627e-04
Validation rmse = 0.896977
Epoch 21
Loss = 1.0452e-03, PNorm = 47.4405, GNorm = 0.9450, lr_0 = 1.8992e-04
Loss = 1.0420e-03, PNorm = 47.4487, GNorm = 0.7163, lr_0 = 1.8377e-04
Validation rmse = 0.850711
Epoch 22
Loss = 1.0088e-03, PNorm = 47.4574, GNorm = 0.5384, lr_0 = 1.7783e-04
Loss = 8.0321e-04, PNorm = 47.4653, GNorm = 1.2349, lr_0 = 1.7207e-04
Loss = 1.1560e-03, PNorm = 47.4734, GNorm = 1.7433, lr_0 = 1.6651e-04
Validation rmse = 0.898363
Epoch 23
Loss = 8.1465e-04, PNorm = 47.4827, GNorm = 0.5723, lr_0 = 1.6059e-04
Loss = 8.9475e-04, PNorm = 47.4912, GNorm = 0.4712, lr_0 = 1.5539e-04
Validation rmse = 0.848259
Epoch 24
Loss = 1.1805e-03, PNorm = 47.4978, GNorm = 1.8220, lr_0 = 1.5036e-04
Loss = 1.1506e-03, PNorm = 47.5067, GNorm = 0.4988, lr_0 = 1.4550e-04
Loss = 8.8227e-04, PNorm = 47.5139, GNorm = 0.6693, lr_0 = 1.4079e-04
Validation rmse = 0.827587
Epoch 25
Loss = 8.3859e-04, PNorm = 47.5193, GNorm = 0.8183, lr_0 = 1.3623e-04
Loss = 9.4264e-04, PNorm = 47.5260, GNorm = 1.2178, lr_0 = 1.3183e-04
Loss = 9.0392e-04, PNorm = 47.5329, GNorm = 0.5809, lr_0 = 1.2756e-04
Validation rmse = 0.863104
Epoch 26
Loss = 9.2062e-04, PNorm = 47.5399, GNorm = 1.9341, lr_0 = 1.2343e-04
Loss = 8.1453e-04, PNorm = 47.5457, GNorm = 1.0622, lr_0 = 1.1944e-04
Validation rmse = 0.846804
Epoch 27
Loss = 7.7234e-04, PNorm = 47.5491, GNorm = 0.5986, lr_0 = 1.1557e-04
Loss = 9.5435e-04, PNorm = 47.5546, GNorm = 1.2988, lr_0 = 1.1183e-04
Loss = 9.2060e-04, PNorm = 47.5597, GNorm = 1.1297, lr_0 = 1.0821e-04
Validation rmse = 0.821749
Epoch 28
Loss = 9.3389e-04, PNorm = 47.5665, GNorm = 1.3462, lr_0 = 1.0437e-04
Loss = 7.4835e-04, PNorm = 47.5711, GNorm = 0.6703, lr_0 = 1.0099e-04
Validation rmse = 0.826114
Epoch 29
Loss = 5.0273e-04, PNorm = 47.5757, GNorm = 1.1860, lr_0 = 1.0000e-04
Loss = 8.1406e-04, PNorm = 47.5809, GNorm = 0.6782, lr_0 = 1.0000e-04
Loss = 8.1461e-04, PNorm = 47.5862, GNorm = 0.8096, lr_0 = 1.0000e-04
Validation rmse = 0.826682
Model 0 best validation rmse = 0.821749 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.673163
Ensemble test rmse = 0.673163
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.8218e-02, PNorm = 46.0240, GNorm = 12.4065, lr_0 = 2.9800e-04
Loss = 1.3389e-02, PNorm = 46.0488, GNorm = 7.2977, lr_0 = 4.7800e-04
Validation rmse = 1.689895
Epoch 1
Loss = 8.6468e-03, PNorm = 46.0942, GNorm = 6.1715, lr_0 = 6.7600e-04
Loss = 8.2205e-03, PNorm = 46.1465, GNorm = 1.1647, lr_0 = 8.5600e-04
Loss = 7.3633e-03, PNorm = 46.2038, GNorm = 2.0710, lr_0 = 9.9344e-04
Validation rmse = 1.743346
Epoch 2
Loss = 6.3910e-03, PNorm = 46.2700, GNorm = 1.7078, lr_0 = 9.6130e-04
Loss = 6.0168e-03, PNorm = 46.3209, GNorm = 2.7158, lr_0 = 9.3019e-04
Validation rmse = 1.248960
Epoch 3
Loss = 4.9981e-03, PNorm = 46.3765, GNorm = 2.2975, lr_0 = 9.0009e-04
Loss = 4.2561e-03, PNorm = 46.4257, GNorm = 2.7855, lr_0 = 8.7096e-04
Loss = 3.6347e-03, PNorm = 46.4757, GNorm = 1.9732, lr_0 = 8.4278e-04
Validation rmse = 1.138433
Epoch 4
Loss = 3.2564e-03, PNorm = 46.5212, GNorm = 0.9991, lr_0 = 8.1551e-04
Loss = 5.4648e-03, PNorm = 46.5660, GNorm = 1.9358, lr_0 = 7.8912e-04
Validation rmse = 1.241184
Epoch 5
Loss = 3.2820e-03, PNorm = 46.6147, GNorm = 4.3838, lr_0 = 7.6358e-04
Loss = 3.5116e-03, PNorm = 46.6540, GNorm = 1.1525, lr_0 = 7.3888e-04
Loss = 3.8849e-03, PNorm = 46.6965, GNorm = 1.7095, lr_0 = 7.1497e-04
Validation rmse = 1.117759
Epoch 6
Loss = 2.6816e-03, PNorm = 46.7429, GNorm = 0.7208, lr_0 = 6.8956e-04
Loss = 2.8388e-03, PNorm = 46.7822, GNorm = 3.5039, lr_0 = 6.6725e-04
Loss = 3.7890e-03, PNorm = 46.8231, GNorm = 1.0856, lr_0 = 6.4565e-04
Validation rmse = 1.147475
Epoch 7
Loss = 3.2987e-03, PNorm = 46.8636, GNorm = 3.5025, lr_0 = 6.2476e-04
Loss = 2.3973e-03, PNorm = 46.8969, GNorm = 1.4995, lr_0 = 6.0454e-04
Validation rmse = 1.069845
Epoch 8
Loss = 2.2585e-03, PNorm = 46.9267, GNorm = 1.2483, lr_0 = 5.8498e-04
Loss = 1.8024e-03, PNorm = 46.9523, GNorm = 0.5810, lr_0 = 5.6605e-04
Loss = 2.1096e-03, PNorm = 46.9759, GNorm = 0.4606, lr_0 = 5.4774e-04
Validation rmse = 1.056987
Epoch 9
Loss = 2.4951e-03, PNorm = 47.0073, GNorm = 4.8908, lr_0 = 5.3001e-04
Loss = 1.8370e-03, PNorm = 47.0369, GNorm = 1.6640, lr_0 = 5.1286e-04
Validation rmse = 1.071497
Epoch 10
Loss = 2.4016e-03, PNorm = 47.0667, GNorm = 1.8967, lr_0 = 4.9627e-04
Loss = 2.0688e-03, PNorm = 47.0918, GNorm = 1.3457, lr_0 = 4.8021e-04
Loss = 1.5022e-03, PNorm = 47.1158, GNorm = 1.3237, lr_0 = 4.6467e-04
Validation rmse = 1.050359
Epoch 11
Loss = 1.9139e-03, PNorm = 47.1407, GNorm = 3.3086, lr_0 = 4.4963e-04
Loss = 1.4501e-03, PNorm = 47.1608, GNorm = 0.5801, lr_0 = 4.3508e-04
Validation rmse = 1.029473
Epoch 12
Loss = 1.5955e-03, PNorm = 47.1850, GNorm = 1.5081, lr_0 = 4.1962e-04
Loss = 1.3724e-03, PNorm = 47.2061, GNorm = 0.7810, lr_0 = 4.0604e-04
Loss = 1.5291e-03, PNorm = 47.2221, GNorm = 1.0493, lr_0 = 3.9290e-04
Validation rmse = 0.983284
Epoch 13
Loss = 1.4337e-03, PNorm = 47.2443, GNorm = 0.9974, lr_0 = 3.8019e-04
Loss = 1.4059e-03, PNorm = 47.2619, GNorm = 0.9970, lr_0 = 3.6789e-04
Loss = 1.5221e-03, PNorm = 47.2807, GNorm = 1.6215, lr_0 = 3.5598e-04
Validation rmse = 0.995741
Epoch 14
Loss = 1.4043e-03, PNorm = 47.3014, GNorm = 0.5768, lr_0 = 3.4446e-04
Loss = 1.1414e-03, PNorm = 47.3169, GNorm = 1.1843, lr_0 = 3.3332e-04
Validation rmse = 1.003177
Epoch 15
Loss = 8.6369e-04, PNorm = 47.3338, GNorm = 0.5424, lr_0 = 3.2253e-04
Loss = 1.4437e-03, PNorm = 47.3525, GNorm = 1.2499, lr_0 = 3.1209e-04
Loss = 1.3358e-03, PNorm = 47.3700, GNorm = 3.1240, lr_0 = 3.0200e-04
Validation rmse = 1.115087
Epoch 16
Loss = 1.3501e-03, PNorm = 47.3856, GNorm = 1.2258, lr_0 = 2.9222e-04
Loss = 1.6107e-03, PNorm = 47.4010, GNorm = 1.4049, lr_0 = 2.8277e-04
Validation rmse = 1.035550
Epoch 17
Loss = 1.5541e-03, PNorm = 47.4212, GNorm = 2.3684, lr_0 = 2.7272e-04
Loss = 1.2398e-03, PNorm = 47.4363, GNorm = 1.1968, lr_0 = 2.6389e-04
Loss = 1.1375e-03, PNorm = 47.4498, GNorm = 1.3342, lr_0 = 2.5535e-04
Validation rmse = 1.011328
Epoch 18
Loss = 1.3158e-03, PNorm = 47.4637, GNorm = 1.6915, lr_0 = 2.4709e-04
Loss = 9.8346e-04, PNorm = 47.4752, GNorm = 1.0665, lr_0 = 2.3910e-04
Loss = 1.1234e-03, PNorm = 47.4854, GNorm = 0.6064, lr_0 = 2.3136e-04
Validation rmse = 0.995393
Epoch 19
Loss = 1.0626e-03, PNorm = 47.4964, GNorm = 0.6426, lr_0 = 2.2387e-04
Loss = 1.0229e-03, PNorm = 47.5080, GNorm = 0.6279, lr_0 = 2.1663e-04
Validation rmse = 0.989910
Epoch 20
Loss = 9.5285e-04, PNorm = 47.5183, GNorm = 0.5297, lr_0 = 2.0962e-04
Loss = 1.0495e-03, PNorm = 47.5298, GNorm = 0.6152, lr_0 = 2.0283e-04
Loss = 1.1223e-03, PNorm = 47.5412, GNorm = 1.3705, lr_0 = 1.9627e-04
Validation rmse = 1.000175
Epoch 21
Loss = 9.1960e-04, PNorm = 47.5508, GNorm = 1.0981, lr_0 = 1.8992e-04
Loss = 9.7023e-04, PNorm = 47.5598, GNorm = 0.8426, lr_0 = 1.8377e-04
Validation rmse = 0.967173
Epoch 22
Loss = 7.8108e-04, PNorm = 47.5681, GNorm = 0.9824, lr_0 = 1.7783e-04
Loss = 9.0031e-04, PNorm = 47.5769, GNorm = 0.4230, lr_0 = 1.7207e-04
Loss = 9.7525e-04, PNorm = 47.5843, GNorm = 0.7152, lr_0 = 1.6651e-04
Validation rmse = 0.983778
Epoch 23
Loss = 7.7502e-04, PNorm = 47.5929, GNorm = 1.4063, lr_0 = 1.6059e-04
Loss = 1.0540e-03, PNorm = 47.5995, GNorm = 0.8269, lr_0 = 1.5539e-04
Validation rmse = 0.972263
Epoch 24
Loss = 7.3591e-04, PNorm = 47.6072, GNorm = 0.8007, lr_0 = 1.5036e-04
Loss = 8.6593e-04, PNorm = 47.6155, GNorm = 0.6761, lr_0 = 1.4550e-04
Loss = 9.3919e-04, PNorm = 47.6239, GNorm = 0.6140, lr_0 = 1.4079e-04
Validation rmse = 0.982906
Epoch 25
Loss = 9.1096e-04, PNorm = 47.6307, GNorm = 0.7711, lr_0 = 1.3623e-04
Loss = 7.3729e-04, PNorm = 47.6368, GNorm = 0.8684, lr_0 = 1.3183e-04
Loss = 9.6185e-04, PNorm = 47.6427, GNorm = 0.5337, lr_0 = 1.2756e-04
Validation rmse = 0.967583
Epoch 26
Loss = 7.8647e-04, PNorm = 47.6494, GNorm = 0.8823, lr_0 = 1.2343e-04
Loss = 8.3319e-04, PNorm = 47.6558, GNorm = 0.6202, lr_0 = 1.1944e-04
Validation rmse = 0.977221
Epoch 27
Loss = 8.5915e-04, PNorm = 47.6625, GNorm = 0.9139, lr_0 = 1.1557e-04
Loss = 7.6972e-04, PNorm = 47.6697, GNorm = 1.1591, lr_0 = 1.1183e-04
Loss = 8.9587e-04, PNorm = 47.6749, GNorm = 0.6976, lr_0 = 1.0821e-04
Validation rmse = 0.974446
Epoch 28
Loss = 8.1872e-04, PNorm = 47.6793, GNorm = 0.5569, lr_0 = 1.0437e-04
Loss = 7.8101e-04, PNorm = 47.6844, GNorm = 1.5335, lr_0 = 1.0099e-04
Validation rmse = 0.972737
Epoch 29
Loss = 7.2698e-04, PNorm = 47.6897, GNorm = 0.4614, lr_0 = 1.0000e-04
Loss = 6.9862e-04, PNorm = 47.6947, GNorm = 0.9865, lr_0 = 1.0000e-04
Loss = 8.8197e-04, PNorm = 47.6998, GNorm = 0.4040, lr_0 = 1.0000e-04
Validation rmse = 0.964457
Model 0 best validation rmse = 0.964457 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.746598
Ensemble test rmse = 0.746598
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.4276e-02, PNorm = 46.0265, GNorm = 7.2588, lr_0 = 2.9800e-04
Loss = 1.2642e-02, PNorm = 46.0499, GNorm = 19.0482, lr_0 = 4.7800e-04
Validation rmse = 1.559889
Epoch 1
Loss = 7.5568e-03, PNorm = 46.0906, GNorm = 8.2090, lr_0 = 6.7600e-04
Loss = 7.9337e-03, PNorm = 46.1415, GNorm = 6.4588, lr_0 = 8.5600e-04
Loss = 7.3612e-03, PNorm = 46.2015, GNorm = 2.7083, lr_0 = 9.9344e-04
Validation rmse = 1.121563
Epoch 2
Loss = 5.6520e-03, PNorm = 46.2633, GNorm = 3.3765, lr_0 = 9.6130e-04
Loss = 5.0907e-03, PNorm = 46.3217, GNorm = 4.4944, lr_0 = 9.3019e-04
Validation rmse = 1.431513
Epoch 3
Loss = 4.8401e-03, PNorm = 46.3682, GNorm = 1.6530, lr_0 = 9.0009e-04
Loss = 4.2599e-03, PNorm = 46.4172, GNorm = 2.7140, lr_0 = 8.7096e-04
Loss = 4.6663e-03, PNorm = 46.4668, GNorm = 4.2322, lr_0 = 8.4278e-04
Validation rmse = 0.881197
Epoch 4
Loss = 3.5005e-03, PNorm = 46.5156, GNorm = 2.8303, lr_0 = 8.1551e-04
Loss = 3.6431e-03, PNorm = 46.5588, GNorm = 4.1688, lr_0 = 7.8912e-04
Validation rmse = 0.978670
Epoch 5
Loss = 3.4863e-03, PNorm = 46.6002, GNorm = 3.0992, lr_0 = 7.6358e-04
Loss = 3.2417e-03, PNorm = 46.6489, GNorm = 0.6382, lr_0 = 7.3888e-04
Loss = 3.3264e-03, PNorm = 46.6892, GNorm = 2.6491, lr_0 = 7.1497e-04
Validation rmse = 0.928476
Epoch 6
Loss = 4.1026e-03, PNorm = 46.7297, GNorm = 7.5190, lr_0 = 6.8956e-04
Loss = 3.6565e-03, PNorm = 46.7674, GNorm = 0.7359, lr_0 = 6.6725e-04
Loss = 2.8224e-03, PNorm = 46.8046, GNorm = 3.0301, lr_0 = 6.4565e-04
Validation rmse = 0.872205
Epoch 7
Loss = 2.6524e-03, PNorm = 46.8417, GNorm = 1.0113, lr_0 = 6.2476e-04
Loss = 2.3569e-03, PNorm = 46.8728, GNorm = 2.3839, lr_0 = 6.0454e-04
Validation rmse = 0.910075
Epoch 8
Loss = 1.5990e-03, PNorm = 46.9051, GNorm = 0.5408, lr_0 = 5.8498e-04
Loss = 2.2872e-03, PNorm = 46.9366, GNorm = 2.4712, lr_0 = 5.6605e-04
Loss = 2.3012e-03, PNorm = 46.9668, GNorm = 1.5960, lr_0 = 5.4774e-04
Validation rmse = 0.824637
Epoch 9
Loss = 2.1105e-03, PNorm = 46.9963, GNorm = 3.2399, lr_0 = 5.3001e-04
Loss = 2.5744e-03, PNorm = 47.0299, GNorm = 2.7550, lr_0 = 5.1286e-04
Validation rmse = 0.856812
Epoch 10
Loss = 1.9509e-03, PNorm = 47.0581, GNorm = 0.6923, lr_0 = 4.9627e-04
Loss = 1.8778e-03, PNorm = 47.0864, GNorm = 0.9739, lr_0 = 4.8021e-04
Loss = 2.1716e-03, PNorm = 47.1106, GNorm = 2.9221, lr_0 = 4.6467e-04
Validation rmse = 0.956631
Epoch 11
Loss = 2.5134e-03, PNorm = 47.1365, GNorm = 3.3798, lr_0 = 4.4963e-04
Loss = 1.6240e-03, PNorm = 47.1612, GNorm = 0.8876, lr_0 = 4.3508e-04
Validation rmse = 0.799880
Epoch 12
Loss = 1.9075e-03, PNorm = 47.1812, GNorm = 0.9680, lr_0 = 4.1962e-04
Loss = 1.5860e-03, PNorm = 47.2023, GNorm = 1.3568, lr_0 = 4.0604e-04
Loss = 1.6571e-03, PNorm = 47.2210, GNorm = 0.7168, lr_0 = 3.9290e-04
Validation rmse = 0.852215
Epoch 13
Loss = 1.6031e-03, PNorm = 47.2364, GNorm = 1.1737, lr_0 = 3.8019e-04
Loss = 1.3924e-03, PNorm = 47.2515, GNorm = 1.0866, lr_0 = 3.6789e-04
Loss = 1.5819e-03, PNorm = 47.2683, GNorm = 1.1415, lr_0 = 3.5598e-04
Validation rmse = 0.763819
Epoch 14
Loss = 1.3356e-03, PNorm = 47.2858, GNorm = 1.0408, lr_0 = 3.4446e-04
Loss = 1.3964e-03, PNorm = 47.3027, GNorm = 1.4731, lr_0 = 3.3332e-04
Validation rmse = 0.817217
Epoch 15
Loss = 6.9574e-04, PNorm = 47.3207, GNorm = 0.7195, lr_0 = 3.2253e-04
Loss = 1.5608e-03, PNorm = 47.3400, GNorm = 0.6163, lr_0 = 3.1209e-04
Loss = 1.2912e-03, PNorm = 47.3562, GNorm = 0.6356, lr_0 = 3.0200e-04
Validation rmse = 0.799213
Epoch 16
Loss = 1.1058e-03, PNorm = 47.3733, GNorm = 1.6594, lr_0 = 2.9222e-04
Loss = 1.4551e-03, PNorm = 47.3889, GNorm = 2.7428, lr_0 = 2.8277e-04
Validation rmse = 0.771597
Epoch 17
Loss = 9.1707e-04, PNorm = 47.4025, GNorm = 1.4892, lr_0 = 2.7272e-04
Loss = 1.1317e-03, PNorm = 47.4132, GNorm = 0.4863, lr_0 = 2.6389e-04
Loss = 1.3751e-03, PNorm = 47.4269, GNorm = 2.3118, lr_0 = 2.5535e-04
Validation rmse = 0.732862
Epoch 18
Loss = 1.0318e-03, PNorm = 47.4398, GNorm = 0.9387, lr_0 = 2.4709e-04
Loss = 1.0994e-03, PNorm = 47.4508, GNorm = 0.6949, lr_0 = 2.3910e-04
Loss = 1.3068e-03, PNorm = 47.4620, GNorm = 2.1900, lr_0 = 2.3136e-04
Validation rmse = 0.756504
Epoch 19
Loss = 1.2048e-03, PNorm = 47.4740, GNorm = 0.8260, lr_0 = 2.2387e-04
Loss = 1.1697e-03, PNorm = 47.4860, GNorm = 0.4603, lr_0 = 2.1663e-04
Validation rmse = 0.741623
Epoch 20
Loss = 1.4785e-03, PNorm = 47.4960, GNorm = 0.9461, lr_0 = 2.0962e-04
Loss = 1.1836e-03, PNorm = 47.5061, GNorm = 2.6100, lr_0 = 2.0283e-04
Loss = 1.0636e-03, PNorm = 47.5169, GNorm = 1.3470, lr_0 = 1.9627e-04
Validation rmse = 0.729984
Epoch 21
Loss = 1.1218e-03, PNorm = 47.5281, GNorm = 1.2633, lr_0 = 1.8992e-04
Loss = 9.8259e-04, PNorm = 47.5374, GNorm = 1.1669, lr_0 = 1.8377e-04
Validation rmse = 0.753356
Epoch 22
Loss = 1.2033e-03, PNorm = 47.5451, GNorm = 0.8671, lr_0 = 1.7783e-04
Loss = 9.4884e-04, PNorm = 47.5524, GNorm = 1.3955, lr_0 = 1.7207e-04
Loss = 1.0332e-03, PNorm = 47.5603, GNorm = 0.9354, lr_0 = 1.6651e-04
Validation rmse = 0.813026
Epoch 23
Loss = 8.7889e-04, PNorm = 47.5683, GNorm = 0.7282, lr_0 = 1.6059e-04
Loss = 9.2702e-04, PNorm = 47.5759, GNorm = 0.4406, lr_0 = 1.5539e-04
Validation rmse = 0.796393
Epoch 24
Loss = 5.5994e-04, PNorm = 47.5829, GNorm = 0.4466, lr_0 = 1.5036e-04
Loss = 9.7324e-04, PNorm = 47.5900, GNorm = 0.5467, lr_0 = 1.4550e-04
Loss = 9.3784e-04, PNorm = 47.5969, GNorm = 0.4098, lr_0 = 1.4079e-04
Validation rmse = 0.763597
Epoch 25
Loss = 6.9338e-04, PNorm = 47.6037, GNorm = 0.5501, lr_0 = 1.3623e-04
Loss = 8.3925e-04, PNorm = 47.6089, GNorm = 1.0378, lr_0 = 1.3183e-04
Loss = 9.8555e-04, PNorm = 47.6152, GNorm = 0.5481, lr_0 = 1.2756e-04
Validation rmse = 0.737226
Epoch 26
Loss = 7.6564e-04, PNorm = 47.6202, GNorm = 0.5125, lr_0 = 1.2343e-04
Loss = 9.1779e-04, PNorm = 47.6265, GNorm = 0.5290, lr_0 = 1.1944e-04
Validation rmse = 0.720559
Epoch 27
Loss = 7.3025e-04, PNorm = 47.6322, GNorm = 0.6305, lr_0 = 1.1557e-04
Loss = 9.3087e-04, PNorm = 47.6381, GNorm = 1.0496, lr_0 = 1.1183e-04
Loss = 9.2584e-04, PNorm = 47.6435, GNorm = 1.3382, lr_0 = 1.0821e-04
Validation rmse = 0.757935
Epoch 28
Loss = 7.9992e-04, PNorm = 47.6481, GNorm = 0.7354, lr_0 = 1.0437e-04
Loss = 7.7705e-04, PNorm = 47.6524, GNorm = 0.5557, lr_0 = 1.0099e-04
Validation rmse = 0.751321
Epoch 29
Loss = 6.2085e-04, PNorm = 47.6581, GNorm = 0.6771, lr_0 = 1.0000e-04
Loss = 8.4832e-04, PNorm = 47.6633, GNorm = 1.6657, lr_0 = 1.0000e-04
Loss = 8.6475e-04, PNorm = 47.6681, GNorm = 1.0719, lr_0 = 1.0000e-04
Validation rmse = 0.749816
Model 0 best validation rmse = 0.720559 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.705750
Ensemble test rmse = 0.705750
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.7981e-02, PNorm = 46.0248, GNorm = 12.2868, lr_0 = 2.9800e-04
Loss = 1.2757e-02, PNorm = 46.0469, GNorm = 2.9581, lr_0 = 4.7800e-04
Validation rmse = 1.629366
Epoch 1
Loss = 9.9585e-03, PNorm = 46.0928, GNorm = 1.3182, lr_0 = 6.7600e-04
Loss = 8.0511e-03, PNorm = 46.1423, GNorm = 0.9402, lr_0 = 8.5600e-04
Loss = 6.4195e-03, PNorm = 46.1943, GNorm = 1.0652, lr_0 = 9.9344e-04
Validation rmse = 1.357491
Epoch 2
Loss = 5.8146e-03, PNorm = 46.2520, GNorm = 3.7580, lr_0 = 9.6130e-04
Loss = 4.8305e-03, PNorm = 46.3035, GNorm = 5.0850, lr_0 = 9.3019e-04
Validation rmse = 1.405679
Epoch 3
Loss = 4.3870e-03, PNorm = 46.3542, GNorm = 1.2099, lr_0 = 9.0009e-04
Loss = 4.6508e-03, PNorm = 46.4006, GNorm = 3.1282, lr_0 = 8.7096e-04
Loss = 4.4918e-03, PNorm = 46.4517, GNorm = 2.1111, lr_0 = 8.4278e-04
Validation rmse = 1.097404
Epoch 4
Loss = 3.8297e-03, PNorm = 46.4929, GNorm = 1.2367, lr_0 = 8.1551e-04
Loss = 3.5640e-03, PNorm = 46.5372, GNorm = 3.2260, lr_0 = 7.8912e-04
Validation rmse = 1.137087
Epoch 5
Loss = 2.4041e-03, PNorm = 46.5730, GNorm = 1.0806, lr_0 = 7.6358e-04
Loss = 3.2345e-03, PNorm = 46.6110, GNorm = 3.1303, lr_0 = 7.3888e-04
Loss = 3.5164e-03, PNorm = 46.6483, GNorm = 1.1012, lr_0 = 7.1497e-04
Validation rmse = 1.066371
Epoch 6
Loss = 2.8613e-03, PNorm = 46.6926, GNorm = 2.9306, lr_0 = 6.8956e-04
Loss = 2.7738e-03, PNorm = 46.7287, GNorm = 0.9762, lr_0 = 6.6725e-04
Loss = 2.8740e-03, PNorm = 46.7509, GNorm = 1.6543, lr_0 = 6.4565e-04
Validation rmse = 1.001332
Epoch 7
Loss = 2.5202e-03, PNorm = 46.7786, GNorm = 0.7480, lr_0 = 6.2476e-04
Loss = 2.2094e-03, PNorm = 46.8059, GNorm = 1.6644, lr_0 = 6.0454e-04
Validation rmse = 0.979174
Epoch 8
Loss = 2.3740e-03, PNorm = 46.8308, GNorm = 1.0863, lr_0 = 5.8498e-04
Loss = 2.2864e-03, PNorm = 46.8616, GNorm = 1.2070, lr_0 = 5.6605e-04
Loss = 1.8559e-03, PNorm = 46.8905, GNorm = 1.1572, lr_0 = 5.4774e-04
Validation rmse = 1.018070
Epoch 9
Loss = 1.9835e-03, PNorm = 46.9150, GNorm = 0.9168, lr_0 = 5.3001e-04
Loss = 2.0760e-03, PNorm = 46.9396, GNorm = 0.8526, lr_0 = 5.1286e-04
Validation rmse = 0.976118
Epoch 10
Loss = 1.8761e-03, PNorm = 46.9631, GNorm = 2.1515, lr_0 = 4.9627e-04
Loss = 2.6535e-03, PNorm = 46.9868, GNorm = 4.2441, lr_0 = 4.8021e-04
Loss = 2.2967e-03, PNorm = 47.0088, GNorm = 1.5448, lr_0 = 4.6467e-04
Validation rmse = 1.021981
Epoch 11
Loss = 2.0375e-03, PNorm = 47.0343, GNorm = 0.9472, lr_0 = 4.4963e-04
Loss = 1.8855e-03, PNorm = 47.0599, GNorm = 3.3509, lr_0 = 4.3508e-04
Validation rmse = 0.957275
Epoch 12
Loss = 1.7443e-03, PNorm = 47.0815, GNorm = 1.9819, lr_0 = 4.1962e-04
Loss = 1.6954e-03, PNorm = 47.0983, GNorm = 2.8306, lr_0 = 4.0604e-04
Loss = 1.7457e-03, PNorm = 47.1162, GNorm = 3.9762, lr_0 = 3.9290e-04
Validation rmse = 0.954317
Epoch 13
Loss = 1.8219e-03, PNorm = 47.1352, GNorm = 1.0588, lr_0 = 3.8019e-04
Loss = 1.9524e-03, PNorm = 47.1524, GNorm = 2.1267, lr_0 = 3.6789e-04
Loss = 1.7022e-03, PNorm = 47.1721, GNorm = 0.5923, lr_0 = 3.5598e-04
Validation rmse = 0.913432
Epoch 14
Loss = 1.3322e-03, PNorm = 47.1885, GNorm = 0.5664, lr_0 = 3.4446e-04
Loss = 1.4792e-03, PNorm = 47.2047, GNorm = 0.8077, lr_0 = 3.3332e-04
Validation rmse = 0.951564
Epoch 15
Loss = 1.6225e-03, PNorm = 47.2203, GNorm = 0.8859, lr_0 = 3.2253e-04
Loss = 1.3947e-03, PNorm = 47.2356, GNorm = 0.8395, lr_0 = 3.1209e-04
Loss = 1.5343e-03, PNorm = 47.2512, GNorm = 1.3059, lr_0 = 3.0200e-04
Validation rmse = 0.962080
Epoch 16
Loss = 1.3395e-03, PNorm = 47.2633, GNorm = 0.9754, lr_0 = 2.9222e-04
Loss = 1.4177e-03, PNorm = 47.2780, GNorm = 0.6539, lr_0 = 2.8277e-04
Validation rmse = 0.957471
Epoch 17
Loss = 9.9546e-04, PNorm = 47.2932, GNorm = 1.3614, lr_0 = 2.7272e-04
Loss = 1.5714e-03, PNorm = 47.3091, GNorm = 0.7019, lr_0 = 2.6389e-04
Loss = 1.3194e-03, PNorm = 47.3202, GNorm = 1.5767, lr_0 = 2.5535e-04
Validation rmse = 0.918963
Epoch 18
Loss = 1.3610e-03, PNorm = 47.3305, GNorm = 1.6702, lr_0 = 2.4709e-04
Loss = 1.4486e-03, PNorm = 47.3403, GNorm = 1.5623, lr_0 = 2.3910e-04
Loss = 1.4817e-03, PNorm = 47.3541, GNorm = 0.8988, lr_0 = 2.3136e-04
Validation rmse = 0.962340
Epoch 19
Loss = 1.2619e-03, PNorm = 47.3665, GNorm = 2.0375, lr_0 = 2.2387e-04
Loss = 1.1244e-03, PNorm = 47.3776, GNorm = 1.2818, lr_0 = 2.1663e-04
Validation rmse = 0.951654
Epoch 20
Loss = 1.1581e-03, PNorm = 47.3867, GNorm = 0.8882, lr_0 = 2.0962e-04
Loss = 1.0574e-03, PNorm = 47.3970, GNorm = 0.9427, lr_0 = 2.0283e-04
Loss = 1.3171e-03, PNorm = 47.4084, GNorm = 2.3290, lr_0 = 1.9627e-04
Validation rmse = 0.935391
Epoch 21
Loss = 9.8733e-04, PNorm = 47.4162, GNorm = 0.6528, lr_0 = 1.8992e-04
Loss = 1.2262e-03, PNorm = 47.4244, GNorm = 0.6916, lr_0 = 1.8377e-04
Validation rmse = 0.953653
Epoch 22
Loss = 1.1061e-03, PNorm = 47.4341, GNorm = 1.0923, lr_0 = 1.7783e-04
Loss = 9.8215e-04, PNorm = 47.4440, GNorm = 0.9468, lr_0 = 1.7207e-04
Loss = 1.1501e-03, PNorm = 47.4514, GNorm = 0.5945, lr_0 = 1.6651e-04
Validation rmse = 0.926243
Epoch 23
Loss = 1.0821e-03, PNorm = 47.4592, GNorm = 1.0164, lr_0 = 1.6059e-04
Loss = 1.0495e-03, PNorm = 47.4678, GNorm = 0.7214, lr_0 = 1.5539e-04
Validation rmse = 0.948453
Epoch 24
Loss = 7.0871e-04, PNorm = 47.4754, GNorm = 1.1603, lr_0 = 1.5036e-04
Loss = 1.1633e-03, PNorm = 47.4840, GNorm = 0.6957, lr_0 = 1.4550e-04
Loss = 9.8003e-04, PNorm = 47.4901, GNorm = 0.7334, lr_0 = 1.4079e-04
Validation rmse = 0.946889
Epoch 25
Loss = 8.7803e-04, PNorm = 47.4973, GNorm = 0.6449, lr_0 = 1.3623e-04
Loss = 9.9728e-04, PNorm = 47.5039, GNorm = 1.1448, lr_0 = 1.3183e-04
Loss = 1.0888e-03, PNorm = 47.5111, GNorm = 1.2204, lr_0 = 1.2756e-04
Validation rmse = 0.966954
Epoch 26
Loss = 1.0946e-03, PNorm = 47.5172, GNorm = 1.4057, lr_0 = 1.2343e-04
Loss = 9.3067e-04, PNorm = 47.5239, GNorm = 1.1301, lr_0 = 1.1944e-04
Validation rmse = 0.959837
Epoch 27
Loss = 1.2606e-03, PNorm = 47.5299, GNorm = 1.8594, lr_0 = 1.1557e-04
Loss = 9.3196e-04, PNorm = 47.5353, GNorm = 1.3262, lr_0 = 1.1183e-04
Loss = 1.0041e-03, PNorm = 47.5400, GNorm = 0.8049, lr_0 = 1.0821e-04
Validation rmse = 0.948685
Epoch 28
Loss = 1.0252e-03, PNorm = 47.5461, GNorm = 1.2242, lr_0 = 1.0437e-04
Loss = 7.6155e-04, PNorm = 47.5520, GNorm = 0.4849, lr_0 = 1.0099e-04
Validation rmse = 0.934320
Epoch 29
Loss = 4.9331e-04, PNorm = 47.5561, GNorm = 0.6241, lr_0 = 1.0000e-04
Loss = 9.1412e-04, PNorm = 47.5608, GNorm = 0.5029, lr_0 = 1.0000e-04
Loss = 8.8210e-04, PNorm = 47.5648, GNorm = 1.1491, lr_0 = 1.0000e-04
Validation rmse = 0.990777
Model 0 best validation rmse = 0.913432 on epoch 13
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.730933
Ensemble test rmse = 0.730933
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.7620e-02, PNorm = 46.0252, GNorm = 10.4119, lr_0 = 2.9800e-04
Loss = 1.3098e-02, PNorm = 46.0498, GNorm = 8.8966, lr_0 = 4.7800e-04
Validation rmse = 1.569579
Epoch 1
Loss = 7.5193e-03, PNorm = 46.0935, GNorm = 3.4565, lr_0 = 6.7600e-04
Loss = 7.5788e-03, PNorm = 46.1425, GNorm = 5.4129, lr_0 = 8.5600e-04
Loss = 6.8518e-03, PNorm = 46.2050, GNorm = 3.0697, lr_0 = 9.9344e-04
Validation rmse = 1.305424
Epoch 2
Loss = 6.1094e-03, PNorm = 46.2688, GNorm = 3.9741, lr_0 = 9.6130e-04
Loss = 4.3248e-03, PNorm = 46.3290, GNorm = 6.0177, lr_0 = 9.3019e-04
Validation rmse = 1.057883
Epoch 3
Loss = 3.8311e-03, PNorm = 46.3786, GNorm = 2.5724, lr_0 = 9.0009e-04
Loss = 4.0783e-03, PNorm = 46.4262, GNorm = 2.4205, lr_0 = 8.7096e-04
Loss = 4.6286e-03, PNorm = 46.4732, GNorm = 1.1754, lr_0 = 8.4278e-04
Validation rmse = 1.064061
Epoch 4
Loss = 4.2734e-03, PNorm = 46.5176, GNorm = 3.5055, lr_0 = 8.1551e-04
Loss = 3.9157e-03, PNorm = 46.5612, GNorm = 2.1885, lr_0 = 7.8912e-04
Validation rmse = 1.123803
Epoch 5
Loss = 3.0141e-03, PNorm = 46.6039, GNorm = 1.4195, lr_0 = 7.6358e-04
Loss = 3.3111e-03, PNorm = 46.6422, GNorm = 2.0991, lr_0 = 7.3888e-04
Loss = 2.6894e-03, PNorm = 46.6733, GNorm = 2.5217, lr_0 = 7.1497e-04
Validation rmse = 1.023449
Epoch 6
Loss = 2.4527e-03, PNorm = 46.7131, GNorm = 0.9709, lr_0 = 6.8956e-04
Loss = 2.7208e-03, PNorm = 46.7478, GNorm = 3.0218, lr_0 = 6.6725e-04
Loss = 2.3416e-03, PNorm = 46.7777, GNorm = 3.8308, lr_0 = 6.4565e-04
Validation rmse = 0.903935
Epoch 7
Loss = 1.9243e-03, PNorm = 46.8085, GNorm = 1.0630, lr_0 = 6.2476e-04
Loss = 2.2399e-03, PNorm = 46.8346, GNorm = 0.9061, lr_0 = 6.0454e-04
Validation rmse = 0.942768
Epoch 8
Loss = 2.5529e-03, PNorm = 46.8648, GNorm = 2.9431, lr_0 = 5.8498e-04
Loss = 2.0819e-03, PNorm = 46.8984, GNorm = 0.5996, lr_0 = 5.6605e-04
Loss = 1.8574e-03, PNorm = 46.9265, GNorm = 2.6304, lr_0 = 5.4774e-04
Validation rmse = 0.856418
Epoch 9
Loss = 1.4978e-03, PNorm = 46.9518, GNorm = 1.1596, lr_0 = 5.3001e-04
Loss = 1.7502e-03, PNorm = 46.9757, GNorm = 2.6389, lr_0 = 5.1286e-04
Validation rmse = 0.828847
Epoch 10
Loss = 1.7134e-03, PNorm = 47.0031, GNorm = 2.2928, lr_0 = 4.9627e-04
Loss = 1.8376e-03, PNorm = 47.0287, GNorm = 0.5340, lr_0 = 4.8021e-04
Loss = 1.9101e-03, PNorm = 47.0570, GNorm = 0.9372, lr_0 = 4.6467e-04
Validation rmse = 0.836277
Epoch 11
Loss = 1.5528e-03, PNorm = 47.0808, GNorm = 0.6249, lr_0 = 4.4963e-04
Loss = 1.6585e-03, PNorm = 47.1034, GNorm = 1.2797, lr_0 = 4.3508e-04
Validation rmse = 0.814071
Epoch 12
Loss = 1.0787e-03, PNorm = 47.1254, GNorm = 0.8621, lr_0 = 4.1962e-04
Loss = 1.6980e-03, PNorm = 47.1477, GNorm = 0.7643, lr_0 = 4.0604e-04
Loss = 1.5617e-03, PNorm = 47.1703, GNorm = 1.3738, lr_0 = 3.9290e-04
Validation rmse = 0.834885
Epoch 13
Loss = 1.4651e-03, PNorm = 47.1853, GNorm = 0.7567, lr_0 = 3.8019e-04
Loss = 1.3806e-03, PNorm = 47.2077, GNorm = 0.7305, lr_0 = 3.6789e-04
Loss = 1.5430e-03, PNorm = 47.2254, GNorm = 0.9440, lr_0 = 3.5598e-04
Validation rmse = 0.766256
Epoch 14
Loss = 1.2849e-03, PNorm = 47.2450, GNorm = 1.2762, lr_0 = 3.4446e-04
Loss = 1.2645e-03, PNorm = 47.2626, GNorm = 0.5716, lr_0 = 3.3332e-04
Validation rmse = 0.904823
Epoch 15
Loss = 2.1202e-03, PNorm = 47.2792, GNorm = 1.3340, lr_0 = 3.2253e-04
Loss = 1.4194e-03, PNorm = 47.2982, GNorm = 0.8853, lr_0 = 3.1209e-04
Loss = 1.0889e-03, PNorm = 47.3152, GNorm = 0.8843, lr_0 = 3.0200e-04
Validation rmse = 0.797970
Epoch 16
Loss = 1.1687e-03, PNorm = 47.3296, GNorm = 0.3834, lr_0 = 2.9222e-04
Loss = 1.1142e-03, PNorm = 47.3424, GNorm = 0.7466, lr_0 = 2.8277e-04
Validation rmse = 0.754069
Epoch 17
Loss = 9.8127e-04, PNorm = 47.3579, GNorm = 0.8479, lr_0 = 2.7272e-04
Loss = 1.1207e-03, PNorm = 47.3703, GNorm = 0.5832, lr_0 = 2.6389e-04
Loss = 1.0909e-03, PNorm = 47.3812, GNorm = 0.4877, lr_0 = 2.5535e-04
Validation rmse = 0.761476
Epoch 18
Loss = 1.1547e-03, PNorm = 47.3922, GNorm = 0.4204, lr_0 = 2.4709e-04
Loss = 1.1559e-03, PNorm = 47.4060, GNorm = 2.9901, lr_0 = 2.3910e-04
Loss = 1.0447e-03, PNorm = 47.4170, GNorm = 0.6139, lr_0 = 2.3136e-04
Validation rmse = 0.747838
Epoch 19
Loss = 1.1357e-03, PNorm = 47.4272, GNorm = 0.9107, lr_0 = 2.2387e-04
Loss = 1.0574e-03, PNorm = 47.4373, GNorm = 0.6964, lr_0 = 2.1663e-04
Validation rmse = 0.716267
Epoch 20
Loss = 7.8469e-04, PNorm = 47.4478, GNorm = 0.5951, lr_0 = 2.0962e-04
Loss = 1.1136e-03, PNorm = 47.4571, GNorm = 1.4031, lr_0 = 2.0283e-04
Loss = 9.6130e-04, PNorm = 47.4666, GNorm = 1.2269, lr_0 = 1.9627e-04
Validation rmse = 0.749765
Epoch 21
Loss = 9.1129e-04, PNorm = 47.4760, GNorm = 0.5518, lr_0 = 1.8992e-04
Loss = 1.0524e-03, PNorm = 47.4861, GNorm = 0.9005, lr_0 = 1.8377e-04
Validation rmse = 0.754735
Epoch 22
Loss = 8.3239e-04, PNorm = 47.4960, GNorm = 0.3599, lr_0 = 1.7783e-04
Loss = 9.2723e-04, PNorm = 47.5040, GNorm = 0.5029, lr_0 = 1.7207e-04
Loss = 9.5581e-04, PNorm = 47.5111, GNorm = 0.4698, lr_0 = 1.6651e-04
Validation rmse = 0.743740
Epoch 23
Loss = 1.0726e-03, PNorm = 47.5191, GNorm = 1.2277, lr_0 = 1.6059e-04
Loss = 8.9019e-04, PNorm = 47.5279, GNorm = 1.4520, lr_0 = 1.5539e-04
Validation rmse = 0.753238
Epoch 24
Loss = 1.1501e-03, PNorm = 47.5357, GNorm = 1.9348, lr_0 = 1.5036e-04
Loss = 1.0778e-03, PNorm = 47.5429, GNorm = 2.7327, lr_0 = 1.4550e-04
Loss = 1.1350e-03, PNorm = 47.5503, GNorm = 3.1794, lr_0 = 1.4079e-04
Validation rmse = 0.771229
Epoch 25
Loss = 8.2578e-04, PNorm = 47.5578, GNorm = 1.2769, lr_0 = 1.3623e-04
Loss = 9.5295e-04, PNorm = 47.5641, GNorm = 2.2310, lr_0 = 1.3183e-04
Loss = 1.0227e-03, PNorm = 47.5704, GNorm = 1.6264, lr_0 = 1.2756e-04
Validation rmse = 0.717461
Epoch 26
Loss = 8.9412e-04, PNorm = 47.5776, GNorm = 0.8140, lr_0 = 1.2343e-04
Loss = 8.2965e-04, PNorm = 47.5830, GNorm = 1.0808, lr_0 = 1.1944e-04
Validation rmse = 0.737938
Epoch 27
Loss = 1.0532e-03, PNorm = 47.5887, GNorm = 2.1743, lr_0 = 1.1557e-04
Loss = 8.5032e-04, PNorm = 47.5952, GNorm = 0.5217, lr_0 = 1.1183e-04
Loss = 8.0956e-04, PNorm = 47.6003, GNorm = 0.4527, lr_0 = 1.0821e-04
Validation rmse = 0.724020
Epoch 28
Loss = 8.6476e-04, PNorm = 47.6058, GNorm = 1.4284, lr_0 = 1.0437e-04
Loss = 7.9802e-04, PNorm = 47.6105, GNorm = 0.4533, lr_0 = 1.0099e-04
Validation rmse = 0.763035
Epoch 29
Loss = 8.9648e-04, PNorm = 47.6158, GNorm = 2.1604, lr_0 = 1.0000e-04
Loss = 8.9463e-04, PNorm = 47.6216, GNorm = 0.7908, lr_0 = 1.0000e-04
Loss = 7.6628e-04, PNorm = 47.6259, GNorm = 0.5454, lr_0 = 1.0000e-04
Validation rmse = 0.720304
Model 0 best validation rmse = 0.716267 on epoch 19
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.755943
Ensemble test rmse = 0.755943
10-fold cross validation
	Seed 0 ==> test rmse = 0.768308
	Seed 1 ==> test rmse = 0.696907
	Seed 2 ==> test rmse = 0.658745
	Seed 3 ==> test rmse = 0.894170
	Seed 4 ==> test rmse = 1.056610
	Seed 5 ==> test rmse = 0.673163
	Seed 6 ==> test rmse = 0.746598
	Seed 7 ==> test rmse = 0.705750
	Seed 8 ==> test rmse = 0.730933
	Seed 9 ==> test rmse = 0.755943
Overall test rmse = 0.768713 +/- 0.114476
Elapsed time = 0:08:15
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.6796e-02, PNorm = 65.0286, GNorm = 9.0341, lr_0 = 2.9800e-04
Loss = 1.3104e-02, PNorm = 65.0752, GNorm = 3.2914, lr_0 = 4.7800e-04
Validation rmse = 1.648737
Epoch 1
Loss = 8.7812e-03, PNorm = 65.1500, GNorm = 4.6956, lr_0 = 6.7600e-04
Loss = 8.2752e-03, PNorm = 65.2400, GNorm = 7.8968, lr_0 = 8.5600e-04
Loss = 8.5346e-03, PNorm = 65.3515, GNorm = 1.7634, lr_0 = 9.9344e-04
Validation rmse = 1.299464
Epoch 2
Loss = 7.8983e-03, PNorm = 65.4734, GNorm = 2.6336, lr_0 = 9.6130e-04
Loss = 5.9847e-03, PNorm = 65.5715, GNorm = 1.5169, lr_0 = 9.3019e-04
Validation rmse = 1.228157
Epoch 3
Loss = 5.1821e-03, PNorm = 65.6625, GNorm = 1.8567, lr_0 = 9.0009e-04
Loss = 4.3346e-03, PNorm = 65.7513, GNorm = 0.8090, lr_0 = 8.7096e-04
Loss = 4.7518e-03, PNorm = 65.8222, GNorm = 4.1643, lr_0 = 8.4278e-04
Validation rmse = 1.135552
Epoch 4
Loss = 3.6934e-03, PNorm = 65.8914, GNorm = 0.6875, lr_0 = 8.1551e-04
Loss = 4.3633e-03, PNorm = 65.9448, GNorm = 3.8868, lr_0 = 7.8912e-04
Validation rmse = 1.413472
Epoch 5
Loss = 7.2466e-03, PNorm = 66.0002, GNorm = 5.0446, lr_0 = 7.6358e-04
Loss = 4.6733e-03, PNorm = 66.0600, GNorm = 2.0303, lr_0 = 7.3888e-04
Loss = 3.9494e-03, PNorm = 66.1161, GNorm = 2.1931, lr_0 = 7.1497e-04
Validation rmse = 0.962626
Epoch 6
Loss = 2.9934e-03, PNorm = 66.1718, GNorm = 0.8495, lr_0 = 6.8956e-04
Loss = 3.4236e-03, PNorm = 66.2145, GNorm = 0.7045, lr_0 = 6.6725e-04
Loss = 2.8181e-03, PNorm = 66.2461, GNorm = 2.0391, lr_0 = 6.4565e-04
Validation rmse = 0.976233
Epoch 7
Loss = 2.3782e-03, PNorm = 66.2856, GNorm = 1.2108, lr_0 = 6.2476e-04
Loss = 2.4376e-03, PNorm = 66.3199, GNorm = 1.1131, lr_0 = 6.0454e-04
Validation rmse = 0.894881
Epoch 8
Loss = 2.1477e-03, PNorm = 66.3502, GNorm = 0.7140, lr_0 = 5.8498e-04
Loss = 2.5396e-03, PNorm = 66.3789, GNorm = 1.5626, lr_0 = 5.6605e-04
Loss = 2.0162e-03, PNorm = 66.4171, GNorm = 2.1894, lr_0 = 5.4774e-04
Validation rmse = 0.936461
Epoch 9
Loss = 1.9487e-03, PNorm = 66.4518, GNorm = 1.5850, lr_0 = 5.3001e-04
Loss = 2.0870e-03, PNorm = 66.4784, GNorm = 1.7820, lr_0 = 5.1286e-04
Validation rmse = 0.858755
Epoch 10
Loss = 2.0369e-03, PNorm = 66.5064, GNorm = 1.6802, lr_0 = 4.9627e-04
Loss = 2.1091e-03, PNorm = 66.5444, GNorm = 1.7838, lr_0 = 4.8021e-04
Loss = 1.8634e-03, PNorm = 66.5754, GNorm = 1.9770, lr_0 = 4.6467e-04
Validation rmse = 0.882422
Epoch 11
Loss = 1.7453e-03, PNorm = 66.5928, GNorm = 0.7715, lr_0 = 4.4963e-04
Loss = 1.5171e-03, PNorm = 66.6208, GNorm = 0.5720, lr_0 = 4.3508e-04
Validation rmse = 0.880178
Epoch 12
Loss = 1.7614e-03, PNorm = 66.6514, GNorm = 1.1706, lr_0 = 4.1962e-04
Loss = 1.7992e-03, PNorm = 66.6720, GNorm = 1.2679, lr_0 = 4.0604e-04
Loss = 1.7375e-03, PNorm = 66.6983, GNorm = 2.5705, lr_0 = 3.9290e-04
Validation rmse = 0.803367
Epoch 13
Loss = 1.6496e-03, PNorm = 66.7235, GNorm = 2.0936, lr_0 = 3.8019e-04
Loss = 1.6259e-03, PNorm = 66.7476, GNorm = 1.2734, lr_0 = 3.6789e-04
Loss = 1.4870e-03, PNorm = 66.7686, GNorm = 1.2148, lr_0 = 3.5598e-04
Validation rmse = 0.830383
Epoch 14
Loss = 1.4478e-03, PNorm = 66.7873, GNorm = 1.2605, lr_0 = 3.4446e-04
Loss = 1.1826e-03, PNorm = 66.8056, GNorm = 1.8652, lr_0 = 3.3332e-04
Validation rmse = 0.821796
Epoch 15
Loss = 1.4056e-03, PNorm = 66.8246, GNorm = 2.1940, lr_0 = 3.2253e-04
Loss = 1.5647e-03, PNorm = 66.8410, GNorm = 1.8712, lr_0 = 3.1209e-04
Loss = 1.6899e-03, PNorm = 66.8635, GNorm = 2.8280, lr_0 = 3.0200e-04
Validation rmse = 0.829350
Epoch 16
Loss = 1.2105e-03, PNorm = 66.8830, GNorm = 0.6003, lr_0 = 2.9222e-04
Loss = 1.3229e-03, PNorm = 66.8987, GNorm = 1.9274, lr_0 = 2.8277e-04
Validation rmse = 0.809200
Epoch 17
Loss = 1.3467e-03, PNorm = 66.9129, GNorm = 0.5798, lr_0 = 2.7272e-04
Loss = 1.2638e-03, PNorm = 66.9286, GNorm = 1.5982, lr_0 = 2.6389e-04
Loss = 1.2837e-03, PNorm = 66.9469, GNorm = 1.4919, lr_0 = 2.5535e-04
Validation rmse = 0.799748
Epoch 18
Loss = 1.1870e-03, PNorm = 66.9597, GNorm = 0.4258, lr_0 = 2.4709e-04
Loss = 1.0564e-03, PNorm = 66.9714, GNorm = 2.2136, lr_0 = 2.3910e-04
Loss = 1.1370e-03, PNorm = 66.9855, GNorm = 0.5394, lr_0 = 2.3136e-04
Validation rmse = 0.764183
Epoch 19
Loss = 1.0571e-03, PNorm = 67.0026, GNorm = 0.4083, lr_0 = 2.2387e-04
Loss = 1.1508e-03, PNorm = 67.0146, GNorm = 2.2276, lr_0 = 2.1663e-04
Validation rmse = 0.786048
Epoch 20
Loss = 8.3514e-04, PNorm = 67.0277, GNorm = 1.2654, lr_0 = 2.0962e-04
Loss = 1.0511e-03, PNorm = 67.0382, GNorm = 0.5025, lr_0 = 2.0283e-04
Loss = 9.8884e-04, PNorm = 67.0503, GNorm = 0.3942, lr_0 = 1.9627e-04
Validation rmse = 0.803580
Epoch 21
Loss = 9.7332e-04, PNorm = 67.0613, GNorm = 1.5798, lr_0 = 1.8992e-04
Loss = 9.4345e-04, PNorm = 67.0701, GNorm = 0.7461, lr_0 = 1.8377e-04
Validation rmse = 0.777675
Epoch 22
Loss = 9.2200e-04, PNorm = 67.0822, GNorm = 0.4955, lr_0 = 1.7783e-04
Loss = 9.4817e-04, PNorm = 67.0910, GNorm = 1.1203, lr_0 = 1.7207e-04
Loss = 9.7692e-04, PNorm = 67.0994, GNorm = 0.5962, lr_0 = 1.6651e-04
Validation rmse = 0.809118
Epoch 23
Loss = 8.9822e-04, PNorm = 67.1094, GNorm = 0.9458, lr_0 = 1.6059e-04
Loss = 1.0555e-03, PNorm = 67.1188, GNorm = 1.7458, lr_0 = 1.5539e-04
Validation rmse = 0.772158
Epoch 24
Loss = 9.3856e-04, PNorm = 67.1280, GNorm = 0.9462, lr_0 = 1.5036e-04
Loss = 9.0368e-04, PNorm = 67.1354, GNorm = 1.1047, lr_0 = 1.4550e-04
Loss = 9.7508e-04, PNorm = 67.1428, GNorm = 0.5613, lr_0 = 1.4079e-04
Validation rmse = 0.795961
Epoch 25
Loss = 7.7718e-04, PNorm = 67.1514, GNorm = 0.4396, lr_0 = 1.3623e-04
Loss = 9.4976e-04, PNorm = 67.1587, GNorm = 0.5661, lr_0 = 1.3183e-04
Loss = 9.4014e-04, PNorm = 67.1659, GNorm = 0.7016, lr_0 = 1.2756e-04
Validation rmse = 0.812698
Epoch 26
Loss = 7.4492e-04, PNorm = 67.1734, GNorm = 0.8835, lr_0 = 1.2343e-04
Loss = 8.9654e-04, PNorm = 67.1788, GNorm = 0.4953, lr_0 = 1.1944e-04
Validation rmse = 0.772120
Epoch 27
Loss = 9.2717e-04, PNorm = 67.1863, GNorm = 0.7753, lr_0 = 1.1557e-04
Loss = 8.9937e-04, PNorm = 67.1931, GNorm = 1.1462, lr_0 = 1.1183e-04
Loss = 8.5742e-04, PNorm = 67.1989, GNorm = 0.5222, lr_0 = 1.0821e-04
Validation rmse = 0.782846
Epoch 28
Loss = 8.8237e-04, PNorm = 67.2062, GNorm = 0.4070, lr_0 = 1.0437e-04
Loss = 7.1741e-04, PNorm = 67.2128, GNorm = 0.4490, lr_0 = 1.0099e-04
Validation rmse = 0.791382
Epoch 29
Loss = 9.8745e-04, PNorm = 67.2175, GNorm = 1.2690, lr_0 = 1.0000e-04
Loss = 7.8204e-04, PNorm = 67.2236, GNorm = 0.6823, lr_0 = 1.0000e-04
Loss = 9.2518e-04, PNorm = 67.2290, GNorm = 2.3619, lr_0 = 1.0000e-04
Validation rmse = 0.789120
Model 0 best validation rmse = 0.764183 on epoch 18
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.784245
Ensemble test rmse = 0.784245
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.8787e-02, PNorm = 65.0280, GNorm = 6.9678, lr_0 = 2.9800e-04
Loss = 1.0667e-02, PNorm = 65.0739, GNorm = 12.0808, lr_0 = 4.7800e-04
Validation rmse = 1.803751
Epoch 1
Loss = 8.5085e-03, PNorm = 65.1408, GNorm = 3.2410, lr_0 = 6.7600e-04
Loss = 1.1151e-02, PNorm = 65.2290, GNorm = 2.8984, lr_0 = 8.5600e-04
Loss = 7.0968e-03, PNorm = 65.3344, GNorm = 0.6962, lr_0 = 9.9344e-04
Validation rmse = 1.468622
Epoch 2
Loss = 7.0382e-03, PNorm = 65.4404, GNorm = 6.1990, lr_0 = 9.6130e-04
Loss = 7.4657e-03, PNorm = 65.5403, GNorm = 1.2127, lr_0 = 9.3019e-04
Validation rmse = 1.296833
Epoch 3
Loss = 5.1187e-03, PNorm = 65.6313, GNorm = 2.3065, lr_0 = 9.0009e-04
Loss = 6.0545e-03, PNorm = 65.7144, GNorm = 1.6718, lr_0 = 8.7096e-04
Loss = 3.9585e-03, PNorm = 65.7903, GNorm = 2.2790, lr_0 = 8.4278e-04
Validation rmse = 0.979218
Epoch 4
Loss = 4.4357e-03, PNorm = 65.8538, GNorm = 2.1358, lr_0 = 8.1551e-04
Loss = 3.1152e-03, PNorm = 65.9193, GNorm = 1.7671, lr_0 = 7.8912e-04
Validation rmse = 0.882448
Epoch 5
Loss = 3.0942e-03, PNorm = 65.9695, GNorm = 2.0463, lr_0 = 7.6358e-04
Loss = 3.5099e-03, PNorm = 66.0190, GNorm = 3.0454, lr_0 = 7.3888e-04
Loss = 3.0356e-03, PNorm = 66.0647, GNorm = 1.5294, lr_0 = 7.1497e-04
Validation rmse = 1.226560
Epoch 6
Loss = 4.7802e-03, PNorm = 66.1111, GNorm = 2.4086, lr_0 = 6.8956e-04
Loss = 3.1634e-03, PNorm = 66.1570, GNorm = 2.1705, lr_0 = 6.6725e-04
Loss = 2.7726e-03, PNorm = 66.1971, GNorm = 1.7304, lr_0 = 6.4565e-04
Validation rmse = 0.849454
Epoch 7
Loss = 2.9002e-03, PNorm = 66.2357, GNorm = 2.6221, lr_0 = 6.2476e-04
Loss = 3.0283e-03, PNorm = 66.2711, GNorm = 6.7588, lr_0 = 6.0454e-04
Validation rmse = 1.105580
Epoch 8
Loss = 4.2154e-03, PNorm = 66.3168, GNorm = 4.7702, lr_0 = 5.8498e-04
Loss = 2.8754e-03, PNorm = 66.3616, GNorm = 0.8623, lr_0 = 5.6605e-04
Loss = 2.5755e-03, PNorm = 66.3968, GNorm = 2.9015, lr_0 = 5.4774e-04
Validation rmse = 0.833595
Epoch 9
Loss = 2.0359e-03, PNorm = 66.4274, GNorm = 1.2136, lr_0 = 5.3001e-04
Loss = 2.3642e-03, PNorm = 66.4611, GNorm = 0.9918, lr_0 = 5.1286e-04
Validation rmse = 0.850836
Epoch 10
Loss = 2.4215e-03, PNorm = 66.4854, GNorm = 3.6295, lr_0 = 4.9627e-04
Loss = 3.1795e-03, PNorm = 66.5146, GNorm = 3.4505, lr_0 = 4.8021e-04
Loss = 2.2853e-03, PNorm = 66.5464, GNorm = 1.7038, lr_0 = 4.6467e-04
Validation rmse = 0.873561
Epoch 11
Loss = 2.4591e-03, PNorm = 66.5788, GNorm = 1.0958, lr_0 = 4.4963e-04
Loss = 2.4338e-03, PNorm = 66.6046, GNorm = 0.8701, lr_0 = 4.3508e-04
Validation rmse = 0.782268
Epoch 12
Loss = 2.5084e-03, PNorm = 66.6357, GNorm = 1.7770, lr_0 = 4.1962e-04
Loss = 1.9645e-03, PNorm = 66.6636, GNorm = 1.5098, lr_0 = 4.0604e-04
Loss = 2.2568e-03, PNorm = 66.6894, GNorm = 0.9815, lr_0 = 3.9290e-04
Validation rmse = 0.944719
Epoch 13
Loss = 2.1844e-03, PNorm = 66.7140, GNorm = 1.2570, lr_0 = 3.8019e-04
Loss = 2.5849e-03, PNorm = 66.7357, GNorm = 2.3949, lr_0 = 3.6789e-04
Loss = 2.0041e-03, PNorm = 66.7530, GNorm = 0.7980, lr_0 = 3.5598e-04
Validation rmse = 0.712269
Epoch 14
Loss = 1.6223e-03, PNorm = 66.7739, GNorm = 0.6510, lr_0 = 3.4446e-04
Loss = 1.6022e-03, PNorm = 66.7915, GNorm = 2.0303, lr_0 = 3.3332e-04
Validation rmse = 0.767774
Epoch 15
Loss = 1.4052e-03, PNorm = 66.8106, GNorm = 0.5235, lr_0 = 3.2253e-04
Loss = 1.7246e-03, PNorm = 66.8260, GNorm = 2.5214, lr_0 = 3.1209e-04
Loss = 2.1142e-03, PNorm = 66.8464, GNorm = 1.1426, lr_0 = 3.0200e-04
Validation rmse = 0.750157
Epoch 16
Loss = 2.0393e-03, PNorm = 66.8658, GNorm = 1.0957, lr_0 = 2.9222e-04
Loss = 1.3390e-03, PNorm = 66.8829, GNorm = 0.6211, lr_0 = 2.8277e-04
Validation rmse = 0.675916
Epoch 17
Loss = 1.1567e-03, PNorm = 66.8994, GNorm = 0.3971, lr_0 = 2.7272e-04
Loss = 1.4842e-03, PNorm = 66.9157, GNorm = 0.4996, lr_0 = 2.6389e-04
Loss = 1.3708e-03, PNorm = 66.9310, GNorm = 1.5617, lr_0 = 2.5535e-04
Validation rmse = 0.695408
Epoch 18
Loss = 1.3894e-03, PNorm = 66.9446, GNorm = 0.6852, lr_0 = 2.4709e-04
Loss = 1.3847e-03, PNorm = 66.9603, GNorm = 0.7805, lr_0 = 2.3910e-04
Loss = 1.3379e-03, PNorm = 66.9758, GNorm = 1.0405, lr_0 = 2.3136e-04
Validation rmse = 0.681063
Epoch 19
Loss = 1.2730e-03, PNorm = 66.9866, GNorm = 1.6803, lr_0 = 2.2387e-04
Loss = 1.2943e-03, PNorm = 67.0007, GNorm = 0.5778, lr_0 = 2.1663e-04
Validation rmse = 0.676344
Epoch 20
Loss = 1.0333e-03, PNorm = 67.0159, GNorm = 0.5618, lr_0 = 2.0962e-04
Loss = 1.5270e-03, PNorm = 67.0314, GNorm = 0.9898, lr_0 = 2.0283e-04
Loss = 1.2112e-03, PNorm = 67.0431, GNorm = 0.6291, lr_0 = 1.9627e-04
Validation rmse = 0.708401
Epoch 21
Loss = 1.1413e-03, PNorm = 67.0547, GNorm = 0.4972, lr_0 = 1.8992e-04
Loss = 1.2653e-03, PNorm = 67.0672, GNorm = 1.8301, lr_0 = 1.8377e-04
Validation rmse = 0.655040
Epoch 22
Loss = 9.9364e-04, PNorm = 67.0779, GNorm = 1.3875, lr_0 = 1.7783e-04
Loss = 1.0918e-03, PNorm = 67.0861, GNorm = 0.5470, lr_0 = 1.7207e-04
Loss = 1.2747e-03, PNorm = 67.0960, GNorm = 1.4436, lr_0 = 1.6651e-04
Validation rmse = 0.660553
Epoch 23
Loss = 9.5059e-04, PNorm = 67.1085, GNorm = 1.2568, lr_0 = 1.6059e-04
Loss = 1.1466e-03, PNorm = 67.1198, GNorm = 1.2239, lr_0 = 1.5539e-04
Validation rmse = 0.725806
Epoch 24
Loss = 1.1809e-03, PNorm = 67.1282, GNorm = 1.5957, lr_0 = 1.5036e-04
Loss = 1.3710e-03, PNorm = 67.1373, GNorm = 1.6998, lr_0 = 1.4550e-04
Loss = 1.2357e-03, PNorm = 67.1496, GNorm = 1.5300, lr_0 = 1.4079e-04
Validation rmse = 0.719202
Epoch 25
Loss = 1.0159e-03, PNorm = 67.1596, GNorm = 0.4257, lr_0 = 1.3623e-04
Loss = 1.1670e-03, PNorm = 67.1693, GNorm = 1.0945, lr_0 = 1.3183e-04
Loss = 1.2698e-03, PNorm = 67.1787, GNorm = 0.4982, lr_0 = 1.2756e-04
Validation rmse = 0.655816
Epoch 26
Loss = 1.1098e-03, PNorm = 67.1855, GNorm = 0.6633, lr_0 = 1.2343e-04
Loss = 1.0952e-03, PNorm = 67.1951, GNorm = 1.0670, lr_0 = 1.1944e-04
Validation rmse = 0.645061
Epoch 27
Loss = 1.0997e-03, PNorm = 67.2018, GNorm = 0.5049, lr_0 = 1.1557e-04
Loss = 9.6721e-04, PNorm = 67.2094, GNorm = 1.8366, lr_0 = 1.1183e-04
Loss = 1.1433e-03, PNorm = 67.2174, GNorm = 0.3070, lr_0 = 1.0821e-04
Validation rmse = 0.658366
Epoch 28
Loss = 1.1490e-03, PNorm = 67.2258, GNorm = 0.8556, lr_0 = 1.0437e-04
Loss = 9.2978e-04, PNorm = 67.2325, GNorm = 0.6269, lr_0 = 1.0099e-04
Validation rmse = 0.654881
Epoch 29
Loss = 9.8947e-04, PNorm = 67.2393, GNorm = 1.2297, lr_0 = 1.0000e-04
Loss = 1.0329e-03, PNorm = 67.2457, GNorm = 1.1351, lr_0 = 1.0000e-04
Loss = 1.0095e-03, PNorm = 67.2527, GNorm = 0.6496, lr_0 = 1.0000e-04
Validation rmse = 0.656244
Model 0 best validation rmse = 0.645061 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.680039
Ensemble test rmse = 0.680039
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.9799e-02, PNorm = 65.0262, GNorm = 2.3703, lr_0 = 2.9800e-04
Loss = 1.4467e-02, PNorm = 65.0718, GNorm = 6.5133, lr_0 = 4.7800e-04
Validation rmse = 1.374839
Epoch 1
Loss = 8.8153e-03, PNorm = 65.1587, GNorm = 6.4513, lr_0 = 6.7600e-04
Loss = 7.9238e-03, PNorm = 65.2384, GNorm = 2.9269, lr_0 = 8.5600e-04
Loss = 9.1247e-03, PNorm = 65.3544, GNorm = 4.8299, lr_0 = 9.9344e-04
Validation rmse = 1.547061
Epoch 2
Loss = 7.7423e-03, PNorm = 65.4831, GNorm = 3.7423, lr_0 = 9.6130e-04
Loss = 6.4854e-03, PNorm = 65.5938, GNorm = 1.8871, lr_0 = 9.3019e-04
Validation rmse = 0.981145
Epoch 3
Loss = 4.5867e-03, PNorm = 65.6924, GNorm = 0.6363, lr_0 = 9.0009e-04
Loss = 3.9750e-03, PNorm = 65.7771, GNorm = 2.2907, lr_0 = 8.7096e-04
Loss = 4.1127e-03, PNorm = 65.8462, GNorm = 1.4758, lr_0 = 8.4278e-04
Validation rmse = 0.932015
Epoch 4
Loss = 4.5483e-03, PNorm = 65.9175, GNorm = 2.9889, lr_0 = 8.1551e-04
Loss = 4.8438e-03, PNorm = 65.9850, GNorm = 3.4584, lr_0 = 7.8912e-04
Validation rmse = 0.850569
Epoch 5
Loss = 2.9846e-03, PNorm = 66.0414, GNorm = 0.5056, lr_0 = 7.6358e-04
Loss = 3.9337e-03, PNorm = 66.1013, GNorm = 1.2210, lr_0 = 7.3888e-04
Loss = 3.3103e-03, PNorm = 66.1637, GNorm = 0.8119, lr_0 = 7.1497e-04
Validation rmse = 0.794986
Epoch 6
Loss = 3.4354e-03, PNorm = 66.2133, GNorm = 2.1060, lr_0 = 6.8956e-04
Loss = 2.8438e-03, PNorm = 66.2562, GNorm = 0.8192, lr_0 = 6.6725e-04
Loss = 3.3520e-03, PNorm = 66.3019, GNorm = 0.9895, lr_0 = 6.4565e-04
Validation rmse = 0.833015
Epoch 7
Loss = 2.7703e-03, PNorm = 66.3412, GNorm = 2.8627, lr_0 = 6.2476e-04
Loss = 2.4503e-03, PNorm = 66.3803, GNorm = 1.0457, lr_0 = 6.0454e-04
Validation rmse = 0.753990
Epoch 8
Loss = 2.4150e-03, PNorm = 66.4179, GNorm = 0.5499, lr_0 = 5.8498e-04
Loss = 2.1074e-03, PNorm = 66.4503, GNorm = 0.4781, lr_0 = 5.6605e-04
Loss = 2.3975e-03, PNorm = 66.4856, GNorm = 1.6279, lr_0 = 5.4774e-04
Validation rmse = 0.747285
Epoch 9
Loss = 2.5512e-03, PNorm = 66.5240, GNorm = 0.8064, lr_0 = 5.3001e-04
Loss = 2.5535e-03, PNorm = 66.5533, GNorm = 1.8146, lr_0 = 5.1286e-04
Validation rmse = 0.767130
Epoch 10
Loss = 2.0509e-03, PNorm = 66.5813, GNorm = 2.0138, lr_0 = 4.9627e-04
Loss = 2.0216e-03, PNorm = 66.6074, GNorm = 0.4574, lr_0 = 4.8021e-04
Loss = 2.3911e-03, PNorm = 66.6444, GNorm = 2.5030, lr_0 = 4.6467e-04
Validation rmse = 0.713444
Epoch 11
Loss = 1.9430e-03, PNorm = 66.6680, GNorm = 1.9741, lr_0 = 4.4963e-04
Loss = 1.9258e-03, PNorm = 66.6975, GNorm = 1.0027, lr_0 = 4.3508e-04
Validation rmse = 0.710441
Epoch 12
Loss = 1.1383e-03, PNorm = 66.7219, GNorm = 0.8586, lr_0 = 4.1962e-04
Loss = 1.9216e-03, PNorm = 66.7417, GNorm = 2.4567, lr_0 = 4.0604e-04
Loss = 1.5273e-03, PNorm = 66.7662, GNorm = 0.4949, lr_0 = 3.9290e-04
Validation rmse = 0.693466
Epoch 13
Loss = 1.5605e-03, PNorm = 66.7902, GNorm = 0.5810, lr_0 = 3.8019e-04
Loss = 1.7026e-03, PNorm = 66.8141, GNorm = 4.0466, lr_0 = 3.6789e-04
Loss = 2.3749e-03, PNorm = 66.8385, GNorm = 2.3742, lr_0 = 3.5598e-04
Validation rmse = 0.777321
Epoch 14
Loss = 1.6872e-03, PNorm = 66.8585, GNorm = 0.3925, lr_0 = 3.4446e-04
Loss = 1.6636e-03, PNorm = 66.8823, GNorm = 0.9490, lr_0 = 3.3332e-04
Validation rmse = 0.809027
Epoch 15
Loss = 1.9087e-03, PNorm = 66.8978, GNorm = 0.5084, lr_0 = 3.2253e-04
Loss = 1.4348e-03, PNorm = 66.9121, GNorm = 0.3601, lr_0 = 3.1209e-04
Loss = 2.0518e-03, PNorm = 66.9328, GNorm = 2.4895, lr_0 = 3.0200e-04
Validation rmse = 0.689530
Epoch 16
Loss = 1.5589e-03, PNorm = 66.9501, GNorm = 1.7886, lr_0 = 2.9222e-04
Loss = 1.4906e-03, PNorm = 66.9675, GNorm = 0.9276, lr_0 = 2.8277e-04
Validation rmse = 0.681771
Epoch 17
Loss = 1.3246e-03, PNorm = 66.9875, GNorm = 2.9224, lr_0 = 2.7272e-04
Loss = 1.2234e-03, PNorm = 67.0049, GNorm = 0.4079, lr_0 = 2.6389e-04
Loss = 1.4696e-03, PNorm = 67.0210, GNorm = 2.3767, lr_0 = 2.5535e-04
Validation rmse = 0.693565
Epoch 18
Loss = 1.4126e-03, PNorm = 67.0341, GNorm = 0.5941, lr_0 = 2.4709e-04
Loss = 1.4030e-03, PNorm = 67.0494, GNorm = 0.7324, lr_0 = 2.3910e-04
Loss = 1.2949e-03, PNorm = 67.0605, GNorm = 0.7997, lr_0 = 2.3136e-04
Validation rmse = 0.678694
Epoch 19
Loss = 1.4565e-03, PNorm = 67.0738, GNorm = 1.2867, lr_0 = 2.2387e-04
Loss = 1.2549e-03, PNorm = 67.0852, GNorm = 1.0318, lr_0 = 2.1663e-04
Validation rmse = 0.687870
Epoch 20
Loss = 1.2730e-03, PNorm = 67.0983, GNorm = 1.7215, lr_0 = 2.0962e-04
Loss = 1.0673e-03, PNorm = 67.1119, GNorm = 0.5489, lr_0 = 2.0283e-04
Loss = 1.1267e-03, PNorm = 67.1215, GNorm = 0.3839, lr_0 = 1.9627e-04
Validation rmse = 0.685645
Epoch 21
Loss = 1.1408e-03, PNorm = 67.1308, GNorm = 0.6117, lr_0 = 1.8992e-04
Loss = 1.2250e-03, PNorm = 67.1419, GNorm = 1.4318, lr_0 = 1.8377e-04
Validation rmse = 0.687594
Epoch 22
Loss = 9.2477e-04, PNorm = 67.1522, GNorm = 1.3175, lr_0 = 1.7783e-04
Loss = 1.2773e-03, PNorm = 67.1643, GNorm = 0.4859, lr_0 = 1.7207e-04
Loss = 1.1167e-03, PNorm = 67.1750, GNorm = 0.4758, lr_0 = 1.6651e-04
Validation rmse = 0.668568
Epoch 23
Loss = 1.0902e-03, PNorm = 67.1864, GNorm = 0.5728, lr_0 = 1.6059e-04
Loss = 1.1267e-03, PNorm = 67.1943, GNorm = 1.0911, lr_0 = 1.5539e-04
Validation rmse = 0.681236
Epoch 24
Loss = 1.3298e-03, PNorm = 67.2022, GNorm = 1.2654, lr_0 = 1.5036e-04
Loss = 1.0128e-03, PNorm = 67.2115, GNorm = 0.5051, lr_0 = 1.4550e-04
Loss = 1.0012e-03, PNorm = 67.2200, GNorm = 2.1921, lr_0 = 1.4079e-04
Validation rmse = 0.666671
Epoch 25
Loss = 1.1492e-03, PNorm = 67.2276, GNorm = 2.6841, lr_0 = 1.3623e-04
Loss = 1.0807e-03, PNorm = 67.2377, GNorm = 0.6869, lr_0 = 1.3183e-04
Loss = 9.9536e-04, PNorm = 67.2449, GNorm = 0.8826, lr_0 = 1.2756e-04
Validation rmse = 0.670339
Epoch 26
Loss = 8.9941e-04, PNorm = 67.2540, GNorm = 1.5972, lr_0 = 1.2343e-04
Loss = 9.7494e-04, PNorm = 67.2600, GNorm = 0.3421, lr_0 = 1.1944e-04
Validation rmse = 0.671198
Epoch 27
Loss = 1.0714e-03, PNorm = 67.2671, GNorm = 0.5589, lr_0 = 1.1557e-04
Loss = 1.0581e-03, PNorm = 67.2750, GNorm = 0.5340, lr_0 = 1.1183e-04
Loss = 8.7450e-04, PNorm = 67.2821, GNorm = 1.0540, lr_0 = 1.0821e-04
Validation rmse = 0.685640
Epoch 28
Loss = 9.2248e-04, PNorm = 67.2883, GNorm = 0.4323, lr_0 = 1.0437e-04
Loss = 9.8887e-04, PNorm = 67.2934, GNorm = 0.8308, lr_0 = 1.0099e-04
Validation rmse = 0.674639
Epoch 29
Loss = 1.1448e-03, PNorm = 67.2997, GNorm = 0.7643, lr_0 = 1.0000e-04
Loss = 9.2694e-04, PNorm = 67.3061, GNorm = 1.6634, lr_0 = 1.0000e-04
Loss = 8.0804e-04, PNorm = 67.3111, GNorm = 0.3413, lr_0 = 1.0000e-04
Validation rmse = 0.673485
Model 0 best validation rmse = 0.666671 on epoch 24
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.684674
Ensemble test rmse = 0.684674
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.8275e-02, PNorm = 65.0269, GNorm = 5.2131, lr_0 = 2.9800e-04
Loss = 1.0732e-02, PNorm = 65.0771, GNorm = 4.1674, lr_0 = 4.7800e-04
Validation rmse = 1.542571
Epoch 1
Loss = 1.1245e-02, PNorm = 65.1486, GNorm = 6.1713, lr_0 = 6.7600e-04
Loss = 9.6703e-03, PNorm = 65.2465, GNorm = 1.3734, lr_0 = 8.5600e-04
Loss = 7.5293e-03, PNorm = 65.3648, GNorm = 2.7308, lr_0 = 9.9344e-04
Validation rmse = 1.475447
Epoch 2
Loss = 8.3763e-03, PNorm = 65.4846, GNorm = 1.4227, lr_0 = 9.6130e-04
Loss = 5.2440e-03, PNorm = 65.5908, GNorm = 1.3840, lr_0 = 9.3019e-04
Validation rmse = 1.096334
Epoch 3
Loss = 4.3594e-03, PNorm = 65.6768, GNorm = 1.7271, lr_0 = 9.0009e-04
Loss = 4.4483e-03, PNorm = 65.7686, GNorm = 2.0379, lr_0 = 8.7096e-04
Loss = 5.1717e-03, PNorm = 65.8443, GNorm = 3.6703, lr_0 = 8.4278e-04
Validation rmse = 0.983074
Epoch 4
Loss = 4.0526e-03, PNorm = 65.9036, GNorm = 4.7379, lr_0 = 8.1551e-04
Loss = 4.0432e-03, PNorm = 65.9680, GNorm = 1.8494, lr_0 = 7.8912e-04
Validation rmse = 0.974214
Epoch 5
Loss = 3.9294e-03, PNorm = 66.0210, GNorm = 2.4351, lr_0 = 7.6358e-04
Loss = 2.8188e-03, PNorm = 66.0697, GNorm = 0.7499, lr_0 = 7.3888e-04
Loss = 3.3568e-03, PNorm = 66.1137, GNorm = 2.0377, lr_0 = 7.1497e-04
Validation rmse = 0.923683
Epoch 6
Loss = 3.0706e-03, PNorm = 66.1667, GNorm = 1.9067, lr_0 = 6.8956e-04
Loss = 3.2555e-03, PNorm = 66.2086, GNorm = 0.9756, lr_0 = 6.6725e-04
Loss = 3.0367e-03, PNorm = 66.2461, GNorm = 2.9169, lr_0 = 6.4565e-04
Validation rmse = 1.004690
Epoch 7
Loss = 2.8201e-03, PNorm = 66.2846, GNorm = 2.6495, lr_0 = 6.2476e-04
Loss = 3.1025e-03, PNorm = 66.3205, GNorm = 1.4690, lr_0 = 6.0454e-04
Validation rmse = 0.785530
Epoch 8
Loss = 2.1563e-03, PNorm = 66.3553, GNorm = 1.4120, lr_0 = 5.8498e-04
Loss = 2.3439e-03, PNorm = 66.3915, GNorm = 2.4422, lr_0 = 5.6605e-04
Loss = 2.0591e-03, PNorm = 66.4261, GNorm = 1.1908, lr_0 = 5.4774e-04
Validation rmse = 0.755332
Epoch 9
Loss = 1.9795e-03, PNorm = 66.4527, GNorm = 0.5754, lr_0 = 5.3001e-04
Loss = 2.1336e-03, PNorm = 66.4851, GNorm = 1.3117, lr_0 = 5.1286e-04
Validation rmse = 0.747283
Epoch 10
Loss = 1.1999e-03, PNorm = 66.5134, GNorm = 1.2370, lr_0 = 4.9627e-04
Loss = 1.7640e-03, PNorm = 66.5401, GNorm = 0.6456, lr_0 = 4.8021e-04
Loss = 2.0568e-03, PNorm = 66.5695, GNorm = 1.6428, lr_0 = 4.6467e-04
Validation rmse = 0.713742
Epoch 11
Loss = 1.4930e-03, PNorm = 66.5911, GNorm = 0.5479, lr_0 = 4.4963e-04
Loss = 2.0810e-03, PNorm = 66.6153, GNorm = 1.9820, lr_0 = 4.3508e-04
Validation rmse = 0.710204
Epoch 12
Loss = 2.0242e-03, PNorm = 66.6401, GNorm = 1.0382, lr_0 = 4.1962e-04
Loss = 1.8704e-03, PNorm = 66.6604, GNorm = 1.8438, lr_0 = 4.0604e-04
Loss = 1.6290e-03, PNorm = 66.6851, GNorm = 1.2004, lr_0 = 3.9290e-04
Validation rmse = 0.731340
Epoch 13
Loss = 1.9873e-03, PNorm = 66.7077, GNorm = 0.7609, lr_0 = 3.8019e-04
Loss = 1.8599e-03, PNorm = 66.7254, GNorm = 0.5523, lr_0 = 3.6789e-04
Loss = 1.7456e-03, PNorm = 66.7475, GNorm = 1.9766, lr_0 = 3.5598e-04
Validation rmse = 0.739560
Epoch 14
Loss = 1.7288e-03, PNorm = 66.7697, GNorm = 2.1312, lr_0 = 3.4446e-04
Loss = 1.5819e-03, PNorm = 66.7902, GNorm = 1.8240, lr_0 = 3.3332e-04
Validation rmse = 0.710901
Epoch 15
Loss = 1.3416e-03, PNorm = 66.8085, GNorm = 0.8349, lr_0 = 3.2253e-04
Loss = 1.6541e-03, PNorm = 66.8270, GNorm = 1.2409, lr_0 = 3.1209e-04
Loss = 1.6352e-03, PNorm = 66.8446, GNorm = 0.3699, lr_0 = 3.0200e-04
Validation rmse = 0.677421
Epoch 16
Loss = 1.5405e-03, PNorm = 66.8620, GNorm = 0.8059, lr_0 = 2.9222e-04
Loss = 1.4821e-03, PNorm = 66.8797, GNorm = 0.6991, lr_0 = 2.8277e-04
Validation rmse = 0.692230
Epoch 17
Loss = 1.3635e-03, PNorm = 66.8975, GNorm = 0.4470, lr_0 = 2.7272e-04
Loss = 1.2474e-03, PNorm = 66.9107, GNorm = 1.7891, lr_0 = 2.6389e-04
Loss = 1.3396e-03, PNorm = 66.9259, GNorm = 0.6417, lr_0 = 2.5535e-04
Validation rmse = 0.670200
Epoch 18
Loss = 1.2082e-03, PNorm = 66.9406, GNorm = 2.6807, lr_0 = 2.4709e-04
Loss = 1.5647e-03, PNorm = 66.9541, GNorm = 1.8734, lr_0 = 2.3910e-04
Loss = 1.2017e-03, PNorm = 66.9708, GNorm = 1.1759, lr_0 = 2.3136e-04
Validation rmse = 0.675350
Epoch 19
Loss = 1.3644e-03, PNorm = 66.9821, GNorm = 1.0738, lr_0 = 2.2387e-04
Loss = 1.1474e-03, PNorm = 66.9949, GNorm = 0.6435, lr_0 = 2.1663e-04
Validation rmse = 0.650204
Epoch 20
Loss = 1.2205e-03, PNorm = 67.0092, GNorm = 0.6427, lr_0 = 2.0962e-04
Loss = 1.3829e-03, PNorm = 67.0230, GNorm = 0.6032, lr_0 = 2.0283e-04
Loss = 1.4572e-03, PNorm = 67.0349, GNorm = 0.9503, lr_0 = 1.9627e-04
Validation rmse = 0.654731
Epoch 21
Loss = 1.2281e-03, PNorm = 67.0480, GNorm = 1.3159, lr_0 = 1.8992e-04
Loss = 1.4346e-03, PNorm = 67.0590, GNorm = 1.6224, lr_0 = 1.8377e-04
Validation rmse = 0.665747
Epoch 22
Loss = 1.5599e-03, PNorm = 67.0712, GNorm = 1.8457, lr_0 = 1.7783e-04
Loss = 1.1889e-03, PNorm = 67.0831, GNorm = 1.6243, lr_0 = 1.7207e-04
Loss = 9.5970e-04, PNorm = 67.0919, GNorm = 0.6567, lr_0 = 1.6651e-04
Validation rmse = 0.643351
Epoch 23
Loss = 1.1671e-03, PNorm = 67.1015, GNorm = 0.7160, lr_0 = 1.6059e-04
Loss = 9.6758e-04, PNorm = 67.1100, GNorm = 0.9612, lr_0 = 1.5539e-04
Validation rmse = 0.656331
Epoch 24
Loss = 9.9499e-04, PNorm = 67.1193, GNorm = 1.1104, lr_0 = 1.5036e-04
Loss = 9.4283e-04, PNorm = 67.1299, GNorm = 0.9243, lr_0 = 1.4550e-04
Loss = 9.7429e-04, PNorm = 67.1384, GNorm = 0.4503, lr_0 = 1.4079e-04
Validation rmse = 0.646738
Epoch 25
Loss = 1.0798e-03, PNorm = 67.1454, GNorm = 0.8353, lr_0 = 1.3623e-04
Loss = 1.0843e-03, PNorm = 67.1520, GNorm = 1.9011, lr_0 = 1.3183e-04
Loss = 1.2059e-03, PNorm = 67.1600, GNorm = 1.7418, lr_0 = 1.2756e-04
Validation rmse = 0.675603
Epoch 26
Loss = 1.1097e-03, PNorm = 67.1677, GNorm = 1.4942, lr_0 = 1.2343e-04
Loss = 1.0078e-03, PNorm = 67.1751, GNorm = 0.4871, lr_0 = 1.1944e-04
Validation rmse = 0.639127
Epoch 27
Loss = 7.9876e-04, PNorm = 67.1829, GNorm = 0.4506, lr_0 = 1.1557e-04
Loss = 9.7079e-04, PNorm = 67.1912, GNorm = 0.6521, lr_0 = 1.1183e-04
Loss = 9.3852e-04, PNorm = 67.1973, GNorm = 1.6392, lr_0 = 1.0821e-04
Validation rmse = 0.648134
Epoch 28
Loss = 9.0918e-04, PNorm = 67.2046, GNorm = 0.6375, lr_0 = 1.0437e-04
Loss = 1.0281e-03, PNorm = 67.2105, GNorm = 1.2755, lr_0 = 1.0099e-04
Validation rmse = 0.639689
Epoch 29
Loss = 6.3541e-04, PNorm = 67.2176, GNorm = 0.3976, lr_0 = 1.0000e-04
Loss = 8.1820e-04, PNorm = 67.2233, GNorm = 0.4154, lr_0 = 1.0000e-04
Loss = 9.7073e-04, PNorm = 67.2292, GNorm = 0.5820, lr_0 = 1.0000e-04
Validation rmse = 0.647544
Model 0 best validation rmse = 0.639127 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.840444
Ensemble test rmse = 0.840444
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.7623e-02, PNorm = 65.0290, GNorm = 6.6415, lr_0 = 2.9800e-04
Loss = 1.1582e-02, PNorm = 65.0787, GNorm = 10.5360, lr_0 = 4.7800e-04
Validation rmse = 1.569156
Epoch 1
Loss = 8.6460e-03, PNorm = 65.1452, GNorm = 2.5995, lr_0 = 6.7600e-04
Loss = 7.8664e-03, PNorm = 65.2317, GNorm = 5.6299, lr_0 = 8.5600e-04
Loss = 8.1830e-03, PNorm = 65.3394, GNorm = 5.1843, lr_0 = 9.9344e-04
Validation rmse = 1.552947
Epoch 2
Loss = 6.5675e-03, PNorm = 65.4630, GNorm = 2.1000, lr_0 = 9.6130e-04
Loss = 6.4064e-03, PNorm = 65.5593, GNorm = 2.7493, lr_0 = 9.3019e-04
Validation rmse = 1.248757
Epoch 3
Loss = 5.1380e-03, PNorm = 65.6563, GNorm = 2.6367, lr_0 = 9.0009e-04
Loss = 4.6834e-03, PNorm = 65.7282, GNorm = 4.7839, lr_0 = 8.7096e-04
Loss = 3.4723e-03, PNorm = 65.8023, GNorm = 0.9024, lr_0 = 8.4278e-04
Validation rmse = 0.983107
Epoch 4
Loss = 3.1378e-03, PNorm = 65.8613, GNorm = 1.2793, lr_0 = 8.1551e-04
Loss = 3.1192e-03, PNorm = 65.9102, GNorm = 3.8565, lr_0 = 7.8912e-04
Validation rmse = 0.916576
Epoch 5
Loss = 3.0459e-03, PNorm = 65.9622, GNorm = 1.3477, lr_0 = 7.6358e-04
Loss = 3.6180e-03, PNorm = 66.0111, GNorm = 0.9983, lr_0 = 7.3888e-04
Loss = 5.2841e-03, PNorm = 66.0628, GNorm = 3.6943, lr_0 = 7.1497e-04
Validation rmse = 1.170657
Epoch 6
Loss = 2.9173e-03, PNorm = 66.1264, GNorm = 0.8352, lr_0 = 6.8956e-04
Loss = 3.9046e-03, PNorm = 66.1742, GNorm = 1.2286, lr_0 = 6.6725e-04
Loss = 3.0786e-03, PNorm = 66.2239, GNorm = 4.4752, lr_0 = 6.4565e-04
Validation rmse = 0.959265
Epoch 7
Loss = 2.6733e-03, PNorm = 66.2663, GNorm = 0.6286, lr_0 = 6.2476e-04
Loss = 2.7306e-03, PNorm = 66.3045, GNorm = 3.8648, lr_0 = 6.0454e-04
Validation rmse = 1.011331
Epoch 8
Loss = 3.1930e-03, PNorm = 66.3368, GNorm = 4.8623, lr_0 = 5.8498e-04
Loss = 2.5304e-03, PNorm = 66.3765, GNorm = 1.8722, lr_0 = 5.6605e-04
Loss = 2.2589e-03, PNorm = 66.4083, GNorm = 1.0475, lr_0 = 5.4774e-04
Validation rmse = 0.803213
Epoch 9
Loss = 2.1716e-03, PNorm = 66.4390, GNorm = 2.6884, lr_0 = 5.3001e-04
Loss = 2.2047e-03, PNorm = 66.4700, GNorm = 0.6864, lr_0 = 5.1286e-04
Validation rmse = 0.785835
Epoch 10
Loss = 1.5394e-03, PNorm = 66.4979, GNorm = 0.3593, lr_0 = 4.9627e-04
Loss = 1.9999e-03, PNorm = 66.5274, GNorm = 1.2352, lr_0 = 4.8021e-04
Loss = 1.7960e-03, PNorm = 66.5567, GNorm = 2.4362, lr_0 = 4.6467e-04
Validation rmse = 0.827845
Epoch 11
Loss = 2.0436e-03, PNorm = 66.5768, GNorm = 5.1576, lr_0 = 4.4963e-04
Loss = 3.3819e-03, PNorm = 66.6089, GNorm = 2.4693, lr_0 = 4.3508e-04
Validation rmse = 0.880064
Epoch 12
Loss = 1.7229e-03, PNorm = 66.6458, GNorm = 0.7930, lr_0 = 4.1962e-04
Loss = 1.8548e-03, PNorm = 66.6743, GNorm = 0.6766, lr_0 = 4.0604e-04
Loss = 1.8311e-03, PNorm = 66.6986, GNorm = 0.4110, lr_0 = 3.9290e-04
Validation rmse = 0.791724
Epoch 13
Loss = 1.7531e-03, PNorm = 66.7206, GNorm = 2.2505, lr_0 = 3.8019e-04
Loss = 1.8914e-03, PNorm = 66.7429, GNorm = 1.0979, lr_0 = 3.6789e-04
Loss = 1.6126e-03, PNorm = 66.7646, GNorm = 1.0353, lr_0 = 3.5598e-04
Validation rmse = 0.849854
Epoch 14
Loss = 1.7578e-03, PNorm = 66.7857, GNorm = 2.3460, lr_0 = 3.4446e-04
Loss = 1.6020e-03, PNorm = 66.8052, GNorm = 1.3438, lr_0 = 3.3332e-04
Validation rmse = 0.765667
Epoch 15
Loss = 1.2965e-03, PNorm = 66.8239, GNorm = 1.6027, lr_0 = 3.2253e-04
Loss = 1.4943e-03, PNorm = 66.8406, GNorm = 1.1446, lr_0 = 3.1209e-04
Loss = 1.3268e-03, PNorm = 66.8560, GNorm = 0.9129, lr_0 = 3.0200e-04
Validation rmse = 0.779622
Epoch 16
Loss = 1.4767e-03, PNorm = 66.8758, GNorm = 0.7960, lr_0 = 2.9222e-04
Loss = 1.4885e-03, PNorm = 66.8903, GNorm = 0.5007, lr_0 = 2.8277e-04
Validation rmse = 0.781281
Epoch 17
Loss = 1.8385e-03, PNorm = 66.9089, GNorm = 1.0466, lr_0 = 2.7272e-04
Loss = 1.3781e-03, PNorm = 66.9283, GNorm = 1.5704, lr_0 = 2.6389e-04
Loss = 1.3230e-03, PNorm = 66.9457, GNorm = 0.8896, lr_0 = 2.5535e-04
Validation rmse = 0.745116
Epoch 18
Loss = 1.2222e-03, PNorm = 66.9617, GNorm = 0.7635, lr_0 = 2.4709e-04
Loss = 1.2920e-03, PNorm = 66.9737, GNorm = 1.3184, lr_0 = 2.3910e-04
Loss = 1.3597e-03, PNorm = 66.9881, GNorm = 0.6565, lr_0 = 2.3136e-04
Validation rmse = 0.784316
Epoch 19
Loss = 1.3311e-03, PNorm = 67.0000, GNorm = 0.8354, lr_0 = 2.2387e-04
Loss = 1.3742e-03, PNorm = 67.0126, GNorm = 0.5534, lr_0 = 2.1663e-04
Validation rmse = 0.756594
Epoch 20
Loss = 7.6137e-04, PNorm = 67.0272, GNorm = 0.5203, lr_0 = 2.0962e-04
Loss = 1.1738e-03, PNorm = 67.0386, GNorm = 0.5353, lr_0 = 2.0283e-04
Loss = 1.2346e-03, PNorm = 67.0481, GNorm = 1.5444, lr_0 = 1.9627e-04
Validation rmse = 0.783759
Epoch 21
Loss = 1.1328e-03, PNorm = 67.0592, GNorm = 0.7110, lr_0 = 1.8992e-04
Loss = 1.2565e-03, PNorm = 67.0709, GNorm = 2.1749, lr_0 = 1.8377e-04
Validation rmse = 0.715234
Epoch 22
Loss = 9.3589e-04, PNorm = 67.0838, GNorm = 0.5119, lr_0 = 1.7783e-04
Loss = 1.0666e-03, PNorm = 67.0907, GNorm = 1.8124, lr_0 = 1.7207e-04
Loss = 1.1949e-03, PNorm = 67.1018, GNorm = 1.1801, lr_0 = 1.6651e-04
Validation rmse = 0.726470
Epoch 23
Loss = 1.0559e-03, PNorm = 67.1148, GNorm = 0.9908, lr_0 = 1.6059e-04
Loss = 9.2366e-04, PNorm = 67.1224, GNorm = 1.4306, lr_0 = 1.5539e-04
Validation rmse = 0.739044
Epoch 24
Loss = 9.1359e-04, PNorm = 67.1308, GNorm = 0.9550, lr_0 = 1.5036e-04
Loss = 1.1267e-03, PNorm = 67.1393, GNorm = 2.3565, lr_0 = 1.4550e-04
Loss = 1.1740e-03, PNorm = 67.1507, GNorm = 0.6513, lr_0 = 1.4079e-04
Validation rmse = 0.735955
Epoch 25
Loss = 1.0807e-03, PNorm = 67.1607, GNorm = 0.6361, lr_0 = 1.3623e-04
Loss = 1.0230e-03, PNorm = 67.1706, GNorm = 1.8688, lr_0 = 1.3183e-04
Loss = 9.5679e-04, PNorm = 67.1774, GNorm = 1.6289, lr_0 = 1.2756e-04
Validation rmse = 0.723211
Epoch 26
Loss = 9.8979e-04, PNorm = 67.1844, GNorm = 1.3014, lr_0 = 1.2343e-04
Loss = 1.0819e-03, PNorm = 67.1924, GNorm = 1.6436, lr_0 = 1.1944e-04
Validation rmse = 0.726126
Epoch 27
Loss = 7.8703e-04, PNorm = 67.2019, GNorm = 0.6377, lr_0 = 1.1557e-04
Loss = 8.7192e-04, PNorm = 67.2091, GNorm = 0.4398, lr_0 = 1.1183e-04
Loss = 9.0895e-04, PNorm = 67.2155, GNorm = 0.9082, lr_0 = 1.0821e-04
Validation rmse = 0.720976
Epoch 28
Loss = 7.7932e-04, PNorm = 67.2238, GNorm = 1.1357, lr_0 = 1.0437e-04
Loss = 9.8652e-04, PNorm = 67.2309, GNorm = 0.3779, lr_0 = 1.0099e-04
Validation rmse = 0.738256
Epoch 29
Loss = 1.4638e-03, PNorm = 67.2368, GNorm = 0.4087, lr_0 = 1.0000e-04
Loss = 9.3259e-04, PNorm = 67.2440, GNorm = 1.3187, lr_0 = 1.0000e-04
Loss = 7.6066e-04, PNorm = 67.2514, GNorm = 0.6956, lr_0 = 1.0000e-04
Validation rmse = 0.719910
Model 0 best validation rmse = 0.715234 on epoch 21
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.024699
Ensemble test rmse = 1.024699
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.9294e-02, PNorm = 65.0282, GNorm = 6.2154, lr_0 = 2.9800e-04
Loss = 1.3694e-02, PNorm = 65.0740, GNorm = 3.5988, lr_0 = 4.7800e-04
Validation rmse = 1.601756
Epoch 1
Loss = 7.6483e-03, PNorm = 65.1542, GNorm = 7.4790, lr_0 = 6.7600e-04
Loss = 8.5370e-03, PNorm = 65.2452, GNorm = 8.1523, lr_0 = 8.5600e-04
Loss = 9.5355e-03, PNorm = 65.3629, GNorm = 3.2608, lr_0 = 9.9344e-04
Validation rmse = 1.444424
Epoch 2
Loss = 6.9181e-03, PNorm = 65.4968, GNorm = 5.2392, lr_0 = 9.6130e-04
Loss = 6.6981e-03, PNorm = 65.6169, GNorm = 2.8702, lr_0 = 9.3019e-04
Validation rmse = 1.288564
Epoch 3
Loss = 4.5528e-03, PNorm = 65.7193, GNorm = 4.3011, lr_0 = 9.0009e-04
Loss = 4.1694e-03, PNorm = 65.7997, GNorm = 0.8333, lr_0 = 8.7096e-04
Loss = 4.4183e-03, PNorm = 65.8714, GNorm = 2.5507, lr_0 = 8.4278e-04
Validation rmse = 1.104648
Epoch 4
Loss = 3.7615e-03, PNorm = 65.9455, GNorm = 2.0930, lr_0 = 8.1551e-04
Loss = 4.0056e-03, PNorm = 66.0042, GNorm = 7.1456, lr_0 = 7.8912e-04
Validation rmse = 1.105583
Epoch 5
Loss = 2.7957e-03, PNorm = 66.0616, GNorm = 0.6660, lr_0 = 7.6358e-04
Loss = 3.1913e-03, PNorm = 66.1141, GNorm = 1.8024, lr_0 = 7.3888e-04
Loss = 3.7245e-03, PNorm = 66.1685, GNorm = 1.5203, lr_0 = 7.1497e-04
Validation rmse = 1.047512
Epoch 6
Loss = 2.6399e-03, PNorm = 66.2367, GNorm = 1.4131, lr_0 = 6.8956e-04
Loss = 3.4570e-03, PNorm = 66.2812, GNorm = 1.3974, lr_0 = 6.6725e-04
Loss = 2.5225e-03, PNorm = 66.3241, GNorm = 2.3857, lr_0 = 6.4565e-04
Validation rmse = 0.991886
Epoch 7
Loss = 2.0513e-03, PNorm = 66.3650, GNorm = 0.6775, lr_0 = 6.2476e-04
Loss = 2.4530e-03, PNorm = 66.4028, GNorm = 2.2589, lr_0 = 6.0454e-04
Validation rmse = 1.020313
Epoch 8
Loss = 1.7677e-03, PNorm = 66.4424, GNorm = 1.7094, lr_0 = 5.8498e-04
Loss = 2.3321e-03, PNorm = 66.4799, GNorm = 5.9341, lr_0 = 5.6605e-04
Loss = 2.5956e-03, PNorm = 66.5110, GNorm = 0.4445, lr_0 = 5.4774e-04
Validation rmse = 1.020271
Epoch 9
Loss = 1.9753e-03, PNorm = 66.5422, GNorm = 2.4386, lr_0 = 5.3001e-04
Loss = 2.1366e-03, PNorm = 66.5763, GNorm = 0.7919, lr_0 = 5.1286e-04
Validation rmse = 0.972614
Epoch 10
Loss = 1.6486e-03, PNorm = 66.6134, GNorm = 1.2314, lr_0 = 4.9627e-04
Loss = 1.6359e-03, PNorm = 66.6420, GNorm = 0.9796, lr_0 = 4.8021e-04
Loss = 2.2436e-03, PNorm = 66.6725, GNorm = 1.4498, lr_0 = 4.6467e-04
Validation rmse = 0.961763
Epoch 11
Loss = 1.6862e-03, PNorm = 66.7040, GNorm = 2.3918, lr_0 = 4.4963e-04
Loss = 2.3249e-03, PNorm = 66.7380, GNorm = 2.3954, lr_0 = 4.3508e-04
Validation rmse = 1.025824
Epoch 12
Loss = 1.8485e-03, PNorm = 66.7694, GNorm = 1.4197, lr_0 = 4.1962e-04
Loss = 2.0936e-03, PNorm = 66.7976, GNorm = 2.2456, lr_0 = 4.0604e-04
Loss = 1.8056e-03, PNorm = 66.8234, GNorm = 1.3614, lr_0 = 3.9290e-04
Validation rmse = 1.054759
Epoch 13
Loss = 2.0194e-03, PNorm = 66.8472, GNorm = 4.7606, lr_0 = 3.8019e-04
Loss = 1.6195e-03, PNorm = 66.8684, GNorm = 0.9510, lr_0 = 3.6789e-04
Loss = 1.7879e-03, PNorm = 66.8927, GNorm = 2.4863, lr_0 = 3.5598e-04
Validation rmse = 0.908874
Epoch 14
Loss = 1.8879e-03, PNorm = 66.9182, GNorm = 1.4612, lr_0 = 3.4446e-04
Loss = 1.4979e-03, PNorm = 66.9412, GNorm = 1.0832, lr_0 = 3.3332e-04
Validation rmse = 0.972786
Epoch 15
Loss = 1.7580e-03, PNorm = 66.9599, GNorm = 1.2090, lr_0 = 3.2253e-04
Loss = 1.3540e-03, PNorm = 66.9785, GNorm = 0.5061, lr_0 = 3.1209e-04
Loss = 1.3811e-03, PNorm = 66.9965, GNorm = 0.7156, lr_0 = 3.0200e-04
Validation rmse = 0.931616
Epoch 16
Loss = 1.6131e-03, PNorm = 67.0117, GNorm = 1.3997, lr_0 = 2.9222e-04
Loss = 1.2938e-03, PNorm = 67.0274, GNorm = 2.1505, lr_0 = 2.8277e-04
Validation rmse = 0.906304
Epoch 17
Loss = 1.3419e-03, PNorm = 67.0466, GNorm = 1.2811, lr_0 = 2.7272e-04
Loss = 1.3620e-03, PNorm = 67.0654, GNorm = 0.6671, lr_0 = 2.6389e-04
Loss = 1.2169e-03, PNorm = 67.0842, GNorm = 0.8609, lr_0 = 2.5535e-04
Validation rmse = 0.901161
Epoch 18
Loss = 1.2488e-03, PNorm = 67.0970, GNorm = 0.9790, lr_0 = 2.4709e-04
Loss = 1.1637e-03, PNorm = 67.1102, GNorm = 0.4171, lr_0 = 2.3910e-04
Loss = 1.1117e-03, PNorm = 67.1228, GNorm = 0.6505, lr_0 = 2.3136e-04
Validation rmse = 0.901801
Epoch 19
Loss = 1.1242e-03, PNorm = 67.1352, GNorm = 1.5900, lr_0 = 2.2387e-04
Loss = 1.3272e-03, PNorm = 67.1493, GNorm = 0.4599, lr_0 = 2.1663e-04
Validation rmse = 0.897644
Epoch 20
Loss = 1.0146e-03, PNorm = 67.1623, GNorm = 0.4598, lr_0 = 2.0962e-04
Loss = 1.1462e-03, PNorm = 67.1780, GNorm = 1.2915, lr_0 = 2.0283e-04
Loss = 1.0420e-03, PNorm = 67.1885, GNorm = 0.5283, lr_0 = 1.9627e-04
Validation rmse = 0.919138
Epoch 21
Loss = 1.1744e-03, PNorm = 67.2010, GNorm = 1.4603, lr_0 = 1.8992e-04
Loss = 1.0355e-03, PNorm = 67.2107, GNorm = 0.8598, lr_0 = 1.8377e-04
Validation rmse = 0.887573
Epoch 22
Loss = 1.0410e-03, PNorm = 67.2228, GNorm = 0.8724, lr_0 = 1.7783e-04
Loss = 7.9350e-04, PNorm = 67.2324, GNorm = 1.4521, lr_0 = 1.7207e-04
Loss = 1.2471e-03, PNorm = 67.2414, GNorm = 0.8872, lr_0 = 1.6651e-04
Validation rmse = 0.957428
Epoch 23
Loss = 1.0125e-03, PNorm = 67.2544, GNorm = 0.4999, lr_0 = 1.6059e-04
Loss = 9.9702e-04, PNorm = 67.2654, GNorm = 0.5968, lr_0 = 1.5539e-04
Validation rmse = 0.854541
Epoch 24
Loss = 9.7461e-04, PNorm = 67.2732, GNorm = 1.2367, lr_0 = 1.5036e-04
Loss = 1.1435e-03, PNorm = 67.2845, GNorm = 0.4646, lr_0 = 1.4550e-04
Loss = 9.6245e-04, PNorm = 67.2936, GNorm = 0.5156, lr_0 = 1.4079e-04
Validation rmse = 0.850493
Epoch 25
Loss = 9.4966e-04, PNorm = 67.3010, GNorm = 0.8335, lr_0 = 1.3623e-04
Loss = 9.1098e-04, PNorm = 67.3115, GNorm = 0.3876, lr_0 = 1.3183e-04
Loss = 9.3846e-04, PNorm = 67.3195, GNorm = 0.3770, lr_0 = 1.2756e-04
Validation rmse = 0.843912
Epoch 26
Loss = 9.7088e-04, PNorm = 67.3269, GNorm = 1.9282, lr_0 = 1.2343e-04
Loss = 8.3470e-04, PNorm = 67.3349, GNorm = 1.3124, lr_0 = 1.1944e-04
Validation rmse = 0.859529
Epoch 27
Loss = 7.2734e-04, PNorm = 67.3372, GNorm = 0.5618, lr_0 = 1.1557e-04
Loss = 9.5825e-04, PNorm = 67.3460, GNorm = 0.9976, lr_0 = 1.1183e-04
Loss = 8.3236e-04, PNorm = 67.3523, GNorm = 0.9155, lr_0 = 1.0821e-04
Validation rmse = 0.828696
Epoch 28
Loss = 9.7805e-04, PNorm = 67.3609, GNorm = 1.3601, lr_0 = 1.0437e-04
Loss = 7.5450e-04, PNorm = 67.3660, GNorm = 1.3932, lr_0 = 1.0099e-04
Validation rmse = 0.835779
Epoch 29
Loss = 5.3989e-04, PNorm = 67.3707, GNorm = 0.9674, lr_0 = 1.0000e-04
Loss = 9.0842e-04, PNorm = 67.3786, GNorm = 1.0946, lr_0 = 1.0000e-04
Loss = 8.3861e-04, PNorm = 67.3860, GNorm = 0.7607, lr_0 = 1.0000e-04
Validation rmse = 0.847987
Model 0 best validation rmse = 0.828696 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.676174
Ensemble test rmse = 0.676174
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.9986e-02, PNorm = 65.0242, GNorm = 6.2413, lr_0 = 2.9800e-04
Loss = 1.6050e-02, PNorm = 65.0699, GNorm = 10.0801, lr_0 = 4.7800e-04
Validation rmse = 1.966199
Epoch 1
Loss = 1.1143e-02, PNorm = 65.1558, GNorm = 6.6604, lr_0 = 6.7600e-04
Loss = 1.0962e-02, PNorm = 65.2579, GNorm = 1.7957, lr_0 = 8.5600e-04
Loss = 8.2326e-03, PNorm = 65.3795, GNorm = 2.2788, lr_0 = 9.9344e-04
Validation rmse = 1.816393
Epoch 2
Loss = 6.5032e-03, PNorm = 65.5015, GNorm = 1.2624, lr_0 = 9.6130e-04
Loss = 5.4145e-03, PNorm = 65.5940, GNorm = 1.1169, lr_0 = 9.3019e-04
Validation rmse = 1.541839
Epoch 3
Loss = 8.2268e-03, PNorm = 65.6898, GNorm = 1.3933, lr_0 = 9.0009e-04
Loss = 5.6545e-03, PNorm = 65.7939, GNorm = 1.1653, lr_0 = 8.7096e-04
Loss = 4.6223e-03, PNorm = 65.8744, GNorm = 3.9001, lr_0 = 8.4278e-04
Validation rmse = 1.257543
Epoch 4
Loss = 4.5573e-03, PNorm = 65.9448, GNorm = 4.1298, lr_0 = 8.1551e-04
Loss = 5.8161e-03, PNorm = 66.0115, GNorm = 3.0267, lr_0 = 7.8912e-04
Validation rmse = 1.124424
Epoch 5
Loss = 2.1424e-03, PNorm = 66.0717, GNorm = 0.9271, lr_0 = 7.6358e-04
Loss = 4.1223e-03, PNorm = 66.1263, GNorm = 1.6550, lr_0 = 7.3888e-04
Loss = 3.2108e-03, PNorm = 66.1782, GNorm = 0.8070, lr_0 = 7.1497e-04
Validation rmse = 1.036526
Epoch 6
Loss = 2.5451e-03, PNorm = 66.2309, GNorm = 1.0181, lr_0 = 6.8956e-04
Loss = 2.8717e-03, PNorm = 66.2714, GNorm = 4.0054, lr_0 = 6.6725e-04
Loss = 3.6001e-03, PNorm = 66.3168, GNorm = 1.3052, lr_0 = 6.4565e-04
Validation rmse = 1.243619
Epoch 7
Loss = 3.3882e-03, PNorm = 66.3669, GNorm = 2.7477, lr_0 = 6.2476e-04
Loss = 2.5623e-03, PNorm = 66.4093, GNorm = 1.9753, lr_0 = 6.0454e-04
Validation rmse = 1.082098
Epoch 8
Loss = 2.6560e-03, PNorm = 66.4467, GNorm = 3.4239, lr_0 = 5.8498e-04
Loss = 2.0917e-03, PNorm = 66.4840, GNorm = 1.4087, lr_0 = 5.6605e-04
Loss = 2.7017e-03, PNorm = 66.5174, GNorm = 1.1710, lr_0 = 5.4774e-04
Validation rmse = 1.038565
Epoch 9
Loss = 3.1997e-03, PNorm = 66.5553, GNorm = 4.7311, lr_0 = 5.3001e-04
Loss = 2.4149e-03, PNorm = 66.5959, GNorm = 0.8161, lr_0 = 5.1286e-04
Validation rmse = 1.012267
Epoch 10
Loss = 2.6109e-03, PNorm = 66.6357, GNorm = 2.3775, lr_0 = 4.9627e-04
Loss = 2.3010e-03, PNorm = 66.6733, GNorm = 1.0421, lr_0 = 4.8021e-04
Loss = 1.8641e-03, PNorm = 66.7069, GNorm = 0.5548, lr_0 = 4.6467e-04
Validation rmse = 1.031239
Epoch 11
Loss = 2.0775e-03, PNorm = 66.7323, GNorm = 2.7430, lr_0 = 4.4963e-04
Loss = 1.6653e-03, PNorm = 66.7579, GNorm = 0.5268, lr_0 = 4.3508e-04
Validation rmse = 0.981613
Epoch 12
Loss = 1.3914e-03, PNorm = 66.7877, GNorm = 0.4698, lr_0 = 4.1962e-04
Loss = 1.4435e-03, PNorm = 66.8108, GNorm = 0.4913, lr_0 = 4.0604e-04
Loss = 1.6215e-03, PNorm = 66.8305, GNorm = 0.6674, lr_0 = 3.9290e-04
Validation rmse = 0.961977
Epoch 13
Loss = 1.6190e-03, PNorm = 66.8544, GNorm = 1.1538, lr_0 = 3.8019e-04
Loss = 1.6304e-03, PNorm = 66.8730, GNorm = 0.7642, lr_0 = 3.6789e-04
Loss = 1.6343e-03, PNorm = 66.8939, GNorm = 0.9254, lr_0 = 3.5598e-04
Validation rmse = 0.971845
Epoch 14
Loss = 1.6495e-03, PNorm = 66.9152, GNorm = 0.4973, lr_0 = 3.4446e-04
Loss = 1.4224e-03, PNorm = 66.9355, GNorm = 0.7020, lr_0 = 3.3332e-04
Validation rmse = 0.991261
Epoch 15
Loss = 1.0624e-03, PNorm = 66.9595, GNorm = 0.4357, lr_0 = 3.2253e-04
Loss = 1.8086e-03, PNorm = 66.9810, GNorm = 0.4391, lr_0 = 3.1209e-04
Loss = 1.5202e-03, PNorm = 67.0022, GNorm = 1.8511, lr_0 = 3.0200e-04
Validation rmse = 1.049832
Epoch 16
Loss = 1.2789e-03, PNorm = 67.0166, GNorm = 1.7914, lr_0 = 2.9222e-04
Loss = 1.5317e-03, PNorm = 67.0383, GNorm = 0.3935, lr_0 = 2.8277e-04
Validation rmse = 0.971562
Epoch 17
Loss = 1.2062e-03, PNorm = 67.0597, GNorm = 2.0099, lr_0 = 2.7272e-04
Loss = 1.3456e-03, PNorm = 67.0743, GNorm = 0.7293, lr_0 = 2.6389e-04
Loss = 1.2119e-03, PNorm = 67.0882, GNorm = 0.4359, lr_0 = 2.5535e-04
Validation rmse = 1.011192
Epoch 18
Loss = 1.6092e-03, PNorm = 67.1027, GNorm = 2.6045, lr_0 = 2.4709e-04
Loss = 1.1898e-03, PNorm = 67.1195, GNorm = 1.7151, lr_0 = 2.3910e-04
Loss = 1.3114e-03, PNorm = 67.1337, GNorm = 0.9884, lr_0 = 2.3136e-04
Validation rmse = 0.970178
Epoch 19
Loss = 1.2242e-03, PNorm = 67.1457, GNorm = 0.4117, lr_0 = 2.2387e-04
Loss = 1.1560e-03, PNorm = 67.1578, GNorm = 1.6592, lr_0 = 2.1663e-04
Validation rmse = 0.958327
Epoch 20
Loss = 1.0231e-03, PNorm = 67.1723, GNorm = 0.3486, lr_0 = 2.0962e-04
Loss = 1.0813e-03, PNorm = 67.1858, GNorm = 0.3152, lr_0 = 2.0283e-04
Loss = 1.2398e-03, PNorm = 67.1977, GNorm = 0.7871, lr_0 = 1.9627e-04
Validation rmse = 0.950812
Epoch 21
Loss = 1.1278e-03, PNorm = 67.2090, GNorm = 0.4900, lr_0 = 1.8992e-04
Loss = 1.0494e-03, PNorm = 67.2224, GNorm = 1.1588, lr_0 = 1.8377e-04
Validation rmse = 0.940947
Epoch 22
Loss = 9.0120e-04, PNorm = 67.2307, GNorm = 0.4776, lr_0 = 1.7783e-04
Loss = 1.0857e-03, PNorm = 67.2410, GNorm = 1.2944, lr_0 = 1.7207e-04
Loss = 1.1111e-03, PNorm = 67.2508, GNorm = 1.2977, lr_0 = 1.6651e-04
Validation rmse = 0.960591
Epoch 23
Loss = 1.0364e-03, PNorm = 67.2613, GNorm = 1.9262, lr_0 = 1.6059e-04
Loss = 1.2327e-03, PNorm = 67.2703, GNorm = 0.5281, lr_0 = 1.5539e-04
Validation rmse = 0.981156
Epoch 24
Loss = 9.2773e-04, PNorm = 67.2801, GNorm = 1.1361, lr_0 = 1.5036e-04
Loss = 1.0277e-03, PNorm = 67.2884, GNorm = 1.4916, lr_0 = 1.4550e-04
Loss = 1.2131e-03, PNorm = 67.2973, GNorm = 1.8902, lr_0 = 1.4079e-04
Validation rmse = 0.942504
Epoch 25
Loss = 1.0617e-03, PNorm = 67.3041, GNorm = 0.4754, lr_0 = 1.3623e-04
Loss = 7.5931e-04, PNorm = 67.3113, GNorm = 0.4585, lr_0 = 1.3183e-04
Loss = 1.2272e-03, PNorm = 67.3186, GNorm = 0.7786, lr_0 = 1.2756e-04
Validation rmse = 0.960800
Epoch 26
Loss = 9.7056e-04, PNorm = 67.3265, GNorm = 1.0573, lr_0 = 1.2343e-04
Loss = 8.7289e-04, PNorm = 67.3344, GNorm = 0.5431, lr_0 = 1.1944e-04
Validation rmse = 0.951838
Epoch 27
Loss = 8.5797e-04, PNorm = 67.3431, GNorm = 0.4642, lr_0 = 1.1557e-04
Loss = 8.9925e-04, PNorm = 67.3507, GNorm = 0.5865, lr_0 = 1.1183e-04
Loss = 8.9000e-04, PNorm = 67.3577, GNorm = 0.5920, lr_0 = 1.0821e-04
Validation rmse = 0.965322
Epoch 28
Loss = 9.6587e-04, PNorm = 67.3632, GNorm = 0.5657, lr_0 = 1.0437e-04
Loss = 9.3858e-04, PNorm = 67.3707, GNorm = 1.2742, lr_0 = 1.0099e-04
Validation rmse = 0.949570
Epoch 29
Loss = 9.0070e-04, PNorm = 67.3767, GNorm = 0.3252, lr_0 = 1.0000e-04
Loss = 7.8611e-04, PNorm = 67.3834, GNorm = 0.5017, lr_0 = 1.0000e-04
Loss = 9.8121e-04, PNorm = 67.3902, GNorm = 0.3770, lr_0 = 1.0000e-04
Validation rmse = 0.954872
Model 0 best validation rmse = 0.940947 on epoch 21
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.763615
Ensemble test rmse = 0.763615
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.6151e-02, PNorm = 65.0303, GNorm = 10.3780, lr_0 = 2.9800e-04
Loss = 1.4231e-02, PNorm = 65.0753, GNorm = 8.3300, lr_0 = 4.7800e-04
Validation rmse = 1.567310
Epoch 1
Loss = 1.0025e-02, PNorm = 65.1579, GNorm = 6.7885, lr_0 = 6.7600e-04
Loss = 8.5267e-03, PNorm = 65.2549, GNorm = 2.9617, lr_0 = 8.5600e-04
Loss = 7.1845e-03, PNorm = 65.3780, GNorm = 4.2200, lr_0 = 9.9344e-04
Validation rmse = 1.897325
Epoch 2
Loss = 8.5283e-03, PNorm = 65.5038, GNorm = 1.3330, lr_0 = 9.6130e-04
Loss = 6.1497e-03, PNorm = 65.6312, GNorm = 2.3818, lr_0 = 9.3019e-04
Validation rmse = 1.467076
Epoch 3
Loss = 5.2395e-03, PNorm = 65.7291, GNorm = 0.9518, lr_0 = 9.0009e-04
Loss = 4.7866e-03, PNorm = 65.8102, GNorm = 3.0892, lr_0 = 8.7096e-04
Loss = 4.9520e-03, PNorm = 65.8952, GNorm = 2.7113, lr_0 = 8.4278e-04
Validation rmse = 0.914437
Epoch 4
Loss = 3.8676e-03, PNorm = 65.9746, GNorm = 1.9907, lr_0 = 8.1551e-04
Loss = 3.4474e-03, PNorm = 66.0369, GNorm = 2.5183, lr_0 = 7.8912e-04
Validation rmse = 0.919170
Epoch 5
Loss = 3.4970e-03, PNorm = 66.0926, GNorm = 2.1904, lr_0 = 7.6358e-04
Loss = 3.5168e-03, PNorm = 66.1623, GNorm = 3.4813, lr_0 = 7.3888e-04
Loss = 3.3247e-03, PNorm = 66.2146, GNorm = 2.0833, lr_0 = 7.1497e-04
Validation rmse = 0.905664
Epoch 6
Loss = 3.6528e-03, PNorm = 66.2625, GNorm = 2.6171, lr_0 = 6.8956e-04
Loss = 4.0982e-03, PNorm = 66.3096, GNorm = 0.6151, lr_0 = 6.6725e-04
Loss = 3.2029e-03, PNorm = 66.3666, GNorm = 1.0069, lr_0 = 6.4565e-04
Validation rmse = 0.775444
Epoch 7
Loss = 2.5547e-03, PNorm = 66.4208, GNorm = 2.9778, lr_0 = 6.2476e-04
Loss = 3.0976e-03, PNorm = 66.4591, GNorm = 4.4374, lr_0 = 6.0454e-04
Validation rmse = 0.982679
Epoch 8
Loss = 2.0676e-03, PNorm = 66.5080, GNorm = 0.9407, lr_0 = 5.8498e-04
Loss = 2.7374e-03, PNorm = 66.5476, GNorm = 0.9579, lr_0 = 5.6605e-04
Loss = 2.5598e-03, PNorm = 66.5884, GNorm = 1.5809, lr_0 = 5.4774e-04
Validation rmse = 0.791980
Epoch 9
Loss = 2.0676e-03, PNorm = 66.6295, GNorm = 3.2535, lr_0 = 5.3001e-04
Loss = 2.7914e-03, PNorm = 66.6666, GNorm = 1.5682, lr_0 = 5.1286e-04
Validation rmse = 0.824016
Epoch 10
Loss = 1.9946e-03, PNorm = 66.7011, GNorm = 1.9307, lr_0 = 4.9627e-04
Loss = 1.8440e-03, PNorm = 66.7386, GNorm = 0.5278, lr_0 = 4.8021e-04
Loss = 2.1753e-03, PNorm = 66.7673, GNorm = 2.0051, lr_0 = 4.6467e-04
Validation rmse = 0.825962
Epoch 11
Loss = 2.2830e-03, PNorm = 66.8019, GNorm = 2.4897, lr_0 = 4.4963e-04
Loss = 1.7211e-03, PNorm = 66.8314, GNorm = 1.7298, lr_0 = 4.3508e-04
Validation rmse = 0.730749
Epoch 12
Loss = 1.8328e-03, PNorm = 66.8604, GNorm = 1.9496, lr_0 = 4.1962e-04
Loss = 1.4888e-03, PNorm = 66.8846, GNorm = 1.1299, lr_0 = 4.0604e-04
Loss = 1.8642e-03, PNorm = 66.9084, GNorm = 1.3889, lr_0 = 3.9290e-04
Validation rmse = 0.875278
Epoch 13
Loss = 1.7375e-03, PNorm = 66.9286, GNorm = 1.0680, lr_0 = 3.8019e-04
Loss = 1.4005e-03, PNorm = 66.9490, GNorm = 0.9421, lr_0 = 3.6789e-04
Loss = 1.7887e-03, PNorm = 66.9720, GNorm = 2.1246, lr_0 = 3.5598e-04
Validation rmse = 0.708668
Epoch 14
Loss = 1.4607e-03, PNorm = 66.9939, GNorm = 0.4827, lr_0 = 3.4446e-04
Loss = 1.5259e-03, PNorm = 67.0157, GNorm = 1.7617, lr_0 = 3.3332e-04
Validation rmse = 0.814086
Epoch 15
Loss = 7.8117e-04, PNorm = 67.0394, GNorm = 0.7676, lr_0 = 3.2253e-04
Loss = 1.7794e-03, PNorm = 67.0629, GNorm = 0.5280, lr_0 = 3.1209e-04
Loss = 1.3340e-03, PNorm = 67.0819, GNorm = 0.4632, lr_0 = 3.0200e-04
Validation rmse = 0.762680
Epoch 16
Loss = 1.0003e-03, PNorm = 67.1005, GNorm = 0.6899, lr_0 = 2.9222e-04
Loss = 1.4591e-03, PNorm = 67.1182, GNorm = 2.2459, lr_0 = 2.8277e-04
Validation rmse = 0.764810
Epoch 17
Loss = 1.0057e-03, PNorm = 67.1319, GNorm = 1.4408, lr_0 = 2.7272e-04
Loss = 1.0962e-03, PNorm = 67.1443, GNorm = 0.6053, lr_0 = 2.6389e-04
Loss = 1.4191e-03, PNorm = 67.1608, GNorm = 2.4038, lr_0 = 2.5535e-04
Validation rmse = 0.718974
Epoch 18
Loss = 1.1611e-03, PNorm = 67.1755, GNorm = 0.5749, lr_0 = 2.4709e-04
Loss = 1.1347e-03, PNorm = 67.1880, GNorm = 0.4401, lr_0 = 2.3910e-04
Loss = 1.3612e-03, PNorm = 67.1997, GNorm = 2.9528, lr_0 = 2.3136e-04
Validation rmse = 0.747504
Epoch 19
Loss = 1.2609e-03, PNorm = 67.2132, GNorm = 0.8033, lr_0 = 2.2387e-04
Loss = 1.3034e-03, PNorm = 67.2271, GNorm = 0.8471, lr_0 = 2.1663e-04
Validation rmse = 0.707841
Epoch 20
Loss = 1.3984e-03, PNorm = 67.2390, GNorm = 1.1324, lr_0 = 2.0962e-04
Loss = 1.1888e-03, PNorm = 67.2524, GNorm = 2.9698, lr_0 = 2.0283e-04
Loss = 1.1484e-03, PNorm = 67.2660, GNorm = 1.2892, lr_0 = 1.9627e-04
Validation rmse = 0.705714
Epoch 21
Loss = 1.2464e-03, PNorm = 67.2817, GNorm = 1.5477, lr_0 = 1.8992e-04
Loss = 1.0371e-03, PNorm = 67.2927, GNorm = 0.6224, lr_0 = 1.8377e-04
Validation rmse = 0.706626
Epoch 22
Loss = 1.0589e-03, PNorm = 67.3022, GNorm = 0.5830, lr_0 = 1.7783e-04
Loss = 9.5423e-04, PNorm = 67.3116, GNorm = 1.3726, lr_0 = 1.7207e-04
Loss = 1.0415e-03, PNorm = 67.3205, GNorm = 0.9803, lr_0 = 1.6651e-04
Validation rmse = 0.802468
Epoch 23
Loss = 8.6928e-04, PNorm = 67.3320, GNorm = 0.4546, lr_0 = 1.6059e-04
Loss = 9.9866e-04, PNorm = 67.3418, GNorm = 0.4687, lr_0 = 1.5539e-04
Validation rmse = 0.808550
Epoch 24
Loss = 6.0386e-04, PNorm = 67.3490, GNorm = 0.4962, lr_0 = 1.5036e-04
Loss = 1.0275e-03, PNorm = 67.3568, GNorm = 0.6454, lr_0 = 1.4550e-04
Loss = 1.0038e-03, PNorm = 67.3630, GNorm = 0.6167, lr_0 = 1.4079e-04
Validation rmse = 0.748876
Epoch 25
Loss = 7.2675e-04, PNorm = 67.3713, GNorm = 1.1519, lr_0 = 1.3623e-04
Loss = 8.9623e-04, PNorm = 67.3808, GNorm = 0.9356, lr_0 = 1.3183e-04
Loss = 1.0438e-03, PNorm = 67.3884, GNorm = 0.5570, lr_0 = 1.2756e-04
Validation rmse = 0.723510
Epoch 26
Loss = 8.1205e-04, PNorm = 67.3942, GNorm = 0.6717, lr_0 = 1.2343e-04
Loss = 8.7126e-04, PNorm = 67.4023, GNorm = 0.6704, lr_0 = 1.1944e-04
Validation rmse = 0.702566
Epoch 27
Loss = 6.9035e-04, PNorm = 67.4088, GNorm = 0.4328, lr_0 = 1.1557e-04
Loss = 9.6459e-04, PNorm = 67.4167, GNorm = 1.1651, lr_0 = 1.1183e-04
Loss = 9.5326e-04, PNorm = 67.4225, GNorm = 0.6941, lr_0 = 1.0821e-04
Validation rmse = 0.742808
Epoch 28
Loss = 8.6205e-04, PNorm = 67.4282, GNorm = 0.8518, lr_0 = 1.0437e-04
Loss = 7.9129e-04, PNorm = 67.4334, GNorm = 0.5142, lr_0 = 1.0099e-04
Validation rmse = 0.717520
Epoch 29
Loss = 6.8547e-04, PNorm = 67.4398, GNorm = 0.5840, lr_0 = 1.0000e-04
Loss = 8.8457e-04, PNorm = 67.4448, GNorm = 1.4218, lr_0 = 1.0000e-04
Loss = 9.2243e-04, PNorm = 67.4501, GNorm = 0.9518, lr_0 = 1.0000e-04
Validation rmse = 0.739837
Model 0 best validation rmse = 0.702566 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.708465
Ensemble test rmse = 0.708465
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.8859e-02, PNorm = 65.0271, GNorm = 8.1681, lr_0 = 2.9800e-04
Loss = 1.3749e-02, PNorm = 65.0667, GNorm = 2.8101, lr_0 = 4.7800e-04
Validation rmse = 1.897872
Epoch 1
Loss = 1.0667e-02, PNorm = 65.1474, GNorm = 1.8272, lr_0 = 6.7600e-04
Loss = 7.1173e-03, PNorm = 65.2396, GNorm = 2.1867, lr_0 = 8.5600e-04
Loss = 6.7011e-03, PNorm = 65.3402, GNorm = 4.3922, lr_0 = 9.9344e-04
Validation rmse = 1.437890
Epoch 2
Loss = 6.5002e-03, PNorm = 65.4542, GNorm = 5.5623, lr_0 = 9.6130e-04
Loss = 5.2129e-03, PNorm = 65.5608, GNorm = 6.1507, lr_0 = 9.3019e-04
Validation rmse = 1.304565
Epoch 3
Loss = 4.7088e-03, PNorm = 65.6504, GNorm = 3.3994, lr_0 = 9.0009e-04
Loss = 5.0665e-03, PNorm = 65.7289, GNorm = 2.0474, lr_0 = 8.7096e-04
Loss = 4.1680e-03, PNorm = 65.8018, GNorm = 3.8505, lr_0 = 8.4278e-04
Validation rmse = 1.083480
Epoch 4
Loss = 4.7281e-03, PNorm = 65.8583, GNorm = 5.9031, lr_0 = 8.1551e-04
Loss = 4.1956e-03, PNorm = 65.9228, GNorm = 1.9738, lr_0 = 7.8912e-04
Validation rmse = 1.087870
Epoch 5
Loss = 1.9999e-03, PNorm = 65.9670, GNorm = 0.7166, lr_0 = 7.6358e-04
Loss = 2.7630e-03, PNorm = 66.0052, GNorm = 1.8723, lr_0 = 7.3888e-04
Loss = 3.4441e-03, PNorm = 66.0434, GNorm = 2.4032, lr_0 = 7.1497e-04
Validation rmse = 1.242704
Epoch 6
Loss = 3.1702e-03, PNorm = 66.0892, GNorm = 0.5427, lr_0 = 6.8956e-04
Loss = 3.1190e-03, PNorm = 66.1379, GNorm = 2.0970, lr_0 = 6.6725e-04
Loss = 3.4733e-03, PNorm = 66.1733, GNorm = 1.7515, lr_0 = 6.4565e-04
Validation rmse = 0.977181
Epoch 7
Loss = 2.6492e-03, PNorm = 66.2117, GNorm = 1.2823, lr_0 = 6.2476e-04
Loss = 2.5827e-03, PNorm = 66.2483, GNorm = 2.5098, lr_0 = 6.0454e-04
Validation rmse = 0.987611
Epoch 8
Loss = 2.3838e-03, PNorm = 66.2778, GNorm = 1.2902, lr_0 = 5.8498e-04
Loss = 2.2076e-03, PNorm = 66.3104, GNorm = 1.0282, lr_0 = 5.6605e-04
Loss = 2.0593e-03, PNorm = 66.3414, GNorm = 0.6801, lr_0 = 5.4774e-04
Validation rmse = 1.014147
Epoch 9
Loss = 2.1724e-03, PNorm = 66.3663, GNorm = 1.8073, lr_0 = 5.3001e-04
Loss = 2.0347e-03, PNorm = 66.3992, GNorm = 0.7229, lr_0 = 5.1286e-04
Validation rmse = 0.961665
Epoch 10
Loss = 2.1267e-03, PNorm = 66.4255, GNorm = 2.7775, lr_0 = 4.9627e-04
Loss = 2.8501e-03, PNorm = 66.4512, GNorm = 3.4563, lr_0 = 4.8021e-04
Loss = 2.7218e-03, PNorm = 66.4790, GNorm = 2.5008, lr_0 = 4.6467e-04
Validation rmse = 1.013809
Epoch 11
Loss = 2.3233e-03, PNorm = 66.5105, GNorm = 2.5615, lr_0 = 4.4963e-04
Loss = 1.8377e-03, PNorm = 66.5379, GNorm = 2.1124, lr_0 = 4.3508e-04
Validation rmse = 0.953014
Epoch 12
Loss = 1.6407e-03, PNorm = 66.5644, GNorm = 0.8926, lr_0 = 4.1962e-04
Loss = 1.8811e-03, PNorm = 66.5837, GNorm = 3.0294, lr_0 = 4.0604e-04
Loss = 1.8630e-03, PNorm = 66.6080, GNorm = 3.2789, lr_0 = 3.9290e-04
Validation rmse = 0.951958
Epoch 13
Loss = 1.8081e-03, PNorm = 66.6274, GNorm = 1.1713, lr_0 = 3.8019e-04
Loss = 1.9718e-03, PNorm = 66.6506, GNorm = 1.7399, lr_0 = 3.6789e-04
Loss = 1.5952e-03, PNorm = 66.6707, GNorm = 1.7806, lr_0 = 3.5598e-04
Validation rmse = 0.942102
Epoch 14
Loss = 1.4209e-03, PNorm = 66.6874, GNorm = 0.7925, lr_0 = 3.4446e-04
Loss = 1.5220e-03, PNorm = 66.7065, GNorm = 1.1835, lr_0 = 3.3332e-04
Validation rmse = 0.951715
Epoch 15
Loss = 1.6593e-03, PNorm = 66.7244, GNorm = 0.7348, lr_0 = 3.2253e-04
Loss = 1.5466e-03, PNorm = 66.7432, GNorm = 1.5883, lr_0 = 3.1209e-04
Loss = 1.4279e-03, PNorm = 66.7608, GNorm = 0.5161, lr_0 = 3.0200e-04
Validation rmse = 0.959809
Epoch 16
Loss = 1.4459e-03, PNorm = 66.7735, GNorm = 1.2918, lr_0 = 2.9222e-04
Loss = 1.4480e-03, PNorm = 66.7896, GNorm = 0.7761, lr_0 = 2.8277e-04
Validation rmse = 1.000511
Epoch 17
Loss = 1.0944e-03, PNorm = 66.8078, GNorm = 1.3562, lr_0 = 2.7272e-04
Loss = 1.6352e-03, PNorm = 66.8277, GNorm = 1.2926, lr_0 = 2.6389e-04
Loss = 1.3199e-03, PNorm = 66.8427, GNorm = 1.3513, lr_0 = 2.5535e-04
Validation rmse = 0.921459
Epoch 18
Loss = 1.2578e-03, PNorm = 66.8535, GNorm = 1.1532, lr_0 = 2.4709e-04
Loss = 1.4232e-03, PNorm = 66.8649, GNorm = 0.6030, lr_0 = 2.3910e-04
Loss = 1.5694e-03, PNorm = 66.8799, GNorm = 1.2714, lr_0 = 2.3136e-04
Validation rmse = 0.951614
Epoch 19
Loss = 1.3472e-03, PNorm = 66.8969, GNorm = 1.7972, lr_0 = 2.2387e-04
Loss = 1.0867e-03, PNorm = 66.9107, GNorm = 0.9237, lr_0 = 2.1663e-04
Validation rmse = 0.952722
Epoch 20
Loss = 1.2099e-03, PNorm = 66.9190, GNorm = 0.7173, lr_0 = 2.0962e-04
Loss = 1.2406e-03, PNorm = 66.9312, GNorm = 0.6237, lr_0 = 2.0283e-04
Loss = 1.3107e-03, PNorm = 66.9429, GNorm = 2.0876, lr_0 = 1.9627e-04
Validation rmse = 0.947474
Epoch 21
Loss = 1.1163e-03, PNorm = 66.9525, GNorm = 1.1387, lr_0 = 1.8992e-04
Loss = 1.2330e-03, PNorm = 66.9619, GNorm = 0.5104, lr_0 = 1.8377e-04
Validation rmse = 0.936118
Epoch 22
Loss = 1.0947e-03, PNorm = 66.9722, GNorm = 1.1351, lr_0 = 1.7783e-04
Loss = 1.0569e-03, PNorm = 66.9828, GNorm = 1.4005, lr_0 = 1.7207e-04
Loss = 1.1968e-03, PNorm = 66.9936, GNorm = 0.4753, lr_0 = 1.6651e-04
Validation rmse = 0.936844
Epoch 23
Loss = 1.0880e-03, PNorm = 67.0031, GNorm = 0.5468, lr_0 = 1.6059e-04
Loss = 9.9417e-04, PNorm = 67.0122, GNorm = 0.4311, lr_0 = 1.5539e-04
Validation rmse = 0.948158
Epoch 24
Loss = 8.1678e-04, PNorm = 67.0223, GNorm = 0.4488, lr_0 = 1.5036e-04
Loss = 1.1510e-03, PNorm = 67.0315, GNorm = 0.9281, lr_0 = 1.4550e-04
Loss = 9.4879e-04, PNorm = 67.0387, GNorm = 0.7945, lr_0 = 1.4079e-04
Validation rmse = 0.961052
Epoch 25
Loss = 8.8838e-04, PNorm = 67.0452, GNorm = 0.5061, lr_0 = 1.3623e-04
Loss = 1.0327e-03, PNorm = 67.0534, GNorm = 1.1057, lr_0 = 1.3183e-04
Loss = 1.0701e-03, PNorm = 67.0614, GNorm = 0.7020, lr_0 = 1.2756e-04
Validation rmse = 0.957549
Epoch 26
Loss = 1.1176e-03, PNorm = 67.0697, GNorm = 0.4687, lr_0 = 1.2343e-04
Loss = 9.7015e-04, PNorm = 67.0783, GNorm = 1.6540, lr_0 = 1.1944e-04
Validation rmse = 0.949640
Epoch 27
Loss = 1.1441e-03, PNorm = 67.0858, GNorm = 1.7687, lr_0 = 1.1557e-04
Loss = 9.6935e-04, PNorm = 67.0921, GNorm = 0.8295, lr_0 = 1.1183e-04
Loss = 1.0734e-03, PNorm = 67.0979, GNorm = 1.0361, lr_0 = 1.0821e-04
Validation rmse = 0.971939
Epoch 28
Loss = 1.0634e-03, PNorm = 67.1060, GNorm = 1.3380, lr_0 = 1.0437e-04
Loss = 9.4675e-04, PNorm = 67.1117, GNorm = 0.5741, lr_0 = 1.0099e-04
Validation rmse = 0.948873
Epoch 29
Loss = 6.1155e-04, PNorm = 67.1169, GNorm = 0.6951, lr_0 = 1.0000e-04
Loss = 9.3802e-04, PNorm = 67.1223, GNorm = 0.4642, lr_0 = 1.0000e-04
Loss = 9.7675e-04, PNorm = 67.1289, GNorm = 1.9810, lr_0 = 1.0000e-04
Validation rmse = 0.987639
Model 0 best validation rmse = 0.921459 on epoch 17
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.698984
Ensemble test rmse = 0.698984
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.9493e-02, PNorm = 65.0252, GNorm = 4.1362, lr_0 = 2.9800e-04
Loss = 1.3972e-02, PNorm = 65.0734, GNorm = 3.0112, lr_0 = 4.7800e-04
Validation rmse = 1.501489
Epoch 1
Loss = 8.1544e-03, PNorm = 65.1528, GNorm = 3.6218, lr_0 = 6.7600e-04
Loss = 8.0340e-03, PNorm = 65.2472, GNorm = 3.3890, lr_0 = 8.5600e-04
Loss = 6.8062e-03, PNorm = 65.3589, GNorm = 3.3065, lr_0 = 9.9344e-04
Validation rmse = 1.267007
Epoch 2
Loss = 7.3963e-03, PNorm = 65.4745, GNorm = 6.5967, lr_0 = 9.6130e-04
Loss = 5.3241e-03, PNorm = 65.5899, GNorm = 3.4347, lr_0 = 9.3019e-04
Validation rmse = 1.110979
Epoch 3
Loss = 3.9876e-03, PNorm = 65.6861, GNorm = 2.6716, lr_0 = 9.0009e-04
Loss = 4.3689e-03, PNorm = 65.7708, GNorm = 4.7430, lr_0 = 8.7096e-04
Loss = 4.8055e-03, PNorm = 65.8490, GNorm = 2.1721, lr_0 = 8.4278e-04
Validation rmse = 1.103278
Epoch 4
Loss = 4.2816e-03, PNorm = 65.9178, GNorm = 1.4977, lr_0 = 8.1551e-04
Loss = 4.7794e-03, PNorm = 65.9869, GNorm = 2.8945, lr_0 = 7.8912e-04
Validation rmse = 1.239743
Epoch 5
Loss = 3.5007e-03, PNorm = 66.0492, GNorm = 1.5492, lr_0 = 7.6358e-04
Loss = 3.9913e-03, PNorm = 66.0987, GNorm = 1.7099, lr_0 = 7.3888e-04
Loss = 3.1305e-03, PNorm = 66.1432, GNorm = 2.9346, lr_0 = 7.1497e-04
Validation rmse = 1.031200
Epoch 6
Loss = 2.7387e-03, PNorm = 66.1990, GNorm = 1.1836, lr_0 = 6.8956e-04
Loss = 3.2956e-03, PNorm = 66.2406, GNorm = 2.1994, lr_0 = 6.6725e-04
Loss = 2.3757e-03, PNorm = 66.2845, GNorm = 2.2042, lr_0 = 6.4565e-04
Validation rmse = 0.991414
Epoch 7
Loss = 2.3485e-03, PNorm = 66.3305, GNorm = 1.1992, lr_0 = 6.2476e-04
Loss = 2.4708e-03, PNorm = 66.3649, GNorm = 1.3164, lr_0 = 6.0454e-04
Validation rmse = 1.036652
Epoch 8
Loss = 2.7936e-03, PNorm = 66.4112, GNorm = 2.0142, lr_0 = 5.8498e-04
Loss = 2.3977e-03, PNorm = 66.4585, GNorm = 0.8776, lr_0 = 5.6605e-04
Loss = 2.2103e-03, PNorm = 66.4927, GNorm = 1.0320, lr_0 = 5.4774e-04
Validation rmse = 0.862042
Epoch 9
Loss = 1.7320e-03, PNorm = 66.5245, GNorm = 0.4774, lr_0 = 5.3001e-04
Loss = 2.3249e-03, PNorm = 66.5562, GNorm = 0.9326, lr_0 = 5.1286e-04
Validation rmse = 0.856950
Epoch 10
Loss = 1.8275e-03, PNorm = 66.5955, GNorm = 2.5939, lr_0 = 4.9627e-04
Loss = 2.1366e-03, PNorm = 66.6265, GNorm = 1.9085, lr_0 = 4.8021e-04
Loss = 1.6001e-03, PNorm = 66.6577, GNorm = 2.0753, lr_0 = 4.6467e-04
Validation rmse = 0.813108
Epoch 11
Loss = 1.4454e-03, PNorm = 66.6904, GNorm = 0.9306, lr_0 = 4.4963e-04
Loss = 1.5939e-03, PNorm = 66.7241, GNorm = 1.6460, lr_0 = 4.3508e-04
Validation rmse = 0.792922
Epoch 12
Loss = 1.1036e-03, PNorm = 66.7499, GNorm = 0.5620, lr_0 = 4.1962e-04
Loss = 1.5633e-03, PNorm = 66.7756, GNorm = 1.2845, lr_0 = 4.0604e-04
Loss = 1.4196e-03, PNorm = 66.7966, GNorm = 0.8001, lr_0 = 3.9290e-04
Validation rmse = 0.777477
Epoch 13
Loss = 1.4610e-03, PNorm = 66.8151, GNorm = 1.9497, lr_0 = 3.8019e-04
Loss = 1.2925e-03, PNorm = 66.8429, GNorm = 0.4830, lr_0 = 3.6789e-04
Loss = 1.6326e-03, PNorm = 66.8631, GNorm = 1.3345, lr_0 = 3.5598e-04
Validation rmse = 0.763408
Epoch 14
Loss = 1.4999e-03, PNorm = 66.8872, GNorm = 2.1398, lr_0 = 3.4446e-04
Loss = 1.3203e-03, PNorm = 66.9128, GNorm = 1.4245, lr_0 = 3.3332e-04
Validation rmse = 0.966097
Epoch 15
Loss = 2.0586e-03, PNorm = 66.9290, GNorm = 0.9519, lr_0 = 3.2253e-04
Loss = 1.7830e-03, PNorm = 66.9521, GNorm = 1.2730, lr_0 = 3.1209e-04
Loss = 1.1760e-03, PNorm = 66.9751, GNorm = 0.7490, lr_0 = 3.0200e-04
Validation rmse = 0.806257
Epoch 16
Loss = 1.1598e-03, PNorm = 66.9924, GNorm = 0.6366, lr_0 = 2.9222e-04
Loss = 1.2627e-03, PNorm = 67.0078, GNorm = 0.5637, lr_0 = 2.8277e-04
Validation rmse = 0.753481
Epoch 17
Loss = 9.3233e-04, PNorm = 67.0305, GNorm = 0.2913, lr_0 = 2.7272e-04
Loss = 1.1427e-03, PNorm = 67.0449, GNorm = 0.5690, lr_0 = 2.6389e-04
Loss = 1.1084e-03, PNorm = 67.0588, GNorm = 0.6847, lr_0 = 2.5535e-04
Validation rmse = 0.762699
Epoch 18
Loss = 1.2252e-03, PNorm = 67.0751, GNorm = 0.3854, lr_0 = 2.4709e-04
Loss = 1.1503e-03, PNorm = 67.0898, GNorm = 1.8028, lr_0 = 2.3910e-04
Loss = 1.0569e-03, PNorm = 67.1020, GNorm = 0.4484, lr_0 = 2.3136e-04
Validation rmse = 0.750389
Epoch 19
Loss = 1.1758e-03, PNorm = 67.1166, GNorm = 0.8236, lr_0 = 2.2387e-04
Loss = 1.1548e-03, PNorm = 67.1286, GNorm = 0.6787, lr_0 = 2.1663e-04
Validation rmse = 0.736314
Epoch 20
Loss = 7.0027e-04, PNorm = 67.1432, GNorm = 0.3706, lr_0 = 2.0962e-04
Loss = 1.3725e-03, PNorm = 67.1550, GNorm = 2.5409, lr_0 = 2.0283e-04
Loss = 1.0403e-03, PNorm = 67.1660, GNorm = 0.6615, lr_0 = 1.9627e-04
Validation rmse = 0.767417
Epoch 21
Loss = 1.0484e-03, PNorm = 67.1777, GNorm = 0.4693, lr_0 = 1.8992e-04
Loss = 1.1722e-03, PNorm = 67.1903, GNorm = 0.6177, lr_0 = 1.8377e-04
Validation rmse = 0.748909
Epoch 22
Loss = 8.1252e-04, PNorm = 67.2010, GNorm = 0.4979, lr_0 = 1.7783e-04
Loss = 9.3804e-04, PNorm = 67.2123, GNorm = 0.4457, lr_0 = 1.7207e-04
Loss = 1.0431e-03, PNorm = 67.2224, GNorm = 0.4999, lr_0 = 1.6651e-04
Validation rmse = 0.745868
Epoch 23
Loss = 1.1162e-03, PNorm = 67.2305, GNorm = 0.3559, lr_0 = 1.6059e-04
Loss = 9.5841e-04, PNorm = 67.2418, GNorm = 1.8863, lr_0 = 1.5539e-04
Validation rmse = 0.739277
Epoch 24
Loss = 9.1268e-04, PNorm = 67.2539, GNorm = 0.5596, lr_0 = 1.5036e-04
Loss = 1.0126e-03, PNorm = 67.2629, GNorm = 1.9810, lr_0 = 1.4550e-04
Loss = 1.1006e-03, PNorm = 67.2717, GNorm = 1.8246, lr_0 = 1.4079e-04
Validation rmse = 0.796922
Epoch 25
Loss = 9.9242e-04, PNorm = 67.2797, GNorm = 0.9927, lr_0 = 1.3623e-04
Loss = 9.9070e-04, PNorm = 67.2882, GNorm = 1.7273, lr_0 = 1.3183e-04
Loss = 1.0791e-03, PNorm = 67.2966, GNorm = 1.6943, lr_0 = 1.2756e-04
Validation rmse = 0.744355
Epoch 26
Loss = 9.4619e-04, PNorm = 67.3062, GNorm = 0.7495, lr_0 = 1.2343e-04
Loss = 9.0066e-04, PNorm = 67.3132, GNorm = 0.3986, lr_0 = 1.1944e-04
Validation rmse = 0.747332
Epoch 27
Loss = 9.1989e-04, PNorm = 67.3205, GNorm = 1.1740, lr_0 = 1.1557e-04
Loss = 8.9145e-04, PNorm = 67.3263, GNorm = 0.5426, lr_0 = 1.1183e-04
Loss = 8.2828e-04, PNorm = 67.3320, GNorm = 0.4562, lr_0 = 1.0821e-04
Validation rmse = 0.743010
Epoch 28
Loss = 8.8458e-04, PNorm = 67.3378, GNorm = 0.5825, lr_0 = 1.0437e-04
Loss = 8.9498e-04, PNorm = 67.3430, GNorm = 0.3820, lr_0 = 1.0099e-04
Validation rmse = 0.771077
Epoch 29
Loss = 1.0198e-03, PNorm = 67.3504, GNorm = 1.5405, lr_0 = 1.0000e-04
Loss = 8.8157e-04, PNorm = 67.3559, GNorm = 0.8570, lr_0 = 1.0000e-04
Loss = 7.9026e-04, PNorm = 67.3601, GNorm = 0.4310, lr_0 = 1.0000e-04
Validation rmse = 0.742314
Model 0 best validation rmse = 0.736314 on epoch 19
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.730803
Ensemble test rmse = 0.730803
10-fold cross validation
	Seed 0 ==> test rmse = 0.784245
	Seed 1 ==> test rmse = 0.680039
	Seed 2 ==> test rmse = 0.684674
	Seed 3 ==> test rmse = 0.840444
	Seed 4 ==> test rmse = 1.024699
	Seed 5 ==> test rmse = 0.676174
	Seed 6 ==> test rmse = 0.763615
	Seed 7 ==> test rmse = 0.708465
	Seed 8 ==> test rmse = 0.698984
	Seed 9 ==> test rmse = 0.730803
Overall test rmse = 0.759214 +/- 0.101714
Elapsed time = 0:08:30
