Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 1.6106e-02, PNorm = 75.7834, GNorm = 7.2294, lr_0 = 2.9800e-04
Loss = 1.1742e-02, PNorm = 75.8394, GNorm = 7.2244, lr_0 = 4.7800e-04
Validation rmse = 1.314188
Epoch 1
Loss = 8.2911e-03, PNorm = 75.9249, GNorm = 4.9557, lr_0 = 6.7600e-04
Loss = 6.0000e-03, PNorm = 76.0146, GNorm = 6.1743, lr_0 = 8.5600e-04
Loss = 7.4457e-03, PNorm = 76.1254, GNorm = 0.6025, lr_0 = 9.9344e-04
Validation rmse = 1.259831
Epoch 2
Loss = 4.9060e-03, PNorm = 76.2348, GNorm = 2.5507, lr_0 = 9.6130e-04
Loss = 5.8014e-03, PNorm = 76.3361, GNorm = 9.4117, lr_0 = 9.3019e-04
Validation rmse = 1.089552
Epoch 3
Loss = 4.5982e-03, PNorm = 76.4269, GNorm = 5.6252, lr_0 = 9.0009e-04
Loss = 6.1034e-03, PNorm = 76.5164, GNorm = 1.5026, lr_0 = 8.7096e-04
Loss = 7.2259e-03, PNorm = 76.6153, GNorm = 4.8315, lr_0 = 8.4278e-04
Validation rmse = 1.342935
Epoch 4
Loss = 4.5018e-03, PNorm = 76.6963, GNorm = 0.9764, lr_0 = 8.1551e-04
Loss = 3.7193e-03, PNorm = 76.7587, GNorm = 1.7284, lr_0 = 7.8912e-04
Validation rmse = 1.153597
Epoch 5
Loss = 4.1452e-03, PNorm = 76.8085, GNorm = 3.4639, lr_0 = 7.6358e-04
Loss = 3.1665e-03, PNorm = 76.8635, GNorm = 0.9283, lr_0 = 7.3888e-04
Loss = 2.8942e-03, PNorm = 76.9060, GNorm = 3.5513, lr_0 = 7.1497e-04
Validation rmse = 0.984495
Epoch 6
Loss = 2.5076e-03, PNorm = 76.9576, GNorm = 1.1992, lr_0 = 6.8956e-04
Loss = 2.5134e-03, PNorm = 76.9960, GNorm = 0.9314, lr_0 = 6.6725e-04
Loss = 2.6364e-03, PNorm = 77.0322, GNorm = 1.4891, lr_0 = 6.4565e-04
Validation rmse = 0.972181
Epoch 7
Loss = 2.0601e-03, PNorm = 77.0678, GNorm = 1.5712, lr_0 = 6.2476e-04
Loss = 2.2013e-03, PNorm = 77.0983, GNorm = 2.6626, lr_0 = 6.0454e-04
Validation rmse = 0.871139
Epoch 8
Loss = 1.8661e-03, PNorm = 77.1306, GNorm = 1.7132, lr_0 = 5.8498e-04
Loss = 2.2419e-03, PNorm = 77.1588, GNorm = 2.5004, lr_0 = 5.6605e-04
Loss = 1.7038e-03, PNorm = 77.1933, GNorm = 1.6434, lr_0 = 5.4774e-04
Validation rmse = 0.960224
Epoch 9
Loss = 1.8702e-03, PNorm = 77.2257, GNorm = 1.6426, lr_0 = 5.3001e-04
Loss = 1.5592e-03, PNorm = 77.2552, GNorm = 0.6004, lr_0 = 5.1286e-04
Validation rmse = 0.881618
Epoch 10
Loss = 1.7503e-03, PNorm = 77.2828, GNorm = 1.5479, lr_0 = 4.9627e-04
Loss = 1.6177e-03, PNorm = 77.3153, GNorm = 2.0977, lr_0 = 4.8021e-04
Loss = 1.6864e-03, PNorm = 77.3376, GNorm = 1.6850, lr_0 = 4.6467e-04
Validation rmse = 0.910866
Epoch 11
Loss = 1.3676e-03, PNorm = 77.3576, GNorm = 0.8313, lr_0 = 4.4963e-04
Loss = 1.2983e-03, PNorm = 77.3834, GNorm = 0.4894, lr_0 = 4.3508e-04
Validation rmse = 0.883623
Epoch 12
Loss = 1.2268e-03, PNorm = 77.4082, GNorm = 0.4278, lr_0 = 4.1962e-04
Loss = 1.4424e-03, PNorm = 77.4290, GNorm = 0.9341, lr_0 = 4.0604e-04
Loss = 1.3407e-03, PNorm = 77.4511, GNorm = 1.4237, lr_0 = 3.9290e-04
Validation rmse = 0.836436
Epoch 13
Loss = 1.0857e-03, PNorm = 77.4725, GNorm = 1.0936, lr_0 = 3.8019e-04
Loss = 1.1952e-03, PNorm = 77.4888, GNorm = 1.6628, lr_0 = 3.6789e-04
Loss = 1.1825e-03, PNorm = 77.5050, GNorm = 0.7729, lr_0 = 3.5598e-04
Validation rmse = 0.866042
Epoch 14
Loss = 1.1313e-03, PNorm = 77.5272, GNorm = 1.9066, lr_0 = 3.4446e-04
Loss = 8.9061e-04, PNorm = 77.5468, GNorm = 1.5468, lr_0 = 3.3332e-04
Validation rmse = 0.832247
Epoch 15
Loss = 1.0006e-03, PNorm = 77.5625, GNorm = 0.9447, lr_0 = 3.2253e-04
Loss = 1.1849e-03, PNorm = 77.5822, GNorm = 0.7807, lr_0 = 3.1209e-04
Loss = 1.0281e-03, PNorm = 77.6049, GNorm = 1.3341, lr_0 = 3.0200e-04
Validation rmse = 0.808706
Epoch 16
Loss = 8.9901e-04, PNorm = 77.6208, GNorm = 0.3982, lr_0 = 2.9222e-04
Loss = 9.5313e-04, PNorm = 77.6312, GNorm = 1.4434, lr_0 = 2.8277e-04
Validation rmse = 0.807453
Epoch 17
Loss = 8.6815e-04, PNorm = 77.6457, GNorm = 0.8553, lr_0 = 2.7272e-04
Loss = 8.7260e-04, PNorm = 77.6613, GNorm = 1.1511, lr_0 = 2.6389e-04
Loss = 8.9559e-04, PNorm = 77.6776, GNorm = 1.0891, lr_0 = 2.5535e-04
Validation rmse = 0.815597
Epoch 18
Loss = 8.0033e-04, PNorm = 77.6906, GNorm = 0.3894, lr_0 = 2.4709e-04
Loss = 7.1393e-04, PNorm = 77.7029, GNorm = 1.0802, lr_0 = 2.3910e-04
Loss = 7.0807e-04, PNorm = 77.7169, GNorm = 0.6415, lr_0 = 2.3136e-04
Validation rmse = 0.784100
Epoch 19
Loss = 7.3684e-04, PNorm = 77.7313, GNorm = 0.6810, lr_0 = 2.2387e-04
Loss = 7.9788e-04, PNorm = 77.7449, GNorm = 1.5028, lr_0 = 2.1663e-04
Validation rmse = 0.803090
Epoch 20
Loss = 7.3475e-04, PNorm = 77.7567, GNorm = 0.4728, lr_0 = 2.0962e-04
Loss = 7.9882e-04, PNorm = 77.7697, GNorm = 1.1649, lr_0 = 2.0283e-04
Loss = 7.6462e-04, PNorm = 77.7839, GNorm = 0.5040, lr_0 = 1.9627e-04
Validation rmse = 0.788941
Epoch 21
Loss = 5.8872e-04, PNorm = 77.7965, GNorm = 1.1452, lr_0 = 1.8992e-04
Loss = 5.6499e-04, PNorm = 77.8067, GNorm = 0.4095, lr_0 = 1.8377e-04
Validation rmse = 0.775865
Epoch 22
Loss = 6.2874e-04, PNorm = 77.8189, GNorm = 0.4398, lr_0 = 1.7783e-04
Loss = 6.2784e-04, PNorm = 77.8303, GNorm = 1.1449, lr_0 = 1.7207e-04
Loss = 6.1484e-04, PNorm = 77.8396, GNorm = 0.5553, lr_0 = 1.6651e-04
Validation rmse = 0.791220
Epoch 23
Loss = 5.4813e-04, PNorm = 77.8500, GNorm = 0.4337, lr_0 = 1.6059e-04
Loss = 6.3084e-04, PNorm = 77.8605, GNorm = 0.8105, lr_0 = 1.5539e-04
Validation rmse = 0.793240
Epoch 24
Loss = 6.4525e-04, PNorm = 77.8677, GNorm = 0.7312, lr_0 = 1.5036e-04
Loss = 5.2657e-04, PNorm = 77.8782, GNorm = 0.3907, lr_0 = 1.4550e-04
Loss = 5.5034e-04, PNorm = 77.8864, GNorm = 0.2841, lr_0 = 1.4079e-04
Validation rmse = 0.793761
Epoch 25
Loss = 4.2761e-04, PNorm = 77.8947, GNorm = 0.4674, lr_0 = 1.3623e-04
Loss = 5.1827e-04, PNorm = 77.9029, GNorm = 0.5043, lr_0 = 1.3183e-04
Loss = 4.9902e-04, PNorm = 77.9117, GNorm = 0.4873, lr_0 = 1.2756e-04
Validation rmse = 0.771298
Epoch 26
Loss = 4.2197e-04, PNorm = 77.9179, GNorm = 0.4589, lr_0 = 1.2343e-04
Loss = 5.1548e-04, PNorm = 77.9241, GNorm = 0.4607, lr_0 = 1.1944e-04
Validation rmse = 0.784671
Epoch 27
Loss = 4.6078e-04, PNorm = 77.9315, GNorm = 0.4452, lr_0 = 1.1557e-04
Loss = 4.7088e-04, PNorm = 77.9396, GNorm = 0.6567, lr_0 = 1.1183e-04
Loss = 4.8899e-04, PNorm = 77.9463, GNorm = 0.5516, lr_0 = 1.0821e-04
Validation rmse = 0.805184
Epoch 28
Loss = 4.5688e-04, PNorm = 77.9519, GNorm = 0.4752, lr_0 = 1.0437e-04
Loss = 4.1013e-04, PNorm = 77.9573, GNorm = 0.3715, lr_0 = 1.0099e-04
Validation rmse = 0.801218
Epoch 29
Loss = 4.9488e-04, PNorm = 77.9632, GNorm = 0.4140, lr_0 = 1.0000e-04
Loss = 4.8630e-04, PNorm = 77.9692, GNorm = 0.5620, lr_0 = 1.0000e-04
Loss = 4.9418e-04, PNorm = 77.9756, GNorm = 1.6637, lr_0 = 1.0000e-04
Validation rmse = 0.799414
Model 0 best validation rmse = 0.771298 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.757741
Ensemble test rmse = 0.757741
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 2.0927e-02, PNorm = 75.7839, GNorm = 3.0505, lr_0 = 2.9800e-04
Loss = 1.2491e-02, PNorm = 75.8377, GNorm = 3.5975, lr_0 = 4.7800e-04
Validation rmse = 1.548972
Epoch 1
Loss = 8.9260e-03, PNorm = 75.9242, GNorm = 3.1464, lr_0 = 6.7600e-04
Loss = 9.3664e-03, PNorm = 76.0183, GNorm = 6.2113, lr_0 = 8.5600e-04
Loss = 5.0514e-03, PNorm = 76.1087, GNorm = 1.2834, lr_0 = 9.9344e-04
Validation rmse = 1.324175
Epoch 2
Loss = 5.1366e-03, PNorm = 76.1983, GNorm = 0.8110, lr_0 = 9.6130e-04
Loss = 5.0451e-03, PNorm = 76.2824, GNorm = 2.3770, lr_0 = 9.3019e-04
Validation rmse = 1.137850
Epoch 3
Loss = 3.7864e-03, PNorm = 76.3517, GNorm = 2.8934, lr_0 = 9.0009e-04
Loss = 3.9454e-03, PNorm = 76.4163, GNorm = 0.5038, lr_0 = 8.7096e-04
Loss = 3.7202e-03, PNorm = 76.4745, GNorm = 3.5897, lr_0 = 8.4278e-04
Validation rmse = 0.876522
Epoch 4
Loss = 3.7567e-03, PNorm = 76.5209, GNorm = 2.0715, lr_0 = 8.1551e-04
Loss = 2.9370e-03, PNorm = 76.5696, GNorm = 4.5233, lr_0 = 7.8912e-04
Validation rmse = 0.952752
Epoch 5
Loss = 2.8459e-03, PNorm = 76.6194, GNorm = 3.2715, lr_0 = 7.6358e-04
Loss = 3.7928e-03, PNorm = 76.6647, GNorm = 2.5945, lr_0 = 7.3888e-04
Loss = 3.8875e-03, PNorm = 76.7180, GNorm = 3.3513, lr_0 = 7.1497e-04
Validation rmse = 0.981531
Epoch 6
Loss = 3.5534e-03, PNorm = 76.7746, GNorm = 0.5797, lr_0 = 6.8956e-04
Loss = 2.6764e-03, PNorm = 76.8310, GNorm = 1.1104, lr_0 = 6.6725e-04
Loss = 2.2462e-03, PNorm = 76.8704, GNorm = 2.8299, lr_0 = 6.4565e-04
Validation rmse = 0.777729
Epoch 7
Loss = 2.3151e-03, PNorm = 76.9048, GNorm = 2.2436, lr_0 = 6.2476e-04
Loss = 2.2841e-03, PNorm = 76.9352, GNorm = 2.5152, lr_0 = 6.0454e-04
Validation rmse = 0.738855
Epoch 8
Loss = 3.1992e-03, PNorm = 76.9737, GNorm = 3.0228, lr_0 = 5.8498e-04
Loss = 2.3575e-03, PNorm = 77.0167, GNorm = 1.8332, lr_0 = 5.6605e-04
Loss = 1.7990e-03, PNorm = 77.0496, GNorm = 1.4884, lr_0 = 5.4774e-04
Validation rmse = 0.813754
Epoch 9
Loss = 1.6270e-03, PNorm = 77.0827, GNorm = 1.8564, lr_0 = 5.3001e-04
Loss = 1.8144e-03, PNorm = 77.1149, GNorm = 0.9922, lr_0 = 5.1286e-04
Validation rmse = 0.744582
Epoch 10
Loss = 1.3360e-03, PNorm = 77.1352, GNorm = 0.7808, lr_0 = 4.9627e-04
Loss = 1.8519e-03, PNorm = 77.1628, GNorm = 1.0426, lr_0 = 4.8021e-04
Loss = 1.5627e-03, PNorm = 77.1852, GNorm = 1.4080, lr_0 = 4.6467e-04
Validation rmse = 0.759031
Epoch 11
Loss = 2.0617e-03, PNorm = 77.2126, GNorm = 4.5606, lr_0 = 4.4963e-04
Loss = 1.7884e-03, PNorm = 77.2395, GNorm = 1.1135, lr_0 = 4.3508e-04
Validation rmse = 0.762466
Epoch 12
Loss = 1.8275e-03, PNorm = 77.2699, GNorm = 2.6867, lr_0 = 4.1962e-04
Loss = 1.8381e-03, PNorm = 77.2964, GNorm = 0.7247, lr_0 = 4.0604e-04
Loss = 1.4849e-03, PNorm = 77.3197, GNorm = 1.0439, lr_0 = 3.9290e-04
Validation rmse = 0.731393
Epoch 13
Loss = 1.0773e-03, PNorm = 77.3397, GNorm = 0.5454, lr_0 = 3.8019e-04
Loss = 1.1583e-03, PNorm = 77.3590, GNorm = 0.6000, lr_0 = 3.6789e-04
Loss = 1.6591e-03, PNorm = 77.3733, GNorm = 0.8944, lr_0 = 3.5598e-04
Validation rmse = 0.767081
Epoch 14
Loss = 1.4716e-03, PNorm = 77.3923, GNorm = 2.0036, lr_0 = 3.4446e-04
Loss = 1.0296e-03, PNorm = 77.4095, GNorm = 0.3543, lr_0 = 3.3332e-04
Validation rmse = 0.676247
Epoch 15
Loss = 1.2634e-03, PNorm = 77.4268, GNorm = 1.1373, lr_0 = 3.2253e-04
Loss = 1.0933e-03, PNorm = 77.4440, GNorm = 1.0001, lr_0 = 3.1209e-04
Loss = 1.3227e-03, PNorm = 77.4665, GNorm = 1.3443, lr_0 = 3.0200e-04
Validation rmse = 0.679718
Epoch 16
Loss = 1.2804e-03, PNorm = 77.4845, GNorm = 0.7010, lr_0 = 2.9222e-04
Loss = 7.0790e-04, PNorm = 77.4992, GNorm = 0.6841, lr_0 = 2.8277e-04
Validation rmse = 0.657288
Epoch 17
Loss = 8.8435e-04, PNorm = 77.5148, GNorm = 0.6285, lr_0 = 2.7272e-04
Loss = 1.0802e-03, PNorm = 77.5319, GNorm = 0.6889, lr_0 = 2.6389e-04
Loss = 9.8718e-04, PNorm = 77.5473, GNorm = 0.7370, lr_0 = 2.5535e-04
Validation rmse = 0.673400
Epoch 18
Loss = 9.2502e-04, PNorm = 77.5627, GNorm = 1.1399, lr_0 = 2.4709e-04
Loss = 1.0510e-03, PNorm = 77.5772, GNorm = 0.6956, lr_0 = 2.3910e-04
Loss = 9.2425e-04, PNorm = 77.5929, GNorm = 1.1219, lr_0 = 2.3136e-04
Validation rmse = 0.680217
Epoch 19
Loss = 8.6634e-04, PNorm = 77.6050, GNorm = 1.4780, lr_0 = 2.2387e-04
Loss = 9.5879e-04, PNorm = 77.6194, GNorm = 1.3588, lr_0 = 2.1663e-04
Validation rmse = 0.656262
Epoch 20
Loss = 6.3452e-04, PNorm = 77.6358, GNorm = 0.9585, lr_0 = 2.0962e-04
Loss = 8.9709e-04, PNorm = 77.6477, GNorm = 0.6739, lr_0 = 2.0283e-04
Loss = 8.0100e-04, PNorm = 77.6595, GNorm = 0.7973, lr_0 = 1.9627e-04
Validation rmse = 0.660024
Epoch 21
Loss = 7.3195e-04, PNorm = 77.6712, GNorm = 0.7288, lr_0 = 1.8992e-04
Loss = 8.4002e-04, PNorm = 77.6813, GNorm = 1.0111, lr_0 = 1.8377e-04
Validation rmse = 0.660835
Epoch 22
Loss = 6.6347e-04, PNorm = 77.6940, GNorm = 0.4125, lr_0 = 1.7783e-04
Loss = 7.8521e-04, PNorm = 77.7038, GNorm = 1.1279, lr_0 = 1.7207e-04
Loss = 7.9254e-04, PNorm = 77.7155, GNorm = 0.5276, lr_0 = 1.6651e-04
Validation rmse = 0.653254
Epoch 23
Loss = 6.4395e-04, PNorm = 77.7294, GNorm = 0.5124, lr_0 = 1.6059e-04
Loss = 6.7482e-04, PNorm = 77.7395, GNorm = 0.4415, lr_0 = 1.5539e-04
Validation rmse = 0.672456
Epoch 24
Loss = 4.5909e-04, PNorm = 77.7497, GNorm = 0.5479, lr_0 = 1.5036e-04
Loss = 7.2472e-04, PNorm = 77.7598, GNorm = 0.4491, lr_0 = 1.4550e-04
Loss = 6.5164e-04, PNorm = 77.7707, GNorm = 0.4125, lr_0 = 1.4079e-04
Validation rmse = 0.632985
Epoch 25
Loss = 4.6102e-04, PNorm = 77.7798, GNorm = 0.3447, lr_0 = 1.3623e-04
Loss = 6.0649e-04, PNorm = 77.7883, GNorm = 0.5376, lr_0 = 1.3183e-04
Loss = 6.8713e-04, PNorm = 77.7986, GNorm = 0.7341, lr_0 = 1.2756e-04
Validation rmse = 0.694295
Epoch 26
Loss = 7.1018e-04, PNorm = 77.8064, GNorm = 1.4038, lr_0 = 1.2343e-04
Loss = 6.3909e-04, PNorm = 77.8152, GNorm = 0.4509, lr_0 = 1.1944e-04
Validation rmse = 0.647046
Epoch 27
Loss = 6.7641e-04, PNorm = 77.8221, GNorm = 0.3843, lr_0 = 1.1557e-04
Loss = 5.6945e-04, PNorm = 77.8303, GNorm = 0.8782, lr_0 = 1.1183e-04
Loss = 6.6126e-04, PNorm = 77.8395, GNorm = 0.6224, lr_0 = 1.0821e-04
Validation rmse = 0.669199
Epoch 28
Loss = 6.1674e-04, PNorm = 77.8463, GNorm = 0.3843, lr_0 = 1.0437e-04
Loss = 4.6716e-04, PNorm = 77.8529, GNorm = 0.6177, lr_0 = 1.0099e-04
Validation rmse = 0.659265
Epoch 29
Loss = 5.5510e-04, PNorm = 77.8592, GNorm = 1.1090, lr_0 = 1.0000e-04
Loss = 5.5039e-04, PNorm = 77.8676, GNorm = 0.8000, lr_0 = 1.0000e-04
Loss = 5.2428e-04, PNorm = 77.8747, GNorm = 1.1157, lr_0 = 1.0000e-04
Validation rmse = 0.642803
Model 0 best validation rmse = 0.632985 on epoch 24
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.606592
Ensemble test rmse = 0.606592
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 2.1318e-02, PNorm = 75.7827, GNorm = 11.5258, lr_0 = 2.9800e-04
Loss = 1.2628e-02, PNorm = 75.8448, GNorm = 2.6401, lr_0 = 4.7800e-04
Validation rmse = 1.355551
Epoch 1
Loss = 8.8233e-03, PNorm = 75.9402, GNorm = 5.9553, lr_0 = 6.7600e-04
Loss = 7.4861e-03, PNorm = 76.0350, GNorm = 2.2264, lr_0 = 8.5600e-04
Loss = 8.7938e-03, PNorm = 76.1484, GNorm = 4.8403, lr_0 = 9.9344e-04
Validation rmse = 1.427053
Epoch 2
Loss = 6.7418e-03, PNorm = 76.2578, GNorm = 3.8788, lr_0 = 9.6130e-04
Loss = 6.0044e-03, PNorm = 76.3557, GNorm = 3.2971, lr_0 = 9.3019e-04
Validation rmse = 1.006832
Epoch 3
Loss = 4.5072e-03, PNorm = 76.4316, GNorm = 0.7591, lr_0 = 9.0009e-04
Loss = 3.5533e-03, PNorm = 76.5001, GNorm = 1.8788, lr_0 = 8.7096e-04
Loss = 4.0565e-03, PNorm = 76.5573, GNorm = 1.3059, lr_0 = 8.4278e-04
Validation rmse = 0.945976
Epoch 4
Loss = 4.7145e-03, PNorm = 76.6215, GNorm = 1.4185, lr_0 = 8.1551e-04
Loss = 4.8366e-03, PNorm = 76.6891, GNorm = 0.6763, lr_0 = 7.8912e-04
Validation rmse = 0.841521
Epoch 5
Loss = 3.4473e-03, PNorm = 76.7461, GNorm = 1.2924, lr_0 = 7.6358e-04
Loss = 2.7531e-03, PNorm = 76.8042, GNorm = 1.4315, lr_0 = 7.3888e-04
Loss = 3.1486e-03, PNorm = 76.8525, GNorm = 2.0932, lr_0 = 7.1497e-04
Validation rmse = 0.730249
Epoch 6
Loss = 2.6840e-03, PNorm = 76.8950, GNorm = 1.8273, lr_0 = 6.8956e-04
Loss = 2.4555e-03, PNorm = 76.9324, GNorm = 1.8471, lr_0 = 6.6725e-04
Loss = 2.5655e-03, PNorm = 76.9705, GNorm = 1.2888, lr_0 = 6.4565e-04
Validation rmse = 0.919972
Epoch 7
Loss = 2.3742e-03, PNorm = 77.0108, GNorm = 1.1204, lr_0 = 6.2476e-04
Loss = 1.9112e-03, PNorm = 77.0522, GNorm = 0.7228, lr_0 = 6.0454e-04
Validation rmse = 0.705231
Epoch 8
Loss = 1.9719e-03, PNorm = 77.0885, GNorm = 0.7242, lr_0 = 5.8498e-04
Loss = 1.5835e-03, PNorm = 77.1156, GNorm = 0.9930, lr_0 = 5.6605e-04
Loss = 1.9085e-03, PNorm = 77.1405, GNorm = 1.5475, lr_0 = 5.4774e-04
Validation rmse = 0.658996
Epoch 9
Loss = 1.8315e-03, PNorm = 77.1734, GNorm = 2.8920, lr_0 = 5.3001e-04
Loss = 2.0022e-03, PNorm = 77.2084, GNorm = 0.9260, lr_0 = 5.1286e-04
Validation rmse = 0.650790
Epoch 10
Loss = 1.3942e-03, PNorm = 77.2365, GNorm = 0.3819, lr_0 = 4.9627e-04
Loss = 1.4431e-03, PNorm = 77.2622, GNorm = 0.8469, lr_0 = 4.8021e-04
Loss = 2.0313e-03, PNorm = 77.2978, GNorm = 1.0909, lr_0 = 4.6467e-04
Validation rmse = 0.672920
Epoch 11
Loss = 1.6665e-03, PNorm = 77.3188, GNorm = 1.1236, lr_0 = 4.4963e-04
Loss = 1.6209e-03, PNorm = 77.3477, GNorm = 0.9272, lr_0 = 4.3508e-04
Validation rmse = 0.652174
Epoch 12
Loss = 8.9981e-04, PNorm = 77.3695, GNorm = 0.9237, lr_0 = 4.1962e-04
Loss = 1.6163e-03, PNorm = 77.3907, GNorm = 3.2042, lr_0 = 4.0604e-04
Loss = 1.3420e-03, PNorm = 77.4143, GNorm = 1.6621, lr_0 = 3.9290e-04
Validation rmse = 0.625095
Epoch 13
Loss = 1.3319e-03, PNorm = 77.4372, GNorm = 0.7375, lr_0 = 3.8019e-04
Loss = 1.2857e-03, PNorm = 77.4574, GNorm = 2.5768, lr_0 = 3.6789e-04
Loss = 1.5802e-03, PNorm = 77.4775, GNorm = 2.7723, lr_0 = 3.5598e-04
Validation rmse = 0.628256
Epoch 14
Loss = 1.2608e-03, PNorm = 77.4940, GNorm = 2.2074, lr_0 = 3.4446e-04
Loss = 1.4806e-03, PNorm = 77.5192, GNorm = 1.4847, lr_0 = 3.3332e-04
Validation rmse = 0.826980
Epoch 15
Loss = 1.6880e-03, PNorm = 77.5399, GNorm = 0.9894, lr_0 = 3.2253e-04
Loss = 1.3272e-03, PNorm = 77.5575, GNorm = 0.9798, lr_0 = 3.1209e-04
Loss = 1.4096e-03, PNorm = 77.5787, GNorm = 2.5059, lr_0 = 3.0200e-04
Validation rmse = 0.638217
Epoch 16
Loss = 1.0160e-03, PNorm = 77.5928, GNorm = 0.4444, lr_0 = 2.9222e-04
Loss = 9.9352e-04, PNorm = 77.6095, GNorm = 1.0754, lr_0 = 2.8277e-04
Validation rmse = 0.611372
Epoch 17
Loss = 7.1604e-04, PNorm = 77.6271, GNorm = 1.1132, lr_0 = 2.7272e-04
Loss = 8.2306e-04, PNorm = 77.6426, GNorm = 0.5211, lr_0 = 2.6389e-04
Loss = 1.1344e-03, PNorm = 77.6585, GNorm = 2.8000, lr_0 = 2.5535e-04
Validation rmse = 0.606260
Epoch 18
Loss = 9.5953e-04, PNorm = 77.6732, GNorm = 1.1712, lr_0 = 2.4709e-04
Loss = 1.0556e-03, PNorm = 77.6912, GNorm = 1.1774, lr_0 = 2.3910e-04
Loss = 8.4293e-04, PNorm = 77.7008, GNorm = 0.7553, lr_0 = 2.3136e-04
Validation rmse = 0.615602
Epoch 19
Loss = 1.0407e-03, PNorm = 77.7158, GNorm = 1.7260, lr_0 = 2.2387e-04
Loss = 7.9020e-04, PNorm = 77.7282, GNorm = 0.8242, lr_0 = 2.1663e-04
Validation rmse = 0.605981
Epoch 20
Loss = 7.6189e-04, PNorm = 77.7384, GNorm = 1.7316, lr_0 = 2.0962e-04
Loss = 7.2417e-04, PNorm = 77.7510, GNorm = 0.7905, lr_0 = 2.0283e-04
Loss = 7.4640e-04, PNorm = 77.7602, GNorm = 0.5687, lr_0 = 1.9627e-04
Validation rmse = 0.599582
Epoch 21
Loss = 6.8903e-04, PNorm = 77.7706, GNorm = 0.5336, lr_0 = 1.8992e-04
Loss = 7.0783e-04, PNorm = 77.7824, GNorm = 1.0804, lr_0 = 1.8377e-04
Validation rmse = 0.620409
Epoch 22
Loss = 7.0413e-04, PNorm = 77.7930, GNorm = 0.4665, lr_0 = 1.7783e-04
Loss = 8.5040e-04, PNorm = 77.8045, GNorm = 0.9347, lr_0 = 1.7207e-04
Loss = 6.8916e-04, PNorm = 77.8155, GNorm = 1.4715, lr_0 = 1.6651e-04
Validation rmse = 0.608373
Epoch 23
Loss = 6.8461e-04, PNorm = 77.8244, GNorm = 0.7497, lr_0 = 1.6059e-04
Loss = 7.3328e-04, PNorm = 77.8344, GNorm = 0.7244, lr_0 = 1.5539e-04
Validation rmse = 0.586218
Epoch 24
Loss = 6.0488e-04, PNorm = 77.8440, GNorm = 0.2825, lr_0 = 1.5036e-04
Loss = 5.7814e-04, PNorm = 77.8538, GNorm = 1.0846, lr_0 = 1.4550e-04
Loss = 5.4262e-04, PNorm = 77.8622, GNorm = 0.8375, lr_0 = 1.4079e-04
Validation rmse = 0.598886
Epoch 25
Loss = 6.2748e-04, PNorm = 77.8716, GNorm = 1.4602, lr_0 = 1.3623e-04
Loss = 6.3332e-04, PNorm = 77.8817, GNorm = 0.9006, lr_0 = 1.3183e-04
Loss = 5.9645e-04, PNorm = 77.8886, GNorm = 0.7978, lr_0 = 1.2756e-04
Validation rmse = 0.592180
Epoch 26
Loss = 5.0767e-04, PNorm = 77.8956, GNorm = 1.1487, lr_0 = 1.2343e-04
Loss = 5.7384e-04, PNorm = 77.9047, GNorm = 0.3051, lr_0 = 1.1944e-04
Validation rmse = 0.611474
Epoch 27
Loss = 7.1037e-04, PNorm = 77.9116, GNorm = 0.9467, lr_0 = 1.1557e-04
Loss = 6.3599e-04, PNorm = 77.9190, GNorm = 0.5806, lr_0 = 1.1183e-04
Loss = 4.8784e-04, PNorm = 77.9246, GNorm = 0.9918, lr_0 = 1.0821e-04
Validation rmse = 0.619888
Epoch 28
Loss = 6.0492e-04, PNorm = 77.9313, GNorm = 0.3959, lr_0 = 1.0437e-04
Loss = 5.5544e-04, PNorm = 77.9383, GNorm = 0.3982, lr_0 = 1.0099e-04
Validation rmse = 0.605548
Epoch 29
Loss = 6.2957e-04, PNorm = 77.9449, GNorm = 0.3264, lr_0 = 1.0000e-04
Loss = 4.7735e-04, PNorm = 77.9522, GNorm = 1.4977, lr_0 = 1.0000e-04
Loss = 4.4770e-04, PNorm = 77.9580, GNorm = 0.7577, lr_0 = 1.0000e-04
Validation rmse = 0.605484
Model 0 best validation rmse = 0.586218 on epoch 23
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.637968
Ensemble test rmse = 0.637968
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 2.0461e-02, PNorm = 75.7817, GNorm = 9.5453, lr_0 = 2.9800e-04
Loss = 1.1190e-02, PNorm = 75.8414, GNorm = 1.7019, lr_0 = 4.7800e-04
Validation rmse = 1.248214
Epoch 1
Loss = 5.3406e-03, PNorm = 75.9320, GNorm = 2.0125, lr_0 = 6.7600e-04
Loss = 7.1934e-03, PNorm = 76.0187, GNorm = 14.3222, lr_0 = 8.5600e-04
Loss = 9.3319e-03, PNorm = 76.1300, GNorm = 3.6782, lr_0 = 9.9344e-04
Validation rmse = 1.090971
Epoch 2
Loss = 6.3016e-03, PNorm = 76.2400, GNorm = 3.7327, lr_0 = 9.6130e-04
Loss = 5.0837e-03, PNorm = 76.3277, GNorm = 2.6311, lr_0 = 9.3019e-04
Validation rmse = 0.948045
Epoch 3
Loss = 3.3237e-03, PNorm = 76.4110, GNorm = 1.4663, lr_0 = 9.0009e-04
Loss = 4.3061e-03, PNorm = 76.4800, GNorm = 5.8133, lr_0 = 8.7096e-04
Loss = 4.4534e-03, PNorm = 76.5420, GNorm = 2.8178, lr_0 = 8.4278e-04
Validation rmse = 0.841540
Epoch 4
Loss = 3.1373e-03, PNorm = 76.5880, GNorm = 3.3460, lr_0 = 8.1551e-04
Loss = 3.9124e-03, PNorm = 76.6332, GNorm = 4.3181, lr_0 = 7.8912e-04
Validation rmse = 0.844346
Epoch 5
Loss = 2.8504e-03, PNorm = 76.6812, GNorm = 2.8903, lr_0 = 7.6358e-04
Loss = 2.3380e-03, PNorm = 76.7198, GNorm = 0.7274, lr_0 = 7.3888e-04
Loss = 3.0507e-03, PNorm = 76.7589, GNorm = 2.9427, lr_0 = 7.1497e-04
Validation rmse = 0.799322
Epoch 6
Loss = 2.4457e-03, PNorm = 76.8076, GNorm = 1.2634, lr_0 = 6.8956e-04
Loss = 2.4816e-03, PNorm = 76.8379, GNorm = 2.0030, lr_0 = 6.6725e-04
Loss = 2.6072e-03, PNorm = 76.8739, GNorm = 4.0595, lr_0 = 6.4565e-04
Validation rmse = 0.703852
Epoch 7
Loss = 2.0566e-03, PNorm = 76.9107, GNorm = 1.8667, lr_0 = 6.2476e-04
Loss = 2.3515e-03, PNorm = 76.9447, GNorm = 1.4408, lr_0 = 6.0454e-04
Validation rmse = 0.755795
Epoch 8
Loss = 1.6961e-03, PNorm = 76.9760, GNorm = 0.8209, lr_0 = 5.8498e-04
Loss = 1.8209e-03, PNorm = 77.0079, GNorm = 1.1142, lr_0 = 5.6605e-04
Loss = 1.7425e-03, PNorm = 77.0387, GNorm = 1.2412, lr_0 = 5.4774e-04
Validation rmse = 0.706025
Epoch 9
Loss = 1.7699e-03, PNorm = 77.0705, GNorm = 0.5770, lr_0 = 5.3001e-04
Loss = 1.7154e-03, PNorm = 77.1038, GNorm = 1.0367, lr_0 = 5.1286e-04
Validation rmse = 0.645046
Epoch 10
Loss = 1.0268e-03, PNorm = 77.1336, GNorm = 0.9258, lr_0 = 4.9627e-04
Loss = 1.4274e-03, PNorm = 77.1620, GNorm = 0.9387, lr_0 = 4.8021e-04
Loss = 1.4646e-03, PNorm = 77.1848, GNorm = 1.4332, lr_0 = 4.6467e-04
Validation rmse = 0.645093
Epoch 11
Loss = 1.2394e-03, PNorm = 77.2110, GNorm = 1.2158, lr_0 = 4.4963e-04
Loss = 1.6406e-03, PNorm = 77.2399, GNorm = 1.3972, lr_0 = 4.3508e-04
Validation rmse = 0.710585
Epoch 12
Loss = 1.7810e-03, PNorm = 77.2700, GNorm = 1.6272, lr_0 = 4.1962e-04
Loss = 1.5094e-03, PNorm = 77.2969, GNorm = 0.9191, lr_0 = 4.0604e-04
Loss = 1.2961e-03, PNorm = 77.3257, GNorm = 0.6568, lr_0 = 3.9290e-04
Validation rmse = 0.642301
Epoch 13
Loss = 1.4075e-03, PNorm = 77.3465, GNorm = 1.1980, lr_0 = 3.8019e-04
Loss = 1.2483e-03, PNorm = 77.3665, GNorm = 0.6286, lr_0 = 3.6789e-04
Loss = 1.2671e-03, PNorm = 77.3936, GNorm = 1.2736, lr_0 = 3.5598e-04
Validation rmse = 0.633127
Epoch 14
Loss = 1.1566e-03, PNorm = 77.4191, GNorm = 1.9508, lr_0 = 3.4446e-04
Loss = 1.1977e-03, PNorm = 77.4402, GNorm = 2.1694, lr_0 = 3.3332e-04
Validation rmse = 0.644442
Epoch 15
Loss = 1.0273e-03, PNorm = 77.4590, GNorm = 1.0676, lr_0 = 3.2253e-04
Loss = 1.0719e-03, PNorm = 77.4823, GNorm = 1.6523, lr_0 = 3.1209e-04
Loss = 1.0258e-03, PNorm = 77.5032, GNorm = 0.9703, lr_0 = 3.0200e-04
Validation rmse = 0.645665
Epoch 16
Loss = 1.1198e-03, PNorm = 77.5220, GNorm = 0.7815, lr_0 = 2.9222e-04
Loss = 1.1131e-03, PNorm = 77.5453, GNorm = 0.3847, lr_0 = 2.8277e-04
Validation rmse = 0.618899
Epoch 17
Loss = 9.4353e-04, PNorm = 77.5648, GNorm = 1.7144, lr_0 = 2.7272e-04
Loss = 8.6286e-04, PNorm = 77.5804, GNorm = 1.1187, lr_0 = 2.6389e-04
Loss = 9.0148e-04, PNorm = 77.5974, GNorm = 1.3893, lr_0 = 2.5535e-04
Validation rmse = 0.613262
Epoch 18
Loss = 7.6508e-04, PNorm = 77.6142, GNorm = 1.2958, lr_0 = 2.4709e-04
Loss = 1.0038e-03, PNorm = 77.6300, GNorm = 0.5074, lr_0 = 2.3910e-04
Loss = 8.2241e-04, PNorm = 77.6479, GNorm = 0.8798, lr_0 = 2.3136e-04
Validation rmse = 0.613350
Epoch 19
Loss = 8.3582e-04, PNorm = 77.6659, GNorm = 0.6945, lr_0 = 2.2387e-04
Loss = 6.8644e-04, PNorm = 77.6815, GNorm = 1.3470, lr_0 = 2.1663e-04
Validation rmse = 0.584126
Epoch 20
Loss = 6.7024e-04, PNorm = 77.6946, GNorm = 0.4360, lr_0 = 2.0962e-04
Loss = 7.4280e-04, PNorm = 77.7086, GNorm = 0.6575, lr_0 = 2.0283e-04
Loss = 1.1326e-03, PNorm = 77.7220, GNorm = 1.8640, lr_0 = 1.9627e-04
Validation rmse = 0.649582
Epoch 21
Loss = 7.1215e-04, PNorm = 77.7353, GNorm = 0.3843, lr_0 = 1.8992e-04
Loss = 7.9255e-04, PNorm = 77.7500, GNorm = 0.4684, lr_0 = 1.8377e-04
Validation rmse = 0.612741
Epoch 22
Loss = 8.7527e-04, PNorm = 77.7609, GNorm = 0.6918, lr_0 = 1.7783e-04
Loss = 7.5601e-04, PNorm = 77.7718, GNorm = 1.1291, lr_0 = 1.7207e-04
Loss = 5.9008e-04, PNorm = 77.7815, GNorm = 0.5567, lr_0 = 1.6651e-04
Validation rmse = 0.606105
Epoch 23
Loss = 6.8475e-04, PNorm = 77.7942, GNorm = 0.8448, lr_0 = 1.6059e-04
Loss = 5.6315e-04, PNorm = 77.8033, GNorm = 0.3059, lr_0 = 1.5539e-04
Validation rmse = 0.617439
Epoch 24
Loss = 5.7575e-04, PNorm = 77.8137, GNorm = 1.1029, lr_0 = 1.5036e-04
Loss = 5.4121e-04, PNorm = 77.8240, GNorm = 0.3149, lr_0 = 1.4550e-04
Loss = 5.1839e-04, PNorm = 77.8327, GNorm = 0.9981, lr_0 = 1.4079e-04
Validation rmse = 0.663610
Epoch 25
Loss = 6.4106e-04, PNorm = 77.8411, GNorm = 2.0679, lr_0 = 1.3623e-04
Loss = 6.4311e-04, PNorm = 77.8488, GNorm = 2.1723, lr_0 = 1.3183e-04
Loss = 7.0840e-04, PNorm = 77.8569, GNorm = 0.8047, lr_0 = 1.2756e-04
Validation rmse = 0.622212
Epoch 26
Loss = 6.2602e-04, PNorm = 77.8657, GNorm = 0.5684, lr_0 = 1.2343e-04
Loss = 5.2269e-04, PNorm = 77.8753, GNorm = 0.4051, lr_0 = 1.1944e-04
Validation rmse = 0.596516
Epoch 27
Loss = 4.6115e-04, PNorm = 77.8831, GNorm = 0.4482, lr_0 = 1.1557e-04
Loss = 4.8316e-04, PNorm = 77.8910, GNorm = 0.4296, lr_0 = 1.1183e-04
Loss = 4.9649e-04, PNorm = 77.8973, GNorm = 0.5052, lr_0 = 1.0821e-04
Validation rmse = 0.602753
Epoch 28
Loss = 4.3180e-04, PNorm = 77.9037, GNorm = 0.2703, lr_0 = 1.0437e-04
Loss = 5.2035e-04, PNorm = 77.9104, GNorm = 0.3138, lr_0 = 1.0099e-04
Validation rmse = 0.587192
Epoch 29
Loss = 3.5781e-04, PNorm = 77.9170, GNorm = 0.6353, lr_0 = 1.0000e-04
Loss = 3.8682e-04, PNorm = 77.9230, GNorm = 0.5896, lr_0 = 1.0000e-04
Loss = 5.5749e-04, PNorm = 77.9285, GNorm = 0.4005, lr_0 = 1.0000e-04
Validation rmse = 0.597845
Model 0 best validation rmse = 0.584126 on epoch 19
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.866818
Ensemble test rmse = 0.866818
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 2.1273e-02, PNorm = 75.7827, GNorm = 5.7596, lr_0 = 2.9800e-04
Loss = 1.3319e-02, PNorm = 75.8422, GNorm = 13.4306, lr_0 = 4.7800e-04
Validation rmse = 1.931354
Epoch 1
Loss = 9.8342e-03, PNorm = 75.9349, GNorm = 2.4603, lr_0 = 6.7600e-04
Loss = 7.7812e-03, PNorm = 76.0308, GNorm = 2.3092, lr_0 = 8.5600e-04
Loss = 6.5326e-03, PNorm = 76.1324, GNorm = 1.2248, lr_0 = 9.9344e-04
Validation rmse = 1.249191
Epoch 2
Loss = 5.6022e-03, PNorm = 76.2338, GNorm = 1.4607, lr_0 = 9.6130e-04
Loss = 5.1348e-03, PNorm = 76.3269, GNorm = 2.7437, lr_0 = 9.3019e-04
Validation rmse = 0.955304
Epoch 3
Loss = 3.5176e-03, PNorm = 76.4077, GNorm = 1.4371, lr_0 = 9.0009e-04
Loss = 4.7149e-03, PNorm = 76.4721, GNorm = 2.4768, lr_0 = 8.7096e-04
Loss = 4.0771e-03, PNorm = 76.5366, GNorm = 2.6946, lr_0 = 8.4278e-04
Validation rmse = 0.947118
Epoch 4
Loss = 2.9216e-03, PNorm = 76.5915, GNorm = 3.8357, lr_0 = 8.1551e-04
Loss = 2.9683e-03, PNorm = 76.6422, GNorm = 3.8027, lr_0 = 7.8912e-04
Validation rmse = 0.970993
Epoch 5
Loss = 2.7944e-03, PNorm = 76.6898, GNorm = 2.6320, lr_0 = 7.6358e-04
Loss = 2.3369e-03, PNorm = 76.7313, GNorm = 3.7506, lr_0 = 7.3888e-04
Loss = 3.1803e-03, PNorm = 76.7744, GNorm = 1.8772, lr_0 = 7.1497e-04
Validation rmse = 0.986723
Epoch 6
Loss = 2.1794e-03, PNorm = 76.8172, GNorm = 0.6506, lr_0 = 6.8956e-04
Loss = 3.4844e-03, PNorm = 76.8616, GNorm = 2.9574, lr_0 = 6.6725e-04
Loss = 2.7798e-03, PNorm = 76.9060, GNorm = 3.7940, lr_0 = 6.4565e-04
Validation rmse = 0.917271
Epoch 7
Loss = 2.0243e-03, PNorm = 76.9412, GNorm = 0.5662, lr_0 = 6.2476e-04
Loss = 2.3082e-03, PNorm = 76.9672, GNorm = 3.1373, lr_0 = 6.0454e-04
Validation rmse = 0.813269
Epoch 8
Loss = 2.3263e-03, PNorm = 77.0036, GNorm = 4.2674, lr_0 = 5.8498e-04
Loss = 2.7038e-03, PNorm = 77.0411, GNorm = 0.7181, lr_0 = 5.6605e-04
Loss = 1.8044e-03, PNorm = 77.0702, GNorm = 0.6157, lr_0 = 5.4774e-04
Validation rmse = 0.799577
Epoch 9
Loss = 1.6939e-03, PNorm = 77.0968, GNorm = 3.5280, lr_0 = 5.3001e-04
Loss = 1.8448e-03, PNorm = 77.1235, GNorm = 1.1531, lr_0 = 5.1286e-04
Validation rmse = 0.801955
Epoch 10
Loss = 1.5339e-03, PNorm = 77.1475, GNorm = 0.6542, lr_0 = 4.9627e-04
Loss = 1.7616e-03, PNorm = 77.1725, GNorm = 0.9622, lr_0 = 4.8021e-04
Loss = 1.4248e-03, PNorm = 77.1966, GNorm = 1.9163, lr_0 = 4.6467e-04
Validation rmse = 0.820732
Epoch 11
Loss = 1.6758e-03, PNorm = 77.2176, GNorm = 4.4884, lr_0 = 4.4963e-04
Loss = 2.7722e-03, PNorm = 77.2462, GNorm = 3.1431, lr_0 = 4.3508e-04
Validation rmse = 0.912601
Epoch 12
Loss = 1.5452e-03, PNorm = 77.2783, GNorm = 1.3449, lr_0 = 4.1962e-04
Loss = 1.6249e-03, PNorm = 77.3115, GNorm = 0.8921, lr_0 = 4.0604e-04
Loss = 1.4157e-03, PNorm = 77.3355, GNorm = 0.7858, lr_0 = 3.9290e-04
Validation rmse = 0.777391
Epoch 13
Loss = 1.4268e-03, PNorm = 77.3540, GNorm = 1.8641, lr_0 = 3.8019e-04
Loss = 1.3865e-03, PNorm = 77.3730, GNorm = 1.2599, lr_0 = 3.6789e-04
Loss = 1.3247e-03, PNorm = 77.3906, GNorm = 1.6089, lr_0 = 3.5598e-04
Validation rmse = 0.880673
Epoch 14
Loss = 1.6439e-03, PNorm = 77.4127, GNorm = 1.8960, lr_0 = 3.4446e-04
Loss = 1.3349e-03, PNorm = 77.4335, GNorm = 1.7871, lr_0 = 3.3332e-04
Validation rmse = 0.752397
Epoch 15
Loss = 1.0021e-03, PNorm = 77.4540, GNorm = 2.6864, lr_0 = 3.2253e-04
Loss = 1.1443e-03, PNorm = 77.4697, GNorm = 0.6738, lr_0 = 3.1209e-04
Loss = 9.7935e-04, PNorm = 77.4857, GNorm = 1.1312, lr_0 = 3.0200e-04
Validation rmse = 0.784162
Epoch 16
Loss = 1.0613e-03, PNorm = 77.5037, GNorm = 0.6181, lr_0 = 2.9222e-04
Loss = 1.1369e-03, PNorm = 77.5192, GNorm = 0.9448, lr_0 = 2.8277e-04
Validation rmse = 0.748574
Epoch 17
Loss = 1.4098e-03, PNorm = 77.5370, GNorm = 1.3808, lr_0 = 2.7272e-04
Loss = 1.0567e-03, PNorm = 77.5545, GNorm = 0.5738, lr_0 = 2.6389e-04
Loss = 8.9360e-04, PNorm = 77.5692, GNorm = 0.3932, lr_0 = 2.5535e-04
Validation rmse = 0.743804
Epoch 18
Loss = 7.3016e-04, PNorm = 77.5839, GNorm = 0.7909, lr_0 = 2.4709e-04
Loss = 1.0106e-03, PNorm = 77.5991, GNorm = 1.1431, lr_0 = 2.3910e-04
Loss = 9.4339e-04, PNorm = 77.6152, GNorm = 0.3810, lr_0 = 2.3136e-04
Validation rmse = 0.763576
Epoch 19
Loss = 8.5802e-04, PNorm = 77.6286, GNorm = 0.8501, lr_0 = 2.2387e-04
Loss = 8.8931e-04, PNorm = 77.6438, GNorm = 0.5787, lr_0 = 2.1663e-04
Validation rmse = 0.753948
Epoch 20
Loss = 5.7648e-04, PNorm = 77.6574, GNorm = 0.3936, lr_0 = 2.0962e-04
Loss = 8.2680e-04, PNorm = 77.6688, GNorm = 0.6076, lr_0 = 2.0283e-04
Loss = 8.0539e-04, PNorm = 77.6802, GNorm = 1.6599, lr_0 = 1.9627e-04
Validation rmse = 0.757264
Epoch 21
Loss = 7.0108e-04, PNorm = 77.6925, GNorm = 0.4205, lr_0 = 1.8992e-04
Loss = 7.4757e-04, PNorm = 77.7052, GNorm = 1.0247, lr_0 = 1.8377e-04
Validation rmse = 0.740734
Epoch 22
Loss = 7.1704e-04, PNorm = 77.7167, GNorm = 0.5875, lr_0 = 1.7783e-04
Loss = 7.3620e-04, PNorm = 77.7244, GNorm = 1.3962, lr_0 = 1.7207e-04
Loss = 8.7140e-04, PNorm = 77.7360, GNorm = 1.0340, lr_0 = 1.6651e-04
Validation rmse = 0.747031
Epoch 23
Loss = 7.0883e-04, PNorm = 77.7501, GNorm = 0.8959, lr_0 = 1.6059e-04
Loss = 6.3646e-04, PNorm = 77.7601, GNorm = 0.8620, lr_0 = 1.5539e-04
Validation rmse = 0.754880
Epoch 24
Loss = 4.9390e-04, PNorm = 77.7696, GNorm = 0.4350, lr_0 = 1.5036e-04
Loss = 7.7371e-04, PNorm = 77.7782, GNorm = 2.0960, lr_0 = 1.4550e-04
Loss = 7.6338e-04, PNorm = 77.7888, GNorm = 0.6780, lr_0 = 1.4079e-04
Validation rmse = 0.734766
Epoch 25
Loss = 5.8996e-04, PNorm = 77.7985, GNorm = 0.6804, lr_0 = 1.3623e-04
Loss = 6.2424e-04, PNorm = 77.8071, GNorm = 0.8127, lr_0 = 1.3183e-04
Loss = 6.2379e-04, PNorm = 77.8150, GNorm = 0.6218, lr_0 = 1.2756e-04
Validation rmse = 0.753294
Epoch 26
Loss = 5.6991e-04, PNorm = 77.8233, GNorm = 0.8384, lr_0 = 1.2343e-04
Loss = 6.0060e-04, PNorm = 77.8306, GNorm = 0.9436, lr_0 = 1.1944e-04
Validation rmse = 0.729727
Epoch 27
Loss = 6.2612e-04, PNorm = 77.8393, GNorm = 0.7380, lr_0 = 1.1557e-04
Loss = 5.0357e-04, PNorm = 77.8464, GNorm = 0.4545, lr_0 = 1.1183e-04
Loss = 5.5795e-04, PNorm = 77.8528, GNorm = 0.3566, lr_0 = 1.0821e-04
Validation rmse = 0.725057
Epoch 28
Loss = 4.2940e-04, PNorm = 77.8616, GNorm = 0.3692, lr_0 = 1.0437e-04
Loss = 6.3387e-04, PNorm = 77.8685, GNorm = 0.2435, lr_0 = 1.0099e-04
Validation rmse = 0.790422
Epoch 29
Loss = 9.6672e-04, PNorm = 77.8762, GNorm = 0.4857, lr_0 = 1.0000e-04
Loss = 5.0445e-04, PNorm = 77.8834, GNorm = 0.7680, lr_0 = 1.0000e-04
Loss = 4.0512e-04, PNorm = 77.8900, GNorm = 0.4669, lr_0 = 1.0000e-04
Validation rmse = 0.725693
Model 0 best validation rmse = 0.725057 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.030011
Ensemble test rmse = 1.030011
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 1.9851e-02, PNorm = 75.7838, GNorm = 2.1212, lr_0 = 2.9800e-04
Loss = 1.3735e-02, PNorm = 75.8412, GNorm = 10.6059, lr_0 = 4.7800e-04
Validation rmse = 1.755342
Epoch 1
Loss = 9.1657e-03, PNorm = 75.9366, GNorm = 2.7332, lr_0 = 6.7600e-04
Loss = 8.0930e-03, PNorm = 76.0390, GNorm = 2.3145, lr_0 = 8.5600e-04
Loss = 1.0814e-02, PNorm = 76.1582, GNorm = 6.1058, lr_0 = 9.9344e-04
Validation rmse = 2.195776
Epoch 2
Loss = 8.0416e-03, PNorm = 76.3058, GNorm = 4.7247, lr_0 = 9.6130e-04
Loss = 7.1854e-03, PNorm = 76.4224, GNorm = 2.3022, lr_0 = 9.3019e-04
Validation rmse = 1.243735
Epoch 3
Loss = 4.9242e-03, PNorm = 76.5081, GNorm = 3.1966, lr_0 = 9.0009e-04
Loss = 4.7999e-03, PNorm = 76.5834, GNorm = 1.5152, lr_0 = 8.7096e-04
Loss = 4.5989e-03, PNorm = 76.6478, GNorm = 3.6787, lr_0 = 8.4278e-04
Validation rmse = 1.006472
Epoch 4
Loss = 3.3301e-03, PNorm = 76.7111, GNorm = 3.7734, lr_0 = 8.1551e-04
Loss = 3.4105e-03, PNorm = 76.7559, GNorm = 1.3774, lr_0 = 7.8912e-04
Validation rmse = 1.224555
Epoch 5
Loss = 3.9804e-03, PNorm = 76.8030, GNorm = 4.2213, lr_0 = 7.6358e-04
Loss = 3.2911e-03, PNorm = 76.8529, GNorm = 2.0025, lr_0 = 7.3888e-04
Loss = 3.6266e-03, PNorm = 76.9046, GNorm = 1.4444, lr_0 = 7.1497e-04
Validation rmse = 0.968597
Epoch 6
Loss = 2.4563e-03, PNorm = 76.9619, GNorm = 1.5794, lr_0 = 6.8956e-04
Loss = 2.9575e-03, PNorm = 77.0064, GNorm = 0.9320, lr_0 = 6.6725e-04
Loss = 2.1785e-03, PNorm = 77.0442, GNorm = 2.0196, lr_0 = 6.4565e-04
Validation rmse = 0.922622
Epoch 7
Loss = 2.0022e-03, PNorm = 77.0809, GNorm = 0.8005, lr_0 = 6.2476e-04
Loss = 2.1823e-03, PNorm = 77.1171, GNorm = 2.7463, lr_0 = 6.0454e-04
Validation rmse = 1.093092
Epoch 8
Loss = 1.9885e-03, PNorm = 77.1498, GNorm = 0.6998, lr_0 = 5.8498e-04
Loss = 2.0635e-03, PNorm = 77.1860, GNorm = 2.4073, lr_0 = 5.6605e-04
Loss = 2.1007e-03, PNorm = 77.2171, GNorm = 0.6201, lr_0 = 5.4774e-04
Validation rmse = 0.985526
Epoch 9
Loss = 1.8103e-03, PNorm = 77.2419, GNorm = 1.7425, lr_0 = 5.3001e-04
Loss = 2.0253e-03, PNorm = 77.2741, GNorm = 1.6272, lr_0 = 5.1286e-04
Validation rmse = 0.927040
Epoch 10
Loss = 1.4051e-03, PNorm = 77.3091, GNorm = 1.9155, lr_0 = 4.9627e-04
Loss = 1.5571e-03, PNorm = 77.3383, GNorm = 0.5196, lr_0 = 4.8021e-04
Loss = 2.0030e-03, PNorm = 77.3661, GNorm = 1.1698, lr_0 = 4.6467e-04
Validation rmse = 0.877272
Epoch 11
Loss = 1.3946e-03, PNorm = 77.4000, GNorm = 1.9386, lr_0 = 4.4963e-04
Loss = 2.0056e-03, PNorm = 77.4310, GNorm = 2.9587, lr_0 = 4.3508e-04
Validation rmse = 0.992915
Epoch 12
Loss = 1.8774e-03, PNorm = 77.4603, GNorm = 1.6500, lr_0 = 4.1962e-04
Loss = 1.4587e-03, PNorm = 77.4848, GNorm = 1.1136, lr_0 = 4.0604e-04
Loss = 1.2959e-03, PNorm = 77.5060, GNorm = 1.5591, lr_0 = 3.9290e-04
Validation rmse = 0.983118
Epoch 13
Loss = 1.5703e-03, PNorm = 77.5340, GNorm = 3.8687, lr_0 = 3.8019e-04
Loss = 1.2598e-03, PNorm = 77.5544, GNorm = 1.1658, lr_0 = 3.6789e-04
Loss = 1.3156e-03, PNorm = 77.5725, GNorm = 2.1192, lr_0 = 3.5598e-04
Validation rmse = 0.824434
Epoch 14
Loss = 1.7321e-03, PNorm = 77.6017, GNorm = 3.9705, lr_0 = 3.4446e-04
Loss = 1.3361e-03, PNorm = 77.6249, GNorm = 0.5561, lr_0 = 3.3332e-04
Validation rmse = 0.928173
Epoch 15
Loss = 1.5663e-03, PNorm = 77.6429, GNorm = 1.6258, lr_0 = 3.2253e-04
Loss = 1.0977e-03, PNorm = 77.6628, GNorm = 0.8156, lr_0 = 3.1209e-04
Loss = 1.0388e-03, PNorm = 77.6825, GNorm = 0.7704, lr_0 = 3.0200e-04
Validation rmse = 0.867516
Epoch 16
Loss = 1.1788e-03, PNorm = 77.7003, GNorm = 1.1243, lr_0 = 2.9222e-04
Loss = 1.0338e-03, PNorm = 77.7185, GNorm = 2.2661, lr_0 = 2.8277e-04
Validation rmse = 0.870008
Epoch 17
Loss = 1.2381e-03, PNorm = 77.7385, GNorm = 1.0821, lr_0 = 2.7272e-04
Loss = 1.0663e-03, PNorm = 77.7585, GNorm = 0.6446, lr_0 = 2.6389e-04
Loss = 8.8775e-04, PNorm = 77.7804, GNorm = 0.9549, lr_0 = 2.5535e-04
Validation rmse = 0.821158
Epoch 18
Loss = 9.7463e-04, PNorm = 77.7892, GNorm = 1.0496, lr_0 = 2.4709e-04
Loss = 8.7323e-04, PNorm = 77.8021, GNorm = 0.4748, lr_0 = 2.3910e-04
Loss = 9.0089e-04, PNorm = 77.8173, GNorm = 0.8248, lr_0 = 2.3136e-04
Validation rmse = 0.873072
Epoch 19
Loss = 9.2424e-04, PNorm = 77.8313, GNorm = 1.2863, lr_0 = 2.2387e-04
Loss = 9.9004e-04, PNorm = 77.8443, GNorm = 1.0147, lr_0 = 2.1663e-04
Validation rmse = 0.830142
Epoch 20
Loss = 7.8762e-04, PNorm = 77.8571, GNorm = 0.4868, lr_0 = 2.0962e-04
Loss = 8.5652e-04, PNorm = 77.8734, GNorm = 1.1527, lr_0 = 2.0283e-04
Loss = 7.9542e-04, PNorm = 77.8854, GNorm = 0.6170, lr_0 = 1.9627e-04
Validation rmse = 0.842479
Epoch 21
Loss = 7.7819e-04, PNorm = 77.8975, GNorm = 1.0818, lr_0 = 1.8992e-04
Loss = 7.3886e-04, PNorm = 77.9089, GNorm = 0.7112, lr_0 = 1.8377e-04
Validation rmse = 0.814791
Epoch 22
Loss = 6.1038e-04, PNorm = 77.9202, GNorm = 0.3957, lr_0 = 1.7783e-04
Loss = 5.2999e-04, PNorm = 77.9312, GNorm = 0.9049, lr_0 = 1.7207e-04
Loss = 7.7382e-04, PNorm = 77.9408, GNorm = 0.8319, lr_0 = 1.6651e-04
Validation rmse = 0.884976
Epoch 23
Loss = 6.6726e-04, PNorm = 77.9521, GNorm = 0.3579, lr_0 = 1.6059e-04
Loss = 6.0738e-04, PNorm = 77.9628, GNorm = 0.9619, lr_0 = 1.5539e-04
Validation rmse = 0.811968
Epoch 24
Loss = 6.2746e-04, PNorm = 77.9724, GNorm = 0.9939, lr_0 = 1.5036e-04
Loss = 7.5053e-04, PNorm = 77.9851, GNorm = 0.5330, lr_0 = 1.4550e-04
Loss = 6.4404e-04, PNorm = 77.9953, GNorm = 0.5664, lr_0 = 1.4079e-04
Validation rmse = 0.782449
Epoch 25
Loss = 6.1000e-04, PNorm = 78.0042, GNorm = 0.5031, lr_0 = 1.3623e-04
Loss = 5.6381e-04, PNorm = 78.0137, GNorm = 0.5963, lr_0 = 1.3183e-04
Loss = 6.0369e-04, PNorm = 78.0218, GNorm = 0.4516, lr_0 = 1.2756e-04
Validation rmse = 0.791711
Epoch 26
Loss = 5.9165e-04, PNorm = 78.0294, GNorm = 1.0532, lr_0 = 1.2343e-04
Loss = 5.4294e-04, PNorm = 78.0374, GNorm = 1.6447, lr_0 = 1.1944e-04
Validation rmse = 0.820926
Epoch 27
Loss = 4.8250e-04, PNorm = 78.0438, GNorm = 0.6212, lr_0 = 1.1557e-04
Loss = 5.9629e-04, PNorm = 78.0525, GNorm = 1.7214, lr_0 = 1.1183e-04
Loss = 6.2598e-04, PNorm = 78.0595, GNorm = 0.6273, lr_0 = 1.0821e-04
Validation rmse = 0.789097
Epoch 28
Loss = 6.0996e-04, PNorm = 78.0686, GNorm = 0.3587, lr_0 = 1.0437e-04
Loss = 5.0208e-04, PNorm = 78.0740, GNorm = 1.0414, lr_0 = 1.0099e-04
Validation rmse = 0.780912
Epoch 29
Loss = 3.6266e-04, PNorm = 78.0801, GNorm = 1.0533, lr_0 = 1.0000e-04
Loss = 5.5526e-04, PNorm = 78.0864, GNorm = 1.0163, lr_0 = 1.0000e-04
Loss = 5.1681e-04, PNorm = 78.0931, GNorm = 0.8159, lr_0 = 1.0000e-04
Validation rmse = 0.793743
Model 0 best validation rmse = 0.780912 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.672819
Ensemble test rmse = 0.672819
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 2.1084e-02, PNorm = 75.7813, GNorm = 5.3755, lr_0 = 2.9800e-04
Loss = 1.3358e-02, PNorm = 75.8440, GNorm = 7.5289, lr_0 = 4.7800e-04
Validation rmse = 1.672724
Epoch 1
Loss = 7.9857e-03, PNorm = 75.9464, GNorm = 4.7157, lr_0 = 6.7600e-04
Loss = 8.1691e-03, PNorm = 76.0408, GNorm = 5.3821, lr_0 = 8.5600e-04
Loss = 6.5282e-03, PNorm = 76.1513, GNorm = 0.9386, lr_0 = 9.9344e-04
Validation rmse = 1.461707
Epoch 2
Loss = 7.5279e-03, PNorm = 76.2572, GNorm = 2.4318, lr_0 = 9.6130e-04
Loss = 5.6514e-03, PNorm = 76.3438, GNorm = 2.6224, lr_0 = 9.3019e-04
Validation rmse = 1.346432
Epoch 3
Loss = 5.9752e-03, PNorm = 76.4345, GNorm = 2.2031, lr_0 = 9.0009e-04
Loss = 5.1268e-03, PNorm = 76.5203, GNorm = 1.2827, lr_0 = 8.7096e-04
Loss = 3.5355e-03, PNorm = 76.5834, GNorm = 1.4317, lr_0 = 8.4278e-04
Validation rmse = 1.188904
Epoch 4
Loss = 2.9726e-03, PNorm = 76.6427, GNorm = 0.9467, lr_0 = 8.1551e-04
Loss = 3.4852e-03, PNorm = 76.6890, GNorm = 1.2995, lr_0 = 7.8912e-04
Validation rmse = 1.248562
Epoch 5
Loss = 3.9653e-03, PNorm = 76.7359, GNorm = 4.9797, lr_0 = 7.6358e-04
Loss = 2.9271e-03, PNorm = 76.7816, GNorm = 1.0452, lr_0 = 7.3888e-04
Loss = 2.7825e-03, PNorm = 76.8258, GNorm = 0.8524, lr_0 = 7.1497e-04
Validation rmse = 1.192090
Epoch 6
Loss = 2.3088e-03, PNorm = 76.8804, GNorm = 2.3177, lr_0 = 6.8956e-04
Loss = 2.2870e-03, PNorm = 76.9251, GNorm = 4.4715, lr_0 = 6.6725e-04
Loss = 2.8262e-03, PNorm = 76.9622, GNorm = 1.8146, lr_0 = 6.4565e-04
Validation rmse = 1.054853
Epoch 7
Loss = 2.3319e-03, PNorm = 77.0023, GNorm = 1.3574, lr_0 = 6.2476e-04
Loss = 1.7862e-03, PNorm = 77.0426, GNorm = 1.0106, lr_0 = 6.0454e-04
Validation rmse = 0.963235
Epoch 8
Loss = 2.0453e-03, PNorm = 77.0731, GNorm = 3.2096, lr_0 = 5.8498e-04
Loss = 1.6736e-03, PNorm = 77.1074, GNorm = 1.5325, lr_0 = 5.6605e-04
Loss = 1.8243e-03, PNorm = 77.1368, GNorm = 1.4398, lr_0 = 5.4774e-04
Validation rmse = 1.033555
Epoch 9
Loss = 1.8557e-03, PNorm = 77.1739, GNorm = 1.4359, lr_0 = 5.3001e-04
Loss = 1.3070e-03, PNorm = 77.2060, GNorm = 0.7261, lr_0 = 5.1286e-04
Validation rmse = 0.965369
Epoch 10
Loss = 1.6303e-03, PNorm = 77.2386, GNorm = 1.8392, lr_0 = 4.9627e-04
Loss = 1.9235e-03, PNorm = 77.2715, GNorm = 0.8994, lr_0 = 4.8021e-04
Loss = 1.8152e-03, PNorm = 77.2988, GNorm = 1.3139, lr_0 = 4.6467e-04
Validation rmse = 1.121954
Epoch 11
Loss = 1.9786e-03, PNorm = 77.3308, GNorm = 1.4227, lr_0 = 4.4963e-04
Loss = 1.3357e-03, PNorm = 77.3581, GNorm = 0.7893, lr_0 = 4.3508e-04
Validation rmse = 0.999607
Epoch 12
Loss = 1.1806e-03, PNorm = 77.3887, GNorm = 0.6773, lr_0 = 4.1962e-04
Loss = 1.1835e-03, PNorm = 77.4129, GNorm = 0.7833, lr_0 = 4.0604e-04
Loss = 1.3799e-03, PNorm = 77.4309, GNorm = 1.4706, lr_0 = 3.9290e-04
Validation rmse = 1.030719
Epoch 13
Loss = 1.3331e-03, PNorm = 77.4592, GNorm = 2.0728, lr_0 = 3.8019e-04
Loss = 1.2267e-03, PNorm = 77.4812, GNorm = 1.2444, lr_0 = 3.6789e-04
Loss = 1.1629e-03, PNorm = 77.5033, GNorm = 0.4067, lr_0 = 3.5598e-04
Validation rmse = 0.960963
Epoch 14
Loss = 1.0705e-03, PNorm = 77.5236, GNorm = 1.0791, lr_0 = 3.4446e-04
Loss = 9.6436e-04, PNorm = 77.5421, GNorm = 0.6992, lr_0 = 3.3332e-04
Validation rmse = 0.949664
Epoch 15
Loss = 6.2379e-04, PNorm = 77.5640, GNorm = 0.3375, lr_0 = 3.2253e-04
Loss = 1.1868e-03, PNorm = 77.5827, GNorm = 2.3168, lr_0 = 3.1209e-04
Loss = 9.5850e-04, PNorm = 77.6014, GNorm = 1.3395, lr_0 = 3.0200e-04
Validation rmse = 0.966402
Epoch 16
Loss = 1.0682e-03, PNorm = 77.6179, GNorm = 0.8816, lr_0 = 2.9222e-04
Loss = 1.0326e-03, PNorm = 77.6373, GNorm = 0.7394, lr_0 = 2.8277e-04
Validation rmse = 0.949398
Epoch 17
Loss = 8.3610e-04, PNorm = 77.6613, GNorm = 0.6770, lr_0 = 2.7272e-04
Loss = 9.3340e-04, PNorm = 77.6780, GNorm = 0.6563, lr_0 = 2.6389e-04
Loss = 9.5056e-04, PNorm = 77.6957, GNorm = 1.5004, lr_0 = 2.5535e-04
Validation rmse = 1.015093
Epoch 18
Loss = 1.2545e-03, PNorm = 77.7109, GNorm = 0.5426, lr_0 = 2.4709e-04
Loss = 9.8067e-04, PNorm = 77.7277, GNorm = 0.8039, lr_0 = 2.3910e-04
Loss = 9.3638e-04, PNorm = 77.7416, GNorm = 0.9667, lr_0 = 2.3136e-04
Validation rmse = 0.958469
Epoch 19
Loss = 8.0750e-04, PNorm = 77.7546, GNorm = 0.5984, lr_0 = 2.2387e-04
Loss = 7.6416e-04, PNorm = 77.7696, GNorm = 0.9872, lr_0 = 2.1663e-04
Validation rmse = 0.936879
Epoch 20
Loss = 8.1426e-04, PNorm = 77.7818, GNorm = 1.1265, lr_0 = 2.0962e-04
Loss = 6.4898e-04, PNorm = 77.7963, GNorm = 0.4756, lr_0 = 2.0283e-04
Loss = 7.8752e-04, PNorm = 77.8097, GNorm = 0.4123, lr_0 = 1.9627e-04
Validation rmse = 0.939398
Epoch 21
Loss = 6.2711e-04, PNorm = 77.8209, GNorm = 0.4273, lr_0 = 1.8992e-04
Loss = 6.6536e-04, PNorm = 77.8325, GNorm = 1.4076, lr_0 = 1.8377e-04
Validation rmse = 0.935479
Epoch 22
Loss = 6.2053e-04, PNorm = 77.8418, GNorm = 0.6166, lr_0 = 1.7783e-04
Loss = 6.1995e-04, PNorm = 77.8522, GNorm = 0.4251, lr_0 = 1.7207e-04
Loss = 7.0291e-04, PNorm = 77.8631, GNorm = 1.1323, lr_0 = 1.6651e-04
Validation rmse = 0.930000
Epoch 23
Loss = 5.7182e-04, PNorm = 77.8744, GNorm = 1.3157, lr_0 = 1.6059e-04
Loss = 7.5759e-04, PNorm = 77.8838, GNorm = 1.1197, lr_0 = 1.5539e-04
Validation rmse = 0.948140
Epoch 24
Loss = 6.6851e-04, PNorm = 77.8941, GNorm = 1.0704, lr_0 = 1.5036e-04
Loss = 5.9732e-04, PNorm = 77.9038, GNorm = 0.5111, lr_0 = 1.4550e-04
Loss = 6.5345e-04, PNorm = 77.9139, GNorm = 0.4597, lr_0 = 1.4079e-04
Validation rmse = 0.923550
Epoch 25
Loss = 5.9674e-04, PNorm = 77.9225, GNorm = 0.5208, lr_0 = 1.3623e-04
Loss = 4.8185e-04, PNorm = 77.9297, GNorm = 0.5788, lr_0 = 1.3183e-04
Loss = 6.2896e-04, PNorm = 77.9381, GNorm = 0.4293, lr_0 = 1.2756e-04
Validation rmse = 0.929427
Epoch 26
Loss = 5.3135e-04, PNorm = 77.9452, GNorm = 1.3029, lr_0 = 1.2343e-04
Loss = 5.8340e-04, PNorm = 77.9534, GNorm = 0.7252, lr_0 = 1.1944e-04
Validation rmse = 0.928112
Epoch 27
Loss = 5.4348e-04, PNorm = 77.9616, GNorm = 0.7352, lr_0 = 1.1557e-04
Loss = 4.7726e-04, PNorm = 77.9686, GNorm = 1.2346, lr_0 = 1.1183e-04
Loss = 5.8659e-04, PNorm = 77.9765, GNorm = 0.9089, lr_0 = 1.0821e-04
Validation rmse = 0.954492
Epoch 28
Loss = 4.9094e-04, PNorm = 77.9835, GNorm = 0.3224, lr_0 = 1.0437e-04
Loss = 4.9730e-04, PNorm = 77.9905, GNorm = 1.4850, lr_0 = 1.0099e-04
Validation rmse = 0.922104
Epoch 29
Loss = 4.3098e-04, PNorm = 77.9966, GNorm = 0.6974, lr_0 = 1.0000e-04
Loss = 3.9609e-04, PNorm = 78.0018, GNorm = 0.3412, lr_0 = 1.0000e-04
Loss = 5.6524e-04, PNorm = 78.0078, GNorm = 0.3102, lr_0 = 1.0000e-04
Validation rmse = 0.923840
Model 0 best validation rmse = 0.922104 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.752020
Ensemble test rmse = 0.752020
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 1.5681e-02, PNorm = 75.7839, GNorm = 2.7702, lr_0 = 2.9800e-04
Loss = 1.0953e-02, PNorm = 75.8381, GNorm = 3.8422, lr_0 = 4.7800e-04
Validation rmse = 1.300758
Epoch 1
Loss = 9.0399e-03, PNorm = 75.9305, GNorm = 3.5541, lr_0 = 6.7600e-04
Loss = 8.5297e-03, PNorm = 76.0368, GNorm = 4.8235, lr_0 = 8.5600e-04
Loss = 6.2227e-03, PNorm = 76.1626, GNorm = 1.0130, lr_0 = 9.9344e-04
Validation rmse = 1.654987
Epoch 2
Loss = 6.3802e-03, PNorm = 76.2886, GNorm = 3.3133, lr_0 = 9.6130e-04
Loss = 5.9280e-03, PNorm = 76.3937, GNorm = 6.0222, lr_0 = 9.3019e-04
Validation rmse = 1.162245
Epoch 3
Loss = 4.4018e-03, PNorm = 76.4953, GNorm = 3.6005, lr_0 = 9.0009e-04
Loss = 3.8771e-03, PNorm = 76.5765, GNorm = 1.5884, lr_0 = 8.7096e-04
Loss = 4.3147e-03, PNorm = 76.6511, GNorm = 6.9617, lr_0 = 8.4278e-04
Validation rmse = 1.056633
Epoch 4
Loss = 4.0000e-03, PNorm = 76.7131, GNorm = 2.9410, lr_0 = 8.1551e-04
Loss = 3.4204e-03, PNorm = 76.7700, GNorm = 2.8409, lr_0 = 7.8912e-04
Validation rmse = 0.919412
Epoch 5
Loss = 2.7994e-03, PNorm = 76.8238, GNorm = 2.3208, lr_0 = 7.6358e-04
Loss = 3.0390e-03, PNorm = 76.8831, GNorm = 5.6798, lr_0 = 7.3888e-04
Loss = 2.9683e-03, PNorm = 76.9313, GNorm = 0.7654, lr_0 = 7.1497e-04
Validation rmse = 0.847467
Epoch 6
Loss = 2.4546e-03, PNorm = 76.9746, GNorm = 1.8490, lr_0 = 6.8956e-04
Loss = 2.7656e-03, PNorm = 77.0151, GNorm = 5.0108, lr_0 = 6.6725e-04
Loss = 2.9573e-03, PNorm = 77.0587, GNorm = 4.9065, lr_0 = 6.4565e-04
Validation rmse = 0.911755
Epoch 7
Loss = 3.0711e-03, PNorm = 77.1112, GNorm = 2.1031, lr_0 = 6.2476e-04
Loss = 2.1980e-03, PNorm = 77.1504, GNorm = 0.6517, lr_0 = 6.0454e-04
Validation rmse = 0.812524
Epoch 8
Loss = 1.2582e-03, PNorm = 77.1833, GNorm = 1.2804, lr_0 = 5.8498e-04
Loss = 1.7972e-03, PNorm = 77.2129, GNorm = 3.0843, lr_0 = 5.6605e-04
Loss = 1.6846e-03, PNorm = 77.2459, GNorm = 1.4032, lr_0 = 5.4774e-04
Validation rmse = 0.836338
Epoch 9
Loss = 1.5470e-03, PNorm = 77.2790, GNorm = 0.7251, lr_0 = 5.3001e-04
Loss = 1.9844e-03, PNorm = 77.3066, GNorm = 1.0281, lr_0 = 5.1286e-04
Validation rmse = 0.877995
Epoch 10
Loss = 2.0730e-03, PNorm = 77.3351, GNorm = 3.1003, lr_0 = 4.9627e-04
Loss = 1.4017e-03, PNorm = 77.3665, GNorm = 1.0062, lr_0 = 4.8021e-04
Loss = 1.5712e-03, PNorm = 77.3895, GNorm = 1.4156, lr_0 = 4.6467e-04
Validation rmse = 0.827503
Epoch 11
Loss = 1.4264e-03, PNorm = 77.4093, GNorm = 0.6921, lr_0 = 4.4963e-04
Loss = 1.1663e-03, PNorm = 77.4291, GNorm = 0.4236, lr_0 = 4.3508e-04
Validation rmse = 0.750808
Epoch 12
Loss = 1.2916e-03, PNorm = 77.4502, GNorm = 1.4928, lr_0 = 4.1962e-04
Loss = 1.0777e-03, PNorm = 77.4706, GNorm = 0.7499, lr_0 = 4.0604e-04
Loss = 1.3430e-03, PNorm = 77.4886, GNorm = 0.8939, lr_0 = 3.9290e-04
Validation rmse = 0.776085
Epoch 13
Loss = 1.3321e-03, PNorm = 77.5073, GNorm = 1.1279, lr_0 = 3.8019e-04
Loss = 1.0443e-03, PNorm = 77.5272, GNorm = 0.5937, lr_0 = 3.6789e-04
Loss = 1.2740e-03, PNorm = 77.5466, GNorm = 1.4956, lr_0 = 3.5598e-04
Validation rmse = 0.743735
Epoch 14
Loss = 9.3407e-04, PNorm = 77.5650, GNorm = 0.6877, lr_0 = 3.4446e-04
Loss = 1.1869e-03, PNorm = 77.5880, GNorm = 1.1746, lr_0 = 3.3332e-04
Validation rmse = 0.765236
Epoch 15
Loss = 5.2481e-04, PNorm = 77.6066, GNorm = 0.6279, lr_0 = 3.2253e-04
Loss = 1.0765e-03, PNorm = 77.6242, GNorm = 1.5363, lr_0 = 3.1209e-04
Loss = 1.0103e-03, PNorm = 77.6444, GNorm = 0.5828, lr_0 = 3.0200e-04
Validation rmse = 0.765146
Epoch 16
Loss = 7.7173e-04, PNorm = 77.6600, GNorm = 1.1428, lr_0 = 2.9222e-04
Loss = 9.5182e-04, PNorm = 77.6733, GNorm = 1.1933, lr_0 = 2.8277e-04
Validation rmse = 0.813291
Epoch 17
Loss = 7.9236e-04, PNorm = 77.6909, GNorm = 0.8552, lr_0 = 2.7272e-04
Loss = 7.4487e-04, PNorm = 77.7051, GNorm = 0.5618, lr_0 = 2.6389e-04
Loss = 9.4749e-04, PNorm = 77.7194, GNorm = 1.8354, lr_0 = 2.5535e-04
Validation rmse = 0.765154
Epoch 18
Loss = 8.2271e-04, PNorm = 77.7354, GNorm = 0.7297, lr_0 = 2.4709e-04
Loss = 7.7844e-04, PNorm = 77.7463, GNorm = 0.4184, lr_0 = 2.3910e-04
Loss = 8.1990e-04, PNorm = 77.7604, GNorm = 1.2688, lr_0 = 2.3136e-04
Validation rmse = 0.778858
Epoch 19
Loss = 8.0094e-04, PNorm = 77.7733, GNorm = 2.4525, lr_0 = 2.2387e-04
Loss = 7.8270e-04, PNorm = 77.7854, GNorm = 0.7241, lr_0 = 2.1663e-04
Validation rmse = 0.753629
Epoch 20
Loss = 9.4081e-04, PNorm = 77.7977, GNorm = 0.7235, lr_0 = 2.0962e-04
Loss = 7.2190e-04, PNorm = 77.8099, GNorm = 1.8426, lr_0 = 2.0283e-04
Loss = 7.0036e-04, PNorm = 77.8217, GNorm = 0.4954, lr_0 = 1.9627e-04
Validation rmse = 0.731104
Epoch 21
Loss = 6.8737e-04, PNorm = 77.8325, GNorm = 1.7705, lr_0 = 1.8992e-04
Loss = 6.5737e-04, PNorm = 77.8432, GNorm = 0.5254, lr_0 = 1.8377e-04
Validation rmse = 0.744026
Epoch 22
Loss = 5.8223e-04, PNorm = 77.8515, GNorm = 0.3309, lr_0 = 1.7783e-04
Loss = 5.7769e-04, PNorm = 77.8615, GNorm = 0.8495, lr_0 = 1.7207e-04
Loss = 6.3713e-04, PNorm = 77.8720, GNorm = 0.5316, lr_0 = 1.6651e-04
Validation rmse = 0.753631
Epoch 23
Loss = 4.6745e-04, PNorm = 77.8822, GNorm = 0.4636, lr_0 = 1.6059e-04
Loss = 5.9673e-04, PNorm = 77.8902, GNorm = 0.3221, lr_0 = 1.5539e-04
Validation rmse = 0.749823
Epoch 24
Loss = 3.0316e-04, PNorm = 77.8981, GNorm = 0.2723, lr_0 = 1.5036e-04
Loss = 5.5427e-04, PNorm = 77.9061, GNorm = 0.6088, lr_0 = 1.4550e-04
Loss = 5.6722e-04, PNorm = 77.9158, GNorm = 0.7490, lr_0 = 1.4079e-04
Validation rmse = 0.733855
Epoch 25
Loss = 4.5440e-04, PNorm = 77.9249, GNorm = 0.3674, lr_0 = 1.3623e-04
Loss = 5.5155e-04, PNorm = 77.9326, GNorm = 0.4297, lr_0 = 1.3183e-04
Loss = 5.8101e-04, PNorm = 77.9415, GNorm = 0.4506, lr_0 = 1.2756e-04
Validation rmse = 0.729347
Epoch 26
Loss = 4.0119e-04, PNorm = 77.9493, GNorm = 0.3100, lr_0 = 1.2343e-04
Loss = 4.9581e-04, PNorm = 77.9567, GNorm = 0.5109, lr_0 = 1.1944e-04
Validation rmse = 0.730748
Epoch 27
Loss = 4.4483e-04, PNorm = 77.9637, GNorm = 1.3980, lr_0 = 1.1557e-04
Loss = 5.8980e-04, PNorm = 77.9703, GNorm = 0.3053, lr_0 = 1.1183e-04
Loss = 5.6789e-04, PNorm = 77.9771, GNorm = 0.6821, lr_0 = 1.0821e-04
Validation rmse = 0.716827
Epoch 28
Loss = 5.0494e-04, PNorm = 77.9828, GNorm = 0.3723, lr_0 = 1.0437e-04
Loss = 4.6850e-04, PNorm = 77.9892, GNorm = 0.4171, lr_0 = 1.0099e-04
Validation rmse = 0.720497
Epoch 29
Loss = 3.1986e-04, PNorm = 77.9958, GNorm = 0.5035, lr_0 = 1.0000e-04
Loss = 4.9012e-04, PNorm = 78.0025, GNorm = 1.0804, lr_0 = 1.0000e-04
Loss = 5.6965e-04, PNorm = 78.0092, GNorm = 1.4871, lr_0 = 1.0000e-04
Validation rmse = 0.715603
Model 0 best validation rmse = 0.715603 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.707304
Ensemble test rmse = 0.707304
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 2.3349e-02, PNorm = 75.7834, GNorm = 7.5468, lr_0 = 2.9800e-04
Loss = 1.3759e-02, PNorm = 75.8491, GNorm = 2.2462, lr_0 = 4.7800e-04
Validation rmse = 1.847796
Epoch 1
Loss = 1.0606e-02, PNorm = 75.9527, GNorm = 5.2483, lr_0 = 6.7600e-04
Loss = 8.8139e-03, PNorm = 76.0571, GNorm = 2.4218, lr_0 = 8.5600e-04
Loss = 6.7912e-03, PNorm = 76.1540, GNorm = 2.0051, lr_0 = 9.9344e-04
Validation rmse = 1.394384
Epoch 2
Loss = 6.2784e-03, PNorm = 76.2541, GNorm = 3.6372, lr_0 = 9.6130e-04
Loss = 4.9815e-03, PNorm = 76.3407, GNorm = 5.6320, lr_0 = 9.3019e-04
Validation rmse = 1.321677
Epoch 3
Loss = 5.3053e-03, PNorm = 76.4263, GNorm = 3.9702, lr_0 = 9.0009e-04
Loss = 4.8070e-03, PNorm = 76.4976, GNorm = 2.6231, lr_0 = 8.7096e-04
Loss = 4.3285e-03, PNorm = 76.5630, GNorm = 5.4156, lr_0 = 8.4278e-04
Validation rmse = 1.125107
Epoch 4
Loss = 4.5026e-03, PNorm = 76.6181, GNorm = 1.0674, lr_0 = 8.1551e-04
Loss = 4.1224e-03, PNorm = 76.6722, GNorm = 3.6388, lr_0 = 7.8912e-04
Validation rmse = 1.124417
Epoch 5
Loss = 2.0640e-03, PNorm = 76.7174, GNorm = 1.7986, lr_0 = 7.6358e-04
Loss = 2.7548e-03, PNorm = 76.7604, GNorm = 1.0109, lr_0 = 7.3888e-04
Loss = 3.6488e-03, PNorm = 76.8012, GNorm = 0.7001, lr_0 = 7.1497e-04
Validation rmse = 1.104025
Epoch 6
Loss = 2.7984e-03, PNorm = 76.8524, GNorm = 0.8712, lr_0 = 6.8956e-04
Loss = 2.4808e-03, PNorm = 76.8963, GNorm = 1.2233, lr_0 = 6.6725e-04
Loss = 2.4885e-03, PNorm = 76.9241, GNorm = 1.9834, lr_0 = 6.4565e-04
Validation rmse = 0.943339
Epoch 7
Loss = 2.1224e-03, PNorm = 76.9605, GNorm = 0.7042, lr_0 = 6.2476e-04
Loss = 2.0601e-03, PNorm = 76.9908, GNorm = 1.5521, lr_0 = 6.0454e-04
Validation rmse = 0.944691
Epoch 8
Loss = 1.8483e-03, PNorm = 77.0217, GNorm = 2.1713, lr_0 = 5.8498e-04
Loss = 1.9585e-03, PNorm = 77.0533, GNorm = 0.9191, lr_0 = 5.6605e-04
Loss = 1.6151e-03, PNorm = 77.0783, GNorm = 1.0245, lr_0 = 5.4774e-04
Validation rmse = 0.961750
Epoch 9
Loss = 1.6113e-03, PNorm = 77.1011, GNorm = 0.8038, lr_0 = 5.3001e-04
Loss = 1.6191e-03, PNorm = 77.1324, GNorm = 1.4596, lr_0 = 5.1286e-04
Validation rmse = 0.914776
Epoch 10
Loss = 1.7349e-03, PNorm = 77.1566, GNorm = 3.1748, lr_0 = 4.9627e-04
Loss = 2.7285e-03, PNorm = 77.1840, GNorm = 4.2980, lr_0 = 4.8021e-04
Loss = 2.3829e-03, PNorm = 77.2156, GNorm = 2.6401, lr_0 = 4.6467e-04
Validation rmse = 0.944141
Epoch 11
Loss = 2.0761e-03, PNorm = 77.2463, GNorm = 1.2324, lr_0 = 4.4963e-04
Loss = 1.7497e-03, PNorm = 77.2763, GNorm = 2.2934, lr_0 = 4.3508e-04
Validation rmse = 0.902512
Epoch 12
Loss = 1.6308e-03, PNorm = 77.3047, GNorm = 1.0080, lr_0 = 4.1962e-04
Loss = 1.4392e-03, PNorm = 77.3249, GNorm = 2.5039, lr_0 = 4.0604e-04
Loss = 1.4828e-03, PNorm = 77.3482, GNorm = 2.1580, lr_0 = 3.9290e-04
Validation rmse = 0.897043
Epoch 13
Loss = 1.5115e-03, PNorm = 77.3701, GNorm = 1.4446, lr_0 = 3.8019e-04
Loss = 1.3800e-03, PNorm = 77.3898, GNorm = 1.8591, lr_0 = 3.6789e-04
Loss = 1.3098e-03, PNorm = 77.4100, GNorm = 0.4916, lr_0 = 3.5598e-04
Validation rmse = 0.866445
Epoch 14
Loss = 9.7732e-04, PNorm = 77.4286, GNorm = 0.4569, lr_0 = 3.4446e-04
Loss = 1.2333e-03, PNorm = 77.4478, GNorm = 0.5672, lr_0 = 3.3332e-04
Validation rmse = 0.876357
Epoch 15
Loss = 1.3367e-03, PNorm = 77.4640, GNorm = 1.4467, lr_0 = 3.2253e-04
Loss = 1.2305e-03, PNorm = 77.4841, GNorm = 1.6590, lr_0 = 3.1209e-04
Loss = 1.1545e-03, PNorm = 77.5018, GNorm = 0.7930, lr_0 = 3.0200e-04
Validation rmse = 0.922755
Epoch 16
Loss = 1.0510e-03, PNorm = 77.5148, GNorm = 0.7954, lr_0 = 2.9222e-04
Loss = 1.0509e-03, PNorm = 77.5317, GNorm = 0.7345, lr_0 = 2.8277e-04
Validation rmse = 0.932172
Epoch 17
Loss = 6.6814e-04, PNorm = 77.5511, GNorm = 1.1846, lr_0 = 2.7272e-04
Loss = 1.0808e-03, PNorm = 77.5693, GNorm = 0.6163, lr_0 = 2.6389e-04
Loss = 1.0086e-03, PNorm = 77.5867, GNorm = 1.2344, lr_0 = 2.5535e-04
Validation rmse = 0.881106
Epoch 18
Loss = 8.2287e-04, PNorm = 77.6011, GNorm = 1.5781, lr_0 = 2.4709e-04
Loss = 1.0820e-03, PNorm = 77.6133, GNorm = 0.6558, lr_0 = 2.3910e-04
Loss = 1.2365e-03, PNorm = 77.6283, GNorm = 0.8879, lr_0 = 2.3136e-04
Validation rmse = 0.884533
Epoch 19
Loss = 9.8697e-04, PNorm = 77.6452, GNorm = 0.7391, lr_0 = 2.2387e-04
Loss = 8.3888e-04, PNorm = 77.6605, GNorm = 1.1404, lr_0 = 2.1663e-04
Validation rmse = 0.894475
Epoch 20
Loss = 8.2155e-04, PNorm = 77.6719, GNorm = 0.5403, lr_0 = 2.0962e-04
Loss = 8.1845e-04, PNorm = 77.6867, GNorm = 0.6632, lr_0 = 2.0283e-04
Loss = 9.4853e-04, PNorm = 77.7000, GNorm = 1.5226, lr_0 = 1.9627e-04
Validation rmse = 0.897541
Epoch 21
Loss = 7.2555e-04, PNorm = 77.7112, GNorm = 0.3401, lr_0 = 1.8992e-04
Loss = 8.2738e-04, PNorm = 77.7241, GNorm = 0.5657, lr_0 = 1.8377e-04
Validation rmse = 0.890273
Epoch 22
Loss = 6.5369e-04, PNorm = 77.7364, GNorm = 0.8269, lr_0 = 1.7783e-04
Loss = 6.6128e-04, PNorm = 77.7483, GNorm = 0.7223, lr_0 = 1.7207e-04
Loss = 7.7926e-04, PNorm = 77.7591, GNorm = 0.9967, lr_0 = 1.6651e-04
Validation rmse = 0.892094
Epoch 23
Loss = 6.7087e-04, PNorm = 77.7715, GNorm = 0.6074, lr_0 = 1.6059e-04
Loss = 7.3915e-04, PNorm = 77.7833, GNorm = 0.9089, lr_0 = 1.5539e-04
Validation rmse = 0.876811
Epoch 24
Loss = 4.6363e-04, PNorm = 77.7955, GNorm = 0.5255, lr_0 = 1.5036e-04
Loss = 7.5860e-04, PNorm = 77.8069, GNorm = 0.5160, lr_0 = 1.4550e-04
Loss = 5.9198e-04, PNorm = 77.8164, GNorm = 0.5971, lr_0 = 1.4079e-04
Validation rmse = 0.885076
Epoch 25
Loss = 5.4752e-04, PNorm = 77.8243, GNorm = 0.8894, lr_0 = 1.3623e-04
Loss = 6.7730e-04, PNorm = 77.8326, GNorm = 0.7249, lr_0 = 1.3183e-04
Loss = 6.2582e-04, PNorm = 77.8412, GNorm = 0.6951, lr_0 = 1.2756e-04
Validation rmse = 0.910229
Epoch 26
Loss = 6.4818e-04, PNorm = 77.8488, GNorm = 0.8937, lr_0 = 1.2343e-04
Loss = 5.9825e-04, PNorm = 77.8574, GNorm = 0.8042, lr_0 = 1.1944e-04
Validation rmse = 0.900097
Epoch 27
Loss = 7.3248e-04, PNorm = 77.8648, GNorm = 1.6212, lr_0 = 1.1557e-04
Loss = 5.5642e-04, PNorm = 77.8725, GNorm = 0.8323, lr_0 = 1.1183e-04
Loss = 6.4101e-04, PNorm = 77.8803, GNorm = 0.4749, lr_0 = 1.0821e-04
Validation rmse = 0.884569
Epoch 28
Loss = 6.2502e-04, PNorm = 77.8896, GNorm = 1.4179, lr_0 = 1.0437e-04
Loss = 5.2919e-04, PNorm = 77.8972, GNorm = 0.4083, lr_0 = 1.0099e-04
Validation rmse = 0.890666
Epoch 29
Loss = 3.3038e-04, PNorm = 77.9034, GNorm = 0.2479, lr_0 = 1.0000e-04
Loss = 5.5152e-04, PNorm = 77.9098, GNorm = 0.4998, lr_0 = 1.0000e-04
Loss = 5.9878e-04, PNorm = 77.9161, GNorm = 1.2104, lr_0 = 1.0000e-04
Validation rmse = 0.924773
Model 0 best validation rmse = 0.866445 on epoch 13
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.697140
Ensemble test rmse = 0.697140
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_6_dropout_0.05_ffn_num_layers_2_hidden_size_1800/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1800, bias=False)
      (W_h): Linear(in_features=1800, out_features=1800, bias=False)
      (W_o): Linear(in_features=1933, out_features=1800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=1800, out_features=1800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.05, inplace=False)
    (4): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 10,229,401
Moving model to cuda
Epoch 0
Loss = 1.9870e-02, PNorm = 75.7844, GNorm = 3.2316, lr_0 = 2.9800e-04
Loss = 1.2819e-02, PNorm = 75.8447, GNorm = 2.7859, lr_0 = 4.7800e-04
Validation rmse = 1.495126
Epoch 1
Loss = 8.6717e-03, PNorm = 75.9374, GNorm = 6.0541, lr_0 = 6.7600e-04
Loss = 7.4490e-03, PNorm = 76.0311, GNorm = 4.0641, lr_0 = 8.5600e-04
Loss = 7.0450e-03, PNorm = 76.1415, GNorm = 3.9551, lr_0 = 9.9344e-04
Validation rmse = 1.484081
Epoch 2
Loss = 5.3262e-03, PNorm = 76.2472, GNorm = 3.2052, lr_0 = 9.6130e-04
Loss = 4.8680e-03, PNorm = 76.3471, GNorm = 3.6298, lr_0 = 9.3019e-04
Validation rmse = 1.092536
Epoch 3
Loss = 3.8137e-03, PNorm = 76.4248, GNorm = 3.1522, lr_0 = 9.0009e-04
Loss = 4.8410e-03, PNorm = 76.4879, GNorm = 5.2843, lr_0 = 8.7096e-04
Loss = 3.7812e-03, PNorm = 76.5497, GNorm = 1.9150, lr_0 = 8.4278e-04
Validation rmse = 1.032870
Epoch 4
Loss = 3.2277e-03, PNorm = 76.5985, GNorm = 1.0576, lr_0 = 8.1551e-04
Loss = 3.3565e-03, PNorm = 76.6418, GNorm = 1.5734, lr_0 = 7.8912e-04
Validation rmse = 0.962974
Epoch 5
Loss = 2.6877e-03, PNorm = 76.6876, GNorm = 0.8643, lr_0 = 7.6358e-04
Loss = 3.2825e-03, PNorm = 76.7315, GNorm = 2.0658, lr_0 = 7.3888e-04
Loss = 2.3173e-03, PNorm = 76.7692, GNorm = 0.8912, lr_0 = 7.1497e-04
Validation rmse = 0.914283
Epoch 6
Loss = 2.3615e-03, PNorm = 76.8178, GNorm = 1.3550, lr_0 = 6.8956e-04
Loss = 2.7629e-03, PNorm = 76.8580, GNorm = 0.5997, lr_0 = 6.6725e-04
Loss = 2.0661e-03, PNorm = 76.8903, GNorm = 3.4750, lr_0 = 6.4565e-04
Validation rmse = 0.943213
Epoch 7
Loss = 2.0422e-03, PNorm = 76.9248, GNorm = 1.3236, lr_0 = 6.2476e-04
Loss = 1.8649e-03, PNorm = 76.9543, GNorm = 1.3130, lr_0 = 6.0454e-04
Validation rmse = 0.833661
Epoch 8
Loss = 2.2485e-03, PNorm = 76.9883, GNorm = 1.1157, lr_0 = 5.8498e-04
Loss = 1.9607e-03, PNorm = 77.0255, GNorm = 0.7092, lr_0 = 5.6605e-04
Loss = 1.7690e-03, PNorm = 77.0551, GNorm = 0.9145, lr_0 = 5.4774e-04
Validation rmse = 0.785163
Epoch 9
Loss = 1.4067e-03, PNorm = 77.0823, GNorm = 0.3865, lr_0 = 5.3001e-04
Loss = 1.7693e-03, PNorm = 77.1116, GNorm = 2.9192, lr_0 = 5.1286e-04
Validation rmse = 0.872797
Epoch 10
Loss = 1.5058e-03, PNorm = 77.1442, GNorm = 0.7480, lr_0 = 4.9627e-04
Loss = 1.5304e-03, PNorm = 77.1729, GNorm = 0.9005, lr_0 = 4.8021e-04
Loss = 1.5002e-03, PNorm = 77.1989, GNorm = 0.6518, lr_0 = 4.6467e-04
Validation rmse = 0.812760
Epoch 11
Loss = 1.3035e-03, PNorm = 77.2278, GNorm = 0.6355, lr_0 = 4.4963e-04
Loss = 1.5447e-03, PNorm = 77.2574, GNorm = 1.7577, lr_0 = 4.3508e-04
Validation rmse = 0.778771
Epoch 12
Loss = 6.8912e-04, PNorm = 77.2851, GNorm = 0.6145, lr_0 = 4.1962e-04
Loss = 1.2789e-03, PNorm = 77.3069, GNorm = 1.7001, lr_0 = 4.0604e-04
Loss = 1.0992e-03, PNorm = 77.3245, GNorm = 1.1909, lr_0 = 3.9290e-04
Validation rmse = 0.763284
Epoch 13
Loss = 1.2622e-03, PNorm = 77.3436, GNorm = 2.2535, lr_0 = 3.8019e-04
Loss = 1.0575e-03, PNorm = 77.3709, GNorm = 0.6658, lr_0 = 3.6789e-04
Loss = 1.4389e-03, PNorm = 77.3898, GNorm = 2.0462, lr_0 = 3.5598e-04
Validation rmse = 0.706003
Epoch 14
Loss = 1.3987e-03, PNorm = 77.4141, GNorm = 2.4415, lr_0 = 3.4446e-04
Loss = 1.1273e-03, PNorm = 77.4386, GNorm = 0.9907, lr_0 = 3.3332e-04
Validation rmse = 0.895758
Epoch 15
Loss = 1.8121e-03, PNorm = 77.4622, GNorm = 1.0962, lr_0 = 3.2253e-04
Loss = 1.2414e-03, PNorm = 77.4847, GNorm = 1.1697, lr_0 = 3.1209e-04
Loss = 9.3714e-04, PNorm = 77.5022, GNorm = 0.8139, lr_0 = 3.0200e-04
Validation rmse = 0.774749
Epoch 16
Loss = 9.2010e-04, PNorm = 77.5182, GNorm = 0.7057, lr_0 = 2.9222e-04
Loss = 8.9892e-04, PNorm = 77.5317, GNorm = 0.9188, lr_0 = 2.8277e-04
Validation rmse = 0.715536
Epoch 17
Loss = 9.7205e-04, PNorm = 77.5499, GNorm = 1.2748, lr_0 = 2.7272e-04
Loss = 9.3298e-04, PNorm = 77.5641, GNorm = 0.4782, lr_0 = 2.6389e-04
Loss = 8.5334e-04, PNorm = 77.5785, GNorm = 0.8984, lr_0 = 2.5535e-04
Validation rmse = 0.698475
Epoch 18
Loss = 9.8005e-04, PNorm = 77.5943, GNorm = 0.7813, lr_0 = 2.4709e-04
Loss = 9.6672e-04, PNorm = 77.6088, GNorm = 1.4923, lr_0 = 2.3910e-04
Loss = 7.9597e-04, PNorm = 77.6183, GNorm = 0.5355, lr_0 = 2.3136e-04
Validation rmse = 0.680488
Epoch 19
Loss = 9.0099e-04, PNorm = 77.6301, GNorm = 0.8194, lr_0 = 2.2387e-04
Loss = 7.8642e-04, PNorm = 77.6423, GNorm = 0.5547, lr_0 = 2.1663e-04
Validation rmse = 0.662157
Epoch 20
Loss = 5.4458e-04, PNorm = 77.6563, GNorm = 0.6922, lr_0 = 2.0962e-04
Loss = 9.0783e-04, PNorm = 77.6676, GNorm = 1.6505, lr_0 = 2.0283e-04
Loss = 7.4534e-04, PNorm = 77.6784, GNorm = 0.4616, lr_0 = 1.9627e-04
Validation rmse = 0.659547
Epoch 21
Loss = 6.6971e-04, PNorm = 77.6894, GNorm = 0.4682, lr_0 = 1.8992e-04
Loss = 7.4076e-04, PNorm = 77.7019, GNorm = 0.4791, lr_0 = 1.8377e-04
Validation rmse = 0.674588
Epoch 22
Loss = 5.3293e-04, PNorm = 77.7126, GNorm = 0.5832, lr_0 = 1.7783e-04
Loss = 5.4047e-04, PNorm = 77.7211, GNorm = 0.6503, lr_0 = 1.7207e-04
Loss = 7.2030e-04, PNorm = 77.7310, GNorm = 0.3399, lr_0 = 1.6651e-04
Validation rmse = 0.670657
Epoch 23
Loss = 7.1459e-04, PNorm = 77.7424, GNorm = 0.4719, lr_0 = 1.6059e-04
Loss = 6.5382e-04, PNorm = 77.7524, GNorm = 1.1458, lr_0 = 1.5539e-04
Validation rmse = 0.707632
Epoch 24
Loss = 8.8459e-04, PNorm = 77.7617, GNorm = 1.8586, lr_0 = 1.5036e-04
Loss = 6.9864e-04, PNorm = 77.7693, GNorm = 1.5294, lr_0 = 1.4550e-04
Loss = 7.5068e-04, PNorm = 77.7787, GNorm = 1.8798, lr_0 = 1.4079e-04
Validation rmse = 0.680234
Epoch 25
Loss = 5.6263e-04, PNorm = 77.7875, GNorm = 0.9104, lr_0 = 1.3623e-04
Loss = 6.2009e-04, PNorm = 77.7937, GNorm = 1.2822, lr_0 = 1.3183e-04
Loss = 6.3045e-04, PNorm = 77.8011, GNorm = 1.2563, lr_0 = 1.2756e-04
Validation rmse = 0.658083
Epoch 26
Loss = 6.4326e-04, PNorm = 77.8107, GNorm = 0.6959, lr_0 = 1.2343e-04
Loss = 5.4159e-04, PNorm = 77.8173, GNorm = 0.8968, lr_0 = 1.1944e-04
Validation rmse = 0.663516
Epoch 27
Loss = 7.2487e-04, PNorm = 77.8248, GNorm = 1.7538, lr_0 = 1.1557e-04
Loss = 5.5752e-04, PNorm = 77.8318, GNorm = 0.6478, lr_0 = 1.1183e-04
Loss = 5.2101e-04, PNorm = 77.8377, GNorm = 0.7704, lr_0 = 1.0821e-04
Validation rmse = 0.662031
Epoch 28
Loss = 5.8643e-04, PNorm = 77.8453, GNorm = 1.4522, lr_0 = 1.0437e-04
Loss = 5.2526e-04, PNorm = 77.8506, GNorm = 0.5389, lr_0 = 1.0099e-04
Validation rmse = 0.649040
Epoch 29
Loss = 5.1223e-04, PNorm = 77.8568, GNorm = 0.9924, lr_0 = 1.0000e-04
Loss = 4.7906e-04, PNorm = 77.8626, GNorm = 0.6200, lr_0 = 1.0000e-04
Loss = 4.9955e-04, PNorm = 77.8677, GNorm = 0.9211, lr_0 = 1.0000e-04
Validation rmse = 0.636512
Model 0 best validation rmse = 0.636512 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.709886
Ensemble test rmse = 0.709886
10-fold cross validation
	Seed 0 ==> test rmse = 0.757741
	Seed 1 ==> test rmse = 0.606592
	Seed 2 ==> test rmse = 0.637968
	Seed 3 ==> test rmse = 0.866818
	Seed 4 ==> test rmse = 1.030011
	Seed 5 ==> test rmse = 0.672819
	Seed 6 ==> test rmse = 0.752020
	Seed 7 ==> test rmse = 0.707304
	Seed 8 ==> test rmse = 0.697140
	Seed 9 ==> test rmse = 0.709886
Overall test rmse = 0.743830 +/- 0.117063
Elapsed time = 0:10:31
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.4675e-02, PNorm = 46.0261, GNorm = 16.3336, lr_0 = 2.9800e-04
Loss = 1.2820e-02, PNorm = 46.0488, GNorm = 6.0382, lr_0 = 4.7800e-04
Validation rmse = 1.485666
Epoch 1
Loss = 6.9008e-03, PNorm = 46.0952, GNorm = 3.8002, lr_0 = 6.7600e-04
Loss = 7.3880e-03, PNorm = 46.1410, GNorm = 1.5269, lr_0 = 8.5600e-04
Loss = 6.3303e-03, PNorm = 46.1964, GNorm = 0.9288, lr_0 = 9.9344e-04
Validation rmse = 1.184097
Epoch 2
Loss = 6.5032e-03, PNorm = 46.2556, GNorm = 3.4702, lr_0 = 9.6130e-04
Loss = 5.3720e-03, PNorm = 46.3157, GNorm = 5.4733, lr_0 = 9.3019e-04
Validation rmse = 1.161319
Epoch 3
Loss = 5.0474e-03, PNorm = 46.3675, GNorm = 4.6816, lr_0 = 9.0009e-04
Loss = 4.6101e-03, PNorm = 46.4227, GNorm = 0.8936, lr_0 = 8.7096e-04
Loss = 5.0596e-03, PNorm = 46.4799, GNorm = 1.4482, lr_0 = 8.4278e-04
Validation rmse = 1.074079
Epoch 4
Loss = 3.6809e-03, PNorm = 46.5270, GNorm = 0.7476, lr_0 = 8.1551e-04
Loss = 3.6949e-03, PNorm = 46.5619, GNorm = 2.4311, lr_0 = 7.8912e-04
Validation rmse = 1.227840
Epoch 5
Loss = 4.2338e-03, PNorm = 46.5959, GNorm = 5.3459, lr_0 = 7.6358e-04
Loss = 3.8416e-03, PNorm = 46.6410, GNorm = 1.4153, lr_0 = 7.3888e-04
Loss = 3.5792e-03, PNorm = 46.6749, GNorm = 1.4395, lr_0 = 7.1497e-04
Validation rmse = 1.065364
Epoch 6
Loss = 2.5484e-03, PNorm = 46.7117, GNorm = 0.6881, lr_0 = 6.8956e-04
Loss = 2.5988e-03, PNorm = 46.7402, GNorm = 2.8104, lr_0 = 6.6725e-04
Loss = 2.4780e-03, PNorm = 46.7651, GNorm = 1.8275, lr_0 = 6.4565e-04
Validation rmse = 0.923696
Epoch 7
Loss = 1.9785e-03, PNorm = 46.7915, GNorm = 1.7345, lr_0 = 6.2476e-04
Loss = 2.9934e-03, PNorm = 46.8202, GNorm = 3.6221, lr_0 = 6.0454e-04
Validation rmse = 0.924736
Epoch 8
Loss = 1.9292e-03, PNorm = 46.8484, GNorm = 0.7163, lr_0 = 5.8498e-04
Loss = 2.6691e-03, PNorm = 46.8694, GNorm = 4.2588, lr_0 = 5.6605e-04
Loss = 2.2741e-03, PNorm = 46.8980, GNorm = 1.2783, lr_0 = 5.4774e-04
Validation rmse = 0.927410
Epoch 9
Loss = 1.6915e-03, PNorm = 46.9257, GNorm = 0.9759, lr_0 = 5.3001e-04
Loss = 1.9497e-03, PNorm = 46.9455, GNorm = 4.1100, lr_0 = 5.1286e-04
Validation rmse = 0.882403
Epoch 10
Loss = 1.6783e-03, PNorm = 46.9653, GNorm = 0.6654, lr_0 = 4.9627e-04
Loss = 1.8570e-03, PNorm = 46.9892, GNorm = 2.2088, lr_0 = 4.8021e-04
Loss = 1.8768e-03, PNorm = 47.0094, GNorm = 1.5989, lr_0 = 4.6467e-04
Validation rmse = 0.878531
Epoch 11
Loss = 1.6666e-03, PNorm = 47.0263, GNorm = 1.2098, lr_0 = 4.4963e-04
Loss = 1.5657e-03, PNorm = 47.0462, GNorm = 0.3191, lr_0 = 4.3508e-04
Validation rmse = 0.884713
Epoch 12
Loss = 1.5599e-03, PNorm = 47.0690, GNorm = 0.4808, lr_0 = 4.1962e-04
Loss = 1.5443e-03, PNorm = 47.0874, GNorm = 1.0943, lr_0 = 4.0604e-04
Loss = 1.6276e-03, PNorm = 47.1056, GNorm = 2.8972, lr_0 = 3.9290e-04
Validation rmse = 0.859924
Epoch 13
Loss = 1.4479e-03, PNorm = 47.1215, GNorm = 1.1680, lr_0 = 3.8019e-04
Loss = 1.7008e-03, PNorm = 47.1378, GNorm = 1.9507, lr_0 = 3.6789e-04
Loss = 1.5617e-03, PNorm = 47.1549, GNorm = 2.0378, lr_0 = 3.5598e-04
Validation rmse = 0.901662
Epoch 14
Loss = 1.4310e-03, PNorm = 47.1703, GNorm = 1.5553, lr_0 = 3.4446e-04
Loss = 1.2409e-03, PNorm = 47.1868, GNorm = 1.5956, lr_0 = 3.3332e-04
Validation rmse = 0.862250
Epoch 15
Loss = 1.1953e-03, PNorm = 47.2004, GNorm = 1.5706, lr_0 = 3.2253e-04
Loss = 1.5319e-03, PNorm = 47.2151, GNorm = 0.5934, lr_0 = 3.1209e-04
Loss = 1.3842e-03, PNorm = 47.2325, GNorm = 1.8658, lr_0 = 3.0200e-04
Validation rmse = 0.845073
Epoch 16
Loss = 1.3624e-03, PNorm = 47.2471, GNorm = 1.2947, lr_0 = 2.9222e-04
Loss = 1.3115e-03, PNorm = 47.2606, GNorm = 3.1157, lr_0 = 2.8277e-04
Validation rmse = 0.837631
Epoch 17
Loss = 1.2096e-03, PNorm = 47.2723, GNorm = 0.7818, lr_0 = 2.7272e-04
Loss = 1.1270e-03, PNorm = 47.2850, GNorm = 2.3774, lr_0 = 2.6389e-04
Loss = 1.2706e-03, PNorm = 47.2981, GNorm = 0.4834, lr_0 = 2.5535e-04
Validation rmse = 0.848234
Epoch 18
Loss = 1.2589e-03, PNorm = 47.3097, GNorm = 1.1342, lr_0 = 2.4709e-04
Loss = 1.0595e-03, PNorm = 47.3203, GNorm = 1.3217, lr_0 = 2.3910e-04
Loss = 1.0913e-03, PNorm = 47.3312, GNorm = 0.5937, lr_0 = 2.3136e-04
Validation rmse = 0.820719
Epoch 19
Loss = 1.1018e-03, PNorm = 47.3426, GNorm = 0.4425, lr_0 = 2.2387e-04
Loss = 1.2249e-03, PNorm = 47.3533, GNorm = 2.5597, lr_0 = 2.1663e-04
Validation rmse = 0.854129
Epoch 20
Loss = 8.9463e-04, PNorm = 47.3631, GNorm = 1.8132, lr_0 = 2.0962e-04
Loss = 1.1171e-03, PNorm = 47.3721, GNorm = 0.4947, lr_0 = 2.0283e-04
Loss = 1.0206e-03, PNorm = 47.3811, GNorm = 0.5921, lr_0 = 1.9627e-04
Validation rmse = 0.837549
Epoch 21
Loss = 9.5884e-04, PNorm = 47.3911, GNorm = 1.6042, lr_0 = 1.8992e-04
Loss = 9.3740e-04, PNorm = 47.3978, GNorm = 0.5840, lr_0 = 1.8377e-04
Validation rmse = 0.821650
Epoch 22
Loss = 1.0483e-03, PNorm = 47.4072, GNorm = 0.9466, lr_0 = 1.7783e-04
Loss = 9.9554e-04, PNorm = 47.4162, GNorm = 1.6166, lr_0 = 1.7207e-04
Loss = 9.7753e-04, PNorm = 47.4240, GNorm = 0.7845, lr_0 = 1.6651e-04
Validation rmse = 0.847549
Epoch 23
Loss = 7.8254e-04, PNorm = 47.4332, GNorm = 0.7100, lr_0 = 1.6059e-04
Loss = 9.1963e-04, PNorm = 47.4408, GNorm = 1.3059, lr_0 = 1.5539e-04
Validation rmse = 0.825262
Epoch 24
Loss = 8.3304e-04, PNorm = 47.4483, GNorm = 1.4831, lr_0 = 1.5036e-04
Loss = 8.3830e-04, PNorm = 47.4547, GNorm = 0.5828, lr_0 = 1.4550e-04
Loss = 8.9086e-04, PNorm = 47.4613, GNorm = 1.1820, lr_0 = 1.4079e-04
Validation rmse = 0.839412
Epoch 25
Loss = 8.0416e-04, PNorm = 47.4672, GNorm = 0.7472, lr_0 = 1.3623e-04
Loss = 9.2662e-04, PNorm = 47.4726, GNorm = 0.9171, lr_0 = 1.3183e-04
Loss = 8.9484e-04, PNorm = 47.4786, GNorm = 0.9659, lr_0 = 1.2756e-04
Validation rmse = 0.835772
Epoch 26
Loss = 7.0995e-04, PNorm = 47.4855, GNorm = 1.0652, lr_0 = 1.2343e-04
Loss = 7.9742e-04, PNorm = 47.4910, GNorm = 0.6829, lr_0 = 1.1944e-04
Validation rmse = 0.820557
Epoch 27
Loss = 7.9746e-04, PNorm = 47.4975, GNorm = 0.6196, lr_0 = 1.1557e-04
Loss = 8.9585e-04, PNorm = 47.5036, GNorm = 1.5875, lr_0 = 1.1183e-04
Loss = 7.6349e-04, PNorm = 47.5086, GNorm = 0.9209, lr_0 = 1.0821e-04
Validation rmse = 0.833208
Epoch 28
Loss = 8.5548e-04, PNorm = 47.5131, GNorm = 0.5805, lr_0 = 1.0437e-04
Loss = 7.5397e-04, PNorm = 47.5177, GNorm = 1.3586, lr_0 = 1.0099e-04
Validation rmse = 0.835071
Epoch 29
Loss = 1.0368e-03, PNorm = 47.5226, GNorm = 1.0488, lr_0 = 1.0000e-04
Loss = 7.5077e-04, PNorm = 47.5271, GNorm = 0.8476, lr_0 = 1.0000e-04
Loss = 9.4584e-04, PNorm = 47.5325, GNorm = 2.9986, lr_0 = 1.0000e-04
Validation rmse = 0.863216
Model 0 best validation rmse = 0.820557 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.768308
Ensemble test rmse = 0.768308
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.6381e-02, PNorm = 46.0265, GNorm = 5.4853, lr_0 = 2.9800e-04
Loss = 1.0270e-02, PNorm = 46.0510, GNorm = 6.9899, lr_0 = 4.7800e-04
Validation rmse = 1.769245
Epoch 1
Loss = 8.5416e-03, PNorm = 46.0869, GNorm = 1.6221, lr_0 = 6.7600e-04
Loss = 9.3951e-03, PNorm = 46.1335, GNorm = 5.3768, lr_0 = 8.5600e-04
Loss = 5.1915e-03, PNorm = 46.1838, GNorm = 1.7847, lr_0 = 9.9344e-04
Validation rmse = 1.268261
Epoch 2
Loss = 5.4321e-03, PNorm = 46.2333, GNorm = 2.5509, lr_0 = 9.6130e-04
Loss = 6.2431e-03, PNorm = 46.2835, GNorm = 3.9583, lr_0 = 9.3019e-04
Validation rmse = 1.256846
Epoch 3
Loss = 6.0160e-03, PNorm = 46.3345, GNorm = 6.4624, lr_0 = 9.0009e-04
Loss = 5.0496e-03, PNorm = 46.3855, GNorm = 3.0366, lr_0 = 8.7096e-04
Loss = 4.2430e-03, PNorm = 46.4349, GNorm = 2.1575, lr_0 = 8.4278e-04
Validation rmse = 1.027976
Epoch 4
Loss = 4.2210e-03, PNorm = 46.4753, GNorm = 3.1065, lr_0 = 8.1551e-04
Loss = 3.1171e-03, PNorm = 46.5178, GNorm = 1.5405, lr_0 = 7.8912e-04
Validation rmse = 0.895676
Epoch 5
Loss = 2.5042e-03, PNorm = 46.5598, GNorm = 1.3745, lr_0 = 7.6358e-04
Loss = 3.4166e-03, PNorm = 46.5968, GNorm = 4.6291, lr_0 = 7.3888e-04
Loss = 2.8568e-03, PNorm = 46.6328, GNorm = 3.3401, lr_0 = 7.1497e-04
Validation rmse = 0.932810
Epoch 6
Loss = 3.3279e-03, PNorm = 46.6693, GNorm = 0.8290, lr_0 = 6.8956e-04
Loss = 2.8566e-03, PNorm = 46.7074, GNorm = 2.9716, lr_0 = 6.6725e-04
Loss = 2.5285e-03, PNorm = 46.7391, GNorm = 1.9790, lr_0 = 6.4565e-04
Validation rmse = 0.853075
Epoch 7
Loss = 2.5668e-03, PNorm = 46.7698, GNorm = 2.8730, lr_0 = 6.2476e-04
Loss = 2.5661e-03, PNorm = 46.7980, GNorm = 4.2735, lr_0 = 6.0454e-04
Validation rmse = 1.022437
Epoch 8
Loss = 3.3071e-03, PNorm = 46.8306, GNorm = 4.0441, lr_0 = 5.8498e-04
Loss = 2.1834e-03, PNorm = 46.8579, GNorm = 1.0803, lr_0 = 5.6605e-04
Loss = 1.8994e-03, PNorm = 46.8849, GNorm = 0.5973, lr_0 = 5.4774e-04
Validation rmse = 0.795297
Epoch 9
Loss = 1.8079e-03, PNorm = 46.9111, GNorm = 1.7169, lr_0 = 5.3001e-04
Loss = 2.0982e-03, PNorm = 46.9432, GNorm = 0.6445, lr_0 = 5.1286e-04
Validation rmse = 0.806603
Epoch 10
Loss = 1.7672e-03, PNorm = 46.9643, GNorm = 2.1224, lr_0 = 4.9627e-04
Loss = 2.5338e-03, PNorm = 46.9892, GNorm = 2.3140, lr_0 = 4.8021e-04
Loss = 2.0779e-03, PNorm = 47.0135, GNorm = 3.3082, lr_0 = 4.6467e-04
Validation rmse = 0.844825
Epoch 11
Loss = 2.0482e-03, PNorm = 47.0383, GNorm = 1.5644, lr_0 = 4.4963e-04
Loss = 1.8388e-03, PNorm = 47.0579, GNorm = 1.3342, lr_0 = 4.3508e-04
Validation rmse = 0.747349
Epoch 12
Loss = 1.8200e-03, PNorm = 47.0810, GNorm = 1.3190, lr_0 = 4.1962e-04
Loss = 1.8807e-03, PNorm = 47.1015, GNorm = 1.9385, lr_0 = 4.0604e-04
Loss = 2.3714e-03, PNorm = 47.1242, GNorm = 1.8699, lr_0 = 3.9290e-04
Validation rmse = 1.035433
Epoch 13
Loss = 1.9684e-03, PNorm = 47.1462, GNorm = 1.5944, lr_0 = 3.8019e-04
Loss = 2.0652e-03, PNorm = 47.1647, GNorm = 2.6182, lr_0 = 3.6789e-04
Loss = 1.9243e-03, PNorm = 47.1822, GNorm = 1.1759, lr_0 = 3.5598e-04
Validation rmse = 0.718708
Epoch 14
Loss = 1.5605e-03, PNorm = 47.2022, GNorm = 0.6512, lr_0 = 3.4446e-04
Loss = 1.3710e-03, PNorm = 47.2162, GNorm = 1.6050, lr_0 = 3.3332e-04
Validation rmse = 0.739149
Epoch 15
Loss = 1.2010e-03, PNorm = 47.2315, GNorm = 1.2754, lr_0 = 3.2253e-04
Loss = 1.5993e-03, PNorm = 47.2472, GNorm = 2.8654, lr_0 = 3.1209e-04
Loss = 1.7307e-03, PNorm = 47.2637, GNorm = 0.8598, lr_0 = 3.0200e-04
Validation rmse = 0.745434
Epoch 16
Loss = 1.8475e-03, PNorm = 47.2797, GNorm = 2.1575, lr_0 = 2.9222e-04
Loss = 1.0257e-03, PNorm = 47.2936, GNorm = 0.7989, lr_0 = 2.8277e-04
Validation rmse = 0.684788
Epoch 17
Loss = 9.9421e-04, PNorm = 47.3059, GNorm = 0.5085, lr_0 = 2.7272e-04
Loss = 1.4231e-03, PNorm = 47.3176, GNorm = 0.7532, lr_0 = 2.6389e-04
Loss = 1.1711e-03, PNorm = 47.3312, GNorm = 1.0674, lr_0 = 2.5535e-04
Validation rmse = 0.686444
Epoch 18
Loss = 1.1901e-03, PNorm = 47.3431, GNorm = 0.9872, lr_0 = 2.4709e-04
Loss = 1.3169e-03, PNorm = 47.3539, GNorm = 0.7763, lr_0 = 2.3910e-04
Loss = 1.2093e-03, PNorm = 47.3652, GNorm = 1.2792, lr_0 = 2.3136e-04
Validation rmse = 0.690240
Epoch 19
Loss = 1.1604e-03, PNorm = 47.3751, GNorm = 1.1873, lr_0 = 2.2387e-04
Loss = 1.1576e-03, PNorm = 47.3858, GNorm = 1.2067, lr_0 = 2.1663e-04
Validation rmse = 0.668977
Epoch 20
Loss = 9.3432e-04, PNorm = 47.3970, GNorm = 0.9572, lr_0 = 2.0962e-04
Loss = 1.2759e-03, PNorm = 47.4063, GNorm = 0.7229, lr_0 = 2.0283e-04
Loss = 1.0574e-03, PNorm = 47.4152, GNorm = 0.5782, lr_0 = 1.9627e-04
Validation rmse = 0.668719
Epoch 21
Loss = 1.0819e-03, PNorm = 47.4235, GNorm = 0.3960, lr_0 = 1.8992e-04
Loss = 1.1738e-03, PNorm = 47.4318, GNorm = 1.5112, lr_0 = 1.8377e-04
Validation rmse = 0.663405
Epoch 22
Loss = 7.8130e-04, PNorm = 47.4411, GNorm = 0.9504, lr_0 = 1.7783e-04
Loss = 1.1522e-03, PNorm = 47.4480, GNorm = 1.1656, lr_0 = 1.7207e-04
Loss = 1.0860e-03, PNorm = 47.4567, GNorm = 1.0189, lr_0 = 1.6651e-04
Validation rmse = 0.679696
Epoch 23
Loss = 9.6203e-04, PNorm = 47.4678, GNorm = 1.5585, lr_0 = 1.6059e-04
Loss = 1.0715e-03, PNorm = 47.4766, GNorm = 1.2621, lr_0 = 1.5539e-04
Validation rmse = 0.752276
Epoch 24
Loss = 1.0978e-03, PNorm = 47.4847, GNorm = 1.9451, lr_0 = 1.5036e-04
Loss = 1.1942e-03, PNorm = 47.4924, GNorm = 1.8083, lr_0 = 1.4550e-04
Loss = 1.2018e-03, PNorm = 47.5007, GNorm = 2.0398, lr_0 = 1.4079e-04
Validation rmse = 0.725163
Epoch 25
Loss = 9.3406e-04, PNorm = 47.5070, GNorm = 1.5501, lr_0 = 1.3623e-04
Loss = 1.1453e-03, PNorm = 47.5133, GNorm = 0.8063, lr_0 = 1.3183e-04
Loss = 1.2063e-03, PNorm = 47.5207, GNorm = 0.5110, lr_0 = 1.2756e-04
Validation rmse = 0.673814
Epoch 26
Loss = 1.1419e-03, PNorm = 47.5270, GNorm = 0.9513, lr_0 = 1.2343e-04
Loss = 1.0690e-03, PNorm = 47.5331, GNorm = 1.7125, lr_0 = 1.1944e-04
Validation rmse = 0.658948
Epoch 27
Loss = 1.1771e-03, PNorm = 47.5380, GNorm = 1.0374, lr_0 = 1.1557e-04
Loss = 9.0353e-04, PNorm = 47.5446, GNorm = 1.3663, lr_0 = 1.1183e-04
Loss = 9.9707e-04, PNorm = 47.5518, GNorm = 0.5969, lr_0 = 1.0821e-04
Validation rmse = 0.658195
Epoch 28
Loss = 1.0588e-03, PNorm = 47.5581, GNorm = 0.7229, lr_0 = 1.0437e-04
Loss = 8.1662e-04, PNorm = 47.5628, GNorm = 0.4127, lr_0 = 1.0099e-04
Validation rmse = 0.659182
Epoch 29
Loss = 1.0106e-03, PNorm = 47.5671, GNorm = 1.5546, lr_0 = 1.0000e-04
Loss = 9.0851e-04, PNorm = 47.5725, GNorm = 1.1296, lr_0 = 1.0000e-04
Loss = 9.0394e-04, PNorm = 47.5772, GNorm = 0.8330, lr_0 = 1.0000e-04
Validation rmse = 0.643522
Model 0 best validation rmse = 0.643522 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.696907
Ensemble test rmse = 0.696907
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.9069e-02, PNorm = 46.0253, GNorm = 2.6761, lr_0 = 2.9800e-04
Loss = 1.2470e-02, PNorm = 46.0507, GNorm = 2.3642, lr_0 = 4.7800e-04
Validation rmse = 1.270823
Epoch 1
Loss = 7.0960e-03, PNorm = 46.0972, GNorm = 9.0694, lr_0 = 6.7600e-04
Loss = 7.1067e-03, PNorm = 46.1356, GNorm = 6.8574, lr_0 = 8.5600e-04
Loss = 8.0104e-03, PNorm = 46.1867, GNorm = 6.2447, lr_0 = 9.9344e-04
Validation rmse = 1.361817
Epoch 2
Loss = 6.3355e-03, PNorm = 46.2469, GNorm = 5.3251, lr_0 = 9.6130e-04
Loss = 6.1038e-03, PNorm = 46.2973, GNorm = 2.0690, lr_0 = 9.3019e-04
Validation rmse = 1.012333
Epoch 3
Loss = 4.8485e-03, PNorm = 46.3462, GNorm = 3.0534, lr_0 = 9.0009e-04
Loss = 4.0495e-03, PNorm = 46.3930, GNorm = 1.6161, lr_0 = 8.7096e-04
Loss = 4.3635e-03, PNorm = 46.4378, GNorm = 1.4662, lr_0 = 8.4278e-04
Validation rmse = 0.953612
Epoch 4
Loss = 4.6332e-03, PNorm = 46.4821, GNorm = 3.2847, lr_0 = 8.1551e-04
Loss = 4.9766e-03, PNorm = 46.5333, GNorm = 3.6094, lr_0 = 7.8912e-04
Validation rmse = 0.923494
Epoch 5
Loss = 3.3901e-03, PNorm = 46.5758, GNorm = 0.7137, lr_0 = 7.6358e-04
Loss = 3.0652e-03, PNorm = 46.6203, GNorm = 1.2056, lr_0 = 7.3888e-04
Loss = 3.0845e-03, PNorm = 46.6605, GNorm = 2.3195, lr_0 = 7.1497e-04
Validation rmse = 0.832264
Epoch 6
Loss = 3.0165e-03, PNorm = 46.6938, GNorm = 1.1101, lr_0 = 6.8956e-04
Loss = 2.3556e-03, PNorm = 46.7223, GNorm = 0.9666, lr_0 = 6.6725e-04
Loss = 2.7039e-03, PNorm = 46.7511, GNorm = 1.0260, lr_0 = 6.4565e-04
Validation rmse = 0.820645
Epoch 7
Loss = 2.6466e-03, PNorm = 46.7783, GNorm = 1.0173, lr_0 = 6.2476e-04
Loss = 2.2720e-03, PNorm = 46.8144, GNorm = 0.6014, lr_0 = 6.0454e-04
Validation rmse = 0.747814
Epoch 8
Loss = 2.5009e-03, PNorm = 46.8480, GNorm = 1.5542, lr_0 = 5.8498e-04
Loss = 1.8687e-03, PNorm = 46.8771, GNorm = 0.7219, lr_0 = 5.6605e-04
Loss = 2.3632e-03, PNorm = 46.9001, GNorm = 1.4960, lr_0 = 5.4774e-04
Validation rmse = 0.751820
Epoch 9
Loss = 2.4913e-03, PNorm = 46.9287, GNorm = 2.2236, lr_0 = 5.3001e-04
Loss = 2.5471e-03, PNorm = 46.9585, GNorm = 2.8139, lr_0 = 5.1286e-04
Validation rmse = 0.698983
Epoch 10
Loss = 2.0387e-03, PNorm = 46.9858, GNorm = 2.1400, lr_0 = 4.9627e-04
Loss = 1.9201e-03, PNorm = 47.0090, GNorm = 0.9575, lr_0 = 4.8021e-04
Loss = 2.2207e-03, PNorm = 47.0404, GNorm = 2.4731, lr_0 = 4.6467e-04
Validation rmse = 0.701196
Epoch 11
Loss = 2.0665e-03, PNorm = 47.0626, GNorm = 3.0597, lr_0 = 4.4963e-04
Loss = 1.9518e-03, PNorm = 47.0866, GNorm = 1.7496, lr_0 = 4.3508e-04
Validation rmse = 0.661812
Epoch 12
Loss = 1.1488e-03, PNorm = 47.1095, GNorm = 0.7646, lr_0 = 4.1962e-04
Loss = 1.7757e-03, PNorm = 47.1279, GNorm = 2.0234, lr_0 = 4.0604e-04
Loss = 1.4856e-03, PNorm = 47.1472, GNorm = 0.6746, lr_0 = 3.9290e-04
Validation rmse = 0.682246
Epoch 13
Loss = 1.5607e-03, PNorm = 47.1674, GNorm = 0.7859, lr_0 = 3.8019e-04
Loss = 1.6812e-03, PNorm = 47.1864, GNorm = 4.5029, lr_0 = 3.6789e-04
Loss = 2.1792e-03, PNorm = 47.2076, GNorm = 2.1017, lr_0 = 3.5598e-04
Validation rmse = 0.774577
Epoch 14
Loss = 1.6506e-03, PNorm = 47.2223, GNorm = 0.5288, lr_0 = 3.4446e-04
Loss = 1.6056e-03, PNorm = 47.2419, GNorm = 0.7168, lr_0 = 3.3332e-04
Validation rmse = 0.766368
Epoch 15
Loss = 1.7068e-03, PNorm = 47.2590, GNorm = 0.4383, lr_0 = 3.2253e-04
Loss = 1.4850e-03, PNorm = 47.2733, GNorm = 0.5406, lr_0 = 3.1209e-04
Loss = 1.8816e-03, PNorm = 47.2910, GNorm = 1.5710, lr_0 = 3.0200e-04
Validation rmse = 0.663280
Epoch 16
Loss = 1.3816e-03, PNorm = 47.3062, GNorm = 1.0378, lr_0 = 2.9222e-04
Loss = 1.2523e-03, PNorm = 47.3195, GNorm = 0.7313, lr_0 = 2.8277e-04
Validation rmse = 0.651028
Epoch 17
Loss = 1.0583e-03, PNorm = 47.3340, GNorm = 2.0345, lr_0 = 2.7272e-04
Loss = 1.1784e-03, PNorm = 47.3452, GNorm = 0.5787, lr_0 = 2.6389e-04
Loss = 1.5218e-03, PNorm = 47.3574, GNorm = 3.4399, lr_0 = 2.5535e-04
Validation rmse = 0.675440
Epoch 18
Loss = 1.2585e-03, PNorm = 47.3706, GNorm = 0.4750, lr_0 = 2.4709e-04
Loss = 1.3827e-03, PNorm = 47.3829, GNorm = 0.9575, lr_0 = 2.3910e-04
Loss = 1.1278e-03, PNorm = 47.3918, GNorm = 1.1184, lr_0 = 2.3136e-04
Validation rmse = 0.651296
Epoch 19
Loss = 1.4741e-03, PNorm = 47.4031, GNorm = 1.2647, lr_0 = 2.2387e-04
Loss = 1.1224e-03, PNorm = 47.4149, GNorm = 0.6307, lr_0 = 2.1663e-04
Validation rmse = 0.647109
Epoch 20
Loss = 1.1154e-03, PNorm = 47.4242, GNorm = 2.2273, lr_0 = 2.0962e-04
Loss = 1.0723e-03, PNorm = 47.4340, GNorm = 1.2583, lr_0 = 2.0283e-04
Loss = 1.0457e-03, PNorm = 47.4427, GNorm = 0.5162, lr_0 = 1.9627e-04
Validation rmse = 0.631697
Epoch 21
Loss = 1.0533e-03, PNorm = 47.4511, GNorm = 0.5028, lr_0 = 1.8992e-04
Loss = 1.1312e-03, PNorm = 47.4599, GNorm = 1.2715, lr_0 = 1.8377e-04
Validation rmse = 0.653755
Epoch 22
Loss = 9.9667e-04, PNorm = 47.4676, GNorm = 0.6508, lr_0 = 1.7783e-04
Loss = 1.1815e-03, PNorm = 47.4765, GNorm = 0.6173, lr_0 = 1.7207e-04
Loss = 9.7338e-04, PNorm = 47.4841, GNorm = 0.5190, lr_0 = 1.6651e-04
Validation rmse = 0.640327
Epoch 23
Loss = 1.0823e-03, PNorm = 47.4921, GNorm = 1.1291, lr_0 = 1.6059e-04
Loss = 1.1643e-03, PNorm = 47.4982, GNorm = 0.7634, lr_0 = 1.5539e-04
Validation rmse = 0.632745
Epoch 24
Loss = 1.0395e-03, PNorm = 47.5057, GNorm = 0.9258, lr_0 = 1.5036e-04
Loss = 9.0421e-04, PNorm = 47.5128, GNorm = 0.7281, lr_0 = 1.4550e-04
Loss = 8.1197e-04, PNorm = 47.5195, GNorm = 1.2312, lr_0 = 1.4079e-04
Validation rmse = 0.629219
Epoch 25
Loss = 1.0908e-03, PNorm = 47.5260, GNorm = 2.7267, lr_0 = 1.3623e-04
Loss = 1.0499e-03, PNorm = 47.5342, GNorm = 0.8761, lr_0 = 1.3183e-04
Loss = 1.0253e-03, PNorm = 47.5393, GNorm = 0.7027, lr_0 = 1.2756e-04
Validation rmse = 0.635388
Epoch 26
Loss = 9.4944e-04, PNorm = 47.5457, GNorm = 2.2732, lr_0 = 1.2343e-04
Loss = 9.6649e-04, PNorm = 47.5519, GNorm = 0.8226, lr_0 = 1.1944e-04
Validation rmse = 0.651908
Epoch 27
Loss = 1.0223e-03, PNorm = 47.5574, GNorm = 0.9607, lr_0 = 1.1557e-04
Loss = 1.1407e-03, PNorm = 47.5634, GNorm = 0.6702, lr_0 = 1.1183e-04
Loss = 7.9349e-04, PNorm = 47.5687, GNorm = 1.0363, lr_0 = 1.0821e-04
Validation rmse = 0.647322
Epoch 28
Loss = 8.8715e-04, PNorm = 47.5739, GNorm = 0.5747, lr_0 = 1.0437e-04
Loss = 1.0108e-03, PNorm = 47.5790, GNorm = 0.8748, lr_0 = 1.0099e-04
Validation rmse = 0.635893
Epoch 29
Loss = 1.1878e-03, PNorm = 47.5835, GNorm = 1.5167, lr_0 = 1.0000e-04
Loss = 9.8582e-04, PNorm = 47.5888, GNorm = 2.5295, lr_0 = 1.0000e-04
Loss = 8.0764e-04, PNorm = 47.5933, GNorm = 0.8674, lr_0 = 1.0000e-04
Validation rmse = 0.637176
Model 0 best validation rmse = 0.629219 on epoch 24
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.658745
Ensemble test rmse = 0.658745
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.6762e-02, PNorm = 46.0249, GNorm = 5.5817, lr_0 = 2.9800e-04
Loss = 9.0999e-03, PNorm = 46.0526, GNorm = 1.8092, lr_0 = 4.7800e-04
Validation rmse = 1.239116
Epoch 1
Loss = 8.3903e-03, PNorm = 46.0922, GNorm = 5.4040, lr_0 = 6.7600e-04
Loss = 9.0109e-03, PNorm = 46.1402, GNorm = 3.2282, lr_0 = 8.5600e-04
Loss = 7.3389e-03, PNorm = 46.2049, GNorm = 4.4620, lr_0 = 9.9344e-04
Validation rmse = 1.169742
Epoch 2
Loss = 5.6628e-03, PNorm = 46.2675, GNorm = 2.8730, lr_0 = 9.6130e-04
Loss = 4.8909e-03, PNorm = 46.3139, GNorm = 4.4466, lr_0 = 9.3019e-04
Validation rmse = 1.087504
Epoch 3
Loss = 4.9011e-03, PNorm = 46.3575, GNorm = 1.9014, lr_0 = 9.0009e-04
Loss = 4.3571e-03, PNorm = 46.4044, GNorm = 1.7183, lr_0 = 8.7096e-04
Loss = 4.2235e-03, PNorm = 46.4483, GNorm = 3.8459, lr_0 = 8.4278e-04
Validation rmse = 0.918332
Epoch 4
Loss = 4.0219e-03, PNorm = 46.4862, GNorm = 6.5918, lr_0 = 8.1551e-04
Loss = 4.1754e-03, PNorm = 46.5313, GNorm = 2.0675, lr_0 = 7.8912e-04
Validation rmse = 1.056850
Epoch 5
Loss = 4.2716e-03, PNorm = 46.5745, GNorm = 2.6151, lr_0 = 7.6358e-04
Loss = 3.0186e-03, PNorm = 46.6138, GNorm = 0.7486, lr_0 = 7.3888e-04
Loss = 3.2441e-03, PNorm = 46.6498, GNorm = 1.7118, lr_0 = 7.1497e-04
Validation rmse = 0.850773
Epoch 6
Loss = 2.5832e-03, PNorm = 46.6888, GNorm = 1.1902, lr_0 = 6.8956e-04
Loss = 2.6237e-03, PNorm = 46.7179, GNorm = 1.0312, lr_0 = 6.6725e-04
Loss = 2.4152e-03, PNorm = 46.7442, GNorm = 2.2469, lr_0 = 6.4565e-04
Validation rmse = 0.764185
Epoch 7
Loss = 2.0735e-03, PNorm = 46.7719, GNorm = 2.4873, lr_0 = 6.2476e-04
Loss = 2.6154e-03, PNorm = 46.8005, GNorm = 1.6556, lr_0 = 6.0454e-04
Validation rmse = 0.724942
Epoch 8
Loss = 1.7624e-03, PNorm = 46.8277, GNorm = 1.2406, lr_0 = 5.8498e-04
Loss = 2.0950e-03, PNorm = 46.8545, GNorm = 2.3550, lr_0 = 5.6605e-04
Loss = 2.1167e-03, PNorm = 46.8802, GNorm = 0.7719, lr_0 = 5.4774e-04
Validation rmse = 0.733603
Epoch 9
Loss = 2.2115e-03, PNorm = 46.9042, GNorm = 2.2540, lr_0 = 5.3001e-04
Loss = 2.4021e-03, PNorm = 46.9294, GNorm = 2.9427, lr_0 = 5.1286e-04
Validation rmse = 0.764865
Epoch 10
Loss = 1.0286e-03, PNorm = 46.9544, GNorm = 0.5484, lr_0 = 4.9627e-04
Loss = 1.8428e-03, PNorm = 46.9754, GNorm = 2.6176, lr_0 = 4.8021e-04
Loss = 2.1053e-03, PNorm = 46.9983, GNorm = 3.2105, lr_0 = 4.6467e-04
Validation rmse = 0.715610
Epoch 11
Loss = 1.5064e-03, PNorm = 47.0209, GNorm = 0.5990, lr_0 = 4.4963e-04
Loss = 1.9736e-03, PNorm = 47.0435, GNorm = 1.9100, lr_0 = 4.3508e-04
Validation rmse = 0.741413
Epoch 12
Loss = 2.0838e-03, PNorm = 47.0652, GNorm = 1.7688, lr_0 = 4.1962e-04
Loss = 1.9576e-03, PNorm = 47.0840, GNorm = 1.6831, lr_0 = 4.0604e-04
Loss = 1.8913e-03, PNorm = 47.1037, GNorm = 2.7432, lr_0 = 3.9290e-04
Validation rmse = 0.738987
Epoch 13
Loss = 2.0186e-03, PNorm = 47.1253, GNorm = 0.8802, lr_0 = 3.8019e-04
Loss = 1.7331e-03, PNorm = 47.1434, GNorm = 1.9932, lr_0 = 3.6789e-04
Loss = 1.3777e-03, PNorm = 47.1617, GNorm = 0.7191, lr_0 = 3.5598e-04
Validation rmse = 0.664412
Epoch 14
Loss = 1.2605e-03, PNorm = 47.1767, GNorm = 1.1398, lr_0 = 3.4446e-04
Loss = 1.3773e-03, PNorm = 47.1920, GNorm = 0.9052, lr_0 = 3.3332e-04
Validation rmse = 0.687029
Epoch 15
Loss = 1.2054e-03, PNorm = 47.2075, GNorm = 1.3786, lr_0 = 3.2253e-04
Loss = 1.3742e-03, PNorm = 47.2226, GNorm = 1.0177, lr_0 = 3.1209e-04
Loss = 1.3622e-03, PNorm = 47.2344, GNorm = 0.9854, lr_0 = 3.0200e-04
Validation rmse = 0.648192
Epoch 16
Loss = 1.3384e-03, PNorm = 47.2500, GNorm = 0.8592, lr_0 = 2.9222e-04
Loss = 1.4210e-03, PNorm = 47.2664, GNorm = 0.7001, lr_0 = 2.8277e-04
Validation rmse = 0.697399
Epoch 17
Loss = 1.2990e-03, PNorm = 47.2816, GNorm = 1.2074, lr_0 = 2.7272e-04
Loss = 1.2598e-03, PNorm = 47.2939, GNorm = 3.0916, lr_0 = 2.6389e-04
Loss = 1.3427e-03, PNorm = 47.3066, GNorm = 0.6618, lr_0 = 2.5535e-04
Validation rmse = 0.645485
Epoch 18
Loss = 1.1064e-03, PNorm = 47.3205, GNorm = 2.4234, lr_0 = 2.4709e-04
Loss = 1.3507e-03, PNorm = 47.3330, GNorm = 1.8689, lr_0 = 2.3910e-04
Loss = 1.0424e-03, PNorm = 47.3465, GNorm = 1.1172, lr_0 = 2.3136e-04
Validation rmse = 0.645009
Epoch 19
Loss = 1.3698e-03, PNorm = 47.3580, GNorm = 0.9062, lr_0 = 2.2387e-04
Loss = 1.1584e-03, PNorm = 47.3696, GNorm = 0.5609, lr_0 = 2.1663e-04
Validation rmse = 0.647001
Epoch 20
Loss = 1.1459e-03, PNorm = 47.3811, GNorm = 0.5012, lr_0 = 2.0962e-04
Loss = 1.3179e-03, PNorm = 47.3925, GNorm = 1.5636, lr_0 = 2.0283e-04
Loss = 1.2943e-03, PNorm = 47.4040, GNorm = 0.3977, lr_0 = 1.9627e-04
Validation rmse = 0.667372
Epoch 21
Loss = 1.0845e-03, PNorm = 47.4152, GNorm = 0.7449, lr_0 = 1.8992e-04
Loss = 1.4600e-03, PNorm = 47.4251, GNorm = 1.9448, lr_0 = 1.8377e-04
Validation rmse = 0.653919
Epoch 22
Loss = 1.5151e-03, PNorm = 47.4343, GNorm = 2.5868, lr_0 = 1.7783e-04
Loss = 1.0612e-03, PNorm = 47.4438, GNorm = 1.5244, lr_0 = 1.7207e-04
Loss = 9.4194e-04, PNorm = 47.4514, GNorm = 1.9551, lr_0 = 1.6651e-04
Validation rmse = 0.658481
Epoch 23
Loss = 1.1784e-03, PNorm = 47.4610, GNorm = 1.6472, lr_0 = 1.6059e-04
Loss = 9.5479e-04, PNorm = 47.4680, GNorm = 0.8562, lr_0 = 1.5539e-04
Validation rmse = 0.665133
Epoch 24
Loss = 9.8037e-04, PNorm = 47.4760, GNorm = 1.4193, lr_0 = 1.5036e-04
Loss = 9.0777e-04, PNorm = 47.4835, GNorm = 0.7147, lr_0 = 1.4550e-04
Loss = 8.5479e-04, PNorm = 47.4904, GNorm = 0.8433, lr_0 = 1.4079e-04
Validation rmse = 0.665293
Epoch 25
Loss = 1.0843e-03, PNorm = 47.4969, GNorm = 0.5491, lr_0 = 1.3623e-04
Loss = 9.8564e-04, PNorm = 47.5038, GNorm = 1.1188, lr_0 = 1.3183e-04
Loss = 1.0068e-03, PNorm = 47.5107, GNorm = 0.4305, lr_0 = 1.2756e-04
Validation rmse = 0.661791
Epoch 26
Loss = 9.7646e-04, PNorm = 47.5173, GNorm = 0.6069, lr_0 = 1.2343e-04
Loss = 8.4991e-04, PNorm = 47.5239, GNorm = 0.8130, lr_0 = 1.1944e-04
Validation rmse = 0.642504
Epoch 27
Loss = 7.2036e-04, PNorm = 47.5297, GNorm = 0.8058, lr_0 = 1.1557e-04
Loss = 9.7463e-04, PNorm = 47.5354, GNorm = 0.6484, lr_0 = 1.1183e-04
Loss = 8.0221e-04, PNorm = 47.5408, GNorm = 1.3696, lr_0 = 1.0821e-04
Validation rmse = 0.640875
Epoch 28
Loss = 8.5177e-04, PNorm = 47.5460, GNorm = 0.5976, lr_0 = 1.0437e-04
Loss = 9.7368e-04, PNorm = 47.5512, GNorm = 1.8224, lr_0 = 1.0099e-04
Validation rmse = 0.648797
Epoch 29
Loss = 6.7873e-04, PNorm = 47.5563, GNorm = 1.6454, lr_0 = 1.0000e-04
Loss = 7.5767e-04, PNorm = 47.5613, GNorm = 1.3798, lr_0 = 1.0000e-04
Loss = 9.8216e-04, PNorm = 47.5660, GNorm = 0.7731, lr_0 = 1.0000e-04
Validation rmse = 0.644248
Model 0 best validation rmse = 0.640875 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.894170
Ensemble test rmse = 0.894170
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.6799e-02, PNorm = 46.0250, GNorm = 7.4602, lr_0 = 2.9800e-04
Loss = 1.1350e-02, PNorm = 46.0502, GNorm = 15.2722, lr_0 = 4.7800e-04
Validation rmse = 1.509030
Epoch 1
Loss = 7.6028e-03, PNorm = 46.0887, GNorm = 6.0972, lr_0 = 6.7600e-04
Loss = 7.1042e-03, PNorm = 46.1339, GNorm = 7.3003, lr_0 = 8.5600e-04
Loss = 8.1161e-03, PNorm = 46.1915, GNorm = 4.7299, lr_0 = 9.9344e-04
Validation rmse = 1.406896
Epoch 2
Loss = 6.9580e-03, PNorm = 46.2662, GNorm = 3.6173, lr_0 = 9.6130e-04
Loss = 4.8887e-03, PNorm = 46.3235, GNorm = 2.8614, lr_0 = 9.3019e-04
Validation rmse = 1.046439
Epoch 3
Loss = 3.5426e-03, PNorm = 46.3788, GNorm = 2.2190, lr_0 = 9.0009e-04
Loss = 3.7624e-03, PNorm = 46.4272, GNorm = 2.9908, lr_0 = 8.7096e-04
Loss = 3.8956e-03, PNorm = 46.4822, GNorm = 0.8339, lr_0 = 8.4278e-04
Validation rmse = 1.006819
Epoch 4
Loss = 3.0944e-03, PNorm = 46.5251, GNorm = 0.7591, lr_0 = 8.1551e-04
Loss = 2.8912e-03, PNorm = 46.5646, GNorm = 0.9684, lr_0 = 7.8912e-04
Validation rmse = 0.934171
Epoch 5
Loss = 3.4378e-03, PNorm = 46.6057, GNorm = 2.5107, lr_0 = 7.6358e-04
Loss = 3.3425e-03, PNorm = 46.6441, GNorm = 1.2016, lr_0 = 7.3888e-04
Loss = 5.4049e-03, PNorm = 46.6893, GNorm = 4.4940, lr_0 = 7.1497e-04
Validation rmse = 1.130638
Epoch 6
Loss = 2.9636e-03, PNorm = 46.7368, GNorm = 2.0715, lr_0 = 6.8956e-04
Loss = 3.1827e-03, PNorm = 46.7766, GNorm = 1.1004, lr_0 = 6.6725e-04
Loss = 2.7165e-03, PNorm = 46.8108, GNorm = 4.7680, lr_0 = 6.4565e-04
Validation rmse = 0.904352
Epoch 7
Loss = 2.3538e-03, PNorm = 46.8432, GNorm = 0.5303, lr_0 = 6.2476e-04
Loss = 2.6802e-03, PNorm = 46.8698, GNorm = 5.1278, lr_0 = 6.0454e-04
Validation rmse = 0.987898
Epoch 8
Loss = 3.1567e-03, PNorm = 46.8957, GNorm = 5.0369, lr_0 = 5.8498e-04
Loss = 2.5319e-03, PNorm = 46.9265, GNorm = 2.9896, lr_0 = 5.6605e-04
Loss = 2.1476e-03, PNorm = 46.9510, GNorm = 1.0281, lr_0 = 5.4774e-04
Validation rmse = 0.852254
Epoch 9
Loss = 1.9645e-03, PNorm = 46.9787, GNorm = 0.7776, lr_0 = 5.3001e-04
Loss = 2.0195e-03, PNorm = 47.0027, GNorm = 1.6074, lr_0 = 5.1286e-04
Validation rmse = 0.806832
Epoch 10
Loss = 1.6140e-03, PNorm = 47.0215, GNorm = 0.9978, lr_0 = 4.9627e-04
Loss = 1.9301e-03, PNorm = 47.0387, GNorm = 0.9641, lr_0 = 4.8021e-04
Loss = 1.6428e-03, PNorm = 47.0594, GNorm = 1.9762, lr_0 = 4.6467e-04
Validation rmse = 0.789804
Epoch 11
Loss = 1.7332e-03, PNorm = 47.0760, GNorm = 4.1661, lr_0 = 4.4963e-04
Loss = 2.7148e-03, PNorm = 47.0990, GNorm = 2.4877, lr_0 = 4.3508e-04
Validation rmse = 0.860065
Epoch 12
Loss = 1.8045e-03, PNorm = 47.1260, GNorm = 0.8500, lr_0 = 4.1962e-04
Loss = 1.5365e-03, PNorm = 47.1493, GNorm = 1.3917, lr_0 = 4.0604e-04
Loss = 1.6051e-03, PNorm = 47.1687, GNorm = 0.6225, lr_0 = 3.9290e-04
Validation rmse = 0.773592
Epoch 13
Loss = 1.6239e-03, PNorm = 47.1886, GNorm = 3.1312, lr_0 = 3.8019e-04
Loss = 1.7225e-03, PNorm = 47.2072, GNorm = 0.9137, lr_0 = 3.6789e-04
Loss = 1.4289e-03, PNorm = 47.2215, GNorm = 0.7146, lr_0 = 3.5598e-04
Validation rmse = 0.839738
Epoch 14
Loss = 1.6024e-03, PNorm = 47.2398, GNorm = 2.0872, lr_0 = 3.4446e-04
Loss = 1.4747e-03, PNorm = 47.2568, GNorm = 1.6209, lr_0 = 3.3332e-04
Validation rmse = 0.758567
Epoch 15
Loss = 1.0855e-03, PNorm = 47.2734, GNorm = 2.3010, lr_0 = 3.2253e-04
Loss = 1.3679e-03, PNorm = 47.2883, GNorm = 1.2813, lr_0 = 3.1209e-04
Loss = 1.2566e-03, PNorm = 47.3019, GNorm = 1.3626, lr_0 = 3.0200e-04
Validation rmse = 0.779250
Epoch 16
Loss = 1.3864e-03, PNorm = 47.3184, GNorm = 1.6265, lr_0 = 2.9222e-04
Loss = 1.4697e-03, PNorm = 47.3340, GNorm = 2.3260, lr_0 = 2.8277e-04
Validation rmse = 0.736149
Epoch 17
Loss = 1.5048e-03, PNorm = 47.3482, GNorm = 1.6758, lr_0 = 2.7272e-04
Loss = 1.3243e-03, PNorm = 47.3613, GNorm = 1.3394, lr_0 = 2.6389e-04
Loss = 1.0689e-03, PNorm = 47.3741, GNorm = 0.4216, lr_0 = 2.5535e-04
Validation rmse = 0.741563
Epoch 18
Loss = 9.8378e-04, PNorm = 47.3869, GNorm = 0.4537, lr_0 = 2.4709e-04
Loss = 1.2791e-03, PNorm = 47.3984, GNorm = 1.6663, lr_0 = 2.3910e-04
Loss = 1.1664e-03, PNorm = 47.4109, GNorm = 0.8076, lr_0 = 2.3136e-04
Validation rmse = 0.763010
Epoch 19
Loss = 1.1802e-03, PNorm = 47.4215, GNorm = 0.6457, lr_0 = 2.2387e-04
Loss = 1.2508e-03, PNorm = 47.4334, GNorm = 0.5987, lr_0 = 2.1663e-04
Validation rmse = 0.728401
Epoch 20
Loss = 7.1820e-04, PNorm = 47.4441, GNorm = 0.2940, lr_0 = 2.0962e-04
Loss = 1.0593e-03, PNorm = 47.4546, GNorm = 0.6192, lr_0 = 2.0283e-04
Loss = 1.1028e-03, PNorm = 47.4636, GNorm = 1.6504, lr_0 = 1.9627e-04
Validation rmse = 0.764232
Epoch 21
Loss = 9.4817e-04, PNorm = 47.4739, GNorm = 0.4733, lr_0 = 1.8992e-04
Loss = 1.0949e-03, PNorm = 47.4832, GNorm = 1.1781, lr_0 = 1.8377e-04
Validation rmse = 0.732670
Epoch 22
Loss = 8.7647e-04, PNorm = 47.4939, GNorm = 1.0673, lr_0 = 1.7783e-04
Loss = 1.0626e-03, PNorm = 47.5020, GNorm = 2.0439, lr_0 = 1.7207e-04
Loss = 1.1760e-03, PNorm = 47.5113, GNorm = 1.5099, lr_0 = 1.6651e-04
Validation rmse = 0.725028
Epoch 23
Loss = 9.7282e-04, PNorm = 47.5207, GNorm = 1.0178, lr_0 = 1.6059e-04
Loss = 8.6852e-04, PNorm = 47.5286, GNorm = 0.8506, lr_0 = 1.5539e-04
Validation rmse = 0.720538
Epoch 24
Loss = 5.5615e-04, PNorm = 47.5361, GNorm = 0.4906, lr_0 = 1.5036e-04
Loss = 9.9010e-04, PNorm = 47.5427, GNorm = 1.9915, lr_0 = 1.4550e-04
Loss = 1.0256e-03, PNorm = 47.5505, GNorm = 0.7029, lr_0 = 1.4079e-04
Validation rmse = 0.721955
Epoch 25
Loss = 9.5047e-04, PNorm = 47.5584, GNorm = 1.2136, lr_0 = 1.3623e-04
Loss = 8.7180e-04, PNorm = 47.5658, GNorm = 1.3653, lr_0 = 1.3183e-04
Loss = 9.4801e-04, PNorm = 47.5722, GNorm = 1.5173, lr_0 = 1.2756e-04
Validation rmse = 0.727046
Epoch 26
Loss = 8.5991e-04, PNorm = 47.5784, GNorm = 0.8334, lr_0 = 1.2343e-04
Loss = 9.4796e-04, PNorm = 47.5841, GNorm = 1.2553, lr_0 = 1.1944e-04
Validation rmse = 0.714223
Epoch 27
Loss = 8.1007e-04, PNorm = 47.5899, GNorm = 0.9618, lr_0 = 1.1557e-04
Loss = 8.0669e-04, PNorm = 47.5952, GNorm = 0.5188, lr_0 = 1.1183e-04
Loss = 8.8066e-04, PNorm = 47.6009, GNorm = 0.9545, lr_0 = 1.0821e-04
Validation rmse = 0.712328
Epoch 28
Loss = 7.0964e-04, PNorm = 47.6071, GNorm = 1.3283, lr_0 = 1.0437e-04
Loss = 9.3253e-04, PNorm = 47.6123, GNorm = 0.5628, lr_0 = 1.0099e-04
Validation rmse = 0.726544
Epoch 29
Loss = 1.4973e-03, PNorm = 47.6177, GNorm = 0.8164, lr_0 = 1.0000e-04
Loss = 7.9172e-04, PNorm = 47.6231, GNorm = 1.1087, lr_0 = 1.0000e-04
Loss = 6.8065e-04, PNorm = 47.6282, GNorm = 0.6499, lr_0 = 1.0000e-04
Validation rmse = 0.697758
Model 0 best validation rmse = 0.697758 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 1.056610
Ensemble test rmse = 1.056610
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.7601e-02, PNorm = 46.0261, GNorm = 6.7725, lr_0 = 2.9800e-04
Loss = 1.1992e-02, PNorm = 46.0512, GNorm = 5.0880, lr_0 = 4.7800e-04
Validation rmse = 1.527313
Epoch 1
Loss = 7.5918e-03, PNorm = 46.0932, GNorm = 2.6081, lr_0 = 6.7600e-04
Loss = 6.4688e-03, PNorm = 46.1408, GNorm = 2.3365, lr_0 = 8.5600e-04
Loss = 6.4606e-03, PNorm = 46.1941, GNorm = 8.6075, lr_0 = 9.9344e-04
Validation rmse = 1.245187
Epoch 2
Loss = 5.5326e-03, PNorm = 46.2527, GNorm = 6.5929, lr_0 = 9.6130e-04
Loss = 5.0080e-03, PNorm = 46.3141, GNorm = 5.6921, lr_0 = 9.3019e-04
Validation rmse = 1.207299
Epoch 3
Loss = 3.3904e-03, PNorm = 46.3670, GNorm = 3.7327, lr_0 = 9.0009e-04
Loss = 4.0085e-03, PNorm = 46.4099, GNorm = 3.1627, lr_0 = 8.7096e-04
Loss = 4.3862e-03, PNorm = 46.4540, GNorm = 1.1723, lr_0 = 8.4278e-04
Validation rmse = 1.145929
Epoch 4
Loss = 3.4395e-03, PNorm = 46.5022, GNorm = 2.1675, lr_0 = 8.1551e-04
Loss = 3.7872e-03, PNorm = 46.5421, GNorm = 4.8004, lr_0 = 7.8912e-04
Validation rmse = 1.069631
Epoch 5
Loss = 2.4071e-03, PNorm = 46.5828, GNorm = 1.1459, lr_0 = 7.6358e-04
Loss = 2.9787e-03, PNorm = 46.6158, GNorm = 1.4116, lr_0 = 7.3888e-04
Loss = 4.3726e-03, PNorm = 46.6519, GNorm = 2.4161, lr_0 = 7.1497e-04
Validation rmse = 1.173216
Epoch 6
Loss = 3.6518e-03, PNorm = 46.7057, GNorm = 3.6773, lr_0 = 6.8956e-04
Loss = 3.6624e-03, PNorm = 46.7472, GNorm = 2.1457, lr_0 = 6.6725e-04
Loss = 2.5170e-03, PNorm = 46.7799, GNorm = 2.8800, lr_0 = 6.4565e-04
Validation rmse = 0.980850
Epoch 7
Loss = 2.2012e-03, PNorm = 46.8112, GNorm = 0.8243, lr_0 = 6.2476e-04
Loss = 2.6137e-03, PNorm = 46.8402, GNorm = 1.8281, lr_0 = 6.0454e-04
Validation rmse = 1.082054
Epoch 8
Loss = 2.2570e-03, PNorm = 46.8677, GNorm = 0.9890, lr_0 = 5.8498e-04
Loss = 2.2155e-03, PNorm = 46.8932, GNorm = 2.3344, lr_0 = 5.6605e-04
Loss = 1.9804e-03, PNorm = 46.9151, GNorm = 1.7192, lr_0 = 5.4774e-04
Validation rmse = 0.992751
Epoch 9
Loss = 1.9706e-03, PNorm = 46.9330, GNorm = 2.9315, lr_0 = 5.3001e-04
Loss = 1.9623e-03, PNorm = 46.9575, GNorm = 1.2087, lr_0 = 5.1286e-04
Validation rmse = 0.922189
Epoch 10
Loss = 1.5703e-03, PNorm = 46.9794, GNorm = 0.3998, lr_0 = 4.9627e-04
Loss = 1.5126e-03, PNorm = 46.9990, GNorm = 1.2394, lr_0 = 4.8021e-04
Loss = 2.0611e-03, PNorm = 47.0209, GNorm = 2.0477, lr_0 = 4.6467e-04
Validation rmse = 0.923778
Epoch 11
Loss = 1.5729e-03, PNorm = 47.0414, GNorm = 1.1325, lr_0 = 4.4963e-04
Loss = 1.9973e-03, PNorm = 47.0655, GNorm = 1.0453, lr_0 = 4.3508e-04
Validation rmse = 0.935630
Epoch 12
Loss = 1.5648e-03, PNorm = 47.0849, GNorm = 0.7790, lr_0 = 4.1962e-04
Loss = 1.9111e-03, PNorm = 47.1029, GNorm = 0.5225, lr_0 = 4.0604e-04
Loss = 1.6980e-03, PNorm = 47.1214, GNorm = 1.9687, lr_0 = 3.9290e-04
Validation rmse = 1.147764
Epoch 13
Loss = 2.0362e-03, PNorm = 47.1461, GNorm = 5.3247, lr_0 = 3.8019e-04
Loss = 1.6697e-03, PNorm = 47.1646, GNorm = 1.5854, lr_0 = 3.6789e-04
Loss = 1.9729e-03, PNorm = 47.1859, GNorm = 3.2929, lr_0 = 3.5598e-04
Validation rmse = 0.889954
Epoch 14
Loss = 2.1327e-03, PNorm = 47.2065, GNorm = 2.0836, lr_0 = 3.4446e-04
Loss = 1.5916e-03, PNorm = 47.2280, GNorm = 1.3229, lr_0 = 3.3332e-04
Validation rmse = 0.904725
Epoch 15
Loss = 1.5807e-03, PNorm = 47.2449, GNorm = 0.9714, lr_0 = 3.2253e-04
Loss = 1.2696e-03, PNorm = 47.2581, GNorm = 0.5807, lr_0 = 3.1209e-04
Loss = 1.1976e-03, PNorm = 47.2726, GNorm = 0.6187, lr_0 = 3.0200e-04
Validation rmse = 0.865871
Epoch 16
Loss = 1.5001e-03, PNorm = 47.2851, GNorm = 1.1417, lr_0 = 2.9222e-04
Loss = 1.2458e-03, PNorm = 47.2998, GNorm = 2.3555, lr_0 = 2.8277e-04
Validation rmse = 0.885946
Epoch 17
Loss = 1.6119e-03, PNorm = 47.3148, GNorm = 2.1140, lr_0 = 2.7272e-04
Loss = 1.2382e-03, PNorm = 47.3287, GNorm = 0.6421, lr_0 = 2.6389e-04
Loss = 1.2041e-03, PNorm = 47.3429, GNorm = 1.7016, lr_0 = 2.5535e-04
Validation rmse = 0.870879
Epoch 18
Loss = 1.3091e-03, PNorm = 47.3540, GNorm = 1.8882, lr_0 = 2.4709e-04
Loss = 1.2631e-03, PNorm = 47.3665, GNorm = 0.7974, lr_0 = 2.3910e-04
Loss = 1.2703e-03, PNorm = 47.3788, GNorm = 0.5966, lr_0 = 2.3136e-04
Validation rmse = 0.922856
Epoch 19
Loss = 1.2865e-03, PNorm = 47.3905, GNorm = 1.5032, lr_0 = 2.2387e-04
Loss = 1.2819e-03, PNorm = 47.4011, GNorm = 0.7580, lr_0 = 2.1663e-04
Validation rmse = 0.908336
Epoch 20
Loss = 9.5675e-04, PNorm = 47.4108, GNorm = 0.5925, lr_0 = 2.0962e-04
Loss = 1.2113e-03, PNorm = 47.4214, GNorm = 1.4705, lr_0 = 2.0283e-04
Loss = 1.1085e-03, PNorm = 47.4315, GNorm = 1.0060, lr_0 = 1.9627e-04
Validation rmse = 0.896977
Epoch 21
Loss = 1.0452e-03, PNorm = 47.4405, GNorm = 0.9450, lr_0 = 1.8992e-04
Loss = 1.0420e-03, PNorm = 47.4487, GNorm = 0.7163, lr_0 = 1.8377e-04
Validation rmse = 0.850711
Epoch 22
Loss = 1.0088e-03, PNorm = 47.4574, GNorm = 0.5384, lr_0 = 1.7783e-04
Loss = 8.0321e-04, PNorm = 47.4653, GNorm = 1.2349, lr_0 = 1.7207e-04
Loss = 1.1560e-03, PNorm = 47.4734, GNorm = 1.7433, lr_0 = 1.6651e-04
Validation rmse = 0.898363
Epoch 23
Loss = 8.1465e-04, PNorm = 47.4827, GNorm = 0.5723, lr_0 = 1.6059e-04
Loss = 8.9475e-04, PNorm = 47.4912, GNorm = 0.4712, lr_0 = 1.5539e-04
Validation rmse = 0.848259
Epoch 24
Loss = 1.1805e-03, PNorm = 47.4978, GNorm = 1.8220, lr_0 = 1.5036e-04
Loss = 1.1506e-03, PNorm = 47.5067, GNorm = 0.4988, lr_0 = 1.4550e-04
Loss = 8.8227e-04, PNorm = 47.5139, GNorm = 0.6693, lr_0 = 1.4079e-04
Validation rmse = 0.827587
Epoch 25
Loss = 8.3859e-04, PNorm = 47.5193, GNorm = 0.8183, lr_0 = 1.3623e-04
Loss = 9.4264e-04, PNorm = 47.5260, GNorm = 1.2178, lr_0 = 1.3183e-04
Loss = 9.0392e-04, PNorm = 47.5329, GNorm = 0.5809, lr_0 = 1.2756e-04
Validation rmse = 0.863104
Epoch 26
Loss = 9.2062e-04, PNorm = 47.5399, GNorm = 1.9341, lr_0 = 1.2343e-04
Loss = 8.1453e-04, PNorm = 47.5457, GNorm = 1.0622, lr_0 = 1.1944e-04
Validation rmse = 0.846804
Epoch 27
Loss = 7.7234e-04, PNorm = 47.5491, GNorm = 0.5986, lr_0 = 1.1557e-04
Loss = 9.5435e-04, PNorm = 47.5546, GNorm = 1.2988, lr_0 = 1.1183e-04
Loss = 9.2060e-04, PNorm = 47.5597, GNorm = 1.1297, lr_0 = 1.0821e-04
Validation rmse = 0.821749
Epoch 28
Loss = 9.3389e-04, PNorm = 47.5665, GNorm = 1.3462, lr_0 = 1.0437e-04
Loss = 7.4835e-04, PNorm = 47.5711, GNorm = 0.6703, lr_0 = 1.0099e-04
Validation rmse = 0.826114
Epoch 29
Loss = 5.0273e-04, PNorm = 47.5757, GNorm = 1.1860, lr_0 = 1.0000e-04
Loss = 8.1406e-04, PNorm = 47.5809, GNorm = 0.6782, lr_0 = 1.0000e-04
Loss = 8.1461e-04, PNorm = 47.5862, GNorm = 0.8096, lr_0 = 1.0000e-04
Validation rmse = 0.826682
Model 0 best validation rmse = 0.821749 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.673163
Ensemble test rmse = 0.673163
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.8218e-02, PNorm = 46.0240, GNorm = 12.4065, lr_0 = 2.9800e-04
Loss = 1.3389e-02, PNorm = 46.0488, GNorm = 7.2977, lr_0 = 4.7800e-04
Validation rmse = 1.689895
Epoch 1
Loss = 8.6468e-03, PNorm = 46.0942, GNorm = 6.1715, lr_0 = 6.7600e-04
Loss = 8.2205e-03, PNorm = 46.1465, GNorm = 1.1647, lr_0 = 8.5600e-04
Loss = 7.3633e-03, PNorm = 46.2038, GNorm = 2.0710, lr_0 = 9.9344e-04
Validation rmse = 1.743346
Epoch 2
Loss = 6.3910e-03, PNorm = 46.2700, GNorm = 1.7078, lr_0 = 9.6130e-04
Loss = 6.0168e-03, PNorm = 46.3209, GNorm = 2.7158, lr_0 = 9.3019e-04
Validation rmse = 1.248960
Epoch 3
Loss = 4.9981e-03, PNorm = 46.3765, GNorm = 2.2975, lr_0 = 9.0009e-04
Loss = 4.2561e-03, PNorm = 46.4257, GNorm = 2.7855, lr_0 = 8.7096e-04
Loss = 3.6347e-03, PNorm = 46.4757, GNorm = 1.9732, lr_0 = 8.4278e-04
Validation rmse = 1.138433
Epoch 4
Loss = 3.2564e-03, PNorm = 46.5212, GNorm = 0.9991, lr_0 = 8.1551e-04
Loss = 5.4648e-03, PNorm = 46.5660, GNorm = 1.9358, lr_0 = 7.8912e-04
Validation rmse = 1.241184
Epoch 5
Loss = 3.2820e-03, PNorm = 46.6147, GNorm = 4.3838, lr_0 = 7.6358e-04
Loss = 3.5116e-03, PNorm = 46.6540, GNorm = 1.1525, lr_0 = 7.3888e-04
Loss = 3.8849e-03, PNorm = 46.6965, GNorm = 1.7095, lr_0 = 7.1497e-04
Validation rmse = 1.117759
Epoch 6
Loss = 2.6816e-03, PNorm = 46.7429, GNorm = 0.7208, lr_0 = 6.8956e-04
Loss = 2.8388e-03, PNorm = 46.7822, GNorm = 3.5039, lr_0 = 6.6725e-04
Loss = 3.7890e-03, PNorm = 46.8231, GNorm = 1.0856, lr_0 = 6.4565e-04
Validation rmse = 1.147475
Epoch 7
Loss = 3.2987e-03, PNorm = 46.8636, GNorm = 3.5025, lr_0 = 6.2476e-04
Loss = 2.3973e-03, PNorm = 46.8969, GNorm = 1.4995, lr_0 = 6.0454e-04
Validation rmse = 1.069845
Epoch 8
Loss = 2.2585e-03, PNorm = 46.9267, GNorm = 1.2483, lr_0 = 5.8498e-04
Loss = 1.8024e-03, PNorm = 46.9523, GNorm = 0.5810, lr_0 = 5.6605e-04
Loss = 2.1096e-03, PNorm = 46.9759, GNorm = 0.4606, lr_0 = 5.4774e-04
Validation rmse = 1.056987
Epoch 9
Loss = 2.4951e-03, PNorm = 47.0073, GNorm = 4.8908, lr_0 = 5.3001e-04
Loss = 1.8370e-03, PNorm = 47.0369, GNorm = 1.6640, lr_0 = 5.1286e-04
Validation rmse = 1.071497
Epoch 10
Loss = 2.4016e-03, PNorm = 47.0667, GNorm = 1.8967, lr_0 = 4.9627e-04
Loss = 2.0688e-03, PNorm = 47.0918, GNorm = 1.3457, lr_0 = 4.8021e-04
Loss = 1.5022e-03, PNorm = 47.1158, GNorm = 1.3237, lr_0 = 4.6467e-04
Validation rmse = 1.050359
Epoch 11
Loss = 1.9139e-03, PNorm = 47.1407, GNorm = 3.3086, lr_0 = 4.4963e-04
Loss = 1.4501e-03, PNorm = 47.1608, GNorm = 0.5801, lr_0 = 4.3508e-04
Validation rmse = 1.029473
Epoch 12
Loss = 1.5955e-03, PNorm = 47.1850, GNorm = 1.5081, lr_0 = 4.1962e-04
Loss = 1.3724e-03, PNorm = 47.2061, GNorm = 0.7810, lr_0 = 4.0604e-04
Loss = 1.5291e-03, PNorm = 47.2221, GNorm = 1.0493, lr_0 = 3.9290e-04
Validation rmse = 0.983284
Epoch 13
Loss = 1.4337e-03, PNorm = 47.2443, GNorm = 0.9974, lr_0 = 3.8019e-04
Loss = 1.4059e-03, PNorm = 47.2619, GNorm = 0.9970, lr_0 = 3.6789e-04
Loss = 1.5221e-03, PNorm = 47.2807, GNorm = 1.6215, lr_0 = 3.5598e-04
Validation rmse = 0.995741
Epoch 14
Loss = 1.4043e-03, PNorm = 47.3014, GNorm = 0.5768, lr_0 = 3.4446e-04
Loss = 1.1414e-03, PNorm = 47.3169, GNorm = 1.1843, lr_0 = 3.3332e-04
Validation rmse = 1.003177
Epoch 15
Loss = 8.6369e-04, PNorm = 47.3338, GNorm = 0.5424, lr_0 = 3.2253e-04
Loss = 1.4437e-03, PNorm = 47.3525, GNorm = 1.2499, lr_0 = 3.1209e-04
Loss = 1.3358e-03, PNorm = 47.3700, GNorm = 3.1240, lr_0 = 3.0200e-04
Validation rmse = 1.115087
Epoch 16
Loss = 1.3501e-03, PNorm = 47.3856, GNorm = 1.2258, lr_0 = 2.9222e-04
Loss = 1.6107e-03, PNorm = 47.4010, GNorm = 1.4049, lr_0 = 2.8277e-04
Validation rmse = 1.035550
Epoch 17
Loss = 1.5541e-03, PNorm = 47.4212, GNorm = 2.3684, lr_0 = 2.7272e-04
Loss = 1.2398e-03, PNorm = 47.4363, GNorm = 1.1968, lr_0 = 2.6389e-04
Loss = 1.1375e-03, PNorm = 47.4498, GNorm = 1.3342, lr_0 = 2.5535e-04
Validation rmse = 1.011328
Epoch 18
Loss = 1.3158e-03, PNorm = 47.4637, GNorm = 1.6915, lr_0 = 2.4709e-04
Loss = 9.8346e-04, PNorm = 47.4752, GNorm = 1.0665, lr_0 = 2.3910e-04
Loss = 1.1234e-03, PNorm = 47.4854, GNorm = 0.6064, lr_0 = 2.3136e-04
Validation rmse = 0.995393
Epoch 19
Loss = 1.0626e-03, PNorm = 47.4964, GNorm = 0.6426, lr_0 = 2.2387e-04
Loss = 1.0229e-03, PNorm = 47.5080, GNorm = 0.6279, lr_0 = 2.1663e-04
Validation rmse = 0.989910
Epoch 20
Loss = 9.5285e-04, PNorm = 47.5183, GNorm = 0.5297, lr_0 = 2.0962e-04
Loss = 1.0495e-03, PNorm = 47.5298, GNorm = 0.6152, lr_0 = 2.0283e-04
Loss = 1.1223e-03, PNorm = 47.5412, GNorm = 1.3705, lr_0 = 1.9627e-04
Validation rmse = 1.000175
Epoch 21
Loss = 9.1960e-04, PNorm = 47.5508, GNorm = 1.0981, lr_0 = 1.8992e-04
Loss = 9.7023e-04, PNorm = 47.5598, GNorm = 0.8426, lr_0 = 1.8377e-04
Validation rmse = 0.967173
Epoch 22
Loss = 7.8108e-04, PNorm = 47.5681, GNorm = 0.9824, lr_0 = 1.7783e-04
Loss = 9.0031e-04, PNorm = 47.5769, GNorm = 0.4230, lr_0 = 1.7207e-04
Loss = 9.7525e-04, PNorm = 47.5843, GNorm = 0.7152, lr_0 = 1.6651e-04
Validation rmse = 0.983778
Epoch 23
Loss = 7.7502e-04, PNorm = 47.5929, GNorm = 1.4063, lr_0 = 1.6059e-04
Loss = 1.0540e-03, PNorm = 47.5995, GNorm = 0.8269, lr_0 = 1.5539e-04
Validation rmse = 0.972263
Epoch 24
Loss = 7.3591e-04, PNorm = 47.6072, GNorm = 0.8007, lr_0 = 1.5036e-04
Loss = 8.6593e-04, PNorm = 47.6155, GNorm = 0.6761, lr_0 = 1.4550e-04
Loss = 9.3919e-04, PNorm = 47.6239, GNorm = 0.6140, lr_0 = 1.4079e-04
Validation rmse = 0.982906
Epoch 25
Loss = 9.1096e-04, PNorm = 47.6307, GNorm = 0.7711, lr_0 = 1.3623e-04
Loss = 7.3729e-04, PNorm = 47.6368, GNorm = 0.8684, lr_0 = 1.3183e-04
Loss = 9.6185e-04, PNorm = 47.6427, GNorm = 0.5337, lr_0 = 1.2756e-04
Validation rmse = 0.967583
Epoch 26
Loss = 7.8647e-04, PNorm = 47.6494, GNorm = 0.8823, lr_0 = 1.2343e-04
Loss = 8.3319e-04, PNorm = 47.6558, GNorm = 0.6202, lr_0 = 1.1944e-04
Validation rmse = 0.977221
Epoch 27
Loss = 8.5915e-04, PNorm = 47.6625, GNorm = 0.9139, lr_0 = 1.1557e-04
Loss = 7.6972e-04, PNorm = 47.6697, GNorm = 1.1591, lr_0 = 1.1183e-04
Loss = 8.9587e-04, PNorm = 47.6749, GNorm = 0.6976, lr_0 = 1.0821e-04
Validation rmse = 0.974446
Epoch 28
Loss = 8.1872e-04, PNorm = 47.6793, GNorm = 0.5569, lr_0 = 1.0437e-04
Loss = 7.8101e-04, PNorm = 47.6844, GNorm = 1.5335, lr_0 = 1.0099e-04
Validation rmse = 0.972737
Epoch 29
Loss = 7.2698e-04, PNorm = 47.6897, GNorm = 0.4614, lr_0 = 1.0000e-04
Loss = 6.9862e-04, PNorm = 47.6947, GNorm = 0.9865, lr_0 = 1.0000e-04
Loss = 8.8197e-04, PNorm = 47.6998, GNorm = 0.4040, lr_0 = 1.0000e-04
Validation rmse = 0.964457
Model 0 best validation rmse = 0.964457 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.746598
Ensemble test rmse = 0.746598
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.4276e-02, PNorm = 46.0265, GNorm = 7.2588, lr_0 = 2.9800e-04
Loss = 1.2642e-02, PNorm = 46.0499, GNorm = 19.0482, lr_0 = 4.7800e-04
Validation rmse = 1.559889
Epoch 1
Loss = 7.5568e-03, PNorm = 46.0906, GNorm = 8.2090, lr_0 = 6.7600e-04
Loss = 7.9337e-03, PNorm = 46.1415, GNorm = 6.4588, lr_0 = 8.5600e-04
Loss = 7.3612e-03, PNorm = 46.2015, GNorm = 2.7083, lr_0 = 9.9344e-04
Validation rmse = 1.121563
Epoch 2
Loss = 5.6520e-03, PNorm = 46.2633, GNorm = 3.3765, lr_0 = 9.6130e-04
Loss = 5.0907e-03, PNorm = 46.3217, GNorm = 4.4944, lr_0 = 9.3019e-04
Validation rmse = 1.431513
Epoch 3
Loss = 4.8401e-03, PNorm = 46.3682, GNorm = 1.6530, lr_0 = 9.0009e-04
Loss = 4.2599e-03, PNorm = 46.4172, GNorm = 2.7140, lr_0 = 8.7096e-04
Loss = 4.6663e-03, PNorm = 46.4668, GNorm = 4.2322, lr_0 = 8.4278e-04
Validation rmse = 0.881197
Epoch 4
Loss = 3.5005e-03, PNorm = 46.5156, GNorm = 2.8303, lr_0 = 8.1551e-04
Loss = 3.6431e-03, PNorm = 46.5588, GNorm = 4.1688, lr_0 = 7.8912e-04
Validation rmse = 0.978670
Epoch 5
Loss = 3.4863e-03, PNorm = 46.6002, GNorm = 3.0992, lr_0 = 7.6358e-04
Loss = 3.2417e-03, PNorm = 46.6489, GNorm = 0.6382, lr_0 = 7.3888e-04
Loss = 3.3264e-03, PNorm = 46.6892, GNorm = 2.6491, lr_0 = 7.1497e-04
Validation rmse = 0.928476
Epoch 6
Loss = 4.1026e-03, PNorm = 46.7297, GNorm = 7.5190, lr_0 = 6.8956e-04
Loss = 3.6565e-03, PNorm = 46.7674, GNorm = 0.7359, lr_0 = 6.6725e-04
Loss = 2.8224e-03, PNorm = 46.8046, GNorm = 3.0301, lr_0 = 6.4565e-04
Validation rmse = 0.872205
Epoch 7
Loss = 2.6524e-03, PNorm = 46.8417, GNorm = 1.0113, lr_0 = 6.2476e-04
Loss = 2.3569e-03, PNorm = 46.8728, GNorm = 2.3839, lr_0 = 6.0454e-04
Validation rmse = 0.910075
Epoch 8
Loss = 1.5990e-03, PNorm = 46.9051, GNorm = 0.5408, lr_0 = 5.8498e-04
Loss = 2.2872e-03, PNorm = 46.9366, GNorm = 2.4712, lr_0 = 5.6605e-04
Loss = 2.3012e-03, PNorm = 46.9668, GNorm = 1.5960, lr_0 = 5.4774e-04
Validation rmse = 0.824637
Epoch 9
Loss = 2.1105e-03, PNorm = 46.9963, GNorm = 3.2399, lr_0 = 5.3001e-04
Loss = 2.5744e-03, PNorm = 47.0299, GNorm = 2.7550, lr_0 = 5.1286e-04
Validation rmse = 0.856812
Epoch 10
Loss = 1.9509e-03, PNorm = 47.0581, GNorm = 0.6923, lr_0 = 4.9627e-04
Loss = 1.8778e-03, PNorm = 47.0864, GNorm = 0.9739, lr_0 = 4.8021e-04
Loss = 2.1716e-03, PNorm = 47.1106, GNorm = 2.9221, lr_0 = 4.6467e-04
Validation rmse = 0.956631
Epoch 11
Loss = 2.5134e-03, PNorm = 47.1365, GNorm = 3.3798, lr_0 = 4.4963e-04
Loss = 1.6240e-03, PNorm = 47.1612, GNorm = 0.8876, lr_0 = 4.3508e-04
Validation rmse = 0.799880
Epoch 12
Loss = 1.9075e-03, PNorm = 47.1812, GNorm = 0.9680, lr_0 = 4.1962e-04
Loss = 1.5860e-03, PNorm = 47.2023, GNorm = 1.3568, lr_0 = 4.0604e-04
Loss = 1.6571e-03, PNorm = 47.2210, GNorm = 0.7168, lr_0 = 3.9290e-04
Validation rmse = 0.852215
Epoch 13
Loss = 1.6031e-03, PNorm = 47.2364, GNorm = 1.1737, lr_0 = 3.8019e-04
Loss = 1.3924e-03, PNorm = 47.2515, GNorm = 1.0866, lr_0 = 3.6789e-04
Loss = 1.5819e-03, PNorm = 47.2683, GNorm = 1.1415, lr_0 = 3.5598e-04
Validation rmse = 0.763819
Epoch 14
Loss = 1.3356e-03, PNorm = 47.2858, GNorm = 1.0408, lr_0 = 3.4446e-04
Loss = 1.3964e-03, PNorm = 47.3027, GNorm = 1.4731, lr_0 = 3.3332e-04
Validation rmse = 0.817217
Epoch 15
Loss = 6.9574e-04, PNorm = 47.3207, GNorm = 0.7195, lr_0 = 3.2253e-04
Loss = 1.5608e-03, PNorm = 47.3400, GNorm = 0.6163, lr_0 = 3.1209e-04
Loss = 1.2912e-03, PNorm = 47.3562, GNorm = 0.6356, lr_0 = 3.0200e-04
Validation rmse = 0.799213
Epoch 16
Loss = 1.1058e-03, PNorm = 47.3733, GNorm = 1.6594, lr_0 = 2.9222e-04
Loss = 1.4551e-03, PNorm = 47.3889, GNorm = 2.7428, lr_0 = 2.8277e-04
Validation rmse = 0.771597
Epoch 17
Loss = 9.1707e-04, PNorm = 47.4025, GNorm = 1.4892, lr_0 = 2.7272e-04
Loss = 1.1317e-03, PNorm = 47.4132, GNorm = 0.4863, lr_0 = 2.6389e-04
Loss = 1.3751e-03, PNorm = 47.4269, GNorm = 2.3118, lr_0 = 2.5535e-04
Validation rmse = 0.732862
Epoch 18
Loss = 1.0318e-03, PNorm = 47.4398, GNorm = 0.9387, lr_0 = 2.4709e-04
Loss = 1.0994e-03, PNorm = 47.4508, GNorm = 0.6949, lr_0 = 2.3910e-04
Loss = 1.3068e-03, PNorm = 47.4620, GNorm = 2.1900, lr_0 = 2.3136e-04
Validation rmse = 0.756504
Epoch 19
Loss = 1.2048e-03, PNorm = 47.4740, GNorm = 0.8260, lr_0 = 2.2387e-04
Loss = 1.1697e-03, PNorm = 47.4860, GNorm = 0.4603, lr_0 = 2.1663e-04
Validation rmse = 0.741623
Epoch 20
Loss = 1.4785e-03, PNorm = 47.4960, GNorm = 0.9461, lr_0 = 2.0962e-04
Loss = 1.1836e-03, PNorm = 47.5061, GNorm = 2.6100, lr_0 = 2.0283e-04
Loss = 1.0636e-03, PNorm = 47.5169, GNorm = 1.3470, lr_0 = 1.9627e-04
Validation rmse = 0.729984
Epoch 21
Loss = 1.1218e-03, PNorm = 47.5281, GNorm = 1.2633, lr_0 = 1.8992e-04
Loss = 9.8259e-04, PNorm = 47.5374, GNorm = 1.1669, lr_0 = 1.8377e-04
Validation rmse = 0.753356
Epoch 22
Loss = 1.2033e-03, PNorm = 47.5451, GNorm = 0.8671, lr_0 = 1.7783e-04
Loss = 9.4884e-04, PNorm = 47.5524, GNorm = 1.3955, lr_0 = 1.7207e-04
Loss = 1.0332e-03, PNorm = 47.5603, GNorm = 0.9354, lr_0 = 1.6651e-04
Validation rmse = 0.813026
Epoch 23
Loss = 8.7889e-04, PNorm = 47.5683, GNorm = 0.7282, lr_0 = 1.6059e-04
Loss = 9.2702e-04, PNorm = 47.5759, GNorm = 0.4406, lr_0 = 1.5539e-04
Validation rmse = 0.796393
Epoch 24
Loss = 5.5994e-04, PNorm = 47.5829, GNorm = 0.4466, lr_0 = 1.5036e-04
Loss = 9.7324e-04, PNorm = 47.5900, GNorm = 0.5467, lr_0 = 1.4550e-04
Loss = 9.3784e-04, PNorm = 47.5969, GNorm = 0.4098, lr_0 = 1.4079e-04
Validation rmse = 0.763597
Epoch 25
Loss = 6.9338e-04, PNorm = 47.6037, GNorm = 0.5501, lr_0 = 1.3623e-04
Loss = 8.3925e-04, PNorm = 47.6089, GNorm = 1.0378, lr_0 = 1.3183e-04
Loss = 9.8555e-04, PNorm = 47.6152, GNorm = 0.5481, lr_0 = 1.2756e-04
Validation rmse = 0.737226
Epoch 26
Loss = 7.6564e-04, PNorm = 47.6202, GNorm = 0.5125, lr_0 = 1.2343e-04
Loss = 9.1779e-04, PNorm = 47.6265, GNorm = 0.5290, lr_0 = 1.1944e-04
Validation rmse = 0.720559
Epoch 27
Loss = 7.3025e-04, PNorm = 47.6322, GNorm = 0.6305, lr_0 = 1.1557e-04
Loss = 9.3087e-04, PNorm = 47.6381, GNorm = 1.0496, lr_0 = 1.1183e-04
Loss = 9.2584e-04, PNorm = 47.6435, GNorm = 1.3382, lr_0 = 1.0821e-04
Validation rmse = 0.757935
Epoch 28
Loss = 7.9992e-04, PNorm = 47.6481, GNorm = 0.7354, lr_0 = 1.0437e-04
Loss = 7.7705e-04, PNorm = 47.6524, GNorm = 0.5557, lr_0 = 1.0099e-04
Validation rmse = 0.751321
Epoch 29
Loss = 6.2085e-04, PNorm = 47.6581, GNorm = 0.6771, lr_0 = 1.0000e-04
Loss = 8.4832e-04, PNorm = 47.6633, GNorm = 1.6657, lr_0 = 1.0000e-04
Loss = 8.6475e-04, PNorm = 47.6681, GNorm = 1.0719, lr_0 = 1.0000e-04
Validation rmse = 0.749816
Model 0 best validation rmse = 0.720559 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.705750
Ensemble test rmse = 0.705750
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.7981e-02, PNorm = 46.0248, GNorm = 12.2868, lr_0 = 2.9800e-04
Loss = 1.2757e-02, PNorm = 46.0469, GNorm = 2.9581, lr_0 = 4.7800e-04
Validation rmse = 1.629366
Epoch 1
Loss = 9.9585e-03, PNorm = 46.0928, GNorm = 1.3182, lr_0 = 6.7600e-04
Loss = 8.0511e-03, PNorm = 46.1423, GNorm = 0.9402, lr_0 = 8.5600e-04
Loss = 6.4195e-03, PNorm = 46.1943, GNorm = 1.0652, lr_0 = 9.9344e-04
Validation rmse = 1.357491
Epoch 2
Loss = 5.8146e-03, PNorm = 46.2520, GNorm = 3.7580, lr_0 = 9.6130e-04
Loss = 4.8305e-03, PNorm = 46.3035, GNorm = 5.0850, lr_0 = 9.3019e-04
Validation rmse = 1.405679
Epoch 3
Loss = 4.3870e-03, PNorm = 46.3542, GNorm = 1.2099, lr_0 = 9.0009e-04
Loss = 4.6508e-03, PNorm = 46.4006, GNorm = 3.1282, lr_0 = 8.7096e-04
Loss = 4.4918e-03, PNorm = 46.4517, GNorm = 2.1111, lr_0 = 8.4278e-04
Validation rmse = 1.097404
Epoch 4
Loss = 3.8297e-03, PNorm = 46.4929, GNorm = 1.2367, lr_0 = 8.1551e-04
Loss = 3.5640e-03, PNorm = 46.5372, GNorm = 3.2260, lr_0 = 7.8912e-04
Validation rmse = 1.137087
Epoch 5
Loss = 2.4041e-03, PNorm = 46.5730, GNorm = 1.0806, lr_0 = 7.6358e-04
Loss = 3.2345e-03, PNorm = 46.6110, GNorm = 3.1303, lr_0 = 7.3888e-04
Loss = 3.5164e-03, PNorm = 46.6483, GNorm = 1.1012, lr_0 = 7.1497e-04
Validation rmse = 1.066371
Epoch 6
Loss = 2.8613e-03, PNorm = 46.6926, GNorm = 2.9306, lr_0 = 6.8956e-04
Loss = 2.7738e-03, PNorm = 46.7287, GNorm = 0.9762, lr_0 = 6.6725e-04
Loss = 2.8740e-03, PNorm = 46.7509, GNorm = 1.6543, lr_0 = 6.4565e-04
Validation rmse = 1.001332
Epoch 7
Loss = 2.5202e-03, PNorm = 46.7786, GNorm = 0.7480, lr_0 = 6.2476e-04
Loss = 2.2094e-03, PNorm = 46.8059, GNorm = 1.6644, lr_0 = 6.0454e-04
Validation rmse = 0.979174
Epoch 8
Loss = 2.3740e-03, PNorm = 46.8308, GNorm = 1.0863, lr_0 = 5.8498e-04
Loss = 2.2864e-03, PNorm = 46.8616, GNorm = 1.2070, lr_0 = 5.6605e-04
Loss = 1.8559e-03, PNorm = 46.8905, GNorm = 1.1572, lr_0 = 5.4774e-04
Validation rmse = 1.018070
Epoch 9
Loss = 1.9835e-03, PNorm = 46.9150, GNorm = 0.9168, lr_0 = 5.3001e-04
Loss = 2.0760e-03, PNorm = 46.9396, GNorm = 0.8526, lr_0 = 5.1286e-04
Validation rmse = 0.976118
Epoch 10
Loss = 1.8761e-03, PNorm = 46.9631, GNorm = 2.1515, lr_0 = 4.9627e-04
Loss = 2.6535e-03, PNorm = 46.9868, GNorm = 4.2441, lr_0 = 4.8021e-04
Loss = 2.2967e-03, PNorm = 47.0088, GNorm = 1.5448, lr_0 = 4.6467e-04
Validation rmse = 1.021981
Epoch 11
Loss = 2.0375e-03, PNorm = 47.0343, GNorm = 0.9472, lr_0 = 4.4963e-04
Loss = 1.8855e-03, PNorm = 47.0599, GNorm = 3.3509, lr_0 = 4.3508e-04
Validation rmse = 0.957275
Epoch 12
Loss = 1.7443e-03, PNorm = 47.0815, GNorm = 1.9819, lr_0 = 4.1962e-04
Loss = 1.6954e-03, PNorm = 47.0983, GNorm = 2.8306, lr_0 = 4.0604e-04
Loss = 1.7457e-03, PNorm = 47.1162, GNorm = 3.9762, lr_0 = 3.9290e-04
Validation rmse = 0.954317
Epoch 13
Loss = 1.8219e-03, PNorm = 47.1352, GNorm = 1.0588, lr_0 = 3.8019e-04
Loss = 1.9524e-03, PNorm = 47.1524, GNorm = 2.1267, lr_0 = 3.6789e-04
Loss = 1.7022e-03, PNorm = 47.1721, GNorm = 0.5923, lr_0 = 3.5598e-04
Validation rmse = 0.913432
Epoch 14
Loss = 1.3322e-03, PNorm = 47.1885, GNorm = 0.5664, lr_0 = 3.4446e-04
Loss = 1.4792e-03, PNorm = 47.2047, GNorm = 0.8077, lr_0 = 3.3332e-04
Validation rmse = 0.951564
Epoch 15
Loss = 1.6225e-03, PNorm = 47.2203, GNorm = 0.8859, lr_0 = 3.2253e-04
Loss = 1.3947e-03, PNorm = 47.2356, GNorm = 0.8395, lr_0 = 3.1209e-04
Loss = 1.5343e-03, PNorm = 47.2512, GNorm = 1.3059, lr_0 = 3.0200e-04
Validation rmse = 0.962080
Epoch 16
Loss = 1.3395e-03, PNorm = 47.2633, GNorm = 0.9754, lr_0 = 2.9222e-04
Loss = 1.4177e-03, PNorm = 47.2780, GNorm = 0.6539, lr_0 = 2.8277e-04
Validation rmse = 0.957471
Epoch 17
Loss = 9.9546e-04, PNorm = 47.2932, GNorm = 1.3614, lr_0 = 2.7272e-04
Loss = 1.5714e-03, PNorm = 47.3091, GNorm = 0.7019, lr_0 = 2.6389e-04
Loss = 1.3194e-03, PNorm = 47.3202, GNorm = 1.5767, lr_0 = 2.5535e-04
Validation rmse = 0.918963
Epoch 18
Loss = 1.3610e-03, PNorm = 47.3305, GNorm = 1.6702, lr_0 = 2.4709e-04
Loss = 1.4486e-03, PNorm = 47.3403, GNorm = 1.5623, lr_0 = 2.3910e-04
Loss = 1.4817e-03, PNorm = 47.3541, GNorm = 0.8988, lr_0 = 2.3136e-04
Validation rmse = 0.962340
Epoch 19
Loss = 1.2619e-03, PNorm = 47.3665, GNorm = 2.0375, lr_0 = 2.2387e-04
Loss = 1.1244e-03, PNorm = 47.3776, GNorm = 1.2818, lr_0 = 2.1663e-04
Validation rmse = 0.951654
Epoch 20
Loss = 1.1581e-03, PNorm = 47.3867, GNorm = 0.8882, lr_0 = 2.0962e-04
Loss = 1.0574e-03, PNorm = 47.3970, GNorm = 0.9427, lr_0 = 2.0283e-04
Loss = 1.3171e-03, PNorm = 47.4084, GNorm = 2.3290, lr_0 = 1.9627e-04
Validation rmse = 0.935391
Epoch 21
Loss = 9.8733e-04, PNorm = 47.4162, GNorm = 0.6528, lr_0 = 1.8992e-04
Loss = 1.2262e-03, PNorm = 47.4244, GNorm = 0.6916, lr_0 = 1.8377e-04
Validation rmse = 0.953653
Epoch 22
Loss = 1.1061e-03, PNorm = 47.4341, GNorm = 1.0923, lr_0 = 1.7783e-04
Loss = 9.8215e-04, PNorm = 47.4440, GNorm = 0.9468, lr_0 = 1.7207e-04
Loss = 1.1501e-03, PNorm = 47.4514, GNorm = 0.5945, lr_0 = 1.6651e-04
Validation rmse = 0.926243
Epoch 23
Loss = 1.0821e-03, PNorm = 47.4592, GNorm = 1.0164, lr_0 = 1.6059e-04
Loss = 1.0495e-03, PNorm = 47.4678, GNorm = 0.7214, lr_0 = 1.5539e-04
Validation rmse = 0.948453
Epoch 24
Loss = 7.0871e-04, PNorm = 47.4754, GNorm = 1.1603, lr_0 = 1.5036e-04
Loss = 1.1633e-03, PNorm = 47.4840, GNorm = 0.6957, lr_0 = 1.4550e-04
Loss = 9.8003e-04, PNorm = 47.4901, GNorm = 0.7334, lr_0 = 1.4079e-04
Validation rmse = 0.946889
Epoch 25
Loss = 8.7803e-04, PNorm = 47.4973, GNorm = 0.6449, lr_0 = 1.3623e-04
Loss = 9.9728e-04, PNorm = 47.5039, GNorm = 1.1448, lr_0 = 1.3183e-04
Loss = 1.0888e-03, PNorm = 47.5111, GNorm = 1.2204, lr_0 = 1.2756e-04
Validation rmse = 0.966954
Epoch 26
Loss = 1.0946e-03, PNorm = 47.5172, GNorm = 1.4057, lr_0 = 1.2343e-04
Loss = 9.3067e-04, PNorm = 47.5239, GNorm = 1.1301, lr_0 = 1.1944e-04
Validation rmse = 0.959837
Epoch 27
Loss = 1.2606e-03, PNorm = 47.5299, GNorm = 1.8594, lr_0 = 1.1557e-04
Loss = 9.3196e-04, PNorm = 47.5353, GNorm = 1.3262, lr_0 = 1.1183e-04
Loss = 1.0041e-03, PNorm = 47.5400, GNorm = 0.8049, lr_0 = 1.0821e-04
Validation rmse = 0.948685
Epoch 28
Loss = 1.0252e-03, PNorm = 47.5461, GNorm = 1.2242, lr_0 = 1.0437e-04
Loss = 7.6155e-04, PNorm = 47.5520, GNorm = 0.4849, lr_0 = 1.0099e-04
Validation rmse = 0.934320
Epoch 29
Loss = 4.9331e-04, PNorm = 47.5561, GNorm = 0.6241, lr_0 = 1.0000e-04
Loss = 9.1412e-04, PNorm = 47.5608, GNorm = 0.5029, lr_0 = 1.0000e-04
Loss = 8.8210e-04, PNorm = 47.5648, GNorm = 1.1491, lr_0 = 1.0000e-04
Validation rmse = 0.990777
Model 0 best validation rmse = 0.913432 on epoch 13
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.730933
Ensemble test rmse = 0.730933
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 5,
 'device': device(type='cuda'),
 'dropout': 0.05,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 900,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 900,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_5_dropout_0.05_ffn_num_layers_1_hidden_size_900/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.05, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=900, bias=False)
      (W_h): Linear(in_features=900, out_features=900, bias=False)
      (W_o): Linear(in_features=1033, out_features=900, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.05, inplace=False)
    (1): Linear(in_features=900, out_features=1, bias=True)
  )
)
Number of parameters = 1,873,801
Moving model to cuda
Epoch 0
Loss = 1.7620e-02, PNorm = 46.0252, GNorm = 10.4119, lr_0 = 2.9800e-04
Loss = 1.3098e-02, PNorm = 46.0498, GNorm = 8.8966, lr_0 = 4.7800e-04
Validation rmse = 1.569579
Epoch 1
Loss = 7.5193e-03, PNorm = 46.0935, GNorm = 3.4565, lr_0 = 6.7600e-04
Loss = 7.5788e-03, PNorm = 46.1425, GNorm = 5.4129, lr_0 = 8.5600e-04
Loss = 6.8518e-03, PNorm = 46.2050, GNorm = 3.0697, lr_0 = 9.9344e-04
Validation rmse = 1.305424
Epoch 2
Loss = 6.1094e-03, PNorm = 46.2688, GNorm = 3.9741, lr_0 = 9.6130e-04
Loss = 4.3248e-03, PNorm = 46.3290, GNorm = 6.0177, lr_0 = 9.3019e-04
Validation rmse = 1.057883
Epoch 3
Loss = 3.8311e-03, PNorm = 46.3786, GNorm = 2.5724, lr_0 = 9.0009e-04
Loss = 4.0783e-03, PNorm = 46.4262, GNorm = 2.4205, lr_0 = 8.7096e-04
Loss = 4.6286e-03, PNorm = 46.4732, GNorm = 1.1754, lr_0 = 8.4278e-04
Validation rmse = 1.064061
Epoch 4
Loss = 4.2734e-03, PNorm = 46.5176, GNorm = 3.5055, lr_0 = 8.1551e-04
Loss = 3.9157e-03, PNorm = 46.5612, GNorm = 2.1885, lr_0 = 7.8912e-04
Validation rmse = 1.123803
Epoch 5
Loss = 3.0141e-03, PNorm = 46.6039, GNorm = 1.4195, lr_0 = 7.6358e-04
Loss = 3.3111e-03, PNorm = 46.6422, GNorm = 2.0991, lr_0 = 7.3888e-04
Loss = 2.6894e-03, PNorm = 46.6733, GNorm = 2.5217, lr_0 = 7.1497e-04
Validation rmse = 1.023449
Epoch 6
Loss = 2.4527e-03, PNorm = 46.7131, GNorm = 0.9709, lr_0 = 6.8956e-04
Loss = 2.7208e-03, PNorm = 46.7478, GNorm = 3.0218, lr_0 = 6.6725e-04
Loss = 2.3416e-03, PNorm = 46.7777, GNorm = 3.8308, lr_0 = 6.4565e-04
Validation rmse = 0.903935
Epoch 7
Loss = 1.9243e-03, PNorm = 46.8085, GNorm = 1.0630, lr_0 = 6.2476e-04
Loss = 2.2399e-03, PNorm = 46.8346, GNorm = 0.9061, lr_0 = 6.0454e-04
Validation rmse = 0.942768
Epoch 8
Loss = 2.5529e-03, PNorm = 46.8648, GNorm = 2.9431, lr_0 = 5.8498e-04
Loss = 2.0819e-03, PNorm = 46.8984, GNorm = 0.5996, lr_0 = 5.6605e-04
Loss = 1.8574e-03, PNorm = 46.9265, GNorm = 2.6304, lr_0 = 5.4774e-04
Validation rmse = 0.856418
Epoch 9
Loss = 1.4978e-03, PNorm = 46.9518, GNorm = 1.1596, lr_0 = 5.3001e-04
Loss = 1.7502e-03, PNorm = 46.9757, GNorm = 2.6389, lr_0 = 5.1286e-04
Validation rmse = 0.828847
Epoch 10
Loss = 1.7134e-03, PNorm = 47.0031, GNorm = 2.2928, lr_0 = 4.9627e-04
Loss = 1.8376e-03, PNorm = 47.0287, GNorm = 0.5340, lr_0 = 4.8021e-04
Loss = 1.9101e-03, PNorm = 47.0570, GNorm = 0.9372, lr_0 = 4.6467e-04
Validation rmse = 0.836277
Epoch 11
Loss = 1.5528e-03, PNorm = 47.0808, GNorm = 0.6249, lr_0 = 4.4963e-04
Loss = 1.6585e-03, PNorm = 47.1034, GNorm = 1.2797, lr_0 = 4.3508e-04
Validation rmse = 0.814071
Epoch 12
Loss = 1.0787e-03, PNorm = 47.1254, GNorm = 0.8621, lr_0 = 4.1962e-04
Loss = 1.6980e-03, PNorm = 47.1477, GNorm = 0.7643, lr_0 = 4.0604e-04
Loss = 1.5617e-03, PNorm = 47.1703, GNorm = 1.3738, lr_0 = 3.9290e-04
Validation rmse = 0.834885
Epoch 13
Loss = 1.4651e-03, PNorm = 47.1853, GNorm = 0.7567, lr_0 = 3.8019e-04
Loss = 1.3806e-03, PNorm = 47.2077, GNorm = 0.7305, lr_0 = 3.6789e-04
Loss = 1.5430e-03, PNorm = 47.2254, GNorm = 0.9440, lr_0 = 3.5598e-04
Validation rmse = 0.766256
Epoch 14
Loss = 1.2849e-03, PNorm = 47.2450, GNorm = 1.2762, lr_0 = 3.4446e-04
Loss = 1.2645e-03, PNorm = 47.2626, GNorm = 0.5716, lr_0 = 3.3332e-04
Validation rmse = 0.904823
Epoch 15
Loss = 2.1202e-03, PNorm = 47.2792, GNorm = 1.3340, lr_0 = 3.2253e-04
Loss = 1.4194e-03, PNorm = 47.2982, GNorm = 0.8853, lr_0 = 3.1209e-04
Loss = 1.0889e-03, PNorm = 47.3152, GNorm = 0.8843, lr_0 = 3.0200e-04
Validation rmse = 0.797970
Epoch 16
Loss = 1.1687e-03, PNorm = 47.3296, GNorm = 0.3834, lr_0 = 2.9222e-04
Loss = 1.1142e-03, PNorm = 47.3424, GNorm = 0.7466, lr_0 = 2.8277e-04
Validation rmse = 0.754069
Epoch 17
Loss = 9.8127e-04, PNorm = 47.3579, GNorm = 0.8479, lr_0 = 2.7272e-04
Loss = 1.1207e-03, PNorm = 47.3703, GNorm = 0.5832, lr_0 = 2.6389e-04
Loss = 1.0909e-03, PNorm = 47.3812, GNorm = 0.4877, lr_0 = 2.5535e-04
Validation rmse = 0.761476
Epoch 18
Loss = 1.1547e-03, PNorm = 47.3922, GNorm = 0.4204, lr_0 = 2.4709e-04
Loss = 1.1559e-03, PNorm = 47.4060, GNorm = 2.9901, lr_0 = 2.3910e-04
Loss = 1.0447e-03, PNorm = 47.4170, GNorm = 0.6139, lr_0 = 2.3136e-04
Validation rmse = 0.747838
Epoch 19
Loss = 1.1357e-03, PNorm = 47.4272, GNorm = 0.9107, lr_0 = 2.2387e-04
Loss = 1.0574e-03, PNorm = 47.4373, GNorm = 0.6964, lr_0 = 2.1663e-04
Validation rmse = 0.716267
Epoch 20
Loss = 7.8469e-04, PNorm = 47.4478, GNorm = 0.5951, lr_0 = 2.0962e-04
Loss = 1.1136e-03, PNorm = 47.4571, GNorm = 1.4031, lr_0 = 2.0283e-04
Loss = 9.6130e-04, PNorm = 47.4666, GNorm = 1.2269, lr_0 = 1.9627e-04
Validation rmse = 0.749765
Epoch 21
Loss = 9.1129e-04, PNorm = 47.4760, GNorm = 0.5518, lr_0 = 1.8992e-04
Loss = 1.0524e-03, PNorm = 47.4861, GNorm = 0.9005, lr_0 = 1.8377e-04
Validation rmse = 0.754735
Epoch 22
Loss = 8.3239e-04, PNorm = 47.4960, GNorm = 0.3599, lr_0 = 1.7783e-04
Loss = 9.2723e-04, PNorm = 47.5040, GNorm = 0.5029, lr_0 = 1.7207e-04
Loss = 9.5581e-04, PNorm = 47.5111, GNorm = 0.4698, lr_0 = 1.6651e-04
Validation rmse = 0.743740
Epoch 23
Loss = 1.0726e-03, PNorm = 47.5191, GNorm = 1.2277, lr_0 = 1.6059e-04
Loss = 8.9019e-04, PNorm = 47.5279, GNorm = 1.4520, lr_0 = 1.5539e-04
Validation rmse = 0.753238
Epoch 24
Loss = 1.1501e-03, PNorm = 47.5357, GNorm = 1.9348, lr_0 = 1.5036e-04
Loss = 1.0778e-03, PNorm = 47.5429, GNorm = 2.7327, lr_0 = 1.4550e-04
Loss = 1.1350e-03, PNorm = 47.5503, GNorm = 3.1794, lr_0 = 1.4079e-04
Validation rmse = 0.771229
Epoch 25
Loss = 8.2578e-04, PNorm = 47.5578, GNorm = 1.2769, lr_0 = 1.3623e-04
Loss = 9.5295e-04, PNorm = 47.5641, GNorm = 2.2310, lr_0 = 1.3183e-04
Loss = 1.0227e-03, PNorm = 47.5704, GNorm = 1.6264, lr_0 = 1.2756e-04
Validation rmse = 0.717461
Epoch 26
Loss = 8.9412e-04, PNorm = 47.5776, GNorm = 0.8140, lr_0 = 1.2343e-04
Loss = 8.2965e-04, PNorm = 47.5830, GNorm = 1.0808, lr_0 = 1.1944e-04
Validation rmse = 0.737938
Epoch 27
Loss = 1.0532e-03, PNorm = 47.5887, GNorm = 2.1743, lr_0 = 1.1557e-04
Loss = 8.5032e-04, PNorm = 47.5952, GNorm = 0.5217, lr_0 = 1.1183e-04
Loss = 8.0956e-04, PNorm = 47.6003, GNorm = 0.4527, lr_0 = 1.0821e-04
Validation rmse = 0.724020
Epoch 28
Loss = 8.6476e-04, PNorm = 47.6058, GNorm = 1.4284, lr_0 = 1.0437e-04
Loss = 7.9802e-04, PNorm = 47.6105, GNorm = 0.4533, lr_0 = 1.0099e-04
Validation rmse = 0.763035
Epoch 29
Loss = 8.9648e-04, PNorm = 47.6158, GNorm = 2.1604, lr_0 = 1.0000e-04
Loss = 8.9463e-04, PNorm = 47.6216, GNorm = 0.7908, lr_0 = 1.0000e-04
Loss = 7.6628e-04, PNorm = 47.6259, GNorm = 0.5454, lr_0 = 1.0000e-04
Validation rmse = 0.720304
Model 0 best validation rmse = 0.716267 on epoch 19
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test rmse = 0.755943
Ensemble test rmse = 0.755943
10-fold cross validation
	Seed 0 ==> test rmse = 0.768308
	Seed 1 ==> test rmse = 0.696907
	Seed 2 ==> test rmse = 0.658745
	Seed 3 ==> test rmse = 0.894170
	Seed 4 ==> test rmse = 1.056610
	Seed 5 ==> test rmse = 0.673163
	Seed 6 ==> test rmse = 0.746598
	Seed 7 ==> test rmse = 0.705750
	Seed 8 ==> test rmse = 0.730933
	Seed 9 ==> test rmse = 0.755943
Overall test rmse = 0.768713 +/- 0.114476
Elapsed time = 0:08:15
Fold 0
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_0',
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.6796e-02, PNorm = 65.0286, GNorm = 9.0341, lr_0 = 2.9800e-04
Loss = 1.3104e-02, PNorm = 65.0752, GNorm = 3.2914, lr_0 = 4.7800e-04
Validation rmse = 1.648737
Epoch 1
Loss = 8.7812e-03, PNorm = 65.1500, GNorm = 4.6956, lr_0 = 6.7600e-04
Loss = 8.2752e-03, PNorm = 65.2400, GNorm = 7.8968, lr_0 = 8.5600e-04
Loss = 8.5346e-03, PNorm = 65.3515, GNorm = 1.7634, lr_0 = 9.9344e-04
Validation rmse = 1.299464
Epoch 2
Loss = 7.8983e-03, PNorm = 65.4734, GNorm = 2.6336, lr_0 = 9.6130e-04
Loss = 5.9847e-03, PNorm = 65.5715, GNorm = 1.5169, lr_0 = 9.3019e-04
Validation rmse = 1.228157
Epoch 3
Loss = 5.1821e-03, PNorm = 65.6625, GNorm = 1.8567, lr_0 = 9.0009e-04
Loss = 4.3346e-03, PNorm = 65.7513, GNorm = 0.8090, lr_0 = 8.7096e-04
Loss = 4.7518e-03, PNorm = 65.8222, GNorm = 4.1643, lr_0 = 8.4278e-04
Validation rmse = 1.135552
Epoch 4
Loss = 3.6934e-03, PNorm = 65.8914, GNorm = 0.6875, lr_0 = 8.1551e-04
Loss = 4.3633e-03, PNorm = 65.9448, GNorm = 3.8868, lr_0 = 7.8912e-04
Validation rmse = 1.413472
Epoch 5
Loss = 7.2466e-03, PNorm = 66.0002, GNorm = 5.0446, lr_0 = 7.6358e-04
Loss = 4.6733e-03, PNorm = 66.0600, GNorm = 2.0303, lr_0 = 7.3888e-04
Loss = 3.9494e-03, PNorm = 66.1161, GNorm = 2.1931, lr_0 = 7.1497e-04
Validation rmse = 0.962626
Epoch 6
Loss = 2.9934e-03, PNorm = 66.1718, GNorm = 0.8495, lr_0 = 6.8956e-04
Loss = 3.4236e-03, PNorm = 66.2145, GNorm = 0.7045, lr_0 = 6.6725e-04
Loss = 2.8181e-03, PNorm = 66.2461, GNorm = 2.0391, lr_0 = 6.4565e-04
Validation rmse = 0.976233
Epoch 7
Loss = 2.3782e-03, PNorm = 66.2856, GNorm = 1.2108, lr_0 = 6.2476e-04
Loss = 2.4376e-03, PNorm = 66.3199, GNorm = 1.1131, lr_0 = 6.0454e-04
Validation rmse = 0.894881
Epoch 8
Loss = 2.1477e-03, PNorm = 66.3502, GNorm = 0.7140, lr_0 = 5.8498e-04
Loss = 2.5396e-03, PNorm = 66.3789, GNorm = 1.5626, lr_0 = 5.6605e-04
Loss = 2.0162e-03, PNorm = 66.4171, GNorm = 2.1894, lr_0 = 5.4774e-04
Validation rmse = 0.936461
Epoch 9
Loss = 1.9487e-03, PNorm = 66.4518, GNorm = 1.5850, lr_0 = 5.3001e-04
Loss = 2.0870e-03, PNorm = 66.4784, GNorm = 1.7820, lr_0 = 5.1286e-04
Validation rmse = 0.858755
Epoch 10
Loss = 2.0369e-03, PNorm = 66.5064, GNorm = 1.6802, lr_0 = 4.9627e-04
Loss = 2.1091e-03, PNorm = 66.5444, GNorm = 1.7838, lr_0 = 4.8021e-04
Loss = 1.8634e-03, PNorm = 66.5754, GNorm = 1.9770, lr_0 = 4.6467e-04
Validation rmse = 0.882422
Epoch 11
Loss = 1.7453e-03, PNorm = 66.5928, GNorm = 0.7715, lr_0 = 4.4963e-04
Loss = 1.5171e-03, PNorm = 66.6208, GNorm = 0.5720, lr_0 = 4.3508e-04
Validation rmse = 0.880178
Epoch 12
Loss = 1.7614e-03, PNorm = 66.6514, GNorm = 1.1706, lr_0 = 4.1962e-04
Loss = 1.7992e-03, PNorm = 66.6720, GNorm = 1.2679, lr_0 = 4.0604e-04
Loss = 1.7375e-03, PNorm = 66.6983, GNorm = 2.5705, lr_0 = 3.9290e-04
Validation rmse = 0.803367
Epoch 13
Loss = 1.6496e-03, PNorm = 66.7235, GNorm = 2.0936, lr_0 = 3.8019e-04
Loss = 1.6259e-03, PNorm = 66.7476, GNorm = 1.2734, lr_0 = 3.6789e-04
Loss = 1.4870e-03, PNorm = 66.7686, GNorm = 1.2148, lr_0 = 3.5598e-04
Validation rmse = 0.830383
Epoch 14
Loss = 1.4478e-03, PNorm = 66.7873, GNorm = 1.2605, lr_0 = 3.4446e-04
Loss = 1.1826e-03, PNorm = 66.8056, GNorm = 1.8652, lr_0 = 3.3332e-04
Validation rmse = 0.821796
Epoch 15
Loss = 1.4056e-03, PNorm = 66.8246, GNorm = 2.1940, lr_0 = 3.2253e-04
Loss = 1.5647e-03, PNorm = 66.8410, GNorm = 1.8712, lr_0 = 3.1209e-04
Loss = 1.6899e-03, PNorm = 66.8635, GNorm = 2.8280, lr_0 = 3.0200e-04
Validation rmse = 0.829350
Epoch 16
Loss = 1.2105e-03, PNorm = 66.8830, GNorm = 0.6003, lr_0 = 2.9222e-04
Loss = 1.3229e-03, PNorm = 66.8987, GNorm = 1.9274, lr_0 = 2.8277e-04
Validation rmse = 0.809200
Epoch 17
Loss = 1.3467e-03, PNorm = 66.9129, GNorm = 0.5798, lr_0 = 2.7272e-04
Loss = 1.2638e-03, PNorm = 66.9286, GNorm = 1.5982, lr_0 = 2.6389e-04
Loss = 1.2837e-03, PNorm = 66.9469, GNorm = 1.4919, lr_0 = 2.5535e-04
Validation rmse = 0.799748
Epoch 18
Loss = 1.1870e-03, PNorm = 66.9597, GNorm = 0.4258, lr_0 = 2.4709e-04
Loss = 1.0564e-03, PNorm = 66.9714, GNorm = 2.2136, lr_0 = 2.3910e-04
Loss = 1.1370e-03, PNorm = 66.9855, GNorm = 0.5394, lr_0 = 2.3136e-04
Validation rmse = 0.764183
Epoch 19
Loss = 1.0571e-03, PNorm = 67.0026, GNorm = 0.4083, lr_0 = 2.2387e-04
Loss = 1.1508e-03, PNorm = 67.0146, GNorm = 2.2276, lr_0 = 2.1663e-04
Validation rmse = 0.786048
Epoch 20
Loss = 8.3514e-04, PNorm = 67.0277, GNorm = 1.2654, lr_0 = 2.0962e-04
Loss = 1.0511e-03, PNorm = 67.0382, GNorm = 0.5025, lr_0 = 2.0283e-04
Loss = 9.8884e-04, PNorm = 67.0503, GNorm = 0.3942, lr_0 = 1.9627e-04
Validation rmse = 0.803580
Epoch 21
Loss = 9.7332e-04, PNorm = 67.0613, GNorm = 1.5798, lr_0 = 1.8992e-04
Loss = 9.4345e-04, PNorm = 67.0701, GNorm = 0.7461, lr_0 = 1.8377e-04
Validation rmse = 0.777675
Epoch 22
Loss = 9.2200e-04, PNorm = 67.0822, GNorm = 0.4955, lr_0 = 1.7783e-04
Loss = 9.4817e-04, PNorm = 67.0910, GNorm = 1.1203, lr_0 = 1.7207e-04
Loss = 9.7692e-04, PNorm = 67.0994, GNorm = 0.5962, lr_0 = 1.6651e-04
Validation rmse = 0.809118
Epoch 23
Loss = 8.9822e-04, PNorm = 67.1094, GNorm = 0.9458, lr_0 = 1.6059e-04
Loss = 1.0555e-03, PNorm = 67.1188, GNorm = 1.7458, lr_0 = 1.5539e-04
Validation rmse = 0.772158
Epoch 24
Loss = 9.3856e-04, PNorm = 67.1280, GNorm = 0.9462, lr_0 = 1.5036e-04
Loss = 9.0368e-04, PNorm = 67.1354, GNorm = 1.1047, lr_0 = 1.4550e-04
Loss = 9.7508e-04, PNorm = 67.1428, GNorm = 0.5613, lr_0 = 1.4079e-04
Validation rmse = 0.795961
Epoch 25
Loss = 7.7718e-04, PNorm = 67.1514, GNorm = 0.4396, lr_0 = 1.3623e-04
Loss = 9.4976e-04, PNorm = 67.1587, GNorm = 0.5661, lr_0 = 1.3183e-04
Loss = 9.4014e-04, PNorm = 67.1659, GNorm = 0.7016, lr_0 = 1.2756e-04
Validation rmse = 0.812698
Epoch 26
Loss = 7.4492e-04, PNorm = 67.1734, GNorm = 0.8835, lr_0 = 1.2343e-04
Loss = 8.9654e-04, PNorm = 67.1788, GNorm = 0.4953, lr_0 = 1.1944e-04
Validation rmse = 0.772120
Epoch 27
Loss = 9.2717e-04, PNorm = 67.1863, GNorm = 0.7753, lr_0 = 1.1557e-04
Loss = 8.9937e-04, PNorm = 67.1931, GNorm = 1.1462, lr_0 = 1.1183e-04
Loss = 8.5742e-04, PNorm = 67.1989, GNorm = 0.5222, lr_0 = 1.0821e-04
Validation rmse = 0.782846
Epoch 28
Loss = 8.8237e-04, PNorm = 67.2062, GNorm = 0.4070, lr_0 = 1.0437e-04
Loss = 7.1741e-04, PNorm = 67.2128, GNorm = 0.4490, lr_0 = 1.0099e-04
Validation rmse = 0.791382
Epoch 29
Loss = 9.8745e-04, PNorm = 67.2175, GNorm = 1.2690, lr_0 = 1.0000e-04
Loss = 7.8204e-04, PNorm = 67.2236, GNorm = 0.6823, lr_0 = 1.0000e-04
Loss = 9.2518e-04, PNorm = 67.2290, GNorm = 2.3619, lr_0 = 1.0000e-04
Validation rmse = 0.789120
Model 0 best validation rmse = 0.764183 on epoch 18
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.784245
Ensemble test rmse = 0.784245
Fold 1
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_1',
 'save_smiles_splits': True,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.8787e-02, PNorm = 65.0280, GNorm = 6.9678, lr_0 = 2.9800e-04
Loss = 1.0667e-02, PNorm = 65.0739, GNorm = 12.0808, lr_0 = 4.7800e-04
Validation rmse = 1.803751
Epoch 1
Loss = 8.5085e-03, PNorm = 65.1408, GNorm = 3.2410, lr_0 = 6.7600e-04
Loss = 1.1151e-02, PNorm = 65.2290, GNorm = 2.8984, lr_0 = 8.5600e-04
Loss = 7.0968e-03, PNorm = 65.3344, GNorm = 0.6962, lr_0 = 9.9344e-04
Validation rmse = 1.468622
Epoch 2
Loss = 7.0382e-03, PNorm = 65.4404, GNorm = 6.1990, lr_0 = 9.6130e-04
Loss = 7.4657e-03, PNorm = 65.5403, GNorm = 1.2127, lr_0 = 9.3019e-04
Validation rmse = 1.296833
Epoch 3
Loss = 5.1187e-03, PNorm = 65.6313, GNorm = 2.3065, lr_0 = 9.0009e-04
Loss = 6.0545e-03, PNorm = 65.7144, GNorm = 1.6718, lr_0 = 8.7096e-04
Loss = 3.9585e-03, PNorm = 65.7903, GNorm = 2.2790, lr_0 = 8.4278e-04
Validation rmse = 0.979218
Epoch 4
Loss = 4.4357e-03, PNorm = 65.8538, GNorm = 2.1358, lr_0 = 8.1551e-04
Loss = 3.1152e-03, PNorm = 65.9193, GNorm = 1.7671, lr_0 = 7.8912e-04
Validation rmse = 0.882448
Epoch 5
Loss = 3.0942e-03, PNorm = 65.9695, GNorm = 2.0463, lr_0 = 7.6358e-04
Loss = 3.5099e-03, PNorm = 66.0190, GNorm = 3.0454, lr_0 = 7.3888e-04
Loss = 3.0356e-03, PNorm = 66.0647, GNorm = 1.5294, lr_0 = 7.1497e-04
Validation rmse = 1.226560
Epoch 6
Loss = 4.7802e-03, PNorm = 66.1111, GNorm = 2.4086, lr_0 = 6.8956e-04
Loss = 3.1634e-03, PNorm = 66.1570, GNorm = 2.1705, lr_0 = 6.6725e-04
Loss = 2.7726e-03, PNorm = 66.1971, GNorm = 1.7304, lr_0 = 6.4565e-04
Validation rmse = 0.849454
Epoch 7
Loss = 2.9002e-03, PNorm = 66.2357, GNorm = 2.6221, lr_0 = 6.2476e-04
Loss = 3.0283e-03, PNorm = 66.2711, GNorm = 6.7588, lr_0 = 6.0454e-04
Validation rmse = 1.105580
Epoch 8
Loss = 4.2154e-03, PNorm = 66.3168, GNorm = 4.7702, lr_0 = 5.8498e-04
Loss = 2.8754e-03, PNorm = 66.3616, GNorm = 0.8623, lr_0 = 5.6605e-04
Loss = 2.5755e-03, PNorm = 66.3968, GNorm = 2.9015, lr_0 = 5.4774e-04
Validation rmse = 0.833595
Epoch 9
Loss = 2.0359e-03, PNorm = 66.4274, GNorm = 1.2136, lr_0 = 5.3001e-04
Loss = 2.3642e-03, PNorm = 66.4611, GNorm = 0.9918, lr_0 = 5.1286e-04
Validation rmse = 0.850836
Epoch 10
Loss = 2.4215e-03, PNorm = 66.4854, GNorm = 3.6295, lr_0 = 4.9627e-04
Loss = 3.1795e-03, PNorm = 66.5146, GNorm = 3.4505, lr_0 = 4.8021e-04
Loss = 2.2853e-03, PNorm = 66.5464, GNorm = 1.7038, lr_0 = 4.6467e-04
Validation rmse = 0.873561
Epoch 11
Loss = 2.4591e-03, PNorm = 66.5788, GNorm = 1.0958, lr_0 = 4.4963e-04
Loss = 2.4338e-03, PNorm = 66.6046, GNorm = 0.8701, lr_0 = 4.3508e-04
Validation rmse = 0.782268
Epoch 12
Loss = 2.5084e-03, PNorm = 66.6357, GNorm = 1.7770, lr_0 = 4.1962e-04
Loss = 1.9645e-03, PNorm = 66.6636, GNorm = 1.5098, lr_0 = 4.0604e-04
Loss = 2.2568e-03, PNorm = 66.6894, GNorm = 0.9815, lr_0 = 3.9290e-04
Validation rmse = 0.944719
Epoch 13
Loss = 2.1844e-03, PNorm = 66.7140, GNorm = 1.2570, lr_0 = 3.8019e-04
Loss = 2.5849e-03, PNorm = 66.7357, GNorm = 2.3949, lr_0 = 3.6789e-04
Loss = 2.0041e-03, PNorm = 66.7530, GNorm = 0.7980, lr_0 = 3.5598e-04
Validation rmse = 0.712269
Epoch 14
Loss = 1.6223e-03, PNorm = 66.7739, GNorm = 0.6510, lr_0 = 3.4446e-04
Loss = 1.6022e-03, PNorm = 66.7915, GNorm = 2.0303, lr_0 = 3.3332e-04
Validation rmse = 0.767774
Epoch 15
Loss = 1.4052e-03, PNorm = 66.8106, GNorm = 0.5235, lr_0 = 3.2253e-04
Loss = 1.7246e-03, PNorm = 66.8260, GNorm = 2.5214, lr_0 = 3.1209e-04
Loss = 2.1142e-03, PNorm = 66.8464, GNorm = 1.1426, lr_0 = 3.0200e-04
Validation rmse = 0.750157
Epoch 16
Loss = 2.0393e-03, PNorm = 66.8658, GNorm = 1.0957, lr_0 = 2.9222e-04
Loss = 1.3390e-03, PNorm = 66.8829, GNorm = 0.6211, lr_0 = 2.8277e-04
Validation rmse = 0.675916
Epoch 17
Loss = 1.1567e-03, PNorm = 66.8994, GNorm = 0.3971, lr_0 = 2.7272e-04
Loss = 1.4842e-03, PNorm = 66.9157, GNorm = 0.4996, lr_0 = 2.6389e-04
Loss = 1.3708e-03, PNorm = 66.9310, GNorm = 1.5617, lr_0 = 2.5535e-04
Validation rmse = 0.695408
Epoch 18
Loss = 1.3894e-03, PNorm = 66.9446, GNorm = 0.6852, lr_0 = 2.4709e-04
Loss = 1.3847e-03, PNorm = 66.9603, GNorm = 0.7805, lr_0 = 2.3910e-04
Loss = 1.3379e-03, PNorm = 66.9758, GNorm = 1.0405, lr_0 = 2.3136e-04
Validation rmse = 0.681063
Epoch 19
Loss = 1.2730e-03, PNorm = 66.9866, GNorm = 1.6803, lr_0 = 2.2387e-04
Loss = 1.2943e-03, PNorm = 67.0007, GNorm = 0.5778, lr_0 = 2.1663e-04
Validation rmse = 0.676344
Epoch 20
Loss = 1.0333e-03, PNorm = 67.0159, GNorm = 0.5618, lr_0 = 2.0962e-04
Loss = 1.5270e-03, PNorm = 67.0314, GNorm = 0.9898, lr_0 = 2.0283e-04
Loss = 1.2112e-03, PNorm = 67.0431, GNorm = 0.6291, lr_0 = 1.9627e-04
Validation rmse = 0.708401
Epoch 21
Loss = 1.1413e-03, PNorm = 67.0547, GNorm = 0.4972, lr_0 = 1.8992e-04
Loss = 1.2653e-03, PNorm = 67.0672, GNorm = 1.8301, lr_0 = 1.8377e-04
Validation rmse = 0.655040
Epoch 22
Loss = 9.9364e-04, PNorm = 67.0779, GNorm = 1.3875, lr_0 = 1.7783e-04
Loss = 1.0918e-03, PNorm = 67.0861, GNorm = 0.5470, lr_0 = 1.7207e-04
Loss = 1.2747e-03, PNorm = 67.0960, GNorm = 1.4436, lr_0 = 1.6651e-04
Validation rmse = 0.660553
Epoch 23
Loss = 9.5059e-04, PNorm = 67.1085, GNorm = 1.2568, lr_0 = 1.6059e-04
Loss = 1.1466e-03, PNorm = 67.1198, GNorm = 1.2239, lr_0 = 1.5539e-04
Validation rmse = 0.725806
Epoch 24
Loss = 1.1809e-03, PNorm = 67.1282, GNorm = 1.5957, lr_0 = 1.5036e-04
Loss = 1.3710e-03, PNorm = 67.1373, GNorm = 1.6998, lr_0 = 1.4550e-04
Loss = 1.2357e-03, PNorm = 67.1496, GNorm = 1.5300, lr_0 = 1.4079e-04
Validation rmse = 0.719202
Epoch 25
Loss = 1.0159e-03, PNorm = 67.1596, GNorm = 0.4257, lr_0 = 1.3623e-04
Loss = 1.1670e-03, PNorm = 67.1693, GNorm = 1.0945, lr_0 = 1.3183e-04
Loss = 1.2698e-03, PNorm = 67.1787, GNorm = 0.4982, lr_0 = 1.2756e-04
Validation rmse = 0.655816
Epoch 26
Loss = 1.1098e-03, PNorm = 67.1855, GNorm = 0.6633, lr_0 = 1.2343e-04
Loss = 1.0952e-03, PNorm = 67.1951, GNorm = 1.0670, lr_0 = 1.1944e-04
Validation rmse = 0.645061
Epoch 27
Loss = 1.0997e-03, PNorm = 67.2018, GNorm = 0.5049, lr_0 = 1.1557e-04
Loss = 9.6721e-04, PNorm = 67.2094, GNorm = 1.8366, lr_0 = 1.1183e-04
Loss = 1.1433e-03, PNorm = 67.2174, GNorm = 0.3070, lr_0 = 1.0821e-04
Validation rmse = 0.658366
Epoch 28
Loss = 1.1490e-03, PNorm = 67.2258, GNorm = 0.8556, lr_0 = 1.0437e-04
Loss = 9.2978e-04, PNorm = 67.2325, GNorm = 0.6269, lr_0 = 1.0099e-04
Validation rmse = 0.654881
Epoch 29
Loss = 9.8947e-04, PNorm = 67.2393, GNorm = 1.2297, lr_0 = 1.0000e-04
Loss = 1.0329e-03, PNorm = 67.2457, GNorm = 1.1351, lr_0 = 1.0000e-04
Loss = 1.0095e-03, PNorm = 67.2527, GNorm = 0.6496, lr_0 = 1.0000e-04
Validation rmse = 0.656244
Model 0 best validation rmse = 0.645061 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.680039
Ensemble test rmse = 0.680039
Fold 2
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_2',
 'save_smiles_splits': True,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.9799e-02, PNorm = 65.0262, GNorm = 2.3703, lr_0 = 2.9800e-04
Loss = 1.4467e-02, PNorm = 65.0718, GNorm = 6.5133, lr_0 = 4.7800e-04
Validation rmse = 1.374839
Epoch 1
Loss = 8.8153e-03, PNorm = 65.1587, GNorm = 6.4513, lr_0 = 6.7600e-04
Loss = 7.9238e-03, PNorm = 65.2384, GNorm = 2.9269, lr_0 = 8.5600e-04
Loss = 9.1247e-03, PNorm = 65.3544, GNorm = 4.8299, lr_0 = 9.9344e-04
Validation rmse = 1.547061
Epoch 2
Loss = 7.7423e-03, PNorm = 65.4831, GNorm = 3.7423, lr_0 = 9.6130e-04
Loss = 6.4854e-03, PNorm = 65.5938, GNorm = 1.8871, lr_0 = 9.3019e-04
Validation rmse = 0.981145
Epoch 3
Loss = 4.5867e-03, PNorm = 65.6924, GNorm = 0.6363, lr_0 = 9.0009e-04
Loss = 3.9750e-03, PNorm = 65.7771, GNorm = 2.2907, lr_0 = 8.7096e-04
Loss = 4.1127e-03, PNorm = 65.8462, GNorm = 1.4758, lr_0 = 8.4278e-04
Validation rmse = 0.932015
Epoch 4
Loss = 4.5483e-03, PNorm = 65.9175, GNorm = 2.9889, lr_0 = 8.1551e-04
Loss = 4.8438e-03, PNorm = 65.9850, GNorm = 3.4584, lr_0 = 7.8912e-04
Validation rmse = 0.850569
Epoch 5
Loss = 2.9846e-03, PNorm = 66.0414, GNorm = 0.5056, lr_0 = 7.6358e-04
Loss = 3.9337e-03, PNorm = 66.1013, GNorm = 1.2210, lr_0 = 7.3888e-04
Loss = 3.3103e-03, PNorm = 66.1637, GNorm = 0.8119, lr_0 = 7.1497e-04
Validation rmse = 0.794986
Epoch 6
Loss = 3.4354e-03, PNorm = 66.2133, GNorm = 2.1060, lr_0 = 6.8956e-04
Loss = 2.8438e-03, PNorm = 66.2562, GNorm = 0.8192, lr_0 = 6.6725e-04
Loss = 3.3520e-03, PNorm = 66.3019, GNorm = 0.9895, lr_0 = 6.4565e-04
Validation rmse = 0.833015
Epoch 7
Loss = 2.7703e-03, PNorm = 66.3412, GNorm = 2.8627, lr_0 = 6.2476e-04
Loss = 2.4503e-03, PNorm = 66.3803, GNorm = 1.0457, lr_0 = 6.0454e-04
Validation rmse = 0.753990
Epoch 8
Loss = 2.4150e-03, PNorm = 66.4179, GNorm = 0.5499, lr_0 = 5.8498e-04
Loss = 2.1074e-03, PNorm = 66.4503, GNorm = 0.4781, lr_0 = 5.6605e-04
Loss = 2.3975e-03, PNorm = 66.4856, GNorm = 1.6279, lr_0 = 5.4774e-04
Validation rmse = 0.747285
Epoch 9
Loss = 2.5512e-03, PNorm = 66.5240, GNorm = 0.8064, lr_0 = 5.3001e-04
Loss = 2.5535e-03, PNorm = 66.5533, GNorm = 1.8146, lr_0 = 5.1286e-04
Validation rmse = 0.767130
Epoch 10
Loss = 2.0509e-03, PNorm = 66.5813, GNorm = 2.0138, lr_0 = 4.9627e-04
Loss = 2.0216e-03, PNorm = 66.6074, GNorm = 0.4574, lr_0 = 4.8021e-04
Loss = 2.3911e-03, PNorm = 66.6444, GNorm = 2.5030, lr_0 = 4.6467e-04
Validation rmse = 0.713444
Epoch 11
Loss = 1.9430e-03, PNorm = 66.6680, GNorm = 1.9741, lr_0 = 4.4963e-04
Loss = 1.9258e-03, PNorm = 66.6975, GNorm = 1.0027, lr_0 = 4.3508e-04
Validation rmse = 0.710441
Epoch 12
Loss = 1.1383e-03, PNorm = 66.7219, GNorm = 0.8586, lr_0 = 4.1962e-04
Loss = 1.9216e-03, PNorm = 66.7417, GNorm = 2.4567, lr_0 = 4.0604e-04
Loss = 1.5273e-03, PNorm = 66.7662, GNorm = 0.4949, lr_0 = 3.9290e-04
Validation rmse = 0.693466
Epoch 13
Loss = 1.5605e-03, PNorm = 66.7902, GNorm = 0.5810, lr_0 = 3.8019e-04
Loss = 1.7026e-03, PNorm = 66.8141, GNorm = 4.0466, lr_0 = 3.6789e-04
Loss = 2.3749e-03, PNorm = 66.8385, GNorm = 2.3742, lr_0 = 3.5598e-04
Validation rmse = 0.777321
Epoch 14
Loss = 1.6872e-03, PNorm = 66.8585, GNorm = 0.3925, lr_0 = 3.4446e-04
Loss = 1.6636e-03, PNorm = 66.8823, GNorm = 0.9490, lr_0 = 3.3332e-04
Validation rmse = 0.809027
Epoch 15
Loss = 1.9087e-03, PNorm = 66.8978, GNorm = 0.5084, lr_0 = 3.2253e-04
Loss = 1.4348e-03, PNorm = 66.9121, GNorm = 0.3601, lr_0 = 3.1209e-04
Loss = 2.0518e-03, PNorm = 66.9328, GNorm = 2.4895, lr_0 = 3.0200e-04
Validation rmse = 0.689530
Epoch 16
Loss = 1.5589e-03, PNorm = 66.9501, GNorm = 1.7886, lr_0 = 2.9222e-04
Loss = 1.4906e-03, PNorm = 66.9675, GNorm = 0.9276, lr_0 = 2.8277e-04
Validation rmse = 0.681771
Epoch 17
Loss = 1.3246e-03, PNorm = 66.9875, GNorm = 2.9224, lr_0 = 2.7272e-04
Loss = 1.2234e-03, PNorm = 67.0049, GNorm = 0.4079, lr_0 = 2.6389e-04
Loss = 1.4696e-03, PNorm = 67.0210, GNorm = 2.3767, lr_0 = 2.5535e-04
Validation rmse = 0.693565
Epoch 18
Loss = 1.4126e-03, PNorm = 67.0341, GNorm = 0.5941, lr_0 = 2.4709e-04
Loss = 1.4030e-03, PNorm = 67.0494, GNorm = 0.7324, lr_0 = 2.3910e-04
Loss = 1.2949e-03, PNorm = 67.0605, GNorm = 0.7997, lr_0 = 2.3136e-04
Validation rmse = 0.678694
Epoch 19
Loss = 1.4565e-03, PNorm = 67.0738, GNorm = 1.2867, lr_0 = 2.2387e-04
Loss = 1.2549e-03, PNorm = 67.0852, GNorm = 1.0318, lr_0 = 2.1663e-04
Validation rmse = 0.687870
Epoch 20
Loss = 1.2730e-03, PNorm = 67.0983, GNorm = 1.7215, lr_0 = 2.0962e-04
Loss = 1.0673e-03, PNorm = 67.1119, GNorm = 0.5489, lr_0 = 2.0283e-04
Loss = 1.1267e-03, PNorm = 67.1215, GNorm = 0.3839, lr_0 = 1.9627e-04
Validation rmse = 0.685645
Epoch 21
Loss = 1.1408e-03, PNorm = 67.1308, GNorm = 0.6117, lr_0 = 1.8992e-04
Loss = 1.2250e-03, PNorm = 67.1419, GNorm = 1.4318, lr_0 = 1.8377e-04
Validation rmse = 0.687594
Epoch 22
Loss = 9.2477e-04, PNorm = 67.1522, GNorm = 1.3175, lr_0 = 1.7783e-04
Loss = 1.2773e-03, PNorm = 67.1643, GNorm = 0.4859, lr_0 = 1.7207e-04
Loss = 1.1167e-03, PNorm = 67.1750, GNorm = 0.4758, lr_0 = 1.6651e-04
Validation rmse = 0.668568
Epoch 23
Loss = 1.0902e-03, PNorm = 67.1864, GNorm = 0.5728, lr_0 = 1.6059e-04
Loss = 1.1267e-03, PNorm = 67.1943, GNorm = 1.0911, lr_0 = 1.5539e-04
Validation rmse = 0.681236
Epoch 24
Loss = 1.3298e-03, PNorm = 67.2022, GNorm = 1.2654, lr_0 = 1.5036e-04
Loss = 1.0128e-03, PNorm = 67.2115, GNorm = 0.5051, lr_0 = 1.4550e-04
Loss = 1.0012e-03, PNorm = 67.2200, GNorm = 2.1921, lr_0 = 1.4079e-04
Validation rmse = 0.666671
Epoch 25
Loss = 1.1492e-03, PNorm = 67.2276, GNorm = 2.6841, lr_0 = 1.3623e-04
Loss = 1.0807e-03, PNorm = 67.2377, GNorm = 0.6869, lr_0 = 1.3183e-04
Loss = 9.9536e-04, PNorm = 67.2449, GNorm = 0.8826, lr_0 = 1.2756e-04
Validation rmse = 0.670339
Epoch 26
Loss = 8.9941e-04, PNorm = 67.2540, GNorm = 1.5972, lr_0 = 1.2343e-04
Loss = 9.7494e-04, PNorm = 67.2600, GNorm = 0.3421, lr_0 = 1.1944e-04
Validation rmse = 0.671198
Epoch 27
Loss = 1.0714e-03, PNorm = 67.2671, GNorm = 0.5589, lr_0 = 1.1557e-04
Loss = 1.0581e-03, PNorm = 67.2750, GNorm = 0.5340, lr_0 = 1.1183e-04
Loss = 8.7450e-04, PNorm = 67.2821, GNorm = 1.0540, lr_0 = 1.0821e-04
Validation rmse = 0.685640
Epoch 28
Loss = 9.2248e-04, PNorm = 67.2883, GNorm = 0.4323, lr_0 = 1.0437e-04
Loss = 9.8887e-04, PNorm = 67.2934, GNorm = 0.8308, lr_0 = 1.0099e-04
Validation rmse = 0.674639
Epoch 29
Loss = 1.1448e-03, PNorm = 67.2997, GNorm = 0.7643, lr_0 = 1.0000e-04
Loss = 9.2694e-04, PNorm = 67.3061, GNorm = 1.6634, lr_0 = 1.0000e-04
Loss = 8.0804e-04, PNorm = 67.3111, GNorm = 0.3413, lr_0 = 1.0000e-04
Validation rmse = 0.673485
Model 0 best validation rmse = 0.666671 on epoch 24
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.684674
Ensemble test rmse = 0.684674
Fold 3
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_3',
 'save_smiles_splits': True,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.8275e-02, PNorm = 65.0269, GNorm = 5.2131, lr_0 = 2.9800e-04
Loss = 1.0732e-02, PNorm = 65.0771, GNorm = 4.1674, lr_0 = 4.7800e-04
Validation rmse = 1.542571
Epoch 1
Loss = 1.1245e-02, PNorm = 65.1486, GNorm = 6.1713, lr_0 = 6.7600e-04
Loss = 9.6703e-03, PNorm = 65.2465, GNorm = 1.3734, lr_0 = 8.5600e-04
Loss = 7.5293e-03, PNorm = 65.3648, GNorm = 2.7308, lr_0 = 9.9344e-04
Validation rmse = 1.475447
Epoch 2
Loss = 8.3763e-03, PNorm = 65.4846, GNorm = 1.4227, lr_0 = 9.6130e-04
Loss = 5.2440e-03, PNorm = 65.5908, GNorm = 1.3840, lr_0 = 9.3019e-04
Validation rmse = 1.096334
Epoch 3
Loss = 4.3594e-03, PNorm = 65.6768, GNorm = 1.7271, lr_0 = 9.0009e-04
Loss = 4.4483e-03, PNorm = 65.7686, GNorm = 2.0379, lr_0 = 8.7096e-04
Loss = 5.1717e-03, PNorm = 65.8443, GNorm = 3.6703, lr_0 = 8.4278e-04
Validation rmse = 0.983074
Epoch 4
Loss = 4.0526e-03, PNorm = 65.9036, GNorm = 4.7379, lr_0 = 8.1551e-04
Loss = 4.0432e-03, PNorm = 65.9680, GNorm = 1.8494, lr_0 = 7.8912e-04
Validation rmse = 0.974214
Epoch 5
Loss = 3.9294e-03, PNorm = 66.0210, GNorm = 2.4351, lr_0 = 7.6358e-04
Loss = 2.8188e-03, PNorm = 66.0697, GNorm = 0.7499, lr_0 = 7.3888e-04
Loss = 3.3568e-03, PNorm = 66.1137, GNorm = 2.0377, lr_0 = 7.1497e-04
Validation rmse = 0.923683
Epoch 6
Loss = 3.0706e-03, PNorm = 66.1667, GNorm = 1.9067, lr_0 = 6.8956e-04
Loss = 3.2555e-03, PNorm = 66.2086, GNorm = 0.9756, lr_0 = 6.6725e-04
Loss = 3.0367e-03, PNorm = 66.2461, GNorm = 2.9169, lr_0 = 6.4565e-04
Validation rmse = 1.004690
Epoch 7
Loss = 2.8201e-03, PNorm = 66.2846, GNorm = 2.6495, lr_0 = 6.2476e-04
Loss = 3.1025e-03, PNorm = 66.3205, GNorm = 1.4690, lr_0 = 6.0454e-04
Validation rmse = 0.785530
Epoch 8
Loss = 2.1563e-03, PNorm = 66.3553, GNorm = 1.4120, lr_0 = 5.8498e-04
Loss = 2.3439e-03, PNorm = 66.3915, GNorm = 2.4422, lr_0 = 5.6605e-04
Loss = 2.0591e-03, PNorm = 66.4261, GNorm = 1.1908, lr_0 = 5.4774e-04
Validation rmse = 0.755332
Epoch 9
Loss = 1.9795e-03, PNorm = 66.4527, GNorm = 0.5754, lr_0 = 5.3001e-04
Loss = 2.1336e-03, PNorm = 66.4851, GNorm = 1.3117, lr_0 = 5.1286e-04
Validation rmse = 0.747283
Epoch 10
Loss = 1.1999e-03, PNorm = 66.5134, GNorm = 1.2370, lr_0 = 4.9627e-04
Loss = 1.7640e-03, PNorm = 66.5401, GNorm = 0.6456, lr_0 = 4.8021e-04
Loss = 2.0568e-03, PNorm = 66.5695, GNorm = 1.6428, lr_0 = 4.6467e-04
Validation rmse = 0.713742
Epoch 11
Loss = 1.4930e-03, PNorm = 66.5911, GNorm = 0.5479, lr_0 = 4.4963e-04
Loss = 2.0810e-03, PNorm = 66.6153, GNorm = 1.9820, lr_0 = 4.3508e-04
Validation rmse = 0.710204
Epoch 12
Loss = 2.0242e-03, PNorm = 66.6401, GNorm = 1.0382, lr_0 = 4.1962e-04
Loss = 1.8704e-03, PNorm = 66.6604, GNorm = 1.8438, lr_0 = 4.0604e-04
Loss = 1.6290e-03, PNorm = 66.6851, GNorm = 1.2004, lr_0 = 3.9290e-04
Validation rmse = 0.731340
Epoch 13
Loss = 1.9873e-03, PNorm = 66.7077, GNorm = 0.7609, lr_0 = 3.8019e-04
Loss = 1.8599e-03, PNorm = 66.7254, GNorm = 0.5523, lr_0 = 3.6789e-04
Loss = 1.7456e-03, PNorm = 66.7475, GNorm = 1.9766, lr_0 = 3.5598e-04
Validation rmse = 0.739560
Epoch 14
Loss = 1.7288e-03, PNorm = 66.7697, GNorm = 2.1312, lr_0 = 3.4446e-04
Loss = 1.5819e-03, PNorm = 66.7902, GNorm = 1.8240, lr_0 = 3.3332e-04
Validation rmse = 0.710901
Epoch 15
Loss = 1.3416e-03, PNorm = 66.8085, GNorm = 0.8349, lr_0 = 3.2253e-04
Loss = 1.6541e-03, PNorm = 66.8270, GNorm = 1.2409, lr_0 = 3.1209e-04
Loss = 1.6352e-03, PNorm = 66.8446, GNorm = 0.3699, lr_0 = 3.0200e-04
Validation rmse = 0.677421
Epoch 16
Loss = 1.5405e-03, PNorm = 66.8620, GNorm = 0.8059, lr_0 = 2.9222e-04
Loss = 1.4821e-03, PNorm = 66.8797, GNorm = 0.6991, lr_0 = 2.8277e-04
Validation rmse = 0.692230
Epoch 17
Loss = 1.3635e-03, PNorm = 66.8975, GNorm = 0.4470, lr_0 = 2.7272e-04
Loss = 1.2474e-03, PNorm = 66.9107, GNorm = 1.7891, lr_0 = 2.6389e-04
Loss = 1.3396e-03, PNorm = 66.9259, GNorm = 0.6417, lr_0 = 2.5535e-04
Validation rmse = 0.670200
Epoch 18
Loss = 1.2082e-03, PNorm = 66.9406, GNorm = 2.6807, lr_0 = 2.4709e-04
Loss = 1.5647e-03, PNorm = 66.9541, GNorm = 1.8734, lr_0 = 2.3910e-04
Loss = 1.2017e-03, PNorm = 66.9708, GNorm = 1.1759, lr_0 = 2.3136e-04
Validation rmse = 0.675350
Epoch 19
Loss = 1.3644e-03, PNorm = 66.9821, GNorm = 1.0738, lr_0 = 2.2387e-04
Loss = 1.1474e-03, PNorm = 66.9949, GNorm = 0.6435, lr_0 = 2.1663e-04
Validation rmse = 0.650204
Epoch 20
Loss = 1.2205e-03, PNorm = 67.0092, GNorm = 0.6427, lr_0 = 2.0962e-04
Loss = 1.3829e-03, PNorm = 67.0230, GNorm = 0.6032, lr_0 = 2.0283e-04
Loss = 1.4572e-03, PNorm = 67.0349, GNorm = 0.9503, lr_0 = 1.9627e-04
Validation rmse = 0.654731
Epoch 21
Loss = 1.2281e-03, PNorm = 67.0480, GNorm = 1.3159, lr_0 = 1.8992e-04
Loss = 1.4346e-03, PNorm = 67.0590, GNorm = 1.6224, lr_0 = 1.8377e-04
Validation rmse = 0.665747
Epoch 22
Loss = 1.5599e-03, PNorm = 67.0712, GNorm = 1.8457, lr_0 = 1.7783e-04
Loss = 1.1889e-03, PNorm = 67.0831, GNorm = 1.6243, lr_0 = 1.7207e-04
Loss = 9.5970e-04, PNorm = 67.0919, GNorm = 0.6567, lr_0 = 1.6651e-04
Validation rmse = 0.643351
Epoch 23
Loss = 1.1671e-03, PNorm = 67.1015, GNorm = 0.7160, lr_0 = 1.6059e-04
Loss = 9.6758e-04, PNorm = 67.1100, GNorm = 0.9612, lr_0 = 1.5539e-04
Validation rmse = 0.656331
Epoch 24
Loss = 9.9499e-04, PNorm = 67.1193, GNorm = 1.1104, lr_0 = 1.5036e-04
Loss = 9.4283e-04, PNorm = 67.1299, GNorm = 0.9243, lr_0 = 1.4550e-04
Loss = 9.7429e-04, PNorm = 67.1384, GNorm = 0.4503, lr_0 = 1.4079e-04
Validation rmse = 0.646738
Epoch 25
Loss = 1.0798e-03, PNorm = 67.1454, GNorm = 0.8353, lr_0 = 1.3623e-04
Loss = 1.0843e-03, PNorm = 67.1520, GNorm = 1.9011, lr_0 = 1.3183e-04
Loss = 1.2059e-03, PNorm = 67.1600, GNorm = 1.7418, lr_0 = 1.2756e-04
Validation rmse = 0.675603
Epoch 26
Loss = 1.1097e-03, PNorm = 67.1677, GNorm = 1.4942, lr_0 = 1.2343e-04
Loss = 1.0078e-03, PNorm = 67.1751, GNorm = 0.4871, lr_0 = 1.1944e-04
Validation rmse = 0.639127
Epoch 27
Loss = 7.9876e-04, PNorm = 67.1829, GNorm = 0.4506, lr_0 = 1.1557e-04
Loss = 9.7079e-04, PNorm = 67.1912, GNorm = 0.6521, lr_0 = 1.1183e-04
Loss = 9.3852e-04, PNorm = 67.1973, GNorm = 1.6392, lr_0 = 1.0821e-04
Validation rmse = 0.648134
Epoch 28
Loss = 9.0918e-04, PNorm = 67.2046, GNorm = 0.6375, lr_0 = 1.0437e-04
Loss = 1.0281e-03, PNorm = 67.2105, GNorm = 1.2755, lr_0 = 1.0099e-04
Validation rmse = 0.639689
Epoch 29
Loss = 6.3541e-04, PNorm = 67.2176, GNorm = 0.3976, lr_0 = 1.0000e-04
Loss = 8.1820e-04, PNorm = 67.2233, GNorm = 0.4154, lr_0 = 1.0000e-04
Loss = 9.7073e-04, PNorm = 67.2292, GNorm = 0.5820, lr_0 = 1.0000e-04
Validation rmse = 0.647544
Model 0 best validation rmse = 0.639127 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.840444
Ensemble test rmse = 0.840444
Fold 4
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_4',
 'save_smiles_splits': True,
 'seed': 4,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 4
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.7623e-02, PNorm = 65.0290, GNorm = 6.6415, lr_0 = 2.9800e-04
Loss = 1.1582e-02, PNorm = 65.0787, GNorm = 10.5360, lr_0 = 4.7800e-04
Validation rmse = 1.569156
Epoch 1
Loss = 8.6460e-03, PNorm = 65.1452, GNorm = 2.5995, lr_0 = 6.7600e-04
Loss = 7.8664e-03, PNorm = 65.2317, GNorm = 5.6299, lr_0 = 8.5600e-04
Loss = 8.1830e-03, PNorm = 65.3394, GNorm = 5.1843, lr_0 = 9.9344e-04
Validation rmse = 1.552947
Epoch 2
Loss = 6.5675e-03, PNorm = 65.4630, GNorm = 2.1000, lr_0 = 9.6130e-04
Loss = 6.4064e-03, PNorm = 65.5593, GNorm = 2.7493, lr_0 = 9.3019e-04
Validation rmse = 1.248757
Epoch 3
Loss = 5.1380e-03, PNorm = 65.6563, GNorm = 2.6367, lr_0 = 9.0009e-04
Loss = 4.6834e-03, PNorm = 65.7282, GNorm = 4.7839, lr_0 = 8.7096e-04
Loss = 3.4723e-03, PNorm = 65.8023, GNorm = 0.9024, lr_0 = 8.4278e-04
Validation rmse = 0.983107
Epoch 4
Loss = 3.1378e-03, PNorm = 65.8613, GNorm = 1.2793, lr_0 = 8.1551e-04
Loss = 3.1192e-03, PNorm = 65.9102, GNorm = 3.8565, lr_0 = 7.8912e-04
Validation rmse = 0.916576
Epoch 5
Loss = 3.0459e-03, PNorm = 65.9622, GNorm = 1.3477, lr_0 = 7.6358e-04
Loss = 3.6180e-03, PNorm = 66.0111, GNorm = 0.9983, lr_0 = 7.3888e-04
Loss = 5.2841e-03, PNorm = 66.0628, GNorm = 3.6943, lr_0 = 7.1497e-04
Validation rmse = 1.170657
Epoch 6
Loss = 2.9173e-03, PNorm = 66.1264, GNorm = 0.8352, lr_0 = 6.8956e-04
Loss = 3.9046e-03, PNorm = 66.1742, GNorm = 1.2286, lr_0 = 6.6725e-04
Loss = 3.0786e-03, PNorm = 66.2239, GNorm = 4.4752, lr_0 = 6.4565e-04
Validation rmse = 0.959265
Epoch 7
Loss = 2.6733e-03, PNorm = 66.2663, GNorm = 0.6286, lr_0 = 6.2476e-04
Loss = 2.7306e-03, PNorm = 66.3045, GNorm = 3.8648, lr_0 = 6.0454e-04
Validation rmse = 1.011331
Epoch 8
Loss = 3.1930e-03, PNorm = 66.3368, GNorm = 4.8623, lr_0 = 5.8498e-04
Loss = 2.5304e-03, PNorm = 66.3765, GNorm = 1.8722, lr_0 = 5.6605e-04
Loss = 2.2589e-03, PNorm = 66.4083, GNorm = 1.0475, lr_0 = 5.4774e-04
Validation rmse = 0.803213
Epoch 9
Loss = 2.1716e-03, PNorm = 66.4390, GNorm = 2.6884, lr_0 = 5.3001e-04
Loss = 2.2047e-03, PNorm = 66.4700, GNorm = 0.6864, lr_0 = 5.1286e-04
Validation rmse = 0.785835
Epoch 10
Loss = 1.5394e-03, PNorm = 66.4979, GNorm = 0.3593, lr_0 = 4.9627e-04
Loss = 1.9999e-03, PNorm = 66.5274, GNorm = 1.2352, lr_0 = 4.8021e-04
Loss = 1.7960e-03, PNorm = 66.5567, GNorm = 2.4362, lr_0 = 4.6467e-04
Validation rmse = 0.827845
Epoch 11
Loss = 2.0436e-03, PNorm = 66.5768, GNorm = 5.1576, lr_0 = 4.4963e-04
Loss = 3.3819e-03, PNorm = 66.6089, GNorm = 2.4693, lr_0 = 4.3508e-04
Validation rmse = 0.880064
Epoch 12
Loss = 1.7229e-03, PNorm = 66.6458, GNorm = 0.7930, lr_0 = 4.1962e-04
Loss = 1.8548e-03, PNorm = 66.6743, GNorm = 0.6766, lr_0 = 4.0604e-04
Loss = 1.8311e-03, PNorm = 66.6986, GNorm = 0.4110, lr_0 = 3.9290e-04
Validation rmse = 0.791724
Epoch 13
Loss = 1.7531e-03, PNorm = 66.7206, GNorm = 2.2505, lr_0 = 3.8019e-04
Loss = 1.8914e-03, PNorm = 66.7429, GNorm = 1.0979, lr_0 = 3.6789e-04
Loss = 1.6126e-03, PNorm = 66.7646, GNorm = 1.0353, lr_0 = 3.5598e-04
Validation rmse = 0.849854
Epoch 14
Loss = 1.7578e-03, PNorm = 66.7857, GNorm = 2.3460, lr_0 = 3.4446e-04
Loss = 1.6020e-03, PNorm = 66.8052, GNorm = 1.3438, lr_0 = 3.3332e-04
Validation rmse = 0.765667
Epoch 15
Loss = 1.2965e-03, PNorm = 66.8239, GNorm = 1.6027, lr_0 = 3.2253e-04
Loss = 1.4943e-03, PNorm = 66.8406, GNorm = 1.1446, lr_0 = 3.1209e-04
Loss = 1.3268e-03, PNorm = 66.8560, GNorm = 0.9129, lr_0 = 3.0200e-04
Validation rmse = 0.779622
Epoch 16
Loss = 1.4767e-03, PNorm = 66.8758, GNorm = 0.7960, lr_0 = 2.9222e-04
Loss = 1.4885e-03, PNorm = 66.8903, GNorm = 0.5007, lr_0 = 2.8277e-04
Validation rmse = 0.781281
Epoch 17
Loss = 1.8385e-03, PNorm = 66.9089, GNorm = 1.0466, lr_0 = 2.7272e-04
Loss = 1.3781e-03, PNorm = 66.9283, GNorm = 1.5704, lr_0 = 2.6389e-04
Loss = 1.3230e-03, PNorm = 66.9457, GNorm = 0.8896, lr_0 = 2.5535e-04
Validation rmse = 0.745116
Epoch 18
Loss = 1.2222e-03, PNorm = 66.9617, GNorm = 0.7635, lr_0 = 2.4709e-04
Loss = 1.2920e-03, PNorm = 66.9737, GNorm = 1.3184, lr_0 = 2.3910e-04
Loss = 1.3597e-03, PNorm = 66.9881, GNorm = 0.6565, lr_0 = 2.3136e-04
Validation rmse = 0.784316
Epoch 19
Loss = 1.3311e-03, PNorm = 67.0000, GNorm = 0.8354, lr_0 = 2.2387e-04
Loss = 1.3742e-03, PNorm = 67.0126, GNorm = 0.5534, lr_0 = 2.1663e-04
Validation rmse = 0.756594
Epoch 20
Loss = 7.6137e-04, PNorm = 67.0272, GNorm = 0.5203, lr_0 = 2.0962e-04
Loss = 1.1738e-03, PNorm = 67.0386, GNorm = 0.5353, lr_0 = 2.0283e-04
Loss = 1.2346e-03, PNorm = 67.0481, GNorm = 1.5444, lr_0 = 1.9627e-04
Validation rmse = 0.783759
Epoch 21
Loss = 1.1328e-03, PNorm = 67.0592, GNorm = 0.7110, lr_0 = 1.8992e-04
Loss = 1.2565e-03, PNorm = 67.0709, GNorm = 2.1749, lr_0 = 1.8377e-04
Validation rmse = 0.715234
Epoch 22
Loss = 9.3589e-04, PNorm = 67.0838, GNorm = 0.5119, lr_0 = 1.7783e-04
Loss = 1.0666e-03, PNorm = 67.0907, GNorm = 1.8124, lr_0 = 1.7207e-04
Loss = 1.1949e-03, PNorm = 67.1018, GNorm = 1.1801, lr_0 = 1.6651e-04
Validation rmse = 0.726470
Epoch 23
Loss = 1.0559e-03, PNorm = 67.1148, GNorm = 0.9908, lr_0 = 1.6059e-04
Loss = 9.2366e-04, PNorm = 67.1224, GNorm = 1.4306, lr_0 = 1.5539e-04
Validation rmse = 0.739044
Epoch 24
Loss = 9.1359e-04, PNorm = 67.1308, GNorm = 0.9550, lr_0 = 1.5036e-04
Loss = 1.1267e-03, PNorm = 67.1393, GNorm = 2.3565, lr_0 = 1.4550e-04
Loss = 1.1740e-03, PNorm = 67.1507, GNorm = 0.6513, lr_0 = 1.4079e-04
Validation rmse = 0.735955
Epoch 25
Loss = 1.0807e-03, PNorm = 67.1607, GNorm = 0.6361, lr_0 = 1.3623e-04
Loss = 1.0230e-03, PNorm = 67.1706, GNorm = 1.8688, lr_0 = 1.3183e-04
Loss = 9.5679e-04, PNorm = 67.1774, GNorm = 1.6289, lr_0 = 1.2756e-04
Validation rmse = 0.723211
Epoch 26
Loss = 9.8979e-04, PNorm = 67.1844, GNorm = 1.3014, lr_0 = 1.2343e-04
Loss = 1.0819e-03, PNorm = 67.1924, GNorm = 1.6436, lr_0 = 1.1944e-04
Validation rmse = 0.726126
Epoch 27
Loss = 7.8703e-04, PNorm = 67.2019, GNorm = 0.6377, lr_0 = 1.1557e-04
Loss = 8.7192e-04, PNorm = 67.2091, GNorm = 0.4398, lr_0 = 1.1183e-04
Loss = 9.0895e-04, PNorm = 67.2155, GNorm = 0.9082, lr_0 = 1.0821e-04
Validation rmse = 0.720976
Epoch 28
Loss = 7.7932e-04, PNorm = 67.2238, GNorm = 1.1357, lr_0 = 1.0437e-04
Loss = 9.8652e-04, PNorm = 67.2309, GNorm = 0.3779, lr_0 = 1.0099e-04
Validation rmse = 0.738256
Epoch 29
Loss = 1.4638e-03, PNorm = 67.2368, GNorm = 0.4087, lr_0 = 1.0000e-04
Loss = 9.3259e-04, PNorm = 67.2440, GNorm = 1.3187, lr_0 = 1.0000e-04
Loss = 7.6066e-04, PNorm = 67.2514, GNorm = 0.6956, lr_0 = 1.0000e-04
Validation rmse = 0.719910
Model 0 best validation rmse = 0.715234 on epoch 21
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 1.024699
Ensemble test rmse = 1.024699
Fold 5
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_5',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.9294e-02, PNorm = 65.0282, GNorm = 6.2154, lr_0 = 2.9800e-04
Loss = 1.3694e-02, PNorm = 65.0740, GNorm = 3.5988, lr_0 = 4.7800e-04
Validation rmse = 1.601756
Epoch 1
Loss = 7.6483e-03, PNorm = 65.1542, GNorm = 7.4790, lr_0 = 6.7600e-04
Loss = 8.5370e-03, PNorm = 65.2452, GNorm = 8.1523, lr_0 = 8.5600e-04
Loss = 9.5355e-03, PNorm = 65.3629, GNorm = 3.2608, lr_0 = 9.9344e-04
Validation rmse = 1.444424
Epoch 2
Loss = 6.9181e-03, PNorm = 65.4968, GNorm = 5.2392, lr_0 = 9.6130e-04
Loss = 6.6981e-03, PNorm = 65.6169, GNorm = 2.8702, lr_0 = 9.3019e-04
Validation rmse = 1.288564
Epoch 3
Loss = 4.5528e-03, PNorm = 65.7193, GNorm = 4.3011, lr_0 = 9.0009e-04
Loss = 4.1694e-03, PNorm = 65.7997, GNorm = 0.8333, lr_0 = 8.7096e-04
Loss = 4.4183e-03, PNorm = 65.8714, GNorm = 2.5507, lr_0 = 8.4278e-04
Validation rmse = 1.104648
Epoch 4
Loss = 3.7615e-03, PNorm = 65.9455, GNorm = 2.0930, lr_0 = 8.1551e-04
Loss = 4.0056e-03, PNorm = 66.0042, GNorm = 7.1456, lr_0 = 7.8912e-04
Validation rmse = 1.105583
Epoch 5
Loss = 2.7957e-03, PNorm = 66.0616, GNorm = 0.6660, lr_0 = 7.6358e-04
Loss = 3.1913e-03, PNorm = 66.1141, GNorm = 1.8024, lr_0 = 7.3888e-04
Loss = 3.7245e-03, PNorm = 66.1685, GNorm = 1.5203, lr_0 = 7.1497e-04
Validation rmse = 1.047512
Epoch 6
Loss = 2.6399e-03, PNorm = 66.2367, GNorm = 1.4131, lr_0 = 6.8956e-04
Loss = 3.4570e-03, PNorm = 66.2812, GNorm = 1.3974, lr_0 = 6.6725e-04
Loss = 2.5225e-03, PNorm = 66.3241, GNorm = 2.3857, lr_0 = 6.4565e-04
Validation rmse = 0.991886
Epoch 7
Loss = 2.0513e-03, PNorm = 66.3650, GNorm = 0.6775, lr_0 = 6.2476e-04
Loss = 2.4530e-03, PNorm = 66.4028, GNorm = 2.2589, lr_0 = 6.0454e-04
Validation rmse = 1.020313
Epoch 8
Loss = 1.7677e-03, PNorm = 66.4424, GNorm = 1.7094, lr_0 = 5.8498e-04
Loss = 2.3321e-03, PNorm = 66.4799, GNorm = 5.9341, lr_0 = 5.6605e-04
Loss = 2.5956e-03, PNorm = 66.5110, GNorm = 0.4445, lr_0 = 5.4774e-04
Validation rmse = 1.020271
Epoch 9
Loss = 1.9753e-03, PNorm = 66.5422, GNorm = 2.4386, lr_0 = 5.3001e-04
Loss = 2.1366e-03, PNorm = 66.5763, GNorm = 0.7919, lr_0 = 5.1286e-04
Validation rmse = 0.972614
Epoch 10
Loss = 1.6486e-03, PNorm = 66.6134, GNorm = 1.2314, lr_0 = 4.9627e-04
Loss = 1.6359e-03, PNorm = 66.6420, GNorm = 0.9796, lr_0 = 4.8021e-04
Loss = 2.2436e-03, PNorm = 66.6725, GNorm = 1.4498, lr_0 = 4.6467e-04
Validation rmse = 0.961763
Epoch 11
Loss = 1.6862e-03, PNorm = 66.7040, GNorm = 2.3918, lr_0 = 4.4963e-04
Loss = 2.3249e-03, PNorm = 66.7380, GNorm = 2.3954, lr_0 = 4.3508e-04
Validation rmse = 1.025824
Epoch 12
Loss = 1.8485e-03, PNorm = 66.7694, GNorm = 1.4197, lr_0 = 4.1962e-04
Loss = 2.0936e-03, PNorm = 66.7976, GNorm = 2.2456, lr_0 = 4.0604e-04
Loss = 1.8056e-03, PNorm = 66.8234, GNorm = 1.3614, lr_0 = 3.9290e-04
Validation rmse = 1.054759
Epoch 13
Loss = 2.0194e-03, PNorm = 66.8472, GNorm = 4.7606, lr_0 = 3.8019e-04
Loss = 1.6195e-03, PNorm = 66.8684, GNorm = 0.9510, lr_0 = 3.6789e-04
Loss = 1.7879e-03, PNorm = 66.8927, GNorm = 2.4863, lr_0 = 3.5598e-04
Validation rmse = 0.908874
Epoch 14
Loss = 1.8879e-03, PNorm = 66.9182, GNorm = 1.4612, lr_0 = 3.4446e-04
Loss = 1.4979e-03, PNorm = 66.9412, GNorm = 1.0832, lr_0 = 3.3332e-04
Validation rmse = 0.972786
Epoch 15
Loss = 1.7580e-03, PNorm = 66.9599, GNorm = 1.2090, lr_0 = 3.2253e-04
Loss = 1.3540e-03, PNorm = 66.9785, GNorm = 0.5061, lr_0 = 3.1209e-04
Loss = 1.3811e-03, PNorm = 66.9965, GNorm = 0.7156, lr_0 = 3.0200e-04
Validation rmse = 0.931616
Epoch 16
Loss = 1.6131e-03, PNorm = 67.0117, GNorm = 1.3997, lr_0 = 2.9222e-04
Loss = 1.2938e-03, PNorm = 67.0274, GNorm = 2.1505, lr_0 = 2.8277e-04
Validation rmse = 0.906304
Epoch 17
Loss = 1.3419e-03, PNorm = 67.0466, GNorm = 1.2811, lr_0 = 2.7272e-04
Loss = 1.3620e-03, PNorm = 67.0654, GNorm = 0.6671, lr_0 = 2.6389e-04
Loss = 1.2169e-03, PNorm = 67.0842, GNorm = 0.8609, lr_0 = 2.5535e-04
Validation rmse = 0.901161
Epoch 18
Loss = 1.2488e-03, PNorm = 67.0970, GNorm = 0.9790, lr_0 = 2.4709e-04
Loss = 1.1637e-03, PNorm = 67.1102, GNorm = 0.4171, lr_0 = 2.3910e-04
Loss = 1.1117e-03, PNorm = 67.1228, GNorm = 0.6505, lr_0 = 2.3136e-04
Validation rmse = 0.901801
Epoch 19
Loss = 1.1242e-03, PNorm = 67.1352, GNorm = 1.5900, lr_0 = 2.2387e-04
Loss = 1.3272e-03, PNorm = 67.1493, GNorm = 0.4599, lr_0 = 2.1663e-04
Validation rmse = 0.897644
Epoch 20
Loss = 1.0146e-03, PNorm = 67.1623, GNorm = 0.4598, lr_0 = 2.0962e-04
Loss = 1.1462e-03, PNorm = 67.1780, GNorm = 1.2915, lr_0 = 2.0283e-04
Loss = 1.0420e-03, PNorm = 67.1885, GNorm = 0.5283, lr_0 = 1.9627e-04
Validation rmse = 0.919138
Epoch 21
Loss = 1.1744e-03, PNorm = 67.2010, GNorm = 1.4603, lr_0 = 1.8992e-04
Loss = 1.0355e-03, PNorm = 67.2107, GNorm = 0.8598, lr_0 = 1.8377e-04
Validation rmse = 0.887573
Epoch 22
Loss = 1.0410e-03, PNorm = 67.2228, GNorm = 0.8724, lr_0 = 1.7783e-04
Loss = 7.9350e-04, PNorm = 67.2324, GNorm = 1.4521, lr_0 = 1.7207e-04
Loss = 1.2471e-03, PNorm = 67.2414, GNorm = 0.8872, lr_0 = 1.6651e-04
Validation rmse = 0.957428
Epoch 23
Loss = 1.0125e-03, PNorm = 67.2544, GNorm = 0.4999, lr_0 = 1.6059e-04
Loss = 9.9702e-04, PNorm = 67.2654, GNorm = 0.5968, lr_0 = 1.5539e-04
Validation rmse = 0.854541
Epoch 24
Loss = 9.7461e-04, PNorm = 67.2732, GNorm = 1.2367, lr_0 = 1.5036e-04
Loss = 1.1435e-03, PNorm = 67.2845, GNorm = 0.4646, lr_0 = 1.4550e-04
Loss = 9.6245e-04, PNorm = 67.2936, GNorm = 0.5156, lr_0 = 1.4079e-04
Validation rmse = 0.850493
Epoch 25
Loss = 9.4966e-04, PNorm = 67.3010, GNorm = 0.8335, lr_0 = 1.3623e-04
Loss = 9.1098e-04, PNorm = 67.3115, GNorm = 0.3876, lr_0 = 1.3183e-04
Loss = 9.3846e-04, PNorm = 67.3195, GNorm = 0.3770, lr_0 = 1.2756e-04
Validation rmse = 0.843912
Epoch 26
Loss = 9.7088e-04, PNorm = 67.3269, GNorm = 1.9282, lr_0 = 1.2343e-04
Loss = 8.3470e-04, PNorm = 67.3349, GNorm = 1.3124, lr_0 = 1.1944e-04
Validation rmse = 0.859529
Epoch 27
Loss = 7.2734e-04, PNorm = 67.3372, GNorm = 0.5618, lr_0 = 1.1557e-04
Loss = 9.5825e-04, PNorm = 67.3460, GNorm = 0.9976, lr_0 = 1.1183e-04
Loss = 8.3236e-04, PNorm = 67.3523, GNorm = 0.9155, lr_0 = 1.0821e-04
Validation rmse = 0.828696
Epoch 28
Loss = 9.7805e-04, PNorm = 67.3609, GNorm = 1.3601, lr_0 = 1.0437e-04
Loss = 7.5450e-04, PNorm = 67.3660, GNorm = 1.3932, lr_0 = 1.0099e-04
Validation rmse = 0.835779
Epoch 29
Loss = 5.3989e-04, PNorm = 67.3707, GNorm = 0.9674, lr_0 = 1.0000e-04
Loss = 9.0842e-04, PNorm = 67.3786, GNorm = 1.0946, lr_0 = 1.0000e-04
Loss = 8.3861e-04, PNorm = 67.3860, GNorm = 0.7607, lr_0 = 1.0000e-04
Validation rmse = 0.847987
Model 0 best validation rmse = 0.828696 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.676174
Ensemble test rmse = 0.676174
Fold 6
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_6',
 'save_smiles_splits': True,
 'seed': 6,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 6
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.9986e-02, PNorm = 65.0242, GNorm = 6.2413, lr_0 = 2.9800e-04
Loss = 1.6050e-02, PNorm = 65.0699, GNorm = 10.0801, lr_0 = 4.7800e-04
Validation rmse = 1.966199
Epoch 1
Loss = 1.1143e-02, PNorm = 65.1558, GNorm = 6.6604, lr_0 = 6.7600e-04
Loss = 1.0962e-02, PNorm = 65.2579, GNorm = 1.7957, lr_0 = 8.5600e-04
Loss = 8.2326e-03, PNorm = 65.3795, GNorm = 2.2788, lr_0 = 9.9344e-04
Validation rmse = 1.816393
Epoch 2
Loss = 6.5032e-03, PNorm = 65.5015, GNorm = 1.2624, lr_0 = 9.6130e-04
Loss = 5.4145e-03, PNorm = 65.5940, GNorm = 1.1169, lr_0 = 9.3019e-04
Validation rmse = 1.541839
Epoch 3
Loss = 8.2268e-03, PNorm = 65.6898, GNorm = 1.3933, lr_0 = 9.0009e-04
Loss = 5.6545e-03, PNorm = 65.7939, GNorm = 1.1653, lr_0 = 8.7096e-04
Loss = 4.6223e-03, PNorm = 65.8744, GNorm = 3.9001, lr_0 = 8.4278e-04
Validation rmse = 1.257543
Epoch 4
Loss = 4.5573e-03, PNorm = 65.9448, GNorm = 4.1298, lr_0 = 8.1551e-04
Loss = 5.8161e-03, PNorm = 66.0115, GNorm = 3.0267, lr_0 = 7.8912e-04
Validation rmse = 1.124424
Epoch 5
Loss = 2.1424e-03, PNorm = 66.0717, GNorm = 0.9271, lr_0 = 7.6358e-04
Loss = 4.1223e-03, PNorm = 66.1263, GNorm = 1.6550, lr_0 = 7.3888e-04
Loss = 3.2108e-03, PNorm = 66.1782, GNorm = 0.8070, lr_0 = 7.1497e-04
Validation rmse = 1.036526
Epoch 6
Loss = 2.5451e-03, PNorm = 66.2309, GNorm = 1.0181, lr_0 = 6.8956e-04
Loss = 2.8717e-03, PNorm = 66.2714, GNorm = 4.0054, lr_0 = 6.6725e-04
Loss = 3.6001e-03, PNorm = 66.3168, GNorm = 1.3052, lr_0 = 6.4565e-04
Validation rmse = 1.243619
Epoch 7
Loss = 3.3882e-03, PNorm = 66.3669, GNorm = 2.7477, lr_0 = 6.2476e-04
Loss = 2.5623e-03, PNorm = 66.4093, GNorm = 1.9753, lr_0 = 6.0454e-04
Validation rmse = 1.082098
Epoch 8
Loss = 2.6560e-03, PNorm = 66.4467, GNorm = 3.4239, lr_0 = 5.8498e-04
Loss = 2.0917e-03, PNorm = 66.4840, GNorm = 1.4087, lr_0 = 5.6605e-04
Loss = 2.7017e-03, PNorm = 66.5174, GNorm = 1.1710, lr_0 = 5.4774e-04
Validation rmse = 1.038565
Epoch 9
Loss = 3.1997e-03, PNorm = 66.5553, GNorm = 4.7311, lr_0 = 5.3001e-04
Loss = 2.4149e-03, PNorm = 66.5959, GNorm = 0.8161, lr_0 = 5.1286e-04
Validation rmse = 1.012267
Epoch 10
Loss = 2.6109e-03, PNorm = 66.6357, GNorm = 2.3775, lr_0 = 4.9627e-04
Loss = 2.3010e-03, PNorm = 66.6733, GNorm = 1.0421, lr_0 = 4.8021e-04
Loss = 1.8641e-03, PNorm = 66.7069, GNorm = 0.5548, lr_0 = 4.6467e-04
Validation rmse = 1.031239
Epoch 11
Loss = 2.0775e-03, PNorm = 66.7323, GNorm = 2.7430, lr_0 = 4.4963e-04
Loss = 1.6653e-03, PNorm = 66.7579, GNorm = 0.5268, lr_0 = 4.3508e-04
Validation rmse = 0.981613
Epoch 12
Loss = 1.3914e-03, PNorm = 66.7877, GNorm = 0.4698, lr_0 = 4.1962e-04
Loss = 1.4435e-03, PNorm = 66.8108, GNorm = 0.4913, lr_0 = 4.0604e-04
Loss = 1.6215e-03, PNorm = 66.8305, GNorm = 0.6674, lr_0 = 3.9290e-04
Validation rmse = 0.961977
Epoch 13
Loss = 1.6190e-03, PNorm = 66.8544, GNorm = 1.1538, lr_0 = 3.8019e-04
Loss = 1.6304e-03, PNorm = 66.8730, GNorm = 0.7642, lr_0 = 3.6789e-04
Loss = 1.6343e-03, PNorm = 66.8939, GNorm = 0.9254, lr_0 = 3.5598e-04
Validation rmse = 0.971845
Epoch 14
Loss = 1.6495e-03, PNorm = 66.9152, GNorm = 0.4973, lr_0 = 3.4446e-04
Loss = 1.4224e-03, PNorm = 66.9355, GNorm = 0.7020, lr_0 = 3.3332e-04
Validation rmse = 0.991261
Epoch 15
Loss = 1.0624e-03, PNorm = 66.9595, GNorm = 0.4357, lr_0 = 3.2253e-04
Loss = 1.8086e-03, PNorm = 66.9810, GNorm = 0.4391, lr_0 = 3.1209e-04
Loss = 1.5202e-03, PNorm = 67.0022, GNorm = 1.8511, lr_0 = 3.0200e-04
Validation rmse = 1.049832
Epoch 16
Loss = 1.2789e-03, PNorm = 67.0166, GNorm = 1.7914, lr_0 = 2.9222e-04
Loss = 1.5317e-03, PNorm = 67.0383, GNorm = 0.3935, lr_0 = 2.8277e-04
Validation rmse = 0.971562
Epoch 17
Loss = 1.2062e-03, PNorm = 67.0597, GNorm = 2.0099, lr_0 = 2.7272e-04
Loss = 1.3456e-03, PNorm = 67.0743, GNorm = 0.7293, lr_0 = 2.6389e-04
Loss = 1.2119e-03, PNorm = 67.0882, GNorm = 0.4359, lr_0 = 2.5535e-04
Validation rmse = 1.011192
Epoch 18
Loss = 1.6092e-03, PNorm = 67.1027, GNorm = 2.6045, lr_0 = 2.4709e-04
Loss = 1.1898e-03, PNorm = 67.1195, GNorm = 1.7151, lr_0 = 2.3910e-04
Loss = 1.3114e-03, PNorm = 67.1337, GNorm = 0.9884, lr_0 = 2.3136e-04
Validation rmse = 0.970178
Epoch 19
Loss = 1.2242e-03, PNorm = 67.1457, GNorm = 0.4117, lr_0 = 2.2387e-04
Loss = 1.1560e-03, PNorm = 67.1578, GNorm = 1.6592, lr_0 = 2.1663e-04
Validation rmse = 0.958327
Epoch 20
Loss = 1.0231e-03, PNorm = 67.1723, GNorm = 0.3486, lr_0 = 2.0962e-04
Loss = 1.0813e-03, PNorm = 67.1858, GNorm = 0.3152, lr_0 = 2.0283e-04
Loss = 1.2398e-03, PNorm = 67.1977, GNorm = 0.7871, lr_0 = 1.9627e-04
Validation rmse = 0.950812
Epoch 21
Loss = 1.1278e-03, PNorm = 67.2090, GNorm = 0.4900, lr_0 = 1.8992e-04
Loss = 1.0494e-03, PNorm = 67.2224, GNorm = 1.1588, lr_0 = 1.8377e-04
Validation rmse = 0.940947
Epoch 22
Loss = 9.0120e-04, PNorm = 67.2307, GNorm = 0.4776, lr_0 = 1.7783e-04
Loss = 1.0857e-03, PNorm = 67.2410, GNorm = 1.2944, lr_0 = 1.7207e-04
Loss = 1.1111e-03, PNorm = 67.2508, GNorm = 1.2977, lr_0 = 1.6651e-04
Validation rmse = 0.960591
Epoch 23
Loss = 1.0364e-03, PNorm = 67.2613, GNorm = 1.9262, lr_0 = 1.6059e-04
Loss = 1.2327e-03, PNorm = 67.2703, GNorm = 0.5281, lr_0 = 1.5539e-04
Validation rmse = 0.981156
Epoch 24
Loss = 9.2773e-04, PNorm = 67.2801, GNorm = 1.1361, lr_0 = 1.5036e-04
Loss = 1.0277e-03, PNorm = 67.2884, GNorm = 1.4916, lr_0 = 1.4550e-04
Loss = 1.2131e-03, PNorm = 67.2973, GNorm = 1.8902, lr_0 = 1.4079e-04
Validation rmse = 0.942504
Epoch 25
Loss = 1.0617e-03, PNorm = 67.3041, GNorm = 0.4754, lr_0 = 1.3623e-04
Loss = 7.5931e-04, PNorm = 67.3113, GNorm = 0.4585, lr_0 = 1.3183e-04
Loss = 1.2272e-03, PNorm = 67.3186, GNorm = 0.7786, lr_0 = 1.2756e-04
Validation rmse = 0.960800
Epoch 26
Loss = 9.7056e-04, PNorm = 67.3265, GNorm = 1.0573, lr_0 = 1.2343e-04
Loss = 8.7289e-04, PNorm = 67.3344, GNorm = 0.5431, lr_0 = 1.1944e-04
Validation rmse = 0.951838
Epoch 27
Loss = 8.5797e-04, PNorm = 67.3431, GNorm = 0.4642, lr_0 = 1.1557e-04
Loss = 8.9925e-04, PNorm = 67.3507, GNorm = 0.5865, lr_0 = 1.1183e-04
Loss = 8.9000e-04, PNorm = 67.3577, GNorm = 0.5920, lr_0 = 1.0821e-04
Validation rmse = 0.965322
Epoch 28
Loss = 9.6587e-04, PNorm = 67.3632, GNorm = 0.5657, lr_0 = 1.0437e-04
Loss = 9.3858e-04, PNorm = 67.3707, GNorm = 1.2742, lr_0 = 1.0099e-04
Validation rmse = 0.949570
Epoch 29
Loss = 9.0070e-04, PNorm = 67.3767, GNorm = 0.3252, lr_0 = 1.0000e-04
Loss = 7.8611e-04, PNorm = 67.3834, GNorm = 0.5017, lr_0 = 1.0000e-04
Loss = 9.8121e-04, PNorm = 67.3902, GNorm = 0.3770, lr_0 = 1.0000e-04
Validation rmse = 0.954872
Model 0 best validation rmse = 0.940947 on epoch 21
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.763615
Ensemble test rmse = 0.763615
Fold 7
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_7',
 'save_smiles_splits': True,
 'seed': 7,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 7
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.6151e-02, PNorm = 65.0303, GNorm = 10.3780, lr_0 = 2.9800e-04
Loss = 1.4231e-02, PNorm = 65.0753, GNorm = 8.3300, lr_0 = 4.7800e-04
Validation rmse = 1.567310
Epoch 1
Loss = 1.0025e-02, PNorm = 65.1579, GNorm = 6.7885, lr_0 = 6.7600e-04
Loss = 8.5267e-03, PNorm = 65.2549, GNorm = 2.9617, lr_0 = 8.5600e-04
Loss = 7.1845e-03, PNorm = 65.3780, GNorm = 4.2200, lr_0 = 9.9344e-04
Validation rmse = 1.897325
Epoch 2
Loss = 8.5283e-03, PNorm = 65.5038, GNorm = 1.3330, lr_0 = 9.6130e-04
Loss = 6.1497e-03, PNorm = 65.6312, GNorm = 2.3818, lr_0 = 9.3019e-04
Validation rmse = 1.467076
Epoch 3
Loss = 5.2395e-03, PNorm = 65.7291, GNorm = 0.9518, lr_0 = 9.0009e-04
Loss = 4.7866e-03, PNorm = 65.8102, GNorm = 3.0892, lr_0 = 8.7096e-04
Loss = 4.9520e-03, PNorm = 65.8952, GNorm = 2.7113, lr_0 = 8.4278e-04
Validation rmse = 0.914437
Epoch 4
Loss = 3.8676e-03, PNorm = 65.9746, GNorm = 1.9907, lr_0 = 8.1551e-04
Loss = 3.4474e-03, PNorm = 66.0369, GNorm = 2.5183, lr_0 = 7.8912e-04
Validation rmse = 0.919170
Epoch 5
Loss = 3.4970e-03, PNorm = 66.0926, GNorm = 2.1904, lr_0 = 7.6358e-04
Loss = 3.5168e-03, PNorm = 66.1623, GNorm = 3.4813, lr_0 = 7.3888e-04
Loss = 3.3247e-03, PNorm = 66.2146, GNorm = 2.0833, lr_0 = 7.1497e-04
Validation rmse = 0.905664
Epoch 6
Loss = 3.6528e-03, PNorm = 66.2625, GNorm = 2.6171, lr_0 = 6.8956e-04
Loss = 4.0982e-03, PNorm = 66.3096, GNorm = 0.6151, lr_0 = 6.6725e-04
Loss = 3.2029e-03, PNorm = 66.3666, GNorm = 1.0069, lr_0 = 6.4565e-04
Validation rmse = 0.775444
Epoch 7
Loss = 2.5547e-03, PNorm = 66.4208, GNorm = 2.9778, lr_0 = 6.2476e-04
Loss = 3.0976e-03, PNorm = 66.4591, GNorm = 4.4374, lr_0 = 6.0454e-04
Validation rmse = 0.982679
Epoch 8
Loss = 2.0676e-03, PNorm = 66.5080, GNorm = 0.9407, lr_0 = 5.8498e-04
Loss = 2.7374e-03, PNorm = 66.5476, GNorm = 0.9579, lr_0 = 5.6605e-04
Loss = 2.5598e-03, PNorm = 66.5884, GNorm = 1.5809, lr_0 = 5.4774e-04
Validation rmse = 0.791980
Epoch 9
Loss = 2.0676e-03, PNorm = 66.6295, GNorm = 3.2535, lr_0 = 5.3001e-04
Loss = 2.7914e-03, PNorm = 66.6666, GNorm = 1.5682, lr_0 = 5.1286e-04
Validation rmse = 0.824016
Epoch 10
Loss = 1.9946e-03, PNorm = 66.7011, GNorm = 1.9307, lr_0 = 4.9627e-04
Loss = 1.8440e-03, PNorm = 66.7386, GNorm = 0.5278, lr_0 = 4.8021e-04
Loss = 2.1753e-03, PNorm = 66.7673, GNorm = 2.0051, lr_0 = 4.6467e-04
Validation rmse = 0.825962
Epoch 11
Loss = 2.2830e-03, PNorm = 66.8019, GNorm = 2.4897, lr_0 = 4.4963e-04
Loss = 1.7211e-03, PNorm = 66.8314, GNorm = 1.7298, lr_0 = 4.3508e-04
Validation rmse = 0.730749
Epoch 12
Loss = 1.8328e-03, PNorm = 66.8604, GNorm = 1.9496, lr_0 = 4.1962e-04
Loss = 1.4888e-03, PNorm = 66.8846, GNorm = 1.1299, lr_0 = 4.0604e-04
Loss = 1.8642e-03, PNorm = 66.9084, GNorm = 1.3889, lr_0 = 3.9290e-04
Validation rmse = 0.875278
Epoch 13
Loss = 1.7375e-03, PNorm = 66.9286, GNorm = 1.0680, lr_0 = 3.8019e-04
Loss = 1.4005e-03, PNorm = 66.9490, GNorm = 0.9421, lr_0 = 3.6789e-04
Loss = 1.7887e-03, PNorm = 66.9720, GNorm = 2.1246, lr_0 = 3.5598e-04
Validation rmse = 0.708668
Epoch 14
Loss = 1.4607e-03, PNorm = 66.9939, GNorm = 0.4827, lr_0 = 3.4446e-04
Loss = 1.5259e-03, PNorm = 67.0157, GNorm = 1.7617, lr_0 = 3.3332e-04
Validation rmse = 0.814086
Epoch 15
Loss = 7.8117e-04, PNorm = 67.0394, GNorm = 0.7676, lr_0 = 3.2253e-04
Loss = 1.7794e-03, PNorm = 67.0629, GNorm = 0.5280, lr_0 = 3.1209e-04
Loss = 1.3340e-03, PNorm = 67.0819, GNorm = 0.4632, lr_0 = 3.0200e-04
Validation rmse = 0.762680
Epoch 16
Loss = 1.0003e-03, PNorm = 67.1005, GNorm = 0.6899, lr_0 = 2.9222e-04
Loss = 1.4591e-03, PNorm = 67.1182, GNorm = 2.2459, lr_0 = 2.8277e-04
Validation rmse = 0.764810
Epoch 17
Loss = 1.0057e-03, PNorm = 67.1319, GNorm = 1.4408, lr_0 = 2.7272e-04
Loss = 1.0962e-03, PNorm = 67.1443, GNorm = 0.6053, lr_0 = 2.6389e-04
Loss = 1.4191e-03, PNorm = 67.1608, GNorm = 2.4038, lr_0 = 2.5535e-04
Validation rmse = 0.718974
Epoch 18
Loss = 1.1611e-03, PNorm = 67.1755, GNorm = 0.5749, lr_0 = 2.4709e-04
Loss = 1.1347e-03, PNorm = 67.1880, GNorm = 0.4401, lr_0 = 2.3910e-04
Loss = 1.3612e-03, PNorm = 67.1997, GNorm = 2.9528, lr_0 = 2.3136e-04
Validation rmse = 0.747504
Epoch 19
Loss = 1.2609e-03, PNorm = 67.2132, GNorm = 0.8033, lr_0 = 2.2387e-04
Loss = 1.3034e-03, PNorm = 67.2271, GNorm = 0.8471, lr_0 = 2.1663e-04
Validation rmse = 0.707841
Epoch 20
Loss = 1.3984e-03, PNorm = 67.2390, GNorm = 1.1324, lr_0 = 2.0962e-04
Loss = 1.1888e-03, PNorm = 67.2524, GNorm = 2.9698, lr_0 = 2.0283e-04
Loss = 1.1484e-03, PNorm = 67.2660, GNorm = 1.2892, lr_0 = 1.9627e-04
Validation rmse = 0.705714
Epoch 21
Loss = 1.2464e-03, PNorm = 67.2817, GNorm = 1.5477, lr_0 = 1.8992e-04
Loss = 1.0371e-03, PNorm = 67.2927, GNorm = 0.6224, lr_0 = 1.8377e-04
Validation rmse = 0.706626
Epoch 22
Loss = 1.0589e-03, PNorm = 67.3022, GNorm = 0.5830, lr_0 = 1.7783e-04
Loss = 9.5423e-04, PNorm = 67.3116, GNorm = 1.3726, lr_0 = 1.7207e-04
Loss = 1.0415e-03, PNorm = 67.3205, GNorm = 0.9803, lr_0 = 1.6651e-04
Validation rmse = 0.802468
Epoch 23
Loss = 8.6928e-04, PNorm = 67.3320, GNorm = 0.4546, lr_0 = 1.6059e-04
Loss = 9.9866e-04, PNorm = 67.3418, GNorm = 0.4687, lr_0 = 1.5539e-04
Validation rmse = 0.808550
Epoch 24
Loss = 6.0386e-04, PNorm = 67.3490, GNorm = 0.4962, lr_0 = 1.5036e-04
Loss = 1.0275e-03, PNorm = 67.3568, GNorm = 0.6454, lr_0 = 1.4550e-04
Loss = 1.0038e-03, PNorm = 67.3630, GNorm = 0.6167, lr_0 = 1.4079e-04
Validation rmse = 0.748876
Epoch 25
Loss = 7.2675e-04, PNorm = 67.3713, GNorm = 1.1519, lr_0 = 1.3623e-04
Loss = 8.9623e-04, PNorm = 67.3808, GNorm = 0.9356, lr_0 = 1.3183e-04
Loss = 1.0438e-03, PNorm = 67.3884, GNorm = 0.5570, lr_0 = 1.2756e-04
Validation rmse = 0.723510
Epoch 26
Loss = 8.1205e-04, PNorm = 67.3942, GNorm = 0.6717, lr_0 = 1.2343e-04
Loss = 8.7126e-04, PNorm = 67.4023, GNorm = 0.6704, lr_0 = 1.1944e-04
Validation rmse = 0.702566
Epoch 27
Loss = 6.9035e-04, PNorm = 67.4088, GNorm = 0.4328, lr_0 = 1.1557e-04
Loss = 9.6459e-04, PNorm = 67.4167, GNorm = 1.1651, lr_0 = 1.1183e-04
Loss = 9.5326e-04, PNorm = 67.4225, GNorm = 0.6941, lr_0 = 1.0821e-04
Validation rmse = 0.742808
Epoch 28
Loss = 8.6205e-04, PNorm = 67.4282, GNorm = 0.8518, lr_0 = 1.0437e-04
Loss = 7.9129e-04, PNorm = 67.4334, GNorm = 0.5142, lr_0 = 1.0099e-04
Validation rmse = 0.717520
Epoch 29
Loss = 6.8547e-04, PNorm = 67.4398, GNorm = 0.5840, lr_0 = 1.0000e-04
Loss = 8.8457e-04, PNorm = 67.4448, GNorm = 1.4218, lr_0 = 1.0000e-04
Loss = 9.2243e-04, PNorm = 67.4501, GNorm = 0.9518, lr_0 = 1.0000e-04
Validation rmse = 0.739837
Model 0 best validation rmse = 0.702566 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.708465
Ensemble test rmse = 0.708465
Fold 8
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_8',
 'save_smiles_splits': True,
 'seed': 8,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 8
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.8859e-02, PNorm = 65.0271, GNorm = 8.1681, lr_0 = 2.9800e-04
Loss = 1.3749e-02, PNorm = 65.0667, GNorm = 2.8101, lr_0 = 4.7800e-04
Validation rmse = 1.897872
Epoch 1
Loss = 1.0667e-02, PNorm = 65.1474, GNorm = 1.8272, lr_0 = 6.7600e-04
Loss = 7.1173e-03, PNorm = 65.2396, GNorm = 2.1867, lr_0 = 8.5600e-04
Loss = 6.7011e-03, PNorm = 65.3402, GNorm = 4.3922, lr_0 = 9.9344e-04
Validation rmse = 1.437890
Epoch 2
Loss = 6.5002e-03, PNorm = 65.4542, GNorm = 5.5623, lr_0 = 9.6130e-04
Loss = 5.2129e-03, PNorm = 65.5608, GNorm = 6.1507, lr_0 = 9.3019e-04
Validation rmse = 1.304565
Epoch 3
Loss = 4.7088e-03, PNorm = 65.6504, GNorm = 3.3994, lr_0 = 9.0009e-04
Loss = 5.0665e-03, PNorm = 65.7289, GNorm = 2.0474, lr_0 = 8.7096e-04
Loss = 4.1680e-03, PNorm = 65.8018, GNorm = 3.8505, lr_0 = 8.4278e-04
Validation rmse = 1.083480
Epoch 4
Loss = 4.7281e-03, PNorm = 65.8583, GNorm = 5.9031, lr_0 = 8.1551e-04
Loss = 4.1956e-03, PNorm = 65.9228, GNorm = 1.9738, lr_0 = 7.8912e-04
Validation rmse = 1.087870
Epoch 5
Loss = 1.9999e-03, PNorm = 65.9670, GNorm = 0.7166, lr_0 = 7.6358e-04
Loss = 2.7630e-03, PNorm = 66.0052, GNorm = 1.8723, lr_0 = 7.3888e-04
Loss = 3.4441e-03, PNorm = 66.0434, GNorm = 2.4032, lr_0 = 7.1497e-04
Validation rmse = 1.242704
Epoch 6
Loss = 3.1702e-03, PNorm = 66.0892, GNorm = 0.5427, lr_0 = 6.8956e-04
Loss = 3.1190e-03, PNorm = 66.1379, GNorm = 2.0970, lr_0 = 6.6725e-04
Loss = 3.4733e-03, PNorm = 66.1733, GNorm = 1.7515, lr_0 = 6.4565e-04
Validation rmse = 0.977181
Epoch 7
Loss = 2.6492e-03, PNorm = 66.2117, GNorm = 1.2823, lr_0 = 6.2476e-04
Loss = 2.5827e-03, PNorm = 66.2483, GNorm = 2.5098, lr_0 = 6.0454e-04
Validation rmse = 0.987611
Epoch 8
Loss = 2.3838e-03, PNorm = 66.2778, GNorm = 1.2902, lr_0 = 5.8498e-04
Loss = 2.2076e-03, PNorm = 66.3104, GNorm = 1.0282, lr_0 = 5.6605e-04
Loss = 2.0593e-03, PNorm = 66.3414, GNorm = 0.6801, lr_0 = 5.4774e-04
Validation rmse = 1.014147
Epoch 9
Loss = 2.1724e-03, PNorm = 66.3663, GNorm = 1.8073, lr_0 = 5.3001e-04
Loss = 2.0347e-03, PNorm = 66.3992, GNorm = 0.7229, lr_0 = 5.1286e-04
Validation rmse = 0.961665
Epoch 10
Loss = 2.1267e-03, PNorm = 66.4255, GNorm = 2.7775, lr_0 = 4.9627e-04
Loss = 2.8501e-03, PNorm = 66.4512, GNorm = 3.4563, lr_0 = 4.8021e-04
Loss = 2.7218e-03, PNorm = 66.4790, GNorm = 2.5008, lr_0 = 4.6467e-04
Validation rmse = 1.013809
Epoch 11
Loss = 2.3233e-03, PNorm = 66.5105, GNorm = 2.5615, lr_0 = 4.4963e-04
Loss = 1.8377e-03, PNorm = 66.5379, GNorm = 2.1124, lr_0 = 4.3508e-04
Validation rmse = 0.953014
Epoch 12
Loss = 1.6407e-03, PNorm = 66.5644, GNorm = 0.8926, lr_0 = 4.1962e-04
Loss = 1.8811e-03, PNorm = 66.5837, GNorm = 3.0294, lr_0 = 4.0604e-04
Loss = 1.8630e-03, PNorm = 66.6080, GNorm = 3.2789, lr_0 = 3.9290e-04
Validation rmse = 0.951958
Epoch 13
Loss = 1.8081e-03, PNorm = 66.6274, GNorm = 1.1713, lr_0 = 3.8019e-04
Loss = 1.9718e-03, PNorm = 66.6506, GNorm = 1.7399, lr_0 = 3.6789e-04
Loss = 1.5952e-03, PNorm = 66.6707, GNorm = 1.7806, lr_0 = 3.5598e-04
Validation rmse = 0.942102
Epoch 14
Loss = 1.4209e-03, PNorm = 66.6874, GNorm = 0.7925, lr_0 = 3.4446e-04
Loss = 1.5220e-03, PNorm = 66.7065, GNorm = 1.1835, lr_0 = 3.3332e-04
Validation rmse = 0.951715
Epoch 15
Loss = 1.6593e-03, PNorm = 66.7244, GNorm = 0.7348, lr_0 = 3.2253e-04
Loss = 1.5466e-03, PNorm = 66.7432, GNorm = 1.5883, lr_0 = 3.1209e-04
Loss = 1.4279e-03, PNorm = 66.7608, GNorm = 0.5161, lr_0 = 3.0200e-04
Validation rmse = 0.959809
Epoch 16
Loss = 1.4459e-03, PNorm = 66.7735, GNorm = 1.2918, lr_0 = 2.9222e-04
Loss = 1.4480e-03, PNorm = 66.7896, GNorm = 0.7761, lr_0 = 2.8277e-04
Validation rmse = 1.000511
Epoch 17
Loss = 1.0944e-03, PNorm = 66.8078, GNorm = 1.3562, lr_0 = 2.7272e-04
Loss = 1.6352e-03, PNorm = 66.8277, GNorm = 1.2926, lr_0 = 2.6389e-04
Loss = 1.3199e-03, PNorm = 66.8427, GNorm = 1.3513, lr_0 = 2.5535e-04
Validation rmse = 0.921459
Epoch 18
Loss = 1.2578e-03, PNorm = 66.8535, GNorm = 1.1532, lr_0 = 2.4709e-04
Loss = 1.4232e-03, PNorm = 66.8649, GNorm = 0.6030, lr_0 = 2.3910e-04
Loss = 1.5694e-03, PNorm = 66.8799, GNorm = 1.2714, lr_0 = 2.3136e-04
Validation rmse = 0.951614
Epoch 19
Loss = 1.3472e-03, PNorm = 66.8969, GNorm = 1.7972, lr_0 = 2.2387e-04
Loss = 1.0867e-03, PNorm = 66.9107, GNorm = 0.9237, lr_0 = 2.1663e-04
Validation rmse = 0.952722
Epoch 20
Loss = 1.2099e-03, PNorm = 66.9190, GNorm = 0.7173, lr_0 = 2.0962e-04
Loss = 1.2406e-03, PNorm = 66.9312, GNorm = 0.6237, lr_0 = 2.0283e-04
Loss = 1.3107e-03, PNorm = 66.9429, GNorm = 2.0876, lr_0 = 1.9627e-04
Validation rmse = 0.947474
Epoch 21
Loss = 1.1163e-03, PNorm = 66.9525, GNorm = 1.1387, lr_0 = 1.8992e-04
Loss = 1.2330e-03, PNorm = 66.9619, GNorm = 0.5104, lr_0 = 1.8377e-04
Validation rmse = 0.936118
Epoch 22
Loss = 1.0947e-03, PNorm = 66.9722, GNorm = 1.1351, lr_0 = 1.7783e-04
Loss = 1.0569e-03, PNorm = 66.9828, GNorm = 1.4005, lr_0 = 1.7207e-04
Loss = 1.1968e-03, PNorm = 66.9936, GNorm = 0.4753, lr_0 = 1.6651e-04
Validation rmse = 0.936844
Epoch 23
Loss = 1.0880e-03, PNorm = 67.0031, GNorm = 0.5468, lr_0 = 1.6059e-04
Loss = 9.9417e-04, PNorm = 67.0122, GNorm = 0.4311, lr_0 = 1.5539e-04
Validation rmse = 0.948158
Epoch 24
Loss = 8.1678e-04, PNorm = 67.0223, GNorm = 0.4488, lr_0 = 1.5036e-04
Loss = 1.1510e-03, PNorm = 67.0315, GNorm = 0.9281, lr_0 = 1.4550e-04
Loss = 9.4879e-04, PNorm = 67.0387, GNorm = 0.7945, lr_0 = 1.4079e-04
Validation rmse = 0.961052
Epoch 25
Loss = 8.8838e-04, PNorm = 67.0452, GNorm = 0.5061, lr_0 = 1.3623e-04
Loss = 1.0327e-03, PNorm = 67.0534, GNorm = 1.1057, lr_0 = 1.3183e-04
Loss = 1.0701e-03, PNorm = 67.0614, GNorm = 0.7020, lr_0 = 1.2756e-04
Validation rmse = 0.957549
Epoch 26
Loss = 1.1176e-03, PNorm = 67.0697, GNorm = 0.4687, lr_0 = 1.2343e-04
Loss = 9.7015e-04, PNorm = 67.0783, GNorm = 1.6540, lr_0 = 1.1944e-04
Validation rmse = 0.949640
Epoch 27
Loss = 1.1441e-03, PNorm = 67.0858, GNorm = 1.7687, lr_0 = 1.1557e-04
Loss = 9.6935e-04, PNorm = 67.0921, GNorm = 0.8295, lr_0 = 1.1183e-04
Loss = 1.0734e-03, PNorm = 67.0979, GNorm = 1.0361, lr_0 = 1.0821e-04
Validation rmse = 0.971939
Epoch 28
Loss = 1.0634e-03, PNorm = 67.1060, GNorm = 1.3380, lr_0 = 1.0437e-04
Loss = 9.4675e-04, PNorm = 67.1117, GNorm = 0.5741, lr_0 = 1.0099e-04
Validation rmse = 0.948873
Epoch 29
Loss = 6.1155e-04, PNorm = 67.1169, GNorm = 0.6951, lr_0 = 1.0000e-04
Loss = 9.3802e-04, PNorm = 67.1223, GNorm = 0.4642, lr_0 = 1.0000e-04
Loss = 9.7675e-04, PNorm = 67.1289, GNorm = 1.9810, lr_0 = 1.0000e-04
Validation rmse = 0.987639
Model 0 best validation rmse = 0.921459 on epoch 17
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.698984
Ensemble test rmse = 0.698984
Fold 9
Command line
python hyperparameter_optimization.py --data_path data/DowData/solubility/Joback_G3_G5/data.csv --dataset_type regression --save_dir checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684 --split_type random --num_iters 20 --num_folds 10 --ensemble_size 1 --save_smiles_splits --config_save_path checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json
Args
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_save_path': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/config.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/DowData/solubility/Joback_G3_G5/data.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 1300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_dir': None,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_iters': 20,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': 'checkpoints/Hansen_G3_G5_random/sol_hyperopt-1597415684/depth_3_dropout_0.1_ffn_num_layers_2_hidden_size_1300/fold_9',
 'save_smiles_splits': True,
 'seed': 9,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'task_names': ['Solubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 1291,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 9
Total size = 1,614 | train size = 1,291 | val size = 161 | test size = 162
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.1, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=1300, bias=False)
      (W_h): Linear(in_features=1300, out_features=1300, bias=False)
      (W_o): Linear(in_features=1433, out_features=1300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=1300, out_features=1300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1300, out_features=1, bias=True)
  )
)
Number of parameters = 5,437,901
Moving model to cuda
Epoch 0
Loss = 1.9493e-02, PNorm = 65.0252, GNorm = 4.1362, lr_0 = 2.9800e-04
Loss = 1.3972e-02, PNorm = 65.0734, GNorm = 3.0112, lr_0 = 4.7800e-04
Validation rmse = 1.501489
Epoch 1
Loss = 8.1544e-03, PNorm = 65.1528, GNorm = 3.6218, lr_0 = 6.7600e-04
Loss = 8.0340e-03, PNorm = 65.2472, GNorm = 3.3890, lr_0 = 8.5600e-04
Loss = 6.8062e-03, PNorm = 65.3589, GNorm = 3.3065, lr_0 = 9.9344e-04
Validation rmse = 1.267007
Epoch 2
Loss = 7.3963e-03, PNorm = 65.4745, GNorm = 6.5967, lr_0 = 9.6130e-04
Loss = 5.3241e-03, PNorm = 65.5899, GNorm = 3.4347, lr_0 = 9.3019e-04
Validation rmse = 1.110979
Epoch 3
Loss = 3.9876e-03, PNorm = 65.6861, GNorm = 2.6716, lr_0 = 9.0009e-04
Loss = 4.3689e-03, PNorm = 65.7708, GNorm = 4.7430, lr_0 = 8.7096e-04
Loss = 4.8055e-03, PNorm = 65.8490, GNorm = 2.1721, lr_0 = 8.4278e-04
Validation rmse = 1.103278
Epoch 4
Loss = 4.2816e-03, PNorm = 65.9178, GNorm = 1.4977, lr_0 = 8.1551e-04
Loss = 4.7794e-03, PNorm = 65.9869, GNorm = 2.8945, lr_0 = 7.8912e-04
Validation rmse = 1.239743
Epoch 5
Loss = 3.5007e-03, PNorm = 66.0492, GNorm = 1.5492, lr_0 = 7.6358e-04
Loss = 3.9913e-03, PNorm = 66.0987, GNorm = 1.7099, lr_0 = 7.3888e-04
Loss = 3.1305e-03, PNorm = 66.1432, GNorm = 2.9346, lr_0 = 7.1497e-04
Validation rmse = 1.031200
Epoch 6
Loss = 2.7387e-03, PNorm = 66.1990, GNorm = 1.1836, lr_0 = 6.8956e-04
Loss = 3.2956e-03, PNorm = 66.2406, GNorm = 2.1994, lr_0 = 6.6725e-04
Loss = 2.3757e-03, PNorm = 66.2845, GNorm = 2.2042, lr_0 = 6.4565e-04
Validation rmse = 0.991414
Epoch 7
Loss = 2.3485e-03, PNorm = 66.3305, GNorm = 1.1992, lr_0 = 6.2476e-04
Loss = 2.4708e-03, PNorm = 66.3649, GNorm = 1.3164, lr_0 = 6.0454e-04
Validation rmse = 1.036652
Epoch 8
Loss = 2.7936e-03, PNorm = 66.4112, GNorm = 2.0142, lr_0 = 5.8498e-04
Loss = 2.3977e-03, PNorm = 66.4585, GNorm = 0.8776, lr_0 = 5.6605e-04
Loss = 2.2103e-03, PNorm = 66.4927, GNorm = 1.0320, lr_0 = 5.4774e-04
Validation rmse = 0.862042
Epoch 9
Loss = 1.7320e-03, PNorm = 66.5245, GNorm = 0.4774, lr_0 = 5.3001e-04
Loss = 2.3249e-03, PNorm = 66.5562, GNorm = 0.9326, lr_0 = 5.1286e-04
Validation rmse = 0.856950
Epoch 10
Loss = 1.8275e-03, PNorm = 66.5955, GNorm = 2.5939, lr_0 = 4.9627e-04
Loss = 2.1366e-03, PNorm = 66.6265, GNorm = 1.9085, lr_0 = 4.8021e-04
Loss = 1.6001e-03, PNorm = 66.6577, GNorm = 2.0753, lr_0 = 4.6467e-04
Validation rmse = 0.813108
Epoch 11
Loss = 1.4454e-03, PNorm = 66.6904, GNorm = 0.9306, lr_0 = 4.4963e-04
Loss = 1.5939e-03, PNorm = 66.7241, GNorm = 1.6460, lr_0 = 4.3508e-04
Validation rmse = 0.792922
Epoch 12
Loss = 1.1036e-03, PNorm = 66.7499, GNorm = 0.5620, lr_0 = 4.1962e-04
Loss = 1.5633e-03, PNorm = 66.7756, GNorm = 1.2845, lr_0 = 4.0604e-04
Loss = 1.4196e-03, PNorm = 66.7966, GNorm = 0.8001, lr_0 = 3.9290e-04
Validation rmse = 0.777477
Epoch 13
Loss = 1.4610e-03, PNorm = 66.8151, GNorm = 1.9497, lr_0 = 3.8019e-04
Loss = 1.2925e-03, PNorm = 66.8429, GNorm = 0.4830, lr_0 = 3.6789e-04
Loss = 1.6326e-03, PNorm = 66.8631, GNorm = 1.3345, lr_0 = 3.5598e-04
Validation rmse = 0.763408
Epoch 14
Loss = 1.4999e-03, PNorm = 66.8872, GNorm = 2.1398, lr_0 = 3.4446e-04
Loss = 1.3203e-03, PNorm = 66.9128, GNorm = 1.4245, lr_0 = 3.3332e-04
Validation rmse = 0.966097
Epoch 15
Loss = 2.0586e-03, PNorm = 66.9290, GNorm = 0.9519, lr_0 = 3.2253e-04
Loss = 1.7830e-03, PNorm = 66.9521, GNorm = 1.2730, lr_0 = 3.1209e-04
Loss = 1.1760e-03, PNorm = 66.9751, GNorm = 0.7490, lr_0 = 3.0200e-04
Validation rmse = 0.806257
Epoch 16
Loss = 1.1598e-03, PNorm = 66.9924, GNorm = 0.6366, lr_0 = 2.9222e-04
Loss = 1.2627e-03, PNorm = 67.0078, GNorm = 0.5637, lr_0 = 2.8277e-04
Validation rmse = 0.753481
Epoch 17
Loss = 9.3233e-04, PNorm = 67.0305, GNorm = 0.2913, lr_0 = 2.7272e-04
Loss = 1.1427e-03, PNorm = 67.0449, GNorm = 0.5690, lr_0 = 2.6389e-04
Loss = 1.1084e-03, PNorm = 67.0588, GNorm = 0.6847, lr_0 = 2.5535e-04
Validation rmse = 0.762699
Epoch 18
Loss = 1.2252e-03, PNorm = 67.0751, GNorm = 0.3854, lr_0 = 2.4709e-04
Loss = 1.1503e-03, PNorm = 67.0898, GNorm = 1.8028, lr_0 = 2.3910e-04
Loss = 1.0569e-03, PNorm = 67.1020, GNorm = 0.4484, lr_0 = 2.3136e-04
Validation rmse = 0.750389
Epoch 19
Loss = 1.1758e-03, PNorm = 67.1166, GNorm = 0.8236, lr_0 = 2.2387e-04
Loss = 1.1548e-03, PNorm = 67.1286, GNorm = 0.6787, lr_0 = 2.1663e-04
Validation rmse = 0.736314
Epoch 20
Loss = 7.0027e-04, PNorm = 67.1432, GNorm = 0.3706, lr_0 = 2.0962e-04
Loss = 1.3725e-03, PNorm = 67.1550, GNorm = 2.5409, lr_0 = 2.0283e-04
Loss = 1.0403e-03, PNorm = 67.1660, GNorm = 0.6615, lr_0 = 1.9627e-04
Validation rmse = 0.767417
Epoch 21
Loss = 1.0484e-03, PNorm = 67.1777, GNorm = 0.4693, lr_0 = 1.8992e-04
Loss = 1.1722e-03, PNorm = 67.1903, GNorm = 0.6177, lr_0 = 1.8377e-04
Validation rmse = 0.748909
Epoch 22
Loss = 8.1252e-04, PNorm = 67.2010, GNorm = 0.4979, lr_0 = 1.7783e-04
Loss = 9.3804e-04, PNorm = 67.2123, GNorm = 0.4457, lr_0 = 1.7207e-04
Loss = 1.0431e-03, PNorm = 67.2224, GNorm = 0.4999, lr_0 = 1.6651e-04
Validation rmse = 0.745868
Epoch 23
Loss = 1.1162e-03, PNorm = 67.2305, GNorm = 0.3559, lr_0 = 1.6059e-04
Loss = 9.5841e-04, PNorm = 67.2418, GNorm = 1.8863, lr_0 = 1.5539e-04
Validation rmse = 0.739277
Epoch 24
Loss = 9.1268e-04, PNorm = 67.2539, GNorm = 0.5596, lr_0 = 1.5036e-04
Loss = 1.0126e-03, PNorm = 67.2629, GNorm = 1.9810, lr_0 = 1.4550e-04
Loss = 1.1006e-03, PNorm = 67.2717, GNorm = 1.8246, lr_0 = 1.4079e-04
Validation rmse = 0.796922
Epoch 25
Loss = 9.9242e-04, PNorm = 67.2797, GNorm = 0.9927, lr_0 = 1.3623e-04
Loss = 9.9070e-04, PNorm = 67.2882, GNorm = 1.7273, lr_0 = 1.3183e-04
Loss = 1.0791e-03, PNorm = 67.2966, GNorm = 1.6943, lr_0 = 1.2756e-04
Validation rmse = 0.744355
Epoch 26
Loss = 9.4619e-04, PNorm = 67.3062, GNorm = 0.7495, lr_0 = 1.2343e-04
Loss = 9.0066e-04, PNorm = 67.3132, GNorm = 0.3986, lr_0 = 1.1944e-04
Validation rmse = 0.747332
Epoch 27
Loss = 9.1989e-04, PNorm = 67.3205, GNorm = 1.1740, lr_0 = 1.1557e-04
Loss = 8.9145e-04, PNorm = 67.3263, GNorm = 0.5426, lr_0 = 1.1183e-04
Loss = 8.2828e-04, PNorm = 67.3320, GNorm = 0.4562, lr_0 = 1.0821e-04
Validation rmse = 0.743010
Epoch 28
Loss = 8.8458e-04, PNorm = 67.3378, GNorm = 0.5825, lr_0 = 1.0437e-04
Loss = 8.9498e-04, PNorm = 67.3430, GNorm = 0.3820, lr_0 = 1.0099e-04
Validation rmse = 0.771077
Epoch 29
Loss = 1.0198e-03, PNorm = 67.3504, GNorm = 1.5405, lr_0 = 1.0000e-04
Loss = 8.8157e-04, PNorm = 67.3559, GNorm = 0.8570, lr_0 = 1.0000e-04
Loss = 7.9026e-04, PNorm = 67.3601, GNorm = 0.4310, lr_0 = 1.0000e-04
Validation rmse = 0.742314
Model 0 best validation rmse = 0.736314 on epoch 19
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.730803
Ensemble test rmse = 0.730803
10-fold cross validation
	Seed 0 ==> test rmse = 0.784245
	Seed 1 ==> test rmse = 0.680039
	Seed 2 ==> test rmse = 0.684674
	Seed 3 ==> test rmse = 0.840444
	Seed 4 ==> test rmse = 1.024699
	Seed 5 ==> test rmse = 0.676174
	Seed 6 ==> test rmse = 0.763615
	Seed 7 ==> test rmse = 0.708465
	Seed 8 ==> test rmse = 0.698984
	Seed 9 ==> test rmse = 0.730803
Overall test rmse = 0.759214 +/- 0.101714
Elapsed time = 0:08:30
